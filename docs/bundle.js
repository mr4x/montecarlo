(()=>{var j0=Object.create;var Ph=Object.defineProperty;var K0=Object.getOwnPropertyDescriptor;var J0=Object.getOwnPropertyNames;var Q0=Object.getPrototypeOf,$0=Object.prototype.hasOwnProperty;var q0=Vr=>Ph(Vr,"__esModule",{value:!0});var Ac=(Vr=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(Vr,{get:(wn,ca)=>(typeof require!="undefined"?require:wn)[ca]}):Vr)(function(Vr){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+Vr+'" is not supported')});var eg=(Vr,wn)=>()=>(wn||Vr((wn={exports:{}}).exports,wn),wn.exports);var tg=(Vr,wn,ca,c)=>{if(wn&&typeof wn=="object"||typeof wn=="function")for(let ae of J0(wn))!$0.call(Vr,ae)&&(ca||ae!=="default")&&Ph(Vr,ae,{get:()=>wn[ae],enumerable:!(c=K0(wn,ae))||c.enumerable});return Vr},rg=(Vr,wn)=>tg(q0(Ph(Vr!=null?j0(Q0(Vr)):{},"default",!wn&&Vr&&Vr.__esModule?{get:()=>Vr.default,enumerable:!0}:{value:Vr,enumerable:!0})),Vr);var Kv=eg((jv,Dh)=>{(function(Vr){if(typeof jv=="object"&&typeof Dh<"u")Dh.exports=Vr();else if(typeof define=="function"&&define.amd)define([],Vr);else{var wn;typeof window<"u"?wn=window:typeof global<"u"?wn=global:typeof self<"u"?wn=self:wn=this,wn.Plotly=Vr()}})(function(){var Vr,wn,ca;return function(){function c(ae,ie,b){function k(e,p){if(!ie[e]){if(!ae[e]){var g=typeof Ac=="function"&&Ac;if(!p&&g)return g(e,!0);if(P)return P(e,!0);var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}var t=ie[e]={exports:{}};ae[e][0].call(t.exports,function(i){var n=ae[e][1][i];return k(n||i)},t,t.exports,c,ae,ie,b)}return ie[e].exports}for(var P=typeof Ac=="function"&&Ac,E=0;E<b.length;E++)k(b[E]);return k}return c}()({1:[function(c,ae,ie){"use strict";var b=c("../src/lib"),k={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:#fff;","X .select-outline-2":"stroke:#000;stroke-dasharray:2px 2px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var P in k){var E=P.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");b.addStyleRule(E,k[P])}},{"../src/lib":503}],2:[function(c,ae,ie){"use strict";ae.exports=c("../src/transforms/aggregate")},{"../src/transforms/aggregate":1118}],3:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/bar")},{"../src/traces/bar":656}],4:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/barpolar")},{"../src/traces/barpolar":669}],5:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/box")},{"../src/traces/box":679}],6:[function(c,ae,ie){"use strict";ae.exports=c("../src/components/calendars")},{"../src/components/calendars":364}],7:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/candlestick")},{"../src/traces/candlestick":688}],8:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/carpet")},{"../src/traces/carpet":707}],9:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/choropleth")},{"../src/traces/choropleth":721}],10:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":728}],11:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/cone")},{"../src/traces/cone":734}],12:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/contour")},{"../src/traces/contour":749}],13:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":760}],14:[function(c,ae,ie){"use strict";ae.exports=c("../src/core")},{"../src/core":481}],15:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":768}],16:[function(c,ae,ie){"use strict";ae.exports=c("../src/transforms/filter")},{"../src/transforms/filter":1119}],17:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/funnel")},{"../src/traces/funnel":778}],18:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/funnelarea")},{"../src/traces/funnelarea":787}],19:[function(c,ae,ie){"use strict";ae.exports=c("../src/transforms/groupby")},{"../src/transforms/groupby":1120}],20:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/heatmap")},{"../src/traces/heatmap":800}],21:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":811}],22:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/histogram")},{"../src/traces/histogram":823}],23:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/histogram2d")},{"../src/traces/histogram2d":829}],24:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":833}],25:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/icicle")},{"../src/traces/icicle":839}],26:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/image")},{"../src/traces/image":852}],27:[function(c,ae,ie){"use strict";var b=c("./core");b.register([c("./bar"),c("./box"),c("./heatmap"),c("./histogram"),c("./histogram2d"),c("./histogram2dcontour"),c("./contour"),c("./scatterternary"),c("./violin"),c("./funnel"),c("./waterfall"),c("./image"),c("./pie"),c("./sunburst"),c("./treemap"),c("./icicle"),c("./funnelarea"),c("./scatter3d"),c("./surface"),c("./isosurface"),c("./volume"),c("./mesh3d"),c("./cone"),c("./streamtube"),c("./scattergeo"),c("./choropleth"),c("./scattergl"),c("./splom"),c("./pointcloud"),c("./heatmapgl"),c("./parcoords"),c("./parcats"),c("./scattermapbox"),c("./choroplethmapbox"),c("./densitymapbox"),c("./sankey"),c("./indicator"),c("./table"),c("./carpet"),c("./scattercarpet"),c("./contourcarpet"),c("./ohlc"),c("./candlestick"),c("./scatterpolar"),c("./scatterpolargl"),c("./barpolar"),c("./scattersmith"),c("./aggregate"),c("./filter"),c("./groupby"),c("./sort"),c("./calendars")]),ae.exports=b},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/indicator")},{"../src/traces/indicator":860}],29:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/isosurface")},{"../src/traces/isosurface":866}],30:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/mesh3d")},{"../src/traces/mesh3d":871}],31:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/ohlc")},{"../src/traces/ohlc":876}],32:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/parcats")},{"../src/traces/parcats":885}],33:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/parcoords")},{"../src/traces/parcoords":896}],34:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/pie")},{"../src/traces/pie":907}],35:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/pointcloud")},{"../src/traces/pointcloud":916}],36:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/sankey")},{"../src/traces/sankey":922}],37:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/scatter3d")},{"../src/traces/scatter3d":960}],38:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":967}],39:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/scattergeo")},{"../src/traces/scattergeo":975}],40:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/scattergl")},{"../src/traces/scattergl":989}],41:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":999}],42:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1007}],43:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1015}],44:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/scattersmith")},{"../src/traces/scattersmith":1022}],45:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/scatterternary")},{"../src/traces/scatterternary":1030}],46:[function(c,ae,ie){"use strict";ae.exports=c("../src/transforms/sort")},{"../src/transforms/sort":1122}],47:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/splom")},{"../src/traces/splom":1040}],48:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/streamtube")},{"../src/traces/streamtube":1048}],49:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/sunburst")},{"../src/traces/sunburst":1056}],50:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/surface")},{"../src/traces/surface":1065}],51:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/table")},{"../src/traces/table":1073}],52:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/treemap")},{"../src/traces/treemap":1084}],53:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/violin")},{"../src/traces/violin":1097}],54:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/volume")},{"../src/traces/volume":1105}],55:[function(c,ae,ie){"use strict";ae.exports=c("../src/traces/waterfall")},{"../src/traces/waterfall":1113}],56:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie,c("d3-array"),c("d3-collection"),c("d3-shape"),c("elementary-circuits-directed-graph")):typeof Vr=="function"&&Vr.amd?Vr(["exports","d3-array","d3-collection","d3-shape","elementary-circuits-directed-graph"],k):k(b.d3=b.d3||{},b.d3,b.d3,b.d3,null)})(this,function(b,k,P,E,e){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;function p(pe){return pe.target.depth}function g(pe){return pe.depth}function a(pe,xe){return xe-1-pe.height}function t(pe,xe){return pe.sourceLinks.length?pe.depth:xe-1}function i(pe){return pe.targetLinks.length?pe.depth:pe.sourceLinks.length?k.min(pe.sourceLinks,p)-1:0}function n(pe){return function(){return pe}}var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(pe){return typeof pe}:function(pe){return pe&&typeof Symbol=="function"&&pe.constructor===Symbol&&pe!==Symbol.prototype?"symbol":typeof pe};function d(pe,xe){return m(pe.source,xe.source)||pe.index-xe.index}function s(pe,xe){return m(pe.target,xe.target)||pe.index-xe.index}function m(pe,xe){return pe.partOfCycle===xe.partOfCycle?pe.y0-xe.y0:pe.circularLinkType==="top"||xe.circularLinkType==="bottom"?-1:1}function x(pe){return pe.value}function M(pe){return(pe.y0+pe.y1)/2}function v(pe){return M(pe.source)}function _(pe){return M(pe.target)}function l(pe){return pe.index}function y(pe){return pe.nodes}function T(pe){return pe.links}function w(pe,xe){var Ee=pe.get(xe);if(!Ee)throw new Error("missing: "+xe);return Ee}function A(pe,xe){return xe(pe)}var f=25,u=10,h=.3;function o(){var pe=0,xe=0,Ee=1,Te=1,de=24,be,Le=l,De=t,ye=y,ke=T,Oe=32,Qe=2,Ve,Ue=null;function Ie(){var _t={nodes:ye.apply(null,arguments),links:ke.apply(null,arguments)};at(_t),S(_t,Le,Ue),pt(_t),It(_t),R(_t,Le),Bt(_t,Oe,Le),St(_t);for(var it=4,ct=0;ct<it;ct++)re(_t,Te,Le),j(_t,Te,Le),ee(_t,xe,Te,Le),re(_t,Te,Le),j(_t,Te,Le);return ge(_t,xe,Te),B(_t,Qe,Te,Le),_t}Ie.nodeId=function(_t){return arguments.length?(Le=typeof _t=="function"?_t:n(_t),Ie):Le},Ie.nodeAlign=function(_t){return arguments.length?(De=typeof _t=="function"?_t:n(_t),Ie):De},Ie.nodeWidth=function(_t){return arguments.length?(de=+_t,Ie):de},Ie.nodePadding=function(_t){return arguments.length?(be=+_t,Ie):be},Ie.nodes=function(_t){return arguments.length?(ye=typeof _t=="function"?_t:n(_t),Ie):ye},Ie.links=function(_t){return arguments.length?(ke=typeof _t=="function"?_t:n(_t),Ie):ke},Ie.size=function(_t){return arguments.length?(pe=xe=0,Ee=+_t[0],Te=+_t[1],Ie):[Ee-pe,Te-xe]},Ie.extent=function(_t){return arguments.length?(pe=+_t[0][0],Ee=+_t[1][0],xe=+_t[0][1],Te=+_t[1][1],Ie):[[pe,xe],[Ee,Te]]},Ie.iterations=function(_t){return arguments.length?(Oe=+_t,Ie):Oe},Ie.circularLinkGap=function(_t){return arguments.length?(Qe=+_t,Ie):Qe},Ie.nodePaddingRatio=function(_t){return arguments.length?(Ve=+_t,Ie):Ve},Ie.sortNodes=function(_t){return arguments.length?(Ue=_t,Ie):Ue},Ie.update=function(_t){return R(_t,Le),St(_t),_t.links.forEach(function(it){it.circular&&(it.circularLinkType=it.y0+it.y1<Te?"top":"bottom",it.source.circularLinkType=it.circularLinkType,it.target.circularLinkType=it.circularLinkType)}),re(_t,Te,Le,!1),j(_t,Te,Le),B(_t,Qe,Te,Le),_t};function at(_t){_t.nodes.forEach(function(ct,et){ct.index=et,ct.sourceLinks=[],ct.targetLinks=[]});var it=P.map(_t.nodes,Le);return _t.links.forEach(function(ct,et){ct.index=et;var Pe=ct.source,We=ct.target;(typeof Pe>"u"?"undefined":r(Pe))!=="object"&&(Pe=ct.source=w(it,Pe)),(typeof We>"u"?"undefined":r(We))!=="object"&&(We=ct.target=w(it,We)),Pe.sourceLinks.push(ct),We.targetLinks.push(ct)}),_t}function pt(_t){_t.nodes.forEach(function(it){it.partOfCycle=!1,it.value=Math.max(k.sum(it.sourceLinks,x),k.sum(it.targetLinks,x)),it.sourceLinks.forEach(function(ct){ct.circular&&(it.partOfCycle=!0,it.circularLinkType=ct.circularLinkType)}),it.targetLinks.forEach(function(ct){ct.circular&&(it.partOfCycle=!0,it.circularLinkType=ct.circularLinkType)})})}function Rt(_t){var it=0,ct=0,et=0,Pe=0,We=k.max(_t.nodes,function(je){return je.column});return _t.links.forEach(function(je){je.circular&&(je.circularLinkType=="top"?it=it+je.width:ct=ct+je.width,je.target.column==0&&(Pe=Pe+je.width),je.source.column==We&&(et=et+je.width))}),it=it>0?it+f+u:it,ct=ct>0?ct+f+u:ct,et=et>0?et+f+u:et,Pe=Pe>0?Pe+f+u:Pe,{top:it,bottom:ct,left:Pe,right:et}}function Mt(_t,it){var ct=k.max(_t.nodes,function(wt){return wt.column}),et=Ee-pe,Pe=Te-xe,We=et+it.right+it.left,je=Pe+it.top+it.bottom,nt=et/We,kt=Pe/je;return pe=pe*nt+it.left,Ee=it.right==0?Ee:Ee*nt,xe=xe*kt+it.top,Te=Te*kt,_t.nodes.forEach(function(wt){wt.x0=pe+wt.column*((Ee-pe-de)/ct),wt.x1=wt.x0+de}),kt}function It(_t){var it,ct,et;for(it=_t.nodes,ct=[],et=0;it.length;++et,it=ct,ct=[])it.forEach(function(Pe){Pe.depth=et,Pe.sourceLinks.forEach(function(We){ct.indexOf(We.target)<0&&!We.circular&&ct.push(We.target)})});for(it=_t.nodes,ct=[],et=0;it.length;++et,it=ct,ct=[])it.forEach(function(Pe){Pe.height=et,Pe.targetLinks.forEach(function(We){ct.indexOf(We.source)<0&&!We.circular&&ct.push(We.source)})});_t.nodes.forEach(function(Pe){Pe.column=Math.floor(De.call(null,Pe,et))})}function Bt(_t,it,ct){var et=P.nest().key(function(wt){return wt.column}).sortKeys(k.ascending).entries(_t.nodes).map(function(wt){return wt.values});je(ct),kt();for(var Pe=1,We=it;We>0;--We)nt(Pe*=.99,ct),kt();function je(wt){if(Ve){var Vt=1/0;et.forEach(function($t){var Qt=Te*Ve/($t.length+1);Vt=Qt<Vt?Qt:Vt}),be=Vt}var qt=k.min(et,function($t){return(Te-xe-($t.length-1)*be)/k.sum($t,x)});qt=qt*h,_t.links.forEach(function($t){$t.width=$t.value*qt});var zt=Rt(_t),Ht=Mt(_t,zt);qt=qt*Ht,_t.links.forEach(function($t){$t.width=$t.value*qt}),et.forEach(function($t){var Qt=$t.length;$t.forEach(function(fr,jr){fr.depth==et.length-1&&Qt==1||fr.depth==0&&Qt==1?(fr.y0=Te/2-fr.value*qt,fr.y1=fr.y0+fr.value*qt):fr.partOfCycle?I(fr,wt)==0?(fr.y0=Te/2+jr,fr.y1=fr.y0+fr.value*qt):fr.circularLinkType=="top"?(fr.y0=xe+jr,fr.y1=fr.y0+fr.value*qt):(fr.y0=Te-fr.value*qt-jr,fr.y1=fr.y0+fr.value*qt):zt.top==0||zt.bottom==0?(fr.y0=(Te-xe)/Qt*jr,fr.y1=fr.y0+fr.value*qt):(fr.y0=(Te-xe)/2-Qt/2+jr,fr.y1=fr.y0+fr.value*qt)})})}function nt(wt,Vt){var qt=et.length;et.forEach(function(zt){var Ht=zt.length,$t=zt[0].depth;zt.forEach(function(Qt){var fr;if((Qt.sourceLinks.length||Qt.targetLinks.length)&&!(Qt.partOfCycle&&I(Qt,Vt)>0))if($t==0&&Ht==1)fr=Qt.y1-Qt.y0,Qt.y0=Te/2-fr/2,Qt.y1=Te/2+fr/2;else if($t==qt-1&&Ht==1)fr=Qt.y1-Qt.y0,Qt.y0=Te/2-fr/2,Qt.y1=Te/2+fr/2;else{var jr=0,cn=k.mean(Qt.sourceLinks,_),Qr=k.mean(Qt.targetLinks,v);cn&&Qr?jr=(cn+Qr)/2:jr=cn||Qr;var lt=(jr-M(Qt))*wt;Qt.y0+=lt,Qt.y1+=lt}})})}function kt(){et.forEach(function(wt){var Vt,qt,zt=xe,Ht=wt.length,$t;for(wt.sort(m),$t=0;$t<Ht;++$t)Vt=wt[$t],qt=zt-Vt.y0,qt>0&&(Vt.y0+=qt,Vt.y1+=qt),zt=Vt.y1+be;if(qt=zt-be-Te,qt>0)for(zt=Vt.y0-=qt,Vt.y1-=qt,$t=Ht-2;$t>=0;--$t)Vt=wt[$t],qt=Vt.y1+be-zt,qt>0&&(Vt.y0-=qt,Vt.y1-=qt),zt=Vt.y0})}}function St(_t){_t.nodes.forEach(function(it){it.sourceLinks.sort(s),it.targetLinks.sort(d)}),_t.nodes.forEach(function(it){var ct=it.y0,et=ct,Pe=it.y1,We=Pe;it.sourceLinks.forEach(function(je){je.circular?(je.y0=Pe-je.width/2,Pe=Pe-je.width):(je.y0=ct+je.width/2,ct+=je.width)}),it.targetLinks.forEach(function(je){je.circular?(je.y1=We-je.width/2,We=We-je.width):(je.y1=et+je.width/2,et+=je.width)})})}return Ie}function S(pe,xe,Ee){var Te=0;if(Ee===null){for(var de=[],be=0;be<pe.links.length;be++){var Le=pe.links[be],De=Le.source.index,ye=Le.target.index;de[De]||(de[De]=[]),de[ye]||(de[ye]=[]),de[De].indexOf(ye)===-1&&de[De].push(ye)}var ke=e(de);ke.sort(function(Ue,Ie){return Ue.length-Ie.length});var Oe={};for(be=0;be<ke.length;be++){var Qe=ke[be],Ve=Qe.slice(-2);Oe[Ve[0]]||(Oe[Ve[0]]={}),Oe[Ve[0]][Ve[1]]=!0}pe.links.forEach(function(Ue){var Ie=Ue.target.index,at=Ue.source.index;Ie===at||Oe[at]&&Oe[at][Ie]?(Ue.circular=!0,Ue.circularLinkID=Te,Te=Te+1):Ue.circular=!1})}else pe.links.forEach(function(Ue){Ue.source[Ee]<Ue.target[Ee]?Ue.circular=!1:(Ue.circular=!0,Ue.circularLinkID=Te,Te=Te+1)})}function R(pe,xe){var Ee=0,Te=0;pe.links.forEach(function(de){de.circular&&(de.source.circularLinkType||de.target.circularLinkType?de.circularLinkType=de.source.circularLinkType?de.source.circularLinkType:de.target.circularLinkType:de.circularLinkType=Ee<Te?"top":"bottom",de.circularLinkType=="top"?Ee=Ee+1:Te=Te+1,pe.nodes.forEach(function(be){(A(be,xe)==A(de.source,xe)||A(be,xe)==A(de.target,xe))&&(be.circularLinkType=de.circularLinkType)}))}),pe.links.forEach(function(de){de.circular&&(de.source.circularLinkType==de.target.circularLinkType&&(de.circularLinkType=de.source.circularLinkType),le(de,xe)&&(de.circularLinkType=de.source.circularLinkType))})}function z(pe){var xe=Math.abs(pe.y1-pe.y0),Ee=Math.abs(pe.target.x0-pe.source.x1);return Math.atan(Ee/xe)}function O(pe,xe){return pe.source.column<xe.target.column?!1:!(pe.target.column>xe.source.column)}function I(pe,xe){var Ee=0;pe.sourceLinks.forEach(function(de){Ee=de.circular&&!le(de,xe)?Ee+1:Ee});var Te=0;return pe.targetLinks.forEach(function(de){Te=de.circular&&!le(de,xe)?Te+1:Te}),Ee+Te}function F(pe){var xe=pe.source.sourceLinks,Ee=0;xe.forEach(function(be){Ee=be.circular?Ee+1:Ee});var Te=pe.target.targetLinks,de=0;return Te.forEach(function(be){de=be.circular?de+1:de}),!(Ee>1||de>1)}function D(pe,xe,Ee){return pe.sort(X),pe.forEach(function(Te,de){var be=0;if(le(Te,Ee)&&F(Te))Te.circularPathData.verticalBuffer=be+Te.width/2;else{var Le=0;for(Le;Le<de;Le++)if(O(pe[de],pe[Le])){var De=pe[Le].circularPathData.verticalBuffer+pe[Le].width/2+xe;be=De>be?De:be}Te.circularPathData.verticalBuffer=be+Te.width/2}}),pe}function B(pe,xe,Ee,Te){var de=5,be=k.min(pe.links,function(ye){return ye.source.y0});pe.links.forEach(function(ye){ye.circular&&(ye.circularPathData={})});var Le=pe.links.filter(function(ye){return ye.circularLinkType=="top"});D(Le,xe,Te);var De=pe.links.filter(function(ye){return ye.circularLinkType=="bottom"});D(De,xe,Te),pe.links.forEach(function(ye){if(ye.circular){if(ye.circularPathData.arcRadius=ye.width+u,ye.circularPathData.leftNodeBuffer=de,ye.circularPathData.rightNodeBuffer=de,ye.circularPathData.sourceWidth=ye.source.x1-ye.source.x0,ye.circularPathData.sourceX=ye.source.x0+ye.circularPathData.sourceWidth,ye.circularPathData.targetX=ye.target.x0,ye.circularPathData.sourceY=ye.y0,ye.circularPathData.targetY=ye.y1,le(ye,Te)&&F(ye))ye.circularPathData.leftSmallArcRadius=u+ye.width/2,ye.circularPathData.leftLargeArcRadius=u+ye.width/2,ye.circularPathData.rightSmallArcRadius=u+ye.width/2,ye.circularPathData.rightLargeArcRadius=u+ye.width/2,ye.circularLinkType=="bottom"?(ye.circularPathData.verticalFullExtent=ye.source.y1+f+ye.circularPathData.verticalBuffer,ye.circularPathData.verticalLeftInnerExtent=ye.circularPathData.verticalFullExtent-ye.circularPathData.leftLargeArcRadius,ye.circularPathData.verticalRightInnerExtent=ye.circularPathData.verticalFullExtent-ye.circularPathData.rightLargeArcRadius):(ye.circularPathData.verticalFullExtent=ye.source.y0-f-ye.circularPathData.verticalBuffer,ye.circularPathData.verticalLeftInnerExtent=ye.circularPathData.verticalFullExtent+ye.circularPathData.leftLargeArcRadius,ye.circularPathData.verticalRightInnerExtent=ye.circularPathData.verticalFullExtent+ye.circularPathData.rightLargeArcRadius);else{var ke=ye.source.column,Oe=ye.circularLinkType,Qe=pe.links.filter(function(Ie){return Ie.source.column==ke&&Ie.circularLinkType==Oe});ye.circularLinkType=="bottom"?Qe.sort(se):Qe.sort(oe);var Ve=0;Qe.forEach(function(Ie,at){Ie.circularLinkID==ye.circularLinkID&&(ye.circularPathData.leftSmallArcRadius=u+ye.width/2+Ve,ye.circularPathData.leftLargeArcRadius=u+ye.width/2+at*xe+Ve),Ve=Ve+Ie.width}),ke=ye.target.column,Qe=pe.links.filter(function(Ie){return Ie.target.column==ke&&Ie.circularLinkType==Oe}),ye.circularLinkType=="bottom"?Qe.sort(K):Qe.sort(q),Ve=0,Qe.forEach(function(Ie,at){Ie.circularLinkID==ye.circularLinkID&&(ye.circularPathData.rightSmallArcRadius=u+ye.width/2+Ve,ye.circularPathData.rightLargeArcRadius=u+ye.width/2+at*xe+Ve),Ve=Ve+Ie.width}),ye.circularLinkType=="bottom"?(ye.circularPathData.verticalFullExtent=Math.max(Ee,ye.source.y1,ye.target.y1)+f+ye.circularPathData.verticalBuffer,ye.circularPathData.verticalLeftInnerExtent=ye.circularPathData.verticalFullExtent-ye.circularPathData.leftLargeArcRadius,ye.circularPathData.verticalRightInnerExtent=ye.circularPathData.verticalFullExtent-ye.circularPathData.rightLargeArcRadius):(ye.circularPathData.verticalFullExtent=be-f-ye.circularPathData.verticalBuffer,ye.circularPathData.verticalLeftInnerExtent=ye.circularPathData.verticalFullExtent+ye.circularPathData.leftLargeArcRadius,ye.circularPathData.verticalRightInnerExtent=ye.circularPathData.verticalFullExtent+ye.circularPathData.rightLargeArcRadius)}ye.circularPathData.leftInnerExtent=ye.circularPathData.sourceX+ye.circularPathData.leftNodeBuffer,ye.circularPathData.rightInnerExtent=ye.circularPathData.targetX-ye.circularPathData.rightNodeBuffer,ye.circularPathData.leftFullExtent=ye.circularPathData.sourceX+ye.circularPathData.leftLargeArcRadius+ye.circularPathData.leftNodeBuffer,ye.circularPathData.rightFullExtent=ye.circularPathData.targetX-ye.circularPathData.rightLargeArcRadius-ye.circularPathData.rightNodeBuffer}if(ye.circular)ye.path=U(ye);else{var Ue=E.linkHorizontal().source(function(Ie){var at=Ie.source.x0+(Ie.source.x1-Ie.source.x0),pt=Ie.y0;return[at,pt]}).target(function(Ie){var at=Ie.target.x0,pt=Ie.y1;return[at,pt]});ye.path=Ue(ye)}})}function U(pe){var xe="";return pe.circularLinkType=="top"?xe="M"+pe.circularPathData.sourceX+" "+pe.circularPathData.sourceY+" L"+pe.circularPathData.leftInnerExtent+" "+pe.circularPathData.sourceY+" A"+pe.circularPathData.leftLargeArcRadius+" "+pe.circularPathData.leftSmallArcRadius+" 0 0 0 "+pe.circularPathData.leftFullExtent+" "+(pe.circularPathData.sourceY-pe.circularPathData.leftSmallArcRadius)+" L"+pe.circularPathData.leftFullExtent+" "+pe.circularPathData.verticalLeftInnerExtent+" A"+pe.circularPathData.leftLargeArcRadius+" "+pe.circularPathData.leftLargeArcRadius+" 0 0 0 "+pe.circularPathData.leftInnerExtent+" "+pe.circularPathData.verticalFullExtent+" L"+pe.circularPathData.rightInnerExtent+" "+pe.circularPathData.verticalFullExtent+" A"+pe.circularPathData.rightLargeArcRadius+" "+pe.circularPathData.rightLargeArcRadius+" 0 0 0 "+pe.circularPathData.rightFullExtent+" "+pe.circularPathData.verticalRightInnerExtent+" L"+pe.circularPathData.rightFullExtent+" "+(pe.circularPathData.targetY-pe.circularPathData.rightSmallArcRadius)+" A"+pe.circularPathData.rightLargeArcRadius+" "+pe.circularPathData.rightSmallArcRadius+" 0 0 0 "+pe.circularPathData.rightInnerExtent+" "+pe.circularPathData.targetY+" L"+pe.circularPathData.targetX+" "+pe.circularPathData.targetY:xe="M"+pe.circularPathData.sourceX+" "+pe.circularPathData.sourceY+" L"+pe.circularPathData.leftInnerExtent+" "+pe.circularPathData.sourceY+" A"+pe.circularPathData.leftLargeArcRadius+" "+pe.circularPathData.leftSmallArcRadius+" 0 0 1 "+pe.circularPathData.leftFullExtent+" "+(pe.circularPathData.sourceY+pe.circularPathData.leftSmallArcRadius)+" L"+pe.circularPathData.leftFullExtent+" "+pe.circularPathData.verticalLeftInnerExtent+" A"+pe.circularPathData.leftLargeArcRadius+" "+pe.circularPathData.leftLargeArcRadius+" 0 0 1 "+pe.circularPathData.leftInnerExtent+" "+pe.circularPathData.verticalFullExtent+" L"+pe.circularPathData.rightInnerExtent+" "+pe.circularPathData.verticalFullExtent+" A"+pe.circularPathData.rightLargeArcRadius+" "+pe.circularPathData.rightLargeArcRadius+" 0 0 1 "+pe.circularPathData.rightFullExtent+" "+pe.circularPathData.verticalRightInnerExtent+" L"+pe.circularPathData.rightFullExtent+" "+(pe.circularPathData.targetY+pe.circularPathData.rightSmallArcRadius)+" A"+pe.circularPathData.rightLargeArcRadius+" "+pe.circularPathData.rightSmallArcRadius+" 0 0 1 "+pe.circularPathData.rightInnerExtent+" "+pe.circularPathData.targetY+" L"+pe.circularPathData.targetX+" "+pe.circularPathData.targetY,xe}function X(pe,xe){return G(pe)==G(xe)?pe.circularLinkType=="bottom"?se(pe,xe):oe(pe,xe):G(xe)-G(pe)}function oe(pe,xe){return pe.y0-xe.y0}function se(pe,xe){return xe.y0-pe.y0}function q(pe,xe){return pe.y1-xe.y1}function K(pe,xe){return xe.y1-pe.y1}function G(pe){return pe.target.column-pe.source.column}function Q(pe){return pe.target.x0-pe.source.x1}function V(pe,xe){var Ee=z(pe),Te=Q(xe)/Math.tan(Ee),de=ne(pe)=="up"?pe.y1+Te:pe.y1-Te;return de}function H(pe,xe){var Ee=z(pe),Te=Q(xe)/Math.tan(Ee),de=ne(pe)=="up"?pe.y1-Te:pe.y1+Te;return de}function ee(pe,xe,Ee,Te){pe.links.forEach(function(de){if(!de.circular&&de.target.column-de.source.column>1){var be=de.source.column+1,Le=de.target.column-1,De=1,ye=Le-be+1;for(De=1;be<=Le;be++,De++)pe.nodes.forEach(function(ke){if(ke.column==be){var Oe=De/(ye+1),Qe=Math.pow(1-Oe,3),Ve=3*Oe*Math.pow(1-Oe,2),Ue=3*Math.pow(Oe,2)*(1-Oe),Ie=Math.pow(Oe,3),at=Qe*de.y0+Ve*de.y0+Ue*de.y1+Ie*de.y1,pt=at-de.width/2,Rt=at+de.width/2,Mt;pt>ke.y0&&pt<ke.y1?(Mt=ke.y1-pt+10,Mt=ke.circularLinkType=="bottom"?Mt:-Mt,ke=W(ke,Mt,xe,Ee),pe.nodes.forEach(function(It){A(It,Te)==A(ke,Te)||It.column!=ke.column||J(ke,It)&&W(It,Mt,xe,Ee)})):Rt>ke.y0&&Rt<ke.y1?(Mt=Rt-ke.y0+10,ke=W(ke,Mt,xe,Ee),pe.nodes.forEach(function(It){A(It,Te)==A(ke,Te)||It.column!=ke.column||It.y0<ke.y1&&It.y1>ke.y1&&W(It,Mt,xe,Ee)})):pt<ke.y0&&Rt>ke.y1&&(Mt=Rt-ke.y0+10,ke=W(ke,Mt,xe,Ee),pe.nodes.forEach(function(It){A(It,Te)==A(ke,Te)||It.column!=ke.column||It.y0<ke.y1&&It.y1>ke.y1&&W(It,Mt,xe,Ee)}))}})}})}function J(pe,xe){return pe.y0>xe.y0&&pe.y0<xe.y1||pe.y1>xe.y0&&pe.y1<xe.y1?!0:pe.y0<xe.y0&&pe.y1>xe.y1}function W(pe,xe,Ee,Te){return pe.y0+xe>=Ee&&pe.y1+xe<=Te&&(pe.y0=pe.y0+xe,pe.y1=pe.y1+xe,pe.targetLinks.forEach(function(de){de.y1=de.y1+xe}),pe.sourceLinks.forEach(function(de){de.y0=de.y0+xe})),pe}function re(pe,xe,Ee,Te){pe.nodes.forEach(function(de){Te&&de.y+(de.y1-de.y0)>xe&&(de.y=de.y-(de.y+(de.y1-de.y0)-xe));var be=pe.links.filter(function(ye){return A(ye.source,Ee)==A(de,Ee)}),Le=be.length;Le>1&&be.sort(function(ye,ke){if(!ye.circular&&!ke.circular){if(ye.target.column==ke.target.column)return ye.y1-ke.y1;if(Z(ye,ke)){if(ye.target.column>ke.target.column){var Oe=H(ke,ye);return ye.y1-Oe}if(ke.target.column>ye.target.column){var Qe=H(ye,ke);return Qe-ke.y1}}else return ye.y1-ke.y1}if(ye.circular&&!ke.circular)return ye.circularLinkType=="top"?-1:1;if(ke.circular&&!ye.circular)return ke.circularLinkType=="top"?1:-1;if(ye.circular&&ke.circular)return ye.circularLinkType===ke.circularLinkType&&ye.circularLinkType=="top"?ye.target.column===ke.target.column?ye.target.y1-ke.target.y1:ke.target.column-ye.target.column:ye.circularLinkType===ke.circularLinkType&&ye.circularLinkType=="bottom"?ye.target.column===ke.target.column?ke.target.y1-ye.target.y1:ye.target.column-ke.target.column:ye.circularLinkType=="top"?-1:1});var De=de.y0;be.forEach(function(ye){ye.y0=De+ye.width/2,De=De+ye.width}),be.forEach(function(ye,ke){if(ye.circularLinkType=="bottom"){var Oe=ke+1,Qe=0;for(Oe;Oe<Le;Oe++)Qe=Qe+be[Oe].width;ye.y0=de.y1-Qe-ye.width/2}})})}function j(pe,xe,Ee){pe.nodes.forEach(function(Te){var de=pe.links.filter(function(De){return A(De.target,Ee)==A(Te,Ee)}),be=de.length;be>1&&de.sort(function(De,ye){if(!De.circular&&!ye.circular){if(De.source.column==ye.source.column)return De.y0-ye.y0;if(Z(De,ye)){if(ye.source.column<De.source.column){var ke=V(ye,De);return De.y0-ke}if(De.source.column<ye.source.column){var Oe=V(De,ye);return Oe-ye.y0}}else return De.y0-ye.y0}if(De.circular&&!ye.circular)return De.circularLinkType=="top"?-1:1;if(ye.circular&&!De.circular)return ye.circularLinkType=="top"?1:-1;if(De.circular&&ye.circular)return De.circularLinkType===ye.circularLinkType&&De.circularLinkType=="top"?De.source.column===ye.source.column?De.source.y1-ye.source.y1:De.source.column-ye.source.column:De.circularLinkType===ye.circularLinkType&&De.circularLinkType=="bottom"?De.source.column===ye.source.column?De.source.y1-ye.source.y1:ye.source.column-De.source.column:De.circularLinkType=="top"?-1:1});var Le=Te.y0;de.forEach(function(De){De.y1=Le+De.width/2,Le=Le+De.width}),de.forEach(function(De,ye){if(De.circularLinkType=="bottom"){var ke=ye+1,Oe=0;for(ke;ke<be;ke++)Oe=Oe+de[ke].width;De.y1=Te.y1-Oe-De.width/2}})})}function Z(pe,xe){return ne(pe)==ne(xe)}function ne(pe){return pe.y0-pe.y1>0?"up":"down"}function le(pe,xe){return A(pe.source,xe)==A(pe.target,xe)}function ge(pe,xe,Ee){var Te=pe.nodes,de=pe.links,be=!1,Le=!1;if(de.forEach(function(Ve){Ve.circularLinkType=="top"?be=!0:Ve.circularLinkType=="bottom"&&(Le=!0)}),be==!1||Le==!1){var De=k.min(Te,function(Ve){return Ve.y0}),ye=k.max(Te,function(Ve){return Ve.y1}),ke=ye-De,Oe=Ee-xe,Qe=Oe/ke;Te.forEach(function(Ve){var Ue=(Ve.y1-Ve.y0)*Qe;Ve.y0=(Ve.y0-De)*Qe,Ve.y1=Ve.y0+Ue}),de.forEach(function(Ve){Ve.y0=(Ve.y0-De)*Qe,Ve.y1=(Ve.y1-De)*Qe,Ve.width=Ve.width*Qe})}}b.sankeyCircular=o,b.sankeyCenter=i,b.sankeyLeft=g,b.sankeyRight=a,b.sankeyJustify=t,Object.defineProperty(b,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie,c("d3-array"),c("d3-collection"),c("d3-shape")):typeof Vr=="function"&&Vr.amd?Vr(["exports","d3-array","d3-collection","d3-shape"],k):k(b.d3=b.d3||{},b.d3,b.d3,b.d3)})(this,function(b,k,P,E){"use strict";function e(u){return u.target.depth}function p(u){return u.depth}function g(u,h){return h-1-u.height}function a(u,h){return u.sourceLinks.length?u.depth:h-1}function t(u){return u.targetLinks.length?u.depth:u.sourceLinks.length?k.min(u.sourceLinks,e)-1:0}function i(u){return function(){return u}}function n(u,h){return d(u.source,h.source)||u.index-h.index}function r(u,h){return d(u.target,h.target)||u.index-h.index}function d(u,h){return u.y0-h.y0}function s(u){return u.value}function m(u){return(u.y0+u.y1)/2}function x(u){return m(u.source)*u.value}function M(u){return m(u.target)*u.value}function v(u){return u.index}function _(u){return u.nodes}function l(u){return u.links}function y(u,h){var o=u.get(h);if(!o)throw new Error("missing: "+h);return o}var T=function(){var u=0,h=0,o=1,S=1,R=24,z=8,O=v,I=a,F=_,D=l,B=32,U=2/3;function X(){var Q={nodes:F.apply(null,arguments),links:D.apply(null,arguments)};return oe(Q),se(Q),q(Q),K(Q,B),G(Q),Q}X.update=function(Q){return G(Q),Q},X.nodeId=function(Q){return arguments.length?(O=typeof Q=="function"?Q:i(Q),X):O},X.nodeAlign=function(Q){return arguments.length?(I=typeof Q=="function"?Q:i(Q),X):I},X.nodeWidth=function(Q){return arguments.length?(R=+Q,X):R},X.nodePadding=function(Q){return arguments.length?(z=+Q,X):z},X.nodes=function(Q){return arguments.length?(F=typeof Q=="function"?Q:i(Q),X):F},X.links=function(Q){return arguments.length?(D=typeof Q=="function"?Q:i(Q),X):D},X.size=function(Q){return arguments.length?(u=h=0,o=+Q[0],S=+Q[1],X):[o-u,S-h]},X.extent=function(Q){return arguments.length?(u=+Q[0][0],o=+Q[1][0],h=+Q[0][1],S=+Q[1][1],X):[[u,h],[o,S]]},X.iterations=function(Q){return arguments.length?(B=+Q,X):B};function oe(Q){Q.nodes.forEach(function(H,ee){H.index=ee,H.sourceLinks=[],H.targetLinks=[]});var V=P.map(Q.nodes,O);Q.links.forEach(function(H,ee){H.index=ee;var J=H.source,W=H.target;typeof J!="object"&&(J=H.source=y(V,J)),typeof W!="object"&&(W=H.target=y(V,W)),J.sourceLinks.push(H),W.targetLinks.push(H)})}function se(Q){Q.nodes.forEach(function(V){V.value=Math.max(k.sum(V.sourceLinks,s),k.sum(V.targetLinks,s))})}function q(Q){var V,H,ee;for(V=Q.nodes,H=[],ee=0;V.length;++ee,V=H,H=[])V.forEach(function(W){W.depth=ee,W.sourceLinks.forEach(function(re){H.indexOf(re.target)<0&&H.push(re.target)})});for(V=Q.nodes,H=[],ee=0;V.length;++ee,V=H,H=[])V.forEach(function(W){W.height=ee,W.targetLinks.forEach(function(re){H.indexOf(re.source)<0&&H.push(re.source)})});var J=(o-u-R)/(ee-1);Q.nodes.forEach(function(W){W.x1=(W.x0=u+Math.max(0,Math.min(ee-1,Math.floor(I.call(null,W,ee))))*J)+R})}function K(Q){var V=P.nest().key(function(Z){return Z.x0}).sortKeys(k.ascending).entries(Q.nodes).map(function(Z){return Z.values});J(),j();for(var H=1,ee=B;ee>0;--ee)re(H*=.99),j(),W(H),j();function J(){var Z=k.max(V,function(ge){return ge.length}),ne=U*(S-h)/(Z-1);z>ne&&(z=ne);var le=k.min(V,function(ge){return(S-h-(ge.length-1)*z)/k.sum(ge,s)});V.forEach(function(ge){ge.forEach(function(pe,xe){pe.y1=(pe.y0=xe)+pe.value*le})}),Q.links.forEach(function(ge){ge.width=ge.value*le})}function W(Z){V.forEach(function(ne){ne.forEach(function(le){if(le.targetLinks.length){var ge=(k.sum(le.targetLinks,x)/k.sum(le.targetLinks,s)-m(le))*Z;le.y0+=ge,le.y1+=ge}})})}function re(Z){V.slice().reverse().forEach(function(ne){ne.forEach(function(le){if(le.sourceLinks.length){var ge=(k.sum(le.sourceLinks,M)/k.sum(le.sourceLinks,s)-m(le))*Z;le.y0+=ge,le.y1+=ge}})})}function j(){V.forEach(function(Z){var ne,le,ge=h,pe=Z.length,xe;for(Z.sort(d),xe=0;xe<pe;++xe)ne=Z[xe],le=ge-ne.y0,le>0&&(ne.y0+=le,ne.y1+=le),ge=ne.y1+z;if(le=ge-z-S,le>0)for(ge=ne.y0-=le,ne.y1-=le,xe=pe-2;xe>=0;--xe)ne=Z[xe],le=ne.y1+z-ge,le>0&&(ne.y0-=le,ne.y1-=le),ge=ne.y0})}}function G(Q){Q.nodes.forEach(function(V){V.sourceLinks.sort(r),V.targetLinks.sort(n)}),Q.nodes.forEach(function(V){var H=V.y0,ee=H;V.sourceLinks.forEach(function(J){J.y0=H+J.width/2,H+=J.width}),V.targetLinks.forEach(function(J){J.y1=ee+J.width/2,ee+=J.width})})}return X};function w(u){return[u.source.x1,u.y0]}function A(u){return[u.target.x0,u.y1]}var f=function(){return E.linkHorizontal().source(w).target(A)};b.sankey=T,b.sankeyCenter=t,b.sankeyLeft=p,b.sankeyRight=g,b.sankeyJustify=a,b.sankeyLinkHorizontal=f,Object.defineProperty(b,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(c,ae,ie){(function(){var b={version:"3.8.0"},k=[].slice,P=function(ue){return k.call(ue)},E=self.document;function e(ue){return ue&&(ue.ownerDocument||ue.document||ue).documentElement}function p(ue){return ue&&(ue.ownerDocument&&ue.ownerDocument.defaultView||ue.document&&ue||ue.defaultView)}if(E)try{P(E.documentElement.childNodes)[0].nodeType}catch{P=function(_e){for(var Ce=_e.length,Be=new Array(Ce);Ce--;)Be[Ce]=_e[Ce];return Be}}if(Date.now||(Date.now=function(){return+new Date}),E)try{E.createElement("DIV").style.setProperty("opacity",0,"")}catch{var g=this.Element.prototype,a=g.setAttribute,t=g.setAttributeNS,i=this.CSSStyleDeclaration.prototype,n=i.setProperty;g.setAttribute=function(_e,Ce){a.call(this,_e,Ce+"")},g.setAttributeNS=function(_e,Ce,Be){t.call(this,_e,Ce,Be+"")},i.setProperty=function(_e,Ce,Be){n.call(this,_e,Ce+"",Be)}}b.ascending=r;function r(ue,_e){return ue<_e?-1:ue>_e?1:ue>=_e?0:NaN}b.descending=function(ue,_e){return _e<ue?-1:_e>ue?1:_e>=ue?0:NaN},b.min=function(ue,_e){var Ce=-1,Be=ue.length,Ge,He;if(arguments.length===1){for(;++Ce<Be;)if((He=ue[Ce])!=null&&He>=He){Ge=He;break}for(;++Ce<Be;)(He=ue[Ce])!=null&&Ge>He&&(Ge=He)}else{for(;++Ce<Be;)if((He=_e.call(ue,ue[Ce],Ce))!=null&&He>=He){Ge=He;break}for(;++Ce<Be;)(He=_e.call(ue,ue[Ce],Ce))!=null&&Ge>He&&(Ge=He)}return Ge},b.max=function(ue,_e){var Ce=-1,Be=ue.length,Ge,He;if(arguments.length===1){for(;++Ce<Be;)if((He=ue[Ce])!=null&&He>=He){Ge=He;break}for(;++Ce<Be;)(He=ue[Ce])!=null&&He>Ge&&(Ge=He)}else{for(;++Ce<Be;)if((He=_e.call(ue,ue[Ce],Ce))!=null&&He>=He){Ge=He;break}for(;++Ce<Be;)(He=_e.call(ue,ue[Ce],Ce))!=null&&He>Ge&&(Ge=He)}return Ge},b.extent=function(ue,_e){var Ce=-1,Be=ue.length,Ge,He,xt;if(arguments.length===1){for(;++Ce<Be;)if((He=ue[Ce])!=null&&He>=He){Ge=xt=He;break}for(;++Ce<Be;)(He=ue[Ce])!=null&&(Ge>He&&(Ge=He),xt<He&&(xt=He))}else{for(;++Ce<Be;)if((He=_e.call(ue,ue[Ce],Ce))!=null&&He>=He){Ge=xt=He;break}for(;++Ce<Be;)(He=_e.call(ue,ue[Ce],Ce))!=null&&(Ge>He&&(Ge=He),xt<He&&(xt=He))}return[Ge,xt]};function d(ue){return ue===null?NaN:+ue}function s(ue){return!isNaN(ue)}b.sum=function(ue,_e){var Ce=0,Be=ue.length,Ge,He=-1;if(arguments.length===1)for(;++He<Be;)s(Ge=+ue[He])&&(Ce+=Ge);else for(;++He<Be;)s(Ge=+_e.call(ue,ue[He],He))&&(Ce+=Ge);return Ce},b.mean=function(ue,_e){var Ce=0,Be=ue.length,Ge,He=-1,xt=Be;if(arguments.length===1)for(;++He<Be;)s(Ge=d(ue[He]))?Ce+=Ge:--xt;else for(;++He<Be;)s(Ge=d(_e.call(ue,ue[He],He)))?Ce+=Ge:--xt;if(xt)return Ce/xt},b.quantile=function(ue,_e){var Ce=(ue.length-1)*_e+1,Be=Math.floor(Ce),Ge=+ue[Be-1],He=Ce-Be;return He?Ge+He*(ue[Be]-Ge):Ge},b.median=function(ue,_e){var Ce=[],Be=ue.length,Ge,He=-1;if(arguments.length===1)for(;++He<Be;)s(Ge=d(ue[He]))&&Ce.push(Ge);else for(;++He<Be;)s(Ge=d(_e.call(ue,ue[He],He)))&&Ce.push(Ge);if(Ce.length)return b.quantile(Ce.sort(r),.5)},b.variance=function(ue,_e){var Ce=ue.length,Be=0,Ge,He,xt=0,ht=-1,Ct=0;if(arguments.length===1)for(;++ht<Ce;)s(Ge=d(ue[ht]))&&(He=Ge-Be,Be+=He/++Ct,xt+=He*(Ge-Be));else for(;++ht<Ce;)s(Ge=d(_e.call(ue,ue[ht],ht)))&&(He=Ge-Be,Be+=He/++Ct,xt+=He*(Ge-Be));if(Ct>1)return xt/(Ct-1)},b.deviation=function(){var ue=b.variance.apply(this,arguments);return ue&&Math.sqrt(ue)};function m(ue){return{left:function(_e,Ce,Be,Ge){for(arguments.length<3&&(Be=0),arguments.length<4&&(Ge=_e.length);Be<Ge;){var He=Be+Ge>>>1;ue(_e[He],Ce)<0?Be=He+1:Ge=He}return Be},right:function(_e,Ce,Be,Ge){for(arguments.length<3&&(Be=0),arguments.length<4&&(Ge=_e.length);Be<Ge;){var He=Be+Ge>>>1;ue(_e[He],Ce)>0?Ge=He:Be=He+1}return Be}}}var x=m(r);b.bisectLeft=x.left,b.bisect=b.bisectRight=x.right,b.bisector=function(ue){return m(ue.length===1?function(_e,Ce){return r(ue(_e),Ce)}:ue)},b.shuffle=function(ue,_e,Ce){(Be=arguments.length)<3&&(Ce=ue.length,Be<2&&(_e=0));for(var Be=Ce-_e,Ge,He;Be;)He=Math.random()*Be--|0,Ge=ue[Be+_e],ue[Be+_e]=ue[He+_e],ue[He+_e]=Ge;return ue},b.permute=function(ue,_e){for(var Ce=_e.length,Be=new Array(Ce);Ce--;)Be[Ce]=ue[_e[Ce]];return Be},b.pairs=function(ue){for(var _e=0,Ce=ue.length-1,Be,Ge=ue[0],He=new Array(Ce<0?0:Ce);_e<Ce;)He[_e]=[Be=Ge,Ge=ue[++_e]];return He},b.transpose=function(ue){if(!(He=ue.length))return[];for(var _e=-1,Ce=b.min(ue,M),Be=new Array(Ce);++_e<Ce;)for(var Ge=-1,He,xt=Be[_e]=new Array(He);++Ge<He;)xt[Ge]=ue[Ge][_e];return Be};function M(ue){return ue.length}b.zip=function(){return b.transpose(arguments)},b.keys=function(ue){var _e=[];for(var Ce in ue)_e.push(Ce);return _e},b.values=function(ue){var _e=[];for(var Ce in ue)_e.push(ue[Ce]);return _e},b.entries=function(ue){var _e=[];for(var Ce in ue)_e.push({key:Ce,value:ue[Ce]});return _e},b.merge=function(ue){for(var _e=ue.length,Ce,Be=-1,Ge=0,He,xt;++Be<_e;)Ge+=ue[Be].length;for(He=new Array(Ge);--_e>=0;)for(xt=ue[_e],Ce=xt.length;--Ce>=0;)He[--Ge]=xt[Ce];return He};var v=Math.abs;b.range=function(ue,_e,Ce){if(arguments.length<3&&(Ce=1,arguments.length<2&&(_e=ue,ue=0)),(_e-ue)/Ce===1/0)throw new Error("infinite range");var Be=[],Ge=_(v(Ce)),He=-1,xt;if(ue*=Ge,_e*=Ge,Ce*=Ge,Ce<0)for(;(xt=ue+Ce*++He)>_e;)Be.push(xt/Ge);else for(;(xt=ue+Ce*++He)<_e;)Be.push(xt/Ge);return Be};function _(ue){for(var _e=1;ue*_e%1;)_e*=10;return _e}function l(ue,_e){for(var Ce in _e)Object.defineProperty(ue.prototype,Ce,{value:_e[Ce],enumerable:!1})}b.map=function(ue,_e){var Ce=new y;if(ue instanceof y)ue.forEach(function(ht,Ct){Ce.set(ht,Ct)});else if(Array.isArray(ue)){var Be=-1,Ge=ue.length,He;if(arguments.length===1)for(;++Be<Ge;)Ce.set(Be,ue[Be]);else for(;++Be<Ge;)Ce.set(_e.call(ue,He=ue[Be],Be),He)}else for(var xt in ue)Ce.set(xt,ue[xt]);return Ce};function y(){this._=Object.create(null)}var T="__proto__",w="\0";l(y,{has:u,get:function(ue){return this._[A(ue)]},set:function(ue,_e){return this._[A(ue)]=_e},remove:h,keys:o,values:function(){var ue=[];for(var _e in this._)ue.push(this._[_e]);return ue},entries:function(){var ue=[];for(var _e in this._)ue.push({key:f(_e),value:this._[_e]});return ue},size:S,empty:R,forEach:function(ue){for(var _e in this._)ue.call(this,f(_e),this._[_e])}});function A(ue){return(ue+="")===T||ue[0]===w?w+ue:ue}function f(ue){return(ue+="")[0]===w?ue.slice(1):ue}function u(ue){return A(ue)in this._}function h(ue){return(ue=A(ue))in this._&&delete this._[ue]}function o(){var ue=[];for(var _e in this._)ue.push(f(_e));return ue}function S(){var ue=0;for(var _e in this._)++ue;return ue}function R(){for(var ue in this._)return!1;return!0}b.nest=function(){var ue={},_e=[],Ce=[],Be,Ge;function He(ht,Ct,Zt){if(Zt>=_e.length)return Ge?Ge.call(ue,Ct):Be?Ct.sort(Be):Ct;for(var jt=-1,br=Ct.length,xr=_e[Zt++],Wr,tn,Mr,Ir=new y,Xr;++jt<br;)(Xr=Ir.get(Wr=xr(tn=Ct[jt])))?Xr.push(tn):Ir.set(Wr,[tn]);return ht?(tn=ht(),Mr=function(qr,an){tn.set(qr,He(ht,an,Zt))}):(tn={},Mr=function(qr,an){tn[qr]=He(ht,an,Zt)}),Ir.forEach(Mr),tn}function xt(ht,Ct){if(Ct>=_e.length)return ht;var Zt=[],jt=Ce[Ct++];return ht.forEach(function(br,xr){Zt.push({key:br,values:xt(xr,Ct)})}),jt?Zt.sort(function(br,xr){return jt(br.key,xr.key)}):Zt}return ue.map=function(ht,Ct){return He(Ct,ht,0)},ue.entries=function(ht){return xt(He(b.map,ht,0),0)},ue.key=function(ht){return _e.push(ht),ue},ue.sortKeys=function(ht){return Ce[_e.length-1]=ht,ue},ue.sortValues=function(ht){return Be=ht,ue},ue.rollup=function(ht){return Ge=ht,ue},ue},b.set=function(ue){var _e=new z;if(ue)for(var Ce=0,Be=ue.length;Ce<Be;++Ce)_e.add(ue[Ce]);return _e};function z(){this._=Object.create(null)}l(z,{has:u,add:function(ue){return this._[A(ue+="")]=!0,ue},remove:h,values:o,size:S,empty:R,forEach:function(ue){for(var _e in this._)ue.call(this,f(_e))}}),b.behavior={};function O(ue){return ue}b.rebind=function(ue,_e){for(var Ce=1,Be=arguments.length,Ge;++Ce<Be;)ue[Ge=arguments[Ce]]=I(ue,_e,_e[Ge]);return ue};function I(ue,_e,Ce){return function(){var Be=Ce.apply(_e,arguments);return Be===_e?ue:Be}}function F(ue,_e){if(_e in ue)return _e;_e=_e.charAt(0).toUpperCase()+_e.slice(1);for(var Ce=0,Be=D.length;Ce<Be;++Ce){var Ge=D[Ce]+_e;if(Ge in ue)return Ge}}var D=["webkit","ms","moz","Moz","o","O"];function B(){}b.dispatch=function(){for(var ue=new U,_e=-1,Ce=arguments.length;++_e<Ce;)ue[arguments[_e]]=X(ue);return ue};function U(){}U.prototype.on=function(ue,_e){var Ce=ue.indexOf("."),Be="";if(Ce>=0&&(Be=ue.slice(Ce+1),ue=ue.slice(0,Ce)),ue)return arguments.length<2?this[ue].on(Be):this[ue].on(Be,_e);if(arguments.length===2){if(_e==null)for(ue in this)this.hasOwnProperty(ue)&&this[ue].on(Be,null);return this}};function X(ue){var _e=[],Ce=new y;function Be(){for(var Ge=_e,He=-1,xt=Ge.length,ht;++He<xt;)(ht=Ge[He].on)&&ht.apply(this,arguments);return ue}return Be.on=function(Ge,He){var xt=Ce.get(Ge),ht;return arguments.length<2?xt&&xt.on:(xt&&(xt.on=null,_e=_e.slice(0,ht=_e.indexOf(xt)).concat(_e.slice(ht+1)),Ce.remove(Ge)),He&&_e.push(Ce.set(Ge,{on:He})),ue)},Be}b.event=null;function oe(){b.event.preventDefault()}function se(){for(var ue=b.event,_e;_e=ue.sourceEvent;)ue=_e;return ue}function q(ue){for(var _e=new U,Ce=0,Be=arguments.length;++Ce<Be;)_e[arguments[Ce]]=X(_e);return _e.of=function(Ge,He){return function(xt){try{var ht=xt.sourceEvent=b.event;xt.target=ue,b.event=xt,_e[xt.type].apply(Ge,He)}finally{b.event=ht}}},_e}b.requote=function(ue){return ue.replace(K,"\\$&")};var K=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,G={}.__proto__?function(ue,_e){ue.__proto__=_e}:function(ue,_e){for(var Ce in _e)ue[Ce]=_e[Ce]};function Q(ue){return G(ue,J),ue}var V=function(ue,_e){return _e.querySelector(ue)},H=function(ue,_e){return _e.querySelectorAll(ue)},ee=function(ue,_e){var Ce=ue.matches||ue[F(ue,"matchesSelector")];return ee=function(Be,Ge){return Ce.call(Be,Ge)},ee(ue,_e)};typeof Sizzle=="function"&&(V=function(ue,_e){return Sizzle(ue,_e)[0]||null},H=Sizzle,ee=Sizzle.matchesSelector),b.selection=function(){return b.select(E.documentElement)};var J=b.selection.prototype=[];J.select=function(ue){var _e=[],Ce,Be,Ge,He;ue=W(ue);for(var xt=-1,ht=this.length;++xt<ht;){_e.push(Ce=[]),Ce.parentNode=(Ge=this[xt]).parentNode;for(var Ct=-1,Zt=Ge.length;++Ct<Zt;)(He=Ge[Ct])?(Ce.push(Be=ue.call(He,He.__data__,Ct,xt)),Be&&"__data__"in He&&(Be.__data__=He.__data__)):Ce.push(null)}return Q(_e)};function W(ue){return typeof ue=="function"?ue:function(){return V(ue,this)}}J.selectAll=function(ue){var _e=[],Ce,Be;ue=re(ue);for(var Ge=-1,He=this.length;++Ge<He;)for(var xt=this[Ge],ht=-1,Ct=xt.length;++ht<Ct;)(Be=xt[ht])&&(_e.push(Ce=P(ue.call(Be,Be.__data__,ht,Ge))),Ce.parentNode=Be);return Q(_e)};function re(ue){return typeof ue=="function"?ue:function(){return H(ue,this)}}var j="http://www.w3.org/1999/xhtml",Z={svg:"http://www.w3.org/2000/svg",xhtml:j,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};b.ns={prefix:Z,qualify:function(ue){var _e=ue.indexOf(":"),Ce=ue;return _e>=0&&(Ce=ue.slice(0,_e))!=="xmlns"&&(ue=ue.slice(_e+1)),Z.hasOwnProperty(Ce)?{space:Z[Ce],local:ue}:ue}},J.attr=function(ue,_e){if(arguments.length<2){if(typeof ue=="string"){var Ce=this.node();return ue=b.ns.qualify(ue),ue.local?Ce.getAttributeNS(ue.space,ue.local):Ce.getAttribute(ue)}for(_e in ue)this.each(ne(_e,ue[_e]));return this}return this.each(ne(ue,_e))};function ne(ue,_e){ue=b.ns.qualify(ue);function Ce(){this.removeAttribute(ue)}function Be(){this.removeAttributeNS(ue.space,ue.local)}function Ge(){this.setAttribute(ue,_e)}function He(){this.setAttributeNS(ue.space,ue.local,_e)}function xt(){var Ct=_e.apply(this,arguments);Ct==null?this.removeAttribute(ue):this.setAttribute(ue,Ct)}function ht(){var Ct=_e.apply(this,arguments);Ct==null?this.removeAttributeNS(ue.space,ue.local):this.setAttributeNS(ue.space,ue.local,Ct)}return _e==null?ue.local?Be:Ce:typeof _e=="function"?ue.local?ht:xt:ue.local?He:Ge}function le(ue){return ue.trim().replace(/\s+/g," ")}J.classed=function(ue,_e){if(arguments.length<2){if(typeof ue=="string"){var Ce=this.node(),Be=(ue=pe(ue)).length,Ge=-1;if(_e=Ce.classList){for(;++Ge<Be;)if(!_e.contains(ue[Ge]))return!1}else for(_e=Ce.getAttribute("class");++Ge<Be;)if(!ge(ue[Ge]).test(_e))return!1;return!0}for(_e in ue)this.each(xe(_e,ue[_e]));return this}return this.each(xe(ue,_e))};function ge(ue){return new RegExp("(?:^|\\s+)"+b.requote(ue)+"(?:\\s+|$)","g")}function pe(ue){return(ue+"").trim().split(/^|\s+/)}function xe(ue,_e){ue=pe(ue).map(Ee);var Ce=ue.length;function Be(){for(var He=-1;++He<Ce;)ue[He](this,_e)}function Ge(){for(var He=-1,xt=_e.apply(this,arguments);++He<Ce;)ue[He](this,xt)}return typeof _e=="function"?Ge:Be}function Ee(ue){var _e=ge(ue);return function(Ce,Be){if(Ge=Ce.classList)return Be?Ge.add(ue):Ge.remove(ue);var Ge=Ce.getAttribute("class")||"";Be?(_e.lastIndex=0,_e.test(Ge)||Ce.setAttribute("class",le(Ge+" "+ue))):Ce.setAttribute("class",le(Ge.replace(_e," ")))}}J.style=function(ue,_e,Ce){var Be=arguments.length;if(Be<3){if(typeof ue!="string"){Be<2&&(_e="");for(Ce in ue)this.each(Te(Ce,ue[Ce],_e));return this}if(Be<2){var Ge=this.node();return p(Ge).getComputedStyle(Ge,null).getPropertyValue(ue)}Ce=""}return this.each(Te(ue,_e,Ce))};function Te(ue,_e,Ce){function Be(){this.style.removeProperty(ue)}function Ge(){this.style.setProperty(ue,_e,Ce)}function He(){var xt=_e.apply(this,arguments);xt==null?this.style.removeProperty(ue):this.style.setProperty(ue,xt,Ce)}return _e==null?Be:typeof _e=="function"?He:Ge}J.property=function(ue,_e){if(arguments.length<2){if(typeof ue=="string")return this.node()[ue];for(_e in ue)this.each(de(_e,ue[_e]));return this}return this.each(de(ue,_e))};function de(ue,_e){function Ce(){delete this[ue]}function Be(){this[ue]=_e}function Ge(){var He=_e.apply(this,arguments);He==null?delete this[ue]:this[ue]=He}return _e==null?Ce:typeof _e=="function"?Ge:Be}J.text=function(ue){return arguments.length?this.each(typeof ue=="function"?function(){var _e=ue.apply(this,arguments);this.textContent=_e??""}:ue==null?function(){this.textContent=""}:function(){this.textContent=ue}):this.node().textContent},J.html=function(ue){return arguments.length?this.each(typeof ue=="function"?function(){var _e=ue.apply(this,arguments);this.innerHTML=_e??""}:ue==null?function(){this.innerHTML=""}:function(){this.innerHTML=ue}):this.node().innerHTML},J.append=function(ue){return ue=be(ue),this.select(function(){return this.appendChild(ue.apply(this,arguments))})};function be(ue){function _e(){var Be=this.ownerDocument,Ge=this.namespaceURI;return Ge===j&&Be.documentElement.namespaceURI===j?Be.createElement(ue):Be.createElementNS(Ge,ue)}function Ce(){return this.ownerDocument.createElementNS(ue.space,ue.local)}return typeof ue=="function"?ue:(ue=b.ns.qualify(ue)).local?Ce:_e}J.insert=function(ue,_e){return ue=be(ue),_e=W(_e),this.select(function(){return this.insertBefore(ue.apply(this,arguments),_e.apply(this,arguments)||null)})},J.remove=function(){return this.each(Le)};function Le(){var ue=this.parentNode;ue&&ue.removeChild(this)}J.data=function(ue,_e){var Ce=-1,Be=this.length,Ge,He;if(!arguments.length){for(ue=new Array(Be=(Ge=this[0]).length);++Ce<Be;)(He=Ge[Ce])&&(ue[Ce]=He.__data__);return ue}function xt(jt,br){var xr,Wr=jt.length,tn=br.length,Mr=Math.min(Wr,tn),Ir=new Array(tn),Xr=new Array(tn),qr=new Array(Wr),an,Br;if(_e){var In=new y,fa=new Array(Wr),ya;for(xr=-1;++xr<Wr;)(an=jt[xr])&&(In.has(ya=_e.call(an,an.__data__,xr))?qr[xr]=an:In.set(ya,an),fa[xr]=ya);for(xr=-1;++xr<tn;)(an=In.get(ya=_e.call(br,Br=br[xr],xr)))?an!==!0&&(Ir[xr]=an,an.__data__=Br):Xr[xr]=De(Br),In.set(ya,!0);for(xr=-1;++xr<Wr;)xr in fa&&In.get(fa[xr])!==!0&&(qr[xr]=jt[xr])}else{for(xr=-1;++xr<Mr;)an=jt[xr],Br=br[xr],an?(an.__data__=Br,Ir[xr]=an):Xr[xr]=De(Br);for(;xr<tn;++xr)Xr[xr]=De(br[xr]);for(;xr<Wr;++xr)qr[xr]=jt[xr]}Xr.update=Ir,Xr.parentNode=Ir.parentNode=qr.parentNode=jt.parentNode,ht.push(Xr),Ct.push(Ir),Zt.push(qr)}var ht=Qe([]),Ct=Q([]),Zt=Q([]);if(typeof ue=="function")for(;++Ce<Be;)xt(Ge=this[Ce],ue.call(Ge,Ge.parentNode.__data__,Ce));else for(;++Ce<Be;)xt(Ge=this[Ce],ue);return Ct.enter=function(){return ht},Ct.exit=function(){return Zt},Ct};function De(ue){return{__data__:ue}}J.datum=function(ue){return arguments.length?this.property("__data__",ue):this.property("__data__")},J.filter=function(ue){var _e=[],Ce,Be,Ge;typeof ue!="function"&&(ue=ye(ue));for(var He=0,xt=this.length;He<xt;He++){_e.push(Ce=[]),Ce.parentNode=(Be=this[He]).parentNode;for(var ht=0,Ct=Be.length;ht<Ct;ht++)(Ge=Be[ht])&&ue.call(Ge,Ge.__data__,ht,He)&&Ce.push(Ge)}return Q(_e)};function ye(ue){return function(){return ee(this,ue)}}J.order=function(){for(var ue=-1,_e=this.length;++ue<_e;)for(var Ce=this[ue],Be=Ce.length-1,Ge=Ce[Be],He;--Be>=0;)(He=Ce[Be])&&(Ge&&Ge!==He.nextSibling&&Ge.parentNode.insertBefore(He,Ge),Ge=He);return this},J.sort=function(ue){ue=ke.apply(this,arguments);for(var _e=-1,Ce=this.length;++_e<Ce;)this[_e].sort(ue);return this.order()};function ke(ue){return arguments.length||(ue=r),function(_e,Ce){return _e&&Ce?ue(_e.__data__,Ce.__data__):!_e-!Ce}}J.each=function(ue){return Oe(this,function(_e,Ce,Be){ue.call(_e,_e.__data__,Ce,Be)})};function Oe(ue,_e){for(var Ce=0,Be=ue.length;Ce<Be;Ce++)for(var Ge=ue[Ce],He=0,xt=Ge.length,ht;He<xt;He++)(ht=Ge[He])&&_e(ht,He,Ce);return ue}J.call=function(ue){var _e=P(arguments);return ue.apply(_e[0]=this,_e),this},J.empty=function(){return!this.node()},J.node=function(){for(var ue=0,_e=this.length;ue<_e;ue++)for(var Ce=this[ue],Be=0,Ge=Ce.length;Be<Ge;Be++){var He=Ce[Be];if(He)return He}return null},J.size=function(){var ue=0;return Oe(this,function(){++ue}),ue};function Qe(ue){return G(ue,Ve),ue}var Ve=[];b.selection.enter=Qe,b.selection.enter.prototype=Ve,Ve.append=J.append,Ve.empty=J.empty,Ve.node=J.node,Ve.call=J.call,Ve.size=J.size,Ve.select=function(ue){for(var _e=[],Ce,Be,Ge,He,xt,ht=-1,Ct=this.length;++ht<Ct;){Ge=(He=this[ht]).update,_e.push(Ce=[]),Ce.parentNode=He.parentNode;for(var Zt=-1,jt=He.length;++Zt<jt;)(xt=He[Zt])?(Ce.push(Ge[Zt]=Be=ue.call(He.parentNode,xt.__data__,Zt,ht)),Be.__data__=xt.__data__):Ce.push(null)}return Q(_e)},Ve.insert=function(ue,_e){return arguments.length<2&&(_e=Ue(this)),J.insert.call(this,ue,_e)};function Ue(ue){var _e,Ce;return function(Be,Ge,He){var xt=ue[He].update,ht=xt.length,Ct;for(He!=Ce&&(Ce=He,_e=0),Ge>=_e&&(_e=Ge+1);!(Ct=xt[_e])&&++_e<ht;);return Ct}}b.select=function(ue){var _e;return typeof ue=="string"?(_e=[V(ue,E)],_e.parentNode=E.documentElement):(_e=[ue],_e.parentNode=e(ue)),Q([_e])},b.selectAll=function(ue){var _e;return typeof ue=="string"?(_e=P(H(ue,E)),_e.parentNode=E.documentElement):(_e=P(ue),_e.parentNode=null),Q([_e])},J.on=function(ue,_e,Ce){var Be=arguments.length;if(Be<3){if(typeof ue!="string"){Be<2&&(_e=!1);for(Ce in ue)this.each(Ie(Ce,ue[Ce],_e));return this}if(Be<2)return(Be=this.node()["__on"+ue])&&Be._;Ce=!1}return this.each(Ie(ue,_e,Ce))};function Ie(ue,_e,Ce){var Be="__on"+ue,Ge=ue.indexOf("."),He=pt;Ge>0&&(ue=ue.slice(0,Ge));var xt=at.get(ue);xt&&(ue=xt,He=Rt);function ht(){var jt=this[Be];jt&&(this.removeEventListener(ue,jt,jt.$),delete this[Be])}function Ct(){var jt=He(_e,P(arguments));ht.call(this),this.addEventListener(ue,this[Be]=jt,jt.$=Ce),jt._=_e}function Zt(){var jt=new RegExp("^__on([^.]+)"+b.requote(ue)+"$"),br;for(var xr in this)if(br=xr.match(jt)){var Wr=this[xr];this.removeEventListener(br[1],Wr,Wr.$),delete this[xr]}}return Ge?_e?Ct:ht:_e?B:Zt}var at=b.map({mouseenter:"mouseover",mouseleave:"mouseout"});E&&at.forEach(function(ue){"on"+ue in E&&at.remove(ue)});function pt(ue,_e){return function(Ce){var Be=b.event;b.event=Ce,_e[0]=this.__data__;try{ue.apply(this,_e)}finally{b.event=Be}}}function Rt(ue,_e){var Ce=pt(ue,_e);return function(Be){var Ge=this,He=Be.relatedTarget;(!He||He!==Ge&&!(He.compareDocumentPosition(Ge)&8))&&Ce.call(Ge,Be)}}var Mt,It=0;function Bt(ue){var _e=".dragsuppress-"+ ++It,Ce="click"+_e,Be=b.select(p(ue)).on("touchmove"+_e,oe).on("dragstart"+_e,oe).on("selectstart"+_e,oe);if(Mt==null&&(Mt="onselectstart"in ue?!1:F(ue.style,"userSelect")),Mt){var Ge=e(ue).style,He=Ge[Mt];Ge[Mt]="none"}return function(xt){if(Be.on(_e,null),Mt&&(Ge[Mt]=He),xt){var ht=function(){Be.on(Ce,null)};Be.on(Ce,function(){oe(),ht()},!0),setTimeout(ht,0)}}}b.mouse=function(ue){return _t(ue,se())};var St=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function _t(ue,_e){_e.changedTouches&&(_e=_e.changedTouches[0]);var Ce=ue.ownerSVGElement||ue;if(Ce.createSVGPoint){var Be=Ce.createSVGPoint();if(St<0){var Ge=p(ue);if(Ge.scrollX||Ge.scrollY){Ce=b.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var He=Ce[0][0].getScreenCTM();St=!(He.f||He.e),Ce.remove()}}return St?(Be.x=_e.pageX,Be.y=_e.pageY):(Be.x=_e.clientX,Be.y=_e.clientY),Be=Be.matrixTransform(ue.getScreenCTM().inverse()),[Be.x,Be.y]}var xt=ue.getBoundingClientRect();return[_e.clientX-xt.left-ue.clientLeft,_e.clientY-xt.top-ue.clientTop]}b.touch=function(ue,_e,Ce){if(arguments.length<3&&(Ce=_e,_e=se().changedTouches),_e){for(var Be=0,Ge=_e.length,He;Be<Ge;++Be)if((He=_e[Be]).identifier===Ce)return _t(ue,He)}},b.behavior.drag=function(){var ue=q(Ge,"drag","dragstart","dragend"),_e=null,Ce=He(B,b.mouse,p,"mousemove","mouseup"),Be=He(it,b.touch,O,"touchmove","touchend");function Ge(){this.on("mousedown.drag",Ce).on("touchstart.drag",Be)}function He(xt,ht,Ct,Zt,jt){return function(){var br=this,xr=b.event.target.correspondingElement||b.event.target,Wr=br.parentNode,tn=ue.of(br,arguments),Mr=0,Ir=xt(),Xr=".drag"+(Ir==null?"":"-"+Ir),qr,an=b.select(Ct(xr)).on(Zt+Xr,fa).on(jt+Xr,ya),Br=Bt(xr),In=ht(Wr,Ir);_e?(qr=_e.apply(br,arguments),qr=[qr.x-In[0],qr.y-In[1]]):qr=[0,0],tn({type:"dragstart"});function fa(){var da=ht(Wr,Ir),Ca,Ra;!da||(Ca=da[0]-In[0],Ra=da[1]-In[1],Mr|=Ca|Ra,In=da,tn({type:"drag",x:da[0]+qr[0],y:da[1]+qr[1],dx:Ca,dy:Ra}))}function ya(){!ht(Wr,Ir)||(an.on(Zt+Xr,null).on(jt+Xr,null),Br(Mr),tn({type:"dragend"}))}}}return Ge.origin=function(xt){return arguments.length?(_e=xt,Ge):_e},b.rebind(Ge,ue,"on")};function it(){return b.event.changedTouches[0].identifier}b.touches=function(ue,_e){return arguments.length<2&&(_e=se().touches),_e?P(_e).map(function(Ce){var Be=_t(ue,Ce);return Be.identifier=Ce.identifier,Be}):[]};var ct=1e-6,et=ct*ct,Pe=Math.PI,We=2*Pe,je=We-ct,nt=Pe/2,kt=Pe/180,wt=180/Pe;function Vt(ue){return ue>0?1:ue<0?-1:0}function qt(ue,_e,Ce){return(_e[0]-ue[0])*(Ce[1]-ue[1])-(_e[1]-ue[1])*(Ce[0]-ue[0])}function zt(ue){return ue>1?0:ue<-1?Pe:Math.acos(ue)}function Ht(ue){return ue>1?nt:ue<-1?-nt:Math.asin(ue)}function $t(ue){return((ue=Math.exp(ue))-1/ue)/2}function Qt(ue){return((ue=Math.exp(ue))+1/ue)/2}function fr(ue){return((ue=Math.exp(2*ue))-1)/(ue+1)}function jr(ue){return(ue=Math.sin(ue/2))*ue}var cn=Math.SQRT2,Qr=2,lt=4;b.interpolateZoom=function(ue,_e){var Ce=ue[0],Be=ue[1],Ge=ue[2],He=_e[0],xt=_e[1],ht=_e[2],Ct=He-Ce,Zt=xt-Be,jt=Ct*Ct+Zt*Zt,br,xr;if(jt<et)xr=Math.log(ht/Ge)/cn,br=function(qr){return[Ce+qr*Ct,Be+qr*Zt,Ge*Math.exp(cn*qr*xr)]};else{var Wr=Math.sqrt(jt),tn=(ht*ht-Ge*Ge+lt*jt)/(2*Ge*Qr*Wr),Mr=(ht*ht-Ge*Ge-lt*jt)/(2*ht*Qr*Wr),Ir=Math.log(Math.sqrt(tn*tn+1)-tn),Xr=Math.log(Math.sqrt(Mr*Mr+1)-Mr);xr=(Xr-Ir)/cn,br=function(qr){var an=qr*xr,Br=Qt(Ir),In=Ge/(Qr*Wr)*(Br*fr(cn*an+Ir)-$t(Ir));return[Ce+In*Ct,Be+In*Zt,Ge*Br/Qt(cn*an+Ir)]}}return br.duration=xr*1e3,br},b.behavior.zoom=function(){var ue={x:0,y:0,k:1},_e,Ce,Be,Ge=[960,500],He=Gt,xt=250,ht=0,Ct="mousedown.zoom",Zt="mousemove.zoom",jt="mouseup.zoom",br,xr="touchstart.zoom",Wr,tn=q(an,"zoomstart","zoom","zoomend"),Mr,Ir,Xr,qr;Nt||(Nt="onwheel"in E?(Kt=function(){return-b.event.deltaY*(b.event.deltaMode?120:1)},"wheel"):"onmousewheel"in E?(Kt=function(){return b.event.wheelDelta},"mousewheel"):(Kt=function(){return-b.event.detail},"MozMousePixelScroll"));function an(aa){aa.on(Ct,Xa).on(Nt+".zoom",ci).on("dblclick.zoom",ki).on(xr,Ii)}an.event=function(aa){aa.each(function(){var $a=tn.of(this,arguments),si=ue;Zi?b.select(this).transition().each("start.zoom",function(){ue=this.__chart__||{x:0,y:0,k:1},Ra($a)}).tween("zoom:zoom",function(){var Mi=Ge[0],Qi=Ge[1],Hi=Ce?Ce[0]:Mi/2,Bi=Ce?Ce[1]:Qi/2,Ma=b.interpolateZoom([(Hi-ue.x)/ue.k,(Bi-ue.y)/ue.k,Mi/ue.k],[(Hi-si.x)/si.k,(Bi-si.y)/si.k,Mi/si.k]);return function(Ia){var eo=Ma(Ia),bo=Mi/eo[2];this.__chart__=ue={x:Hi-eo[0]*bo,y:Bi-eo[1]*bo,k:bo},ii($a)}}).each("interrupt.zoom",function(){Oa($a)}).each("end.zoom",function(){Oa($a)}):(this.__chart__=ue,Ra($a),ii($a),Oa($a))})},an.translate=function(aa){return arguments.length?(ue={x:+aa[0],y:+aa[1],k:ue.k},Ca(),an):[ue.x,ue.y]},an.scale=function(aa){return arguments.length?(ue={x:ue.x,y:ue.y,k:null},fa(+aa),Ca(),an):ue.k},an.scaleExtent=function(aa){return arguments.length?(He=aa==null?Gt:[+aa[0],+aa[1]],an):He},an.center=function(aa){return arguments.length?(Be=aa&&[+aa[0],+aa[1]],an):Be},an.size=function(aa){return arguments.length?(Ge=aa&&[+aa[0],+aa[1]],an):Ge},an.duration=function(aa){return arguments.length?(xt=+aa,an):xt},an.x=function(aa){return arguments.length?(Ir=aa,Mr=aa.copy(),ue={x:0,y:0,k:1},an):Ir},an.y=function(aa){return arguments.length?(qr=aa,Xr=aa.copy(),ue={x:0,y:0,k:1},an):qr};function Br(aa){return[(aa[0]-ue.x)/ue.k,(aa[1]-ue.y)/ue.k]}function In(aa){return[aa[0]*ue.k+ue.x,aa[1]*ue.k+ue.y]}function fa(aa){ue.k=Math.max(He[0],Math.min(He[1],aa))}function ya(aa,$a){$a=In($a),ue.x+=aa[0]-$a[0],ue.y+=aa[1]-$a[1]}function da(aa,$a,si,Mi){aa.__chart__={x:ue.x,y:ue.y,k:ue.k},fa(Math.pow(2,Mi)),ya(Ce=$a,si),aa=b.select(aa),xt>0&&(aa=aa.transition().duration(xt)),aa.call(an.event)}function Ca(){Ir&&Ir.domain(Mr.range().map(function(aa){return(aa-ue.x)/ue.k}).map(Mr.invert)),qr&&qr.domain(Xr.range().map(function(aa){return(aa-ue.y)/ue.k}).map(Xr.invert))}function Ra(aa){ht++||aa({type:"zoomstart"})}function ii(aa){Ca(),aa({type:"zoom",scale:ue.k,translate:[ue.x,ue.y]})}function Oa(aa){--ht||(aa({type:"zoomend"}),Ce=null)}function Xa(){var aa=this,$a=tn.of(aa,arguments),si=0,Mi=b.select(p(aa)).on(Zt,Bi).on(jt,Ma),Qi=Br(b.mouse(aa)),Hi=Bt(aa);ri.call(aa),Ra($a);function Bi(){si=1,ya(b.mouse(aa),Qi),ii($a)}function Ma(){Mi.on(Zt,null).on(jt,null),Hi(si),Oa($a)}}function Ii(){var aa=this,$a=tn.of(aa,arguments),si={},Mi=0,Qi,Hi=".zoom-"+b.event.changedTouches[0].identifier,Bi="touchmove"+Hi,Ma="touchend"+Hi,Ia=[],eo=b.select(aa),bo=Bt(aa);Yi(),Ra($a),eo.on(Ct,null).on(xr,Yi);function yo(){var Os=b.touches(aa);return Qi=ue.k,Os.forEach(function(Ei){Ei.identifier in si&&(si[Ei.identifier]=Br(Ei))}),Os}function Yi(){var Os=b.event.target;b.select(Os).on(Bi,Fs).on(Ma,Pl),Ia.push(Os);for(var Ei=b.event.changedTouches,qs=0,Jo=Ei.length;qs<Jo;++qs)si[Ei[qs].identifier]=null;var gi=yo(),lo=Date.now();if(gi.length===1){if(lo-Wr<500){var _u=gi[0];da(aa,_u,si[_u.identifier],Math.floor(Math.log(ue.k)/Math.LN2)+1),oe()}Wr=lo}else if(gi.length>1){var _u=gi[0],xl=gi[1],lu=_u[0]-xl[0],Xl=_u[1]-xl[1];Mi=lu*lu+Xl*Xl}}function Fs(){var Os=b.touches(aa),Ei,qs,Jo,gi;ri.call(aa);for(var lo=0,_u=Os.length;lo<_u;++lo,gi=null)if(Jo=Os[lo],gi=si[Jo.identifier]){if(qs)break;Ei=Jo,qs=gi}if(gi){var xl=(xl=Jo[0]-Ei[0])*xl+(xl=Jo[1]-Ei[1])*xl,lu=Mi&&Math.sqrt(xl/Mi);Ei=[(Ei[0]+Jo[0])/2,(Ei[1]+Jo[1])/2],qs=[(qs[0]+gi[0])/2,(qs[1]+gi[1])/2],fa(lu*Qi)}Wr=null,ya(Ei,qs),ii($a)}function Pl(){if(b.event.touches.length){for(var Os=b.event.changedTouches,Ei=0,qs=Os.length;Ei<qs;++Ei)delete si[Os[Ei].identifier];for(var Jo in si)return void yo()}b.selectAll(Ia).on(Hi,null),eo.on(Ct,Xa).on(xr,Ii),bo(),Oa($a)}}function ci(){var aa=tn.of(this,arguments);br?clearTimeout(br):(ri.call(this),_e=Br(Ce=Be||b.mouse(this)),Ra(aa)),br=setTimeout(function(){br=null,Oa(aa)},50),oe(),fa(Math.pow(2,Kt()*.002)*ue.k),ya(Ce,_e),ii(aa)}function ki(){var aa=b.mouse(this),$a=Math.log(ue.k)/Math.LN2;da(this,aa,Br(aa),b.event.shiftKey?Math.ceil($a)-1:Math.floor($a)+1)}return b.rebind(an,tn,"on")};var Gt=[0,1/0],Kt,Nt;b.color=gr;function gr(){}gr.prototype.toString=function(){return this.rgb()+""},b.hsl=tt;function tt(ue,_e,Ce){return this instanceof tt?(this.h=+ue,this.s=+_e,void(this.l=+Ce)):arguments.length<2?ue instanceof tt?new tt(ue.h,ue.s,ue.l):Or(""+ue,zr,tt):new tt(ue,_e,Ce)}var we=tt.prototype=new gr;we.brighter=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new tt(this.h,this.s,this.l/ue)},we.darker=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new tt(this.h,this.s,ue*this.l)},we.rgb=function(){return Me(this.h,this.s,this.l)};function Me(ue,_e,Ce){var Be,Ge;ue=isNaN(ue)?0:(ue%=360)<0?ue+360:ue,_e=isNaN(_e)||_e<0?0:_e>1?1:_e,Ce=Ce<0?0:Ce>1?1:Ce,Ge=Ce<=.5?Ce*(1+_e):Ce+_e-Ce*_e,Be=2*Ce-Ge;function He(ht){return ht>360?ht-=360:ht<0&&(ht+=360),ht<60?Be+(Ge-Be)*ht/60:ht<180?Ge:ht<240?Be+(Ge-Be)*(240-ht)/60:Be}function xt(ht){return Math.round(He(ht)*255)}return new Cr(xt(ue+120),xt(ue),xt(ue-120))}b.hcl=Ne;function Ne(ue,_e,Ce){return this instanceof Ne?(this.h=+ue,this.c=+_e,void(this.l=+Ce)):arguments.length<2?ue instanceof Ne?new Ne(ue.h,ue.c,ue.l):ue instanceof rt?ir(ue.l,ue.a,ue.b):ir((ue=Sr((ue=b.rgb(ue)).r,ue.g,ue.b)).l,ue.a,ue.b):new Ne(ue,_e,Ce)}var Xe=Ne.prototype=new gr;Xe.brighter=function(ue){return new Ne(this.h,this.c,Math.min(100,this.l+Je*(arguments.length?ue:1)))},Xe.darker=function(ue){return new Ne(this.h,this.c,Math.max(0,this.l-Je*(arguments.length?ue:1)))},Xe.rgb=function(){return Ke(this.h,this.c,this.l).rgb()};function Ke(ue,_e,Ce){return isNaN(ue)&&(ue=0),isNaN(_e)&&(_e=0),new rt(Ce,Math.cos(ue*=kt)*_e,Math.sin(ue)*_e)}b.lab=rt;function rt(ue,_e,Ce){return this instanceof rt?(this.l=+ue,this.a=+_e,void(this.b=+Ce)):arguments.length<2?ue instanceof rt?new rt(ue.l,ue.a,ue.b):ue instanceof Ne?Ke(ue.h,ue.c,ue.l):Sr((ue=Cr(ue)).r,ue.g,ue.b):new rt(ue,_e,Ce)}var Je=18,vt=.95047,bt=1,Et=1.08883,Wt=rt.prototype=new gr;Wt.brighter=function(ue){return new rt(Math.min(100,this.l+Je*(arguments.length?ue:1)),this.a,this.b)},Wt.darker=function(ue){return new rt(Math.max(0,this.l-Je*(arguments.length?ue:1)),this.a,this.b)},Wt.rgb=function(){return Ot(this.l,this.a,this.b)};function Ot(ue,_e,Ce){var Be=(ue+16)/116,Ge=Be+_e/500,He=Be-Ce/200;return Ge=vr(Ge)*vt,Be=vr(Be)*bt,He=vr(He)*Et,new Cr(ln(3.2404542*Ge-1.5371385*Be-.4985314*He),ln(-.969266*Ge+1.8760108*Be+.041556*He),ln(.0556434*Ge-.2040259*Be+1.0572252*He))}function ir(ue,_e,Ce){return ue>0?new Ne(Math.atan2(Ce,_e)*wt,Math.sqrt(_e*_e+Ce*Ce),ue):new Ne(NaN,NaN,ue)}function vr(ue){return ue>.206893034?ue*ue*ue:(ue-4/29)/7.787037}function _r(ue){return ue>.008856?Math.pow(ue,1/3):7.787037*ue+4/29}function ln(ue){return Math.round(255*(ue<=.00304?12.92*ue:1.055*Math.pow(ue,1/2.4)-.055))}b.rgb=Cr;function Cr(ue,_e,Ce){return this instanceof Cr?(this.r=~~ue,this.g=~~_e,void(this.b=~~Ce)):arguments.length<2?ue instanceof Cr?new Cr(ue.r,ue.g,ue.b):Or(""+ue,Cr,Me):new Cr(ue,_e,Ce)}function Gr(ue){return new Cr(ue>>16,ue>>8&255,ue&255)}function sn(ue){return Gr(ue)+""}var yr=Cr.prototype=new gr;yr.brighter=function(ue){ue=Math.pow(.7,arguments.length?ue:1);var _e=this.r,Ce=this.g,Be=this.b,Ge=30;return!_e&&!Ce&&!Be?new Cr(Ge,Ge,Ge):(_e&&_e<Ge&&(_e=Ge),Ce&&Ce<Ge&&(Ce=Ge),Be&&Be<Ge&&(Be=Ge),new Cr(Math.min(255,_e/ue),Math.min(255,Ce/ue),Math.min(255,Be/ue)))},yr.darker=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new Cr(ue*this.r,ue*this.g,ue*this.b)},yr.hsl=function(){return zr(this.r,this.g,this.b)},yr.toString=function(){return"#"+mr(this.r)+mr(this.g)+mr(this.b)};function mr(ue){return ue<16?"0"+Math.max(0,ue).toString(16):Math.min(255,ue).toString(16)}function Or(ue,_e,Ce){var Be=0,Ge=0,He=0,xt,ht,Ct;if(xt=/([a-z]+)\((.*)\)/.exec(ue=ue.toLowerCase()),xt)switch(ht=xt[2].split(","),xt[1]){case"hsl":return Ce(parseFloat(ht[0]),parseFloat(ht[1])/100,parseFloat(ht[2])/100);case"rgb":return _e(Lt(ht[0]),Lt(ht[1]),Lt(ht[2]))}return(Ct=Xt.get(ue))?_e(Ct.r,Ct.g,Ct.b):(ue!=null&&ue.charAt(0)==="#"&&!isNaN(Ct=parseInt(ue.slice(1),16))&&(ue.length===4?(Be=(Ct&3840)>>4,Be=Be>>4|Be,Ge=Ct&240,Ge=Ge>>4|Ge,He=Ct&15,He=He<<4|He):ue.length===7&&(Be=(Ct&16711680)>>16,Ge=(Ct&65280)>>8,He=Ct&255)),_e(Be,Ge,He))}function zr(ue,_e,Ce){var Be=Math.min(ue/=255,_e/=255,Ce/=255),Ge=Math.max(ue,_e,Ce),He=Ge-Be,xt,ht,Ct=(Ge+Be)/2;return He?(ht=Ct<.5?He/(Ge+Be):He/(2-Ge-Be),ue==Ge?xt=(_e-Ce)/He+(_e<Ce?6:0):_e==Ge?xt=(Ce-ue)/He+2:xt=(ue-_e)/He+4,xt*=60):(xt=NaN,ht=Ct>0&&Ct<1?0:xt),new tt(xt,ht,Ct)}function Sr(ue,_e,Ce){ue=ot(ue),_e=ot(_e),Ce=ot(Ce);var Be=_r((.4124564*ue+.3575761*_e+.1804375*Ce)/vt),Ge=_r((.2126729*ue+.7151522*_e+.072175*Ce)/bt),He=_r((.0193339*ue+.119192*_e+.9503041*Ce)/Et);return rt(116*Ge-16,500*(Be-Ge),200*(Ge-He))}function ot(ue){return(ue/=255)<=.04045?ue/12.92:Math.pow((ue+.055)/1.055,2.4)}function Lt(ue){var _e=parseFloat(ue);return ue.charAt(ue.length-1)==="%"?Math.round(_e*2.55):_e}var Xt=b.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Xt.forEach(function(ue,_e){Xt.set(ue,Gr(_e))});function tr(ue){return typeof ue=="function"?ue:function(){return ue}}b.functor=tr,b.xhr=Lr(O);function Lr(ue){return function(_e,Ce,Be){return arguments.length===2&&typeof Ce=="function"&&(Be=Ce,Ce=null),Nr(_e,Ce,ue,Be)}}function Nr(ue,_e,Ce,Be){var Ge={},He=b.dispatch("beforesend","progress","load","error"),xt={},ht=new XMLHttpRequest,Ct=null;self.XDomainRequest&&!("withCredentials"in ht)&&/^(http(s)?:)?\/\//.test(ue)&&(ht=new XDomainRequest),"onload"in ht?ht.onload=ht.onerror=Zt:ht.onreadystatechange=function(){ht.readyState>3&&Zt()};function Zt(){var jt=ht.status,br;if(!jt&&Ar(ht)||jt>=200&&jt<300||jt===304){try{br=Ce.call(Ge,ht)}catch(xr){He.error.call(Ge,xr);return}He.load.call(Ge,br)}else He.error.call(Ge,ht)}return ht.onprogress=function(jt){var br=b.event;b.event=jt;try{He.progress.call(Ge,ht)}finally{b.event=br}},Ge.header=function(jt,br){return jt=(jt+"").toLowerCase(),arguments.length<2?xt[jt]:(br==null?delete xt[jt]:xt[jt]=br+"",Ge)},Ge.mimeType=function(jt){return arguments.length?(_e=jt==null?null:jt+"",Ge):_e},Ge.responseType=function(jt){return arguments.length?(Ct=jt,Ge):Ct},Ge.response=function(jt){return Ce=jt,Ge},["get","post"].forEach(function(jt){Ge[jt]=function(){return Ge.send.apply(Ge,[jt].concat(P(arguments)))}}),Ge.send=function(jt,br,xr){if(arguments.length===2&&typeof br=="function"&&(xr=br,br=null),ht.open(jt,ue,!0),_e!=null&&!("accept"in xt)&&(xt.accept=_e+",*/*"),ht.setRequestHeader)for(var Wr in xt)ht.setRequestHeader(Wr,xt[Wr]);return _e!=null&&ht.overrideMimeType&&ht.overrideMimeType(_e),Ct!=null&&(ht.responseType=Ct),xr!=null&&Ge.on("error",xr).on("load",function(tn){xr(null,tn)}),He.beforesend.call(Ge,ht),ht.send(br??null),Ge},Ge.abort=function(){return ht.abort(),Ge},b.rebind(Ge,He,"on"),Be==null?Ge:Ge.get(Rr(Be))}function Rr(ue){return ue.length===1?function(_e,Ce){ue(_e==null?Ce:null)}:ue}function Ar(ue){var _e=ue.responseType;return _e&&_e!=="text"?ue.response:ue.responseText}b.dsv=function(ue,_e){var Ce=new RegExp('["'+ue+`
]`),Be=ue.charCodeAt(0);function Ge(Zt,jt,br){arguments.length<3&&(br=jt,jt=null);var xr=Nr(Zt,_e,jt==null?He:xt(jt),br);return xr.row=function(Wr){return arguments.length?xr.response((jt=Wr)==null?He:xt(Wr)):jt},xr}function He(Zt){return Ge.parse(Zt.responseText)}function xt(Zt){return function(jt){return Ge.parse(jt.responseText,Zt)}}Ge.parse=function(Zt,jt){var br;return Ge.parseRows(Zt,function(xr,Wr){if(br)return br(xr,Wr-1);var tn=function(Mr){for(var Ir={},Xr=xr.length,qr=0;qr<Xr;++qr)Ir[xr[qr]]=Mr[qr];return Ir};br=jt?function(Mr,Ir){return jt(tn(Mr),Ir)}:tn})},Ge.parseRows=function(Zt,jt){var br={},xr={},Wr=[],tn=Zt.length,Mr=0,Ir=0,Xr,qr;function an(){if(Mr>=tn)return xr;if(qr)return qr=!1,br;var In=Mr;if(Zt.charCodeAt(In)===34){for(var fa=In;fa++<tn;)if(Zt.charCodeAt(fa)===34){if(Zt.charCodeAt(fa+1)!==34)break;++fa}Mr=fa+2;var ya=Zt.charCodeAt(fa+1);return ya===13?(qr=!0,Zt.charCodeAt(fa+2)===10&&++Mr):ya===10&&(qr=!0),Zt.slice(In+1,fa).replace(/""/g,'"')}for(;Mr<tn;){var ya=Zt.charCodeAt(Mr++),da=1;if(ya===10)qr=!0;else if(ya===13)qr=!0,Zt.charCodeAt(Mr)===10&&(++Mr,++da);else if(ya!==Be)continue;return Zt.slice(In,Mr-da)}return Zt.slice(In)}for(;(Xr=an())!==xr;){for(var Br=[];Xr!==br&&Xr!==xr;)Br.push(Xr),Xr=an();jt&&(Br=jt(Br,Ir++))==null||Wr.push(Br)}return Wr},Ge.format=function(Zt){if(Array.isArray(Zt[0]))return Ge.formatRows(Zt);var jt=new z,br=[];return Zt.forEach(function(xr){for(var Wr in xr)jt.has(Wr)||br.push(jt.add(Wr))}),[br.map(Ct).join(ue)].concat(Zt.map(function(xr){return br.map(function(Wr){return Ct(xr[Wr])}).join(ue)})).join(`
`)},Ge.formatRows=function(Zt){return Zt.map(ht).join(`
`)};function ht(Zt){return Zt.map(Ct).join(ue)}function Ct(Zt){return Ce.test(Zt)?'"'+Zt.replace(/\"/g,'""')+'"':Zt}return Ge},b.csv=b.dsv(",","text/csv"),b.tsv=b.dsv("	","text/tab-separated-values");var Kr,Dn,Sn,Jn,Bn=this[F(this,"requestAnimationFrame")]||function(ue){setTimeout(ue,17)};b.timer=function(){Xn.apply(this,arguments)};function Xn(ue,_e,Ce){var Be=arguments.length;Be<2&&(_e=0),Be<3&&(Ce=Date.now());var Ge=Ce+_e,He={c:ue,t:Ge,n:null};return Dn?Dn.n=He:Kr=He,Dn=He,Sn||(Jn=clearTimeout(Jn),Sn=1,Bn(ea)),He}function ea(){var ue=ka(),_e=Ya()-ue;_e>24?(isFinite(_e)&&(clearTimeout(Jn),Jn=setTimeout(ea,_e)),Sn=0):(Sn=1,Bn(ea))}b.timer.flush=function(){ka(),Ya()};function ka(){for(var ue=Date.now(),_e=Kr;_e;)ue>=_e.t&&_e.c(ue-_e.t)&&(_e.c=null),_e=_e.n;return ue}function Ya(){for(var ue,_e=Kr,Ce=1/0;_e;)_e.c?(_e.t<Ce&&(Ce=_e.t),_e=(ue=_e).n):_e=ue?ue.n=_e.n:Kr=_e.n;return Dn=ue,Ce}b.round=function(ue,_e){return _e?Math.round(ue*(_e=Math.pow(10,_e)))/_e:Math.round(ue)},b.geom={};function fi(ue){return ue[0]}function pi(ue){return ue[1]}b.geom.hull=function(ue){var _e=fi,Ce=pi;if(arguments.length)return Be(ue);function Be(Ge){if(Ge.length<3)return[];var He=tr(_e),xt=tr(Ce),ht,Ct=Ge.length,Zt=[],jt=[];for(ht=0;ht<Ct;ht++)Zt.push([+He.call(this,Ge[ht],ht),+xt.call(this,Ge[ht],ht),ht]);for(Zt.sort(Ka),ht=0;ht<Ct;ht++)jt.push([Zt[ht][0],-Zt[ht][1]]);var br=hi(Zt),xr=hi(jt),Wr=xr[0]===br[0],tn=xr[xr.length-1]===br[br.length-1],Mr=[];for(ht=br.length-1;ht>=0;--ht)Mr.push(Ge[Zt[br[ht]][2]]);for(ht=+Wr;ht<xr.length-tn;++ht)Mr.push(Ge[Zt[xr[ht]][2]]);return Mr}return Be.x=function(Ge){return arguments.length?(_e=Ge,Be):_e},Be.y=function(Ge){return arguments.length?(Ce=Ge,Be):Ce},Be};function hi(ue){for(var _e=ue.length,Ce=[0,1],Be=2,Ge=2;Ge<_e;Ge++){for(;Be>1&&qt(ue[Ce[Be-2]],ue[Ce[Be-1]],ue[Ge])<=0;)--Be;Ce[Be++]=Ge}return Ce.slice(0,Be)}function Ka(ue,_e){return ue[0]-_e[0]||ue[1]-_e[1]}b.geom.polygon=function(ue){return G(ue,wr),ue};var wr=b.geom.polygon.prototype=[];wr.area=function(){for(var ue=-1,_e=this.length,Ce,Be=this[_e-1],Ge=0;++ue<_e;)Ce=Be,Be=this[ue],Ge+=Ce[1]*Be[0]-Ce[0]*Be[1];return Ge*.5},wr.centroid=function(ue){var _e=-1,Ce=this.length,Be=0,Ge=0,He,xt=this[Ce-1],ht;for(arguments.length||(ue=-1/(6*this.area()));++_e<Ce;)He=xt,xt=this[_e],ht=He[0]*xt[1]-xt[0]*He[1],Be+=(He[0]+xt[0])*ht,Ge+=(He[1]+xt[1])*ht;return[Be*ue,Ge*ue]},wr.clip=function(ue){for(var _e,Ce=Tn(ue),Be=-1,Ge=this.length-Tn(this),He,xt,ht=this[Ge-1],Ct,Zt,jt;++Be<Ge;){for(_e=ue.slice(),ue.length=0,Ct=this[Be],Zt=_e[(xt=_e.length-Ce)-1],He=-1;++He<xt;)jt=_e[He],gn(jt,ht,Ct)?(gn(Zt,ht,Ct)||ue.push(hn(Zt,jt,ht,Ct)),ue.push(jt)):gn(Zt,ht,Ct)&&ue.push(hn(Zt,jt,ht,Ct)),Zt=jt;Ce&&ue.push(ue[0]),ht=Ct}return ue};function gn(ue,_e,Ce){return(Ce[0]-_e[0])*(ue[1]-_e[1])<(Ce[1]-_e[1])*(ue[0]-_e[0])}function hn(ue,_e,Ce,Be){var Ge=ue[0],He=Ce[0],xt=_e[0]-Ge,ht=Be[0]-He,Ct=ue[1],Zt=Ce[1],jt=_e[1]-Ct,br=Be[1]-Zt,xr=(ht*(Ct-Zt)-br*(Ge-He))/(br*xt-ht*jt);return[Ge+xr*xt,Ct+xr*jt]}function Tn(ue){var _e=ue[0],Ce=ue[ue.length-1];return!(_e[0]-Ce[0]||_e[1]-Ce[1])}var Vn,oa,na,On=[],ta,Ua,di=[];function Ft(){So(this),this.edge=this.site=this.circle=null}function cr(ue){var _e=On.pop()||new Ft;return _e.site=ue,_e}function nn(ue){Un(ue),na.remove(ue),On.push(ue),So(ue)}function vn(ue){var _e=ue.circle,Ce=_e.x,Be=_e.cy,Ge={x:Ce,y:Be},He=ue.P,xt=ue.N,ht=[ue];nn(ue);for(var Ct=He;Ct.circle&&v(Ce-Ct.circle.x)<ct&&v(Be-Ct.circle.cy)<ct;)He=Ct.P,ht.unshift(Ct),nn(Ct),Ct=He;ht.unshift(Ct),Un(Ct);for(var Zt=xt;Zt.circle&&v(Ce-Zt.circle.x)<ct&&v(Be-Zt.circle.cy)<ct;)xt=Zt.N,ht.push(Zt),nn(Zt),Zt=xt;ht.push(Zt),Un(Zt);var jt=ht.length,br;for(br=1;br<jt;++br)Zt=ht[br],Ct=ht[br-1],ua(Zt.edge,Ct.site,Zt.site,Ge);Ct=ht[0],Zt=ht[jt-1],Zt.edge=ga(Ct.site,Zt.site,null,Ge),dn(Ct),dn(Zt)}function on(ue){for(var _e=ue.x,Ce=ue.y,Be,Ge,He,xt,ht=na._;ht;)if(He=Cn(ht,Ce)-_e,He>ct)ht=ht.L;else if(xt=_e-_n(ht,Ce),xt>ct){if(!ht.R){Be=ht;break}ht=ht.R}else{He>-ct?(Be=ht.P,Ge=ht):xt>-ct?(Be=ht,Ge=ht.N):Be=Ge=ht;break}var Ct=cr(ue);if(na.insert(Be,Ct),!(!Be&&!Ge)){if(Be===Ge){Un(Be),Ge=cr(Be.site),na.insert(Ct,Ge),Ct.edge=Ge.edge=ga(Be.site,Ct.site),dn(Be),dn(Ge);return}if(!Ge){Ct.edge=ga(Be.site,Ct.site);return}Un(Be),Un(Ge);var Zt=Be.site,jt=Zt.x,br=Zt.y,xr=ue.x-jt,Wr=ue.y-br,tn=Ge.site,Mr=tn.x-jt,Ir=tn.y-br,Xr=2*(xr*Ir-Wr*Mr),qr=xr*xr+Wr*Wr,an=Mr*Mr+Ir*Ir,Br={x:(Ir*qr-Wr*an)/Xr+jt,y:(xr*an-Mr*qr)/Xr+br};ua(Ge.edge,Zt,tn,Br),Ct.edge=ga(Zt,ue,null,Br),Ge.edge=ga(ue,tn,null,Br),dn(Be),dn(Ge)}}function Cn(ue,_e){var Ce=ue.site,Be=Ce.x,Ge=Ce.y,He=Ge-_e;if(!He)return Be;var xt=ue.P;if(!xt)return-1/0;Ce=xt.site;var ht=Ce.x,Ct=Ce.y,Zt=Ct-_e;if(!Zt)return ht;var jt=ht-Be,br=1/He-1/Zt,xr=jt/Zt;return br?(-xr+Math.sqrt(xr*xr-2*br*(jt*jt/(-2*Zt)-Ct+Zt/2+Ge-He/2)))/br+Be:(Be+ht)/2}function _n(ue,_e){var Ce=ue.N;if(Ce)return Cn(Ce,_e);var Be=ue.site;return Be.y===_e?Be.x:1/0}function un(ue){this.site=ue,this.edges=[]}un.prototype.prepare=function(){for(var ue=this.edges,_e=ue.length,Ce;_e--;)Ce=ue[_e].edge,(!Ce.b||!Ce.a)&&ue.splice(_e,1);return ue.sort(pr),ue.length};function dr(ue){for(var _e=ue[0][0],Ce=ue[1][0],Be=ue[0][1],Ge=ue[1][1],He,xt,ht,Ct,Zt=oa,jt=Zt.length,br,xr,Wr,tn,Mr,Ir;jt--;)if(br=Zt[jt],!(!br||!br.prepare()))for(Wr=br.edges,tn=Wr.length,xr=0;xr<tn;)Ir=Wr[xr].end(),ht=Ir.x,Ct=Ir.y,Mr=Wr[++xr%tn].start(),He=Mr.x,xt=Mr.y,(v(ht-He)>ct||v(Ct-xt)>ct)&&(Wr.splice(xr,0,new Aa(wa(br.site,Ir,v(ht-_e)<ct&&Ge-Ct>ct?{x:_e,y:v(He-_e)<ct?xt:Ge}:v(Ct-Ge)<ct&&Ce-ht>ct?{x:v(xt-Ge)<ct?He:Ce,y:Ge}:v(ht-Ce)<ct&&Ct-Be>ct?{x:Ce,y:v(He-Ce)<ct?xt:Be}:v(Ct-Be)<ct&&ht-_e>ct?{x:v(xt-Be)<ct?He:_e,y:Be}:null),br.site,null)),++tn)}function pr(ue,_e){return _e.angle-ue.angle}function Pr(){So(this),this.x=this.y=this.arc=this.site=this.cy=null}function dn(ue){var _e=ue.P,Ce=ue.N;if(!(!_e||!Ce)){var Be=_e.site,Ge=ue.site,He=Ce.site;if(Be!==He){var xt=Ge.x,ht=Ge.y,Ct=Be.x-xt,Zt=Be.y-ht,jt=He.x-xt,Ir=He.y-ht,br=2*(Ct*Ir-Zt*jt);if(!(br>=-et)){var xr=Ct*Ct+Zt*Zt,Wr=jt*jt+Ir*Ir,tn=(Ir*xr-Zt*Wr)/br,Mr=(Ct*Wr-jt*xr)/br,Ir=Mr+ht,Xr=di.pop()||new Pr;Xr.arc=ue,Xr.site=Ge,Xr.x=tn+xt,Xr.y=Ir+Math.sqrt(tn*tn+Mr*Mr),Xr.cy=Ir,ue.circle=Xr;for(var qr=null,an=Ua._;an;)if(Xr.y<an.y||Xr.y===an.y&&Xr.x<=an.x)if(an.L)an=an.L;else{qr=an.P;break}else if(an.R)an=an.R;else{qr=an;break}Ua.insert(qr,Xr),qr||(ta=Xr)}}}}function Un(ue){var _e=ue.circle;_e&&(_e.P||(ta=_e.N),Ua.remove(_e),di.push(_e),So(_e),ue.circle=null)}function ra(ue,_e,Ce,Be){return function(Ge){var He=Ge.a,xt=Ge.b,ht=He.x,Ct=He.y,Zt=xt.x,jt=xt.y,br=0,xr=1,Wr=Zt-ht,tn=jt-Ct,Mr;if(Mr=ue-ht,!(!Wr&&Mr>0)){if(Mr/=Wr,Wr<0){if(Mr<br)return;Mr<xr&&(xr=Mr)}else if(Wr>0){if(Mr>xr)return;Mr>br&&(br=Mr)}if(Mr=Ce-ht,!(!Wr&&Mr<0)){if(Mr/=Wr,Wr<0){if(Mr>xr)return;Mr>br&&(br=Mr)}else if(Wr>0){if(Mr<br)return;Mr<xr&&(xr=Mr)}if(Mr=_e-Ct,!(!tn&&Mr>0)){if(Mr/=tn,tn<0){if(Mr<br)return;Mr<xr&&(xr=Mr)}else if(tn>0){if(Mr>xr)return;Mr>br&&(br=Mr)}if(Mr=Be-Ct,!(!tn&&Mr<0)){if(Mr/=tn,tn<0){if(Mr>xr)return;Mr>br&&(br=Mr)}else if(tn>0){if(Mr<br)return;Mr<xr&&(xr=Mr)}return br>0&&(Ge.a={x:ht+br*Wr,y:Ct+br*tn}),xr<1&&(Ge.b={x:ht+xr*Wr,y:Ct+xr*tn}),Ge}}}}}}function bn(ue){for(var _e=Vn,Ce=ra(ue[0][0],ue[0][1],ue[1][0],ue[1][1]),Be=_e.length,Ge;Be--;)Ge=_e[Be],(!Zn(Ge,ue)||!Ce(Ge)||v(Ge.a.x-Ge.b.x)<ct&&v(Ge.a.y-Ge.b.y)<ct)&&(Ge.a=Ge.b=null,_e.splice(Be,1))}function Zn(ue,_e){var Ce=ue.b;if(Ce)return!0;var Be=ue.a,Ge=_e[0][0],He=_e[1][0],xt=_e[0][1],ht=_e[1][1],Ct=ue.l,Zt=ue.r,jt=Ct.x,br=Ct.y,xr=Zt.x,Wr=Zt.y,tn=(jt+xr)/2,Mr=(br+Wr)/2,Ir,Xr;if(Wr===br){if(tn<Ge||tn>=He)return;if(jt>xr){if(!Be)Be={x:tn,y:xt};else if(Be.y>=ht)return;Ce={x:tn,y:ht}}else{if(!Be)Be={x:tn,y:ht};else if(Be.y<xt)return;Ce={x:tn,y:xt}}}else if(Ir=(jt-xr)/(Wr-br),Xr=Mr-Ir*tn,Ir<-1||Ir>1)if(jt>xr){if(!Be)Be={x:(xt-Xr)/Ir,y:xt};else if(Be.y>=ht)return;Ce={x:(ht-Xr)/Ir,y:ht}}else{if(!Be)Be={x:(ht-Xr)/Ir,y:ht};else if(Be.y<xt)return;Ce={x:(xt-Xr)/Ir,y:xt}}else if(br<Wr){if(!Be)Be={x:Ge,y:Ir*Ge+Xr};else if(Be.x>=He)return;Ce={x:He,y:Ir*He+Xr}}else{if(!Be)Be={x:He,y:Ir*He+Xr};else if(Be.x<Ge)return;Ce={x:Ge,y:Ir*Ge+Xr}}return ue.a=Be,ue.b=Ce,!0}function sa(ue,_e){this.l=ue,this.r=_e,this.a=this.b=null}function ga(ue,_e,Ce,Be){var Ge=new sa(ue,_e);return Vn.push(Ge),Ce&&ua(Ge,ue,_e,Ce),Be&&ua(Ge,_e,ue,Be),oa[ue.i].edges.push(new Aa(Ge,ue,_e)),oa[_e.i].edges.push(new Aa(Ge,_e,ue)),Ge}function wa(ue,_e,Ce){var Be=new sa(ue,null);return Be.a=_e,Be.b=Ce,Vn.push(Be),Be}function ua(ue,_e,Ce,Be){!ue.a&&!ue.b?(ue.a=Be,ue.l=_e,ue.r=Ce):ue.l===Ce?ue.b=Be:ue.a=Be}function Aa(ue,_e,Ce){var Be=ue.a,Ge=ue.b;this.edge=ue,this.site=_e,this.angle=Ce?Math.atan2(Ce.y-_e.y,Ce.x-_e.x):ue.l===_e?Math.atan2(Ge.x-Be.x,Be.y-Ge.y):Math.atan2(Be.x-Ge.x,Ge.y-Be.y)}Aa.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}};function _o(){this._=null}function So(ue){ue.U=ue.C=ue.L=ue.R=ue.P=ue.N=null}_o.prototype={insert:function(ue,_e){var Ce,Be,Ge;if(ue){if(_e.P=ue,_e.N=ue.N,ue.N&&(ue.N.P=_e),ue.N=_e,ue.R){for(ue=ue.R;ue.L;)ue=ue.L;ue.L=_e}else ue.R=_e;Ce=ue}else this._?(ue=Jl(this._),_e.P=null,_e.N=ue,ue.P=ue.L=_e,Ce=ue):(_e.P=_e.N=null,this._=_e,Ce=null);for(_e.L=_e.R=null,_e.U=Ce,_e.C=!0,ue=_e;Ce&&Ce.C;)Be=Ce.U,Ce===Be.L?(Ge=Be.R,Ge&&Ge.C?(Ce.C=Ge.C=!1,Be.C=!0,ue=Be):(ue===Ce.R&&(Fo(this,Ce),ue=Ce,Ce=ue.U),Ce.C=!1,Be.C=!0,cs(this,Be))):(Ge=Be.L,Ge&&Ge.C?(Ce.C=Ge.C=!1,Be.C=!0,ue=Be):(ue===Ce.L&&(cs(this,Ce),ue=Ce,Ce=ue.U),Ce.C=!1,Be.C=!0,Fo(this,Be))),Ce=ue.U;this._.C=!1},remove:function(ue){ue.N&&(ue.N.P=ue.P),ue.P&&(ue.P.N=ue.N),ue.N=ue.P=null;var _e=ue.U,Ce,Be=ue.L,Ge=ue.R,He,xt;if(Be?Ge?He=Jl(Ge):He=Be:He=Ge,_e?_e.L===ue?_e.L=He:_e.R=He:this._=He,Be&&Ge?(xt=He.C,He.C=ue.C,He.L=Be,Be.U=He,He!==Ge?(_e=He.U,He.U=ue.U,ue=He.R,_e.L=ue,He.R=Ge,Ge.U=He):(He.U=_e,_e=He,ue=He.R)):(xt=ue.C,ue=He),ue&&(ue.U=_e),!xt){if(ue&&ue.C){ue.C=!1;return}do{if(ue===this._)break;if(ue===_e.L){if(Ce=_e.R,Ce.C&&(Ce.C=!1,_e.C=!0,Fo(this,_e),Ce=_e.R),Ce.L&&Ce.L.C||Ce.R&&Ce.R.C){(!Ce.R||!Ce.R.C)&&(Ce.L.C=!1,Ce.C=!0,cs(this,Ce),Ce=_e.R),Ce.C=_e.C,_e.C=Ce.R.C=!1,Fo(this,_e),ue=this._;break}}else if(Ce=_e.L,Ce.C&&(Ce.C=!1,_e.C=!0,cs(this,_e),Ce=_e.L),Ce.L&&Ce.L.C||Ce.R&&Ce.R.C){(!Ce.L||!Ce.L.C)&&(Ce.R.C=!1,Ce.C=!0,Fo(this,Ce),Ce=_e.L),Ce.C=_e.C,_e.C=Ce.L.C=!1,cs(this,_e),ue=this._;break}Ce.C=!0,ue=_e,_e=_e.U}while(!ue.C);ue&&(ue.C=!1)}}};function Fo(ue,_e){var Ce=_e,Be=_e.R,Ge=Ce.U;Ge?Ge.L===Ce?Ge.L=Be:Ge.R=Be:ue._=Be,Be.U=Ge,Ce.U=Be,Ce.R=Be.L,Ce.R&&(Ce.R.U=Ce),Be.L=Ce}function cs(ue,_e){var Ce=_e,Be=_e.L,Ge=Ce.U;Ge?Ge.L===Ce?Ge.L=Be:Ge.R=Be:ue._=Be,Be.U=Ge,Ce.U=Be,Ce.L=Be.R,Ce.L&&(Ce.L.U=Ce),Be.R=Ce}function Jl(ue){for(;ue.L;)ue=ue.L;return ue}function Tl(ue,_e){var Ce=ue.sort(mi).pop(),Be,Ge,He;for(Vn=[],oa=new Array(ue.length),na=new _o,Ua=new _o;;)if(He=ta,Ce&&(!He||Ce.y<He.y||Ce.y===He.y&&Ce.x<He.x))(Ce.x!==Be||Ce.y!==Ge)&&(oa[Ce.i]=new un(Ce),on(Ce),Be=Ce.x,Ge=Ce.y),Ce=ue.pop();else if(He)vn(He.arc);else break;_e&&(bn(_e),dr(_e));var xt={cells:oa,edges:Vn};return na=Ua=Vn=oa=null,xt}function mi(ue,_e){return _e.y-ue.y||_e.x-ue.x}b.geom.voronoi=function(ue){var _e=fi,Ce=pi,Be=_e,Ge=Ce,He=hs;if(ue)return xt(ue);function xt(Ct){var Zt=new Array(Ct.length),jt=He[0][0],br=He[0][1],xr=He[1][0],Wr=He[1][1];return Tl(ht(Ct),He).cells.forEach(function(tn,Mr){var Ir=tn.edges,Xr=tn.site,qr=Zt[Mr]=Ir.length?Ir.map(function(an){var Br=an.start();return[Br.x,Br.y]}):Xr.x>=jt&&Xr.x<=xr&&Xr.y>=br&&Xr.y<=Wr?[[jt,Wr],[xr,Wr],[xr,br],[jt,br]]:[];qr.point=Ct[Mr]}),Zt}function ht(Ct){return Ct.map(function(Zt,jt){return{x:Math.round(Be(Zt,jt)/ct)*ct,y:Math.round(Ge(Zt,jt)/ct)*ct,i:jt}})}return xt.links=function(Ct){return Tl(ht(Ct)).edges.filter(function(Zt){return Zt.l&&Zt.r}).map(function(Zt){return{source:Ct[Zt.l.i],target:Ct[Zt.r.i]}})},xt.triangles=function(Ct){var Zt=[];return Tl(ht(Ct)).cells.forEach(function(jt,br){for(var xr=jt.site,Wr=jt.edges.sort(pr),tn=-1,Mr=Wr.length,Ir,Xr,qr=Wr[Mr-1].edge,an=qr.l===xr?qr.r:qr.l;++tn<Mr;)Ir=qr,Xr=an,qr=Wr[tn].edge,an=qr.l===xr?qr.r:qr.l,br<Xr.i&&br<an.i&&Gs(xr,Xr,an)<0&&Zt.push([Ct[br],Ct[Xr.i],Ct[an.i]])}),Zt},xt.x=function(Ct){return arguments.length?(Be=tr(_e=Ct),xt):_e},xt.y=function(Ct){return arguments.length?(Ge=tr(Ce=Ct),xt):Ce},xt.clipExtent=function(Ct){return arguments.length?(He=Ct??hs,xt):He===hs?null:He},xt.size=function(Ct){return arguments.length?xt.clipExtent(Ct&&[[0,0],Ct]):He===hs?null:He&&He[1]},xt};var hs=[[-1e6,-1e6],[1e6,1e6]];function Gs(ue,_e,Ce){return(ue.x-Ce.x)*(_e.y-ue.y)-(ue.x-_e.x)*(Ce.y-ue.y)}b.geom.delaunay=function(ue){return b.geom.voronoi().triangles(ue)},b.geom.quadtree=function(ue,_e,Ce,Be,Ge){var He=fi,xt=pi,ht;if(ht=arguments.length)return He=no,xt=ko,ht===3&&(Ge=Ce,Be=_e,Ce=_e=0),Ct(ue);function Ct(Zt){var jt,br=tr(He),xr=tr(xt),Wr,tn,Mr,Ir,Xr,qr,an,Br;if(_e!=null)Xr=_e,qr=Ce,an=Be,Br=Ge;else if(an=Br=-(Xr=qr=1/0),Wr=[],tn=[],Ir=Zt.length,ht)for(Mr=0;Mr<Ir;++Mr)jt=Zt[Mr],jt.x<Xr&&(Xr=jt.x),jt.y<qr&&(qr=jt.y),jt.x>an&&(an=jt.x),jt.y>Br&&(Br=jt.y),Wr.push(jt.x),tn.push(jt.y);else for(Mr=0;Mr<Ir;++Mr){var In=+br(jt=Zt[Mr],Mr),fa=+xr(jt,Mr);In<Xr&&(Xr=In),fa<qr&&(qr=fa),In>an&&(an=In),fa>Br&&(Br=fa),Wr.push(In),tn.push(fa)}var ya=an-Xr,da=Br-qr;ya>da?Br=qr+ya:an=Xr+da;function Ca(Oa,Xa,Ii,ci,ki,aa,$a,si){if(!(isNaN(Ii)||isNaN(ci)))if(Oa.leaf){var Mi=Oa.x,Qi=Oa.y;if(Mi!=null)if(v(Mi-Ii)+v(Qi-ci)<.01)Ra(Oa,Xa,Ii,ci,ki,aa,$a,si);else{var Hi=Oa.point;Oa.x=Oa.y=Oa.point=null,Ra(Oa,Hi,Mi,Qi,ki,aa,$a,si),Ra(Oa,Xa,Ii,ci,ki,aa,$a,si)}else Oa.x=Ii,Oa.y=ci,Oa.point=Xa}else Ra(Oa,Xa,Ii,ci,ki,aa,$a,si)}function Ra(Oa,Xa,Ii,ci,ki,aa,$a,si){var Mi=(ki+$a)*.5,Qi=(aa+si)*.5,Hi=Ii>=Mi,Bi=ci>=Qi,Ma=Bi<<1|Hi;Oa.leaf=!1,Oa=Oa.nodes[Ma]||(Oa.nodes[Ma]=Fl()),Hi?ki=Mi:$a=Mi,Bi?aa=Qi:si=Qi,Ca(Oa,Xa,Ii,ci,ki,aa,$a,si)}var ii=Fl();if(ii.add=function(Oa){Ca(ii,Oa,+br(Oa,++Mr),+xr(Oa,Mr),Xr,qr,an,Br)},ii.visit=function(Oa){Ho(Oa,ii,Xr,qr,an,Br)},ii.find=function(Oa){return ao(ii,Oa[0],Oa[1],Xr,qr,an,Br)},Mr=-1,_e==null){for(;++Mr<Ir;)Ca(ii,Zt[Mr],Wr[Mr],tn[Mr],Xr,qr,an,Br);--Mr}else Zt.forEach(ii.add);return Wr=tn=Zt=jt=null,ii}return Ct.x=function(Zt){return arguments.length?(He=Zt,Ct):He},Ct.y=function(Zt){return arguments.length?(xt=Zt,Ct):xt},Ct.extent=function(Zt){return arguments.length?(Zt==null?_e=Ce=Be=Ge=null:(_e=+Zt[0][0],Ce=+Zt[0][1],Be=+Zt[1][0],Ge=+Zt[1][1]),Ct):_e==null?null:[[_e,Ce],[Be,Ge]]},Ct.size=function(Zt){return arguments.length?(Zt==null?_e=Ce=Be=Ge=null:(_e=Ce=0,Be=+Zt[0],Ge=+Zt[1]),Ct):_e==null?null:[Be-_e,Ge-Ce]},Ct};function no(ue){return ue.x}function ko(ue){return ue.y}function Fl(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Ho(ue,_e,Ce,Be,Ge,He){if(!ue(_e,Ce,Be,Ge,He)){var xt=(Ce+Ge)*.5,ht=(Be+He)*.5,Ct=_e.nodes;Ct[0]&&Ho(ue,Ct[0],Ce,Be,xt,ht),Ct[1]&&Ho(ue,Ct[1],xt,Be,Ge,ht),Ct[2]&&Ho(ue,Ct[2],Ce,ht,xt,He),Ct[3]&&Ho(ue,Ct[3],xt,ht,Ge,He)}}function ao(ue,_e,Ce,Be,Ge,He,xt){var ht=1/0,Ct;return function Zt(jt,br,xr,Wr,tn){if(!(br>He||xr>xt||Wr<Be||tn<Ge)){if(Mr=jt.point){var Mr,Ir=_e-jt.x,Xr=Ce-jt.y,qr=Ir*Ir+Xr*Xr;if(qr<ht){var an=Math.sqrt(ht=qr);Be=_e-an,Ge=Ce-an,He=_e+an,xt=Ce+an,Ct=Mr}}for(var Br=jt.nodes,In=(br+Wr)*.5,fa=(xr+tn)*.5,ya=_e>=In,da=Ce>=fa,Ca=da<<1|ya,Ra=Ca+4;Ca<Ra;++Ca)if(jt=Br[Ca&3])switch(Ca&3){case 0:Zt(jt,br,xr,In,fa);break;case 1:Zt(jt,In,xr,Wr,fa);break;case 2:Zt(jt,br,fa,In,tn);break;case 3:Zt(jt,In,fa,Wr,tn);break}}}(ue,Be,Ge,He,xt),Ct}b.interpolateRgb=Ys;function Ys(ue,_e){ue=b.rgb(ue),_e=b.rgb(_e);var Ce=ue.r,Be=ue.g,Ge=ue.b,He=_e.r-Ce,xt=_e.g-Be,ht=_e.b-Ge;return function(Ct){return"#"+mr(Math.round(Ce+He*Ct))+mr(Math.round(Be+xt*Ct))+mr(Math.round(Ge+ht*Ct))}}b.interpolateObject=io;function io(ue,_e){var Ce={},Be={},Ge;for(Ge in ue)Ge in _e?Ce[Ge]=Go(ue[Ge],_e[Ge]):Be[Ge]=ue[Ge];for(Ge in _e)Ge in ue||(Be[Ge]=_e[Ge]);return function(He){for(Ge in Ce)Be[Ge]=Ce[Ge](He);return Be}}b.interpolateNumber=Si;function Si(ue,_e){return ue=+ue,_e=+_e,function(Ce){return ue*(1-Ce)+_e*Ce}}b.interpolateString=Eo;function Eo(ue,_e){var Ce=oo.lastIndex=$o.lastIndex=0,Be,Ge,He,xt=-1,ht=[],Ct=[];for(ue=ue+"",_e=_e+"";(Be=oo.exec(ue))&&(Ge=$o.exec(_e));)(He=Ge.index)>Ce&&(He=_e.slice(Ce,He),ht[xt]?ht[xt]+=He:ht[++xt]=He),(Be=Be[0])===(Ge=Ge[0])?ht[xt]?ht[xt]+=Ge:ht[++xt]=Ge:(ht[++xt]=null,Ct.push({i:xt,x:Si(Be,Ge)})),Ce=$o.lastIndex;return Ce<_e.length&&(He=_e.slice(Ce),ht[xt]?ht[xt]+=He:ht[++xt]=He),ht.length<2?Ct[0]?(_e=Ct[0].x,function(Zt){return _e(Zt)+""}):function(){return _e}:(_e=Ct.length,function(Zt){for(var jt=0,br;jt<_e;++jt)ht[(br=Ct[jt]).i]=br.x(Zt);return ht.join("")})}var oo=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$o=new RegExp(oo.source,"g");b.interpolate=Go;function Go(ue,_e){for(var Ce=b.interpolators.length,Be;--Ce>=0&&!(Be=b.interpolators[Ce](ue,_e)););return Be}b.interpolators=[function(ue,_e){var Ce=typeof _e;return(Ce==="string"?Xt.has(_e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(_e)?Ys:Eo:_e instanceof gr?Ys:Array.isArray(_e)?Al:Ce==="object"&&isNaN(_e)?io:Si)(ue,_e)}],b.interpolateArray=Al;function Al(ue,_e){var Ce=[],Be=[],Ge=ue.length,He=_e.length,xt=Math.min(ue.length,_e.length),ht;for(ht=0;ht<xt;++ht)Ce.push(Go(ue[ht],_e[ht]));for(;ht<Ge;++ht)Be[ht]=ue[ht];for(;ht<He;++ht)Be[ht]=_e[ht];return function(Ct){for(ht=0;ht<xt;++ht)Be[ht]=Ce[ht](Ct);return Be}}var Yo=function(){return O},Eu=b.map({linear:Yo,poly:Lu,quad:function(){return ws},cubic:function(){return Ol},sin:function(){return Xs},exp:function(){return Bl},circle:function(){return Ts},elastic:Ql,back:il,bounce:function(){return $l}}),Ws=b.map({in:O,out:du,"in-out":_s,"out-in":function(ue){return _s(du(ue))}});b.ease=function(ue){var _e=ue.indexOf("-"),Ce=_e>=0?ue.slice(0,_e):ue,Be=_e>=0?ue.slice(_e+1):"in";return Ce=Eu.get(Ce)||Yo,Be=Ws.get(Be)||O,Co(Be(Ce.apply(null,k.call(arguments,1))))};function Co(ue){return function(_e){return _e<=0?0:_e>=1?1:ue(_e)}}function du(ue){return function(_e){return 1-ue(1-_e)}}function _s(ue){return function(_e){return .5*(_e<.5?ue(2*_e):2-ue(2-2*_e))}}function ws(ue){return ue*ue}function Ol(ue){return ue*ue*ue}function Cu(ue){if(ue<=0)return 0;if(ue>=1)return 1;var _e=ue*ue,Ce=_e*ue;return 4*(ue<.5?Ce:3*(ue-_e)+Ce-.75)}function Lu(ue){return function(_e){return Math.pow(_e,ue)}}function Xs(ue){return 1-Math.cos(ue*nt)}function Bl(ue){return Math.pow(2,10*(ue-1))}function Ts(ue){return 1-Math.sqrt(1-ue*ue)}function Ql(ue,_e){var Ce;return arguments.length<2&&(_e=.45),arguments.length?Ce=_e/We*Math.asin(1/ue):(ue=1,Ce=_e/4),function(Be){return 1+ue*Math.pow(2,-10*Be)*Math.sin((Be-Ce)*We/_e)}}function il(ue){return ue||(ue=1.70158),function(_e){return _e*_e*((ue+1)*_e-ue)}}function $l(ue){return ue<1/2.75?7.5625*ue*ue:ue<2/2.75?7.5625*(ue-=1.5/2.75)*ue+.75:ue<2.5/2.75?7.5625*(ue-=2.25/2.75)*ue+.9375:7.5625*(ue-=2.625/2.75)*ue+.984375}b.interpolateHcl=Pu;function Pu(ue,_e){ue=b.hcl(ue),_e=b.hcl(_e);var Ce=ue.h,Be=ue.c,Ge=ue.l,He=_e.h-Ce,xt=_e.c-Be,ht=_e.l-Ge;return isNaN(xt)&&(xt=0,Be=isNaN(Be)?_e.c:Be),isNaN(He)?(He=0,Ce=isNaN(Ce)?_e.h:Ce):He>180?He-=360:He<-180&&(He+=360),function(Ct){return Ke(Ce+He*Ct,Be+xt*Ct,Ge+ht*Ct)+""}}b.interpolateHsl=ql;function ql(ue,_e){ue=b.hsl(ue),_e=b.hsl(_e);var Ce=ue.h,Be=ue.s,Ge=ue.l,He=_e.h-Ce,xt=_e.s-Be,ht=_e.l-Ge;return isNaN(xt)&&(xt=0,Be=isNaN(Be)?_e.s:Be),isNaN(He)?(He=0,Ce=isNaN(Ce)?_e.h:Ce):He>180?He-=360:He<-180&&(He+=360),function(Ct){return Me(Ce+He*Ct,Be+xt*Ct,Ge+ht*Ct)+""}}b.interpolateLab=Zu;function Zu(ue,_e){ue=b.lab(ue),_e=b.lab(_e);var Ce=ue.l,Be=ue.a,Ge=ue.b,He=_e.l-Ce,xt=_e.a-Be,ht=_e.b-Ge;return function(Ct){return Ot(Ce+He*Ct,Be+xt*Ct,Ge+ht*Ct)+""}}b.interpolateRound=Zs;function Zs(ue,_e){return _e-=ue,function(Ce){return Math.round(ue+_e*Ce)}}b.transform=function(ue){var _e=E.createElementNS(b.ns.prefix.svg,"g");return(b.transform=function(Ce){if(Ce!=null){_e.setAttribute("transform",Ce);var Be=_e.transform.baseVal.consolidate()}return new Nl(Be?Be.matrix:eu)})(ue)};function Nl(ue){var _e=[ue.a,ue.b],Ce=[ue.c,ue.d],Be=ol(_e),Ge=Ml(_e,Ce),He=ol(Sl(Ce,_e,-Ge))||0;_e[0]*Ce[1]<Ce[0]*_e[1]&&(_e[0]*=-1,_e[1]*=-1,Be*=-1,Ge*=-1),this.rotate=(Be?Math.atan2(_e[1],_e[0]):Math.atan2(-Ce[0],Ce[1]))*wt,this.translate=[ue.e,ue.f],this.scale=[Be,He],this.skew=He?Math.atan2(Ge,He)*wt:0}Nl.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};function Ml(ue,_e){return ue[0]*_e[0]+ue[1]*_e[1]}function ol(ue){var _e=Math.sqrt(Ml(ue,ue));return _e&&(ue[0]/=_e,ue[1]/=_e),_e}function Sl(ue,_e,Ce){return ue[0]+=Ce*_e[0],ue[1]+=Ce*_e[1],ue}var eu={a:1,b:0,c:0,d:1,e:0,f:0};b.interpolateTransform=Wo;function js(ue){return ue.length?ue.pop()+",":""}function gu(ue,_e,Ce,Be){if(ue[0]!==_e[0]||ue[1]!==_e[1]){var Ge=Ce.push("translate(",null,",",null,")");Be.push({i:Ge-4,x:Si(ue[0],_e[0])},{i:Ge-2,x:Si(ue[1],_e[1])})}else(_e[0]||_e[1])&&Ce.push("translate("+_e+")")}function tu(ue,_e,Ce,Be){ue!==_e?(ue-_e>180?_e+=360:_e-ue>180&&(ue+=360),Be.push({i:Ce.push(js(Ce)+"rotate(",null,")")-2,x:Si(ue,_e)})):_e&&Ce.push(js(Ce)+"rotate("+_e+")")}function Du(ue,_e,Ce,Be){ue!==_e?Be.push({i:Ce.push(js(Ce)+"skewX(",null,")")-2,x:Si(ue,_e)}):_e&&Ce.push(js(Ce)+"skewX("+_e+")")}function yu(ue,_e,Ce,Be){if(ue[0]!==_e[0]||ue[1]!==_e[1]){var Ge=Ce.push(js(Ce)+"scale(",null,",",null,")");Be.push({i:Ge-4,x:Si(ue[0],_e[0])},{i:Ge-2,x:Si(ue[1],_e[1])})}else(_e[0]!==1||_e[1]!==1)&&Ce.push(js(Ce)+"scale("+_e+")")}function Wo(ue,_e){var Ce=[],Be=[];return ue=b.transform(ue),_e=b.transform(_e),gu(ue.translate,_e.translate,Ce,Be),tu(ue.rotate,_e.rotate,Ce,Be),Du(ue.skew,_e.skew,Ce,Be),yu(ue.scale,_e.scale,Ce,Be),ue=_e=null,function(Ge){for(var He=-1,xt=Be.length,ht;++He<xt;)Ce[(ht=Be[He]).i]=ht.x(Ge);return Ce.join("")}}function kl(ue,_e){return _e=(_e-=ue=+ue)||1/_e,function(Ce){return(Ce-ue)/_e}}function sl(ue,_e){return _e=(_e-=ue=+ue)||1/_e,function(Ce){return Math.max(0,Math.min(1,(Ce-ue)/_e))}}b.layout={},b.layout.bundle=function(){return function(ue){for(var _e=[],Ce=-1,Be=ue.length;++Ce<Be;)_e.push(ru(ue[Ce]));return _e}};function ru(ue){for(var _e=ue.source,Ce=ue.target,Be=Lo(_e,Ce),Ge=[_e];_e!==Be;)_e=_e.parent,Ge.push(_e);for(var He=Ge.length;Ce!==Be;)Ge.splice(He,0,Ce),Ce=Ce.parent;return Ge}function as(ue){for(var _e=[],Ce=ue.parent;Ce!=null;)_e.push(ue),ue=Ce,Ce=Ce.parent;return _e.push(ue),_e}function Lo(ue,_e){if(ue===_e)return ue;for(var Ce=as(ue),Be=as(_e),Ge=Ce.pop(),He=Be.pop(),xt=null;Ge===He;)xt=Ge,Ge=Ce.pop(),He=Be.pop();return xt}b.layout.chord=function(){var ue={},_e,Ce,Be,Ge,He=0,xt,ht,Ct;function Zt(){var br={},xr=[],Wr=b.range(Ge),tn=[],Mr,Ir,Xr,qr,an;for(_e=[],Ce=[],Mr=0,qr=-1;++qr<Ge;){for(Ir=0,an=-1;++an<Ge;)Ir+=Be[qr][an];xr.push(Ir),tn.push(b.range(Ge)),Mr+=Ir}for(xt&&Wr.sort(function(ii,Oa){return xt(xr[ii],xr[Oa])}),ht&&tn.forEach(function(ii,Oa){ii.sort(function(Xa,Ii){return ht(Be[Oa][Xa],Be[Oa][Ii])})}),Mr=(We-He*Ge)/Mr,Ir=0,qr=-1;++qr<Ge;){for(Xr=Ir,an=-1;++an<Ge;){var Br=Wr[qr],In=tn[Br][an],fa=Be[Br][In],ya=Ir,da=Ir+=fa*Mr;br[Br+"-"+In]={index:Br,subindex:In,startAngle:ya,endAngle:da,value:fa}}Ce[Br]={index:Br,startAngle:Xr,endAngle:Ir,value:xr[Br]},Ir+=He}for(qr=-1;++qr<Ge;)for(an=qr-1;++an<Ge;){var Ca=br[qr+"-"+an],Ra=br[an+"-"+qr];(Ca.value||Ra.value)&&_e.push(Ca.value<Ra.value?{source:Ra,target:Ca}:{source:Ca,target:Ra})}Ct&&jt()}function jt(){_e.sort(function(br,xr){return Ct((br.source.value+br.target.value)/2,(xr.source.value+xr.target.value)/2)})}return ue.matrix=function(br){return arguments.length?(Ge=(Be=br)&&Be.length,_e=Ce=null,ue):Be},ue.padding=function(br){return arguments.length?(He=br,_e=Ce=null,ue):He},ue.sortGroups=function(br){return arguments.length?(xt=br,_e=Ce=null,ue):xt},ue.sortSubgroups=function(br){return arguments.length?(ht=br,_e=null,ue):ht},ue.sortChords=function(br){return arguments.length?(Ct=br,_e&&jt(),ue):Ct},ue.chords=function(){return _e||Zt(),_e},ue.groups=function(){return Ce||Zt(),Ce},ue},b.layout.force=function(){var ue={},_e=b.dispatch("start","tick","end"),Ce,Be=[1,1],Ge,He,xt=.9,ht=Ru,Ct=nu,Zt=-30,jt=Iu,br=.1,xr=.64,Wr=[],tn=[],Mr,Ir,Xr;function qr(Br){return function(In,fa,ya,da){if(In.point!==Br){var Ca=In.cx-Br.x,Ra=In.cy-Br.y,ii=da-fa,Oa=Ca*Ca+Ra*Ra;if(ii*ii/xr<Oa){if(Oa<jt){var Xa=In.charge/Oa;Br.px-=Ca*Xa,Br.py-=Ra*Xa}return!0}if(In.point&&Oa&&Oa<jt){var Xa=In.pointCharge/Oa;Br.px-=Ca*Xa,Br.py-=Ra*Xa}}return!In.charge}}ue.tick=function(){if((He*=.99)<.005)return Ce=null,_e.end({type:"end",alpha:He=0}),!0;var Br=Wr.length,In=tn.length,fa,ya,da,Ca,Ra,ii,Oa,Xa,Ii;for(ya=0;ya<In;++ya)da=tn[ya],Ca=da.source,Ra=da.target,Xa=Ra.x-Ca.x,Ii=Ra.y-Ca.y,(ii=Xa*Xa+Ii*Ii)&&(ii=He*Ir[ya]*((ii=Math.sqrt(ii))-Mr[ya])/ii,Xa*=ii,Ii*=ii,Ra.x-=Xa*(Oa=Ca.weight+Ra.weight?Ca.weight/(Ca.weight+Ra.weight):.5),Ra.y-=Ii*Oa,Ca.x+=Xa*(Oa=1-Oa),Ca.y+=Ii*Oa);if((Oa=He*br)&&(Xa=Be[0]/2,Ii=Be[1]/2,ya=-1,Oa))for(;++ya<Br;)da=Wr[ya],da.x+=(Xa-da.x)*Oa,da.y+=(Ii-da.y)*Oa;if(Zt)for(ll(fa=b.geom.quadtree(Wr),He,Xr),ya=-1;++ya<Br;)(da=Wr[ya]).fixed||fa.visit(qr(da));for(ya=-1;++ya<Br;)da=Wr[ya],da.fixed?(da.x=da.px,da.y=da.py):(da.x-=(da.px-(da.px=da.x))*xt,da.y-=(da.py-(da.py=da.y))*xt);_e.tick({type:"tick",alpha:He})},ue.nodes=function(Br){return arguments.length?(Wr=Br,ue):Wr},ue.links=function(Br){return arguments.length?(tn=Br,ue):tn},ue.size=function(Br){return arguments.length?(Be=Br,ue):Be},ue.linkDistance=function(Br){return arguments.length?(ht=typeof Br=="function"?Br:+Br,ue):ht},ue.distance=ue.linkDistance,ue.linkStrength=function(Br){return arguments.length?(Ct=typeof Br=="function"?Br:+Br,ue):Ct},ue.friction=function(Br){return arguments.length?(xt=+Br,ue):xt},ue.charge=function(Br){return arguments.length?(Zt=typeof Br=="function"?Br:+Br,ue):Zt},ue.chargeDistance=function(Br){return arguments.length?(jt=Br*Br,ue):Math.sqrt(jt)},ue.gravity=function(Br){return arguments.length?(br=+Br,ue):br},ue.theta=function(Br){return arguments.length?(xr=Br*Br,ue):Math.sqrt(xr)},ue.alpha=function(Br){return arguments.length?(Br=+Br,He?Br>0?He=Br:(Ce.c=null,Ce.t=NaN,Ce=null,_e.end({type:"end",alpha:He=0})):Br>0&&(_e.start({type:"start",alpha:He=Br}),Ce=Xn(ue.tick)),ue):He},ue.start=function(){var Br,In=Wr.length,fa=tn.length,ya=Be[0],da=Be[1],Ca,Ra;for(Br=0;Br<In;++Br)(Ra=Wr[Br]).index=Br,Ra.weight=0;for(Br=0;Br<fa;++Br)Ra=tn[Br],typeof Ra.source=="number"&&(Ra.source=Wr[Ra.source]),typeof Ra.target=="number"&&(Ra.target=Wr[Ra.target]),++Ra.source.weight,++Ra.target.weight;for(Br=0;Br<In;++Br)Ra=Wr[Br],isNaN(Ra.x)&&(Ra.x=ii("x",ya)),isNaN(Ra.y)&&(Ra.y=ii("y",da)),isNaN(Ra.px)&&(Ra.px=Ra.x),isNaN(Ra.py)&&(Ra.py=Ra.y);if(Mr=[],typeof ht=="function")for(Br=0;Br<fa;++Br)Mr[Br]=+ht.call(this,tn[Br],Br);else for(Br=0;Br<fa;++Br)Mr[Br]=ht;if(Ir=[],typeof Ct=="function")for(Br=0;Br<fa;++Br)Ir[Br]=+Ct.call(this,tn[Br],Br);else for(Br=0;Br<fa;++Br)Ir[Br]=Ct;if(Xr=[],typeof Zt=="function")for(Br=0;Br<In;++Br)Xr[Br]=+Zt.call(this,Wr[Br],Br);else for(Br=0;Br<In;++Br)Xr[Br]=Zt;function ii(Oa,Xa){if(!Ca){for(Ca=new Array(In),ki=0;ki<In;++ki)Ca[ki]=[];for(ki=0;ki<fa;++ki){var Ii=tn[ki];Ca[Ii.source.index].push(Ii.target),Ca[Ii.target.index].push(Ii.source)}}for(var ci=Ca[Br],ki=-1,aa=ci.length,$a;++ki<aa;)if(!isNaN($a=ci[ki][Oa]))return $a;return Math.random()*Xa}return ue.resume()},ue.resume=function(){return ue.alpha(.1)},ue.stop=function(){return ue.alpha(0)},ue.drag=function(){if(Ge||(Ge=b.behavior.drag().origin(O).on("dragstart.force",Ul).on("drag.force",an).on("dragend.force",Ps)),!arguments.length)return Ge;this.on("mouseover.force",As).on("mouseout.force",ho).call(Ge)};function an(Br){Br.px=b.event.x,Br.py=b.event.y,ue.resume()}return b.rebind(ue,_e,"on")};function Ul(ue){ue.fixed|=2}function Ps(ue){ue.fixed&=-7}function As(ue){ue.fixed|=4,ue.px=ue.x,ue.py=ue.y}function ho(ue){ue.fixed&=-5}function ll(ue,_e,Ce){var Be=0,Ge=0;if(ue.charge=0,!ue.leaf)for(var He=ue.nodes,xt=He.length,ht=-1,Ct;++ht<xt;)Ct=He[ht],Ct!=null&&(ll(Ct,_e,Ce),ue.charge+=Ct.charge,Be+=Ct.charge*Ct.cx,Ge+=Ct.charge*Ct.cy);if(ue.point){ue.leaf||(ue.point.x+=Math.random()-.5,ue.point.y+=Math.random()-.5);var Zt=_e*Ce[ue.point.index];ue.charge+=ue.pointCharge=Zt,Be+=Zt*ue.point.x,Ge+=Zt*ue.point.y}ue.cx=Be/ue.charge,ue.cy=Ge/ue.charge}var Ru=20,nu=1,Iu=1/0;b.layout.hierarchy=function(){var ue=zu,_e=El,Ce=ul;function Be(Ge){var He=[Ge],xt=[],ht;for(Ge.depth=0;(ht=He.pop())!=null;)if(xt.push(ht),(Zt=_e.call(Be,ht,ht.depth))&&(Ct=Zt.length)){for(var Ct,Zt,jt;--Ct>=0;)He.push(jt=Zt[Ct]),jt.parent=ht,jt.depth=ht.depth+1;Ce&&(ht.value=0),ht.children=Zt}else Ce&&(ht.value=+Ce.call(Be,ht,ht.depth)||0),delete ht.children;return Xo(Ge,function(br){var xr,Wr;ue&&(xr=br.children)&&xr.sort(ue),Ce&&(Wr=br.parent)&&(Wr.value+=br.value)}),xt}return Be.sort=function(Ge){return arguments.length?(ue=Ge,Be):ue},Be.children=function(Ge){return arguments.length?(_e=Ge,Be):_e},Be.value=function(Ge){return arguments.length?(Ce=Ge,Be):Ce},Be.revalue=function(Ge){return Ce&&(vs(Ge,function(He){He.children&&(He.value=0)}),Xo(Ge,function(He){var xt;He.children||(He.value=+Ce.call(Be,He,He.depth)||0),(xt=He.parent)&&(xt.value+=He.value)})),Ge},Be};function Ms(ue,_e){return b.rebind(ue,_e,"sort","children","value"),ue.nodes=ue,ue.links=is,ue}function vs(ue,_e){for(var Ce=[ue];(ue=Ce.pop())!=null;)if(_e(ue),(Ge=ue.children)&&(Be=Ge.length))for(var Be,Ge;--Be>=0;)Ce.push(Ge[Be])}function Xo(ue,_e){for(var Ce=[ue],Be=[];(ue=Ce.pop())!=null;)if(Be.push(ue),(xt=ue.children)&&(He=xt.length))for(var Ge=-1,He,xt;++Ge<He;)Ce.push(xt[Ge]);for(;(ue=Be.pop())!=null;)_e(ue)}function El(ue){return ue.children}function ul(ue){return ue.value}function zu(ue,_e){return _e.value-ue.value}function is(ue){return b.merge(ue.map(function(_e){return(_e.children||[]).map(function(Ce){return{source:_e,target:Ce}})}))}b.layout.partition=function(){var ue=b.layout.hierarchy(),_e=[1,1];function Ce(He,xt,ht,Ct){var Zt=He.children;if(He.x=xt,He.y=He.depth*Ct,He.dx=ht,He.dy=Ct,Zt&&(br=Zt.length)){var jt=-1,br,xr,Wr;for(ht=He.value?ht/He.value:0;++jt<br;)Ce(xr=Zt[jt],xt,Wr=xr.value*ht,Ct),xt+=Wr}}function Be(He){var xt=He.children,ht=0;if(xt&&(Zt=xt.length))for(var Ct=-1,Zt;++Ct<Zt;)ht=Math.max(ht,Be(xt[Ct]));return 1+ht}function Ge(He,xt){var ht=ue.call(this,He,xt);return Ce(ht[0],0,_e[0],_e[1]/Be(ht[0])),ht}return Ge.size=function(He){return arguments.length?(_e=He,Ge):_e},Ms(Ge,ue)},b.layout.pie=function(){var ue=Number,_e=Fu,Ce=0,Be=We,Ge=0;function He(xt){var ht=xt.length,Ct=xt.map(function(qr,an){return+ue.call(He,qr,an)}),Zt=+(typeof Ce=="function"?Ce.apply(this,arguments):Ce),jt=(typeof Be=="function"?Be.apply(this,arguments):Be)-Zt,br=Math.min(Math.abs(jt)/ht,+(typeof Ge=="function"?Ge.apply(this,arguments):Ge)),xr=br*(jt<0?-1:1),Wr=b.sum(Ct),tn=Wr?(jt-ht*xr)/Wr:0,Mr=b.range(ht),Ir=[],Xr;return _e!=null&&Mr.sort(_e===Fu?function(qr,an){return Ct[an]-Ct[qr]}:function(qr,an){return _e(xt[qr],xt[an])}),Mr.forEach(function(qr){Ir[qr]={data:xt[qr],value:Xr=Ct[qr],startAngle:Zt,endAngle:Zt+=Xr*tn+xr,padAngle:br}}),Ir}return He.value=function(xt){return arguments.length?(ue=xt,He):ue},He.sort=function(xt){return arguments.length?(_e=xt,He):_e},He.startAngle=function(xt){return arguments.length?(Ce=xt,He):Ce},He.endAngle=function(xt){return arguments.length?(Be=xt,He):Be},He.padAngle=function(xt){return arguments.length?(Ge=xt,He):Ge},He};var Fu={};b.layout.stack=function(){var ue=O,_e=Vl,Ce=Hl,Be=iu,Ge=au,He=fl;function xt(ht,Ct){if(!(tn=ht.length))return ht;var Zt=ht.map(function(qr,an){return ue.call(xt,qr,an)}),jt=Zt.map(function(qr){return qr.map(function(an,Br){return[Ge.call(xt,an,Br),He.call(xt,an,Br)]})}),br=_e.call(xt,jt,Ct);Zt=b.permute(Zt,br),jt=b.permute(jt,br);var xr=Ce.call(xt,jt,Ct),Wr=Zt[0].length,tn,Mr,Ir,Xr;for(Ir=0;Ir<Wr;++Ir)for(Be.call(xt,Zt[0][Ir],Xr=xr[Ir],jt[0][Ir][1]),Mr=1;Mr<tn;++Mr)Be.call(xt,Zt[Mr][Ir],Xr+=jt[Mr-1][Ir][1],jt[Mr][Ir][1]);return ht}return xt.values=function(ht){return arguments.length?(ue=ht,xt):ue},xt.order=function(ht){return arguments.length?(_e=typeof ht=="function"?ht:Cl.get(ht)||Vl,xt):_e},xt.offset=function(ht){return arguments.length?(Ce=typeof ht=="function"?ht:Ll.get(ht)||Hl,xt):Ce},xt.x=function(ht){return arguments.length?(Ge=ht,xt):Ge},xt.y=function(ht){return arguments.length?(He=ht,xt):He},xt.out=function(ht){return arguments.length?(Be=ht,xt):Be},xt};function au(ue){return ue.x}function fl(ue){return ue.y}function iu(ue,_e,Ce){ue.y0=_e,ue.y=Ce}var Cl=b.map({"inside-out":function(ue){var _e=ue.length,Ce,Be,Ge=ue.map(ju),He=ue.map(Vi),xt=b.range(_e).sort(function(br,xr){return Ge[br]-Ge[xr]}),ht=0,Ct=0,Zt=[],jt=[];for(Ce=0;Ce<_e;++Ce)Be=xt[Ce],ht<Ct?(ht+=He[Be],Zt.push(Be)):(Ct+=He[Be],jt.push(Be));return jt.reverse().concat(Zt)},reverse:function(ue){return b.range(ue.length).reverse()},default:Vl}),Ll=b.map({silhouette:function(ue){var _e=ue.length,Ce=ue[0].length,Be=[],Ge=0,He,xt,ht,Ct=[];for(xt=0;xt<Ce;++xt){for(He=0,ht=0;He<_e;He++)ht+=ue[He][xt][1];ht>Ge&&(Ge=ht),Be.push(ht)}for(xt=0;xt<Ce;++xt)Ct[xt]=(Ge-Be[xt])/2;return Ct},wiggle:function(ue){var _e=ue.length,Ce=ue[0],Be=Ce.length,Ge,He,xt,ht,Ct,Zt,jt,br,xr,Wr=[];for(Wr[0]=br=xr=0,He=1;He<Be;++He){for(Ge=0,ht=0;Ge<_e;++Ge)ht+=ue[Ge][He][1];for(Ge=0,Ct=0,jt=Ce[He][0]-Ce[He-1][0];Ge<_e;++Ge){for(xt=0,Zt=(ue[Ge][He][1]-ue[Ge][He-1][1])/(2*jt);xt<Ge;++xt)Zt+=(ue[xt][He][1]-ue[xt][He-1][1])/jt;Ct+=Zt*ue[Ge][He][1]}Wr[He]=br-=ht?Ct/ht*jt:0,br<xr&&(xr=br)}for(He=0;He<Be;++He)Wr[He]-=xr;return Wr},expand:function(ue){var _e=ue.length,Ce=ue[0].length,Be=1/_e,Ge,He,xt,ht=[];for(He=0;He<Ce;++He){for(Ge=0,xt=0;Ge<_e;Ge++)xt+=ue[Ge][He][1];if(xt)for(Ge=0;Ge<_e;Ge++)ue[Ge][He][1]/=xt;else for(Ge=0;Ge<_e;Ge++)ue[Ge][He][1]=Be}for(He=0;He<Ce;++He)ht[He]=0;return ht},zero:Hl});function Vl(ue){return b.range(ue.length)}function Hl(ue){for(var _e=-1,Ce=ue[0].length,Be=[];++_e<Ce;)Be[_e]=0;return Be}function ju(ue){for(var _e=1,Ce=0,Be=ue[0][1],Ge,He=ue.length;_e<He;++_e)(Ge=ue[_e][1])>Be&&(Ce=_e,Be=Ge);return Ce}function Vi(ue){return ue.reduce(cl,0)}function cl(ue,_e){return ue+_e[1]}b.layout.histogram=function(){var ue=!0,_e=Number,Ce=ps,Be=Ks;function Ge(He,xr){for(var ht=[],Ct=He.map(_e,this),Zt=Ce.call(this,Ct,xr),jt=Be.call(this,Zt,Ct,xr),br,xr=-1,Wr=Ct.length,tn=jt.length-1,Mr=ue?1:1/Wr,Ir;++xr<tn;)br=ht[xr]=[],br.dx=jt[xr+1]-(br.x=jt[xr]),br.y=0;if(tn>0)for(xr=-1;++xr<Wr;)Ir=Ct[xr],Ir>=Zt[0]&&Ir<=Zt[1]&&(br=ht[b.bisect(jt,Ir,1,tn)-1],br.y+=Mr,br.push(He[xr]));return ht}return Ge.value=function(He){return arguments.length?(_e=He,Ge):_e},Ge.range=function(He){return arguments.length?(Ce=tr(He),Ge):Ce},Ge.bins=function(He){return arguments.length?(Be=typeof He=="number"?function(xt){return os(xt,He)}:tr(He),Ge):Be},Ge.frequency=function(He){return arguments.length?(ue=!!He,Ge):ue},Ge};function Ks(ue,_e){return os(ue,Math.ceil(Math.log(_e.length)/Math.LN2+1))}function os(ue,_e){for(var Ce=-1,Be=+ue[0],Ge=(ue[1]-Be)/_e,He=[];++Ce<=_e;)He[Ce]=Ge*Ce+Be;return He}function ps(ue){return[b.min(ue),b.max(ue)]}b.layout.pack=function(){var ue=b.layout.hierarchy().sort(Gl),_e=0,Ce=[1,1],Be;function Ge(He,xt){var ht=ue.call(this,He,xt),Ct=ht[0],Zt=Ce[0],jt=Ce[1],br=Be==null?Math.sqrt:typeof Be=="function"?Be:function(){return Be};if(Ct.x=Ct.y=0,Xo(Ct,function(Wr){Wr.r=+br(Wr.value)}),Xo(Ct,Ds),_e){var xr=_e*(Be?1:Math.max(2*Ct.r/Zt,2*Ct.r/jt))/2;Xo(Ct,function(Wr){Wr.r+=xr}),Xo(Ct,Ds),Xo(Ct,function(Wr){Wr.r-=xr})}return ds(Ct,Zt/2,jt/2,Be?1:1/Math.max(2*Ct.r/Zt,2*Ct.r/jt)),ht}return Ge.size=function(He){return arguments.length?(Ce=He,Ge):Ce},Ge.radius=function(He){return arguments.length?(Be=He==null||typeof He=="function"?He:+He,Ge):Be},Ge.padding=function(He){return arguments.length?(_e=+He,Ge):_e},Ms(Ge,ue)};function Gl(ue,_e){return ue.value-_e.value}function co(ue,_e){var Ce=ue._pack_next;ue._pack_next=_e,_e._pack_prev=ue,_e._pack_next=Ce,Ce._pack_prev=_e}function ou(ue,_e){ue._pack_next=_e,_e._pack_prev=ue}function qo(ue,_e){var Ce=_e.x-ue.x,Be=_e.y-ue.y,Ge=ue.r+_e.r;return .999*Ge*Ge>Ce*Ce+Be*Be}function Ds(ue){if(!(_e=ue.children)||!(xr=_e.length))return;var _e,Ce=1/0,Be=-1/0,Ge=1/0,He=-1/0,xt,ht,Ct,Zt,jt,br,xr;function Wr(Br){Ce=Math.min(Br.x-Br.r,Ce),Be=Math.max(Br.x+Br.r,Be),Ge=Math.min(Br.y-Br.r,Ge),He=Math.max(Br.y+Br.r,He)}if(_e.forEach(Js),xt=_e[0],xt.x=-xt.r,xt.y=0,Wr(xt),xr>1&&(ht=_e[1],ht.x=ht.r,ht.y=0,Wr(ht),xr>2))for(Ct=_e[2],Ji(xt,ht,Ct),Wr(Ct),co(xt,Ct),xt._pack_prev=Ct,co(Ct,ht),ht=xt._pack_next,Zt=3;Zt<xr;Zt++){Ji(xt,ht,Ct=_e[Zt]);var tn=0,Mr=1,Ir=1;for(jt=ht._pack_next;jt!==ht;jt=jt._pack_next,Mr++)if(qo(jt,Ct)){tn=1;break}if(tn==1)for(br=xt._pack_prev;br!==jt._pack_prev&&!qo(br,Ct);br=br._pack_prev,Ir++);tn?(Mr<Ir||Mr==Ir&&ht.r<xt.r?ou(xt,ht=jt):ou(xt=br,ht),Zt--):(co(xt,Ct),ht=Ct,Wr(Ct))}var Xr=(Ce+Be)/2,qr=(Ge+He)/2,an=0;for(Zt=0;Zt<xr;Zt++)Ct=_e[Zt],Ct.x-=Xr,Ct.y-=qr,an=Math.max(an,Ct.r+Math.sqrt(Ct.x*Ct.x+Ct.y*Ct.y));ue.r=an,_e.forEach(Rs)}function Js(ue){ue._pack_next=ue._pack_prev=ue}function Rs(ue){delete ue._pack_next,delete ue._pack_prev}function ds(ue,_e,Ce,Be){var Ge=ue.children;if(ue.x=_e+=Be*ue.x,ue.y=Ce+=Be*ue.y,ue.r*=Be,Ge)for(var He=-1,xt=Ge.length;++He<xt;)ds(Ge[He],_e,Ce,Be)}function Ji(ue,_e,Ce){var Be=ue.r+Ce.r,Ge=_e.x-ue.x,He=_e.y-ue.y;if(Be&&(Ge||He)){var xt=_e.r+Ce.r,ht=Ge*Ge+He*He;xt*=xt,Be*=Be;var Ct=.5+(Be-xt)/(2*ht),Zt=Math.sqrt(Math.max(0,2*xt*(Be+ht)-(Be-=ht)*Be-xt*xt))/(2*ht);Ce.x=ue.x+Ct*Ge+Zt*He,Ce.y=ue.y+Ct*He-Zt*Ge}else Ce.x=ue.x+Be,Ce.y=ue.y}b.layout.tree=function(){var ue=b.layout.hierarchy().sort(null).value(null),_e=wo,Ce=[1,1],Be=null;function Ge(jt,br){var xr=ue.call(this,jt,br),Wr=xr[0],tn=He(Wr);if(Xo(tn,xt),tn.parent.m=-tn.z,vs(tn,ht),Be)vs(Wr,Zt);else{var Mr=Wr,Ir=Wr,Xr=Wr;vs(Wr,function(In){In.x<Mr.x&&(Mr=In),In.x>Ir.x&&(Ir=In),In.depth>Xr.depth&&(Xr=In)});var qr=_e(Mr,Ir)/2-Mr.x,an=Ce[0]/(Ir.x+_e(Ir,Mr)/2+qr),Br=Ce[1]/(Xr.depth||1);vs(Wr,function(In){In.x=(In.x+qr)*an,In.y=In.depth*Br})}return xr}function He(jt){for(var br={A:null,children:[jt]},xr=[br],Wr;(Wr=xr.pop())!=null;)for(var tn=Wr.children,Mr,Ir=0,Xr=tn.length;Ir<Xr;++Ir)xr.push((tn[Ir]=Mr={_:tn[Ir],parent:Wr,children:(Mr=tn[Ir].children)&&Mr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:Ir}).a=Mr);return br.children[0]}function xt(jt){var br=jt.children,xr=jt.parent.children,Wr=jt.i?xr[jt.i-1]:null;if(br.length){mu(jt);var tn=(br[0].z+br[br.length-1].z)/2;Wr?(jt.z=Wr.z+_e(jt._,Wr._),jt.m=jt.z-tn):jt.z=tn}else Wr&&(jt.z=Wr.z+_e(jt._,Wr._));jt.parent.A=Ct(jt,Wr,jt.parent.A||xr[0])}function ht(jt){jt._.x=jt.z+jt.parent.m,jt.m+=jt.parent.m}function Ct(jt,br,xr){if(br){for(var Wr=jt,tn=jt,Mr=br,Ir=Wr.parent.children[0],Xr=Wr.m,qr=tn.m,an=Mr.m,Br=Ir.m,In;Mr=Yl(Mr),Wr=Zo(Wr),Mr&&Wr;)Ir=Zo(Ir),tn=Yl(tn),tn.a=jt,In=Mr.z+an-Wr.z-Xr+_e(Mr._,Wr._),In>0&&(Wl(gt(Mr,jt,xr),jt,In),Xr+=In,qr+=In),an+=Mr.m,Xr+=Wr.m,Br+=Ir.m,qr+=tn.m;Mr&&!Yl(tn)&&(tn.t=Mr,tn.m+=an-qr),Wr&&!Zo(Ir)&&(Ir.t=Wr,Ir.m+=Xr-Br,xr=jt)}return xr}function Zt(jt){jt.x*=Ce[0],jt.y=jt.depth*Ce[1]}return Ge.separation=function(jt){return arguments.length?(_e=jt,Ge):_e},Ge.size=function(jt){return arguments.length?(Be=(Ce=jt)==null?Zt:null,Ge):Be?null:Ce},Ge.nodeSize=function(jt){return arguments.length?(Be=(Ce=jt)==null?null:Zt,Ge):Be?Ce:null},Ms(Ge,ue)};function wo(ue,_e){return ue.parent==_e.parent?1:2}function Zo(ue){var _e=ue.children;return _e.length?_e[0]:ue.t}function Yl(ue){var _e=ue.children,Ce;return(Ce=_e.length)?_e[Ce-1]:ue.t}function Wl(ue,_e,Ce){var Be=Ce/(_e.i-ue.i);_e.c-=Be,_e.s+=Ce,ue.c+=Be,_e.z+=Ce,_e.m+=Ce}function mu(ue){for(var _e=0,Ce=0,Be=ue.children,Ge=Be.length,He;--Ge>=0;)He=Be[Ge],He.z+=_e,He.m+=_e,_e+=He.s+(Ce+=He.c)}function gt(ue,_e,Ce){return ue.a.parent===_e.parent?ue.a:Ce}b.layout.cluster=function(){var ue=b.layout.hierarchy().sort(null).value(null),_e=wo,Ce=[1,1],Be=!1;function Ge(He,xt){var ht=ue.call(this,He,xt),Ct=ht[0],Zt,jt=0;Xo(Ct,function(Mr){var Ir=Mr.children;Ir&&Ir.length?(Mr.x=or(Ir),Mr.y=Dt(Ir)):(Mr.x=Zt?jt+=_e(Mr,Zt):0,Mr.y=0,Zt=Mr)});var br=er(Ct),xr=Er(Ct),Wr=br.x-_e(br,xr)/2,tn=xr.x+_e(xr,br)/2;return Xo(Ct,Be?function(Mr){Mr.x=(Mr.x-Ct.x)*Ce[0],Mr.y=(Ct.y-Mr.y)*Ce[1]}:function(Mr){Mr.x=(Mr.x-Wr)/(tn-Wr)*Ce[0],Mr.y=(1-(Ct.y?Mr.y/Ct.y:1))*Ce[1]}),ht}return Ge.separation=function(He){return arguments.length?(_e=He,Ge):_e},Ge.size=function(He){return arguments.length?(Be=(Ce=He)==null,Ge):Be?null:Ce},Ge.nodeSize=function(He){return arguments.length?(Be=(Ce=He)!=null,Ge):Be?Ce:null},Ms(Ge,ue)};function Dt(ue){return 1+b.max(ue,function(_e){return _e.y})}function or(ue){return ue.reduce(function(_e,Ce){return _e+Ce.x},0)/ue.length}function er(ue){var _e=ue.children;return _e&&_e.length?er(_e[0]):ue}function Er(ue){var _e=ue.children,Ce;return _e&&(Ce=_e.length)?Er(_e[Ce-1]):ue}b.layout.treemap=function(){var ue=b.layout.hierarchy(),_e=Math.round,Ce=[1,1],Be=null,Ge=en,He=!1,xt,ht="squarify",Ct=.5*(1+Math.sqrt(5));function Zt(Mr,Ir){for(var Xr=-1,qr=Mr.length,an,Br;++Xr<qr;)Br=(an=Mr[Xr]).value*(Ir<0?0:Ir),an.area=isNaN(Br)||Br<=0?0:Br}function jt(Mr){var Ir=Mr.children;if(Ir&&Ir.length){var Xr=Ge(Mr),qr=[],an=Ir.slice(),Br,In=1/0,fa,ya=ht==="slice"?Xr.dx:ht==="dice"?Xr.dy:ht==="slice-dice"?Mr.depth&1?Xr.dy:Xr.dx:Math.min(Xr.dx,Xr.dy),da;for(Zt(an,Xr.dx*Xr.dy/Mr.value),qr.area=0;(da=an.length)>0;)qr.push(Br=an[da-1]),qr.area+=Br.area,ht!=="squarify"||(fa=xr(qr,ya))<=In?(an.pop(),In=fa):(qr.area-=qr.pop().area,Wr(qr,ya,Xr,!1),ya=Math.min(Xr.dx,Xr.dy),qr.length=qr.area=0,In=1/0);qr.length&&(Wr(qr,ya,Xr,!0),qr.length=qr.area=0),Ir.forEach(jt)}}function br(Mr){var Ir=Mr.children;if(Ir&&Ir.length){var Xr=Ge(Mr),qr=Ir.slice(),an,Br=[];for(Zt(qr,Xr.dx*Xr.dy/Mr.value),Br.area=0;an=qr.pop();)Br.push(an),Br.area+=an.area,an.z!=null&&(Wr(Br,an.z?Xr.dx:Xr.dy,Xr,!qr.length),Br.length=Br.area=0);Ir.forEach(br)}}function xr(Mr,Ir){for(var Xr=Mr.area,qr,an=0,Br=1/0,In=-1,fa=Mr.length;++In<fa;)!(qr=Mr[In].area)||(qr<Br&&(Br=qr),qr>an&&(an=qr));return Xr*=Xr,Ir*=Ir,Xr?Math.max(Ir*an*Ct/Xr,Xr/(Ir*Br*Ct)):1/0}function Wr(Mr,Ir,Xr,qr){var an=-1,Br=Mr.length,In=Xr.x,fa=Xr.y,ya=Ir?_e(Mr.area/Ir):0,da;if(Ir==Xr.dx){for((qr||ya>Xr.dy)&&(ya=Xr.dy);++an<Br;)da=Mr[an],da.x=In,da.y=fa,da.dy=ya,In+=da.dx=Math.min(Xr.x+Xr.dx-In,ya?_e(da.area/ya):0);da.z=!0,da.dx+=Xr.x+Xr.dx-In,Xr.y+=ya,Xr.dy-=ya}else{for((qr||ya>Xr.dx)&&(ya=Xr.dx);++an<Br;)da=Mr[an],da.x=In,da.y=fa,da.dx=ya,fa+=da.dy=Math.min(Xr.y+Xr.dy-fa,ya?_e(da.area/ya):0);da.z=!1,da.dy+=Xr.y+Xr.dy-fa,Xr.x+=ya,Xr.dx-=ya}}function tn(Mr){var Ir=xt||ue(Mr),Xr=Ir[0];return Xr.x=Xr.y=0,Xr.value?(Xr.dx=Ce[0],Xr.dy=Ce[1]):Xr.dx=Xr.dy=0,xt&&ue.revalue(Xr),Zt([Xr],Xr.dx*Xr.dy/Xr.value),(xt?br:jt)(Xr),He&&(xt=Ir),Ir}return tn.size=function(Mr){return arguments.length?(Ce=Mr,tn):Ce},tn.padding=function(Mr){if(!arguments.length)return Be;function Ir(an){var Br=Mr.call(tn,an,an.depth);return Br==null?en(an):pn(an,typeof Br=="number"?[Br,Br,Br,Br]:Br)}function Xr(an){return pn(an,Mr)}var qr;return Ge=(Be=Mr)==null?en:(qr=typeof Mr)=="function"?Ir:(qr==="number"&&(Mr=[Mr,Mr,Mr,Mr]),Xr),tn},tn.round=function(Mr){return arguments.length?(_e=Mr?Math.round:Number,tn):_e!=Number},tn.sticky=function(Mr){return arguments.length?(He=Mr,xt=null,tn):He},tn.ratio=function(Mr){return arguments.length?(Ct=Mr,tn):Ct},tn.mode=function(Mr){return arguments.length?(ht=Mr+"",tn):ht},Ms(tn,ue)};function en(ue){return{x:ue.x,y:ue.y,dx:ue.dx,dy:ue.dy}}function pn(ue,_e){var Ce=ue.x+_e[3],Be=ue.y+_e[0],Ge=ue.dx-_e[1]-_e[3],He=ue.dy-_e[0]-_e[2];return Ge<0&&(Ce+=Ge/2,Ge=0),He<0&&(Be+=He/2,He=0),{x:Ce,y:Be,dx:Ge,dy:He}}b.random={normal:function(ue,_e){var Ce=arguments.length;return Ce<2&&(_e=1),Ce<1&&(ue=0),function(){var Be,Ge,He;do Be=Math.random()*2-1,Ge=Math.random()*2-1,He=Be*Be+Ge*Ge;while(!He||He>1);return ue+_e*Be*Math.sqrt(-2*Math.log(He)/He)}},logNormal:function(){var ue=b.random.normal.apply(b,arguments);return function(){return Math.exp(ue())}},bates:function(ue){var _e=b.random.irwinHall(ue);return function(){return _e()/ue}},irwinHall:function(ue){return function(){for(var _e=0,Ce=0;Ce<ue;Ce++)_e+=Math.random();return _e}}},b.scale={};function An(ue){var _e=ue[0],Ce=ue[ue.length-1];return _e<Ce?[_e,Ce]:[Ce,_e]}function Ln(ue){return ue.rangeExtent?ue.rangeExtent():An(ue.range())}function Hn(ue,_e,Ce,Be){var Ge=Ce(ue[0],ue[1]),He=Be(_e[0],_e[1]);return function(xt){return He(Ge(xt))}}function yn(ue,_e){var Ce=0,Be=ue.length-1,Ge=ue[Ce],He=ue[Be],xt;return He<Ge&&(xt=Ce,Ce=Be,Be=xt,xt=Ge,Ge=He,He=xt),ue[Ce]=_e.floor(Ge),ue[Be]=_e.ceil(He),ue}function Fn(ue){return ue?{floor:function(_e){return Math.floor(_e/ue)*ue},ceil:function(_e){return Math.ceil(_e/ue)*ue}}:Pn}var Pn={floor:O,ceil:O};function Gn(ue,_e,Ce,Be){var Ge=[],He=[],xt=0,ht=Math.min(ue.length,_e.length)-1;for(ue[ht]<ue[0]&&(ue=ue.slice().reverse(),_e=_e.slice().reverse());++xt<=ht;)Ge.push(Ce(ue[xt-1],ue[xt])),He.push(Be(_e[xt-1],_e[xt]));return function(Ct){var Zt=b.bisect(ue,Ct,1,ht)-1;return He[Zt](Ge[Zt](Ct))}}b.scale.linear=function(){return $n([0,1],[0,1],Go,!1)};function $n(ue,_e,Ce,Be){var Ge,He;function xt(){var Ct=Math.min(ue.length,_e.length)>2?Gn:Hn,Zt=Be?sl:kl;return Ge=Ct(ue,_e,Zt,Ce),He=Ct(_e,ue,Zt,Go),ht}function ht(Ct){return Ge(Ct)}return ht.invert=function(Ct){return He(Ct)},ht.domain=function(Ct){return arguments.length?(ue=Ct.map(Number),xt()):ue},ht.range=function(Ct){return arguments.length?(_e=Ct,xt()):_e},ht.rangeRound=function(Ct){return ht.range(Ct).interpolate(Zs)},ht.clamp=function(Ct){return arguments.length?(Be=Ct,xt()):Be},ht.interpolate=function(Ct){return arguments.length?(Ce=Ct,xt()):Ce},ht.ticks=function(Ct){return Na(ue,Ct)},ht.tickFormat=function(Ct,Zt){return d3_scale_linearTickFormat(ue,Ct,Zt)},ht.nice=function(Ct){return La(ue,Ct),xt()},ht.copy=function(){return $n(ue,_e,Ce,Be)},xt()}function Ha(ue,_e){return b.rebind(ue,_e,"range","rangeRound","interpolate","clamp")}function La(ue,_e){return yn(ue,Fn(Fa(ue,_e)[2])),yn(ue,Fn(Fa(ue,_e)[2])),ue}function Fa(ue,_e){_e==null&&(_e=10);var Ce=An(ue),Be=Ce[1]-Ce[0],Ge=Math.pow(10,Math.floor(Math.log(Be/_e)/Math.LN10)),He=_e/Be*Ge;return He<=.15?Ge*=10:He<=.35?Ge*=5:He<=.75&&(Ge*=2),Ce[0]=Math.ceil(Ce[0]/Ge)*Ge,Ce[1]=Math.floor(Ce[1]/Ge)*Ge+Ge*.5,Ce[2]=Ge,Ce}function Na(ue,_e){return b.range.apply(b,Fa(ue,_e))}var qn={s:1,g:1,p:1,r:1,e:1};function va(ue){return-Math.floor(Math.log(ue)/Math.LN10+.01)}function ja(ue,_e){var Ce=va(_e[2]);return ue in qn?Math.abs(Ce-va(Math.max(v(_e[0]),v(_e[1]))))+ +(ue!=="e"):Ce-(ue==="%")*2}b.scale.log=function(){return qa(b.scale.linear().domain([0,1]),10,!0,[1,10])};function qa(ue,_e,Ce,Be){function Ge(ht){return(Ce?Math.log(ht<0?0:ht):-Math.log(ht>0?0:-ht))/Math.log(_e)}function He(ht){return Ce?Math.pow(_e,ht):-Math.pow(_e,-ht)}function xt(ht){return ue(Ge(ht))}return xt.invert=function(ht){return He(ue.invert(ht))},xt.domain=function(ht){return arguments.length?(Ce=ht[0]>=0,ue.domain((Be=ht.map(Number)).map(Ge)),xt):Be},xt.base=function(ht){return arguments.length?(_e=+ht,ue.domain(Be.map(Ge)),xt):_e},xt.nice=function(){var ht=yn(Be.map(Ge),Ce?Math:Ti);return ue.domain(ht),Be=ht.map(He),xt},xt.ticks=function(){var ht=An(Be),Ct=[],Zt=ht[0],jt=ht[1],br=Math.floor(Ge(Zt)),xr=Math.ceil(Ge(jt)),Wr=_e%1?2:_e;if(isFinite(xr-br)){if(Ce){for(;br<xr;br++)for(var tn=1;tn<Wr;tn++)Ct.push(He(br)*tn);Ct.push(He(br))}else for(Ct.push(He(br));br++<xr;)for(var tn=Wr-1;tn>0;tn--)Ct.push(He(br)*tn);for(br=0;Ct[br]<Zt;br++);for(xr=Ct.length;Ct[xr-1]>jt;xr--);Ct=Ct.slice(br,xr)}return Ct},xt.copy=function(){return qa(ue.copy(),_e,Ce,Be)},Ha(xt,ue)}var Ti={floor:function(ue){return-Math.ceil(-ue)},ceil:function(ue){return-Math.floor(-ue)}};b.scale.pow=function(){return xi(b.scale.linear(),1,[0,1])};function xi(ue,_e,Ce){var Be=bi(_e),Ge=bi(1/_e);function He(xt){return ue(Be(xt))}return He.invert=function(xt){return Ge(ue.invert(xt))},He.domain=function(xt){return arguments.length?(ue.domain((Ce=xt.map(Number)).map(Be)),He):Ce},He.ticks=function(xt){return Na(Ce,xt)},He.tickFormat=function(xt,ht){return d3_scale_linearTickFormat(Ce,xt,ht)},He.nice=function(xt){return He.domain(La(Ce,xt))},He.exponent=function(xt){return arguments.length?(Be=bi(_e=xt),Ge=bi(1/_e),ue.domain(Ce.map(Be)),He):_e},He.copy=function(){return xi(ue.copy(),_e,Ce)},Ha(He,ue)}function bi(ue){return function(_e){return _e<0?-Math.pow(-_e,ue):Math.pow(_e,ue)}}b.scale.sqrt=function(){return b.scale.pow().exponent(.5)},b.scale.ordinal=function(){return Di([],{t:"range",a:[[]]})};function Di(ue,_e){var Ce,Be,Ge;function He(ht){return Be[((Ce.get(ht)||(_e.t==="range"?Ce.set(ht,ue.push(ht)):NaN))-1)%Be.length]}function xt(ht,Ct){return b.range(ue.length).map(function(Zt){return ht+Ct*Zt})}return He.domain=function(ht){if(!arguments.length)return ue;ue=[],Ce=new y;for(var Ct=-1,Zt=ht.length,jt;++Ct<Zt;)Ce.has(jt=ht[Ct])||Ce.set(jt,ue.push(jt));return He[_e.t].apply(He,_e.a)},He.range=function(ht){return arguments.length?(Be=ht,Ge=0,_e={t:"range",a:arguments},He):Be},He.rangePoints=function(ht,Ct){arguments.length<2&&(Ct=0);var Zt=ht[0],jt=ht[1],br=ue.length<2?(Zt=(Zt+jt)/2,0):(jt-Zt)/(ue.length-1+Ct);return Be=xt(Zt+br*Ct/2,br),Ge=0,_e={t:"rangePoints",a:arguments},He},He.rangeRoundPoints=function(ht,Ct){arguments.length<2&&(Ct=0);var Zt=ht[0],jt=ht[1],br=ue.length<2?(Zt=jt=Math.round((Zt+jt)/2),0):(jt-Zt)/(ue.length-1+Ct)|0;return Be=xt(Zt+Math.round(br*Ct/2+(jt-Zt-(ue.length-1+Ct)*br)/2),br),Ge=0,_e={t:"rangeRoundPoints",a:arguments},He},He.rangeBands=function(ht,Ct,Zt){arguments.length<2&&(Ct=0),arguments.length<3&&(Zt=Ct);var jt=ht[1]<ht[0],br=ht[jt-0],xr=ht[1-jt],Wr=(xr-br)/(ue.length-Ct+2*Zt);return Be=xt(br+Wr*Zt,Wr),jt&&Be.reverse(),Ge=Wr*(1-Ct),_e={t:"rangeBands",a:arguments},He},He.rangeRoundBands=function(ht,Ct,Zt){arguments.length<2&&(Ct=0),arguments.length<3&&(Zt=Ct);var jt=ht[1]<ht[0],br=ht[jt-0],xr=ht[1-jt],Wr=Math.floor((xr-br)/(ue.length-Ct+2*Zt));return Be=xt(br+Math.round((xr-br-(ue.length-Ct)*Wr)/2),Wr),jt&&Be.reverse(),Ge=Math.round(Wr*(1-Ct)),_e={t:"rangeRoundBands",a:arguments},He},He.rangeBand=function(){return Ge},He.rangeExtent=function(){return An(_e.a[0])},He.copy=function(){return Di(ue,_e)},He.domain(ue)}b.scale.category10=function(){return b.scale.ordinal().range(li)},b.scale.category20=function(){return b.scale.ordinal().range(To)},b.scale.category20b=function(){return b.scale.ordinal().range(so)},b.scale.category20c=function(){return b.scale.ordinal().range(ti)};var li=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(sn),To=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(sn),so=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(sn),ti=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(sn);b.scale.quantile=function(){return pa([],[])};function pa(ue,_e){var Ce;function Be(){var He=0,xt=_e.length;for(Ce=[];++He<xt;)Ce[He-1]=b.quantile(ue,He/xt);return Ge}function Ge(He){if(!isNaN(He=+He))return _e[b.bisect(Ce,He)]}return Ge.domain=function(He){return arguments.length?(ue=He.map(d).filter(s).sort(r),Be()):ue},Ge.range=function(He){return arguments.length?(_e=He,Be()):_e},Ge.quantiles=function(){return Ce},Ge.invertExtent=function(He){return He=_e.indexOf(He),He<0?[NaN,NaN]:[He>0?Ce[He-1]:ue[0],He<Ce.length?Ce[He]:ue[ue.length-1]]},Ge.copy=function(){return pa(ue,_e)},Be()}b.scale.quantize=function(){return Ai(0,1,[0,1])};function Ai(ue,_e,Ce){var Be,Ge;function He(ht){return Ce[Math.max(0,Math.min(Ge,Math.floor(Be*(ht-ue))))]}function xt(){return Be=Ce.length/(_e-ue),Ge=Ce.length-1,He}return He.domain=function(ht){return arguments.length?(ue=+ht[0],_e=+ht[ht.length-1],xt()):[ue,_e]},He.range=function(ht){return arguments.length?(Ce=ht,xt()):Ce},He.invertExtent=function(ht){return ht=Ce.indexOf(ht),ht=ht<0?NaN:ht/Be+ue,[ht,ht+1/Be]},He.copy=function(){return Ai(ue,_e,Ce)},xt()}b.scale.threshold=function(){return vo([.5],[0,1])};function vo(ue,_e){function Ce(Be){if(Be<=Be)return _e[b.bisect(ue,Be)]}return Ce.domain=function(Be){return arguments.length?(ue=Be,Ce):ue},Ce.range=function(Be){return arguments.length?(_e=Be,Ce):_e},Ce.invertExtent=function(Be){return Be=_e.indexOf(Be),[ue[Be-1],ue[Be]]},Ce.copy=function(){return vo(ue,_e)},Ce}b.scale.identity=function(){return xo([0,1])};function xo(ue){function _e(Ce){return+Ce}return _e.invert=_e,_e.domain=_e.range=function(Ce){return arguments.length?(ue=Ce.map(_e),_e):ue},_e.ticks=function(Ce){return Na(ue,Ce)},_e.tickFormat=function(Ce,Be){return d3_scale_linearTickFormat(ue,Ce,Be)},_e.copy=function(){return xo(ue)},_e}b.svg={};function ss(){return 0}b.svg.arc=function(){var ue=ls,_e=hl,Ce=ss,Be=Ss,Ge=gs,He=ys,xt=Is;function ht(){var Zt=Math.max(0,+ue.apply(this,arguments)),jt=Math.max(0,+_e.apply(this,arguments)),br=Ge.apply(this,arguments)-nt,xr=He.apply(this,arguments)-nt,Wr=Math.abs(xr-br),tn=br>xr?0:1;if(jt<Zt&&(Mr=jt,jt=Zt,Zt=Mr),Wr>=je)return Ct(jt,tn)+(Zt?Ct(Zt,1-tn):"")+"Z";var Mr,Ir,Xr,qr,an=0,Br=0,In,fa,ya,da,Ca,Ra,ii,Oa,Xa=[];if((qr=(+xt.apply(this,arguments)||0)/2)&&(Xr=Be===Ss?Math.sqrt(Zt*Zt+jt*jt):+Be.apply(this,arguments),tn||(Br*=-1),jt&&(Br=Ht(Xr/jt*Math.sin(qr))),Zt&&(an=Ht(Xr/Zt*Math.sin(qr)))),jt){In=jt*Math.cos(br+Br),fa=jt*Math.sin(br+Br),ya=jt*Math.cos(xr-Br),da=jt*Math.sin(xr-Br);var Ii=Math.abs(xr-br-2*Br)<=Pe?0:1;if(Br&&vl(In,fa,ya,da)===tn^Ii){var ci=(br+xr)/2;In=jt*Math.cos(ci),fa=jt*Math.sin(ci),ya=da=null}}else In=fa=0;if(Zt){Ca=Zt*Math.cos(xr-an),Ra=Zt*Math.sin(xr-an),ii=Zt*Math.cos(br+an),Oa=Zt*Math.sin(br+an);var ki=Math.abs(br-xr+2*an)<=Pe?0:1;if(an&&vl(Ca,Ra,ii,Oa)===1-tn^ki){var aa=(br+xr)/2;Ca=Zt*Math.cos(aa),Ra=Zt*Math.sin(aa),ii=Oa=null}}else Ca=Ra=0;if(Wr>ct&&(Mr=Math.min(Math.abs(jt-Zt)/2,+Ce.apply(this,arguments)))>.001){Ir=Zt<jt^tn?0:1;var $a=Mr,si=Mr;if(Wr<Pe){var Mi=ii==null?[Ca,Ra]:ya==null?[In,fa]:hn([In,fa],[ii,Oa],[ya,da],[Ca,Ra]),Qi=In-Mi[0],Hi=fa-Mi[1],Bi=ya-Mi[0],Ma=da-Mi[1],Ia=1/Math.sin(Math.acos((Qi*Bi+Hi*Ma)/(Math.sqrt(Qi*Qi+Hi*Hi)*Math.sqrt(Bi*Bi+Ma*Ma)))/2),eo=Math.sqrt(Mi[0]*Mi[0]+Mi[1]*Mi[1]);si=Math.min(Mr,(Zt-eo)/(Ia-1)),$a=Math.min(Mr,(jt-eo)/(Ia+1))}if(ya!=null){var bo=pl(ii==null?[Ca,Ra]:[ii,Oa],[In,fa],jt,$a,tn),yo=pl([ya,da],[Ca,Ra],jt,$a,tn);Mr===$a?Xa.push("M",bo[0],"A",$a,",",$a," 0 0,",Ir," ",bo[1],"A",jt,",",jt," 0 ",1-tn^vl(bo[1][0],bo[1][1],yo[1][0],yo[1][1]),",",tn," ",yo[1],"A",$a,",",$a," 0 0,",Ir," ",yo[0]):Xa.push("M",bo[0],"A",$a,",",$a," 0 1,",Ir," ",yo[0])}else Xa.push("M",In,",",fa);if(ii!=null){var Yi=pl([In,fa],[ii,Oa],Zt,-si,tn),Fs=pl([Ca,Ra],ya==null?[In,fa]:[ya,da],Zt,-si,tn);Mr===si?Xa.push("L",Fs[0],"A",si,",",si," 0 0,",Ir," ",Fs[1],"A",Zt,",",Zt," 0 ",tn^vl(Fs[1][0],Fs[1][1],Yi[1][0],Yi[1][1]),",",1-tn," ",Yi[1],"A",si,",",si," 0 0,",Ir," ",Yi[0]):Xa.push("L",Fs[0],"A",si,",",si," 0 0,",Ir," ",Yi[0])}else Xa.push("L",Ca,",",Ra)}else Xa.push("M",In,",",fa),ya!=null&&Xa.push("A",jt,",",jt," 0 ",Ii,",",tn," ",ya,",",da),Xa.push("L",Ca,",",Ra),ii!=null&&Xa.push("A",Zt,",",Zt," 0 ",ki,",",1-tn," ",ii,",",Oa);return Xa.push("Z"),Xa.join("")}function Ct(Zt,jt){return"M0,"+Zt+"A"+Zt+","+Zt+" 0 1,"+jt+" 0,"+-Zt+"A"+Zt+","+Zt+" 0 1,"+jt+" 0,"+Zt}return ht.innerRadius=function(Zt){return arguments.length?(ue=tr(Zt),ht):ue},ht.outerRadius=function(Zt){return arguments.length?(_e=tr(Zt),ht):_e},ht.cornerRadius=function(Zt){return arguments.length?(Ce=tr(Zt),ht):Ce},ht.padRadius=function(Zt){return arguments.length?(Be=Zt==Ss?Ss:tr(Zt),ht):Be},ht.startAngle=function(Zt){return arguments.length?(Ge=tr(Zt),ht):Ge},ht.endAngle=function(Zt){return arguments.length?(He=tr(Zt),ht):He},ht.padAngle=function(Zt){return arguments.length?(xt=tr(Zt),ht):xt},ht.centroid=function(){var Zt=(+ue.apply(this,arguments)+ +_e.apply(this,arguments))/2,jt=(+Ge.apply(this,arguments)+ +He.apply(this,arguments))/2-nt;return[Math.cos(jt)*Zt,Math.sin(jt)*Zt]},ht};var Ss="auto";function ls(ue){return ue.innerRadius}function hl(ue){return ue.outerRadius}function gs(ue){return ue.startAngle}function ys(ue){return ue.endAngle}function Is(ue){return ue&&ue.padAngle}function vl(ue,_e,Ce,Be){return(ue-Ce)*_e-(_e-Be)*ue>0?0:1}function pl(ue,_e,Ce,Be,Ge){var He=ue[0]-_e[0],xt=ue[1]-_e[1],ht=(Ge?Be:-Be)/Math.sqrt(He*He+xt*xt),Ct=ht*xt,Zt=-ht*He,jt=ue[0]+Ct,br=ue[1]+Zt,xr=_e[0]+Ct,Wr=_e[1]+Zt,tn=(jt+xr)/2,Mr=(br+Wr)/2,Ir=xr-jt,Xr=Wr-br,qr=Ir*Ir+Xr*Xr,an=Ce-Be,Br=jt*Wr-xr*br,In=(Xr<0?-1:1)*Math.sqrt(Math.max(0,an*an*qr-Br*Br)),fa=(Br*Xr-Ir*In)/qr,ya=(-Br*Ir-Xr*In)/qr,da=(Br*Xr+Ir*In)/qr,Ca=(-Br*Ir+Xr*In)/qr,Ra=fa-tn,ii=ya-Mr,Oa=da-tn,Xa=Ca-Mr;return Ra*Ra+ii*ii>Oa*Oa+Xa*Xa&&(fa=da,ya=Ca),[[fa-Ct,ya-Zt],[fa*Ce/an,ya*Ce/an]]}function ms(){return!0}function Ou(ue){var _e=fi,Ce=pi,Be=ms,Ge=zs,He=Ge.key,xt=.7;function ht(Ct){var Zt=[],jt=[],br=-1,xr=Ct.length,Wr,tn=tr(_e),Mr=tr(Ce);function Ir(){Zt.push("M",Ge(ue(jt),xt))}for(;++br<xr;)Be.call(this,Wr=Ct[br],br)?jt.push([+tn.call(this,Wr,br),+Mr.call(this,Wr,br)]):jt.length&&(Ir(),jt=[]);return jt.length&&Ir(),Zt.length?Zt.join(""):null}return ht.x=function(Ct){return arguments.length?(_e=Ct,ht):_e},ht.y=function(Ct){return arguments.length?(Ce=Ct,ht):Ce},ht.defined=function(Ct){return arguments.length?(Be=Ct,ht):Be},ht.interpolate=function(Ct){return arguments.length?(typeof Ct=="function"?He=Ge=Ct:He=(Ge=dl.get(Ct)||zs).key,ht):He},ht.tension=function(Ct){return arguments.length?(xt=Ct,ht):xt},ht}b.svg.line=function(){return Ou(O)};var dl=b.map({linear:zs,"linear-closed":xu,step:nf,"step-before":Bu,"step-after":xs,basis:af,"basis-open":su,"basis-closed":Ju,bundle:Qu,cardinal:Uu,"cardinal-open":Ku,"cardinal-closed":Nu,monotone:ar});dl.forEach(function(ue,_e){_e.key=ue,_e.closed=/-closed$/.test(ue)});function zs(ue){return ue.length>1?ue.join("L"):ue+"Z"}function xu(ue){return ue.join("L")+"Z"}function nf(ue){for(var _e=0,Ce=ue.length,Be=ue[0],Ge=[Be[0],",",Be[1]];++_e<Ce;)Ge.push("H",(Be[0]+(Be=ue[_e])[0])/2,"V",Be[1]);return Ce>1&&Ge.push("H",Be[0]),Ge.join("")}function Bu(ue){for(var _e=0,Ce=ue.length,Be=ue[0],Ge=[Be[0],",",Be[1]];++_e<Ce;)Ge.push("V",(Be=ue[_e])[1],"H",Be[0]);return Ge.join("")}function xs(ue){for(var _e=0,Ce=ue.length,Be=ue[0],Ge=[Be[0],",",Be[1]];++_e<Ce;)Ge.push("H",(Be=ue[_e])[0],"V",Be[1]);return Ge.join("")}function Ku(ue,_e){return ue.length<4?zs(ue):ue[1]+yl(ue.slice(1,-1),bu(ue,_e))}function Nu(ue,_e){return ue.length<3?xu(ue):ue[0]+yl((ue.push(ue[0]),ue),bu([ue[ue.length-2]].concat(ue,[ue[1]]),_e))}function Uu(ue,_e){return ue.length<3?zs(ue):ue[0]+yl(ue,bu(ue,_e))}function yl(ue,_e){if(_e.length<1||ue.length!=_e.length&&ue.length!=_e.length+2)return zs(ue);var Ce=ue.length!=_e.length,Be="",Ge=ue[0],He=ue[1],xt=_e[0],ht=xt,Ct=1;if(Ce&&(Be+="Q"+(He[0]-xt[0]*2/3)+","+(He[1]-xt[1]*2/3)+","+He[0]+","+He[1],Ge=ue[1],Ct=2),_e.length>1){ht=_e[1],He=ue[Ct],Ct++,Be+="C"+(Ge[0]+xt[0])+","+(Ge[1]+xt[1])+","+(He[0]-ht[0])+","+(He[1]-ht[1])+","+He[0]+","+He[1];for(var Zt=2;Zt<_e.length;Zt++,Ct++)He=ue[Ct],ht=_e[Zt],Be+="S"+(He[0]-ht[0])+","+(He[1]-ht[1])+","+He[0]+","+He[1]}if(Ce){var jt=ue[Ct];Be+="Q"+(He[0]+ht[0]*2/3)+","+(He[1]+ht[1]*2/3)+","+jt[0]+","+jt[1]}return Be}function bu(ue,_e){for(var Ce=[],Be=(1-_e)/2,Ge,He=ue[0],xt=ue[1],ht=1,Ct=ue.length;++ht<Ct;)Ge=He,He=xt,xt=ue[ht],Ce.push([Be*(xt[0]-Ge[0]),Be*(xt[1]-Ge[1])]);return Ce}function af(ue){if(ue.length<3)return zs(ue);var _e=1,Ce=ue.length,Be=ue[0],Ge=Be[0],He=Be[1],xt=[Ge,Ge,Ge,(Be=ue[1])[0]],ht=[He,He,He,Be[1]],Ct=[Ge,",",He,"L",es(qe,xt),",",es(qe,ht)];for(ue.push(ue[Ce-1]);++_e<=Ce;)Be=ue[_e],xt.shift(),xt.push(Be[0]),ht.shift(),ht.push(Be[1]),st(Ct,xt,ht);return ue.pop(),Ct.push("L",Be),Ct.join("")}function su(ue){if(ue.length<4)return zs(ue);for(var _e=[],Ce=-1,Be=ue.length,Ge,He=[0],xt=[0];++Ce<3;)Ge=ue[Ce],He.push(Ge[0]),xt.push(Ge[1]);for(_e.push(es(qe,He)+","+es(qe,xt)),--Ce;++Ce<Be;)Ge=ue[Ce],He.shift(),He.push(Ge[0]),xt.shift(),xt.push(Ge[1]),st(_e,He,xt);return _e.join("")}function Ju(ue){for(var _e,Ce=-1,Be=ue.length,Ge=Be+4,He,xt=[],ht=[];++Ce<4;)He=ue[Ce%Be],xt.push(He[0]),ht.push(He[1]);for(_e=[es(qe,xt),",",es(qe,ht)],--Ce;++Ce<Ge;)He=ue[Ce%Be],xt.shift(),xt.push(He[0]),ht.shift(),ht.push(He[1]),st(_e,xt,ht);return _e.join("")}function Qu(ue,_e){var Ce=ue.length-1;if(Ce)for(var Be=ue[0][0],Ge=ue[0][1],He=ue[Ce][0]-Be,xt=ue[Ce][1]-Ge,ht=-1,Ct,Zt;++ht<=Ce;)Ct=ue[ht],Zt=ht/Ce,Ct[0]=_e*Ct[0]+(1-_e)*(Be+Zt*He),Ct[1]=_e*Ct[1]+(1-_e)*(Ge+Zt*xt);return af(ue)}function es(ue,_e){return ue[0]*_e[0]+ue[1]*_e[1]+ue[2]*_e[2]+ue[3]*_e[3]}var ze=[0,2/3,1/3,0],Ye=[0,1/3,2/3,0],qe=[0,1/6,2/3,1/6];function st(ue,_e,Ce){ue.push("C",es(ze,_e),",",es(ze,Ce),",",es(Ye,_e),",",es(Ye,Ce),",",es(qe,_e),",",es(qe,Ce))}function mt(ue,_e){return(_e[1]-ue[1])/(_e[0]-ue[0])}function yt(ue){for(var _e=0,Ce=ue.length-1,Be=[],Ge=ue[0],He=ue[1],xt=Be[0]=mt(Ge,He);++_e<Ce;)Be[_e]=(xt+(xt=mt(Ge=He,He=ue[_e+1])))/2;return Be[_e]=xt,Be}function Tt(ue){for(var _e=[],Ce,Be,Ge,He,xt=yt(ue),ht=-1,Ct=ue.length-1;++ht<Ct;)Ce=mt(ue[ht],ue[ht+1]),v(Ce)<ct?xt[ht]=xt[ht+1]=0:(Be=xt[ht]/Ce,Ge=xt[ht+1]/Ce,He=Be*Be+Ge*Ge,He>9&&(He=Ce*3/Math.sqrt(He),xt[ht]=He*Be,xt[ht+1]=He*Ge));for(ht=-1;++ht<=Ct;)He=(ue[Math.min(Ct,ht+1)][0]-ue[Math.max(0,ht-1)][0])/(6*(1+xt[ht]*xt[ht])),_e.push([He||0,xt[ht]*He||0]);return _e}function ar(ue){return ue.length<3?zs(ue):ue[0]+yl(ue,Tt(ue))}b.svg.line.radial=function(){var ue=Ou(lr);return ue.radius=ue.x,delete ue.x,ue.angle=ue.y,delete ue.y,ue};function lr(ue){for(var _e,Ce=-1,Be=ue.length,Ge,He;++Ce<Be;)_e=ue[Ce],Ge=_e[0],He=_e[1]-nt,_e[0]=Ge*Math.cos(He),_e[1]=Ge*Math.sin(He);return ue}function rr(ue){var _e=fi,Ce=fi,Be=0,Ge=pi,He=ms,xt=zs,ht=xt.key,Ct=xt,Zt="L",jt=.7;function br(xr){var Wr=[],tn=[],Mr=[],Ir=-1,Xr=xr.length,qr,an=tr(_e),Br=tr(Be),In=_e===Ce?function(){return ya}:tr(Ce),fa=Be===Ge?function(){return da}:tr(Ge),ya,da;function Ca(){Wr.push("M",xt(ue(Mr),jt),Zt,Ct(ue(tn.reverse()),jt),"Z")}for(;++Ir<Xr;)He.call(this,qr=xr[Ir],Ir)?(tn.push([ya=+an.call(this,qr,Ir),da=+Br.call(this,qr,Ir)]),Mr.push([+In.call(this,qr,Ir),+fa.call(this,qr,Ir)])):tn.length&&(Ca(),tn=[],Mr=[]);return tn.length&&Ca(),Wr.length?Wr.join(""):null}return br.x=function(xr){return arguments.length?(_e=Ce=xr,br):Ce},br.x0=function(xr){return arguments.length?(_e=xr,br):_e},br.x1=function(xr){return arguments.length?(Ce=xr,br):Ce},br.y=function(xr){return arguments.length?(Be=Ge=xr,br):Ge},br.y0=function(xr){return arguments.length?(Be=xr,br):Be},br.y1=function(xr){return arguments.length?(Ge=xr,br):Ge},br.defined=function(xr){return arguments.length?(He=xr,br):He},br.interpolate=function(xr){return arguments.length?(typeof xr=="function"?ht=xt=xr:ht=(xt=dl.get(xr)||zs).key,Ct=xt.reverse||xt,Zt=xt.closed?"M":"L",br):ht},br.tension=function(xr){return arguments.length?(jt=xr,br):jt},br}Bu.reverse=xs,xs.reverse=Bu,b.svg.area=function(){return rr(O)},b.svg.area.radial=function(){var ue=rr(lr);return ue.radius=ue.x,delete ue.x,ue.innerRadius=ue.x0,delete ue.x0,ue.outerRadius=ue.x1,delete ue.x1,ue.angle=ue.y,delete ue.y,ue.startAngle=ue.y0,delete ue.y0,ue.endAngle=ue.y1,delete ue.y1,ue};function hr(ue){return ue.source}function kr(ue){return ue.target}b.svg.chord=function(){var ue=hr,_e=kr,Ce=Yr,Be=gs,Ge=ys;function He(jt,br){var xr=xt(this,ue,jt,br),Wr=xt(this,_e,jt,br);return"M"+xr.p0+Ct(xr.r,xr.p1,xr.a1-xr.a0)+(ht(xr,Wr)?Zt(xr.r,xr.p1,xr.r,xr.p0):Zt(xr.r,xr.p1,Wr.r,Wr.p0)+Ct(Wr.r,Wr.p1,Wr.a1-Wr.a0)+Zt(Wr.r,Wr.p1,xr.r,xr.p0))+"Z"}function xt(jt,br,xr,Wr){var tn=br.call(jt,xr,Wr),Mr=Ce.call(jt,tn,Wr),Ir=Be.call(jt,tn,Wr)-nt,Xr=Ge.call(jt,tn,Wr)-nt;return{r:Mr,a0:Ir,a1:Xr,p0:[Mr*Math.cos(Ir),Mr*Math.sin(Ir)],p1:[Mr*Math.cos(Xr),Mr*Math.sin(Xr)]}}function ht(jt,br){return jt.a0==br.a0&&jt.a1==br.a1}function Ct(jt,br,xr){return"A"+jt+","+jt+" 0 "+ +(xr>Pe)+",1 "+br}function Zt(jt,br,xr,Wr){return"Q 0,0 "+Wr}return He.radius=function(jt){return arguments.length?(Ce=tr(jt),He):Ce},He.source=function(jt){return arguments.length?(ue=tr(jt),He):ue},He.target=function(jt){return arguments.length?(_e=tr(jt),He):_e},He.startAngle=function(jt){return arguments.length?(Be=tr(jt),He):Be},He.endAngle=function(jt){return arguments.length?(Ge=tr(jt),He):Ge},He};function Yr(ue){return ue.radius}b.svg.diagonal=function(){var ue=hr,_e=kr,Ce=$r;function Be(Ge,He){var xt=ue.call(this,Ge,He),ht=_e.call(this,Ge,He),Ct=(xt.y+ht.y)/2,Zt=[xt,{x:xt.x,y:Ct},{x:ht.x,y:Ct},ht];return Zt=Zt.map(Ce),"M"+Zt[0]+"C"+Zt[1]+" "+Zt[2]+" "+Zt[3]}return Be.source=function(Ge){return arguments.length?(ue=tr(Ge),Be):ue},Be.target=function(Ge){return arguments.length?(_e=tr(Ge),Be):_e},Be.projection=function(Ge){return arguments.length?(Ce=Ge,Be):Ce},Be};function $r(ue){return[ue.x,ue.y]}b.svg.diagonal.radial=function(){var ue=b.svg.diagonal(),_e=$r,Ce=ue.projection;return ue.projection=function(Be){return arguments.length?Ce(xn(_e=Be)):_e},ue};function xn(ue){return function(){var _e=ue.apply(this,arguments),Ce=_e[0],Be=_e[1]-nt;return[Ce*Math.cos(Be),Ce*Math.sin(Be)]}}b.svg.symbol=function(){var ue=Wn,_e=Rn;function Ce(Be,Ge){return(Wa.get(ue.call(this,Be,Ge))||ba)(_e.call(this,Be,Ge))}return Ce.type=function(Be){return arguments.length?(ue=tr(Be),Ce):ue},Ce.size=function(Be){return arguments.length?(_e=tr(Be),Ce):_e},Ce};function Rn(){return 64}function Wn(){return"circle"}function ba(ue){var _e=Math.sqrt(ue/Pe);return"M0,"+_e+"A"+_e+","+_e+" 0 1,1 0,"+-_e+"A"+_e+","+_e+" 0 1,1 0,"+_e+"Z"}var Wa=b.map({circle:ba,cross:function(ue){var _e=Math.sqrt(ue/5)/2;return"M"+-3*_e+","+-_e+"H"+-_e+"V"+-3*_e+"H"+_e+"V"+-_e+"H"+3*_e+"V"+_e+"H"+_e+"V"+3*_e+"H"+-_e+"V"+_e+"H"+-3*_e+"Z"},diamond:function(ue){var _e=Math.sqrt(ue/(2*Qa)),Ce=_e*Qa;return"M0,"+-_e+"L"+Ce+",0 0,"+_e+" "+-Ce+",0Z"},square:function(ue){var _e=Math.sqrt(ue)/2;return"M"+-_e+","+-_e+"L"+_e+","+-_e+" "+_e+","+_e+" "+-_e+","+_e+"Z"},"triangle-down":function(ue){var _e=Math.sqrt(ue/Ja),Ce=_e*Ja/2;return"M0,"+Ce+"L"+_e+","+-Ce+" "+-_e+","+-Ce+"Z"},"triangle-up":function(ue){var _e=Math.sqrt(ue/Ja),Ce=_e*Ja/2;return"M0,"+-Ce+"L"+_e+","+Ce+" "+-_e+","+Ce+"Z"}});b.svg.symbolTypes=Wa.keys();var Ja=Math.sqrt(3),Qa=Math.tan(30*kt);J.transition=function(ue){for(var _e=Zi||++qi,Ce=jo(ue),Be=[],Ge,He,xt=po||{time:Date.now(),ease:Cu,delay:0,duration:250},ht=-1,Ct=this.length;++ht<Ct;){Be.push(Ge=[]);for(var Zt=this[ht],jt=-1,br=Zt.length;++jt<br;)(He=Zt[jt])&&go(He,jt,Ce,_e,xt),Ge.push(He)}return Xi(Be,Ce,_e)},J.interrupt=function(ue){return this.each(ue==null?ri:yi(jo(ue)))};var ri=yi(jo());function yi(ue){return function(){var _e,Ce,Be;(_e=this[ue])&&(Be=_e[Ce=_e.active])&&(Be.timer.c=null,Be.timer.t=NaN,--_e.count?delete _e[Ce]:delete this[ue],_e.active+=.5,Be.event&&Be.event.interrupt.call(this,this.__data__,Be.index))}}function Xi(ue,_e,Ce){return G(ue,Ga),ue.namespace=_e,ue.id=Ce,ue}var Ga=[],qi=0,Zi,po;Ga.call=J.call,Ga.empty=J.empty,Ga.node=J.node,Ga.size=J.size,b.transition=function(ue,_e){return ue&&ue.transition?Zi?ue.transition(_e):ue:b.selection().transition(ue)},b.transition.prototype=Ga,Ga.select=function(ue){var _e=this.id,Ce=this.namespace,Be=[],Ge,He,xt;ue=W(ue);for(var ht=-1,Ct=this.length;++ht<Ct;){Be.push(Ge=[]);for(var Zt=this[ht],jt=-1,br=Zt.length;++jt<br;)(xt=Zt[jt])&&(He=ue.call(xt,xt.__data__,jt,ht))?("__data__"in xt&&(He.__data__=xt.__data__),go(He,jt,Ce,_e,xt[Ce][_e]),Ge.push(He)):Ge.push(null)}return Xi(Be,Ce,_e)},Ga.selectAll=function(ue){var _e=this.id,Ce=this.namespace,Be=[],Ge,He,xt,ht,Ct;ue=re(ue);for(var Zt=-1,jt=this.length;++Zt<jt;)for(var br=this[Zt],xr=-1,Wr=br.length;++xr<Wr;)if(xt=br[xr]){Ct=xt[Ce][_e],He=ue.call(xt,xt.__data__,xr,Zt),Be.push(Ge=[]);for(var tn=-1,Mr=He.length;++tn<Mr;)(ht=He[tn])&&go(ht,tn,Ce,_e,Ct),Ge.push(ht)}return Xi(Be,Ce,_e)},Ga.filter=function(ue){var _e=[],Ce,Be,Ge;typeof ue!="function"&&(ue=ye(ue));for(var He=0,xt=this.length;He<xt;He++){_e.push(Ce=[]);for(var Be=this[He],ht=0,Ct=Be.length;ht<Ct;ht++)(Ge=Be[ht])&&ue.call(Ge,Ge.__data__,ht,He)&&Ce.push(Ge)}return Xi(_e,this.namespace,this.id)},Ga.tween=function(ue,_e){var Ce=this.id,Be=this.namespace;return arguments.length<2?this.node()[Be][Ce].tween.get(ue):Oe(this,_e==null?function(Ge){Ge[Be][Ce].tween.remove(ue)}:function(Ge){Ge[Be][Ce].tween.set(ue,_e)})};function _i(ue,_e,Ce,Be){var Ge=ue.id,He=ue.namespace;return Oe(ue,typeof Ce=="function"?function(xt,ht,Ct){xt[He][Ge].tween.set(_e,Be(Ce.call(xt,xt.__data__,ht,Ct)))}:(Ce=Be(Ce),function(xt){xt[He][Ge].tween.set(_e,Ce)}))}Ga.attr=function(ue,_e){if(arguments.length<2){for(_e in ue)this.attr(_e,ue[_e]);return this}var Ce=ue=="transform"?Wo:Go,Be=b.ns.qualify(ue);function Ge(){this.removeAttribute(Be)}function He(){this.removeAttributeNS(Be.space,Be.local)}function xt(Ct){return Ct==null?Ge:(Ct+="",function(){var Zt=this.getAttribute(Be),jt;return Zt!==Ct&&(jt=Ce(Zt,Ct),function(br){this.setAttribute(Be,jt(br))})})}function ht(Ct){return Ct==null?He:(Ct+="",function(){var Zt=this.getAttributeNS(Be.space,Be.local),jt;return Zt!==Ct&&(jt=Ce(Zt,Ct),function(br){this.setAttributeNS(Be.space,Be.local,jt(br))})})}return _i(this,"attr."+ue,_e,Be.local?ht:xt)},Ga.attrTween=function(ue,_e){var Ce=b.ns.qualify(ue);function Be(He,xt){var ht=_e.call(this,He,xt,this.getAttribute(Ce));return ht&&function(Ct){this.setAttribute(Ce,ht(Ct))}}function Ge(He,xt){var ht=_e.call(this,He,xt,this.getAttributeNS(Ce.space,Ce.local));return ht&&function(Ct){this.setAttributeNS(Ce.space,Ce.local,ht(Ct))}}return this.tween("attr."+ue,Ce.local?Ge:Be)},Ga.style=function(ue,_e,Ce){var Be=arguments.length;if(Be<3){if(typeof ue!="string"){Be<2&&(_e="");for(Ce in ue)this.style(Ce,ue[Ce],_e);return this}Ce=""}function Ge(){this.style.removeProperty(ue)}function He(xt){return xt==null?Ge:(xt+="",function(){var ht=p(this).getComputedStyle(this,null).getPropertyValue(ue),Ct;return ht!==xt&&(Ct=Go(ht,xt),function(Zt){this.style.setProperty(ue,Ct(Zt),Ce)})})}return _i(this,"style."+ue,_e,He)},Ga.styleTween=function(ue,_e,Ce){arguments.length<3&&(Ce="");function Be(Ge,He){var xt=_e.call(this,Ge,He,p(this).getComputedStyle(this,null).getPropertyValue(ue));return xt&&function(ht){this.style.setProperty(ue,xt(ht),Ce)}}return this.tween("style."+ue,Be)},Ga.text=function(ue){return _i(this,"text",ue,Ri)};function Ri(ue){return ue==null&&(ue=""),function(){this.textContent=ue}}Ga.remove=function(){var ue=this.namespace;return this.each("end.transition",function(){var _e;this[ue].count<2&&(_e=this.parentNode)&&_e.removeChild(this)})},Ga.ease=function(ue){var _e=this.id,Ce=this.namespace;return arguments.length<1?this.node()[Ce][_e].ease:(typeof ue!="function"&&(ue=b.ease.apply(b,arguments)),Oe(this,function(Be){Be[Ce][_e].ease=ue}))},Ga.delay=function(ue){var _e=this.id,Ce=this.namespace;return arguments.length<1?this.node()[Ce][_e].delay:Oe(this,typeof ue=="function"?function(Be,Ge,He){Be[Ce][_e].delay=+ue.call(Be,Be.__data__,Ge,He)}:(ue=+ue,function(Be){Be[Ce][_e].delay=ue}))},Ga.duration=function(ue){var _e=this.id,Ce=this.namespace;return arguments.length<1?this.node()[Ce][_e].duration:Oe(this,typeof ue=="function"?function(Be,Ge,He){Be[Ce][_e].duration=Math.max(1,ue.call(Be,Be.__data__,Ge,He))}:(ue=Math.max(1,ue),function(Be){Be[Ce][_e].duration=ue}))},Ga.each=function(ue,_e){var Ce=this.id,Be=this.namespace;if(arguments.length<2){var Ge=po,He=Zi;try{Zi=Ce,Oe(this,function(xt,ht,Ct){po=xt[Be][Ce],ue.call(xt,xt.__data__,ht,Ct)})}finally{po=Ge,Zi=He}}else Oe(this,function(xt){var ht=xt[Be][Ce];(ht.event||(ht.event=b.dispatch("start","end","interrupt"))).on(ue,_e)});return this},Ga.transition=function(){for(var ue=this.id,_e=++qi,Ce=this.namespace,Be=[],Ge,He,xt,ht,Ct=0,Zt=this.length;Ct<Zt;Ct++){Be.push(Ge=[]);for(var He=this[Ct],jt=0,br=He.length;jt<br;jt++)(xt=He[jt])&&(ht=xt[Ce][ue],go(xt,jt,Ce,_e,{time:ht.time,ease:ht.ease,delay:ht.delay+ht.duration,duration:ht.duration})),Ge.push(xt)}return Xi(Be,Ce,_e)};function jo(ue){return ue==null?"__transition__":"__transition_"+ue+"__"}function go(ue,_e,Ce,Be,Ge){var He=ue[Ce]||(ue[Ce]={active:0,count:0}),xt=He[Be],ht,Ct,Zt,jt,br;function xr(Mr){var Ir=xt.delay;if(Ct.t=Ir+ht,Ir<=Mr)return Wr(Mr-Ir);Ct.c=Wr}function Wr(Mr){var Ir=He.active,Xr=He[Ir];Xr&&(Xr.timer.c=null,Xr.timer.t=NaN,--He.count,delete He[Ir],Xr.event&&Xr.event.interrupt.call(ue,ue.__data__,Xr.index));for(var qr in He)if(+qr<Be){var an=He[qr];an.timer.c=null,an.timer.t=NaN,--He.count,delete He[qr]}Ct.c=tn,Xn(function(){return Ct.c&&tn(Mr||1)&&(Ct.c=null,Ct.t=NaN),1},0,ht),He.active=Be,xt.event&&xt.event.start.call(ue,ue.__data__,_e),br=[],xt.tween.forEach(function(Br,In){(In=In.call(ue,ue.__data__,_e))&&br.push(In)}),jt=xt.ease,Zt=xt.duration}function tn(Mr){for(var Ir=Mr/Zt,Xr=jt(Ir),qr=br.length;qr>0;)br[--qr].call(ue,Xr);if(Ir>=1)return xt.event&&xt.event.end.call(ue,ue.__data__,_e),--He.count?delete He[Be]:delete ue[Ce],1}xt||(ht=Ge.time,Ct=Xn(xr,0,ht),xt=He[Be]={tween:new y,time:ht,timer:Ct,delay:Ge.delay,duration:Ge.duration,ease:Ge.ease,index:_e},Ge=null,++He.count)}b.svg.axis=function(){var ue=b.scale.linear(),_e=Po,Ce=6,Be=6,Ge=3,He=[10],xt=null,ht;function Ct(Zt){Zt.each(function(){var jt=b.select(this),br=this.__chart__||ue,xr=this.__chart__=ue.copy(),Wr=xt??(xr.ticks?xr.ticks.apply(xr,He):xr.domain()),tn=ht??(xr.tickFormat?xr.tickFormat.apply(xr,He):O),Mr=jt.selectAll(".tick").data(Wr,xr),Ir=Mr.enter().insert("g",".domain").attr("class","tick").style("opacity",ct),Xr=b.transition(Mr.exit()).style("opacity",ct).remove(),qr=b.transition(Mr.order()).style("opacity",1),an=Math.max(Ce,0)+Ge,Br,In=Ln(xr),fa=jt.selectAll(".domain").data([0]),ya=(fa.enter().append("path").attr("class","domain"),b.transition(fa));Ir.append("line"),Ir.append("text");var da=Ir.select("line"),Ca=qr.select("line"),Ra=Mr.select("text").text(tn),ii=Ir.select("text"),Oa=qr.select("text"),Xa=_e==="top"||_e==="left"?-1:1,Ii,ci,ki,aa;if(_e==="bottom"||_e==="top"?(Br=Io,Ii="x",ki="y",ci="x2",aa="y2",Ra.attr("dy",Xa<0?"0em":".71em").style("text-anchor","middle"),ya.attr("d","M"+In[0]+","+Xa*Be+"V0H"+In[1]+"V"+Xa*Be)):(Br=Qs,Ii="y",ki="x",ci="y2",aa="x2",Ra.attr("dy",".32em").style("text-anchor",Xa<0?"end":"start"),ya.attr("d","M"+Xa*Be+","+In[0]+"H0V"+In[1]+"H"+Xa*Be)),da.attr(aa,Xa*Ce),ii.attr(ki,Xa*an),Ca.attr(ci,0).attr(aa,Xa*Ce),Oa.attr(Ii,0).attr(ki,Xa*an),xr.rangeBand){var $a=xr,si=$a.rangeBand()/2;br=xr=function(Mi){return $a(Mi)+si}}else br.rangeBand?br=xr:Xr.call(Br,xr,br);Ir.call(Br,br,xr),qr.call(Br,xr,xr)})}return Ct.scale=function(Zt){return arguments.length?(ue=Zt,Ct):ue},Ct.orient=function(Zt){return arguments.length?(_e=Zt in Ko?Zt+"":Po,Ct):_e},Ct.ticks=function(){return arguments.length?(He=P(arguments),Ct):He},Ct.tickValues=function(Zt){return arguments.length?(xt=Zt,Ct):xt},Ct.tickFormat=function(Zt){return arguments.length?(ht=Zt,Ct):ht},Ct.tickSize=function(Zt){var jt=arguments.length;return jt?(Ce=+Zt,Be=+arguments[jt-1],Ct):Ce},Ct.innerTickSize=function(Zt){return arguments.length?(Ce=+Zt,Ct):Ce},Ct.outerTickSize=function(Zt){return arguments.length?(Be=+Zt,Ct):Be},Ct.tickPadding=function(Zt){return arguments.length?(Ge=+Zt,Ct):Ge},Ct.tickSubdivide=function(){return arguments.length&&Ct},Ct};var Po="bottom",Ko={top:1,right:1,bottom:1,left:1};function Io(ue,_e,Ce){ue.attr("transform",function(Be){var Ge=_e(Be);return"translate("+(isFinite(Ge)?Ge:Ce(Be))+",0)"})}function Qs(ue,_e,Ce){ue.attr("transform",function(Be){var Ge=_e(Be);return"translate(0,"+(isFinite(Ge)?Ge:Ce(Be))+")"})}b.svg.brush=function(){var ue=q(jt,"brushstart","brush","brushend"),_e=null,Ce=null,Be=[0,0],Ge=[0,0],He,xt,ht=!0,Ct=!0,Zt=zo[0];function jt(Mr){Mr.each(function(){var Ir=b.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",tn).on("touchstart.brush",tn),Xr=Ir.selectAll(".background").data([0]);Xr.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Ir.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var qr=Ir.selectAll(".resize").data(Zt,O);qr.exit().remove(),qr.enter().append("g").attr("class",function(fa){return"resize "+fa}).style("cursor",function(fa){return ml[fa]}).append("rect").attr("x",function(fa){return/[ew]$/.test(fa)?-3:null}).attr("y",function(fa){return/^[ns]/.test(fa)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),qr.style("display",jt.empty()?"none":null);var an=b.transition(Ir),Br=b.transition(Xr),In;_e&&(In=Ln(_e),Br.attr("x",In[0]).attr("width",In[1]-In[0]),xr(an)),Ce&&(In=Ln(Ce),Br.attr("y",In[0]).attr("height",In[1]-In[0]),Wr(an)),br(an)})}jt.event=function(Mr){Mr.each(function(){var Ir=ue.of(this,arguments),Xr={x:Be,y:Ge,i:He,j:xt},qr=this.__chart__||Xr;this.__chart__=Xr,Zi?b.select(this).transition().each("start.brush",function(){He=qr.i,xt=qr.j,Be=qr.x,Ge=qr.y,Ir({type:"brushstart"})}).tween("brush:brush",function(){var an=Al(Be,Xr.x),Br=Al(Ge,Xr.y);return He=xt=null,function(In){Be=Xr.x=an(In),Ge=Xr.y=Br(In),Ir({type:"brush",mode:"resize"})}}).each("end.brush",function(){He=Xr.i,xt=Xr.j,Ir({type:"brush",mode:"resize"}),Ir({type:"brushend"})}):(Ir({type:"brushstart"}),Ir({type:"brush",mode:"resize"}),Ir({type:"brushend"}))})};function br(Mr){Mr.selectAll(".resize").attr("transform",function(Ir){return"translate("+Be[+/e$/.test(Ir)]+","+Ge[+/^s/.test(Ir)]+")"})}function xr(Mr){Mr.select(".extent").attr("x",Be[0]),Mr.selectAll(".extent,.n>rect,.s>rect").attr("width",Be[1]-Be[0])}function Wr(Mr){Mr.select(".extent").attr("y",Ge[0]),Mr.selectAll(".extent,.e>rect,.w>rect").attr("height",Ge[1]-Ge[0])}function tn(){var Mr=this,Ir=b.select(b.event.target),Xr=ue.of(Mr,arguments),qr=b.select(Mr),an=Ir.datum(),Br=!/^(n|s)$/.test(an)&&_e,In=!/^(e|w)$/.test(an)&&Ce,fa=Ir.classed("extent"),ya=Bt(Mr),da,Ca=b.mouse(Mr),Ra,ii=b.select(p(Mr)).on("keydown.brush",Ii).on("keyup.brush",ci);if(b.event.changedTouches?ii.on("touchmove.brush",ki).on("touchend.brush",$a):ii.on("mousemove.brush",ki).on("mouseup.brush",$a),qr.interrupt().selectAll("*").interrupt(),fa)Ca[0]=Be[0]-Ca[0],Ca[1]=Ge[0]-Ca[1];else if(an){var Oa=+/w$/.test(an),Xa=+/^n/.test(an);Ra=[Be[1-Oa]-Ca[0],Ge[1-Xa]-Ca[1]],Ca[0]=Be[Oa],Ca[1]=Ge[Xa]}else b.event.altKey&&(da=Ca.slice());qr.style("pointer-events","none").selectAll(".resize").style("display",null),b.select("body").style("cursor",Ir.style("cursor")),Xr({type:"brushstart"}),ki();function Ii(){b.event.keyCode==32&&(fa||(da=null,Ca[0]-=Be[1],Ca[1]-=Ge[1],fa=2),oe())}function ci(){b.event.keyCode==32&&fa==2&&(Ca[0]+=Be[1],Ca[1]+=Ge[1],fa=0,oe())}function ki(){var si=b.mouse(Mr),Mi=!1;Ra&&(si[0]+=Ra[0],si[1]+=Ra[1]),fa||(b.event.altKey?(da||(da=[(Be[0]+Be[1])/2,(Ge[0]+Ge[1])/2]),Ca[0]=Be[+(si[0]<da[0])],Ca[1]=Ge[+(si[1]<da[1])]):da=null),Br&&aa(si,_e,0)&&(xr(qr),Mi=!0),In&&aa(si,Ce,1)&&(Wr(qr),Mi=!0),Mi&&(br(qr),Xr({type:"brush",mode:fa?"move":"resize"}))}function aa(si,Mi,Qi){var Hi=Ln(Mi),Bi=Hi[0],Ma=Hi[1],Ia=Ca[Qi],eo=Qi?Ge:Be,bo=eo[1]-eo[0],yo,Yi;if(fa&&(Bi-=Ia,Ma-=bo+Ia),yo=(Qi?Ct:ht)?Math.max(Bi,Math.min(Ma,si[Qi])):si[Qi],fa?Yi=(yo+=Ia)+bo:(da&&(Ia=Math.max(Bi,Math.min(Ma,2*da[Qi]-yo))),Ia<yo?(Yi=yo,yo=Ia):Yi=Ia),eo[0]!=yo||eo[1]!=Yi)return Qi?xt=null:He=null,eo[0]=yo,eo[1]=Yi,!0}function $a(){ki(),qr.style("pointer-events","all").selectAll(".resize").style("display",jt.empty()?"none":null),b.select("body").style("cursor",null),ii.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),ya(),Xr({type:"brushend"})}}return jt.x=function(Mr){return arguments.length?(_e=Mr,Zt=zo[!_e<<1|!Ce],jt):_e},jt.y=function(Mr){return arguments.length?(Ce=Mr,Zt=zo[!_e<<1|!Ce],jt):Ce},jt.clamp=function(Mr){return arguments.length?(_e&&Ce?(ht=!!Mr[0],Ct=!!Mr[1]):_e?ht=!!Mr:Ce&&(Ct=!!Mr),jt):_e&&Ce?[ht,Ct]:_e?ht:Ce?Ct:null},jt.extent=function(Mr){var Ir,Xr,qr,an,Br;return arguments.length?(_e&&(Ir=Mr[0],Xr=Mr[1],Ce&&(Ir=Ir[0],Xr=Xr[0]),He=[Ir,Xr],_e.invert&&(Ir=_e(Ir),Xr=_e(Xr)),Xr<Ir&&(Br=Ir,Ir=Xr,Xr=Br),(Ir!=Be[0]||Xr!=Be[1])&&(Be=[Ir,Xr])),Ce&&(qr=Mr[0],an=Mr[1],_e&&(qr=qr[1],an=an[1]),xt=[qr,an],Ce.invert&&(qr=Ce(qr),an=Ce(an)),an<qr&&(Br=qr,qr=an,an=Br),(qr!=Ge[0]||an!=Ge[1])&&(Ge=[qr,an])),jt):(_e&&(He?(Ir=He[0],Xr=He[1]):(Ir=Be[0],Xr=Be[1],_e.invert&&(Ir=_e.invert(Ir),Xr=_e.invert(Xr)),Xr<Ir&&(Br=Ir,Ir=Xr,Xr=Br))),Ce&&(xt?(qr=xt[0],an=xt[1]):(qr=Ge[0],an=Ge[1],Ce.invert&&(qr=Ce.invert(qr),an=Ce.invert(an)),an<qr&&(Br=qr,qr=an,an=Br))),_e&&Ce?[[Ir,qr],[Xr,an]]:_e?[Ir,Xr]:Ce&&[qr,an])},jt.clear=function(){return jt.empty()||(Be=[0,0],Ge=[0,0],He=xt=null),jt},jt.empty=function(){return!!_e&&Be[0]==Be[1]||!!Ce&&Ge[0]==Ge[1]},b.rebind(jt,ue,"on")};var ml={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},zo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];b.text=Lr(function(ue){return ue.responseText}),b.json=function(ue,_e){return Nr(ue,"application/json",Ea,_e)};function Ea(ue){return JSON.parse(ue.responseText)}b.html=function(ue,_e){return Nr(ue,"text/html",$s,_e)};function $s(ue){var _e=E.createRange();return _e.selectNode(E.body),_e.createContextualFragment(ue.responseText)}b.xml=Lr(function(ue){return ue.responseXML}),typeof Vr=="function"&&Vr.amd?(this.d3=b,Vr(b)):typeof ae=="object"&&ae.exports?ae.exports=b:this.d3=b}).apply(self)},{}],59:[function(c,ae,ie){"use strict";ae.exports=c("./quad")},{"./quad":60}],60:[function(c,ae,ie){"use strict";var b=c("binary-search-bounds"),k=c("clamp"),P=c("parse-rect"),E=c("array-bounds"),e=c("pick-by-alias"),p=c("defined"),g=c("flatten-vertex-data"),a=c("is-obj"),t=c("dtype"),i=c("math-log2"),n=1073741824;ae.exports=function(s,m){m||(m={}),s=g(s,"float64"),m=e(m,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var x=p(m.maxDepth,255),M=p(m.bounds,E(s,2));M[0]===M[2]&&M[2]++,M[1]===M[3]&&M[3]++;var v=r(s,M),_=s.length>>>1,l;m.dtype||(m.dtype="array"),typeof m.dtype=="string"?l=new(t(m.dtype))(_):m.dtype&&(l=m.dtype,Array.isArray(l)&&(l.length=_));for(var y=0;y<_;++y)l[y]=y;var T=[],w=[],A=[],f=[];O(0,0,1,l,0,1);for(var u=0,h=0;h<T.length;h++){var o=T[h];if(l.set)l.set(o,u);else for(var S=0,R=o.length;S<R;S++)l[S+u]=o[S];var z=u+T[h].length;f[h]=[u,z],u=z}return l.range=I,l;function O(B,U,X,oe,se,q){if(!oe.length)return null;var K=T[se]||(T[se]=[]),G=A[se]||(A[se]=[]),Q=w[se]||(w[se]=[]),V=K.length;if(se++,se>x||q>n){for(var H=0;H<oe.length;H++)K.push(oe[H]),G.push(q),Q.push(null,null,null,null);return V}if(K.push(oe[0]),G.push(q),oe.length<=1)return Q.push(null,null,null,null),V;for(var ee=X*.5,J=B+ee,W=U+ee,re=[],j=[],Z=[],ne=[],le=1,ge=oe.length;le<ge;le++){var pe=oe[le],xe=v[pe*2],Ee=v[pe*2+1];xe<J?Ee<W?re.push(pe):j.push(pe):Ee<W?Z.push(pe):ne.push(pe)}return q<<=2,Q.push(O(B,U,ee,re,se,q),O(B,W,ee,j,se,q+1),O(J,U,ee,Z,se,q+2),O(J,W,ee,ne,se,q+3)),V}function I(){for(var B=[],U=arguments.length;U--;)B[U]=arguments[U];var X;if(a(B[B.length-1])){var oe=B.pop();!B.length&&(oe.x!=null||oe.l!=null||oe.left!=null)&&(B=[oe],X={}),X=e(oe,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else X={};B.length||(B=M);var se=P.apply(void 0,B),q=[Math.min(se.x,se.x+se.width),Math.min(se.y,se.y+se.height),Math.max(se.x,se.x+se.width),Math.max(se.y,se.y+se.height)],K=q[0],G=q[1],Q=q[2],V=q[3],H=r([K,G,Q,V],M),ee=H[0],J=H[1],W=H[2],re=H[3],j=p(X.level,T.length);if(X.d!=null){var Z;typeof X.d=="number"?Z=[X.d,X.d]:X.d.length&&(Z=X.d),j=Math.min(Math.max(Math.ceil(-i(Math.abs(Z[0])/(M[2]-M[0]))),Math.ceil(-i(Math.abs(Z[1])/(M[3]-M[1])))),j)}if(j=Math.min(j,T.length),X.lod)return F(ee,J,W,re,j);var ne=[];le(0,0,1,0,0,1);function le(pe,xe,Ee,Te,de,be){if(!(de===null||be===null)){var Le=pe+Ee,De=xe+Ee;if(!(ee>Le||J>De||W<pe||re<xe)&&!(Te>=j)&&de!==be){var ye=T[Te];be===void 0&&(be=ye.length);for(var ke=de;ke<be;ke++){var Oe=ye[ke],Qe=s[Oe*2],Ve=s[Oe*2+1];Qe>=K&&Qe<=Q&&Ve>=G&&Ve<=V&&ne.push(Oe)}var Ue=w[Te],Ie=Ue[de*4+0],at=Ue[de*4+1],pt=Ue[de*4+2],Rt=Ue[de*4+3],Mt=ge(Ue,de+1),It=Ee*.5,Bt=Te+1;le(pe,xe,It,Bt,Ie,at||pt||Rt||Mt),le(pe,xe+It,It,Bt,at,pt||Rt||Mt),le(pe+It,xe,It,Bt,pt,Rt||Mt),le(pe+It,xe+It,It,Bt,Rt,Mt)}}}function ge(pe,xe){for(var Ee=null,Te=0;Ee===null;)if(Ee=pe[xe*4+Te],Te++,Te>pe.length)return null;return Ee}return ne}function F(B,U,X,oe,se){for(var q=[],K=0;K<se;K++){var G=A[K],Q=f[K][0],V=D(B,U,K),H=D(X,oe,K),ee=b.ge(G,V),J=b.gt(G,H,ee,G.length-1);q[K]=[ee+Q,J+Q]}return q}function D(B,U,X){for(var oe=1,se=.5,q=.5,K=.5,G=0;G<X;G++)oe<<=2,oe+=B<se?U<q?0:1:U<q?2:3,K*=.5,se+=B<se?-K:K,q+=U<q?-K:K;return oe}};function r(d,s){for(var m=s[0],x=s[1],M=s[2],v=s[3],_=1/(M-m),l=1/(v-x),y=new Array(d.length),T=0,w=d.length/2;T<w;T++)y[2*T]=k((d[2*T]-m)*_,0,1),y[2*T+1]=k((d[2*T+1]-x)*l,0,1);return y}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(c,ae,ie){"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var b=c("@turf/meta"),k=6378137;function P(a){return b.geomReduce(a,function(t,i){return t+E(i)},0)}ie.default=P;function E(a){var t=0,i;switch(a.type){case"Polygon":return e(a.coordinates);case"MultiPolygon":for(i=0;i<a.coordinates.length;i++)t+=e(a.coordinates[i]);return t;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function e(a){var t=0;if(a&&a.length>0){t+=Math.abs(p(a[0]));for(var i=1;i<a.length;i++)t-=Math.abs(p(a[i]))}return t}function p(a){var t,i,n,r,d,s,m,x=0,M=a.length;if(M>2){for(m=0;m<M;m++)m===M-2?(r=M-2,d=M-1,s=0):m===M-1?(r=M-1,d=0,s=1):(r=m,d=m+1,s=m+2),t=a[r],i=a[d],n=a[s],x+=(g(n[0])-g(t[0]))*Math.sin(g(i[1]));x=x*k*k/2}return x}function g(a){return a*Math.PI/180}},{"@turf/meta":63}],62:[function(c,ae,ie){"use strict";Object.defineProperty(ie,"__esModule",{value:!0}),ie.earthRadius=63710088e-1,ie.factors={centimeters:ie.earthRadius*100,centimetres:ie.earthRadius*100,degrees:ie.earthRadius/111325,feet:ie.earthRadius*3.28084,inches:ie.earthRadius*39.37,kilometers:ie.earthRadius/1e3,kilometres:ie.earthRadius/1e3,meters:ie.earthRadius,metres:ie.earthRadius,miles:ie.earthRadius/1609.344,millimeters:ie.earthRadius*1e3,millimetres:ie.earthRadius*1e3,nauticalmiles:ie.earthRadius/1852,radians:1,yards:ie.earthRadius*1.0936},ie.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ie.earthRadius,yards:1.0936133},ie.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function b(h,o,S){S===void 0&&(S={});var R={type:"Feature"};return(S.id===0||S.id)&&(R.id=S.id),S.bbox&&(R.bbox=S.bbox),R.properties=o||{},R.geometry=h,R}ie.feature=b;function k(h,o,S){switch(S===void 0&&(S={}),h){case"Point":return P(o).geometry;case"LineString":return g(o).geometry;case"Polygon":return e(o).geometry;case"MultiPoint":return n(o).geometry;case"MultiLineString":return i(o).geometry;case"MultiPolygon":return r(o).geometry;default:throw new Error(h+" is invalid")}}ie.geometry=k;function P(h,o,S){if(S===void 0&&(S={}),!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!w(h[0])||!w(h[1]))throw new Error("coordinates must contain numbers");var R={type:"Point",coordinates:h};return b(R,o,S)}ie.point=P;function E(h,o,S){return S===void 0&&(S={}),t(h.map(function(R){return P(R,o)}),S)}ie.points=E;function e(h,o,S){S===void 0&&(S={});for(var R=0,z=h;R<z.length;R++){var O=z[R];if(O.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var I=0;I<O[O.length-1].length;I++)if(O[O.length-1][I]!==O[0][I])throw new Error("First and last Position are not equivalent.")}var F={type:"Polygon",coordinates:h};return b(F,o,S)}ie.polygon=e;function p(h,o,S){return S===void 0&&(S={}),t(h.map(function(R){return e(R,o)}),S)}ie.polygons=p;function g(h,o,S){if(S===void 0&&(S={}),h.length<2)throw new Error("coordinates must be an array of two or more positions");var R={type:"LineString",coordinates:h};return b(R,o,S)}ie.lineString=g;function a(h,o,S){return S===void 0&&(S={}),t(h.map(function(R){return g(R,o)}),S)}ie.lineStrings=a;function t(h,o){o===void 0&&(o={});var S={type:"FeatureCollection"};return o.id&&(S.id=o.id),o.bbox&&(S.bbox=o.bbox),S.features=h,S}ie.featureCollection=t;function i(h,o,S){S===void 0&&(S={});var R={type:"MultiLineString",coordinates:h};return b(R,o,S)}ie.multiLineString=i;function n(h,o,S){S===void 0&&(S={});var R={type:"MultiPoint",coordinates:h};return b(R,o,S)}ie.multiPoint=n;function r(h,o,S){S===void 0&&(S={});var R={type:"MultiPolygon",coordinates:h};return b(R,o,S)}ie.multiPolygon=r;function d(h,o,S){S===void 0&&(S={});var R={type:"GeometryCollection",geometries:h};return b(R,o,S)}ie.geometryCollection=d;function s(h,o){if(o===void 0&&(o=0),o&&!(o>=0))throw new Error("precision must be a positive number");var S=Math.pow(10,o||0);return Math.round(h*S)/S}ie.round=s;function m(h,o){o===void 0&&(o="kilometers");var S=ie.factors[o];if(!S)throw new Error(o+" units is invalid");return h*S}ie.radiansToLength=m;function x(h,o){o===void 0&&(o="kilometers");var S=ie.factors[o];if(!S)throw new Error(o+" units is invalid");return h/S}ie.lengthToRadians=x;function M(h,o){return _(x(h,o))}ie.lengthToDegrees=M;function v(h){var o=h%360;return o<0&&(o+=360),o}ie.bearingToAzimuth=v;function _(h){var o=h%(2*Math.PI);return o*180/Math.PI}ie.radiansToDegrees=_;function l(h){var o=h%360;return o*Math.PI/180}ie.degreesToRadians=l;function y(h,o,S){if(o===void 0&&(o="kilometers"),S===void 0&&(S="kilometers"),!(h>=0))throw new Error("length must be a positive number");return m(x(h,o),S)}ie.convertLength=y;function T(h,o,S){if(o===void 0&&(o="meters"),S===void 0&&(S="kilometers"),!(h>=0))throw new Error("area must be a positive number");var R=ie.areaFactors[o];if(!R)throw new Error("invalid original units");var z=ie.areaFactors[S];if(!z)throw new Error("invalid final units");return h/R*z}ie.convertArea=T;function w(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)}ie.isNumber=w;function A(h){return!!h&&h.constructor===Object}ie.isObject=A;function f(h){if(!h)throw new Error("bbox is required");if(!Array.isArray(h))throw new Error("bbox must be an Array");if(h.length!==4&&h.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");h.forEach(function(o){if(!w(o))throw new Error("bbox must only contain numbers")})}ie.validateBBox=f;function u(h){if(!h)throw new Error("id is required");if(["string","number"].indexOf(typeof h)===-1)throw new Error("id must be a number or a string")}ie.validateId=u},{}],63:[function(c,ae,ie){"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var b=c("@turf/helpers");function k(_,l,y){if(_!==null)for(var T,w,A,f,u,h,o,S=0,R=0,z,O=_.type,I=O==="FeatureCollection",F=O==="Feature",D=I?_.features.length:1,B=0;B<D;B++){o=I?_.features[B].geometry:F?_.geometry:_,z=o?o.type==="GeometryCollection":!1,u=z?o.geometries.length:1;for(var U=0;U<u;U++){var X=0,oe=0;if(f=z?o.geometries[U]:o,f!==null){h=f.coordinates;var se=f.type;switch(S=y&&(se==="Polygon"||se==="MultiPolygon")?1:0,se){case null:break;case"Point":if(l(h,R,B,X,oe)===!1)return!1;R++,X++;break;case"LineString":case"MultiPoint":for(T=0;T<h.length;T++){if(l(h[T],R,B,X,oe)===!1)return!1;R++,se==="MultiPoint"&&X++}se==="LineString"&&X++;break;case"Polygon":case"MultiLineString":for(T=0;T<h.length;T++){for(w=0;w<h[T].length-S;w++){if(l(h[T][w],R,B,X,oe)===!1)return!1;R++}se==="MultiLineString"&&X++,se==="Polygon"&&oe++}se==="Polygon"&&X++;break;case"MultiPolygon":for(T=0;T<h.length;T++){for(oe=0,w=0;w<h[T].length;w++){for(A=0;A<h[T][w].length-S;A++){if(l(h[T][w][A],R,B,X,oe)===!1)return!1;R++}oe++}X++}break;case"GeometryCollection":for(T=0;T<f.geometries.length;T++)if(k(f.geometries[T],l,y)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function P(_,l,y,T){var w=y;return k(_,function(A,f,u,h,o){f===0&&y===void 0?w=A:w=l(w,A,f,u,h,o)},T),w}function E(_,l){var y;switch(_.type){case"FeatureCollection":for(y=0;y<_.features.length&&l(_.features[y].properties,y)!==!1;y++);break;case"Feature":l(_.properties,0);break}}function e(_,l,y){var T=y;return E(_,function(w,A){A===0&&y===void 0?T=w:T=l(T,w,A)}),T}function p(_,l){if(_.type==="Feature")l(_,0);else if(_.type==="FeatureCollection")for(var y=0;y<_.features.length&&l(_.features[y],y)!==!1;y++);}function g(_,l,y){var T=y;return p(_,function(w,A){A===0&&y===void 0?T=w:T=l(T,w,A)}),T}function a(_){var l=[];return k(_,function(y){l.push(y)}),l}function t(_,l){var y,T,w,A,f,u,h,o,S,R,z=0,O=_.type==="FeatureCollection",I=_.type==="Feature",F=O?_.features.length:1;for(y=0;y<F;y++){for(u=O?_.features[y].geometry:I?_.geometry:_,o=O?_.features[y].properties:I?_.properties:{},S=O?_.features[y].bbox:I?_.bbox:void 0,R=O?_.features[y].id:I?_.id:void 0,h=u?u.type==="GeometryCollection":!1,f=h?u.geometries.length:1,w=0;w<f;w++){if(A=h?u.geometries[w]:u,A===null){if(l(null,z,o,S,R)===!1)return!1;continue}switch(A.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(A,z,o,S,R)===!1)return!1;break}case"GeometryCollection":{for(T=0;T<A.geometries.length;T++)if(l(A.geometries[T],z,o,S,R)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}z++}}function i(_,l,y){var T=y;return t(_,function(w,A,f,u,h){A===0&&y===void 0?T=w:T=l(T,w,A,f,u,h)}),T}function n(_,l){t(_,function(y,T,w,A,f){var u=y===null?null:y.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return l(b.feature(y,w,{bbox:A,id:f}),T,0)===!1?!1:void 0}var h;switch(u){case"MultiPoint":h="Point";break;case"MultiLineString":h="LineString";break;case"MultiPolygon":h="Polygon";break}for(var o=0;o<y.coordinates.length;o++){var S=y.coordinates[o],R={type:h,coordinates:S};if(l(b.feature(R,w),T,o)===!1)return!1}})}function r(_,l,y){var T=y;return n(_,function(w,A,f){A===0&&f===0&&y===void 0?T=w:T=l(T,w,A,f)}),T}function d(_,l){n(_,function(y,T,w){var A=0;if(!!y.geometry){var f=y.geometry.type;if(!(f==="Point"||f==="MultiPoint")){var u,h=0,o=0,S=0;if(k(y,function(R,z,O,I,F){if(u===void 0||T>h||I>o||F>S){u=R,h=T,o=I,S=F,A=0;return}var D=b.lineString([u,R],y.properties);if(l(D,T,w,F,A)===!1)return!1;A++,u=R})===!1)return!1}}})}function s(_,l,y){var T=y,w=!1;return d(_,function(A,f,u,h,o){w===!1&&y===void 0?T=A:T=l(T,A,f,u,h,o),w=!0}),T}function m(_,l){if(!_)throw new Error("geojson is required");n(_,function(y,T,w){if(y.geometry!==null){var A=y.geometry.type,f=y.geometry.coordinates;switch(A){case"LineString":if(l(y,T,w,0,0)===!1)return!1;break;case"Polygon":for(var u=0;u<f.length;u++)if(l(b.lineString(f[u],y.properties),T,w,u)===!1)return!1;break}}})}function x(_,l,y){var T=y;return m(_,function(w,A,f,u){A===0&&y===void 0?T=w:T=l(T,w,A,f,u)}),T}function M(_,l){if(l=l||{},!b.isObject(l))throw new Error("options is invalid");var y=l.featureIndex||0,T=l.multiFeatureIndex||0,w=l.geometryIndex||0,A=l.segmentIndex||0,f=l.properties,u;switch(_.type){case"FeatureCollection":y<0&&(y=_.features.length+y),f=f||_.features[y].properties,u=_.features[y].geometry;break;case"Feature":f=f||_.properties,u=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=_;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var h=u.coordinates;switch(u.type){case"Point":case"MultiPoint":return null;case"LineString":return A<0&&(A=h.length+A-1),b.lineString([h[A],h[A+1]],f,l);case"Polygon":return w<0&&(w=h.length+w),A<0&&(A=h[w].length+A-1),b.lineString([h[w][A],h[w][A+1]],f,l);case"MultiLineString":return T<0&&(T=h.length+T),A<0&&(A=h[T].length+A-1),b.lineString([h[T][A],h[T][A+1]],f,l);case"MultiPolygon":return T<0&&(T=h.length+T),w<0&&(w=h[T].length+w),A<0&&(A=h[T][w].length-A-1),b.lineString([h[T][w][A],h[T][w][A+1]],f,l)}throw new Error("geojson is invalid")}function v(_,l){if(l=l||{},!b.isObject(l))throw new Error("options is invalid");var y=l.featureIndex||0,T=l.multiFeatureIndex||0,w=l.geometryIndex||0,A=l.coordIndex||0,f=l.properties,u;switch(_.type){case"FeatureCollection":y<0&&(y=_.features.length+y),f=f||_.features[y].properties,u=_.features[y].geometry;break;case"Feature":f=f||_.properties,u=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=_;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var h=u.coordinates;switch(u.type){case"Point":return b.point(h,f,l);case"MultiPoint":return T<0&&(T=h.length+T),b.point(h[T],f,l);case"LineString":return A<0&&(A=h.length+A),b.point(h[A],f,l);case"Polygon":return w<0&&(w=h.length+w),A<0&&(A=h[w].length+A),b.point(h[w][A],f,l);case"MultiLineString":return T<0&&(T=h.length+T),A<0&&(A=h[T].length+A),b.point(h[T][A],f,l);case"MultiPolygon":return T<0&&(T=h.length+T),w<0&&(w=h[T].length+w),A<0&&(A=h[T][w].length-A),b.point(h[T][w][A],f,l)}throw new Error("geojson is invalid")}ie.coordEach=k,ie.coordReduce=P,ie.propEach=E,ie.propReduce=e,ie.featureEach=p,ie.featureReduce=g,ie.coordAll=a,ie.geomEach=t,ie.geomReduce=i,ie.flattenEach=n,ie.flattenReduce=r,ie.segmentEach=d,ie.segmentReduce=s,ie.lineEach=m,ie.lineReduce=x,ie.findSegment=M,ie.findPoint=v},{"@turf/helpers":62}],64:[function(c,ae,ie){"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var b=c("@turf/meta");function k(P){var E=[1/0,1/0,-1/0,-1/0];return b.coordEach(P,function(e){E[0]>e[0]&&(E[0]=e[0]),E[1]>e[1]&&(E[1]=e[1]),E[2]<e[0]&&(E[2]=e[0]),E[3]<e[1]&&(E[3]=e[1])}),E}k.default=k,ie.default=k},{"@turf/meta":66}],65:[function(c,ae,ie){arguments[4][62][0].apply(ie,arguments)},{dup:62}],66:[function(c,ae,ie){arguments[4][63][0].apply(ie,arguments)},{"@turf/helpers":65,dup:63}],67:[function(c,ae,ie){"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var b=c("@turf/meta"),k=c("@turf/helpers");function P(E,e){e===void 0&&(e={});var p=0,g=0,a=0;return b.coordEach(E,function(t){p+=t[0],g+=t[1],a++}),k.point([p/a,g/a],e.properties)}ie.default=P},{"@turf/helpers":68,"@turf/meta":69}],68:[function(c,ae,ie){"use strict";Object.defineProperty(ie,"__esModule",{value:!0}),ie.earthRadius=63710088e-1,ie.factors={centimeters:ie.earthRadius*100,centimetres:ie.earthRadius*100,degrees:ie.earthRadius/111325,feet:ie.earthRadius*3.28084,inches:ie.earthRadius*39.37,kilometers:ie.earthRadius/1e3,kilometres:ie.earthRadius/1e3,meters:ie.earthRadius,metres:ie.earthRadius,miles:ie.earthRadius/1609.344,millimeters:ie.earthRadius*1e3,millimetres:ie.earthRadius*1e3,nauticalmiles:ie.earthRadius/1852,radians:1,yards:ie.earthRadius/1.0936},ie.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/ie.earthRadius,yards:1/1.0936},ie.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function b(F,D,B){B===void 0&&(B={});var U={type:"Feature"};return(B.id===0||B.id)&&(U.id=B.id),B.bbox&&(U.bbox=B.bbox),U.properties=D||{},U.geometry=F,U}ie.feature=b;function k(F,D,B){switch(B===void 0&&(B={}),F){case"Point":return P(D).geometry;case"LineString":return g(D).geometry;case"Polygon":return e(D).geometry;case"MultiPoint":return n(D).geometry;case"MultiLineString":return i(D).geometry;case"MultiPolygon":return r(D).geometry;default:throw new Error(F+" is invalid")}}ie.geometry=k;function P(F,D,B){B===void 0&&(B={});var U={type:"Point",coordinates:F};return b(U,D,B)}ie.point=P;function E(F,D,B){return B===void 0&&(B={}),t(F.map(function(U){return P(U,D)}),B)}ie.points=E;function e(F,D,B){B===void 0&&(B={});for(var U=0,X=F;U<X.length;U++){var oe=X[U];if(oe.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var se=0;se<oe[oe.length-1].length;se++)if(oe[oe.length-1][se]!==oe[0][se])throw new Error("First and last Position are not equivalent.")}var q={type:"Polygon",coordinates:F};return b(q,D,B)}ie.polygon=e;function p(F,D,B){return B===void 0&&(B={}),t(F.map(function(U){return e(U,D)}),B)}ie.polygons=p;function g(F,D,B){if(B===void 0&&(B={}),F.length<2)throw new Error("coordinates must be an array of two or more positions");var U={type:"LineString",coordinates:F};return b(U,D,B)}ie.lineString=g;function a(F,D,B){return B===void 0&&(B={}),t(F.map(function(U){return g(U,D)}),B)}ie.lineStrings=a;function t(F,D){D===void 0&&(D={});var B={type:"FeatureCollection"};return D.id&&(B.id=D.id),D.bbox&&(B.bbox=D.bbox),B.features=F,B}ie.featureCollection=t;function i(F,D,B){B===void 0&&(B={});var U={type:"MultiLineString",coordinates:F};return b(U,D,B)}ie.multiLineString=i;function n(F,D,B){B===void 0&&(B={});var U={type:"MultiPoint",coordinates:F};return b(U,D,B)}ie.multiPoint=n;function r(F,D,B){B===void 0&&(B={});var U={type:"MultiPolygon",coordinates:F};return b(U,D,B)}ie.multiPolygon=r;function d(F,D,B){B===void 0&&(B={});var U={type:"GeometryCollection",geometries:F};return b(U,D,B)}ie.geometryCollection=d;function s(F,D){if(D===void 0&&(D=0),D&&!(D>=0))throw new Error("precision must be a positive number");var B=Math.pow(10,D||0);return Math.round(F*B)/B}ie.round=s;function m(F,D){D===void 0&&(D="kilometers");var B=ie.factors[D];if(!B)throw new Error(D+" units is invalid");return F*B}ie.radiansToLength=m;function x(F,D){D===void 0&&(D="kilometers");var B=ie.factors[D];if(!B)throw new Error(D+" units is invalid");return F/B}ie.lengthToRadians=x;function M(F,D){return _(x(F,D))}ie.lengthToDegrees=M;function v(F){var D=F%360;return D<0&&(D+=360),D}ie.bearingToAzimuth=v;function _(F){var D=F%(2*Math.PI);return D*180/Math.PI}ie.radiansToDegrees=_;function l(F){var D=F%360;return D*Math.PI/180}ie.degreesToRadians=l;function y(F,D,B){if(D===void 0&&(D="kilometers"),B===void 0&&(B="kilometers"),!(F>=0))throw new Error("length must be a positive number");return m(x(F,D),B)}ie.convertLength=y;function T(F,D,B){if(D===void 0&&(D="meters"),B===void 0&&(B="kilometers"),!(F>=0))throw new Error("area must be a positive number");var U=ie.areaFactors[D];if(!U)throw new Error("invalid original units");var X=ie.areaFactors[B];if(!X)throw new Error("invalid final units");return F/U*X}ie.convertArea=T;function w(F){return!isNaN(F)&&F!==null&&!Array.isArray(F)&&!/^\s*$/.test(F)}ie.isNumber=w;function A(F){return!!F&&F.constructor===Object}ie.isObject=A;function f(F){if(!F)throw new Error("bbox is required");if(!Array.isArray(F))throw new Error("bbox must be an Array");if(F.length!==4&&F.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");F.forEach(function(D){if(!w(D))throw new Error("bbox must only contain numbers")})}ie.validateBBox=f;function u(F){if(!F)throw new Error("id is required");if(["string","number"].indexOf(typeof F)===-1)throw new Error("id must be a number or a string")}ie.validateId=u;function h(){throw new Error("method has been renamed to `radiansToDegrees`")}ie.radians2degrees=h;function o(){throw new Error("method has been renamed to `degreesToRadians`")}ie.degrees2radians=o;function S(){throw new Error("method has been renamed to `lengthToDegrees`")}ie.distanceToDegrees=S;function R(){throw new Error("method has been renamed to `lengthToRadians`")}ie.distanceToRadians=R;function z(){throw new Error("method has been renamed to `radiansToLength`")}ie.radiansToDistance=z;function O(){throw new Error("method has been renamed to `bearingToAzimuth`")}ie.bearingToAngle=O;function I(){throw new Error("method has been renamed to `convertLength`")}ie.convertDistance=I},{}],69:[function(c,ae,ie){"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var b=c("@turf/helpers");function k(_,l,y){if(_!==null)for(var T,w,A,f,u,h,o,S=0,R=0,z,O=_.type,I=O==="FeatureCollection",F=O==="Feature",D=I?_.features.length:1,B=0;B<D;B++){o=I?_.features[B].geometry:F?_.geometry:_,z=o?o.type==="GeometryCollection":!1,u=z?o.geometries.length:1;for(var U=0;U<u;U++){var X=0,oe=0;if(f=z?o.geometries[U]:o,f!==null){h=f.coordinates;var se=f.type;switch(S=y&&(se==="Polygon"||se==="MultiPolygon")?1:0,se){case null:break;case"Point":if(l(h,R,B,X,oe)===!1)return!1;R++,X++;break;case"LineString":case"MultiPoint":for(T=0;T<h.length;T++){if(l(h[T],R,B,X,oe)===!1)return!1;R++,se==="MultiPoint"&&X++}se==="LineString"&&X++;break;case"Polygon":case"MultiLineString":for(T=0;T<h.length;T++){for(w=0;w<h[T].length-S;w++){if(l(h[T][w],R,B,X,oe)===!1)return!1;R++}se==="MultiLineString"&&X++,se==="Polygon"&&oe++}se==="Polygon"&&X++;break;case"MultiPolygon":for(T=0;T<h.length;T++){for(oe=0,w=0;w<h[T].length;w++){for(A=0;A<h[T][w].length-S;A++){if(l(h[T][w][A],R,B,X,oe)===!1)return!1;R++}oe++}X++}break;case"GeometryCollection":for(T=0;T<f.geometries.length;T++)if(k(f.geometries[T],l,y)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function P(_,l,y,T){var w=y;return k(_,function(A,f,u,h,o){f===0&&y===void 0?w=A:w=l(w,A,f,u,h,o)},T),w}function E(_,l){var y;switch(_.type){case"FeatureCollection":for(y=0;y<_.features.length&&l(_.features[y].properties,y)!==!1;y++);break;case"Feature":l(_.properties,0);break}}function e(_,l,y){var T=y;return E(_,function(w,A){A===0&&y===void 0?T=w:T=l(T,w,A)}),T}function p(_,l){if(_.type==="Feature")l(_,0);else if(_.type==="FeatureCollection")for(var y=0;y<_.features.length&&l(_.features[y],y)!==!1;y++);}function g(_,l,y){var T=y;return p(_,function(w,A){A===0&&y===void 0?T=w:T=l(T,w,A)}),T}function a(_){var l=[];return k(_,function(y){l.push(y)}),l}function t(_,l){var y,T,w,A,f,u,h,o,S,R,z=0,O=_.type==="FeatureCollection",I=_.type==="Feature",F=O?_.features.length:1;for(y=0;y<F;y++){for(u=O?_.features[y].geometry:I?_.geometry:_,o=O?_.features[y].properties:I?_.properties:{},S=O?_.features[y].bbox:I?_.bbox:void 0,R=O?_.features[y].id:I?_.id:void 0,h=u?u.type==="GeometryCollection":!1,f=h?u.geometries.length:1,w=0;w<f;w++){if(A=h?u.geometries[w]:u,A===null){if(l(null,z,o,S,R)===!1)return!1;continue}switch(A.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(l(A,z,o,S,R)===!1)return!1;break}case"GeometryCollection":{for(T=0;T<A.geometries.length;T++)if(l(A.geometries[T],z,o,S,R)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}z++}}function i(_,l,y){var T=y;return t(_,function(w,A,f,u,h){A===0&&y===void 0?T=w:T=l(T,w,A,f,u,h)}),T}function n(_,l){t(_,function(y,T,w,A,f){var u=y===null?null:y.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return l(b.feature(y,w,{bbox:A,id:f}),T,0)===!1?!1:void 0}var h;switch(u){case"MultiPoint":h="Point";break;case"MultiLineString":h="LineString";break;case"MultiPolygon":h="Polygon";break}for(var o=0;o<y.coordinates.length;o++){var S=y.coordinates[o],R={type:h,coordinates:S};if(l(b.feature(R,w),T,o)===!1)return!1}})}function r(_,l,y){var T=y;return n(_,function(w,A,f){A===0&&f===0&&y===void 0?T=w:T=l(T,w,A,f)}),T}function d(_,l){n(_,function(y,T,w){var A=0;if(!!y.geometry){var f=y.geometry.type;if(!(f==="Point"||f==="MultiPoint")){var u,h=0,o=0,S=0;if(k(y,function(R,z,O,I,F){if(u===void 0||T>h||I>o||F>S){u=R,h=T,o=I,S=F,A=0;return}var D=b.lineString([u,R],y.properties);if(l(D,T,w,F,A)===!1)return!1;A++,u=R})===!1)return!1}}})}function s(_,l,y){var T=y,w=!1;return d(_,function(A,f,u,h,o){w===!1&&y===void 0?T=A:T=l(T,A,f,u,h,o),w=!0}),T}function m(_,l){if(!_)throw new Error("geojson is required");n(_,function(y,T,w){if(y.geometry!==null){var A=y.geometry.type,f=y.geometry.coordinates;switch(A){case"LineString":if(l(y,T,w,0,0)===!1)return!1;break;case"Polygon":for(var u=0;u<f.length;u++)if(l(b.lineString(f[u],y.properties),T,w,u)===!1)return!1;break}}})}function x(_,l,y){var T=y;return m(_,function(w,A,f,u){A===0&&y===void 0?T=w:T=l(T,w,A,f,u)}),T}function M(_,l){if(l=l||{},!b.isObject(l))throw new Error("options is invalid");var y=l.featureIndex||0,T=l.multiFeatureIndex||0,w=l.geometryIndex||0,A=l.segmentIndex||0,f=l.properties,u;switch(_.type){case"FeatureCollection":y<0&&(y=_.features.length+y),f=f||_.features[y].properties,u=_.features[y].geometry;break;case"Feature":f=f||_.properties,u=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=_;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var h=u.coordinates;switch(u.type){case"Point":case"MultiPoint":return null;case"LineString":return A<0&&(A=h.length+A-1),b.lineString([h[A],h[A+1]],f,l);case"Polygon":return w<0&&(w=h.length+w),A<0&&(A=h[w].length+A-1),b.lineString([h[w][A],h[w][A+1]],f,l);case"MultiLineString":return T<0&&(T=h.length+T),A<0&&(A=h[T].length+A-1),b.lineString([h[T][A],h[T][A+1]],f,l);case"MultiPolygon":return T<0&&(T=h.length+T),w<0&&(w=h[T].length+w),A<0&&(A=h[T][w].length-A-1),b.lineString([h[T][w][A],h[T][w][A+1]],f,l)}throw new Error("geojson is invalid")}function v(_,l){if(l=l||{},!b.isObject(l))throw new Error("options is invalid");var y=l.featureIndex||0,T=l.multiFeatureIndex||0,w=l.geometryIndex||0,A=l.coordIndex||0,f=l.properties,u;switch(_.type){case"FeatureCollection":y<0&&(y=_.features.length+y),f=f||_.features[y].properties,u=_.features[y].geometry;break;case"Feature":f=f||_.properties,u=_.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":u=_;break;default:throw new Error("geojson is invalid")}if(u===null)return null;var h=u.coordinates;switch(u.type){case"Point":return b.point(h,f,l);case"MultiPoint":return T<0&&(T=h.length+T),b.point(h[T],f,l);case"LineString":return A<0&&(A=h.length+A),b.point(h[A],f,l);case"Polygon":return w<0&&(w=h.length+w),A<0&&(A=h[w].length+A),b.point(h[w][A],f,l);case"MultiLineString":return T<0&&(T=h.length+T),A<0&&(A=h[T].length+A),b.point(h[T][A],f,l);case"MultiPolygon":return T<0&&(T=h.length+T),w<0&&(w=h[T].length+w),A<0&&(A=h[T][w].length-A),b.point(h[T][w][A],f,l)}throw new Error("geojson is invalid")}ie.coordEach=k,ie.coordReduce=P,ie.propEach=E,ie.propReduce=e,ie.featureEach=p,ie.featureReduce=g,ie.coordAll=a,ie.geomEach=t,ie.geomReduce=i,ie.flattenEach=n,ie.flattenReduce=r,ie.segmentEach=d,ie.segmentReduce=s,ie.lineEach=m,ie.lineReduce=x,ie.findSegment=M,ie.findPoint=v},{"@turf/helpers":68}],70:[function(c,ae,ie){ae.exports=b;function b(k){var P=0,E=0,e=0,p=0;return k.map(function(g){g=g.slice();var a=g[0],t=a.toUpperCase();if(a!=t)switch(g[0]=t,a){case"a":g[6]+=e,g[7]+=p;break;case"v":g[1]+=p;break;case"h":g[1]+=e;break;default:for(var i=1;i<g.length;)g[i++]+=e,g[i++]+=p}switch(t){case"Z":e=P,p=E;break;case"H":e=g[1];break;case"V":p=g[1];break;case"M":e=P=g[1],p=E=g[2];break;default:e=g[g.length-2],p=g[g.length-1]}return g})}},{}],71:[function(c,ae,ie){"use strict";ae.exports=b;function b(k,P){if(!k||k.length==null)throw Error("Argument should be an array");P==null?P=1:P=Math.floor(P);for(var E=Array(P*2),e=0;e<P;e++){for(var p=-1/0,g=1/0,a=e,t=k.length;a<t;a+=P)k[a]>p&&(p=k[a]),k[a]<g&&(g=k[a]);E[e]=g,E[P+e]=p}return E}},{}],72:[function(c,ae,ie){"use strict";ae.exports=function(b,k,P){if(typeof Array.prototype.findIndex=="function")return b.findIndex(k,P);if(typeof k!="function")throw new TypeError("predicate must be a function");var E=Object(b),e=E.length;if(e===0)return-1;for(var p=0;p<e;p++)if(k.call(P,E[p],p,E))return p;return-1}},{}],73:[function(c,ae,ie){"use strict";var b=c("array-bounds");ae.exports=k;function k(P,E,e){if(!P||P.length==null)throw Error("Argument should be an array");E==null&&(E=1),e==null&&(e=b(P,E));for(var p=0;p<E;p++){var g=e[E+p],a=e[p],t=p,i=P.length;if(g===1/0&&a===-1/0)for(t=p;t<i;t+=E)P[t]=P[t]===g?1:P[t]===a?0:.5;else if(g===1/0)for(t=p;t<i;t+=E)P[t]=P[t]===g?1:0;else if(a===-1/0)for(t=p;t<i;t+=E)P[t]=P[t]===a?0:1;else{var n=g-a;for(t=p;t<i;t+=E)isNaN(P[t])||(P[t]=n===0?.5:(P[t]-a)/n)}}return P}},{"array-bounds":71}],74:[function(c,ae,ie){ae.exports=function(k,P){var E=typeof k=="number",e=typeof P=="number";E&&!e?(P=k,k=0):!E&&!e&&(k=0,P=0),k=k|0,P=P|0;var p=P-k;if(p<0)throw new Error("array length must be positive");for(var g=new Array(p),a=0,t=k;a<p;a++,t++)g[a]=t;return g}},{}],75:[function(c,ae,ie){(function(b){(function(){"use strict";var k=c("object-assign");function P(o,S){if(o===S)return 0;for(var R=o.length,z=S.length,O=0,I=Math.min(R,z);O<I;++O)if(o[O]!==S[O]){R=o[O],z=S[O];break}return R<z?-1:z<R?1:0}function E(o){return b.Buffer&&typeof b.Buffer.isBuffer=="function"?b.Buffer.isBuffer(o):!!(o!=null&&o._isBuffer)}var e=c("util/"),p=Object.prototype.hasOwnProperty,g=Array.prototype.slice,a=function(){return function(){}.name==="foo"}();function t(o){return Object.prototype.toString.call(o)}function i(o){return E(o)||typeof b.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(o):o?!!(o instanceof DataView||o.buffer&&o.buffer instanceof ArrayBuffer):!1}var n=ae.exports=v,r=/\s*function\s+([^\(\s]*)\s*/;function d(o){if(!!e.isFunction(o)){if(a)return o.name;var S=o.toString(),R=S.match(r);return R&&R[1]}}n.AssertionError=function(S){this.name="AssertionError",this.actual=S.actual,this.expected=S.expected,this.operator=S.operator,S.message?(this.message=S.message,this.generatedMessage=!1):(this.message=x(this),this.generatedMessage=!0);var R=S.stackStartFunction||M;if(Error.captureStackTrace)Error.captureStackTrace(this,R);else{var z=new Error;if(z.stack){var O=z.stack,I=d(R),F=O.indexOf(`
`+I);if(F>=0){var D=O.indexOf(`
`,F+1);O=O.substring(D+1)}this.stack=O}}},e.inherits(n.AssertionError,Error);function s(o,S){return typeof o=="string"?o.length<S?o:o.slice(0,S):o}function m(o){if(a||!e.isFunction(o))return e.inspect(o);var S=d(o),R=S?": "+S:"";return"[Function"+R+"]"}function x(o){return s(m(o.actual),128)+" "+o.operator+" "+s(m(o.expected),128)}function M(o,S,R,z,O){throw new n.AssertionError({message:R,actual:o,expected:S,operator:z,stackStartFunction:O})}n.fail=M;function v(o,S){o||M(o,!0,S,"==",n.ok)}n.ok=v,n.equal=function(S,R,z){S!=R&&M(S,R,z,"==",n.equal)},n.notEqual=function(S,R,z){S==R&&M(S,R,z,"!=",n.notEqual)},n.deepEqual=function(S,R,z){_(S,R,!1)||M(S,R,z,"deepEqual",n.deepEqual)},n.deepStrictEqual=function(S,R,z){_(S,R,!0)||M(S,R,z,"deepStrictEqual",n.deepStrictEqual)};function _(o,S,R,z){if(o===S)return!0;if(E(o)&&E(S))return P(o,S)===0;if(e.isDate(o)&&e.isDate(S))return o.getTime()===S.getTime();if(e.isRegExp(o)&&e.isRegExp(S))return o.source===S.source&&o.global===S.global&&o.multiline===S.multiline&&o.lastIndex===S.lastIndex&&o.ignoreCase===S.ignoreCase;if((o===null||typeof o!="object")&&(S===null||typeof S!="object"))return R?o===S:o==S;if(i(o)&&i(S)&&t(o)===t(S)&&!(o instanceof Float32Array||o instanceof Float64Array))return P(new Uint8Array(o.buffer),new Uint8Array(S.buffer))===0;if(E(o)!==E(S))return!1;z=z||{actual:[],expected:[]};var O=z.actual.indexOf(o);return O!==-1&&O===z.expected.indexOf(S)?!0:(z.actual.push(o),z.expected.push(S),y(o,S,R,z))}function l(o){return Object.prototype.toString.call(o)=="[object Arguments]"}function y(o,S,R,z){if(o==null||S===null||S===void 0)return!1;if(e.isPrimitive(o)||e.isPrimitive(S))return o===S;if(R&&Object.getPrototypeOf(o)!==Object.getPrototypeOf(S))return!1;var O=l(o),I=l(S);if(O&&!I||!O&&I)return!1;if(O)return o=g.call(o),S=g.call(S),_(o,S,R);var F=h(o),D=h(S),B,U;if(F.length!==D.length)return!1;for(F.sort(),D.sort(),U=F.length-1;U>=0;U--)if(F[U]!==D[U])return!1;for(U=F.length-1;U>=0;U--)if(B=F[U],!_(o[B],S[B],R,z))return!1;return!0}n.notDeepEqual=function(S,R,z){_(S,R,!1)&&M(S,R,z,"notDeepEqual",n.notDeepEqual)},n.notDeepStrictEqual=T;function T(o,S,R){_(o,S,!0)&&M(o,S,R,"notDeepStrictEqual",T)}n.strictEqual=function(S,R,z){S!==R&&M(S,R,z,"===",n.strictEqual)},n.notStrictEqual=function(S,R,z){S===R&&M(S,R,z,"!==",n.notStrictEqual)};function w(o,S){if(!o||!S)return!1;if(Object.prototype.toString.call(S)=="[object RegExp]")return S.test(o);try{if(o instanceof S)return!0}catch{}return Error.isPrototypeOf(S)?!1:S.call({},o)===!0}function A(o){var S;try{o()}catch(R){S=R}return S}function f(o,S,R,z){var O;if(typeof S!="function")throw new TypeError('"block" argument must be a function');typeof R=="string"&&(z=R,R=null),O=A(S),z=(R&&R.name?" ("+R.name+").":".")+(z?" "+z:"."),o&&!O&&M(O,R,"Missing expected exception"+z);var I=typeof z=="string",F=!o&&e.isError(O),D=!o&&O&&!R;if((F&&I&&w(O,R)||D)&&M(O,R,"Got unwanted exception"+z),o&&O&&R&&!w(O,R)||!o&&O)throw O}n.throws=function(o,S,R){f(!0,o,S,R)},n.doesNotThrow=function(o,S,R){f(!1,o,S,R)},n.ifError=function(o){if(o)throw o};function u(o,S){o||M(o,!0,S,"==",u)}n.strict=k(u,n,{equal:n.strictEqual,deepEqual:n.deepStrictEqual,notEqual:n.notStrictEqual,notDeepEqual:n.notDeepStrictEqual}),n.strict.strict=n.strict;var h=Object.keys||function(o){var S=[];for(var R in o)p.call(o,R)&&S.push(R);return S}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(c,ae,ie){typeof Object.create=="function"?ae.exports=function(k,P){k.super_=P,k.prototype=Object.create(P.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}})}:ae.exports=function(k,P){k.super_=P;var E=function(){};E.prototype=P.prototype,k.prototype=new E,k.prototype.constructor=k}},{}],77:[function(c,ae,ie){ae.exports=function(k){return k&&typeof k=="object"&&typeof k.copy=="function"&&typeof k.fill=="function"&&typeof k.readUInt8=="function"}},{}],78:[function(c,ae,ie){(function(b,k){(function(){var P=/%[sdj%]/g;ie.format=function(D){if(!y(D)){for(var B=[],U=0;U<arguments.length;U++)B.push(p(arguments[U]));return B.join(" ")}for(var U=1,X=arguments,oe=X.length,se=String(D).replace(P,function(K){if(K==="%%")return"%";if(U>=oe)return K;switch(K){case"%s":return String(X[U++]);case"%d":return Number(X[U++]);case"%j":try{return JSON.stringify(X[U++])}catch{return"[Circular]"}default:return K}}),q=X[U];U<oe;q=X[++U])v(q)||!f(q)?se+=" "+q:se+=" "+p(q);return se},ie.deprecate=function(D,B){if(w(k.process))return function(){return ie.deprecate(D,B).apply(this,arguments)};if(b.noDeprecation===!0)return D;var U=!1;function X(){if(!U){if(b.throwDeprecation)throw new Error(B);b.traceDeprecation?console.trace(B):console.error(B),U=!0}return D.apply(this,arguments)}return X};var E={},e;ie.debuglog=function(D){if(w(e)&&(e=b.env.NODE_DEBUG||""),D=D.toUpperCase(),!E[D])if(new RegExp("\\b"+D+"\\b","i").test(e)){var B=b.pid;E[D]=function(){var U=ie.format.apply(ie,arguments);console.error("%s %d: %s",D,B,U)}}else E[D]=function(){};return E[D]};function p(D,B){var U={seen:[],stylize:a};return arguments.length>=3&&(U.depth=arguments[2]),arguments.length>=4&&(U.colors=arguments[3]),M(B)?U.showHidden=B:B&&ie._extend(U,B),w(U.showHidden)&&(U.showHidden=!1),w(U.depth)&&(U.depth=2),w(U.colors)&&(U.colors=!1),w(U.customInspect)&&(U.customInspect=!0),U.colors&&(U.stylize=g),i(U,D,U.depth)}ie.inspect=p,p.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},p.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function g(D,B){var U=p.styles[B];return U?"\x1B["+p.colors[U][0]+"m"+D+"\x1B["+p.colors[U][1]+"m":D}function a(D,B){return D}function t(D){var B={};return D.forEach(function(U,X){B[U]=!0}),B}function i(D,B,U){if(D.customInspect&&B&&o(B.inspect)&&B.inspect!==ie.inspect&&!(B.constructor&&B.constructor.prototype===B)){var X=B.inspect(U,D);return y(X)||(X=i(D,X,U)),X}var oe=n(D,B);if(oe)return oe;var se=Object.keys(B),q=t(se);if(D.showHidden&&(se=Object.getOwnPropertyNames(B)),h(B)&&(se.indexOf("message")>=0||se.indexOf("description")>=0))return r(B);if(se.length===0){if(o(B)){var K=B.name?": "+B.name:"";return D.stylize("[Function"+K+"]","special")}if(A(B))return D.stylize(RegExp.prototype.toString.call(B),"regexp");if(u(B))return D.stylize(Date.prototype.toString.call(B),"date");if(h(B))return r(B)}var G="",Q=!1,V=["{","}"];if(x(B)&&(Q=!0,V=["[","]"]),o(B)){var H=B.name?": "+B.name:"";G=" [Function"+H+"]"}if(A(B)&&(G=" "+RegExp.prototype.toString.call(B)),u(B)&&(G=" "+Date.prototype.toUTCString.call(B)),h(B)&&(G=" "+r(B)),se.length===0&&(!Q||B.length==0))return V[0]+G+V[1];if(U<0)return A(B)?D.stylize(RegExp.prototype.toString.call(B),"regexp"):D.stylize("[Object]","special");D.seen.push(B);var ee;return Q?ee=d(D,B,U,q,se):ee=se.map(function(J){return s(D,B,U,q,J,Q)}),D.seen.pop(),m(ee,G,V)}function n(D,B){if(w(B))return D.stylize("undefined","undefined");if(y(B)){var U="'"+JSON.stringify(B).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return D.stylize(U,"string")}if(l(B))return D.stylize(""+B,"number");if(M(B))return D.stylize(""+B,"boolean");if(v(B))return D.stylize("null","null")}function r(D){return"["+Error.prototype.toString.call(D)+"]"}function d(D,B,U,X,oe){for(var se=[],q=0,K=B.length;q<K;++q)F(B,String(q))?se.push(s(D,B,U,X,String(q),!0)):se.push("");return oe.forEach(function(G){G.match(/^\d+$/)||se.push(s(D,B,U,X,G,!0))}),se}function s(D,B,U,X,oe,se){var q,K,G;if(G=Object.getOwnPropertyDescriptor(B,oe)||{value:B[oe]},G.get?G.set?K=D.stylize("[Getter/Setter]","special"):K=D.stylize("[Getter]","special"):G.set&&(K=D.stylize("[Setter]","special")),F(X,oe)||(q="["+oe+"]"),K||(D.seen.indexOf(G.value)<0?(v(U)?K=i(D,G.value,null):K=i(D,G.value,U-1),K.indexOf(`
`)>-1&&(se?K=K.split(`
`).map(function(Q){return"  "+Q}).join(`
`).substr(2):K=`
`+K.split(`
`).map(function(Q){return"   "+Q}).join(`
`))):K=D.stylize("[Circular]","special")),w(q)){if(se&&oe.match(/^\d+$/))return K;q=JSON.stringify(""+oe),q.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(q=q.substr(1,q.length-2),q=D.stylize(q,"name")):(q=q.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),q=D.stylize(q,"string"))}return q+": "+K}function m(D,B,U){var X=0,oe=D.reduce(function(se,q){return X++,q.indexOf(`
`)>=0&&X++,se+q.replace(/\u001b\[\d\d?m/g,"").length+1},0);return oe>60?U[0]+(B===""?"":B+`
 `)+" "+D.join(`,
  `)+" "+U[1]:U[0]+B+" "+D.join(", ")+" "+U[1]}function x(D){return Array.isArray(D)}ie.isArray=x;function M(D){return typeof D=="boolean"}ie.isBoolean=M;function v(D){return D===null}ie.isNull=v;function _(D){return D==null}ie.isNullOrUndefined=_;function l(D){return typeof D=="number"}ie.isNumber=l;function y(D){return typeof D=="string"}ie.isString=y;function T(D){return typeof D=="symbol"}ie.isSymbol=T;function w(D){return D===void 0}ie.isUndefined=w;function A(D){return f(D)&&R(D)==="[object RegExp]"}ie.isRegExp=A;function f(D){return typeof D=="object"&&D!==null}ie.isObject=f;function u(D){return f(D)&&R(D)==="[object Date]"}ie.isDate=u;function h(D){return f(D)&&(R(D)==="[object Error]"||D instanceof Error)}ie.isError=h;function o(D){return typeof D=="function"}ie.isFunction=o;function S(D){return D===null||typeof D=="boolean"||typeof D=="number"||typeof D=="string"||typeof D=="symbol"||typeof D>"u"}ie.isPrimitive=S,ie.isBuffer=c("./support/isBuffer");function R(D){return Object.prototype.toString.call(D)}function z(D){return D<10?"0"+D.toString(10):D.toString(10)}var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(){var D=new Date,B=[z(D.getHours()),z(D.getMinutes()),z(D.getSeconds())].join(":");return[D.getDate(),O[D.getMonth()],B].join(" ")}ie.log=function(){console.log("%s - %s",I(),ie.format.apply(ie,arguments))},ie.inherits=c("inherits"),ie._extend=function(D,B){if(!B||!f(B))return D;for(var U=Object.keys(B),X=U.length;X--;)D[U[X]]=B[U[X]];return D};function F(D,B){return Object.prototype.hasOwnProperty.call(D,B)}}).call(this)}).call(this,c("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:277,inherits:76}],79:[function(c,ae,ie){"use strict";ie.byteLength=a,ie.toByteArray=i,ie.fromByteArray=d;for(var b=[],k=[],P=typeof Uint8Array<"u"?Uint8Array:Array,E="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,p=E.length;e<p;++e)b[e]=E[e],k[E.charCodeAt(e)]=e;k["-".charCodeAt(0)]=62,k["_".charCodeAt(0)]=63;function g(s){var m=s.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var x=s.indexOf("=");x===-1&&(x=m);var M=x===m?0:4-x%4;return[x,M]}function a(s){var m=g(s),x=m[0],M=m[1];return(x+M)*3/4-M}function t(s,m,x){return(m+x)*3/4-x}function i(s){var m,x=g(s),M=x[0],v=x[1],_=new P(t(s,M,v)),l=0,y=v>0?M-4:M,T;for(T=0;T<y;T+=4)m=k[s.charCodeAt(T)]<<18|k[s.charCodeAt(T+1)]<<12|k[s.charCodeAt(T+2)]<<6|k[s.charCodeAt(T+3)],_[l++]=m>>16&255,_[l++]=m>>8&255,_[l++]=m&255;return v===2&&(m=k[s.charCodeAt(T)]<<2|k[s.charCodeAt(T+1)]>>4,_[l++]=m&255),v===1&&(m=k[s.charCodeAt(T)]<<10|k[s.charCodeAt(T+1)]<<4|k[s.charCodeAt(T+2)]>>2,_[l++]=m>>8&255,_[l++]=m&255),_}function n(s){return b[s>>18&63]+b[s>>12&63]+b[s>>6&63]+b[s&63]}function r(s,m,x){for(var M,v=[],_=m;_<x;_+=3)M=(s[_]<<16&16711680)+(s[_+1]<<8&65280)+(s[_+2]&255),v.push(n(M));return v.join("")}function d(s){for(var m,x=s.length,M=x%3,v=[],_=16383,l=0,y=x-M;l<y;l+=_)v.push(r(s,l,l+_>y?y:l+_));return M===1?(m=s[x-1],v.push(b[m>>2]+b[m<<4&63]+"==")):M===2&&(m=(s[x-2]<<8)+s[x-1],v.push(b[m>>10]+b[m>>4&63]+b[m<<2&63]+"=")),v.join("")}},{}],80:[function(c,ae,ie){"use strict";function b(g,a,t,i,n){for(var r=n+1;i<=n;){var d=i+n>>>1,s=g[d],m=t!==void 0?t(s,a):s-a;m>=0?(r=d,n=d-1):i=d+1}return r}function k(g,a,t,i,n){for(var r=n+1;i<=n;){var d=i+n>>>1,s=g[d],m=t!==void 0?t(s,a):s-a;m>0?(r=d,n=d-1):i=d+1}return r}function P(g,a,t,i,n){for(var r=i-1;i<=n;){var d=i+n>>>1,s=g[d],m=t!==void 0?t(s,a):s-a;m<0?(r=d,i=d+1):n=d-1}return r}function E(g,a,t,i,n){for(var r=i-1;i<=n;){var d=i+n>>>1,s=g[d],m=t!==void 0?t(s,a):s-a;m<=0?(r=d,i=d+1):n=d-1}return r}function e(g,a,t,i,n){for(;i<=n;){var r=i+n>>>1,d=g[r],s=t!==void 0?t(d,a):d-a;if(s===0)return r;s<=0?i=r+1:n=r-1}return-1}function p(g,a,t,i,n,r){return typeof t=="function"?r(g,a,t,i===void 0?0:i|0,n===void 0?g.length-1:n|0):r(g,a,void 0,t===void 0?0:t|0,i===void 0?g.length-1:i|0)}ae.exports={ge:function(g,a,t,i,n){return p(g,a,t,i,n,b)},gt:function(g,a,t,i,n){return p(g,a,t,i,n,k)},lt:function(g,a,t,i,n){return p(g,a,t,i,n,P)},le:function(g,a,t,i,n){return p(g,a,t,i,n,E)},eq:function(g,a,t,i,n){return p(g,a,t,i,n,e)}}},{}],81:[function(c,ae,ie){"use strict";var b=32;ie.INT_BITS=b,ie.INT_MAX=2147483647,ie.INT_MIN=-1<<b-1,ie.sign=function(E){return(E>0)-(E<0)},ie.abs=function(E){var e=E>>b-1;return(E^e)-e},ie.min=function(E,e){return e^(E^e)&-(E<e)},ie.max=function(E,e){return E^(E^e)&-(E<e)},ie.isPow2=function(E){return!(E&E-1)&&!!E},ie.log2=function(E){var e,p;return e=(E>65535)<<4,E>>>=e,p=(E>255)<<3,E>>>=p,e|=p,p=(E>15)<<2,E>>>=p,e|=p,p=(E>3)<<1,E>>>=p,e|=p,e|E>>1},ie.log10=function(E){return E>=1e9?9:E>=1e8?8:E>=1e7?7:E>=1e6?6:E>=1e5?5:E>=1e4?4:E>=1e3?3:E>=100?2:E>=10?1:0},ie.popCount=function(E){return E=E-(E>>>1&1431655765),E=(E&858993459)+(E>>>2&858993459),(E+(E>>>4)&252645135)*16843009>>>24};function k(E){var e=32;return E&=-E,E&&e--,E&65535&&(e-=16),E&16711935&&(e-=8),E&252645135&&(e-=4),E&858993459&&(e-=2),E&1431655765&&(e-=1),e}ie.countTrailingZeros=k,ie.nextPow2=function(E){return E+=E===0,--E,E|=E>>>1,E|=E>>>2,E|=E>>>4,E|=E>>>8,E|=E>>>16,E+1},ie.prevPow2=function(E){return E|=E>>>1,E|=E>>>2,E|=E>>>4,E|=E>>>8,E|=E>>>16,E-(E>>>1)},ie.parity=function(E){return E^=E>>>16,E^=E>>>8,E^=E>>>4,E&=15,27030>>>E&1};var P=new Array(256);(function(E){for(var e=0;e<256;++e){var p=e,g=e,a=7;for(p>>>=1;p;p>>>=1)g<<=1,g|=p&1,--a;E[e]=g<<a&255}})(P),ie.reverse=function(E){return P[E&255]<<24|P[E>>>8&255]<<16|P[E>>>16&255]<<8|P[E>>>24&255]},ie.interleave2=function(E,e){return E&=65535,E=(E|E<<8)&16711935,E=(E|E<<4)&252645135,E=(E|E<<2)&858993459,E=(E|E<<1)&1431655765,e&=65535,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,E|e<<1},ie.deinterleave2=function(E,e){return E=E>>>e&1431655765,E=(E|E>>>1)&858993459,E=(E|E>>>2)&252645135,E=(E|E>>>4)&16711935,E=(E|E>>>16)&65535,E<<16>>16},ie.interleave3=function(E,e,p){return E&=1023,E=(E|E<<16)&4278190335,E=(E|E<<8)&251719695,E=(E|E<<4)&3272356035,E=(E|E<<2)&1227133513,e&=1023,e=(e|e<<16)&4278190335,e=(e|e<<8)&251719695,e=(e|e<<4)&3272356035,e=(e|e<<2)&1227133513,E|=e<<1,p&=1023,p=(p|p<<16)&4278190335,p=(p|p<<8)&251719695,p=(p|p<<4)&3272356035,p=(p|p<<2)&1227133513,E|p<<2},ie.deinterleave3=function(E,e){return E=E>>>e&1227133513,E=(E|E>>>2)&3272356035,E=(E|E>>>4)&251719695,E=(E|E>>>8)&4278190335,E=(E|E>>>16)&1023,E<<22>>22},ie.nextCombination=function(E){var e=E|E-1;return e+1|(~e&-~e)-1>>>k(E)+1}},{}],82:[function(c,ae,ie){"use strict";var b=c("clamp");ae.exports=P;var k=1e20;function P(p,g){g||(g={});var a=g.cutoff==null?.25:g.cutoff,t=g.radius==null?8:g.radius,i=g.channel||0,n,r,d,s,m,x,M,v,_,l,y;if(ArrayBuffer.isView(p)||Array.isArray(p)){if(!g.width||!g.height)throw Error("For raw data width and height should be provided by options");n=g.width,r=g.height,s=p,g.stride?x=g.stride:x=Math.floor(p.length/n/r)}else window.HTMLCanvasElement&&p instanceof window.HTMLCanvasElement?(v=p,M=v.getContext("2d"),n=v.width,r=v.height,_=M.getImageData(0,0,n,r),s=_.data,x=4):window.CanvasRenderingContext2D&&p instanceof window.CanvasRenderingContext2D?(v=p.canvas,M=p,n=v.width,r=v.height,_=M.getImageData(0,0,n,r),s=_.data,x=4):window.ImageData&&p instanceof window.ImageData&&(_=p,n=p.width,r=p.height,s=_.data,x=4);if(d=Math.max(n,r),window.Uint8ClampedArray&&s instanceof window.Uint8ClampedArray||window.Uint8Array&&s instanceof window.Uint8Array)for(m=s,s=Array(n*r),l=0,y=m.length;l<y;l++)s[l]=m[l*x+i]/255;else if(x!==1)throw Error("Raw data can have only 1 value per pixel");var T=Array(n*r),w=Array(n*r),A=Array(d),f=Array(d),u=Array(d+1),h=Array(d);for(l=0,y=n*r;l<y;l++){var o=s[l];T[l]=o===1?0:o===0?k:Math.pow(Math.max(0,.5-o),2),w[l]=o===1?k:o===0?0:Math.pow(Math.max(0,o-.5),2)}E(T,n,r,A,f,h,u),E(w,n,r,A,f,h,u);var S=window.Float32Array?new Float32Array(n*r):new Array(n*r);for(l=0,y=n*r;l<y;l++)S[l]=b(1-((T[l]-w[l])/t+a),0,1);return S}function E(p,g,a,t,i,n,r){for(var d=0;d<g;d++){for(var s=0;s<a;s++)t[s]=p[s*g+d];for(e(t,i,n,r,a),s=0;s<a;s++)p[s*g+d]=i[s]}for(s=0;s<a;s++){for(d=0;d<g;d++)t[d]=p[s*g+d];for(e(t,i,n,r,g),d=0;d<g;d++)p[s*g+d]=Math.sqrt(i[d])}}function e(p,g,a,t,i){a[0]=0,t[0]=-k,t[1]=+k;for(var n=1,r=0;n<i;n++){for(var d=(p[n]+n*n-(p[a[r]]+a[r]*a[r]))/(2*n-2*a[r]);d<=t[r];)r--,d=(p[n]+n*n-(p[a[r]]+a[r]*a[r]))/(2*n-2*a[r]);r++,a[r]=n,t[r]=d,t[r+1]=+k}for(n=0,r=0;n<i;n++){for(;t[r+1]<n;)r++;g[n]=(n-a[r])*(n-a[r])+p[a[r]]}}},{clamp:86}],83:[function(c,ae,ie){},{}],84:[function(c,ae,ie){"use strict";var b=typeof Reflect=="object"?Reflect:null,k=b&&typeof b.apply=="function"?b.apply:function(l,y,T){return Function.prototype.apply.call(l,y,T)},P;b&&typeof b.ownKeys=="function"?P=b.ownKeys:Object.getOwnPropertySymbols?P=function(l){return Object.getOwnPropertyNames(l).concat(Object.getOwnPropertySymbols(l))}:P=function(l){return Object.getOwnPropertyNames(l)};function E(_){console&&console.warn&&console.warn(_)}var e=Number.isNaN||function(l){return l!==l};function p(){p.init.call(this)}ae.exports=p,ae.exports.once=v,p.EventEmitter=p,p.prototype._events=void 0,p.prototype._eventsCount=0,p.prototype._maxListeners=void 0;var g=10;function a(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return g},set:function(_){if(typeof _!="number"||_<0||e(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");g=_}}),p.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},p.prototype.setMaxListeners=function(l){if(typeof l!="number"||l<0||e(l))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+l+".");return this._maxListeners=l,this};function t(_){return _._maxListeners===void 0?p.defaultMaxListeners:_._maxListeners}p.prototype.getMaxListeners=function(){return t(this)},p.prototype.emit=function(l){for(var y=[],T=1;T<arguments.length;T++)y.push(arguments[T]);var w=l==="error",A=this._events;if(A!==void 0)w=w&&A.error===void 0;else if(!w)return!1;if(w){var f;if(y.length>0&&(f=y[0]),f instanceof Error)throw f;var u=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw u.context=f,u}var h=A[l];if(h===void 0)return!1;if(typeof h=="function")k(h,this,y);else for(var o=h.length,S=m(h,o),T=0;T<o;++T)k(S[T],this,y);return!0};function i(_,l,y,T){var w,A,f;if(a(y),A=_._events,A===void 0?(A=_._events=Object.create(null),_._eventsCount=0):(A.newListener!==void 0&&(_.emit("newListener",l,y.listener?y.listener:y),A=_._events),f=A[l]),f===void 0)f=A[l]=y,++_._eventsCount;else if(typeof f=="function"?f=A[l]=T?[y,f]:[f,y]:T?f.unshift(y):f.push(y),w=t(_),w>0&&f.length>w&&!f.warned){f.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+f.length+" "+String(l)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=_,u.type=l,u.count=f.length,E(u)}return _}p.prototype.addListener=function(l,y){return i(this,l,y,!1)},p.prototype.on=p.prototype.addListener,p.prototype.prependListener=function(l,y){return i(this,l,y,!0)};function n(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function r(_,l,y){var T={fired:!1,wrapFn:void 0,target:_,type:l,listener:y},w=n.bind(T);return w.listener=y,T.wrapFn=w,w}p.prototype.once=function(l,y){return a(y),this.on(l,r(this,l,y)),this},p.prototype.prependOnceListener=function(l,y){return a(y),this.prependListener(l,r(this,l,y)),this},p.prototype.removeListener=function(l,y){var T,w,A,f,u;if(a(y),w=this._events,w===void 0)return this;if(T=w[l],T===void 0)return this;if(T===y||T.listener===y)--this._eventsCount===0?this._events=Object.create(null):(delete w[l],w.removeListener&&this.emit("removeListener",l,T.listener||y));else if(typeof T!="function"){for(A=-1,f=T.length-1;f>=0;f--)if(T[f]===y||T[f].listener===y){u=T[f].listener,A=f;break}if(A<0)return this;A===0?T.shift():x(T,A),T.length===1&&(w[l]=T[0]),w.removeListener!==void 0&&this.emit("removeListener",l,u||y)}return this},p.prototype.off=p.prototype.removeListener,p.prototype.removeAllListeners=function(l){var y,T,w;if(T=this._events,T===void 0)return this;if(T.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):T[l]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete T[l]),this;if(arguments.length===0){var A=Object.keys(T),f;for(w=0;w<A.length;++w)f=A[w],f!=="removeListener"&&this.removeAllListeners(f);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(y=T[l],typeof y=="function")this.removeListener(l,y);else if(y!==void 0)for(w=y.length-1;w>=0;w--)this.removeListener(l,y[w]);return this};function d(_,l,y){var T=_._events;if(T===void 0)return[];var w=T[l];return w===void 0?[]:typeof w=="function"?y?[w.listener||w]:[w]:y?M(w):m(w,w.length)}p.prototype.listeners=function(l){return d(this,l,!0)},p.prototype.rawListeners=function(l){return d(this,l,!1)},p.listenerCount=function(_,l){return typeof _.listenerCount=="function"?_.listenerCount(l):s.call(_,l)},p.prototype.listenerCount=s;function s(_){var l=this._events;if(l!==void 0){var y=l[_];if(typeof y=="function")return 1;if(y!==void 0)return y.length}return 0}p.prototype.eventNames=function(){return this._eventsCount>0?P(this._events):[]};function m(_,l){for(var y=new Array(l),T=0;T<l;++T)y[T]=_[T];return y}function x(_,l){for(;l+1<_.length;l++)_[l]=_[l+1];_.pop()}function M(_){for(var l=new Array(_.length),y=0;y<l.length;++y)l[y]=_[y].listener||_[y];return l}function v(_,l){return new Promise(function(y,T){function w(){A!==void 0&&_.removeListener("error",A),y([].slice.call(arguments))}var A;l!=="error"&&(A=function(u){_.removeListener(l,w),T(u)},_.once("error",A)),_.once(l,w)})}},{}],85:[function(c,ae,ie){(function(b){(function(){"use strict";var k=c("base64-js"),P=c("ieee754");ie.Buffer=g,ie.SlowBuffer=M,ie.INSPECT_MAX_BYTES=50;var E=2147483647;ie.kMaxLength=E,g.TYPED_ARRAY_SUPPORT=e(),!g.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function e(){try{var Z=new Uint8Array(1);return Z.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},Z.foo()===42}catch{return!1}}Object.defineProperty(g.prototype,"parent",{enumerable:!0,get:function(){if(!!g.isBuffer(this))return this.buffer}}),Object.defineProperty(g.prototype,"offset",{enumerable:!0,get:function(){if(!!g.isBuffer(this))return this.byteOffset}});function p(Z){if(Z>E)throw new RangeError('The value "'+Z+'" is invalid for option "size"');var ne=new Uint8Array(Z);return ne.__proto__=g.prototype,ne}function g(Z,ne,le){if(typeof Z=="number"){if(typeof ne=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return n(Z)}return a(Z,ne,le)}typeof Symbol<"u"&&Symbol.species!=null&&g[Symbol.species]===g&&Object.defineProperty(g,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),g.poolSize=8192;function a(Z,ne,le){if(typeof Z=="string")return r(Z,ne);if(ArrayBuffer.isView(Z))return d(Z);if(Z==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z);if(re(Z,ArrayBuffer)||Z&&re(Z.buffer,ArrayBuffer))return s(Z,ne,le);if(typeof Z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ge=Z.valueOf&&Z.valueOf();if(ge!=null&&ge!==Z)return g.from(ge,ne,le);var pe=m(Z);if(pe)return pe;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Z[Symbol.toPrimitive]=="function")return g.from(Z[Symbol.toPrimitive]("string"),ne,le);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z)}g.from=function(Z,ne,le){return a(Z,ne,le)},g.prototype.__proto__=Uint8Array.prototype,g.__proto__=Uint8Array;function t(Z){if(typeof Z!="number")throw new TypeError('"size" argument must be of type number');if(Z<0)throw new RangeError('The value "'+Z+'" is invalid for option "size"')}function i(Z,ne,le){return t(Z),Z<=0?p(Z):ne!==void 0?typeof le=="string"?p(Z).fill(ne,le):p(Z).fill(ne):p(Z)}g.alloc=function(Z,ne,le){return i(Z,ne,le)};function n(Z){return t(Z),p(Z<0?0:x(Z)|0)}g.allocUnsafe=function(Z){return n(Z)},g.allocUnsafeSlow=function(Z){return n(Z)};function r(Z,ne){if((typeof ne!="string"||ne==="")&&(ne="utf8"),!g.isEncoding(ne))throw new TypeError("Unknown encoding: "+ne);var le=v(Z,ne)|0,ge=p(le),pe=ge.write(Z,ne);return pe!==le&&(ge=ge.slice(0,pe)),ge}function d(Z){for(var ne=Z.length<0?0:x(Z.length)|0,le=p(ne),ge=0;ge<ne;ge+=1)le[ge]=Z[ge]&255;return le}function s(Z,ne,le){if(ne<0||Z.byteLength<ne)throw new RangeError('"offset" is outside of buffer bounds');if(Z.byteLength<ne+(le||0))throw new RangeError('"length" is outside of buffer bounds');var ge;return ne===void 0&&le===void 0?ge=new Uint8Array(Z):le===void 0?ge=new Uint8Array(Z,ne):ge=new Uint8Array(Z,ne,le),ge.__proto__=g.prototype,ge}function m(Z){if(g.isBuffer(Z)){var ne=x(Z.length)|0,le=p(ne);return le.length===0||Z.copy(le,0,0,ne),le}if(Z.length!==void 0)return typeof Z.length!="number"||j(Z.length)?p(0):d(Z);if(Z.type==="Buffer"&&Array.isArray(Z.data))return d(Z.data)}function x(Z){if(Z>=E)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+E.toString(16)+" bytes");return Z|0}function M(Z){return+Z!=Z&&(Z=0),g.alloc(+Z)}g.isBuffer=function(ne){return ne!=null&&ne._isBuffer===!0&&ne!==g.prototype},g.compare=function(ne,le){if(re(ne,Uint8Array)&&(ne=g.from(ne,ne.offset,ne.byteLength)),re(le,Uint8Array)&&(le=g.from(le,le.offset,le.byteLength)),!g.isBuffer(ne)||!g.isBuffer(le))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(ne===le)return 0;for(var ge=ne.length,pe=le.length,xe=0,Ee=Math.min(ge,pe);xe<Ee;++xe)if(ne[xe]!==le[xe]){ge=ne[xe],pe=le[xe];break}return ge<pe?-1:pe<ge?1:0},g.isEncoding=function(ne){switch(String(ne).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(ne,le){if(!Array.isArray(ne))throw new TypeError('"list" argument must be an Array of Buffers');if(ne.length===0)return g.alloc(0);var ge;if(le===void 0)for(le=0,ge=0;ge<ne.length;++ge)le+=ne[ge].length;var pe=g.allocUnsafe(le),xe=0;for(ge=0;ge<ne.length;++ge){var Ee=ne[ge];if(re(Ee,Uint8Array)&&(Ee=g.from(Ee)),!g.isBuffer(Ee))throw new TypeError('"list" argument must be an Array of Buffers');Ee.copy(pe,xe),xe+=Ee.length}return pe};function v(Z,ne){if(g.isBuffer(Z))return Z.length;if(ArrayBuffer.isView(Z)||re(Z,ArrayBuffer))return Z.byteLength;if(typeof Z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Z);var le=Z.length,ge=arguments.length>2&&arguments[2]===!0;if(!ge&&le===0)return 0;for(var pe=!1;;)switch(ne){case"ascii":case"latin1":case"binary":return le;case"utf8":case"utf-8":return V(Z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return le*2;case"hex":return le>>>1;case"base64":return J(Z).length;default:if(pe)return ge?-1:V(Z).length;ne=(""+ne).toLowerCase(),pe=!0}}g.byteLength=v;function _(Z,ne,le){var ge=!1;if((ne===void 0||ne<0)&&(ne=0),ne>this.length||((le===void 0||le>this.length)&&(le=this.length),le<=0)||(le>>>=0,ne>>>=0,le<=ne))return"";for(Z||(Z="utf8");;)switch(Z){case"hex":return D(this,ne,le);case"utf8":case"utf-8":return R(this,ne,le);case"ascii":return I(this,ne,le);case"latin1":case"binary":return F(this,ne,le);case"base64":return S(this,ne,le);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,ne,le);default:if(ge)throw new TypeError("Unknown encoding: "+Z);Z=(Z+"").toLowerCase(),ge=!0}}g.prototype._isBuffer=!0;function l(Z,ne,le){var ge=Z[ne];Z[ne]=Z[le],Z[le]=ge}g.prototype.swap16=function(){var ne=this.length;if(ne%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var le=0;le<ne;le+=2)l(this,le,le+1);return this},g.prototype.swap32=function(){var ne=this.length;if(ne%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var le=0;le<ne;le+=4)l(this,le,le+3),l(this,le+1,le+2);return this},g.prototype.swap64=function(){var ne=this.length;if(ne%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var le=0;le<ne;le+=8)l(this,le,le+7),l(this,le+1,le+6),l(this,le+2,le+5),l(this,le+3,le+4);return this},g.prototype.toString=function(){var ne=this.length;return ne===0?"":arguments.length===0?R(this,0,ne):_.apply(this,arguments)},g.prototype.toLocaleString=g.prototype.toString,g.prototype.equals=function(ne){if(!g.isBuffer(ne))throw new TypeError("Argument must be a Buffer");return this===ne?!0:g.compare(this,ne)===0},g.prototype.inspect=function(){var ne="",le=ie.INSPECT_MAX_BYTES;return ne=this.toString("hex",0,le).replace(/(.{2})/g,"$1 ").trim(),this.length>le&&(ne+=" ... "),"<Buffer "+ne+">"},g.prototype.compare=function(ne,le,ge,pe,xe){if(re(ne,Uint8Array)&&(ne=g.from(ne,ne.offset,ne.byteLength)),!g.isBuffer(ne))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof ne);if(le===void 0&&(le=0),ge===void 0&&(ge=ne?ne.length:0),pe===void 0&&(pe=0),xe===void 0&&(xe=this.length),le<0||ge>ne.length||pe<0||xe>this.length)throw new RangeError("out of range index");if(pe>=xe&&le>=ge)return 0;if(pe>=xe)return-1;if(le>=ge)return 1;if(le>>>=0,ge>>>=0,pe>>>=0,xe>>>=0,this===ne)return 0;for(var Ee=xe-pe,Te=ge-le,de=Math.min(Ee,Te),be=this.slice(pe,xe),Le=ne.slice(le,ge),De=0;De<de;++De)if(be[De]!==Le[De]){Ee=be[De],Te=Le[De];break}return Ee<Te?-1:Te<Ee?1:0};function y(Z,ne,le,ge,pe){if(Z.length===0)return-1;if(typeof le=="string"?(ge=le,le=0):le>2147483647?le=2147483647:le<-2147483648&&(le=-2147483648),le=+le,j(le)&&(le=pe?0:Z.length-1),le<0&&(le=Z.length+le),le>=Z.length){if(pe)return-1;le=Z.length-1}else if(le<0)if(pe)le=0;else return-1;if(typeof ne=="string"&&(ne=g.from(ne,ge)),g.isBuffer(ne))return ne.length===0?-1:T(Z,ne,le,ge,pe);if(typeof ne=="number")return ne=ne&255,typeof Uint8Array.prototype.indexOf=="function"?pe?Uint8Array.prototype.indexOf.call(Z,ne,le):Uint8Array.prototype.lastIndexOf.call(Z,ne,le):T(Z,[ne],le,ge,pe);throw new TypeError("val must be string, number or Buffer")}function T(Z,ne,le,ge,pe){var xe=1,Ee=Z.length,Te=ne.length;if(ge!==void 0&&(ge=String(ge).toLowerCase(),ge==="ucs2"||ge==="ucs-2"||ge==="utf16le"||ge==="utf-16le")){if(Z.length<2||ne.length<2)return-1;xe=2,Ee/=2,Te/=2,le/=2}function de(ke,Oe){return xe===1?ke[Oe]:ke.readUInt16BE(Oe*xe)}var be;if(pe){var Le=-1;for(be=le;be<Ee;be++)if(de(Z,be)===de(ne,Le===-1?0:be-Le)){if(Le===-1&&(Le=be),be-Le+1===Te)return Le*xe}else Le!==-1&&(be-=be-Le),Le=-1}else for(le+Te>Ee&&(le=Ee-Te),be=le;be>=0;be--){for(var De=!0,ye=0;ye<Te;ye++)if(de(Z,be+ye)!==de(ne,ye)){De=!1;break}if(De)return be}return-1}g.prototype.includes=function(ne,le,ge){return this.indexOf(ne,le,ge)!==-1},g.prototype.indexOf=function(ne,le,ge){return y(this,ne,le,ge,!0)},g.prototype.lastIndexOf=function(ne,le,ge){return y(this,ne,le,ge,!1)};function w(Z,ne,le,ge){le=Number(le)||0;var pe=Z.length-le;ge?(ge=Number(ge),ge>pe&&(ge=pe)):ge=pe;var xe=ne.length;ge>xe/2&&(ge=xe/2);for(var Ee=0;Ee<ge;++Ee){var Te=parseInt(ne.substr(Ee*2,2),16);if(j(Te))return Ee;Z[le+Ee]=Te}return Ee}function A(Z,ne,le,ge){return W(V(ne,Z.length-le),Z,le,ge)}function f(Z,ne,le,ge){return W(H(ne),Z,le,ge)}function u(Z,ne,le,ge){return f(Z,ne,le,ge)}function h(Z,ne,le,ge){return W(J(ne),Z,le,ge)}function o(Z,ne,le,ge){return W(ee(ne,Z.length-le),Z,le,ge)}g.prototype.write=function(ne,le,ge,pe){if(le===void 0)pe="utf8",ge=this.length,le=0;else if(ge===void 0&&typeof le=="string")pe=le,ge=this.length,le=0;else if(isFinite(le))le=le>>>0,isFinite(ge)?(ge=ge>>>0,pe===void 0&&(pe="utf8")):(pe=ge,ge=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var xe=this.length-le;if((ge===void 0||ge>xe)&&(ge=xe),ne.length>0&&(ge<0||le<0)||le>this.length)throw new RangeError("Attempt to write outside buffer bounds");pe||(pe="utf8");for(var Ee=!1;;)switch(pe){case"hex":return w(this,ne,le,ge);case"utf8":case"utf-8":return A(this,ne,le,ge);case"ascii":return f(this,ne,le,ge);case"latin1":case"binary":return u(this,ne,le,ge);case"base64":return h(this,ne,le,ge);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o(this,ne,le,ge);default:if(Ee)throw new TypeError("Unknown encoding: "+pe);pe=(""+pe).toLowerCase(),Ee=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function S(Z,ne,le){return ne===0&&le===Z.length?k.fromByteArray(Z):k.fromByteArray(Z.slice(ne,le))}function R(Z,ne,le){le=Math.min(Z.length,le);for(var ge=[],pe=ne;pe<le;){var xe=Z[pe],Ee=null,Te=xe>239?4:xe>223?3:xe>191?2:1;if(pe+Te<=le){var de,be,Le,De;switch(Te){case 1:xe<128&&(Ee=xe);break;case 2:de=Z[pe+1],(de&192)===128&&(De=(xe&31)<<6|de&63,De>127&&(Ee=De));break;case 3:de=Z[pe+1],be=Z[pe+2],(de&192)===128&&(be&192)===128&&(De=(xe&15)<<12|(de&63)<<6|be&63,De>2047&&(De<55296||De>57343)&&(Ee=De));break;case 4:de=Z[pe+1],be=Z[pe+2],Le=Z[pe+3],(de&192)===128&&(be&192)===128&&(Le&192)===128&&(De=(xe&15)<<18|(de&63)<<12|(be&63)<<6|Le&63,De>65535&&De<1114112&&(Ee=De))}}Ee===null?(Ee=65533,Te=1):Ee>65535&&(Ee-=65536,ge.push(Ee>>>10&1023|55296),Ee=56320|Ee&1023),ge.push(Ee),pe+=Te}return O(ge)}var z=4096;function O(Z){var ne=Z.length;if(ne<=z)return String.fromCharCode.apply(String,Z);for(var le="",ge=0;ge<ne;)le+=String.fromCharCode.apply(String,Z.slice(ge,ge+=z));return le}function I(Z,ne,le){var ge="";le=Math.min(Z.length,le);for(var pe=ne;pe<le;++pe)ge+=String.fromCharCode(Z[pe]&127);return ge}function F(Z,ne,le){var ge="";le=Math.min(Z.length,le);for(var pe=ne;pe<le;++pe)ge+=String.fromCharCode(Z[pe]);return ge}function D(Z,ne,le){var ge=Z.length;(!ne||ne<0)&&(ne=0),(!le||le<0||le>ge)&&(le=ge);for(var pe="",xe=ne;xe<le;++xe)pe+=Q(Z[xe]);return pe}function B(Z,ne,le){for(var ge=Z.slice(ne,le),pe="",xe=0;xe<ge.length;xe+=2)pe+=String.fromCharCode(ge[xe]+ge[xe+1]*256);return pe}g.prototype.slice=function(ne,le){var ge=this.length;ne=~~ne,le=le===void 0?ge:~~le,ne<0?(ne+=ge,ne<0&&(ne=0)):ne>ge&&(ne=ge),le<0?(le+=ge,le<0&&(le=0)):le>ge&&(le=ge),le<ne&&(le=ne);var pe=this.subarray(ne,le);return pe.__proto__=g.prototype,pe};function U(Z,ne,le){if(Z%1!==0||Z<0)throw new RangeError("offset is not uint");if(Z+ne>le)throw new RangeError("Trying to access beyond buffer length")}g.prototype.readUIntLE=function(ne,le,ge){ne=ne>>>0,le=le>>>0,ge||U(ne,le,this.length);for(var pe=this[ne],xe=1,Ee=0;++Ee<le&&(xe*=256);)pe+=this[ne+Ee]*xe;return pe},g.prototype.readUIntBE=function(ne,le,ge){ne=ne>>>0,le=le>>>0,ge||U(ne,le,this.length);for(var pe=this[ne+--le],xe=1;le>0&&(xe*=256);)pe+=this[ne+--le]*xe;return pe},g.prototype.readUInt8=function(ne,le){return ne=ne>>>0,le||U(ne,1,this.length),this[ne]},g.prototype.readUInt16LE=function(ne,le){return ne=ne>>>0,le||U(ne,2,this.length),this[ne]|this[ne+1]<<8},g.prototype.readUInt16BE=function(ne,le){return ne=ne>>>0,le||U(ne,2,this.length),this[ne]<<8|this[ne+1]},g.prototype.readUInt32LE=function(ne,le){return ne=ne>>>0,le||U(ne,4,this.length),(this[ne]|this[ne+1]<<8|this[ne+2]<<16)+this[ne+3]*16777216},g.prototype.readUInt32BE=function(ne,le){return ne=ne>>>0,le||U(ne,4,this.length),this[ne]*16777216+(this[ne+1]<<16|this[ne+2]<<8|this[ne+3])},g.prototype.readIntLE=function(ne,le,ge){ne=ne>>>0,le=le>>>0,ge||U(ne,le,this.length);for(var pe=this[ne],xe=1,Ee=0;++Ee<le&&(xe*=256);)pe+=this[ne+Ee]*xe;return xe*=128,pe>=xe&&(pe-=Math.pow(2,8*le)),pe},g.prototype.readIntBE=function(ne,le,ge){ne=ne>>>0,le=le>>>0,ge||U(ne,le,this.length);for(var pe=le,xe=1,Ee=this[ne+--pe];pe>0&&(xe*=256);)Ee+=this[ne+--pe]*xe;return xe*=128,Ee>=xe&&(Ee-=Math.pow(2,8*le)),Ee},g.prototype.readInt8=function(ne,le){return ne=ne>>>0,le||U(ne,1,this.length),this[ne]&128?(255-this[ne]+1)*-1:this[ne]},g.prototype.readInt16LE=function(ne,le){ne=ne>>>0,le||U(ne,2,this.length);var ge=this[ne]|this[ne+1]<<8;return ge&32768?ge|4294901760:ge},g.prototype.readInt16BE=function(ne,le){ne=ne>>>0,le||U(ne,2,this.length);var ge=this[ne+1]|this[ne]<<8;return ge&32768?ge|4294901760:ge},g.prototype.readInt32LE=function(ne,le){return ne=ne>>>0,le||U(ne,4,this.length),this[ne]|this[ne+1]<<8|this[ne+2]<<16|this[ne+3]<<24},g.prototype.readInt32BE=function(ne,le){return ne=ne>>>0,le||U(ne,4,this.length),this[ne]<<24|this[ne+1]<<16|this[ne+2]<<8|this[ne+3]},g.prototype.readFloatLE=function(ne,le){return ne=ne>>>0,le||U(ne,4,this.length),P.read(this,ne,!0,23,4)},g.prototype.readFloatBE=function(ne,le){return ne=ne>>>0,le||U(ne,4,this.length),P.read(this,ne,!1,23,4)},g.prototype.readDoubleLE=function(ne,le){return ne=ne>>>0,le||U(ne,8,this.length),P.read(this,ne,!0,52,8)},g.prototype.readDoubleBE=function(ne,le){return ne=ne>>>0,le||U(ne,8,this.length),P.read(this,ne,!1,52,8)};function X(Z,ne,le,ge,pe,xe){if(!g.isBuffer(Z))throw new TypeError('"buffer" argument must be a Buffer instance');if(ne>pe||ne<xe)throw new RangeError('"value" argument is out of bounds');if(le+ge>Z.length)throw new RangeError("Index out of range")}g.prototype.writeUIntLE=function(ne,le,ge,pe){if(ne=+ne,le=le>>>0,ge=ge>>>0,!pe){var xe=Math.pow(2,8*ge)-1;X(this,ne,le,ge,xe,0)}var Ee=1,Te=0;for(this[le]=ne&255;++Te<ge&&(Ee*=256);)this[le+Te]=ne/Ee&255;return le+ge},g.prototype.writeUIntBE=function(ne,le,ge,pe){if(ne=+ne,le=le>>>0,ge=ge>>>0,!pe){var xe=Math.pow(2,8*ge)-1;X(this,ne,le,ge,xe,0)}var Ee=ge-1,Te=1;for(this[le+Ee]=ne&255;--Ee>=0&&(Te*=256);)this[le+Ee]=ne/Te&255;return le+ge},g.prototype.writeUInt8=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,1,255,0),this[le]=ne&255,le+1},g.prototype.writeUInt16LE=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,2,65535,0),this[le]=ne&255,this[le+1]=ne>>>8,le+2},g.prototype.writeUInt16BE=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,2,65535,0),this[le]=ne>>>8,this[le+1]=ne&255,le+2},g.prototype.writeUInt32LE=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,4,4294967295,0),this[le+3]=ne>>>24,this[le+2]=ne>>>16,this[le+1]=ne>>>8,this[le]=ne&255,le+4},g.prototype.writeUInt32BE=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,4,4294967295,0),this[le]=ne>>>24,this[le+1]=ne>>>16,this[le+2]=ne>>>8,this[le+3]=ne&255,le+4},g.prototype.writeIntLE=function(ne,le,ge,pe){if(ne=+ne,le=le>>>0,!pe){var xe=Math.pow(2,8*ge-1);X(this,ne,le,ge,xe-1,-xe)}var Ee=0,Te=1,de=0;for(this[le]=ne&255;++Ee<ge&&(Te*=256);)ne<0&&de===0&&this[le+Ee-1]!==0&&(de=1),this[le+Ee]=(ne/Te>>0)-de&255;return le+ge},g.prototype.writeIntBE=function(ne,le,ge,pe){if(ne=+ne,le=le>>>0,!pe){var xe=Math.pow(2,8*ge-1);X(this,ne,le,ge,xe-1,-xe)}var Ee=ge-1,Te=1,de=0;for(this[le+Ee]=ne&255;--Ee>=0&&(Te*=256);)ne<0&&de===0&&this[le+Ee+1]!==0&&(de=1),this[le+Ee]=(ne/Te>>0)-de&255;return le+ge},g.prototype.writeInt8=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,1,127,-128),ne<0&&(ne=255+ne+1),this[le]=ne&255,le+1},g.prototype.writeInt16LE=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,2,32767,-32768),this[le]=ne&255,this[le+1]=ne>>>8,le+2},g.prototype.writeInt16BE=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,2,32767,-32768),this[le]=ne>>>8,this[le+1]=ne&255,le+2},g.prototype.writeInt32LE=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,4,2147483647,-2147483648),this[le]=ne&255,this[le+1]=ne>>>8,this[le+2]=ne>>>16,this[le+3]=ne>>>24,le+4},g.prototype.writeInt32BE=function(ne,le,ge){return ne=+ne,le=le>>>0,ge||X(this,ne,le,4,2147483647,-2147483648),ne<0&&(ne=4294967295+ne+1),this[le]=ne>>>24,this[le+1]=ne>>>16,this[le+2]=ne>>>8,this[le+3]=ne&255,le+4};function oe(Z,ne,le,ge,pe,xe){if(le+ge>Z.length)throw new RangeError("Index out of range");if(le<0)throw new RangeError("Index out of range")}function se(Z,ne,le,ge,pe){return ne=+ne,le=le>>>0,pe||oe(Z,ne,le,4,34028234663852886e22,-34028234663852886e22),P.write(Z,ne,le,ge,23,4),le+4}g.prototype.writeFloatLE=function(ne,le,ge){return se(this,ne,le,!0,ge)},g.prototype.writeFloatBE=function(ne,le,ge){return se(this,ne,le,!1,ge)};function q(Z,ne,le,ge,pe){return ne=+ne,le=le>>>0,pe||oe(Z,ne,le,8,17976931348623157e292,-17976931348623157e292),P.write(Z,ne,le,ge,52,8),le+8}g.prototype.writeDoubleLE=function(ne,le,ge){return q(this,ne,le,!0,ge)},g.prototype.writeDoubleBE=function(ne,le,ge){return q(this,ne,le,!1,ge)},g.prototype.copy=function(ne,le,ge,pe){if(!g.isBuffer(ne))throw new TypeError("argument should be a Buffer");if(ge||(ge=0),!pe&&pe!==0&&(pe=this.length),le>=ne.length&&(le=ne.length),le||(le=0),pe>0&&pe<ge&&(pe=ge),pe===ge||ne.length===0||this.length===0)return 0;if(le<0)throw new RangeError("targetStart out of bounds");if(ge<0||ge>=this.length)throw new RangeError("Index out of range");if(pe<0)throw new RangeError("sourceEnd out of bounds");pe>this.length&&(pe=this.length),ne.length-le<pe-ge&&(pe=ne.length-le+ge);var xe=pe-ge;if(this===ne&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(le,ge,pe);else if(this===ne&&ge<le&&le<pe)for(var Ee=xe-1;Ee>=0;--Ee)ne[Ee+le]=this[Ee+ge];else Uint8Array.prototype.set.call(ne,this.subarray(ge,pe),le);return xe},g.prototype.fill=function(ne,le,ge,pe){if(typeof ne=="string"){if(typeof le=="string"?(pe=le,le=0,ge=this.length):typeof ge=="string"&&(pe=ge,ge=this.length),pe!==void 0&&typeof pe!="string")throw new TypeError("encoding must be a string");if(typeof pe=="string"&&!g.isEncoding(pe))throw new TypeError("Unknown encoding: "+pe);if(ne.length===1){var xe=ne.charCodeAt(0);(pe==="utf8"&&xe<128||pe==="latin1")&&(ne=xe)}}else typeof ne=="number"&&(ne=ne&255);if(le<0||this.length<le||this.length<ge)throw new RangeError("Out of range index");if(ge<=le)return this;le=le>>>0,ge=ge===void 0?this.length:ge>>>0,ne||(ne=0);var Ee;if(typeof ne=="number")for(Ee=le;Ee<ge;++Ee)this[Ee]=ne;else{var Te=g.isBuffer(ne)?ne:g.from(ne,pe),de=Te.length;if(de===0)throw new TypeError('The value "'+ne+'" is invalid for argument "value"');for(Ee=0;Ee<ge-le;++Ee)this[Ee+le]=Te[Ee%de]}return this};var K=/[^+/0-9A-Za-z-_]/g;function G(Z){if(Z=Z.split("=")[0],Z=Z.trim().replace(K,""),Z.length<2)return"";for(;Z.length%4!==0;)Z=Z+"=";return Z}function Q(Z){return Z<16?"0"+Z.toString(16):Z.toString(16)}function V(Z,ne){ne=ne||1/0;for(var le,ge=Z.length,pe=null,xe=[],Ee=0;Ee<ge;++Ee){if(le=Z.charCodeAt(Ee),le>55295&&le<57344){if(!pe){if(le>56319){(ne-=3)>-1&&xe.push(239,191,189);continue}else if(Ee+1===ge){(ne-=3)>-1&&xe.push(239,191,189);continue}pe=le;continue}if(le<56320){(ne-=3)>-1&&xe.push(239,191,189),pe=le;continue}le=(pe-55296<<10|le-56320)+65536}else pe&&(ne-=3)>-1&&xe.push(239,191,189);if(pe=null,le<128){if((ne-=1)<0)break;xe.push(le)}else if(le<2048){if((ne-=2)<0)break;xe.push(le>>6|192,le&63|128)}else if(le<65536){if((ne-=3)<0)break;xe.push(le>>12|224,le>>6&63|128,le&63|128)}else if(le<1114112){if((ne-=4)<0)break;xe.push(le>>18|240,le>>12&63|128,le>>6&63|128,le&63|128)}else throw new Error("Invalid code point")}return xe}function H(Z){for(var ne=[],le=0;le<Z.length;++le)ne.push(Z.charCodeAt(le)&255);return ne}function ee(Z,ne){for(var le,ge,pe,xe=[],Ee=0;Ee<Z.length&&!((ne-=2)<0);++Ee)le=Z.charCodeAt(Ee),ge=le>>8,pe=le%256,xe.push(pe),xe.push(ge);return xe}function J(Z){return k.toByteArray(G(Z))}function W(Z,ne,le,ge){for(var pe=0;pe<ge&&!(pe+le>=ne.length||pe>=Z.length);++pe)ne[pe+le]=Z[pe];return pe}function re(Z,ne){return Z instanceof ne||Z!=null&&Z.constructor!=null&&Z.constructor.name!=null&&Z.constructor.name===ne.name}function j(Z){return Z!==Z}}).call(this)}).call(this,c("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(c,ae,ie){ae.exports=b;function b(k,P,E){return P<E?k<P?P:k>E?E:k:k<E?E:k>P?P:k}},{}],87:[function(c,ae,ie){"use strict";var b=c("clamp");ae.exports=k,ae.exports.to=k,ae.exports.from=P;function k(E,e){e==null&&(e=!0);var p=E[0],g=E[1],a=E[2],t=E[3];t==null&&(t=e?1:255),e&&(p*=255,g*=255,a*=255,t*=255),p=b(p,0,255)&255,g=b(g,0,255)&255,a=b(a,0,255)&255,t=b(t,0,255)&255;var i=p*16777216+(g<<16)+(a<<8)+t;return i}function P(E,e){E=+E;var p=E>>>24,g=(E&16711680)>>>16,a=(E&65280)>>>8,t=E&255;return e===!1?[p,g,a,t]:[p/255,g/255,a/255,t/255]}},{clamp:86}],88:[function(c,ae,ie){"use strict";ae.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(c,ae,ie){"use strict";var b=c("color-rgba"),k=c("clamp"),P=c("dtype");ae.exports=function(p,g){(g==="float"||!g)&&(g="array"),g==="uint"&&(g="uint8"),g==="uint_clamped"&&(g="uint8_clamped");var a=P(g),t=new a(4),i=g!=="uint8"&&g!=="uint8_clamped";return(!p.length||typeof p=="string")&&(p=b(p),p[0]/=255,p[1]/=255,p[2]/=255),E(p)?(t[0]=p[0],t[1]=p[1],t[2]=p[2],t[3]=p[3]!=null?p[3]:255,i&&(t[0]/=255,t[1]/=255,t[2]/=255,t[3]/=255),t):(i?(t[0]=p[0],t[1]=p[1],t[2]=p[2],t[3]=p[3]!=null?p[3]:1):(t[0]=k(Math.floor(p[0]*255),0,255),t[1]=k(Math.floor(p[1]*255),0,255),t[2]=k(Math.floor(p[2]*255),0,255),t[3]=p[3]==null?255:k(Math.floor(p[3]*255),0,255)),t)};function E(e){return!!(e instanceof Uint8Array||e instanceof Uint8ClampedArray||Array.isArray(e)&&(e[0]>1||e[0]===0)&&(e[1]>1||e[1]===0)&&(e[2]>1||e[2]===0)&&(!e[3]||e[3]>1))}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(c,ae,ie){(function(b){(function(){"use strict";var k=c("color-name"),P=c("is-plain-obj"),E=c("defined");ae.exports=p;var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function p(g){var a,t=[],i=1,n;if(typeof g=="string")if(k[g])t=k[g].slice(),n="rgb";else if(g==="transparent")i=0,n="rgb",t=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(g)){var r=g.slice(1),d=r.length,s=d<=4;i=1,s?(t=[parseInt(r[0]+r[0],16),parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16)],d===4&&(i=parseInt(r[3]+r[3],16)/255)):(t=[parseInt(r[0]+r[1],16),parseInt(r[2]+r[3],16),parseInt(r[4]+r[5],16)],d===8&&(i=parseInt(r[6]+r[7],16)/255)),t[0]||(t[0]=0),t[1]||(t[1]=0),t[2]||(t[2]=0),n="rgb"}else if(a=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(g)){var m=a[1],x=m==="rgb",r=m.replace(/a$/,"");n=r;var d=r==="cmyk"?4:r==="gray"?1:3;t=a[2].trim().split(/\s*,\s*/).map(function(l,y){if(/%$/.test(l))return y===d?parseFloat(l)/100:r==="rgb"?parseFloat(l)*255/100:parseFloat(l);if(r[y]==="h"){if(/deg$/.test(l))return parseFloat(l);if(e[l]!==void 0)return e[l]}return parseFloat(l)}),m===r&&t.push(1),i=x||t[d]===void 0?1:t[d],t=t.slice(0,d)}else g.length>10&&/[0-9](?:\s|\/)/.test(g)&&(t=g.match(/([0-9]+)/g).map(function(v){return parseFloat(v)}),n=g.match(/([a-z])/ig).join("").toLowerCase());else if(!isNaN(g))n="rgb",t=[g>>>16,(g&65280)>>>8,g&255];else if(P(g)){var M=E(g.r,g.red,g.R,null);M!==null?(n="rgb",t=[M,E(g.g,g.green,g.G),E(g.b,g.blue,g.B)]):(n="hsl",t=[E(g.h,g.hue,g.H),E(g.s,g.saturation,g.S),E(g.l,g.lightness,g.L,g.b,g.brightness)]),i=E(g.a,g.alpha,g.opacity,1),g.opacity!=null&&(i/=100)}else(Array.isArray(g)||b.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(g))&&(t=[g[0],g[1],g[2]],n="rgb",i=g.length===4?g[3]:1);return{space:n,values:t,alpha:i}}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(c,ae,ie){"use strict";var b=c("color-parse"),k=c("color-space/hsl"),P=c("clamp");ae.exports=function(e){var p,g,a,t=b(e);return t.space?(p=Array(3),p[0]=P(t.values[0],0,255),p[1]=P(t.values[1],0,255),p[2]=P(t.values[2],0,255),t.space[0]==="h"&&(p=k.rgb(p)),p.push(P(t.alpha,0,1)),p):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(c,ae,ie){"use strict";var b=c("./rgb");ae.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(k){var P=k[0]/360,E=k[1]/100,e=k[2]/100,p,g,a,t,i;if(E===0)return i=e*255,[i,i,i];e<.5?g=e*(1+E):g=e+E-e*E,p=2*e-g,t=[0,0,0];for(var n=0;n<3;n++)a=P+1/3*-(n-1),a<0?a++:a>1&&a--,6*a<1?i=p+(g-p)*6*a:2*a<1?i=g:3*a<2?i=p+(g-p)*(2/3-a)*6:i=p,t[n]=i*255;return t}},b.hsl=function(k){var P=k[0]/255,E=k[1]/255,e=k[2]/255,p=Math.min(P,E,e),g=Math.max(P,E,e),a=g-p,t,i,n;return g===p?t=0:P===g?t=(E-e)/a:E===g?t=2+(e-P)/a:e===g&&(t=4+(P-E)/a),t=Math.min(t*60,360),t<0&&(t+=360),n=(p+g)/2,g===p?i=0:n<=.5?i=a/(g+p):i=a/(2-g-p),[t,i*100,n*100]}},{"./rgb":93}],93:[function(c,ae,ie){"use strict";ae.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(c,ae,ie){ae.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(c,ae,ie){ae.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(c,ae,ie){ae.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(c,ae,ie){ae.exports=["normal","italic","oblique"]},{}],98:[function(c,ae,ie){ae.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(c,ae,ie){"use strict";ae.exports={parse:c("./parse"),stringify:c("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(c,ae,ie){"use strict";var b=c("css-font-size-keywords");ae.exports={isSize:function(P){return/^[\d\.]/.test(P)||P.indexOf("/")!==-1||b.indexOf(P)!==-1}}},{"css-font-size-keywords":95}],101:[function(c,ae,ie){"use strict";var b=c("unquote"),k=c("css-global-keywords"),P=c("css-system-font-keywords"),E=c("css-font-weight-keywords"),e=c("css-font-style-keywords"),p=c("css-font-stretch-keywords"),g=c("string-split-by"),a=c("./lib/util").isSize;ae.exports=i;var t=i.cache={};function i(r){if(typeof r!="string")throw new Error("Font argument must be a string.");if(t[r])return t[r];if(r==="")throw new Error("Cannot parse an empty string.");if(P.indexOf(r)!==-1)return t[r]={system:r};for(var d={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},s=g(r,/\s+/),m;m=s.shift();){if(k.indexOf(m)!==-1)return["style","variant","weight","stretch"].forEach(function(M){d[M]=m}),t[r]=d;if(e.indexOf(m)!==-1){d.style=m;continue}if(m==="normal"||m==="small-caps"){d.variant=m;continue}if(p.indexOf(m)!==-1){d.stretch=m;continue}if(E.indexOf(m)!==-1){d.weight=m;continue}if(a(m)){var x=g(m,"/");if(d.size=x[0],x[1]!=null?d.lineHeight=n(x[1]):s[0]==="/"&&(s.shift(),d.lineHeight=n(s.shift())),!s.length)throw new Error("Missing required font-family.");return d.family=g(s.join(" "),/\s*,\s*/).map(b),t[r]=d}throw new Error("Unknown or unsupported font token: "+m)}throw new Error("Missing required font-size.")}function n(r){var d=parseFloat(r);return d.toString()===r?d:r}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":305,unquote:328}],102:[function(c,ae,ie){"use strict";var b=c("pick-by-alias"),k=c("./lib/util").isSize,P=r(c("css-global-keywords")),E=r(c("css-system-font-keywords")),e=r(c("css-font-weight-keywords")),p=r(c("css-font-style-keywords")),g=r(c("css-font-stretch-keywords")),a={normal:1,"small-caps":1},t={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},i={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};ae.exports=function(s){if(s=b(s,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"}),s.system)return s.system&&n(s.system,E),s.system;if(n(s.style,p),n(s.variant,a),n(s.weight,e),n(s.stretch,g),s.size==null&&(s.size=i.size),typeof s.size=="number"&&(s.size+="px"),!k)throw Error("Bad size value `"+s.size+"`");s.family||(s.family=i.family),Array.isArray(s.family)&&(s.family.length||(s.family=[i.family]),s.family=s.family.map(function(x){return t[x]?x:'"'+x+'"'}).join(", "));var m=[];return m.push(s.style),s.variant!==s.style&&m.push(s.variant),s.weight!==s.variant&&s.weight!==s.style&&m.push(s.weight),s.stretch!==s.weight&&s.stretch!==s.variant&&s.stretch!==s.style&&m.push(s.stretch),m.push(s.size+(s.lineHeight==null||s.lineHeight==="normal"||s.lineHeight+""=="1"?"":"/"+s.lineHeight)),m.push(s.family),m.filter(Boolean).join(" ")};function n(d,s){if(d&&!s[d]&&!P[d])throw Error("Unknown keyword `"+d+"`");return d}function r(d){for(var s={},m=0;m<d.length;m++)s[d[m]]=1;return s}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(c,ae,ie){ae.exports=["inherit","initial","unset"]},{}],104:[function(c,ae,ie){ae.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(c,ae,ie){"use strict";var b=c("type/value/is"),k=c("type/value/ensure"),P=c("type/plain-function/ensure"),E=c("es5-ext/object/copy"),e=c("es5-ext/object/normalize-options"),p=c("es5-ext/object/map"),g=Function.prototype.bind,a=Object.defineProperty,t=Object.prototype.hasOwnProperty,i;i=function(n,r,d){var s=k(r)&&P(r.value),m;return m=E(r),delete m.writable,delete m.value,m.get=function(){return!d.overwriteDefinition&&t.call(this,n)?s:(r.value=g.call(s,d.resolveContext?d.resolveContext(this):this),a(this,n,r),this[n])},m},ae.exports=function(n){var r=e(arguments[1]);return b(r.resolveContext)&&P(r.resolveContext),p(n,function(d,s){return i(s,d,r)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":321,"type/value/ensure":325,"type/value/is":326}],106:[function(c,ae,ie){"use strict";var b=c("type/value/is"),k=c("type/plain-function/is"),P=c("es5-ext/object/assign"),E=c("es5-ext/object/normalize-options"),e=c("es5-ext/string/#/contains"),p=ae.exports=function(g,a){var t,i,n,r,d;return arguments.length<2||typeof g!="string"?(r=a,a=g,g=null):r=arguments[2],b(g)?(t=e.call(g,"c"),i=e.call(g,"e"),n=e.call(g,"w")):(t=n=!0,i=!1),d={value:a,configurable:t,enumerable:i,writable:n},r?P(E(r),d):d};p.gs=function(g,a,t){var i,n,r,d;return typeof g!="string"?(r=t,t=a,a=g,g=null):r=arguments[3],b(a)?k(a)?b(t)?k(t)||(r=t,t=void 0):t=void 0:(r=a,a=t=void 0):a=void 0,b(g)?(i=e.call(g,"c"),n=e.call(g,"e")):(i=!0,n=!1),d={get:a,set:t,configurable:i,enumerable:n},r?P(E(r),d):d}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":322,"type/value/is":326}],107:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):k(b.d3=b.d3||{})})(this,function(b){"use strict";function k(V,H){return V<H?-1:V>H?1:V>=H?0:NaN}function P(V){return V.length===1&&(V=E(V)),{left:function(H,ee,J,W){for(J==null&&(J=0),W==null&&(W=H.length);J<W;){var re=J+W>>>1;V(H[re],ee)<0?J=re+1:W=re}return J},right:function(H,ee,J,W){for(J==null&&(J=0),W==null&&(W=H.length);J<W;){var re=J+W>>>1;V(H[re],ee)>0?W=re:J=re+1}return J}}}function E(V){return function(H,ee){return k(V(H),ee)}}var e=P(k),p=e.right,g=e.left;function a(V,H){H==null&&(H=t);for(var ee=0,J=V.length-1,W=V[0],re=new Array(J<0?0:J);ee<J;)re[ee]=H(W,W=V[++ee]);return re}function t(V,H){return[V,H]}function i(V,H,ee){var J=V.length,W=H.length,re=new Array(J*W),j,Z,ne,le;for(ee==null&&(ee=t),j=ne=0;j<J;++j)for(le=V[j],Z=0;Z<W;++Z,++ne)re[ne]=ee(le,H[Z]);return re}function n(V,H){return H<V?-1:H>V?1:H>=V?0:NaN}function r(V){return V===null?NaN:+V}function d(V,H){var ee=V.length,J=0,W=-1,re=0,j,Z,ne=0;if(H==null)for(;++W<ee;)isNaN(j=r(V[W]))||(Z=j-re,re+=Z/++J,ne+=Z*(j-re));else for(;++W<ee;)isNaN(j=r(H(V[W],W,V)))||(Z=j-re,re+=Z/++J,ne+=Z*(j-re));if(J>1)return ne/(J-1)}function s(V,H){var ee=d(V,H);return ee&&Math.sqrt(ee)}function m(V,H){var ee=V.length,J=-1,W,re,j;if(H==null){for(;++J<ee;)if((W=V[J])!=null&&W>=W)for(re=j=W;++J<ee;)(W=V[J])!=null&&(re>W&&(re=W),j<W&&(j=W))}else for(;++J<ee;)if((W=H(V[J],J,V))!=null&&W>=W)for(re=j=W;++J<ee;)(W=H(V[J],J,V))!=null&&(re>W&&(re=W),j<W&&(j=W));return[re,j]}var x=Array.prototype,M=x.slice,v=x.map;function _(V){return function(){return V}}function l(V){return V}function y(V,H,ee){V=+V,H=+H,ee=(W=arguments.length)<2?(H=V,V=0,1):W<3?1:+ee;for(var J=-1,W=Math.max(0,Math.ceil((H-V)/ee))|0,re=new Array(W);++J<W;)re[J]=V+J*ee;return re}var T=Math.sqrt(50),w=Math.sqrt(10),A=Math.sqrt(2);function f(V,H,ee){var J,W=-1,re,j,Z;if(H=+H,V=+V,ee=+ee,V===H&&ee>0)return[V];if((J=H<V)&&(re=V,V=H,H=re),(Z=u(V,H,ee))===0||!isFinite(Z))return[];if(Z>0)for(V=Math.ceil(V/Z),H=Math.floor(H/Z),j=new Array(re=Math.ceil(H-V+1));++W<re;)j[W]=(V+W)*Z;else for(V=Math.floor(V*Z),H=Math.ceil(H*Z),j=new Array(re=Math.ceil(V-H+1));++W<re;)j[W]=(V-W)/Z;return J&&j.reverse(),j}function u(V,H,ee){var J=(H-V)/Math.max(0,ee),W=Math.floor(Math.log(J)/Math.LN10),re=J/Math.pow(10,W);return W>=0?(re>=T?10:re>=w?5:re>=A?2:1)*Math.pow(10,W):-Math.pow(10,-W)/(re>=T?10:re>=w?5:re>=A?2:1)}function h(V,H,ee){var J=Math.abs(H-V)/Math.max(0,ee),W=Math.pow(10,Math.floor(Math.log(J)/Math.LN10)),re=J/W;return re>=T?W*=10:re>=w?W*=5:re>=A&&(W*=2),H<V?-W:W}function o(V){return Math.ceil(Math.log(V.length)/Math.LN2)+1}function S(){var V=l,H=m,ee=o;function J(W){var re,j=W.length,Z,ne=new Array(j);for(re=0;re<j;++re)ne[re]=V(W[re],re,W);var le=H(ne),ge=le[0],pe=le[1],xe=ee(ne,ge,pe);Array.isArray(xe)||(xe=h(ge,pe,xe),xe=y(Math.ceil(ge/xe)*xe,pe,xe));for(var Ee=xe.length;xe[0]<=ge;)xe.shift(),--Ee;for(;xe[Ee-1]>pe;)xe.pop(),--Ee;var Te=new Array(Ee+1),de;for(re=0;re<=Ee;++re)de=Te[re]=[],de.x0=re>0?xe[re-1]:ge,de.x1=re<Ee?xe[re]:pe;for(re=0;re<j;++re)Z=ne[re],ge<=Z&&Z<=pe&&Te[p(xe,Z,0,Ee)].push(W[re]);return Te}return J.value=function(W){return arguments.length?(V=typeof W=="function"?W:_(W),J):V},J.domain=function(W){return arguments.length?(H=typeof W=="function"?W:_([W[0],W[1]]),J):H},J.thresholds=function(W){return arguments.length?(ee=typeof W=="function"?W:Array.isArray(W)?_(M.call(W)):_(W),J):ee},J}function R(V,H,ee){if(ee==null&&(ee=r),!!(J=V.length)){if((H=+H)<=0||J<2)return+ee(V[0],0,V);if(H>=1)return+ee(V[J-1],J-1,V);var J,W=(J-1)*H,re=Math.floor(W),j=+ee(V[re],re,V),Z=+ee(V[re+1],re+1,V);return j+(Z-j)*(W-re)}}function z(V,H,ee){return V=v.call(V,r).sort(k),Math.ceil((ee-H)/(2*(R(V,.75)-R(V,.25))*Math.pow(V.length,-1/3)))}function O(V,H,ee){return Math.ceil((ee-H)/(3.5*s(V)*Math.pow(V.length,-1/3)))}function I(V,H){var ee=V.length,J=-1,W,re;if(H==null){for(;++J<ee;)if((W=V[J])!=null&&W>=W)for(re=W;++J<ee;)(W=V[J])!=null&&W>re&&(re=W)}else for(;++J<ee;)if((W=H(V[J],J,V))!=null&&W>=W)for(re=W;++J<ee;)(W=H(V[J],J,V))!=null&&W>re&&(re=W);return re}function F(V,H){var ee=V.length,J=ee,W=-1,re,j=0;if(H==null)for(;++W<ee;)isNaN(re=r(V[W]))?--J:j+=re;else for(;++W<ee;)isNaN(re=r(H(V[W],W,V)))?--J:j+=re;if(J)return j/J}function D(V,H){var ee=V.length,J=-1,W,re=[];if(H==null)for(;++J<ee;)isNaN(W=r(V[J]))||re.push(W);else for(;++J<ee;)isNaN(W=r(H(V[J],J,V)))||re.push(W);return R(re.sort(k),.5)}function B(V){for(var H=V.length,ee,J=-1,W=0,re,j;++J<H;)W+=V[J].length;for(re=new Array(W);--H>=0;)for(j=V[H],ee=j.length;--ee>=0;)re[--W]=j[ee];return re}function U(V,H){var ee=V.length,J=-1,W,re;if(H==null){for(;++J<ee;)if((W=V[J])!=null&&W>=W)for(re=W;++J<ee;)(W=V[J])!=null&&re>W&&(re=W)}else for(;++J<ee;)if((W=H(V[J],J,V))!=null&&W>=W)for(re=W;++J<ee;)(W=H(V[J],J,V))!=null&&re>W&&(re=W);return re}function X(V,H){for(var ee=H.length,J=new Array(ee);ee--;)J[ee]=V[H[ee]];return J}function oe(V,H){if(!!(ee=V.length)){var ee,J=0,W=0,re,j=V[W];for(H==null&&(H=k);++J<ee;)(H(re=V[J],j)<0||H(j,j)!==0)&&(j=re,W=J);if(H(j,j)===0)return W}}function se(V,H,ee){for(var J=(ee??V.length)-(H=H==null?0:+H),W,re;J;)re=Math.random()*J--|0,W=V[J+H],V[J+H]=V[re+H],V[re+H]=W;return V}function q(V,H){var ee=V.length,J=-1,W,re=0;if(H==null)for(;++J<ee;)(W=+V[J])&&(re+=W);else for(;++J<ee;)(W=+H(V[J],J,V))&&(re+=W);return re}function K(V){if(!(re=V.length))return[];for(var H=-1,ee=U(V,G),J=new Array(ee);++H<ee;)for(var W=-1,re,j=J[H]=new Array(re);++W<re;)j[W]=V[W][H];return J}function G(V){return V.length}function Q(){return K(arguments)}b.bisect=p,b.bisectRight=p,b.bisectLeft=g,b.ascending=k,b.bisector=P,b.cross=i,b.descending=n,b.deviation=s,b.extent=m,b.histogram=S,b.thresholdFreedmanDiaconis=z,b.thresholdScott=O,b.thresholdSturges=o,b.max=I,b.mean=F,b.median=D,b.merge=B,b.min=U,b.pairs=a,b.permute=X,b.quantile=R,b.range=y,b.scan=oe,b.shuffle=se,b.sum=q,b.ticks=f,b.tickIncrement=u,b.tickStep=h,b.transpose=K,b.variance=d,b.zip=Q,Object.defineProperty(b,"__esModule",{value:!0})})},{}],108:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):k(b.d3=b.d3||{})})(this,function(b){"use strict";var k="$";function P(){}P.prototype=E.prototype={constructor:P,has:function(x){return k+x in this},get:function(x){return this[k+x]},set:function(x,M){return this[k+x]=M,this},remove:function(x){var M=k+x;return M in this&&delete this[M]},clear:function(){for(var x in this)x[0]===k&&delete this[x]},keys:function(){var x=[];for(var M in this)M[0]===k&&x.push(M.slice(1));return x},values:function(){var x=[];for(var M in this)M[0]===k&&x.push(this[M]);return x},entries:function(){var x=[];for(var M in this)M[0]===k&&x.push({key:M.slice(1),value:this[M]});return x},size:function(){var x=0;for(var M in this)M[0]===k&&++x;return x},empty:function(){for(var x in this)if(x[0]===k)return!1;return!0},each:function(x){for(var M in this)M[0]===k&&x(this[M],M.slice(1),this)}};function E(x,M){var v=new P;if(x instanceof P)x.each(function(w,A){v.set(A,w)});else if(Array.isArray(x)){var _=-1,l=x.length,y;if(M==null)for(;++_<l;)v.set(_,x[_]);else for(;++_<l;)v.set(M(y=x[_],_,x),y)}else if(x)for(var T in x)v.set(T,x[T]);return v}function e(){var x=[],M=[],v,_,l;function y(w,A,f,u){if(A>=x.length)return v!=null&&w.sort(v),_!=null?_(w):w;for(var h=-1,o=w.length,S=x[A++],R,z,O=E(),I,F=f();++h<o;)(I=O.get(R=S(z=w[h])+""))?I.push(z):O.set(R,[z]);return O.each(function(D,B){u(F,B,y(D,A,f,u))}),F}function T(w,A){if(++A>x.length)return w;var f,u=M[A-1];return _!=null&&A>=x.length?f=w.entries():(f=[],w.each(function(h,o){f.push({key:o,values:T(h,A)})})),u!=null?f.sort(function(h,o){return u(h.key,o.key)}):f}return l={object:function(w){return y(w,0,p,g)},map:function(w){return y(w,0,a,t)},entries:function(w){return T(y(w,0,a,t),0)},key:function(w){return x.push(w),l},sortKeys:function(w){return M[x.length-1]=w,l},sortValues:function(w){return v=w,l},rollup:function(w){return _=w,l}}}function p(){return{}}function g(x,M,v){x[M]=v}function a(){return E()}function t(x,M,v){x.set(M,v)}function i(){}var n=E.prototype;i.prototype=r.prototype={constructor:i,has:n.has,add:function(x){return x+="",this[k+x]=x,this},remove:n.remove,clear:n.clear,values:n.keys,size:n.size,empty:n.empty,each:n.each};function r(x,M){var v=new i;if(x instanceof i)x.each(function(y){v.add(y)});else if(x){var _=-1,l=x.length;if(M==null)for(;++_<l;)v.add(x[_]);else for(;++_<l;)v.add(M(x[_],_,x))}return v}function d(x){var M=[];for(var v in x)M.push(v);return M}function s(x){var M=[];for(var v in x)M.push(x[v]);return M}function m(x){var M=[];for(var v in x)M.push({key:v,value:x[v]});return M}b.nest=e,b.set=r,b.map=E,b.keys=d,b.values=s,b.entries=m,Object.defineProperty(b,"__esModule",{value:!0})})},{}],109:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):(b=b||self,k(b.d3=b.d3||{}))})(this,function(b){"use strict";function k(Ue,Ie,at){Ue.prototype=Ie.prototype=at,at.constructor=Ue}function P(Ue,Ie){var at=Object.create(Ue.prototype);for(var pt in Ie)at[pt]=Ie[pt];return at}function E(){}var e=.7,p=1/e,g="\\s*([+-]?\\d+)\\s*",a="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",i=/^#([0-9a-f]{3,8})$/,n=new RegExp("^rgb\\("+[g,g,g]+"\\)$"),r=new RegExp("^rgb\\("+[t,t,t]+"\\)$"),d=new RegExp("^rgba\\("+[g,g,g,a]+"\\)$"),s=new RegExp("^rgba\\("+[t,t,t,a]+"\\)$"),m=new RegExp("^hsl\\("+[a,t,t]+"\\)$"),x=new RegExp("^hsla\\("+[a,t,t,a]+"\\)$"),M={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};k(E,y,{copy:function(Ue){return Object.assign(new this.constructor,this,Ue)},displayable:function(){return this.rgb().displayable()},hex:v,formatHex:v,formatHsl:_,formatRgb:l,toString:l});function v(){return this.rgb().formatHex()}function _(){return z(this).formatHsl()}function l(){return this.rgb().formatRgb()}function y(Ue){var Ie,at;return Ue=(Ue+"").trim().toLowerCase(),(Ie=i.exec(Ue))?(at=Ie[1].length,Ie=parseInt(Ie[1],16),at===6?T(Ie):at===3?new u(Ie>>8&15|Ie>>4&240,Ie>>4&15|Ie&240,(Ie&15)<<4|Ie&15,1):at===8?w(Ie>>24&255,Ie>>16&255,Ie>>8&255,(Ie&255)/255):at===4?w(Ie>>12&15|Ie>>8&240,Ie>>8&15|Ie>>4&240,Ie>>4&15|Ie&240,((Ie&15)<<4|Ie&15)/255):null):(Ie=n.exec(Ue))?new u(Ie[1],Ie[2],Ie[3],1):(Ie=r.exec(Ue))?new u(Ie[1]*255/100,Ie[2]*255/100,Ie[3]*255/100,1):(Ie=d.exec(Ue))?w(Ie[1],Ie[2],Ie[3],Ie[4]):(Ie=s.exec(Ue))?w(Ie[1]*255/100,Ie[2]*255/100,Ie[3]*255/100,Ie[4]):(Ie=m.exec(Ue))?R(Ie[1],Ie[2]/100,Ie[3]/100,1):(Ie=x.exec(Ue))?R(Ie[1],Ie[2]/100,Ie[3]/100,Ie[4]):M.hasOwnProperty(Ue)?T(M[Ue]):Ue==="transparent"?new u(NaN,NaN,NaN,0):null}function T(Ue){return new u(Ue>>16&255,Ue>>8&255,Ue&255,1)}function w(Ue,Ie,at,pt){return pt<=0&&(Ue=Ie=at=NaN),new u(Ue,Ie,at,pt)}function A(Ue){return Ue instanceof E||(Ue=y(Ue)),Ue?(Ue=Ue.rgb(),new u(Ue.r,Ue.g,Ue.b,Ue.opacity)):new u}function f(Ue,Ie,at,pt){return arguments.length===1?A(Ue):new u(Ue,Ie,at,pt??1)}function u(Ue,Ie,at,pt){this.r=+Ue,this.g=+Ie,this.b=+at,this.opacity=+pt}k(u,f,P(E,{brighter:function(Ue){return Ue=Ue==null?p:Math.pow(p,Ue),new u(this.r*Ue,this.g*Ue,this.b*Ue,this.opacity)},darker:function(Ue){return Ue=Ue==null?e:Math.pow(e,Ue),new u(this.r*Ue,this.g*Ue,this.b*Ue,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:h,formatHex:h,formatRgb:o,toString:o}));function h(){return"#"+S(this.r)+S(this.g)+S(this.b)}function o(){var Ue=this.opacity;return Ue=isNaN(Ue)?1:Math.max(0,Math.min(1,Ue)),(Ue===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(Ue===1?")":", "+Ue+")")}function S(Ue){return Ue=Math.max(0,Math.min(255,Math.round(Ue)||0)),(Ue<16?"0":"")+Ue.toString(16)}function R(Ue,Ie,at,pt){return pt<=0?Ue=Ie=at=NaN:at<=0||at>=1?Ue=Ie=NaN:Ie<=0&&(Ue=NaN),new I(Ue,Ie,at,pt)}function z(Ue){if(Ue instanceof I)return new I(Ue.h,Ue.s,Ue.l,Ue.opacity);if(Ue instanceof E||(Ue=y(Ue)),!Ue)return new I;if(Ue instanceof I)return Ue;Ue=Ue.rgb();var Ie=Ue.r/255,at=Ue.g/255,pt=Ue.b/255,Rt=Math.min(Ie,at,pt),Mt=Math.max(Ie,at,pt),It=NaN,Bt=Mt-Rt,St=(Mt+Rt)/2;return Bt?(Ie===Mt?It=(at-pt)/Bt+(at<pt)*6:at===Mt?It=(pt-Ie)/Bt+2:It=(Ie-at)/Bt+4,Bt/=St<.5?Mt+Rt:2-Mt-Rt,It*=60):Bt=St>0&&St<1?0:It,new I(It,Bt,St,Ue.opacity)}function O(Ue,Ie,at,pt){return arguments.length===1?z(Ue):new I(Ue,Ie,at,pt??1)}function I(Ue,Ie,at,pt){this.h=+Ue,this.s=+Ie,this.l=+at,this.opacity=+pt}k(I,O,P(E,{brighter:function(Ue){return Ue=Ue==null?p:Math.pow(p,Ue),new I(this.h,this.s,this.l*Ue,this.opacity)},darker:function(Ue){return Ue=Ue==null?e:Math.pow(e,Ue),new I(this.h,this.s,this.l*Ue,this.opacity)},rgb:function(){var Ue=this.h%360+(this.h<0)*360,Ie=isNaN(Ue)||isNaN(this.s)?0:this.s,at=this.l,pt=at+(at<.5?at:1-at)*Ie,Rt=2*at-pt;return new u(F(Ue>=240?Ue-240:Ue+120,Rt,pt),F(Ue,Rt,pt),F(Ue<120?Ue+240:Ue-120,Rt,pt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var Ue=this.opacity;return Ue=isNaN(Ue)?1:Math.max(0,Math.min(1,Ue)),(Ue===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(Ue===1?")":", "+Ue+")")}}));function F(Ue,Ie,at){return(Ue<60?Ie+(at-Ie)*Ue/60:Ue<180?at:Ue<240?Ie+(at-Ie)*(240-Ue)/60:Ie)*255}var D=Math.PI/180,B=180/Math.PI,U=18,X=.96422,oe=1,se=.82521,q=4/29,K=6/29,G=3*K*K,Q=K*K*K;function V(Ue){if(Ue instanceof J)return new J(Ue.l,Ue.a,Ue.b,Ue.opacity);if(Ue instanceof pe)return xe(Ue);Ue instanceof u||(Ue=A(Ue));var Ie=Z(Ue.r),at=Z(Ue.g),pt=Z(Ue.b),Rt=W((.2225045*Ie+.7168786*at+.0606169*pt)/oe),Mt,It;return Ie===at&&at===pt?Mt=It=Rt:(Mt=W((.4360747*Ie+.3850649*at+.1430804*pt)/X),It=W((.0139322*Ie+.0971045*at+.7141733*pt)/se)),new J(116*Rt-16,500*(Mt-Rt),200*(Rt-It),Ue.opacity)}function H(Ue,Ie){return new J(Ue,0,0,Ie??1)}function ee(Ue,Ie,at,pt){return arguments.length===1?V(Ue):new J(Ue,Ie,at,pt??1)}function J(Ue,Ie,at,pt){this.l=+Ue,this.a=+Ie,this.b=+at,this.opacity=+pt}k(J,ee,P(E,{brighter:function(Ue){return new J(this.l+U*(Ue??1),this.a,this.b,this.opacity)},darker:function(Ue){return new J(this.l-U*(Ue??1),this.a,this.b,this.opacity)},rgb:function(){var Ue=(this.l+16)/116,Ie=isNaN(this.a)?Ue:Ue+this.a/500,at=isNaN(this.b)?Ue:Ue-this.b/200;return Ie=X*re(Ie),Ue=oe*re(Ue),at=se*re(at),new u(j(3.1338561*Ie-1.6168667*Ue-.4906146*at),j(-.9787684*Ie+1.9161415*Ue+.033454*at),j(.0719453*Ie-.2289914*Ue+1.4052427*at),this.opacity)}}));function W(Ue){return Ue>Q?Math.pow(Ue,1/3):Ue/G+q}function re(Ue){return Ue>K?Ue*Ue*Ue:G*(Ue-q)}function j(Ue){return 255*(Ue<=.0031308?12.92*Ue:1.055*Math.pow(Ue,1/2.4)-.055)}function Z(Ue){return(Ue/=255)<=.04045?Ue/12.92:Math.pow((Ue+.055)/1.055,2.4)}function ne(Ue){if(Ue instanceof pe)return new pe(Ue.h,Ue.c,Ue.l,Ue.opacity);if(Ue instanceof J||(Ue=V(Ue)),Ue.a===0&&Ue.b===0)return new pe(NaN,0<Ue.l&&Ue.l<100?0:NaN,Ue.l,Ue.opacity);var Ie=Math.atan2(Ue.b,Ue.a)*B;return new pe(Ie<0?Ie+360:Ie,Math.sqrt(Ue.a*Ue.a+Ue.b*Ue.b),Ue.l,Ue.opacity)}function le(Ue,Ie,at,pt){return arguments.length===1?ne(Ue):new pe(at,Ie,Ue,pt??1)}function ge(Ue,Ie,at,pt){return arguments.length===1?ne(Ue):new pe(Ue,Ie,at,pt??1)}function pe(Ue,Ie,at,pt){this.h=+Ue,this.c=+Ie,this.l=+at,this.opacity=+pt}function xe(Ue){if(isNaN(Ue.h))return new J(Ue.l,0,0,Ue.opacity);var Ie=Ue.h*D;return new J(Ue.l,Math.cos(Ie)*Ue.c,Math.sin(Ie)*Ue.c,Ue.opacity)}k(pe,ge,P(E,{brighter:function(Ue){return new pe(this.h,this.c,this.l+U*(Ue??1),this.opacity)},darker:function(Ue){return new pe(this.h,this.c,this.l-U*(Ue??1),this.opacity)},rgb:function(){return xe(this).rgb()}}));var Ee=-.14861,Te=1.78277,de=-.29227,be=-.90649,Le=1.97294,De=Le*be,ye=Le*Te,ke=Te*de-be*Ee;function Oe(Ue){if(Ue instanceof Ve)return new Ve(Ue.h,Ue.s,Ue.l,Ue.opacity);Ue instanceof u||(Ue=A(Ue));var Ie=Ue.r/255,at=Ue.g/255,pt=Ue.b/255,Rt=(ke*pt+De*Ie-ye*at)/(ke+De-ye),Mt=pt-Rt,It=(Le*(at-Rt)-de*Mt)/be,Bt=Math.sqrt(It*It+Mt*Mt)/(Le*Rt*(1-Rt)),St=Bt?Math.atan2(It,Mt)*B-120:NaN;return new Ve(St<0?St+360:St,Bt,Rt,Ue.opacity)}function Qe(Ue,Ie,at,pt){return arguments.length===1?Oe(Ue):new Ve(Ue,Ie,at,pt??1)}function Ve(Ue,Ie,at,pt){this.h=+Ue,this.s=+Ie,this.l=+at,this.opacity=+pt}k(Ve,Qe,P(E,{brighter:function(Ue){return Ue=Ue==null?p:Math.pow(p,Ue),new Ve(this.h,this.s,this.l*Ue,this.opacity)},darker:function(Ue){return Ue=Ue==null?e:Math.pow(e,Ue),new Ve(this.h,this.s,this.l*Ue,this.opacity)},rgb:function(){var Ue=isNaN(this.h)?0:(this.h+120)*D,Ie=+this.l,at=isNaN(this.s)?0:this.s*Ie*(1-Ie),pt=Math.cos(Ue),Rt=Math.sin(Ue);return new u(255*(Ie+at*(Ee*pt+Te*Rt)),255*(Ie+at*(de*pt+be*Rt)),255*(Ie+at*(Le*pt)),this.opacity)}})),b.color=y,b.cubehelix=Qe,b.gray=H,b.hcl=ge,b.hsl=O,b.lab=ee,b.lch=le,b.rgb=f,Object.defineProperty(b,"__esModule",{value:!0})})},{}],110:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):(b=b||self,k(b.d3=b.d3||{}))})(this,function(b){"use strict";var k={value:function(){}};function P(){for(var a=0,t=arguments.length,i={},n;a<t;++a){if(!(n=arguments[a]+"")||n in i||/[\s.]/.test(n))throw new Error("illegal type: "+n);i[n]=[]}return new E(i)}function E(a){this._=a}function e(a,t){return a.trim().split(/^|\s+/).map(function(i){var n="",r=i.indexOf(".");if(r>=0&&(n=i.slice(r+1),i=i.slice(0,r)),i&&!t.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:n}})}E.prototype=P.prototype={constructor:E,on:function(a,t){var i=this._,n=e(a+"",i),r,d=-1,s=n.length;if(arguments.length<2){for(;++d<s;)if((r=(a=n[d]).type)&&(r=p(i[r],a.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++d<s;)if(r=(a=n[d]).type)i[r]=g(i[r],a.name,t);else if(t==null)for(r in i)i[r]=g(i[r],a.name,null);return this},copy:function(){var a={},t=this._;for(var i in t)a[i]=t[i].slice();return new E(a)},call:function(a,t){if((r=arguments.length-2)>0)for(var i=new Array(r),n=0,r,d;n<r;++n)i[n]=arguments[n+2];if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(d=this._[a],n=0,r=d.length;n<r;++n)d[n].value.apply(t,i)},apply:function(a,t,i){if(!this._.hasOwnProperty(a))throw new Error("unknown type: "+a);for(var n=this._[a],r=0,d=n.length;r<d;++r)n[r].value.apply(t,i)}};function p(a,t){for(var i=0,n=a.length,r;i<n;++i)if((r=a[i]).name===t)return r.value}function g(a,t,i){for(var n=0,r=a.length;n<r;++n)if(a[n].name===t){a[n]=k,a=a.slice(0,n).concat(a.slice(n+1));break}return i!=null&&a.push({name:t,value:i}),a}b.dispatch=P,Object.defineProperty(b,"__esModule",{value:!0})})},{}],111:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie,c("d3-quadtree"),c("d3-collection"),c("d3-dispatch"),c("d3-timer")):typeof Vr=="function"&&Vr.amd?Vr(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],k):k(b.d3=b.d3||{},b.d3,b.d3,b.d3,b.d3)})(this,function(b,k,P,E,e){"use strict";function p(A,f){var u;A==null&&(A=0),f==null&&(f=0);function h(){var o,S=u.length,R,z=0,O=0;for(o=0;o<S;++o)R=u[o],z+=R.x,O+=R.y;for(z=z/S-A,O=O/S-f,o=0;o<S;++o)R=u[o],R.x-=z,R.y-=O}return h.initialize=function(o){u=o},h.x=function(o){return arguments.length?(A=+o,h):A},h.y=function(o){return arguments.length?(f=+o,h):f},h}function g(A){return function(){return A}}function a(){return(Math.random()-.5)*1e-6}function t(A){return A.x+A.vx}function i(A){return A.y+A.vy}function n(A){var f,u,h=1,o=1;typeof A!="function"&&(A=g(A==null?1:+A));function S(){for(var O,I=f.length,F,D,B,U,X,oe,se=0;se<o;++se)for(F=k.quadtree(f,t,i).visitAfter(R),O=0;O<I;++O)D=f[O],X=u[D.index],oe=X*X,B=D.x+D.vx,U=D.y+D.vy,F.visit(q);function q(K,G,Q,V,H){var ee=K.data,J=K.r,W=X+J;if(ee){if(ee.index>D.index){var re=B-ee.x-ee.vx,j=U-ee.y-ee.vy,Z=re*re+j*j;Z<W*W&&(re===0&&(re=a(),Z+=re*re),j===0&&(j=a(),Z+=j*j),Z=(W-(Z=Math.sqrt(Z)))/Z*h,D.vx+=(re*=Z)*(W=(J*=J)/(oe+J)),D.vy+=(j*=Z)*W,ee.vx-=re*(W=1-W),ee.vy-=j*W)}return}return G>B+W||V<B-W||Q>U+W||H<U-W}}function R(O){if(O.data)return O.r=u[O.data.index];for(var I=O.r=0;I<4;++I)O[I]&&O[I].r>O.r&&(O.r=O[I].r)}function z(){if(!!f){var O,I=f.length,F;for(u=new Array(I),O=0;O<I;++O)F=f[O],u[F.index]=+A(F,O,f)}}return S.initialize=function(O){f=O,z()},S.iterations=function(O){return arguments.length?(o=+O,S):o},S.strength=function(O){return arguments.length?(h=+O,S):h},S.radius=function(O){return arguments.length?(A=typeof O=="function"?O:g(+O),z(),S):A},S}function r(A){return A.index}function d(A,f){var u=A.get(f);if(!u)throw new Error("missing: "+f);return u}function s(A){var f=r,u=F,h,o=g(30),S,R,z,O,I=1;A==null&&(A=[]);function F(oe){return 1/Math.min(z[oe.source.index],z[oe.target.index])}function D(oe){for(var se=0,q=A.length;se<I;++se)for(var K=0,G,Q,V,H,ee,J,W;K<q;++K)G=A[K],Q=G.source,V=G.target,H=V.x+V.vx-Q.x-Q.vx||a(),ee=V.y+V.vy-Q.y-Q.vy||a(),J=Math.sqrt(H*H+ee*ee),J=(J-S[K])/J*oe*h[K],H*=J,ee*=J,V.vx-=H*(W=O[K]),V.vy-=ee*W,Q.vx+=H*(W=1-W),Q.vy+=ee*W}function B(){if(!!R){var oe,se=R.length,q=A.length,K=P.map(R,f),G;for(oe=0,z=new Array(se);oe<q;++oe)G=A[oe],G.index=oe,typeof G.source!="object"&&(G.source=d(K,G.source)),typeof G.target!="object"&&(G.target=d(K,G.target)),z[G.source.index]=(z[G.source.index]||0)+1,z[G.target.index]=(z[G.target.index]||0)+1;for(oe=0,O=new Array(q);oe<q;++oe)G=A[oe],O[oe]=z[G.source.index]/(z[G.source.index]+z[G.target.index]);h=new Array(q),U(),S=new Array(q),X()}}function U(){if(!!R)for(var oe=0,se=A.length;oe<se;++oe)h[oe]=+u(A[oe],oe,A)}function X(){if(!!R)for(var oe=0,se=A.length;oe<se;++oe)S[oe]=+o(A[oe],oe,A)}return D.initialize=function(oe){R=oe,B()},D.links=function(oe){return arguments.length?(A=oe,B(),D):A},D.id=function(oe){return arguments.length?(f=oe,D):f},D.iterations=function(oe){return arguments.length?(I=+oe,D):I},D.strength=function(oe){return arguments.length?(u=typeof oe=="function"?oe:g(+oe),U(),D):u},D.distance=function(oe){return arguments.length?(o=typeof oe=="function"?oe:g(+oe),X(),D):o},D}function m(A){return A.x}function x(A){return A.y}var M=10,v=Math.PI*(3-Math.sqrt(5));function _(A){var f,u=1,h=.001,o=1-Math.pow(h,1/300),S=0,R=.6,z=P.map(),O=e.timer(F),I=E.dispatch("tick","end");A==null&&(A=[]);function F(){D(),I.call("tick",f),u<h&&(O.stop(),I.call("end",f))}function D(X){var oe,se=A.length,q;X===void 0&&(X=1);for(var K=0;K<X;++K)for(u+=(S-u)*o,z.each(function(G){G(u)}),oe=0;oe<se;++oe)q=A[oe],q.fx==null?q.x+=q.vx*=R:(q.x=q.fx,q.vx=0),q.fy==null?q.y+=q.vy*=R:(q.y=q.fy,q.vy=0);return f}function B(){for(var X=0,oe=A.length,se;X<oe;++X){if(se=A[X],se.index=X,se.fx!=null&&(se.x=se.fx),se.fy!=null&&(se.y=se.fy),isNaN(se.x)||isNaN(se.y)){var q=M*Math.sqrt(X),K=X*v;se.x=q*Math.cos(K),se.y=q*Math.sin(K)}(isNaN(se.vx)||isNaN(se.vy))&&(se.vx=se.vy=0)}}function U(X){return X.initialize&&X.initialize(A),X}return B(),f={tick:D,restart:function(){return O.restart(F),f},stop:function(){return O.stop(),f},nodes:function(X){return arguments.length?(A=X,B(),z.each(U),f):A},alpha:function(X){return arguments.length?(u=+X,f):u},alphaMin:function(X){return arguments.length?(h=+X,f):h},alphaDecay:function(X){return arguments.length?(o=+X,f):+o},alphaTarget:function(X){return arguments.length?(S=+X,f):S},velocityDecay:function(X){return arguments.length?(R=1-X,f):1-R},force:function(X,oe){return arguments.length>1?(oe==null?z.remove(X):z.set(X,U(oe)),f):z.get(X)},find:function(X,oe,se){var q=0,K=A.length,G,Q,V,H,ee;for(se==null?se=1/0:se*=se,q=0;q<K;++q)H=A[q],G=X-H.x,Q=oe-H.y,V=G*G+Q*Q,V<se&&(ee=H,se=V);return ee},on:function(X,oe){return arguments.length>1?(I.on(X,oe),f):I.on(X)}}}function l(){var A,f,u,h=g(-30),o,S=1,R=1/0,z=.81;function O(B){var U,X=A.length,oe=k.quadtree(A,m,x).visitAfter(F);for(u=B,U=0;U<X;++U)f=A[U],oe.visit(D)}function I(){if(!!A){var B,U=A.length,X;for(o=new Array(U),B=0;B<U;++B)X=A[B],o[X.index]=+h(X,B,A)}}function F(B){var U=0,X,oe,se=0,q,K,G;if(B.length){for(q=K=G=0;G<4;++G)(X=B[G])&&(oe=Math.abs(X.value))&&(U+=X.value,se+=oe,q+=oe*X.x,K+=oe*X.y);B.x=q/se,B.y=K/se}else{X=B,X.x=X.data.x,X.y=X.data.y;do U+=o[X.data.index];while(X=X.next)}B.value=U}function D(B,U,X,oe){if(!B.value)return!0;var se=B.x-f.x,q=B.y-f.y,K=oe-U,G=se*se+q*q;if(K*K/z<G)return G<R&&(se===0&&(se=a(),G+=se*se),q===0&&(q=a(),G+=q*q),G<S&&(G=Math.sqrt(S*G)),f.vx+=se*B.value*u/G,f.vy+=q*B.value*u/G),!0;if(B.length||G>=R)return;(B.data!==f||B.next)&&(se===0&&(se=a(),G+=se*se),q===0&&(q=a(),G+=q*q),G<S&&(G=Math.sqrt(S*G)));do B.data!==f&&(K=o[B.data.index]*u/G,f.vx+=se*K,f.vy+=q*K);while(B=B.next)}return O.initialize=function(B){A=B,I()},O.strength=function(B){return arguments.length?(h=typeof B=="function"?B:g(+B),I(),O):h},O.distanceMin=function(B){return arguments.length?(S=B*B,O):Math.sqrt(S)},O.distanceMax=function(B){return arguments.length?(R=B*B,O):Math.sqrt(R)},O.theta=function(B){return arguments.length?(z=B*B,O):Math.sqrt(z)},O}function y(A,f,u){var h,o=g(.1),S,R;typeof A!="function"&&(A=g(+A)),f==null&&(f=0),u==null&&(u=0);function z(I){for(var F=0,D=h.length;F<D;++F){var B=h[F],U=B.x-f||1e-6,X=B.y-u||1e-6,oe=Math.sqrt(U*U+X*X),se=(R[F]-oe)*S[F]*I/oe;B.vx+=U*se,B.vy+=X*se}}function O(){if(!!h){var I,F=h.length;for(S=new Array(F),R=new Array(F),I=0;I<F;++I)R[I]=+A(h[I],I,h),S[I]=isNaN(R[I])?0:+o(h[I],I,h)}}return z.initialize=function(I){h=I,O()},z.strength=function(I){return arguments.length?(o=typeof I=="function"?I:g(+I),O(),z):o},z.radius=function(I){return arguments.length?(A=typeof I=="function"?I:g(+I),O(),z):A},z.x=function(I){return arguments.length?(f=+I,z):f},z.y=function(I){return arguments.length?(u=+I,z):u},z}function T(A){var f=g(.1),u,h,o;typeof A!="function"&&(A=g(A==null?0:+A));function S(z){for(var O=0,I=u.length,F;O<I;++O)F=u[O],F.vx+=(o[O]-F.x)*h[O]*z}function R(){if(!!u){var z,O=u.length;for(h=new Array(O),o=new Array(O),z=0;z<O;++z)h[z]=isNaN(o[z]=+A(u[z],z,u))?0:+f(u[z],z,u)}}return S.initialize=function(z){u=z,R()},S.strength=function(z){return arguments.length?(f=typeof z=="function"?z:g(+z),R(),S):f},S.x=function(z){return arguments.length?(A=typeof z=="function"?z:g(+z),R(),S):A},S}function w(A){var f=g(.1),u,h,o;typeof A!="function"&&(A=g(A==null?0:+A));function S(z){for(var O=0,I=u.length,F;O<I;++O)F=u[O],F.vy+=(o[O]-F.y)*h[O]*z}function R(){if(!!u){var z,O=u.length;for(h=new Array(O),o=new Array(O),z=0;z<O;++z)h[z]=isNaN(o[z]=+A(u[z],z,u))?0:+f(u[z],z,u)}}return S.initialize=function(z){u=z,R()},S.strength=function(z){return arguments.length?(f=typeof z=="function"?z:g(+z),R(),S):f},S.y=function(z){return arguments.length?(A=typeof z=="function"?z:g(+z),R(),S):A},S}b.forceCenter=p,b.forceCollide=n,b.forceLink=s,b.forceManyBody=l,b.forceRadial=y,b.forceSimulation=_,b.forceX=T,b.forceY=w,Object.defineProperty(b,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):(b=typeof globalThis<"u"?globalThis:b||self,k(b.d3=b.d3||{}))})(this,function(b){"use strict";function k(A){return Math.abs(A=Math.round(A))>=1e21?A.toLocaleString("en").replace(/,/g,""):A.toString(10)}function P(A,f){if((u=(A=f?A.toExponential(f-1):A.toExponential()).indexOf("e"))<0)return null;var u,h=A.slice(0,u);return[h.length>1?h[0]+h.slice(2):h,+A.slice(u+1)]}function E(A){return A=P(Math.abs(A)),A?A[1]:NaN}function e(A,f){return function(u,h){for(var o=u.length,S=[],R=0,z=A[0],O=0;o>0&&z>0&&(O+z+1>h&&(z=Math.max(1,h-O)),S.push(u.substring(o-=z,o+z)),!((O+=z+1)>h));)z=A[R=(R+1)%A.length];return S.reverse().join(f)}}function p(A){return function(f){return f.replace(/[0-9]/g,function(u){return A[+u]})}}var g=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function a(A){if(!(f=g.exec(A)))throw new Error("invalid format: "+A);var f;return new t({fill:f[1],align:f[2],sign:f[3],symbol:f[4],zero:f[5],width:f[6],comma:f[7],precision:f[8]&&f[8].slice(1),trim:f[9],type:f[10]})}a.prototype=t.prototype;function t(A){this.fill=A.fill===void 0?" ":A.fill+"",this.align=A.align===void 0?">":A.align+"",this.sign=A.sign===void 0?"-":A.sign+"",this.symbol=A.symbol===void 0?"":A.symbol+"",this.zero=!!A.zero,this.width=A.width===void 0?void 0:+A.width,this.comma=!!A.comma,this.precision=A.precision===void 0?void 0:+A.precision,this.trim=!!A.trim,this.type=A.type===void 0?"":A.type+""}t.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function i(A){e:for(var f=A.length,u=1,h=-1,o;u<f;++u)switch(A[u]){case".":h=o=u;break;case"0":h===0&&(h=u),o=u;break;default:if(!+A[u])break e;h>0&&(h=0);break}return h>0?A.slice(0,h)+A.slice(o+1):A}var n;function r(A,f){var u=P(A,f);if(!u)return A+"";var h=u[0],o=u[1],S=o-(n=Math.max(-8,Math.min(8,Math.floor(o/3)))*3)+1,R=h.length;return S===R?h:S>R?h+new Array(S-R+1).join("0"):S>0?h.slice(0,S)+"."+h.slice(S):"0."+new Array(1-S).join("0")+P(A,Math.max(0,f+S-1))[0]}function d(A,f){var u=P(A,f);if(!u)return A+"";var h=u[0],o=u[1];return o<0?"0."+new Array(-o).join("0")+h:h.length>o+1?h.slice(0,o+1)+"."+h.slice(o+1):h+new Array(o-h.length+2).join("0")}var s={"%":function(A,f){return(A*100).toFixed(f)},b:function(A){return Math.round(A).toString(2)},c:function(A){return A+""},d:k,e:function(A,f){return A.toExponential(f)},f:function(A,f){return A.toFixed(f)},g:function(A,f){return A.toPrecision(f)},o:function(A){return Math.round(A).toString(8)},p:function(A,f){return d(A*100,f)},r:d,s:r,X:function(A){return Math.round(A).toString(16).toUpperCase()},x:function(A){return Math.round(A).toString(16)}};function m(A){return A}var x=Array.prototype.map,M=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function v(A){var f=A.grouping===void 0||A.thousands===void 0?m:e(x.call(A.grouping,Number),A.thousands+""),u=A.currency===void 0?"":A.currency[0]+"",h=A.currency===void 0?"":A.currency[1]+"",o=A.decimal===void 0?".":A.decimal+"",S=A.numerals===void 0?m:p(x.call(A.numerals,String)),R=A.percent===void 0?"%":A.percent+"",z=A.minus===void 0?"-":A.minus+"",O=A.nan===void 0?"NaN":A.nan+"";function I(D){D=a(D);var B=D.fill,U=D.align,X=D.sign,oe=D.symbol,se=D.zero,q=D.width,K=D.comma,G=D.precision,Q=D.trim,V=D.type;V==="n"?(K=!0,V="g"):s[V]||(G===void 0&&(G=12),Q=!0,V="g"),(se||B==="0"&&U==="=")&&(se=!0,B="0",U="=");var H=oe==="$"?u:oe==="#"&&/[boxX]/.test(V)?"0"+V.toLowerCase():"",ee=oe==="$"?h:/[%p]/.test(V)?R:"",J=s[V],W=/[defgprs%]/.test(V);G=G===void 0?6:/[gprs]/.test(V)?Math.max(1,Math.min(21,G)):Math.max(0,Math.min(20,G));function re(j){var Z=H,ne=ee,le,ge,pe;if(V==="c")ne=J(j)+ne,j="";else{j=+j;var xe=j<0||1/j<0;if(j=isNaN(j)?O:J(Math.abs(j),G),Q&&(j=i(j)),xe&&+j==0&&X!=="+"&&(xe=!1),Z=(xe?X==="("?X:z:X==="-"||X==="("?"":X)+Z,ne=(V==="s"?M[8+n/3]:"")+ne+(xe&&X==="("?")":""),W){for(le=-1,ge=j.length;++le<ge;)if(pe=j.charCodeAt(le),48>pe||pe>57){ne=(pe===46?o+j.slice(le+1):j.slice(le))+ne,j=j.slice(0,le);break}}}K&&!se&&(j=f(j,1/0));var Ee=Z.length+j.length+ne.length,Te=Ee<q?new Array(q-Ee+1).join(B):"";switch(K&&se&&(j=f(Te+j,Te.length?q-ne.length:1/0),Te=""),U){case"<":j=Z+j+ne+Te;break;case"=":j=Z+Te+j+ne;break;case"^":j=Te.slice(0,Ee=Te.length>>1)+Z+j+ne+Te.slice(Ee);break;default:j=Te+Z+j+ne;break}return S(j)}return re.toString=function(){return D+""},re}function F(D,B){var U=I((D=a(D),D.type="f",D)),X=Math.max(-8,Math.min(8,Math.floor(E(B)/3)))*3,oe=Math.pow(10,-X),se=M[8+X/3];return function(q){return U(oe*q)+se}}return{format:I,formatPrefix:F}}var _;l({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function l(A){return _=v(A),b.format=_.format,b.formatPrefix=_.formatPrefix,_}function y(A){return Math.max(0,-E(Math.abs(A)))}function T(A,f){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(E(f)/3)))*3-E(Math.abs(A)))}function w(A,f){return A=Math.abs(A),f=Math.abs(f)-A,Math.max(0,E(f)-E(A))+1}b.FormatSpecifier=t,b.formatDefaultLocale=l,b.formatLocale=v,b.formatSpecifier=a,b.precisionFixed=y,b.precisionPrefix=T,b.precisionRound=w,Object.defineProperty(b,"__esModule",{value:!0})})},{}],113:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie,c("d3-geo"),c("d3-array")):typeof Vr=="function"&&Vr.amd?Vr(["exports","d3-geo","d3-array"],k):k(b.d3=b.d3||{},b.d3,b.d3)})(this,function(b,k,P){"use strict";var E=Math.abs,e=Math.atan,p=Math.atan2,g=Math.cos,a=Math.exp,t=Math.floor,i=Math.log,n=Math.max,r=Math.min,d=Math.pow,s=Math.round,m=Math.sign||function(ze){return ze>0?1:ze<0?-1:0},x=Math.sin,M=Math.tan,v=1e-6,_=1e-12,l=Math.PI,y=l/2,T=l/4,w=Math.SQRT1_2,A=O(2),f=O(l),u=l*2,h=180/l,o=l/180;function S(ze){return ze?ze/Math.sin(ze):1}function R(ze){return ze>1?y:ze<-1?-y:Math.asin(ze)}function z(ze){return ze>1?0:ze<-1?l:Math.acos(ze)}function O(ze){return ze>0?Math.sqrt(ze):0}function I(ze){return ze=a(2*ze),(ze-1)/(ze+1)}function F(ze){return(a(ze)-a(-ze))/2}function D(ze){return(a(ze)+a(-ze))/2}function B(ze){return i(ze+O(ze*ze+1))}function U(ze){return i(ze+O(ze*ze-1))}function X(ze){var Ye=M(ze/2),qe=2*i(g(ze/2))/(Ye*Ye);function st(mt,yt){var Tt=g(mt),ar=g(yt),lr=x(yt),rr=ar*Tt,hr=-((1-rr?i((1+rr)/2)/(1-rr):-.5)+qe/(1+rr));return[hr*ar*x(mt),hr*lr]}return st.invert=function(mt,yt){var Tt=O(mt*mt+yt*yt),ar=-ze/2,lr=50,rr;if(!Tt)return[0,0];do{var hr=ar/2,kr=g(hr),Yr=x(hr),$r=Yr/kr,xn=-i(E(kr));ar-=rr=(2/$r*xn-qe*$r-Tt)/(-xn/(Yr*Yr)+1-qe/(2*kr*kr))*(kr<0?.7:1)}while(E(rr)>v&&--lr>0);var Rn=x(ar);return[p(mt*Rn,Tt*g(ar)),R(yt*Rn/Tt)]},st}function oe(){var ze=y,Ye=k.geoProjectionMutator(X),qe=Ye(ze);return qe.radius=function(st){return arguments.length?Ye(ze=st*o):ze*h},qe.scale(179.976).clipAngle(147)}function se(ze,Ye){var qe=g(Ye),st=S(z(qe*g(ze/=2)));return[2*qe*x(ze)*st,x(Ye)*st]}se.invert=function(ze,Ye){if(!(ze*ze+4*Ye*Ye>l*l+v)){var qe=ze,st=Ye,mt=25;do{var yt=x(qe),Tt=x(qe/2),ar=g(qe/2),lr=x(st),rr=g(st),hr=x(2*st),kr=lr*lr,Yr=rr*rr,$r=Tt*Tt,xn=1-Yr*ar*ar,Rn=xn?z(rr*ar)*O(Wn=1/xn):Wn=0,Wn,ba=2*Rn*rr*Tt-ze,Wa=Rn*lr-Ye,Ja=Wn*(Yr*$r+Rn*rr*ar*kr),Qa=Wn*(.5*yt*hr-Rn*2*lr*Tt),ri=Wn*.25*(hr*Tt-Rn*lr*Yr*yt),yi=Wn*(kr*ar+Rn*$r*rr),Xi=Qa*ri-yi*Ja;if(!Xi)break;var Ga=(Wa*Qa-ba*yi)/Xi,qi=(ba*ri-Wa*Ja)/Xi;qe-=Ga,st-=qi}while((E(Ga)>v||E(qi)>v)&&--mt>0);return[qe,st]}};function q(){return k.geoProjection(se).scale(152.63)}function K(ze){var Ye=x(ze),qe=g(ze),st=ze>=0?1:-1,mt=M(st*ze),yt=(1+Ye-qe)/2;function Tt(ar,lr){var rr=g(lr),hr=g(ar/=2);return[(1+rr)*x(ar),(st*lr>-p(hr,mt)-.001?0:-st*10)+yt+x(lr)*qe-(1+rr)*Ye*hr]}return Tt.invert=function(ar,lr){var rr=0,hr=0,kr=50;do{var Yr=g(rr),$r=x(rr),xn=g(hr),Rn=x(hr),Wn=1+xn,ba=Wn*$r-ar,Wa=yt+Rn*qe-Wn*Ye*Yr-lr,Ja=Wn*Yr/2,Qa=-$r*Rn,ri=Ye*Wn*$r/2,yi=qe*xn+Ye*Yr*Rn,Xi=Qa*ri-yi*Ja,Ga=(Wa*Qa-ba*yi)/Xi/2,qi=(ba*ri-Wa*Ja)/Xi;E(qi)>2&&(qi/=2),rr-=Ga,hr-=qi}while((E(Ga)>v||E(qi)>v)&&--kr>0);return st*hr>-p(g(rr),mt)-.001?[rr*2,hr]:null},Tt}function G(){var ze=20*o,Ye=ze>=0?1:-1,qe=M(Ye*ze),st=k.geoProjectionMutator(K),mt=st(ze),yt=mt.stream;return mt.parallel=function(Tt){return arguments.length?(qe=M((Ye=(ze=Tt*o)>=0?1:-1)*ze),st(ze)):ze*h},mt.stream=function(Tt){var ar=mt.rotate(),lr=yt(Tt),rr=(mt.rotate([0,0]),yt(Tt)),hr=mt.precision();return mt.rotate(ar),lr.sphere=function(){rr.polygonStart(),rr.lineStart();for(var kr=Ye*-180;Ye*kr<180;kr+=Ye*90)rr.point(kr,Ye*90);if(ze)for(;Ye*(kr-=3*Ye*hr)>=-180;)rr.point(kr,Ye*-p(g(kr*o/2),qe)*h);rr.lineEnd(),rr.polygonEnd()},lr},mt.scale(218.695).center([0,28.0974])}function Q(ze,Ye){var qe=M(Ye/2),st=O(1-qe*qe),mt=1+st*g(ze/=2),yt=x(ze)*st/mt,Tt=qe/mt,ar=yt*yt,lr=Tt*Tt;return[4/3*yt*(3+ar-3*lr),4/3*Tt*(3+3*ar-lr)]}Q.invert=function(ze,Ye){if(ze*=3/8,Ye*=3/8,!ze&&E(Ye)>1)return null;var qe=ze*ze,st=Ye*Ye,mt=1+qe+st,yt=O((mt-O(mt*mt-4*Ye*Ye))/2),Tt=R(yt)/3,ar=yt?U(E(Ye/yt))/3:B(E(ze))/3,lr=g(Tt),rr=D(ar),hr=rr*rr-lr*lr;return[m(ze)*2*p(F(ar)*lr,.25-hr),m(Ye)*2*p(rr*x(Tt),.25+hr)]};function V(){return k.geoProjection(Q).scale(66.1603)}var H=O(8),ee=i(1+A);function J(ze,Ye){var qe=E(Ye);return qe<T?[ze,i(M(T+Ye/2))]:[ze*g(qe)*(2*A-1/x(qe)),m(Ye)*(2*A*(qe-T)-i(M(qe/2)))]}J.invert=function(ze,Ye){if((yt=E(Ye))<ee)return[ze,2*e(a(Ye))-y];var qe=T,st=25,mt,yt;do{var Tt=g(qe/2),ar=M(qe/2);qe-=mt=(H*(qe-T)-i(ar)-yt)/(H-Tt*Tt/(2*ar))}while(E(mt)>_&&--st>0);return[ze/(g(qe)*(H-1/x(qe))),m(Ye)*qe]};function W(){return k.geoProjection(J).scale(112.314)}function re(ze){var Ye=2*l/ze;function qe(st,mt){var yt=k.geoAzimuthalEquidistantRaw(st,mt);if(E(st)>y){var Tt=p(yt[1],yt[0]),ar=O(yt[0]*yt[0]+yt[1]*yt[1]),lr=Ye*s((Tt-y)/Ye)+y,rr=p(x(Tt-=lr),2-g(Tt));Tt=lr+R(l/ar*x(rr))-rr,yt[0]=ar*g(Tt),yt[1]=ar*x(Tt)}return yt}return qe.invert=function(st,mt){var yt=O(st*st+mt*mt);if(yt>y){var Tt=p(mt,st),ar=Ye*s((Tt-y)/Ye)+y,lr=Tt>ar?-1:1,rr=yt*g(ar-Tt),hr=1/M(lr*z((rr-l)/O(l*(l-2*rr)+yt*yt)));Tt=ar+2*e((hr+lr*O(hr*hr-3))/3),st=yt*g(Tt),mt=yt*x(Tt)}return k.geoAzimuthalEquidistantRaw.invert(st,mt)},qe}function j(){var ze=5,Ye=k.geoProjectionMutator(re),qe=Ye(ze),st=qe.stream,mt=.01,yt=-g(mt*o),Tt=x(mt*o);return qe.lobes=function(ar){return arguments.length?Ye(ze=+ar):ze},qe.stream=function(ar){var lr=qe.rotate(),rr=st(ar),hr=(qe.rotate([0,0]),st(ar));return qe.rotate(lr),rr.sphere=function(){hr.polygonStart(),hr.lineStart();for(var kr=0,Yr=360/ze,$r=2*l/ze,xn=90-180/ze,Rn=y;kr<ze;++kr,xn-=Yr,Rn-=$r)hr.point(p(Tt*g(Rn),yt)*h,R(Tt*x(Rn))*h),xn<-90?(hr.point(-90,-180-xn-mt),hr.point(-90,-180-xn+mt)):(hr.point(90,xn+mt),hr.point(90,xn-mt));hr.lineEnd(),hr.polygonEnd()},rr},qe.scale(87.8076).center([0,17.1875]).clipAngle(180-.001)}function Z(ze,Ye){if(arguments.length<2&&(Ye=ze),Ye===1)return k.geoAzimuthalEqualAreaRaw;if(Ye===1/0)return ne;function qe(st,mt){var yt=k.geoAzimuthalEqualAreaRaw(st/Ye,mt);return yt[0]*=ze,yt}return qe.invert=function(st,mt){var yt=k.geoAzimuthalEqualAreaRaw.invert(st/ze,mt);return yt[0]*=Ye,yt},qe}function ne(ze,Ye){return[ze*g(Ye)/g(Ye/=2),2*x(Ye)]}ne.invert=function(ze,Ye){var qe=2*R(Ye/2);return[ze*g(qe/2)/g(qe),qe]};function le(){var ze=2,Ye=k.geoProjectionMutator(Z),qe=Ye(ze);return qe.coefficient=function(st){return arguments.length?Ye(ze=+st):ze},qe.scale(169.529)}function ge(ze,Ye,qe){var st=100,mt,yt,Tt;qe=qe===void 0?0:+qe,Ye=+Ye;do yt=ze(qe),Tt=ze(qe+v),yt===Tt&&(Tt=yt+v),qe-=mt=-1*v*(yt-Ye)/(yt-Tt);while(st-- >0&&E(mt)>v);return st<0?NaN:qe}function pe(ze,Ye,qe){return Ye===void 0&&(Ye=40),qe===void 0&&(qe=_),function(st,mt,yt,Tt){var ar,lr,rr;yt=yt===void 0?0:+yt,Tt=Tt===void 0?0:+Tt;for(var hr=0;hr<Ye;hr++){var kr=ze(yt,Tt),Yr=kr[0]-st,$r=kr[1]-mt;if(E(Yr)<qe&&E($r)<qe)break;var xn=Yr*Yr+$r*$r;if(xn>ar){yt-=lr/=2,Tt-=rr/=2;continue}ar=xn;var Rn=(yt>0?-1:1)*qe,Wn=(Tt>0?-1:1)*qe,ba=ze(yt+Rn,Tt),Wa=ze(yt,Tt+Wn),Ja=(ba[0]-kr[0])/Rn,Qa=(ba[1]-kr[1])/Rn,ri=(Wa[0]-kr[0])/Wn,yi=(Wa[1]-kr[1])/Wn,Xi=yi*Ja-Qa*ri,Ga=(E(Xi)<.5?.5:1)/Xi;if(lr=($r*ri-Yr*yi)*Ga,rr=(Yr*Qa-$r*Ja)*Ga,yt+=lr,Tt+=rr,E(lr)<qe&&E(rr)<qe)break}return[yt,Tt]}}function xe(){var ze=Z(1.68,2),Ye=1.4,qe=12;function st(mt,yt){if(mt+yt<-Ye){var Tt=(mt-yt+1.6)*(mt+yt+Ye)/8;mt+=Tt,yt-=.8*Tt*x(yt+l/2)}var ar=ze(mt,yt),lr=(1-g(mt*yt))/qe;return ar[1]<0&&(ar[0]*=1+lr),ar[1]>0&&(ar[1]*=1+lr/1.5*ar[0]*ar[0]),ar}return st.invert=pe(st),st}function Ee(){return k.geoProjection(xe()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])}function Te(ze,Ye){var qe=ze*x(Ye),st=30,mt;do Ye-=mt=(Ye+x(Ye)-qe)/(1+g(Ye));while(E(mt)>v&&--st>0);return Ye/2}function de(ze,Ye,qe){function st(mt,yt){return[ze*mt*g(yt=Te(qe,yt)),Ye*x(yt)]}return st.invert=function(mt,yt){return yt=R(yt/Ye),[mt/(ze*g(yt)),R((2*yt+x(2*yt))/qe)]},st}var be=de(A/y,A,l);function Le(){return k.geoProjection(be).scale(169.529)}var De=2.00276,ye=1.11072;function ke(ze,Ye){var qe=Te(l,Ye);return[De*ze/(1/g(Ye)+ye/g(qe)),(Ye+A*x(qe))/De]}ke.invert=function(ze,Ye){var qe=De*Ye,st=Ye<0?-T:T,mt=25,yt,Tt;do Tt=qe-A*x(st),st-=yt=(x(2*st)+2*st-l*x(Tt))/(2*g(2*st)+2+l*g(Tt)*A*g(st));while(E(yt)>v&&--mt>0);return Tt=qe-A*x(st),[ze*(1/g(Tt)+ye/g(st))/De,Tt]};function Oe(){return k.geoProjection(ke).scale(160.857)}function Qe(ze){var Ye=0,qe=k.geoProjectionMutator(ze),st=qe(Ye);return st.parallel=function(mt){return arguments.length?qe(Ye=mt*o):Ye*h},st}function Ve(ze,Ye){return[ze*g(Ye),Ye]}Ve.invert=function(ze,Ye){return[ze/g(Ye),Ye]};function Ue(){return k.geoProjection(Ve).scale(152.63)}function Ie(ze){if(!ze)return Ve;var Ye=1/M(ze);function qe(st,mt){var yt=Ye+ze-mt,Tt=yt&&st*g(mt)/yt;return[yt*x(Tt),Ye-yt*g(Tt)]}return qe.invert=function(st,mt){var yt=O(st*st+(mt=Ye-mt)*mt),Tt=Ye+ze-yt;return[yt/g(Tt)*p(st,mt),Tt]},qe}function at(){return Qe(Ie).scale(123.082).center([0,26.1441]).parallel(45)}function pt(ze){function Ye(qe,st){var mt=y-st,yt=mt&&qe*ze*x(mt)/mt;return[mt*x(yt)/ze,y-mt*g(yt)]}return Ye.invert=function(qe,st){var mt=qe*ze,yt=y-st,Tt=O(mt*mt+yt*yt),ar=p(mt,yt);return[(Tt?Tt/x(Tt):1)*ar/ze,y-Tt]},Ye}function Rt(){var ze=.5,Ye=k.geoProjectionMutator(pt),qe=Ye(ze);return qe.fraction=function(st){return arguments.length?Ye(ze=+st):ze},qe.scale(158.837)}var Mt=de(1,4/l,l);function It(){return k.geoProjection(Mt).scale(152.63)}function Bt(ze,Ye,qe,st,mt,yt){var Tt=g(yt),ar;if(E(ze)>1||E(yt)>1)ar=z(qe*mt+Ye*st*Tt);else{var lr=x(ze/2),rr=x(yt/2);ar=2*R(O(lr*lr+Ye*st*rr*rr))}return E(ar)>v?[ar,p(st*x(yt),Ye*mt-qe*st*Tt)]:[0,0]}function St(ze,Ye,qe){return z((ze*ze+Ye*Ye-qe*qe)/(2*ze*Ye))}function _t(ze){return ze-2*l*t((ze+l)/(2*l))}function it(ze,Ye,qe){for(var st=[[ze[0],ze[1],x(ze[1]),g(ze[1])],[Ye[0],Ye[1],x(Ye[1]),g(Ye[1])],[qe[0],qe[1],x(qe[1]),g(qe[1])]],mt=st[2],yt,Tt=0;Tt<3;++Tt,mt=yt)yt=st[Tt],mt.v=Bt(yt[1]-mt[1],mt[3],mt[2],yt[3],yt[2],yt[0]-mt[0]),mt.point=[0,0];var ar=St(st[0].v[0],st[2].v[0],st[1].v[0]),lr=St(st[0].v[0],st[1].v[0],st[2].v[0]),rr=l-ar;st[2].point[1]=0,st[0].point[0]=-(st[1].point[0]=st[0].v[0]/2);var hr=[st[2].point[0]=st[0].point[0]+st[2].v[0]*g(ar),2*(st[0].point[1]=st[1].point[1]=st[2].v[0]*x(ar))];function kr(Yr,$r){var xn=x($r),Rn=g($r),Wn=new Array(3),ba;for(ba=0;ba<3;++ba){var Wa=st[ba];if(Wn[ba]=Bt($r-Wa[1],Wa[3],Wa[2],Rn,xn,Yr-Wa[0]),!Wn[ba][0])return Wa.point;Wn[ba][1]=_t(Wn[ba][1]-Wa.v[1])}var Ja=hr.slice();for(ba=0;ba<3;++ba){var Qa=ba==2?0:ba+1,ri=St(st[ba].v[0],Wn[ba][0],Wn[Qa][0]);Wn[ba][1]<0&&(ri=-ri),ba?ba==1?(ri=lr-ri,Ja[0]-=Wn[ba][0]*g(ri),Ja[1]-=Wn[ba][0]*x(ri)):(ri=rr-ri,Ja[0]+=Wn[ba][0]*g(ri),Ja[1]+=Wn[ba][0]*x(ri)):(Ja[0]+=Wn[ba][0]*g(ri),Ja[1]-=Wn[ba][0]*x(ri))}return Ja[0]/=3,Ja[1]/=3,Ja}return kr}function ct(ze){return ze[0]*=o,ze[1]*=o,ze}function et(){return Pe([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])}function Pe(ze,Ye,qe){var st=k.geoCentroid({type:"MultiPoint",coordinates:[ze,Ye,qe]}),mt=[-st[0],-st[1]],yt=k.geoRotation(mt),Tt=it(ct(yt(ze)),ct(yt(Ye)),ct(yt(qe)));Tt.invert=pe(Tt);var ar=k.geoProjection(Tt).rotate(mt),lr=ar.center;return delete ar.rotate,ar.center=function(rr){return arguments.length?lr(yt(rr)):yt.invert(lr())},ar.clipAngle(90)}function We(ze,Ye){var qe=O(1-x(Ye));return[2/f*ze*qe,f*(1-qe)]}We.invert=function(ze,Ye){var qe=(qe=Ye/f-1)*qe;return[qe>0?ze*O(l/qe)/2:0,R(1-qe)]};function je(){return k.geoProjection(We).scale(95.6464).center([0,30])}function nt(ze){var Ye=M(ze);function qe(st,mt){return[st,(st?st/x(st):1)*(x(mt)*g(st)-Ye*g(mt))]}return qe.invert=Ye?function(st,mt){st&&(mt*=x(st)/st);var yt=g(st);return[st,2*p(O(yt*yt+Ye*Ye-mt*mt)-yt,Ye-mt)]}:function(st,mt){return[st,R(st?mt*M(st)/st:mt)]},qe}function kt(){return Qe(nt).scale(249.828).clipAngle(90)}var wt=O(3);function Vt(ze,Ye){return[wt*ze*(2*g(2*Ye/3)-1)/f,wt*f*x(Ye/3)]}Vt.invert=function(ze,Ye){var qe=3*R(Ye/(wt*f));return[f*ze/(wt*(2*g(2*qe/3)-1)),qe]};function qt(){return k.geoProjection(Vt).scale(156.19)}function zt(ze){var Ye=g(ze);function qe(st,mt){return[st*Ye,x(mt)/Ye]}return qe.invert=function(st,mt){return[st/Ye,R(mt*Ye)]},qe}function Ht(){return Qe(zt).parallel(38.58).scale(195.044)}function $t(ze){var Ye=g(ze);function qe(st,mt){return[st*Ye,(1+Ye)*M(mt/2)]}return qe.invert=function(st,mt){return[st/Ye,e(mt/(1+Ye))*2]},qe}function Qt(){return Qe($t).scale(124.75)}function fr(ze,Ye){var qe=O(8/(3*l));return[qe*ze*(1-E(Ye)/l),qe*Ye]}fr.invert=function(ze,Ye){var qe=O(8/(3*l)),st=Ye/qe;return[ze/(qe*(1-E(st)/l)),st]};function jr(){return k.geoProjection(fr).scale(165.664)}function cn(ze,Ye){var qe=O(4-3*x(E(Ye)));return[2/O(6*l)*ze*qe,m(Ye)*O(2*l/3)*(2-qe)]}cn.invert=function(ze,Ye){var qe=2-E(Ye)/O(2*l/3);return[ze*O(6*l)/(2*qe),m(Ye)*R((4-qe*qe)/3)]};function Qr(){return k.geoProjection(cn).scale(165.664)}function lt(ze,Ye){var qe=O(l*(4+l));return[2/qe*ze*(1+O(1-4*Ye*Ye/(l*l))),4/qe*Ye]}lt.invert=function(ze,Ye){var qe=O(l*(4+l))/2;return[ze*qe/(1+O(1-Ye*Ye*(4+l)/(4*l))),Ye*qe/2]};function Gt(){return k.geoProjection(lt).scale(180.739)}function Kt(ze,Ye){var qe=(2+y)*x(Ye);Ye/=2;for(var st=0,mt=1/0;st<10&&E(mt)>v;st++){var yt=g(Ye);Ye-=mt=(Ye+x(Ye)*(yt+2)-qe)/(2*yt*(1+yt))}return[2/O(l*(4+l))*ze*(1+g(Ye)),2*O(l/(4+l))*x(Ye)]}Kt.invert=function(ze,Ye){var qe=Ye*O((4+l)/l)/2,st=R(qe),mt=g(st);return[ze/(2/O(l*(4+l))*(1+mt)),R((st+qe*(mt+2))/(2+y))]};function Nt(){return k.geoProjection(Kt).scale(180.739)}function gr(ze,Ye){return[ze*(1+g(Ye))/O(2+l),2*Ye/O(2+l)]}gr.invert=function(ze,Ye){var qe=O(2+l),st=Ye*qe/2;return[qe*ze/(1+g(st)),st]};function tt(){return k.geoProjection(gr).scale(173.044)}function we(ze,Ye){for(var qe=(1+y)*x(Ye),st=0,mt=1/0;st<10&&E(mt)>v;st++)Ye-=mt=(Ye+x(Ye)-qe)/(1+g(Ye));return qe=O(2+l),[ze*(1+g(Ye))/qe,2*Ye/qe]}we.invert=function(ze,Ye){var qe=1+y,st=O(qe/2);return[ze*2*st/(1+g(Ye*=st)),R((Ye+x(Ye))/qe)]};function Me(){return k.geoProjection(we).scale(173.044)}var Ne=3+2*A;function Xe(ze,Ye){var qe=x(ze/=2),st=g(ze),mt=O(g(Ye)),yt=g(Ye/=2),Tt=x(Ye)/(yt+A*st*mt),ar=O(2/(1+Tt*Tt)),lr=O((A*yt+(st+qe)*mt)/(A*yt+(st-qe)*mt));return[Ne*(ar*(lr-1/lr)-2*i(lr)),Ne*(ar*Tt*(lr+1/lr)-2*e(Tt))]}Xe.invert=function(ze,Ye){if(!(yt=Q.invert(ze/1.2,Ye*1.065)))return null;var qe=yt[0],st=yt[1],mt=20,yt;ze/=Ne,Ye/=Ne;do{var Tt=qe/2,ar=st/2,lr=x(Tt),rr=g(Tt),hr=x(ar),kr=g(ar),Yr=g(st),$r=O(Yr),xn=hr/(kr+A*rr*$r),Rn=xn*xn,Wn=O(2/(1+Rn)),ba=A*kr+(rr+lr)*$r,Wa=A*kr+(rr-lr)*$r,Ja=ba/Wa,Qa=O(Ja),ri=Qa-1/Qa,yi=Qa+1/Qa,Xi=Wn*ri-2*i(Qa)-ze,Ga=Wn*xn*yi-2*e(xn)-Ye,qi=hr&&w*$r*lr*Rn/hr,Zi=(A*rr*kr+$r)/(2*(kr+A*rr*$r)*(kr+A*rr*$r)*$r),po=-.5*xn*Wn*Wn*Wn,_i=po*qi,Ri=po*Zi,jo=(jo=2*kr+A*$r*(rr-lr))*jo*Qa,go=(A*rr*kr*$r+Yr)/jo,Po=-(A*lr*hr)/($r*jo),Ko=ri*_i-2*go/Qa+Wn*(go+go/Ja),Io=ri*Ri-2*Po/Qa+Wn*(Po+Po/Ja),Qs=xn*yi*_i-2*qi/(1+Rn)+Wn*yi*qi+Wn*xn*(go-go/Ja),ml=xn*yi*Ri-2*Zi/(1+Rn)+Wn*yi*Zi+Wn*xn*(Po-Po/Ja),zo=Io*Qs-ml*Ko;if(!zo)break;var Ea=(Ga*Io-Xi*ml)/zo,$s=(Xi*Qs-Ga*Ko)/zo;qe-=Ea,st=n(-y,r(y,st-$s))}while((E(Ea)>v||E($s)>v)&&--mt>0);return E(E(st)-y)<v?[0,st]:mt&&[qe,st]};function Ke(){return k.geoProjection(Xe).scale(62.5271)}var rt=g(35*o);function Je(ze,Ye){var qe=M(Ye/2);return[ze*rt*O(1-qe*qe),(1+rt)*qe]}Je.invert=function(ze,Ye){var qe=Ye/(1+rt);return[ze&&ze/(rt*O(1-qe*qe)),2*e(qe)]};function vt(){return k.geoProjection(Je).scale(137.152)}function bt(ze,Ye){var qe=Ye/2,st=g(qe);return[2*ze/f*g(Ye)*st*st,f*M(qe)]}bt.invert=function(ze,Ye){var qe=e(Ye/f),st=g(qe),mt=2*qe;return[ze*f/2/(g(mt)*st*st),mt]};function Et(){return k.geoProjection(bt).scale(135.264)}function Wt(ze){var Ye=1-ze,qe=yt(l,0)[0]-yt(-l,0)[0],st=yt(0,y)[1]-yt(0,-y)[1],mt=O(2*st/qe);function yt(lr,rr){var hr=g(rr),kr=x(rr);return[hr/(Ye+ze*hr)*lr,Ye*rr+ze*kr]}function Tt(lr,rr){var hr=yt(lr,rr);return[hr[0]*mt,hr[1]/mt]}function ar(lr){return Tt(0,lr)[1]}return Tt.invert=function(lr,rr){var hr=ge(ar,rr),kr=lr/mt*(ze+Ye/g(hr));return[kr,hr]},Tt}function Ot(){var ze=.5,Ye=k.geoProjectionMutator(Wt),qe=Ye(ze);return qe.alpha=function(st){return arguments.length?Ye(ze=+st):ze},qe.scale(168.725)}function ir(ze){return[ze[0]/2,R(M(ze[1]/2*o))*h]}function vr(ze){return[ze[0]*2,2*e(x(ze[1]*o))*h]}function _r(ze){ze==null&&(ze=k.geoOrthographic);var Ye=ze(),qe=k.geoEquirectangular().scale(h).precision(0).clipAngle(null).translate([0,0]);function st(yt){return Ye(ir(yt))}Ye.invert&&(st.invert=function(yt){return vr(Ye.invert(yt))}),st.stream=function(yt){var Tt=Ye.stream(yt),ar=qe.stream({point:function(lr,rr){Tt.point(lr/2,R(M(-rr/2*o))*h)},lineStart:function(){Tt.lineStart()},lineEnd:function(){Tt.lineEnd()},polygonStart:function(){Tt.polygonStart()},polygonEnd:function(){Tt.polygonEnd()}});return ar.sphere=Tt.sphere,ar};function mt(yt){st[yt]=function(){return arguments.length?(Ye[yt].apply(Ye,arguments),st):Ye[yt]()}}return st.rotate=function(yt){return arguments.length?(qe.rotate(yt),st):qe.rotate()},st.center=function(yt){return arguments.length?(Ye.center(ir(yt)),st):vr(Ye.center())},mt("angle"),mt("clipAngle"),mt("clipExtent"),mt("fitExtent"),mt("fitHeight"),mt("fitSize"),mt("fitWidth"),mt("scale"),mt("translate"),mt("precision"),st.scale(249.5)}function ln(ze,Ye){var qe=2*l/Ye,st=ze*ze;function mt(yt,Tt){var ar=k.geoAzimuthalEquidistantRaw(yt,Tt),lr=ar[0],rr=ar[1],hr=lr*lr+rr*rr;if(hr>st){var kr=O(hr),Yr=p(rr,lr),$r=qe*s(Yr/qe),xn=Yr-$r,Rn=ze*g(xn),Wn=(ze*x(xn)-xn*x(Rn))/(y-Rn),ba=Cr(xn,Wn),Wa=(l-ze)/Gr(ba,Rn,l);lr=kr;var Ja=50,Qa;do lr-=Qa=(ze+Gr(ba,Rn,lr)*Wa-kr)/(ba(lr)*Wa);while(E(Qa)>v&&--Ja>0);rr=xn*x(lr),lr<y&&(rr-=Wn*(lr-y));var ri=x($r),yi=g($r);ar[0]=lr*yi-rr*ri,ar[1]=lr*ri+rr*yi}return ar}return mt.invert=function(yt,Tt){var ar=yt*yt+Tt*Tt;if(ar>st){var lr=O(ar),rr=p(Tt,yt),hr=qe*s(rr/qe),kr=rr-hr;yt=lr*g(kr),Tt=lr*x(kr);for(var Yr=yt-y,$r=x(yt),xn=Tt/$r,Rn=yt<y?1/0:0,Wn=10;;){var ba=ze*x(xn),Wa=ze*g(xn),Ja=x(Wa),Qa=y-Wa,ri=(ba-xn*Ja)/Qa,yi=Cr(xn,ri);if(E(Rn)<_||!--Wn)break;xn-=Rn=(xn*$r-ri*Yr-Tt)/($r-Yr*2*(Qa*(Wa+xn*ba*g(Wa)-Ja)-ba*(ba-xn*Ja))/(Qa*Qa))}lr=ze+Gr(yi,Wa,yt)*(l-ze)/Gr(yi,Wa,l),rr=hr+xn,yt=lr*g(rr),Tt=lr*x(rr)}return k.geoAzimuthalEquidistantRaw.invert(yt,Tt)},mt}function Cr(ze,Ye){return function(qe){var st=ze*g(qe);return qe<y&&(st-=Ye),O(1+st*st)}}function Gr(ze,Ye,qe){for(var st=50,mt=(qe-Ye)/st,yt=ze(Ye)+ze(qe),Tt=1,ar=Ye;Tt<st;++Tt)yt+=2*ze(ar+=mt);return yt*.5*mt}function sn(){var ze=6,Ye=30*o,qe=g(Ye),st=x(Ye),mt=k.geoProjectionMutator(ln),yt=mt(Ye,ze),Tt=yt.stream,ar=.01,lr=-g(ar*o),rr=x(ar*o);return yt.radius=function(hr){return arguments.length?(qe=g(Ye=hr*o),st=x(Ye),mt(Ye,ze)):Ye*h},yt.lobes=function(hr){return arguments.length?mt(Ye,ze=+hr):ze},yt.stream=function(hr){var kr=yt.rotate(),Yr=Tt(hr),$r=(yt.rotate([0,0]),Tt(hr));return yt.rotate(kr),Yr.sphere=function(){$r.polygonStart(),$r.lineStart();for(var xn=0,Rn=2*l/ze,Wn=0;xn<ze;++xn,Wn-=Rn)$r.point(p(rr*g(Wn),lr)*h,R(rr*x(Wn))*h),$r.point(p(st*g(Wn-Rn/2),qe)*h,R(st*x(Wn-Rn/2))*h);$r.lineEnd(),$r.polygonEnd()},Yr},yt.rotate([90,-40]).scale(91.7095).clipAngle(180-.001)}function yr(ze,Ye,qe,st,mt,yt,Tt,ar){arguments.length<8&&(ar=0);function lr(rr,hr){if(!hr)return[ze*rr/l,0];var kr=hr*hr,Yr=ze+kr*(Ye+kr*(qe+kr*st)),$r=hr*(mt-1+kr*(yt-ar+kr*Tt)),xn=(Yr*Yr+$r*$r)/(2*$r),Rn=rr*R(Yr/xn)/l;return[xn*x(Rn),hr*(1+kr*ar)+xn*(1-g(Rn))]}return lr.invert=function(rr,hr){var kr=l*rr/ze,Yr=hr,$r,xn,Rn=50;do{var Wn=Yr*Yr,ba=ze+Wn*(Ye+Wn*(qe+Wn*st)),Wa=Yr*(mt-1+Wn*(yt-ar+Wn*Tt)),Ja=ba*ba+Wa*Wa,Qa=2*Wa,ri=Ja/Qa,yi=ri*ri,Xi=R(ba/ri)/l,Ga=kr*Xi,qi=ba*ba,Zi=(2*Ye+Wn*(4*qe+Wn*6*st))*Yr,po=mt+Wn*(3*yt+Wn*5*Tt),_i=2*(ba*Zi+Wa*(po-1)),Ri=2*(po-1),jo=(_i*Qa-Ja*Ri)/(Qa*Qa),go=g(Ga),Po=x(Ga),Ko=ri*go,Io=ri*Po,Qs=kr/l*(1/O(1-qi/yi))*(Zi*ri-ba*jo)/yi,ml=Io-rr,zo=Yr*(1+Wn*ar)+ri-Ko-hr,Ea=jo*Po+Ko*Qs,$s=Ko*Xi,ue=1+jo-(jo*go-Io*Qs),_e=Io*Xi,Ce=Ea*_e-ue*$s;if(!Ce)break;kr-=$r=(zo*Ea-ml*ue)/Ce,Yr-=xn=(ml*_e-zo*$s)/Ce}while((E($r)>v||E(xn)>v)&&--Rn>0);return[kr,Yr]},lr}var mr=yr(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555);function Or(){return k.geoProjection(mr).scale(149.995)}var zr=yr(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742);function Sr(){return k.geoProjection(zr).scale(153.93)}var ot=yr(5/6*l,-.62636,-.0344,0,1.3493,-.05524,0,.045);function Lt(){return k.geoProjection(ot).scale(130.945)}function Xt(ze,Ye){var qe=ze*ze,st=Ye*Ye;return[ze*(1-.162388*st)*(.87-952426e-9*qe*qe),Ye*(1+st/12)]}Xt.invert=function(ze,Ye){var qe=ze,st=Ye,mt=50,yt;do{var Tt=st*st;st-=yt=(st*(1+Tt/12)-Ye)/(1+Tt/4)}while(E(yt)>v&&--mt>0);mt=50,ze/=1-.162388*Tt;do{var ar=(ar=qe*qe)*ar;qe-=yt=(qe*(.87-952426e-9*ar)-ze)/(.87-.00476213*ar)}while(E(yt)>v&&--mt>0);return[qe,st]};function tr(){return k.geoProjection(Xt).scale(131.747)}var Lr=yr(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Nr(){return k.geoProjection(Lr).scale(131.087)}function Rr(ze){var Ye=ze(y,0)[0]-ze(-y,0)[0];function qe(st,mt){var yt=st>0?-.5:.5,Tt=ze(st+yt*l,mt);return Tt[0]-=yt*Ye,Tt}return ze.invert&&(qe.invert=function(st,mt){var yt=st>0?-.5:.5,Tt=ze.invert(st+yt*Ye,mt),ar=Tt[0]-yt*l;return ar<-l?ar+=2*l:ar>l&&(ar-=2*l),Tt[0]=ar,Tt}),qe}function Ar(ze,Ye){var qe=m(ze),st=m(Ye),mt=g(Ye),yt=g(ze)*mt,Tt=x(ze)*mt,ar=x(st*Ye);ze=E(p(Tt,ar)),Ye=R(yt),E(ze-y)>v&&(ze%=y);var lr=Kr(ze>l/4?y-ze:ze,Ye);return ze>l/4&&(ar=lr[0],lr[0]=-lr[1],lr[1]=-ar),lr[0]*=qe,lr[1]*=-st,lr}Ar.invert=function(ze,Ye){E(ze)>1&&(ze=m(ze)*2-ze),E(Ye)>1&&(Ye=m(Ye)*2-Ye);var qe=m(ze),st=m(Ye),mt=-qe*ze,yt=-st*Ye,Tt=yt/mt<1,ar=Dn(Tt?yt:mt,Tt?mt:yt),lr=ar[0],rr=ar[1],hr=g(rr);return Tt&&(lr=-y-lr),[qe*(p(x(lr)*hr,-x(rr))+l),st*R(g(lr)*hr)]};function Kr(ze,Ye){if(Ye===y)return[0,0];var qe=x(Ye),st=qe*qe,mt=st*st,yt=1+mt,Tt=1+3*mt,ar=1-mt,lr=R(1/O(yt)),rr=ar+st*yt*lr,hr=(1-qe)/rr,kr=O(hr),Yr=hr*yt,$r=O(Yr),xn=kr*ar,Rn,Wn;if(ze===0)return[0,-(xn+st*$r)];var ba=g(Ye),Wa=1/ba,Ja=2*qe*ba,Qa=(-3*st+lr*Tt)*Ja,ri=(-rr*ba-(1-qe)*Qa)/(rr*rr),yi=.5*ri/kr,Xi=ar*yi-2*st*kr*Ja,Ga=st*yt*ri+hr*Tt*Ja,qi=-Wa*Ja,Zi=-Wa*Ga,po=-2*Wa*Xi,_i=4*ze/l,Ri;if(ze>.222*l||Ye<l/4&&ze>.175*l){if(Rn=(xn+st*O(Yr*(1+mt)-xn*xn))/(1+mt),ze>l/4)return[Rn,Rn];var jo=Rn,go=.5*Rn;Rn=.5*(go+jo),Wn=50;do{var Po=O(Yr-Rn*Rn),Ko=Rn*(po+qi*Po)+Zi*R(Rn/$r)-_i;if(!Ko)break;Ko<0?go=Rn:jo=Rn,Rn=.5*(go+jo)}while(E(jo-go)>v&&--Wn>0)}else{Rn=v,Wn=25;do{var Io=Rn*Rn,Qs=O(Yr-Io),ml=po+qi*Qs,zo=Rn*ml+Zi*R(Rn/$r)-_i,Ea=ml+(Zi-qi*Io)/Qs;Rn-=Ri=Qs?zo/Ea:0}while(E(Ri)>v&&--Wn>0)}return[Rn,-xn-st*O(Yr-Rn*Rn)]}function Dn(ze,Ye){for(var qe=0,st=1,mt=.5,yt=50;;){var Tt=mt*mt,ar=O(mt),lr=R(1/O(1+Tt)),rr=1-Tt+mt*(1+Tt)*lr,hr=(1-ar)/rr,kr=O(hr),Yr=hr*(1+Tt),$r=kr*(1-Tt),xn=Yr-ze*ze,Rn=O(xn),Wn=Ye+$r+mt*Rn;if(E(st-qe)<_||--yt===0||Wn===0)break;Wn>0?qe=mt:st=mt,mt=.5*(qe+st)}if(!yt)return null;var ba=R(ar),Wa=g(ba),Ja=1/Wa,Qa=2*ar*Wa,ri=(-3*mt+lr*(1+3*Tt))*Qa,yi=(-rr*Wa-(1-ar)*ri)/(rr*rr),Xi=.5*yi/kr,Ga=(1-Tt)*Xi-2*mt*kr*Qa,qi=-2*Ja*Ga,Zi=-Ja*Qa,po=-Ja*(mt*(1+Tt)*yi+hr*(1+3*Tt)*Qa);return[l/4*(ze*(qi+Zi*Rn)+po*R(ze/O(Yr))),ba]}function Sn(){return k.geoProjection(Rr(Ar)).scale(239.75)}function Jn(ze,Ye,qe){var st,mt,yt;return ze?(st=Bn(ze,qe),Ye?(mt=Bn(Ye,1-qe),yt=mt[1]*mt[1]+qe*st[0]*st[0]*mt[0]*mt[0],[[st[0]*mt[2]/yt,st[1]*st[2]*mt[0]*mt[1]/yt],[st[1]*mt[1]/yt,-st[0]*st[2]*mt[0]*mt[2]/yt],[st[2]*mt[1]*mt[2]/yt,-qe*st[0]*st[1]*mt[0]/yt]]):[[st[0],0],[st[1],0],[st[2],0]]):(mt=Bn(Ye,1-qe),[[0,mt[0]/mt[1]],[1/mt[1],0],[mt[2]/mt[1],0]])}function Bn(ze,Ye){var qe,st,mt,yt,Tt;if(Ye<v)return yt=x(ze),st=g(ze),qe=Ye*(ze-yt*st)/4,[yt-qe*st,st+qe*yt,1-Ye*yt*yt/2,ze-qe];if(Ye>=1-v)return qe=(1-Ye)/4,st=D(ze),yt=I(ze),mt=1/st,Tt=st*F(ze),[yt+qe*(Tt-ze)/(st*st),mt-qe*yt*mt*(Tt-ze),mt+qe*yt*mt*(Tt+ze),2*e(a(ze))-y+qe*(Tt-ze)/st];var ar=[1,0,0,0,0,0,0,0,0],lr=[O(Ye),0,0,0,0,0,0,0,0],rr=0;for(st=O(1-Ye),Tt=1;E(lr[rr]/ar[rr])>v&&rr<8;)qe=ar[rr++],lr[rr]=(qe-st)/2,ar[rr]=(qe+st)/2,st=O(qe*st),Tt*=2;mt=Tt*ar[rr]*ze;do yt=lr[rr]*x(st=mt)/ar[rr],mt=(R(yt)+mt)/2;while(--rr);return[x(mt),yt=g(mt),yt/g(mt-st),mt]}function Xn(ze,Ye,qe){var st=E(ze),mt=E(Ye),yt=F(mt);if(st){var Tt=1/x(st),ar=1/(M(st)*M(st)),lr=-(ar+qe*(yt*yt*Tt*Tt)-1+qe),rr=(qe-1)*ar,hr=(-lr+O(lr*lr-4*rr))/2;return[ea(e(1/O(hr)),qe)*m(ze),ea(e(O((hr/ar-1)/qe)),1-qe)*m(Ye)]}return[0,ea(e(yt),1-qe)*m(Ye)]}function ea(ze,Ye){if(!Ye)return ze;if(Ye===1)return i(M(ze/2+T));for(var qe=1,st=O(1-Ye),mt=O(Ye),yt=0;E(mt)>v;yt++){if(ze%l){var Tt=e(st*M(ze)/qe);Tt<0&&(Tt+=l),ze+=Tt+~~(ze/l)*l}else ze+=ze;mt=(qe+st)/2,st=O(qe*st),mt=((qe=mt)-st)/2}return ze/(d(2,yt)*qe)}function ka(ze,Ye){var qe=(A-1)/(A+1),st=O(1-qe*qe),mt=ea(y,st*st),yt=-1,Tt=i(M(l/4+E(Ye)/2)),ar=a(yt*Tt)/O(qe),lr=Ya(ar*g(yt*ze),ar*x(yt*ze)),rr=Xn(lr[0],lr[1],st*st);return[-rr[1],(Ye>=0?1:-1)*(.5*mt-rr[0])]}function Ya(ze,Ye){var qe=ze*ze,st=Ye+1,mt=1-qe-Ye*Ye;return[.5*((ze>=0?y:-y)-p(mt,2*ze)),-.25*i(mt*mt+4*qe)+.5*i(st*st+qe)]}function fi(ze,Ye){var qe=Ye[0]*Ye[0]+Ye[1]*Ye[1];return[(ze[0]*Ye[0]+ze[1]*Ye[1])/qe,(ze[1]*Ye[0]-ze[0]*Ye[1])/qe]}ka.invert=function(ze,Ye){var qe=(A-1)/(A+1),st=O(1-qe*qe),mt=ea(y,st*st),yt=-1,Tt=Jn(.5*mt-Ye,-ze,st*st),ar=fi(Tt[0],Tt[1]),lr=p(ar[1],ar[0])/yt;return[lr,2*e(a(.5/yt*i(qe*ar[0]*ar[0]+qe*ar[1]*ar[1])))-y]};function pi(){return k.geoProjection(Rr(ka)).scale(151.496)}function hi(ze){var Ye=x(ze),qe=g(ze),st=Ka(ze);st.invert=Ka(-ze);function mt(yt,Tt){var ar=st(yt,Tt);yt=ar[0],Tt=ar[1];var lr=x(Tt),rr=g(Tt),hr=g(yt),kr=z(Ye*lr+qe*rr*hr),Yr=x(kr),$r=E(Yr)>v?kr/Yr:1;return[$r*qe*x(yt),(E(yt)>y?$r:-$r)*(Ye*rr-qe*lr*hr)]}return mt.invert=function(yt,Tt){var ar=O(yt*yt+Tt*Tt),lr=-x(ar),rr=g(ar),hr=ar*rr,kr=-Tt*lr,Yr=ar*Ye,$r=O(hr*hr+kr*kr-Yr*Yr),xn=p(hr*Yr+kr*$r,kr*Yr-hr*$r),Rn=(ar>y?-1:1)*p(yt*lr,ar*g(xn)*rr+Tt*x(xn)*lr);return st.invert(Rn,xn)},mt}function Ka(ze){var Ye=x(ze),qe=g(ze);return function(st,mt){var yt=g(mt),Tt=g(st)*yt,ar=x(st)*yt,lr=x(mt);return[p(ar,Tt*qe-lr*Ye),R(lr*qe+Tt*Ye)]}}function wr(){var ze=0,Ye=k.geoProjectionMutator(hi),qe=Ye(ze),st=qe.rotate,mt=qe.stream,yt=k.geoCircle();return qe.parallel=function(Tt){if(!arguments.length)return ze*h;var ar=qe.rotate();return Ye(ze=Tt*o).rotate(ar)},qe.rotate=function(Tt){return arguments.length?(st.call(qe,[Tt[0],Tt[1]-ze*h]),yt.center([-Tt[0],-Tt[1]]),qe):(Tt=st.call(qe),Tt[1]+=ze*h,Tt)},qe.stream=function(Tt){return Tt=mt(Tt),Tt.sphere=function(){Tt.polygonStart();var ar=.01,lr=yt.radius(90-ar)().coordinates[0],rr=lr.length-1,hr=-1,kr;for(Tt.lineStart();++hr<rr;)Tt.point((kr=lr[hr])[0],kr[1]);for(Tt.lineEnd(),lr=yt.radius(90+ar)().coordinates[0],rr=lr.length-1,Tt.lineStart();--hr>=0;)Tt.point((kr=lr[hr])[0],kr[1]);Tt.lineEnd(),Tt.polygonEnd()},Tt},qe.scale(79.4187).parallel(45).clipAngle(180-.001)}var gn=3,hn=R(1-1/gn)*h,Tn=zt(0);function Vn(ze){var Ye=hn*o,qe=We(l,Ye)[0]-We(-l,Ye)[0],st=Tn(0,Ye)[1],mt=We(0,Ye)[1],yt=f-mt,Tt=u/ze,ar=4/u,lr=st+yt*yt*4/u;function rr(hr,kr){var Yr,$r=E(kr);if($r>Ye){var xn=r(ze-1,n(0,t((hr+l)/Tt)));hr+=l*(ze-1)/ze-xn*Tt,Yr=We(hr,$r),Yr[0]=Yr[0]*u/qe-u*(ze-1)/(2*ze)+xn*u/ze,Yr[1]=st+(Yr[1]-mt)*4*yt/u,kr<0&&(Yr[1]=-Yr[1])}else Yr=Tn(hr,kr);return Yr[0]*=ar,Yr[1]/=lr,Yr}return rr.invert=function(hr,kr){hr/=ar,kr*=lr;var Yr=E(kr);if(Yr>st){var $r=r(ze-1,n(0,t((hr+l)/Tt)));hr=(hr+l*(ze-1)/ze-$r*Tt)*qe/u;var xn=We.invert(hr,.25*(Yr-st)*u/yt+mt);return xn[0]-=l*(ze-1)/ze-$r*Tt,kr<0&&(xn[1]=-xn[1]),xn}return Tn.invert(hr,kr)},rr}function oa(ze,Ye){return[ze,Ye&1?90-v:hn]}function na(ze,Ye){return[ze,Ye&1?-90+v:-hn]}function On(ze){return[ze[0]*(1-v),ze[1]]}function ta(ze){var Ye=[].concat(P.range(-180,180+ze/2,ze).map(oa),P.range(180,-180-ze/2,-ze).map(na));return{type:"Polygon",coordinates:[ze===180?Ye.map(On):Ye]}}function Ua(){var ze=4,Ye=k.geoProjectionMutator(Vn),qe=Ye(ze),st=qe.stream;return qe.lobes=function(mt){return arguments.length?Ye(ze=+mt):ze},qe.stream=function(mt){var yt=qe.rotate(),Tt=st(mt),ar=(qe.rotate([0,0]),st(mt));return qe.rotate(yt),Tt.sphere=function(){k.geoStream(ta(180/ze),ar)},Tt},qe.scale(239.75)}function di(ze){var Ye=1+ze,qe=x(1/Ye),st=R(qe),mt=2*O(l/(yt=l+4*st*Ye)),yt,Tt=.5*mt*(Ye+O(ze*(2+ze))),ar=ze*ze,lr=Ye*Ye;function rr(hr,kr){var Yr=1-x(kr),$r,xn;if(Yr&&Yr<2){var Rn=y-kr,Wn=25,ba;do{var Wa=x(Rn),Ja=g(Rn),Qa=st+p(Wa,Ye-Ja),ri=1+lr-2*Ye*Ja;Rn-=ba=(Rn-ar*st-Ye*Wa+ri*Qa-.5*Yr*yt)/(2*Ye*Wa*Qa)}while(E(ba)>_&&--Wn>0);$r=mt*O(ri),xn=hr*Qa/l}else $r=mt*(ze+Yr),xn=hr*st/l;return[$r*x(xn),Tt-$r*g(xn)]}return rr.invert=function(hr,kr){var Yr=hr*hr+(kr-=Tt)*kr,$r=(1+lr-Yr/(mt*mt))/(2*Ye),xn=z($r),Rn=x(xn),Wn=st+p(Rn,Ye-$r);return[R(hr/O(Yr))*l/Wn,R(1-2*(xn-ar*st-Ye*Rn+(1+lr-2*Ye*$r)*Wn)/yt)]},rr}function Ft(){var ze=1,Ye=k.geoProjectionMutator(di),qe=Ye(ze);return qe.ratio=function(st){return arguments.length?Ye(ze=+st):ze},qe.scale(167.774).center([0,18.67])}var cr=.7109889596207567,nn=.0528035274542;function vn(ze,Ye){return Ye>-cr?(ze=be(ze,Ye),ze[1]+=nn,ze):Ve(ze,Ye)}vn.invert=function(ze,Ye){return Ye>-cr?be.invert(ze,Ye-nn):Ve.invert(ze,Ye)};function on(){return k.geoProjection(vn).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}function Cn(ze,Ye){return E(Ye)>cr?(ze=be(ze,Ye),ze[1]-=Ye>0?nn:-nn,ze):Ve(ze,Ye)}Cn.invert=function(ze,Ye){return E(Ye)>cr?be.invert(ze,Ye+(Ye>0?nn:-nn)):Ve.invert(ze,Ye)};function _n(){return k.geoProjection(Cn).scale(152.63)}function un(ze,Ye,qe,st){var mt=O(4*l/(2*qe+(1+ze-Ye/2)*x(2*qe)+(ze+Ye)/2*x(4*qe)+Ye/2*x(6*qe))),yt=O(st*x(qe)*O((1+ze*g(2*qe)+Ye*g(4*qe))/(1+ze+Ye))),Tt=qe*lr(1);function ar(kr){return O(1+ze*g(2*kr)+Ye*g(4*kr))}function lr(kr){var Yr=kr*qe;return(2*Yr+(1+ze-Ye/2)*x(2*Yr)+(ze+Ye)/2*x(4*Yr)+Ye/2*x(6*Yr))/qe}function rr(kr){return ar(kr)*x(kr)}var hr=function(kr,Yr){var $r=qe*ge(lr,Tt*x(Yr)/qe,Yr/l);isNaN($r)&&($r=qe*m(Yr));var xn=mt*ar($r);return[xn*yt*kr/l*g($r),xn/yt*x($r)]};return hr.invert=function(kr,Yr){var $r=ge(rr,Yr*yt/mt);return[kr*l/(g($r)*mt*yt*ar($r)),R(qe*lr($r/qe)/Tt)]},qe===0&&(mt=O(st/l),hr=function(kr,Yr){return[kr*mt,x(Yr)/mt]},hr.invert=function(kr,Yr){return[kr/mt,R(Yr*mt)]}),hr}function dr(){var ze=1,Ye=0,qe=45*o,st=2,mt=k.geoProjectionMutator(un),yt=mt(ze,Ye,qe,st);return yt.a=function(Tt){return arguments.length?mt(ze=+Tt,Ye,qe,st):ze},yt.b=function(Tt){return arguments.length?mt(ze,Ye=+Tt,qe,st):Ye},yt.psiMax=function(Tt){return arguments.length?mt(ze,Ye,qe=+Tt*o,st):qe*h},yt.ratio=function(Tt){return arguments.length?mt(ze,Ye,qe,st=+Tt):st},yt.scale(180.739)}function pr(ze,Ye,qe,st,mt,yt,Tt,ar,lr,rr,hr){if(hr.nanEncountered)return NaN;var kr,Yr,$r,xn,Rn,Wn,ba,Wa,Ja,Qa;if(kr=qe-Ye,Yr=ze(Ye+kr*.25),$r=ze(qe-kr*.25),isNaN(Yr)){hr.nanEncountered=!0;return}if(isNaN($r)){hr.nanEncountered=!0;return}return xn=kr*(st+4*Yr+mt)/12,Rn=kr*(mt+4*$r+yt)/12,Wn=xn+Rn,Qa=(Wn-Tt)/15,rr>lr?(hr.maxDepthCount++,Wn+Qa):Math.abs(Qa)<ar?Wn+Qa:(ba=Ye+kr*.5,Wa=pr(ze,Ye,ba,st,Yr,mt,xn,ar*.5,lr,rr+1,hr),isNaN(Wa)?(hr.nanEncountered=!0,NaN):(Ja=pr(ze,ba,qe,mt,$r,yt,Rn,ar*.5,lr,rr+1,hr),isNaN(Ja)?(hr.nanEncountered=!0,NaN):Wa+Ja))}function Pr(ze,Ye,qe,st,mt){var yt={maxDepthCount:0,nanEncountered:!1};st===void 0&&(st=1e-8),mt===void 0&&(mt=20);var Tt=ze(Ye),ar=ze(.5*(Ye+qe)),lr=ze(qe),rr=(Tt+4*ar+lr)*(qe-Ye)/6,hr=pr(ze,Ye,qe,Tt,ar,lr,rr,st,mt,1,yt);return hr}function dn(ze,Ye,qe){function st($r){return ze+(1-ze)*d(1-d($r,Ye),1/Ye)}function mt($r){return Pr(st,0,$r,1e-4)}for(var yt=1/mt(1),Tt=1e3,ar=(1+1e-8)*yt,lr=[],rr=0;rr<=Tt;rr++)lr.push(mt(rr/Tt)*ar);function hr($r){var xn=0,Rn=Tt,Wn=Tt>>1;do lr[Wn]>$r?Rn=Wn:xn=Wn,Wn=xn+Rn>>1;while(Wn>xn);var ba=lr[Wn+1]-lr[Wn];return ba&&(ba=($r-lr[Wn+1])/ba),(Wn+1+ba)/Tt}var kr=2*hr(1)/l*yt/qe,Yr=function($r,xn){var Rn=hr(E(x(xn))),Wn=st(Rn)*$r;return Rn/=kr,[Wn,xn>=0?Rn:-Rn]};return Yr.invert=function($r,xn){var Rn;return xn*=kr,E(xn)<1&&(Rn=m(xn)*R(mt(E(xn))*yt)),[$r/st(E(xn)),Rn]},Yr}function Un(){var ze=0,Ye=2.5,qe=1.183136,st=k.geoProjectionMutator(dn),mt=st(ze,Ye,qe);return mt.alpha=function(yt){return arguments.length?st(ze=+yt,Ye,qe):ze},mt.k=function(yt){return arguments.length?st(ze,Ye=+yt,qe):Ye},mt.gamma=function(yt){return arguments.length?st(ze,Ye,qe=+yt):qe},mt.scale(152.63)}function ra(ze,Ye){return E(ze[0]-Ye[0])<v&&E(ze[1]-Ye[1])<v}function bn(ze,Ye){for(var qe=-1,st=ze.length,mt=ze[0],yt,Tt,ar,lr=[];++qe<st;){yt=ze[qe],Tt=(yt[0]-mt[0])/Ye,ar=(yt[1]-mt[1])/Ye;for(var rr=0;rr<Ye;++rr)lr.push([mt[0]+rr*Tt,mt[1]+rr*ar]);mt=yt}return lr.push(yt),lr}function Zn(ze){var Ye=[],qe,st,mt,yt,Tt,ar,lr,rr=ze[0].length;for(lr=0;lr<rr;++lr)qe=ze[0][lr],st=qe[0][0],mt=qe[0][1],yt=qe[1][1],Tt=qe[2][0],ar=qe[2][1],Ye.push(bn([[st+v,mt+v],[st+v,yt-v],[Tt-v,yt-v],[Tt-v,ar+v]],30));for(lr=ze[1].length-1;lr>=0;--lr)qe=ze[1][lr],st=qe[0][0],mt=qe[0][1],yt=qe[1][1],Tt=qe[2][0],ar=qe[2][1],Ye.push(bn([[Tt-v,ar-v],[Tt-v,yt+v],[st+v,yt+v],[st+v,mt-v]],30));return{type:"Polygon",coordinates:[P.merge(Ye)]}}function sa(ze,Ye,qe){var st,mt;function yt(lr,rr){for(var hr=rr<0?-1:1,kr=Ye[+(rr<0)],Yr=0,$r=kr.length-1;Yr<$r&&lr>kr[Yr][2][0];++Yr);var xn=ze(lr-kr[Yr][1][0],rr);return xn[0]+=ze(kr[Yr][1][0],hr*rr>hr*kr[Yr][0][1]?kr[Yr][0][1]:rr)[0],xn}qe?yt.invert=qe(yt):ze.invert&&(yt.invert=function(lr,rr){for(var hr=mt[+(rr<0)],kr=Ye[+(rr<0)],Yr=0,$r=hr.length;Yr<$r;++Yr){var xn=hr[Yr];if(xn[0][0]<=lr&&lr<xn[1][0]&&xn[0][1]<=rr&&rr<xn[1][1]){var Rn=ze.invert(lr-ze(kr[Yr][1][0],0)[0],rr);return Rn[0]+=kr[Yr][1][0],ra(yt(Rn[0],Rn[1]),[lr,rr])?Rn:null}}});var Tt=k.geoProjection(yt),ar=Tt.stream;return Tt.stream=function(lr){var rr=Tt.rotate(),hr=ar(lr),kr=(Tt.rotate([0,0]),ar(lr));return Tt.rotate(rr),hr.sphere=function(){k.geoStream(st,kr)},hr},Tt.lobes=function(lr){return arguments.length?(st=Zn(lr),Ye=lr.map(function(rr){return rr.map(function(hr){return[[hr[0][0]*o,hr[0][1]*o],[hr[1][0]*o,hr[1][1]*o],[hr[2][0]*o,hr[2][1]*o]]})}),mt=Ye.map(function(rr){return rr.map(function(hr){var kr=ze(hr[0][0],hr[0][1])[0],Yr=ze(hr[2][0],hr[2][1])[0],$r=ze(hr[1][0],hr[0][1])[1],xn=ze(hr[1][0],hr[1][1])[1],Rn;return $r>xn&&(Rn=$r,$r=xn,xn=Rn),[[kr,$r],[Yr,xn]]})}),Tt):Ye.map(function(rr){return rr.map(function(hr){return[[hr[0][0]*h,hr[0][1]*h],[hr[1][0]*h,hr[1][1]*h],[hr[2][0]*h,hr[2][1]*h]]})})},Ye!=null&&Tt.lobes(Ye),Tt}var ga=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function wa(){return sa(ke,ga).scale(160.857)}var ua=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function Aa(){return sa(Cn,ua).scale(152.63)}var _o=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]];function So(){return sa(be,_o).scale(169.529)}var Fo=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function cs(){return sa(be,Fo).scale(169.529).rotate([20,0])}var Jl=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]];function Tl(){return sa(vn,Jl,pe).rotate([-20,-55]).scale(164.263).center([0,-5.4036])}var mi=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function hs(){return sa(Ve,mi).scale(152.63).rotate([-20,0])}function Gs(ze,Ye){return[3/u*ze*O(l*l/3-Ye*Ye),Ye]}Gs.invert=function(ze,Ye){return[u/3*ze/O(l*l/3-Ye*Ye),Ye]};function no(){return k.geoProjection(Gs).scale(158.837)}function ko(ze){function Ye(qe,st){if(E(E(st)-y)<v)return[0,st<0?-2:2];var mt=x(st),yt=d((1+mt)/(1-mt),ze/2),Tt=.5*(yt+1/yt)+g(qe*=ze);return[2*x(qe)/Tt,(yt-1/yt)/Tt]}return Ye.invert=function(qe,st){var mt=E(st);if(E(mt-2)<v)return qe?null:[0,m(st)*y];if(mt>2)return null;qe/=2,st/=2;var yt=qe*qe,Tt=st*st,ar=2*st/(1+yt+Tt);return ar=d((1+ar)/(1-ar),1/ze),[p(2*qe,1-yt-Tt)/ze,R((ar-1)/(ar+1))]},Ye}function Fl(){var ze=.5,Ye=k.geoProjectionMutator(ko),qe=Ye(ze);return qe.spacing=function(st){return arguments.length?Ye(ze=+st):ze},qe.scale(124.75)}var Ho=l/A;function ao(ze,Ye){return[ze*(1+O(g(Ye)))/2,Ye/(g(Ye/2)*g(ze/6))]}ao.invert=function(ze,Ye){var qe=E(ze),st=E(Ye),mt=v,yt=y;st<Ho?yt*=st/Ho:mt+=6*z(Ho/st);for(var Tt=0;Tt<25;Tt++){var ar=x(yt),lr=O(g(yt)),rr=x(yt/2),hr=g(yt/2),kr=x(mt/6),Yr=g(mt/6),$r=.5*mt*(1+lr)-qe,xn=yt/(hr*Yr)-st,Rn=lr?-.25*mt*ar/lr:0,Wn=.5*(1+lr),ba=(1+.5*yt*rr/hr)/(hr*Yr),Wa=yt/hr*(kr/6)/(Yr*Yr),Ja=Rn*Wa-ba*Wn,Qa=($r*Wa-xn*Wn)/Ja,ri=(xn*Rn-$r*ba)/Ja;if(yt-=Qa,mt-=ri,E(Qa)<v&&E(ri)<v)break}return[ze<0?-mt:mt,Ye<0?-yt:yt]};function Ys(){return k.geoProjection(ao).scale(97.2672)}function io(ze,Ye){var qe=ze*ze,st=Ye*Ye;return[ze*(.975534+st*(-.119161+qe*-.0143059+st*-.0547009)),Ye*(1.00384+qe*(.0802894+st*-.02855+qe*199025e-9)+st*(.0998909+st*-.0491032))]}io.invert=function(ze,Ye){var qe=m(ze)*l,st=Ye/2,mt=50;do{var yt=qe*qe,Tt=st*st,ar=qe*st,lr=qe*(.975534+Tt*(-.119161+yt*-.0143059+Tt*-.0547009))-ze,rr=st*(1.00384+yt*(.0802894+Tt*-.02855+yt*199025e-9)+Tt*(.0998909+Tt*-.0491032))-Ye,hr=.975534-Tt*(.119161+3*yt*.0143059+Tt*.0547009),kr=-ar*(2*.119161+4*.0547009*Tt+2*.0143059*yt),Yr=ar*(2*.0802894+4*199025e-9*yt+2*-.02855*Tt),$r=1.00384+yt*(.0802894+199025e-9*yt)+Tt*(3*(.0998909-.02855*yt)-5*.0491032*Tt),xn=kr*Yr-$r*hr,Rn=(rr*kr-lr*$r)/xn,Wn=(lr*Yr-rr*hr)/xn;qe-=Rn,st-=Wn}while((E(Rn)>v||E(Wn)>v)&&--mt>0);return mt&&[qe,st]};function Si(){return k.geoProjection(io).scale(139.98)}function Eo(ze,Ye){return[x(ze)/g(Ye),M(Ye)*g(ze)]}Eo.invert=function(ze,Ye){var qe=ze*ze,st=Ye*Ye,mt=st+1,yt=qe+mt,Tt=ze?w*O((yt-O(yt*yt-4*qe))/qe):1/O(mt);return[R(ze*Tt),m(Ye)*z(Tt)]};function oo(){return k.geoProjection(Eo).scale(144.049).clipAngle(90-.001)}function $o(ze){var Ye=g(ze),qe=M(T+ze/2);function st(mt,yt){var Tt=yt-ze,ar=E(Tt)<v?mt*Ye:E(ar=T+yt/2)<v||E(E(ar)-y)<v?0:mt*Tt/i(M(ar)/qe);return[ar,Tt]}return st.invert=function(mt,yt){var Tt,ar=yt+ze;return[E(yt)<v?mt/Ye:E(Tt=T+ar/2)<v||E(E(Tt)-y)<v?0:mt*i(M(Tt)/qe)/yt,ar]},st}function Go(){return Qe($o).parallel(40).scale(158.837)}function Al(ze,Ye){return[ze,1.25*i(M(T+.4*Ye))]}Al.invert=function(ze,Ye){return[ze,2.5*e(a(.8*Ye))-.625*l]};function Yo(){return k.geoProjection(Al).scale(108.318)}function Eu(ze){var Ye=ze.length-1;function qe(st,mt){for(var yt=g(mt),Tt=2/(1+yt*g(st)),ar=Tt*yt*x(st),lr=Tt*x(mt),rr=Ye,hr=ze[rr],kr=hr[0],Yr=hr[1],$r;--rr>=0;)hr=ze[rr],kr=hr[0]+ar*($r=kr)-lr*Yr,Yr=hr[1]+ar*Yr+lr*$r;return kr=ar*($r=kr)-lr*Yr,Yr=ar*Yr+lr*$r,[kr,Yr]}return qe.invert=function(st,mt){var yt=20,Tt=st,ar=mt;do{for(var lr=Ye,rr=ze[lr],hr=rr[0],kr=rr[1],Yr=0,$r=0,xn;--lr>=0;)rr=ze[lr],Yr=hr+Tt*(xn=Yr)-ar*$r,$r=kr+Tt*$r+ar*xn,hr=rr[0]+Tt*(xn=hr)-ar*kr,kr=rr[1]+Tt*kr+ar*xn;Yr=hr+Tt*(xn=Yr)-ar*$r,$r=kr+Tt*$r+ar*xn,hr=Tt*(xn=hr)-ar*kr-st,kr=Tt*kr+ar*xn-mt;var Rn=Yr*Yr+$r*$r,Wn,ba;Tt-=Wn=(hr*Yr+kr*$r)/Rn,ar-=ba=(kr*Yr-hr*$r)/Rn}while(E(Wn)+E(ba)>v*v&&--yt>0);if(yt){var Wa=O(Tt*Tt+ar*ar),Ja=2*e(Wa*.5),Qa=x(Ja);return[p(Tt*Qa,Wa*g(Ja)),Wa?R(ar*Qa/Wa):0]}},qe}var Ws=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Co=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],du=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],_s=[[.9245,0],[0,0],[.01943,0]],ws=[[.721316,0],[0,0],[-.00881625,-.00617325]];function Ol(){return Ts(Ws,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)}function Cu(){return Ts(Co,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])}function Lu(){return Ts(du,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])}function Xs(){return Ts(_s,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)}function Bl(){return Ts(ws,[165,10]).scale(250).clipAngle(130).center([-165,-10])}function Ts(ze,Ye){var qe=k.geoProjection(Eu(ze)).rotate(Ye).clipAngle(90),st=k.geoRotation(Ye),mt=qe.center;return delete qe.rotate,qe.center=function(yt){return arguments.length?mt(st(yt)):st.invert(mt())},qe}var Ql=O(6),il=O(7);function $l(ze,Ye){var qe=R(7*x(Ye)/(3*Ql));return[Ql*ze*(2*g(2*qe/3)-1)/il,9*x(qe/3)/il]}$l.invert=function(ze,Ye){var qe=3*R(Ye*il/9);return[ze*il/(Ql*(2*g(2*qe/3)-1)),R(x(qe)*3*Ql/7)]};function Pu(){return k.geoProjection($l).scale(164.859)}function ql(ze,Ye){for(var qe=(1+w)*x(Ye),st=Ye,mt=0,yt;mt<25&&(st-=yt=(x(st/2)+x(st)-qe)/(.5*g(st/2)+g(st)),!(E(yt)<v));mt++);return[ze*(1+2*g(st)/g(st/2))/(3*A),2*O(3)*x(st/2)/O(2+A)]}ql.invert=function(ze,Ye){var qe=Ye*O(2+A)/(2*O(3)),st=2*R(qe);return[3*A*ze/(1+2*g(st)/g(st/2)),R((qe+x(st))/(1+w))]};function Zu(){return k.geoProjection(ql).scale(188.209)}function Zs(ze,Ye){for(var qe=O(6/(4+l)),st=(1+l/4)*x(Ye),mt=Ye/2,yt=0,Tt;yt<25&&(mt-=Tt=(mt/2+x(mt)-st)/(.5+g(mt)),!(E(Tt)<v));yt++);return[qe*(.5+g(mt))*ze/1.5,qe*mt]}Zs.invert=function(ze,Ye){var qe=O(6/(4+l)),st=Ye/qe;return E(E(st)-y)<v&&(st=st<0?-y:y),[1.5*ze/(qe*(.5+g(st))),R((st/2+x(st))/(1+l/4))]};function Nl(){return k.geoProjection(Zs).scale(166.518)}function Ml(ze,Ye){var qe=Ye*Ye,st=qe*qe,mt=qe*st;return[ze*(.84719-.13063*qe+mt*mt*(-.04515+.05494*qe-.02326*st+.00331*mt)),Ye*(1.01183+st*st*(-.02625+.01926*qe-.00396*st))]}Ml.invert=function(ze,Ye){var qe=Ye,st=25,mt,yt,Tt,ar;do yt=qe*qe,Tt=yt*yt,qe-=mt=(qe*(1.01183+Tt*Tt*(-.02625+.01926*yt-.00396*Tt))-Ye)/(1.01183+Tt*Tt*(9*-.02625+11*.01926*yt+13*-.00396*Tt));while(E(mt)>_&&--st>0);return yt=qe*qe,Tt=yt*yt,ar=yt*Tt,[ze/(.84719-.13063*yt+ar*ar*(-.04515+.05494*yt-.02326*Tt+.00331*ar)),qe]};function ol(){return k.geoProjection(Ml).scale(175.295)}function Sl(ze,Ye){return[ze*(1+g(Ye))/2,2*(Ye-M(Ye/2))]}Sl.invert=function(ze,Ye){for(var qe=Ye/2,st=0,mt=1/0;st<10&&E(mt)>v;++st){var yt=g(Ye/2);Ye-=mt=(Ye-M(Ye/2)-qe)/(1-.5/(yt*yt))}return[2*ze/(1+g(Ye)),Ye]};function eu(){return k.geoProjection(Sl).scale(152.63)}var js=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function gu(){return sa(Z(1/0),js).rotate([20,0]).scale(152.63)}function tu(ze,Ye){var qe=x(Ye),st=g(Ye),mt=m(ze);if(ze===0||E(Ye)===y)return[0,Ye];if(Ye===0)return[ze,0];if(E(ze)===y)return[ze*st,y*qe];var yt=l/(2*ze)-2*ze/l,Tt=2*Ye/l,ar=(1-Tt*Tt)/(qe-Tt),lr=yt*yt,rr=ar*ar,hr=1+lr/rr,kr=1+rr/lr,Yr=(yt*qe/ar-yt/2)/hr,$r=(rr*qe/lr+ar/2)/kr,xn=Yr*Yr+st*st/hr,Rn=$r*$r-(rr*qe*qe/lr+ar*qe-1)/kr;return[y*(Yr+O(xn)*mt),y*($r+O(Rn<0?0:Rn)*m(-Ye*yt)*mt)]}tu.invert=function(ze,Ye){ze/=y,Ye/=y;var qe=ze*ze,st=Ye*Ye,mt=qe+st,yt=l*l;return[ze?(mt-1+O((1-mt)*(1-mt)+4*qe))/(2*ze)*y:0,ge(function(Tt){return mt*(l*x(Tt)-2*Tt)*l+4*Tt*Tt*(Ye-x(Tt))+2*l*Tt-yt*Ye},0)]};function Du(){return k.geoProjection(tu).scale(127.267)}var yu=1.0148,Wo=.23185,kl=-.14499,sl=.02406,ru=yu,as=5*Wo,Lo=7*kl,Ul=9*sl,Ps=1.790857183;function As(ze,Ye){var qe=Ye*Ye;return[ze,Ye*(yu+qe*qe*(Wo+qe*(kl+sl*qe)))]}As.invert=function(ze,Ye){Ye>Ps?Ye=Ps:Ye<-Ps&&(Ye=-Ps);var qe=Ye,st;do{var mt=qe*qe;qe-=st=(qe*(yu+mt*mt*(Wo+mt*(kl+sl*mt)))-Ye)/(ru+mt*mt*(as+mt*(Lo+Ul*mt)))}while(E(st)>v);return[ze,qe]};function ho(){return k.geoProjection(As).scale(139.319)}function ll(ze,Ye){if(E(Ye)<v)return[ze,0];var qe=M(Ye),st=ze*x(Ye);return[x(st)/qe,Ye+(1-g(st))/qe]}ll.invert=function(ze,Ye){if(E(Ye)<v)return[ze,0];var qe=ze*ze+Ye*Ye,st=Ye*.5,mt=10,yt;do{var Tt=M(st),ar=1/g(st),lr=qe-2*Ye*st+st*st;st-=yt=(Tt*lr+2*(st-Ye))/(2+lr*ar*ar+2*(st-Ye)*Tt)}while(E(yt)>v&&--mt>0);return Tt=M(st),[(E(Ye)<E(st+1/Tt)?R(ze*Tt):m(Ye)*m(ze)*(z(E(ze*Tt))+y))/x(st),st]};function Ru(){return k.geoProjection(ll).scale(103.74)}function nu(ze,Ye){var qe=vs(ze[1],ze[0]),st=vs(Ye[1],Ye[0]),mt=El(qe,st),yt=Xo(qe)/Xo(st);return Ms([1,0,ze[0][0],0,1,ze[0][1]],Ms([yt,0,0,0,yt,0],Ms([g(mt),x(mt),0,-x(mt),g(mt),0],[1,0,-Ye[0][0],0,1,-Ye[0][1]])))}function Iu(ze){var Ye=1/(ze[0]*ze[4]-ze[1]*ze[3]);return[Ye*ze[4],-Ye*ze[1],Ye*(ze[1]*ze[5]-ze[2]*ze[4]),-Ye*ze[3],Ye*ze[0],Ye*(ze[2]*ze[3]-ze[0]*ze[5])]}function Ms(ze,Ye){return[ze[0]*Ye[0]+ze[1]*Ye[3],ze[0]*Ye[1]+ze[1]*Ye[4],ze[0]*Ye[2]+ze[1]*Ye[5]+ze[2],ze[3]*Ye[0]+ze[4]*Ye[3],ze[3]*Ye[1]+ze[4]*Ye[4],ze[3]*Ye[2]+ze[4]*Ye[5]+ze[5]]}function vs(ze,Ye){return[ze[0]-Ye[0],ze[1]-Ye[1]]}function Xo(ze){return O(ze[0]*ze[0]+ze[1]*ze[1])}function El(ze,Ye){return p(ze[0]*Ye[1]-ze[1]*Ye[0],ze[0]*Ye[0]+ze[1]*Ye[1])}function ul(ze,Ye,qe){st(ze,{transform:null});function st(rr,hr){if(rr.edges=au(rr.face),hr.face){var kr=rr.shared=Fu(rr.face,hr.face),Yr=nu(kr.map(hr.project),kr.map(rr.project));rr.transform=hr.transform?Ms(hr.transform,Yr):Yr;for(var $r=hr.edges,xn=0,Rn=$r.length;xn<Rn;++xn)is(kr[0],$r[xn][1])&&is(kr[1],$r[xn][0])&&($r[xn]=rr),is(kr[0],$r[xn][0])&&is(kr[1],$r[xn][1])&&($r[xn]=rr);for($r=rr.edges,xn=0,Rn=$r.length;xn<Rn;++xn)is(kr[0],$r[xn][0])&&is(kr[1],$r[xn][1])&&($r[xn]=hr),is(kr[0],$r[xn][1])&&is(kr[1],$r[xn][0])&&($r[xn]=hr)}else rr.transform=hr.transform;return rr.children&&rr.children.forEach(function(Wn){st(Wn,rr)}),rr}function mt(rr,hr){var kr=Ye(rr,hr),Yr=kr.project([rr*h,hr*h]),$r;return($r=kr.transform)?[$r[0]*Yr[0]+$r[1]*Yr[1]+$r[2],-($r[3]*Yr[0]+$r[4]*Yr[1]+$r[5])]:(Yr[1]=-Yr[1],Yr)}fl(ze)&&(mt.invert=function(rr,hr){var kr=yt(ze,[rr,-hr]);return kr&&(kr[0]*=o,kr[1]*=o,kr)});function yt(rr,hr){var kr=rr.project.invert,Yr=rr.transform,$r=hr;if(Yr&&(Yr=Iu(Yr),$r=[Yr[0]*$r[0]+Yr[1]*$r[1]+Yr[2],Yr[3]*$r[0]+Yr[4]*$r[1]+Yr[5]]),kr&&rr===Tt(xn=kr($r)))return xn;for(var xn,Rn=rr.children,Wn=0,ba=Rn&&Rn.length;Wn<ba;++Wn)if(xn=yt(Rn[Wn],hr))return xn}function Tt(rr){return Ye(rr[0]*o,rr[1]*o)}var ar=k.geoProjection(mt),lr=ar.stream;return ar.stream=function(rr){var hr=ar.rotate(),kr=lr(rr),Yr=(ar.rotate([0,0]),lr(rr));return ar.rotate(hr),kr.sphere=function(){Yr.polygonStart(),Yr.lineStart(),zu(Yr,ze),Yr.lineEnd(),Yr.polygonEnd()},kr},ar.angle(qe==null?-30:qe*h)}function zu(ze,Ye,qe){var st,mt=Ye.edges,yt=mt.length,Tt,ar={type:"MultiPoint",coordinates:Ye.face},lr=Ye.face.filter(function(Rn){return E(Rn[1])!==90}),rr=k.geoBounds({type:"MultiPoint",coordinates:lr}),hr=!1,kr=-1,Yr=rr[1][0]-rr[0][0],$r=Yr===180||Yr===360?[(rr[0][0]+rr[1][0])/2,(rr[0][1]+rr[1][1])/2]:k.geoCentroid(ar);if(qe)for(;++kr<yt&&mt[kr]!==qe;);++kr;for(var xn=0;xn<yt;++xn)Tt=mt[(xn+kr)%yt],Array.isArray(Tt)?(hr||(ze.point((st=k.geoInterpolate(Tt[0],$r)(v))[0],st[1]),hr=!0),ze.point((st=k.geoInterpolate(Tt[1],$r)(v))[0],st[1])):(hr=!1,Tt!==qe&&zu(ze,Tt,Ye))}function is(ze,Ye){return ze&&Ye&&ze[0]===Ye[0]&&ze[1]===Ye[1]}function Fu(ze,Ye){for(var qe,st,mt=ze.length,yt=null,Tt=0;Tt<mt;++Tt){qe=ze[Tt];for(var ar=Ye.length;--ar>=0;)if(st=Ye[ar],qe[0]===st[0]&&qe[1]===st[1]){if(yt)return[yt,qe];yt=qe}}}function au(ze){for(var Ye=ze.length,qe=[],st=ze[Ye-1],mt=0;mt<Ye;++mt)qe.push([st,st=ze[mt]]);return qe}function fl(ze){return ze.project.invert||ze.children&&ze.children.some(fl)}var iu=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],Cl=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(ze){return ze.map(function(Ye){return iu[Ye]})});function Ll(ze){ze=ze||function(qe){var st=k.geoCentroid({type:"MultiPoint",coordinates:qe});return k.geoGnomonic().scale(1).translate([0,0]).rotate([-st[0],-st[1]])};var Ye=Cl.map(function(qe){return{face:qe,project:ze(qe)}});return[-1,0,0,1,0,1,4,5].forEach(function(qe,st){var mt=Ye[qe];mt&&(mt.children||(mt.children=[])).push(Ye[st])}),ul(Ye[0],function(qe,st){return Ye[qe<-l/2?st<0?6:4:qe<0?st<0?2:0:qe<l/2?st<0?3:1:st<0?7:5]}).angle(-30).scale(101.858).center([0,45])}var Vl=2/O(3);function Hl(ze,Ye){var qe=We(ze,Ye);return[qe[0]*Vl,qe[1]]}Hl.invert=function(ze,Ye){return We.invert(ze/Vl,Ye)};function ju(ze){ze=ze||function(qe){var st=k.geoCentroid({type:"MultiPoint",coordinates:qe});return k.geoProjection(Hl).translate([0,0]).scale(1).rotate(st[1]>0?[-st[0],0]:[180-st[0],180])};var Ye=Cl.map(function(qe){return{face:qe,project:ze(qe)}});return[-1,0,0,1,0,1,4,5].forEach(function(qe,st){var mt=Ye[qe];mt&&(mt.children||(mt.children=[])).push(Ye[st])}),ul(Ye[0],function(qe,st){return Ye[qe<-l/2?st<0?6:4:qe<0?st<0?2:0:qe<l/2?st<0?3:1:st<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])}function Vi(ze){ze=ze||function(Tt){var ar=Tt.length===6?k.geoCentroid({type:"MultiPoint",coordinates:Tt}):Tt[0];return k.geoGnomonic().scale(1).translate([0,0]).rotate([-ar[0],-ar[1]])};var Ye=Cl.map(function(Tt){for(var ar=Tt.map(ps),lr=ar.length,rr=ar[lr-1],hr,kr=[],Yr=0;Yr<lr;++Yr)hr=ar[Yr],kr.push(os([rr[0]*.9486832980505138+hr[0]*.31622776601683794,rr[1]*.9486832980505138+hr[1]*.31622776601683794,rr[2]*.9486832980505138+hr[2]*.31622776601683794]),os([hr[0]*.9486832980505138+rr[0]*.31622776601683794,hr[1]*.9486832980505138+rr[1]*.31622776601683794,hr[2]*.9486832980505138+rr[2]*.31622776601683794])),rr=hr;return kr}),qe=[],st=[-1,0,0,1,0,1,4,5];Ye.forEach(function(Tt,ar){for(var lr=Cl[ar],rr=lr.length,hr=qe[ar]=[],kr=0;kr<rr;++kr)Ye.push([lr[kr],Tt[(kr*2+2)%(2*rr)],Tt[(kr*2+1)%(2*rr)]]),st.push(ar),hr.push(Ks(ps(Tt[(kr*2+2)%(2*rr)]),ps(Tt[(kr*2+1)%(2*rr)])))});var mt=Ye.map(function(Tt){return{project:ze(Tt),face:Tt}});st.forEach(function(Tt,ar){var lr=mt[Tt];lr&&(lr.children||(lr.children=[])).push(mt[ar])});function yt(Tt,ar){var lr=g(ar),rr=[lr*g(Tt),lr*x(Tt),x(ar)],hr=Tt<-l/2?ar<0?6:4:Tt<0?ar<0?2:0:Tt<l/2?ar<0?3:1:ar<0?7:5,kr=qe[hr];return mt[cl(kr[0],rr)<0?8+3*hr:cl(kr[1],rr)<0?8+3*hr+1:cl(kr[2],rr)<0?8+3*hr+2:hr]}return ul(mt[0],yt).angle(-30).scale(110.625).center([0,45])}function cl(ze,Ye){for(var qe=0,st=ze.length,mt=0;qe<st;++qe)mt+=ze[qe]*Ye[qe];return mt}function Ks(ze,Ye){return[ze[1]*Ye[2]-ze[2]*Ye[1],ze[2]*Ye[0]-ze[0]*Ye[2],ze[0]*Ye[1]-ze[1]*Ye[0]]}function os(ze){return[p(ze[1],ze[0])*h,R(n(-1,r(1,ze[2])))*h]}function ps(ze){var Ye=ze[0]*o,qe=ze[1]*o,st=g(qe);return[st*g(Ye),st*x(Ye),x(qe)]}function Gl(){}function co(ze){if((qe=ze.length)<4)return!1;for(var Ye=0,qe,st=ze[qe-1][1]*ze[0][0]-ze[qe-1][0]*ze[0][1];++Ye<qe;)st+=ze[Ye-1][1]*ze[Ye][0]-ze[Ye-1][0]*ze[Ye][1];return st<=0}function ou(ze,Ye){for(var qe=Ye[0],st=Ye[1],mt=!1,yt=0,Tt=ze.length,ar=Tt-1;yt<Tt;ar=yt++){var lr=ze[yt],rr=lr[0],hr=lr[1],kr=ze[ar],Yr=kr[0],$r=kr[1];hr>st^$r>st&&qe<(Yr-rr)*(st-hr)/($r-hr)+rr&&(mt=!mt)}return mt}function qo(ze,Ye){var qe=Ye.stream,st;if(!qe)throw new Error("invalid projection");switch(ze&&ze.type){case"Feature":st=Js;break;case"FeatureCollection":st=Ds;break;default:st=ds;break}return st(ze,qe)}function Ds(ze,Ye){return{type:"FeatureCollection",features:ze.features.map(function(qe){return Js(qe,Ye)})}}function Js(ze,Ye){return{type:"Feature",id:ze.id,properties:ze.properties,geometry:ds(ze.geometry,Ye)}}function Rs(ze,Ye){return{type:"GeometryCollection",geometries:ze.geometries.map(function(qe){return ds(qe,Ye)})}}function ds(ze,Ye){if(!ze)return null;if(ze.type==="GeometryCollection")return Rs(ze,Ye);var qe;switch(ze.type){case"Point":qe=Zo;break;case"MultiPoint":qe=Zo;break;case"LineString":qe=Yl;break;case"MultiLineString":qe=Yl;break;case"Polygon":qe=Wl;break;case"MultiPolygon":qe=Wl;break;case"Sphere":qe=Wl;break;default:return null}return k.geoStream(ze,Ye(qe)),qe.result()}var Ji=[],wo=[],Zo={point:function(ze,Ye){Ji.push([ze,Ye])},result:function(){var ze=Ji.length?Ji.length<2?{type:"Point",coordinates:Ji[0]}:{type:"MultiPoint",coordinates:Ji}:null;return Ji=[],ze}},Yl={lineStart:Gl,point:function(ze,Ye){Ji.push([ze,Ye])},lineEnd:function(){Ji.length&&(wo.push(Ji),Ji=[])},result:function(){var ze=wo.length?wo.length<2?{type:"LineString",coordinates:wo[0]}:{type:"MultiLineString",coordinates:wo}:null;return wo=[],ze}},Wl={polygonStart:Gl,lineStart:Gl,point:function(ze,Ye){Ji.push([ze,Ye])},lineEnd:function(){var ze=Ji.length;if(ze){do Ji.push(Ji[0].slice());while(++ze<4);wo.push(Ji),Ji=[]}},polygonEnd:Gl,result:function(){if(!wo.length)return null;var ze=[],Ye=[];return wo.forEach(function(qe){co(qe)?ze.push([qe]):Ye.push(qe)}),Ye.forEach(function(qe){var st=qe[0];ze.some(function(mt){if(ou(mt[0],st))return mt.push(qe),!0})||ze.push([qe])}),wo=[],ze.length?ze.length>1?{type:"MultiPolygon",coordinates:ze}:{type:"Polygon",coordinates:ze[0]}:null}};function mu(ze){var Ye=ze(y,0)[0]-ze(-y,0)[0];function qe(st,mt){var yt=E(st)<y,Tt=ze(yt?st:st>0?st-l:st+l,mt),ar=(Tt[0]-Tt[1])*w,lr=(Tt[0]+Tt[1])*w;if(yt)return[ar,lr];var rr=Ye*w,hr=ar>0^lr>0?-1:1;return[hr*ar-m(lr)*rr,hr*lr-m(ar)*rr]}return ze.invert&&(qe.invert=function(st,mt){var yt=(st+mt)*w,Tt=(mt-st)*w,ar=E(yt)<.5*Ye&&E(Tt)<.5*Ye;if(!ar){var lr=Ye*w,rr=yt>0^Tt>0?-1:1,hr=-rr*st+(Tt>0?1:-1)*lr,kr=-rr*mt+(yt>0?1:-1)*lr;yt=(-hr-kr)*w,Tt=(hr-kr)*w}var Yr=ze.invert(yt,Tt);return ar||(Yr[0]+=yt>0?l:-l),Yr}),k.geoProjection(qe).rotate([-90,-90,45]).clipAngle(180-.001)}function gt(){return mu(Ar).scale(176.423)}function Dt(){return mu(ka).scale(111.48)}function or(ze,Ye){if(!(0<=(Ye=+Ye)&&Ye<=20))throw new Error("invalid digits");function qe(rr){var hr=rr.length,kr=2,Yr=new Array(hr);for(Yr[0]=+rr[0].toFixed(Ye),Yr[1]=+rr[1].toFixed(Ye);kr<hr;)Yr[kr]=rr[kr],++kr;return Yr}function st(rr){return rr.map(qe)}function mt(rr){for(var hr=qe(rr[0]),kr=[hr],Yr=1;Yr<rr.length;Yr++){var $r=qe(rr[Yr]);($r.length>2||$r[0]!=hr[0]||$r[1]!=hr[1])&&(kr.push($r),hr=$r)}return kr.length===1&&rr.length>1&&kr.push(qe(rr[rr.length-1])),kr}function yt(rr){return rr.map(mt)}function Tt(rr){if(rr==null)return rr;var hr;switch(rr.type){case"GeometryCollection":hr={type:"GeometryCollection",geometries:rr.geometries.map(Tt)};break;case"Point":hr={type:"Point",coordinates:qe(rr.coordinates)};break;case"MultiPoint":hr={type:rr.type,coordinates:st(rr.coordinates)};break;case"LineString":hr={type:rr.type,coordinates:mt(rr.coordinates)};break;case"MultiLineString":case"Polygon":hr={type:rr.type,coordinates:yt(rr.coordinates)};break;case"MultiPolygon":hr={type:"MultiPolygon",coordinates:rr.coordinates.map(yt)};break;default:return rr}return rr.bbox!=null&&(hr.bbox=rr.bbox),hr}function ar(rr){var hr={type:"Feature",properties:rr.properties,geometry:Tt(rr.geometry)};return rr.id!=null&&(hr.id=rr.id),rr.bbox!=null&&(hr.bbox=rr.bbox),hr}if(ze!=null)switch(ze.type){case"Feature":return ar(ze);case"FeatureCollection":{var lr={type:"FeatureCollection",features:ze.features.map(ar)};return ze.bbox!=null&&(lr.bbox=ze.bbox),lr}default:return Tt(ze)}return ze}function er(ze){var Ye=x(ze);function qe(st,mt){var yt=Ye?M(st*Ye/2)/Ye:st/2;if(!mt)return[2*yt,-ze];var Tt=2*e(yt*x(mt)),ar=1/M(mt);return[x(Tt)*ar,mt+(1-g(Tt))*ar-ze]}return qe.invert=function(st,mt){if(E(mt+=ze)<v)return[Ye?2*e(Ye*st/2)/Ye:st,0];var yt=st*st+mt*mt,Tt=0,ar=10,lr;do{var rr=M(Tt),hr=1/g(Tt),kr=yt-2*mt*Tt+Tt*Tt;Tt-=lr=(rr*kr+2*(Tt-mt))/(2+kr*hr*hr+2*(Tt-mt)*rr)}while(E(lr)>v&&--ar>0);var Yr=st*(rr=M(Tt)),$r=M(E(mt)<E(Tt+1/rr)?R(Yr)*.5:z(Yr)*.5+l/4)/x(Tt);return[Ye?2*e(Ye*$r)/Ye:2*$r,Tt]},qe}function Er(){return Qe(er).scale(131.215)}var en=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];en.forEach(function(ze){ze[1]*=1.0144});function pn(ze,Ye){var qe=r(18,E(Ye)*36/l),st=t(qe),mt=qe-st,yt=(kr=en[st])[0],Tt=kr[1],ar=(kr=en[++st])[0],lr=kr[1],rr=(kr=en[r(19,++st)])[0],hr=kr[1],kr;return[ze*(ar+mt*(rr-yt)/2+mt*mt*(rr-2*ar+yt)/2),(Ye>0?y:-y)*(lr+mt*(hr-Tt)/2+mt*mt*(hr-2*lr+Tt)/2)]}pn.invert=function(ze,Ye){var qe=Ye/y,st=qe*90,mt=r(18,E(st/5)),yt=n(0,t(mt));do{var Tt=en[yt][1],ar=en[yt+1][1],lr=en[r(19,yt+2)][1],rr=lr-Tt,hr=lr-2*ar+Tt,kr=2*(E(qe)-ar)/rr,Yr=hr/rr,$r=kr*(1-Yr*kr*(1-2*Yr*kr));if($r>=0||yt===1){st=(Ye>=0?5:-5)*($r+mt);var xn=50,Rn;do mt=r(18,E(st)/5),yt=t(mt),$r=mt-yt,Tt=en[yt][1],ar=en[yt+1][1],lr=en[r(19,yt+2)][1],st-=(Rn=(Ye>=0?y:-y)*(ar+$r*(lr-Tt)/2+$r*$r*(lr-2*ar+Tt)/2)-Ye)*h;while(E(Rn)>_&&--xn>0);break}}while(--yt>=0);var Wn=en[yt][0],ba=en[yt+1][0],Wa=en[r(19,yt+2)][0];return[ze/(ba+$r*(Wa-Wn)/2+$r*$r*(Wa-2*ba+Wn)/2),st*o]};function An(){return k.geoProjection(pn).scale(152.63)}function Ln(ze){function Ye(qe,st){var mt=g(st),yt=(ze-1)/(ze-mt*g(qe));return[yt*mt*x(qe),yt*x(st)]}return Ye.invert=function(qe,st){var mt=qe*qe+st*st,yt=O(mt),Tt=(ze-O(1-mt*(ze+1)/(ze-1)))/((ze-1)/yt+yt/(ze-1));return[p(qe*Tt,yt*O(1-Tt*Tt)),yt?R(st*Tt/yt):0]},Ye}function Hn(ze,Ye){var qe=Ln(ze);if(!Ye)return qe;var st=g(Ye),mt=x(Ye);function yt(Tt,ar){var lr=qe(Tt,ar),rr=lr[1],hr=rr*mt/(ze-1)+st;return[lr[0]*st/hr,rr/hr]}return yt.invert=function(Tt,ar){var lr=(ze-1)/(ze-1-ar*mt);return qe.invert(lr*Tt,lr*ar*st)},yt}function yn(){var ze=2,Ye=0,qe=k.geoProjectionMutator(Hn),st=qe(ze,Ye);return st.distance=function(mt){return arguments.length?qe(ze=+mt,Ye):ze},st.tilt=function(mt){return arguments.length?qe(ze,Ye=mt*o):Ye*h},st.scale(432.147).clipAngle(z(1/ze)*h-1e-6)}var Fn=1e-4,Pn=1e4,Gn=-180,$n=Gn+Fn,Ha=180,La=Ha-Fn,Fa=-90,Na=Fa+Fn,qn=90,va=qn-Fn;function ja(ze){return ze.length>0}function qa(ze){return Math.floor(ze*Pn)/Pn}function Ti(ze){return ze===Fa||ze===qn?[0,ze]:[Gn,qa(ze)]}function xi(ze){var Ye=ze[0],qe=ze[1],st=!1;return Ye<=$n?(Ye=Gn,st=!0):Ye>=La&&(Ye=Ha,st=!0),qe<=Na?(qe=Fa,st=!0):qe>=va&&(qe=qn,st=!0),st?[Ye,qe]:ze}function bi(ze){return ze.map(xi)}function Di(ze,Ye,qe){for(var st=0,mt=ze.length;st<mt;++st){var yt=ze[st].slice();qe.push({index:-1,polygon:Ye,ring:yt});for(var Tt=0,ar=yt.length;Tt<ar;++Tt){var lr=yt[Tt],rr=lr[0],hr=lr[1];if(rr<=$n||rr>=La||hr<=Na||hr>=va){yt[Tt]=xi(lr);for(var kr=Tt+1;kr<ar;++kr){var Yr=yt[kr],$r=Yr[0],xn=Yr[1];if($r>$n&&$r<La&&xn>Na&&xn<va)break}if(kr===Tt+1)continue;if(Tt){var Rn={index:-1,polygon:Ye,ring:yt.slice(0,Tt+1)};Rn.ring[Rn.ring.length-1]=Ti(hr),qe[qe.length-1]=Rn}else qe.pop();if(kr>=ar)break;qe.push({index:-1,polygon:Ye,ring:yt=yt.slice(kr-1)}),yt[0]=Ti(yt[0][1]),Tt=-1,ar=yt.length}}}}function li(ze){var Ye,qe=ze.length,st={},mt={},yt,Tt,ar,lr,rr;for(Ye=0;Ye<qe;++Ye){if(yt=ze[Ye],Tt=yt.ring[0],lr=yt.ring[yt.ring.length-1],Tt[0]===lr[0]&&Tt[1]===lr[1]){yt.polygon.push(yt.ring),ze[Ye]=null;continue}yt.index=Ye,st[Tt]=mt[lr]=yt}for(Ye=0;Ye<qe;++Ye)if(yt=ze[Ye],yt){if(Tt=yt.ring[0],lr=yt.ring[yt.ring.length-1],ar=mt[Tt],rr=st[lr],delete st[Tt],delete mt[lr],Tt[0]===lr[0]&&Tt[1]===lr[1]){yt.polygon.push(yt.ring);continue}ar?(delete mt[Tt],delete st[ar.ring[0]],ar.ring.pop(),ze[ar.index]=null,yt={index:-1,polygon:ar.polygon,ring:ar.ring.concat(yt.ring)},ar===rr?yt.polygon.push(yt.ring):(yt.index=qe++,ze.push(st[yt.ring[0]]=mt[yt.ring[yt.ring.length-1]]=yt))):rr?(delete st[lr],delete mt[rr.ring[rr.ring.length-1]],yt.ring.pop(),yt={index:qe++,polygon:rr.polygon,ring:yt.ring.concat(rr.ring)},ze[rr.index]=null,ze.push(st[yt.ring[0]]=mt[yt.ring[yt.ring.length-1]]=yt)):(yt.ring.push(yt.ring[0]),yt.polygon.push(yt.ring))}}function To(ze){var Ye={type:"Feature",geometry:so(ze.geometry)};return ze.id!=null&&(Ye.id=ze.id),ze.bbox!=null&&(Ye.bbox=ze.bbox),ze.properties!=null&&(Ye.properties=ze.properties),Ye}function so(ze){if(ze==null)return ze;var Ye,qe,st,mt;switch(ze.type){case"GeometryCollection":Ye={type:"GeometryCollection",geometries:ze.geometries.map(so)};break;case"Point":Ye={type:"Point",coordinates:xi(ze.coordinates)};break;case"MultiPoint":case"LineString":Ye={type:ze.type,coordinates:bi(ze.coordinates)};break;case"MultiLineString":Ye={type:"MultiLineString",coordinates:ze.coordinates.map(bi)};break;case"Polygon":{var yt=[];Di(ze.coordinates,yt,qe=[]),li(qe),Ye={type:"Polygon",coordinates:yt};break}case"MultiPolygon":{qe=[],st=-1,mt=ze.coordinates.length;for(var Tt=new Array(mt);++st<mt;)Di(ze.coordinates[st],Tt[st]=[],qe);li(qe),Ye={type:"MultiPolygon",coordinates:Tt.filter(ja)};break}default:return ze}return ze.bbox!=null&&(Ye.bbox=ze.bbox),Ye}function ti(ze){if(ze==null)return ze;switch(ze.type){case"Feature":return To(ze);case"FeatureCollection":{var Ye={type:"FeatureCollection",features:ze.features.map(To)};return ze.bbox!=null&&(Ye.bbox=ze.bbox),Ye}default:return so(ze)}}function pa(ze,Ye){var qe=M(Ye/2),st=x(T*qe);return[ze*(.74482-.34588*st*st),1.70711*qe]}pa.invert=function(ze,Ye){var qe=Ye/1.70711,st=x(T*qe);return[ze/(.74482-.34588*st*st),2*e(qe)]};function Ai(){return k.geoProjection(pa).scale(146.153)}function vo(ze,Ye,qe){var st=k.geoInterpolate(Ye,qe),mt=st(.5),yt=k.geoRotation([-mt[0],-mt[1]])(Ye),Tt=st.distance/2,ar=-R(x(yt[1]*o)/x(Tt)),lr=[-mt[0],-mt[1],-(yt[0]>0?l-ar:ar)*h],rr=k.geoProjection(ze(Tt)).rotate(lr),hr=k.geoRotation(lr),kr=rr.center;return delete rr.rotate,rr.center=function(Yr){return arguments.length?kr(hr(Yr)):hr.invert(kr())},rr.clipAngle(90)}function xo(ze){var Ye=g(ze);function qe(st,mt){var yt=k.geoGnomonicRaw(st,mt);return yt[0]*=Ye,yt}return qe.invert=function(st,mt){return k.geoGnomonicRaw.invert(st/Ye,mt)},qe}function ss(){return Ss([-158,21.5],[-77,39]).clipAngle(60).scale(400)}function Ss(ze,Ye){return vo(xo,ze,Ye)}function ls(ze){if(!(ze*=2))return k.geoAzimuthalEquidistantRaw;var Ye=-ze/2,qe=-Ye,st=ze*ze,mt=M(qe),yt=.5/x(qe);function Tt(ar,lr){var rr=z(g(lr)*g(ar-Ye)),hr=z(g(lr)*g(ar-qe)),kr=lr<0?-1:1;return rr*=rr,hr*=hr,[(rr-hr)/(2*ze),kr*O(4*st*hr-(st-rr+hr)*(st-rr+hr))/(2*ze)]}return Tt.invert=function(ar,lr){var rr=lr*lr,hr=g(O(rr+(Yr=ar+Ye)*Yr)),kr=g(O(rr+(Yr=ar+qe)*Yr)),Yr,$r;return[p($r=hr-kr,Yr=(hr+kr)*mt),(lr<0?-1:1)*z(O(Yr*Yr+$r*$r)*yt)]},Tt}function hl(){return gs([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)}function gs(ze,Ye){return vo(ls,ze,Ye)}function ys(ze,Ye){if(E(Ye)<v)return[ze,0];var qe=E(Ye/y),st=R(qe);if(E(ze)<v||E(E(Ye)-y)<v)return[0,m(Ye)*l*M(st/2)];var mt=g(st),yt=E(l/ze-ze/l)/2,Tt=yt*yt,ar=mt/(qe+mt-1),lr=ar*(2/qe-1),rr=lr*lr,hr=rr+Tt,kr=ar-rr,Yr=Tt+ar;return[m(ze)*l*(yt*kr+O(Tt*kr*kr-hr*(ar*ar-rr)))/hr,m(Ye)*l*(lr*Yr-yt*O((Tt+1)*hr-Yr*Yr))/hr]}ys.invert=function(ze,Ye){if(E(Ye)<v)return[ze,0];if(E(ze)<v)return[0,y*x(2*e(Ye/l))];var qe=(ze/=l)*ze,st=(Ye/=l)*Ye,mt=qe+st,yt=mt*mt,Tt=-E(Ye)*(1+mt),ar=Tt-2*st+qe,lr=-2*Tt+1+2*st+yt,rr=st/lr+(2*ar*ar*ar/(lr*lr*lr)-9*Tt*ar/(lr*lr))/27,hr=(Tt-ar*ar/(3*lr))/lr,kr=2*O(-hr/3),Yr=z(3*rr/(hr*kr))/3;return[l*(mt-1+O(1+2*(qe-st)+yt))/(2*ze),m(Ye)*l*(-kr*g(Yr+l/3)-ar/(3*lr))]};function Is(){return k.geoProjection(ys).scale(79.4183)}function vl(ze,Ye){if(E(Ye)<v)return[ze,0];var qe=E(Ye/y),st=R(qe);if(E(ze)<v||E(E(Ye)-y)<v)return[0,m(Ye)*l*M(st/2)];var mt=g(st),yt=E(l/ze-ze/l)/2,Tt=yt*yt,ar=mt*(O(1+Tt)-yt*mt)/(1+Tt*qe*qe);return[m(ze)*l*ar,m(Ye)*l*O(1-ar*(2*yt+ar))]}vl.invert=function(ze,Ye){if(!ze)return[0,y*x(2*e(Ye/l))];var qe=E(ze/l),st=(1-qe*qe-(Ye/=l)*Ye)/(2*qe),mt=st*st,yt=O(mt+1);return[m(ze)*l*(yt-st),m(Ye)*y*x(2*p(O((1-2*st*qe)*(st+yt)-qe),O(yt+st+qe)))]};function pl(){return k.geoProjection(vl).scale(79.4183)}function ms(ze,Ye){if(E(Ye)<v)return[ze,0];var qe=Ye/y,st=R(qe);if(E(ze)<v||E(E(Ye)-y)<v)return[0,l*M(st/2)];var mt=(l/ze-ze/l)/2,yt=qe/(1+g(st));return[l*(m(ze)*O(mt*mt+1-yt*yt)-mt),l*yt]}ms.invert=function(ze,Ye){if(!Ye)return[ze,0];var qe=Ye/l,st=(l*l*(1-qe*qe)-ze*ze)/(2*l*ze);return[ze?l*(m(ze)*O(st*st+1)-st):0,y*x(2*e(qe))]};function Ou(){return k.geoProjection(ms).scale(79.4183)}function dl(ze,Ye){if(!Ye)return[ze,0];var qe=E(Ye);if(!ze||qe===y)return[0,Ye];var st=qe/y,mt=st*st,yt=(8*st-mt*(mt+2)-5)/(2*mt*(st-1)),Tt=yt*yt,ar=st*yt,lr=mt+Tt+2*ar,rr=st+3*yt,hr=ze/y,kr=hr+1/hr,Yr=m(E(ze)-y)*O(kr*kr-4),$r=Yr*Yr,xn=lr*(mt+Tt*$r-1)+(1-mt)*(mt*(rr*rr+4*Tt)+12*ar*Tt+4*Tt*Tt),Rn=(Yr*(lr+Tt-1)+2*O(xn))/(4*lr+$r);return[m(ze)*y*Rn,m(Ye)*y*O(1+Yr*E(Rn)-Rn*Rn)]}dl.invert=function(ze,Ye){var qe;if(!ze||!Ye)return[ze,Ye];Ye/=l;var st=m(ze)*ze/y,mt=(st*st-1+4*Ye*Ye)/E(st),yt=mt*mt,Tt=2*Ye,ar=50;do{var lr=Tt*Tt,rr=(8*Tt-lr*(lr+2)-5)/(2*lr*(Tt-1)),hr=(3*Tt-lr*Tt-10)/(2*lr*Tt),kr=rr*rr,Yr=Tt*rr,$r=Tt+rr,xn=$r*$r,Rn=Tt+3*rr,Wn=xn*(lr+kr*yt-1)+(1-lr)*(lr*(Rn*Rn+4*kr)+kr*(12*Yr+4*kr)),ba=-2*$r*(4*Yr*kr+(1-4*lr+3*lr*lr)*(1+hr)+kr*(-6+14*lr-yt+(-8+8*lr-2*yt)*hr)+Yr*(-8+12*lr+(-10+10*lr-yt)*hr)),Wa=O(Wn),Ja=mt*(xn+kr-1)+2*Wa-st*(4*xn+yt),Qa=mt*(2*rr*hr+2*$r*(1+hr))+ba/Wa-8*$r*(mt*(-1+kr+xn)+2*Wa)*(1+hr)/(yt+4*xn);Tt-=qe=Ja/Qa}while(qe>v&&--ar>0);return[m(ze)*(O(mt*mt+4)+mt)*l/4,y*Tt]};function zs(){return k.geoProjection(dl).scale(127.16)}function xu(ze,Ye,qe,st,mt){function yt(Tt,ar){var lr=qe*x(st*ar),rr=O(1-lr*lr),hr=O(2/(1+rr*g(Tt*=mt)));return[ze*rr*hr*x(Tt),Ye*lr*hr]}return yt.invert=function(Tt,ar){var lr=Tt/ze,rr=ar/Ye,hr=O(lr*lr+rr*rr),kr=2*R(hr/2);return[p(Tt*M(kr),ze*hr)/mt,hr&&R(ar*x(kr)/(Ye*qe*hr))/st]},yt}function nf(ze,Ye,qe,st){var mt=l/3;ze=n(ze,v),Ye=n(Ye,v),ze=r(ze,y),Ye=r(Ye,l-v),qe=n(qe,0),qe=r(qe,100-v),st=n(st,v);var yt=qe/100+1,Tt=st/100,ar=z(yt*g(mt))/mt,lr=x(ze)/x(ar*y),rr=Ye/l,hr=O(Tt*x(ze/2)/x(Ye/2)),kr=hr/O(rr*lr*ar),Yr=1/(hr*O(rr*lr*ar));return xu(kr,Yr,lr,ar,rr)}function Bu(){var ze=65*o,Ye=60*o,qe=20,st=200,mt=k.geoProjectionMutator(nf),yt=mt(ze,Ye,qe,st);return yt.poleline=function(Tt){return arguments.length?mt(ze=+Tt*o,Ye,qe,st):ze*h},yt.parallels=function(Tt){return arguments.length?mt(ze,Ye=+Tt*o,qe,st):Ye*h},yt.inflation=function(Tt){return arguments.length?mt(ze,Ye,qe=+Tt,st):qe},yt.ratio=function(Tt){return arguments.length?mt(ze,Ye,qe,st=+Tt):st},yt.scale(163.775)}function xs(){return Bu().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)}var Ku=4*l+3*O(3),Nu=2*O(2*l*O(3)/Ku),Uu=de(Nu*O(3)/l,Nu,Ku/6);function yl(){return k.geoProjection(Uu).scale(176.84)}function bu(ze,Ye){return[ze*O(1-3*Ye*Ye/(l*l)),Ye]}bu.invert=function(ze,Ye){return[ze/O(1-3*Ye*Ye/(l*l)),Ye]};function af(){return k.geoProjection(bu).scale(152.63)}function su(ze,Ye){var qe=g(Ye),st=g(ze)*qe,mt=1-st,yt=g(ze=p(x(ze)*qe,-x(Ye))),Tt=x(ze);return qe=O(1-st*st),[Tt*qe-yt*mt,-yt*qe-Tt*mt]}su.invert=function(ze,Ye){var qe=(ze*ze+Ye*Ye)/-2,st=O(-qe*(2+qe)),mt=Ye*qe+ze*st,yt=ze*qe-Ye*st,Tt=O(yt*yt+mt*mt);return[p(st*mt,Tt*(1+qe)),Tt?-R(st*yt/Tt):0]};function Ju(){return k.geoProjection(su).rotate([0,-90,45]).scale(124.75).clipAngle(180-.001)}function Qu(ze,Ye){var qe=se(ze,Ye);return[(qe[0]+ze/y)/2,(qe[1]+Ye)/2]}Qu.invert=function(ze,Ye){var qe=ze,st=Ye,mt=25;do{var yt=g(st),Tt=x(st),ar=x(2*st),lr=Tt*Tt,rr=yt*yt,hr=x(qe),kr=g(qe/2),Yr=x(qe/2),$r=Yr*Yr,xn=1-rr*kr*kr,Rn=xn?z(yt*kr)*O(Wn=1/xn):Wn=0,Wn,ba=.5*(2*Rn*yt*Yr+qe/y)-ze,Wa=.5*(Rn*Tt+st)-Ye,Ja=.5*Wn*(rr*$r+Rn*yt*kr*lr)+.5/y,Qa=Wn*(hr*ar/4-Rn*Tt*Yr),ri=.125*Wn*(ar*Yr-Rn*Tt*rr*hr),yi=.5*Wn*(lr*kr+Rn*$r*yt)+.5,Xi=Qa*ri-yi*Ja,Ga=(Wa*Qa-ba*yi)/Xi,qi=(ba*ri-Wa*Ja)/Xi;qe-=Ga,st-=qi}while((E(Ga)>v||E(qi)>v)&&--mt>0);return[qe,st]};function es(){return k.geoProjection(Qu).scale(158.837)}b.geoNaturalEarth=k.geoNaturalEarth1,b.geoNaturalEarthRaw=k.geoNaturalEarth1Raw,b.geoAiry=oe,b.geoAiryRaw=X,b.geoAitoff=q,b.geoAitoffRaw=se,b.geoArmadillo=G,b.geoArmadilloRaw=K,b.geoAugust=V,b.geoAugustRaw=Q,b.geoBaker=W,b.geoBakerRaw=J,b.geoBerghaus=j,b.geoBerghausRaw=re,b.geoBertin1953=Ee,b.geoBertin1953Raw=xe,b.geoBoggs=Oe,b.geoBoggsRaw=ke,b.geoBonne=at,b.geoBonneRaw=Ie,b.geoBottomley=Rt,b.geoBottomleyRaw=pt,b.geoBromley=It,b.geoBromleyRaw=Mt,b.geoChamberlin=Pe,b.geoChamberlinRaw=it,b.geoChamberlinAfrica=et,b.geoCollignon=je,b.geoCollignonRaw=We,b.geoCraig=kt,b.geoCraigRaw=nt,b.geoCraster=qt,b.geoCrasterRaw=Vt,b.geoCylindricalEqualArea=Ht,b.geoCylindricalEqualAreaRaw=zt,b.geoCylindricalStereographic=Qt,b.geoCylindricalStereographicRaw=$t,b.geoEckert1=jr,b.geoEckert1Raw=fr,b.geoEckert2=Qr,b.geoEckert2Raw=cn,b.geoEckert3=Gt,b.geoEckert3Raw=lt,b.geoEckert4=Nt,b.geoEckert4Raw=Kt,b.geoEckert5=tt,b.geoEckert5Raw=gr,b.geoEckert6=Me,b.geoEckert6Raw=we,b.geoEisenlohr=Ke,b.geoEisenlohrRaw=Xe,b.geoFahey=vt,b.geoFaheyRaw=Je,b.geoFoucaut=Et,b.geoFoucautRaw=bt,b.geoFoucautSinusoidal=Ot,b.geoFoucautSinusoidalRaw=Wt,b.geoGilbert=_r,b.geoGingery=sn,b.geoGingeryRaw=ln,b.geoGinzburg4=Or,b.geoGinzburg4Raw=mr,b.geoGinzburg5=Sr,b.geoGinzburg5Raw=zr,b.geoGinzburg6=Lt,b.geoGinzburg6Raw=ot,b.geoGinzburg8=tr,b.geoGinzburg8Raw=Xt,b.geoGinzburg9=Nr,b.geoGinzburg9Raw=Lr,b.geoGringorten=Sn,b.geoGringortenRaw=Ar,b.geoGuyou=pi,b.geoGuyouRaw=ka,b.geoHammer=le,b.geoHammerRaw=Z,b.geoHammerRetroazimuthal=wr,b.geoHammerRetroazimuthalRaw=hi,b.geoHealpix=Ua,b.geoHealpixRaw=Vn,b.geoHill=Ft,b.geoHillRaw=di,b.geoHomolosine=_n,b.geoHomolosineRaw=Cn,b.geoHufnagel=dr,b.geoHufnagelRaw=un,b.geoHyperelliptical=Un,b.geoHyperellipticalRaw=dn,b.geoInterrupt=sa,b.geoInterruptedBoggs=wa,b.geoInterruptedHomolosine=Aa,b.geoInterruptedMollweide=So,b.geoInterruptedMollweideHemispheres=cs,b.geoInterruptedSinuMollweide=Tl,b.geoInterruptedSinusoidal=hs,b.geoKavrayskiy7=no,b.geoKavrayskiy7Raw=Gs,b.geoLagrange=Fl,b.geoLagrangeRaw=ko,b.geoLarrivee=Ys,b.geoLarriveeRaw=ao,b.geoLaskowski=Si,b.geoLaskowskiRaw=io,b.geoLittrow=oo,b.geoLittrowRaw=Eo,b.geoLoximuthal=Go,b.geoLoximuthalRaw=$o,b.geoMiller=Yo,b.geoMillerRaw=Al,b.geoModifiedStereographic=Ts,b.geoModifiedStereographicRaw=Eu,b.geoModifiedStereographicAlaska=Ol,b.geoModifiedStereographicGs48=Cu,b.geoModifiedStereographicGs50=Lu,b.geoModifiedStereographicMiller=Xs,b.geoModifiedStereographicLee=Bl,b.geoMollweide=Le,b.geoMollweideRaw=be,b.geoMtFlatPolarParabolic=Pu,b.geoMtFlatPolarParabolicRaw=$l,b.geoMtFlatPolarQuartic=Zu,b.geoMtFlatPolarQuarticRaw=ql,b.geoMtFlatPolarSinusoidal=Nl,b.geoMtFlatPolarSinusoidalRaw=Zs,b.geoNaturalEarth2=ol,b.geoNaturalEarth2Raw=Ml,b.geoNellHammer=eu,b.geoNellHammerRaw=Sl,b.geoInterruptedQuarticAuthalic=gu,b.geoNicolosi=Du,b.geoNicolosiRaw=tu,b.geoPatterson=ho,b.geoPattersonRaw=As,b.geoPolyconic=Ru,b.geoPolyconicRaw=ll,b.geoPolyhedral=ul,b.geoPolyhedralButterfly=Ll,b.geoPolyhedralCollignon=ju,b.geoPolyhedralWaterman=Vi,b.geoProject=qo,b.geoGringortenQuincuncial=gt,b.geoPeirceQuincuncial=Dt,b.geoPierceQuincuncial=Dt,b.geoQuantize=or,b.geoQuincuncial=mu,b.geoRectangularPolyconic=Er,b.geoRectangularPolyconicRaw=er,b.geoRobinson=An,b.geoRobinsonRaw=pn,b.geoSatellite=yn,b.geoSatelliteRaw=Hn,b.geoSinuMollweide=on,b.geoSinuMollweideRaw=vn,b.geoSinusoidal=Ue,b.geoSinusoidalRaw=Ve,b.geoStitch=ti,b.geoTimes=Ai,b.geoTimesRaw=pa,b.geoTwoPointAzimuthal=Ss,b.geoTwoPointAzimuthalRaw=xo,b.geoTwoPointAzimuthalUsa=ss,b.geoTwoPointEquidistant=gs,b.geoTwoPointEquidistantRaw=ls,b.geoTwoPointEquidistantUsa=hl,b.geoVanDerGrinten=Is,b.geoVanDerGrintenRaw=ys,b.geoVanDerGrinten2=pl,b.geoVanDerGrinten2Raw=vl,b.geoVanDerGrinten3=Ou,b.geoVanDerGrinten3Raw=ms,b.geoVanDerGrinten4=zs,b.geoVanDerGrinten4Raw=dl,b.geoWagner=Bu,b.geoWagner7=xs,b.geoWagnerRaw=nf,b.geoWagner4=yl,b.geoWagner4Raw=Uu,b.geoWagner6=af,b.geoWagner6Raw=bu,b.geoWiechel=Ju,b.geoWiechelRaw=su,b.geoWinkel3=es,b.geoWinkel3Raw=Qu,Object.defineProperty(b,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie,c("d3-array")):typeof Vr=="function"&&Vr.amd?Vr(["exports","d3-array"],k):(b=b||self,k(b.d3=b.d3||{},b.d3))})(this,function(b,k){"use strict";function P(){return new E}function E(){this.reset()}E.prototype={constructor:E,reset:function(){this.s=this.t=0},add:function(gt){p(e,gt,this.t),p(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new E;function p(gt,Dt,or){var er=gt.s=Dt+or,Er=er-Dt,en=er-Er;gt.t=Dt-en+(or-Er)}var g=1e-6,a=1e-12,t=Math.PI,i=t/2,n=t/4,r=t*2,d=180/t,s=t/180,m=Math.abs,x=Math.atan,M=Math.atan2,v=Math.cos,_=Math.ceil,l=Math.exp,y=Math.log,T=Math.pow,w=Math.sin,A=Math.sign||function(gt){return gt>0?1:gt<0?-1:0},f=Math.sqrt,u=Math.tan;function h(gt){return gt>1?0:gt<-1?t:Math.acos(gt)}function o(gt){return gt>1?i:gt<-1?-i:Math.asin(gt)}function S(gt){return(gt=w(gt/2))*gt}function R(){}function z(gt,Dt){gt&&I.hasOwnProperty(gt.type)&&I[gt.type](gt,Dt)}var O={Feature:function(gt,Dt){z(gt.geometry,Dt)},FeatureCollection:function(gt,Dt){for(var or=gt.features,er=-1,Er=or.length;++er<Er;)z(or[er].geometry,Dt)}},I={Sphere:function(gt,Dt){Dt.sphere()},Point:function(gt,Dt){gt=gt.coordinates,Dt.point(gt[0],gt[1],gt[2])},MultiPoint:function(gt,Dt){for(var or=gt.coordinates,er=-1,Er=or.length;++er<Er;)gt=or[er],Dt.point(gt[0],gt[1],gt[2])},LineString:function(gt,Dt){F(gt.coordinates,Dt,0)},MultiLineString:function(gt,Dt){for(var or=gt.coordinates,er=-1,Er=or.length;++er<Er;)F(or[er],Dt,0)},Polygon:function(gt,Dt){D(gt.coordinates,Dt)},MultiPolygon:function(gt,Dt){for(var or=gt.coordinates,er=-1,Er=or.length;++er<Er;)D(or[er],Dt)},GeometryCollection:function(gt,Dt){for(var or=gt.geometries,er=-1,Er=or.length;++er<Er;)z(or[er],Dt)}};function F(gt,Dt,or){var er=-1,Er=gt.length-or,en;for(Dt.lineStart();++er<Er;)en=gt[er],Dt.point(en[0],en[1],en[2]);Dt.lineEnd()}function D(gt,Dt){var or=-1,er=gt.length;for(Dt.polygonStart();++or<er;)F(gt[or],Dt,1);Dt.polygonEnd()}function B(gt,Dt){gt&&O.hasOwnProperty(gt.type)?O[gt.type](gt,Dt):z(gt,Dt)}var U=P(),X=P(),oe,se,q,K,G,Q={point:R,lineStart:R,lineEnd:R,polygonStart:function(){U.reset(),Q.lineStart=V,Q.lineEnd=H},polygonEnd:function(){var gt=+U;X.add(gt<0?r+gt:gt),this.lineStart=this.lineEnd=this.point=R},sphere:function(){X.add(r)}};function V(){Q.point=ee}function H(){J(oe,se)}function ee(gt,Dt){Q.point=J,oe=gt,se=Dt,gt*=s,Dt*=s,q=gt,K=v(Dt=Dt/2+n),G=w(Dt)}function J(gt,Dt){gt*=s,Dt*=s,Dt=Dt/2+n;var or=gt-q,er=or>=0?1:-1,Er=er*or,en=v(Dt),pn=w(Dt),An=G*pn,Ln=K*en+An*v(Er),Hn=An*er*w(Er);U.add(M(Hn,Ln)),q=gt,K=en,G=pn}function W(gt){return X.reset(),B(gt,Q),X*2}function re(gt){return[M(gt[1],gt[0]),o(gt[2])]}function j(gt){var Dt=gt[0],or=gt[1],er=v(or);return[er*v(Dt),er*w(Dt),w(or)]}function Z(gt,Dt){return gt[0]*Dt[0]+gt[1]*Dt[1]+gt[2]*Dt[2]}function ne(gt,Dt){return[gt[1]*Dt[2]-gt[2]*Dt[1],gt[2]*Dt[0]-gt[0]*Dt[2],gt[0]*Dt[1]-gt[1]*Dt[0]]}function le(gt,Dt){gt[0]+=Dt[0],gt[1]+=Dt[1],gt[2]+=Dt[2]}function ge(gt,Dt){return[gt[0]*Dt,gt[1]*Dt,gt[2]*Dt]}function pe(gt){var Dt=f(gt[0]*gt[0]+gt[1]*gt[1]+gt[2]*gt[2]);gt[0]/=Dt,gt[1]/=Dt,gt[2]/=Dt}var xe,Ee,Te,de,be,Le,De,ye,ke=P(),Oe,Qe,Ve={point:Ue,lineStart:at,lineEnd:pt,polygonStart:function(){Ve.point=Rt,Ve.lineStart=Mt,Ve.lineEnd=It,ke.reset(),Q.polygonStart()},polygonEnd:function(){Q.polygonEnd(),Ve.point=Ue,Ve.lineStart=at,Ve.lineEnd=pt,U<0?(xe=-(Te=180),Ee=-(de=90)):ke>g?de=90:ke<-g&&(Ee=-90),Qe[0]=xe,Qe[1]=Te},sphere:function(){xe=-(Te=180),Ee=-(de=90)}};function Ue(gt,Dt){Oe.push(Qe=[xe=gt,Te=gt]),Dt<Ee&&(Ee=Dt),Dt>de&&(de=Dt)}function Ie(gt,Dt){var or=j([gt*s,Dt*s]);if(ye){var er=ne(ye,or),Er=[er[1],-er[0],0],en=ne(Er,er);pe(en),en=re(en);var pn=gt-be,An=pn>0?1:-1,Ln=en[0]*d*An,Hn,yn=m(pn)>180;yn^(An*be<Ln&&Ln<An*gt)?(Hn=en[1]*d,Hn>de&&(de=Hn)):(Ln=(Ln+360)%360-180,yn^(An*be<Ln&&Ln<An*gt)?(Hn=-en[1]*d,Hn<Ee&&(Ee=Hn)):(Dt<Ee&&(Ee=Dt),Dt>de&&(de=Dt))),yn?gt<be?Bt(xe,gt)>Bt(xe,Te)&&(Te=gt):Bt(gt,Te)>Bt(xe,Te)&&(xe=gt):Te>=xe?(gt<xe&&(xe=gt),gt>Te&&(Te=gt)):gt>be?Bt(xe,gt)>Bt(xe,Te)&&(Te=gt):Bt(gt,Te)>Bt(xe,Te)&&(xe=gt)}else Oe.push(Qe=[xe=gt,Te=gt]);Dt<Ee&&(Ee=Dt),Dt>de&&(de=Dt),ye=or,be=gt}function at(){Ve.point=Ie}function pt(){Qe[0]=xe,Qe[1]=Te,Ve.point=Ue,ye=null}function Rt(gt,Dt){if(ye){var or=gt-be;ke.add(m(or)>180?or+(or>0?360:-360):or)}else Le=gt,De=Dt;Q.point(gt,Dt),Ie(gt,Dt)}function Mt(){Q.lineStart()}function It(){Rt(Le,De),Q.lineEnd(),m(ke)>g&&(xe=-(Te=180)),Qe[0]=xe,Qe[1]=Te,ye=null}function Bt(gt,Dt){return(Dt-=gt)<0?Dt+360:Dt}function St(gt,Dt){return gt[0]-Dt[0]}function _t(gt,Dt){return gt[0]<=gt[1]?gt[0]<=Dt&&Dt<=gt[1]:Dt<gt[0]||gt[1]<Dt}function it(gt){var Dt,or,er,Er,en,pn,An;if(de=Te=-(xe=Ee=1/0),Oe=[],B(gt,Ve),or=Oe.length){for(Oe.sort(St),Dt=1,er=Oe[0],en=[er];Dt<or;++Dt)Er=Oe[Dt],_t(er,Er[0])||_t(er,Er[1])?(Bt(er[0],Er[1])>Bt(er[0],er[1])&&(er[1]=Er[1]),Bt(Er[0],er[1])>Bt(er[0],er[1])&&(er[0]=Er[0])):en.push(er=Er);for(pn=-1/0,or=en.length-1,Dt=0,er=en[or];Dt<=or;er=Er,++Dt)Er=en[Dt],(An=Bt(er[1],Er[0]))>pn&&(pn=An,xe=Er[0],Te=er[1])}return Oe=Qe=null,xe===1/0||Ee===1/0?[[NaN,NaN],[NaN,NaN]]:[[xe,Ee],[Te,de]]}var ct,et,Pe,We,je,nt,kt,wt,Vt,qt,zt,Ht,$t,Qt,fr,jr,cn={sphere:R,point:Qr,lineStart:Gt,lineEnd:gr,polygonStart:function(){cn.lineStart=tt,cn.lineEnd=we},polygonEnd:function(){cn.lineStart=Gt,cn.lineEnd=gr}};function Qr(gt,Dt){gt*=s,Dt*=s;var or=v(Dt);lt(or*v(gt),or*w(gt),w(Dt))}function lt(gt,Dt,or){++ct,Pe+=(gt-Pe)/ct,We+=(Dt-We)/ct,je+=(or-je)/ct}function Gt(){cn.point=Kt}function Kt(gt,Dt){gt*=s,Dt*=s;var or=v(Dt);Qt=or*v(gt),fr=or*w(gt),jr=w(Dt),cn.point=Nt,lt(Qt,fr,jr)}function Nt(gt,Dt){gt*=s,Dt*=s;var or=v(Dt),er=or*v(gt),Er=or*w(gt),en=w(Dt),pn=M(f((pn=fr*en-jr*Er)*pn+(pn=jr*er-Qt*en)*pn+(pn=Qt*Er-fr*er)*pn),Qt*er+fr*Er+jr*en);et+=pn,nt+=pn*(Qt+(Qt=er)),kt+=pn*(fr+(fr=Er)),wt+=pn*(jr+(jr=en)),lt(Qt,fr,jr)}function gr(){cn.point=Qr}function tt(){cn.point=Me}function we(){Ne(Ht,$t),cn.point=Qr}function Me(gt,Dt){Ht=gt,$t=Dt,gt*=s,Dt*=s,cn.point=Ne;var or=v(Dt);Qt=or*v(gt),fr=or*w(gt),jr=w(Dt),lt(Qt,fr,jr)}function Ne(gt,Dt){gt*=s,Dt*=s;var or=v(Dt),er=or*v(gt),Er=or*w(gt),en=w(Dt),pn=fr*en-jr*Er,An=jr*er-Qt*en,Ln=Qt*Er-fr*er,Hn=f(pn*pn+An*An+Ln*Ln),yn=o(Hn),Fn=Hn&&-yn/Hn;Vt+=Fn*pn,qt+=Fn*An,zt+=Fn*Ln,et+=yn,nt+=yn*(Qt+(Qt=er)),kt+=yn*(fr+(fr=Er)),wt+=yn*(jr+(jr=en)),lt(Qt,fr,jr)}function Xe(gt){ct=et=Pe=We=je=nt=kt=wt=Vt=qt=zt=0,B(gt,cn);var Dt=Vt,or=qt,er=zt,Er=Dt*Dt+or*or+er*er;return Er<a&&(Dt=nt,or=kt,er=wt,et<g&&(Dt=Pe,or=We,er=je),Er=Dt*Dt+or*or+er*er,Er<a)?[NaN,NaN]:[M(or,Dt)*d,o(er/f(Er))*d]}function Ke(gt){return function(){return gt}}function rt(gt,Dt){function or(er,Er){return er=gt(er,Er),Dt(er[0],er[1])}return gt.invert&&Dt.invert&&(or.invert=function(er,Er){return er=Dt.invert(er,Er),er&&gt.invert(er[0],er[1])}),or}function Je(gt,Dt){return[m(gt)>t?gt+Math.round(-gt/r)*r:gt,Dt]}Je.invert=Je;function vt(gt,Dt,or){return(gt%=r)?Dt||or?rt(Et(gt),Wt(Dt,or)):Et(gt):Dt||or?Wt(Dt,or):Je}function bt(gt){return function(Dt,or){return Dt+=gt,[Dt>t?Dt-r:Dt<-t?Dt+r:Dt,or]}}function Et(gt){var Dt=bt(gt);return Dt.invert=bt(-gt),Dt}function Wt(gt,Dt){var or=v(gt),er=w(gt),Er=v(Dt),en=w(Dt);function pn(An,Ln){var Hn=v(Ln),yn=v(An)*Hn,Fn=w(An)*Hn,Pn=w(Ln),Gn=Pn*or+yn*er;return[M(Fn*Er-Gn*en,yn*or-Pn*er),o(Gn*Er+Fn*en)]}return pn.invert=function(An,Ln){var Hn=v(Ln),yn=v(An)*Hn,Fn=w(An)*Hn,Pn=w(Ln),Gn=Pn*Er-Fn*en;return[M(Fn*Er+Pn*en,yn*or+Gn*er),o(Gn*or-yn*er)]},pn}function Ot(gt){gt=vt(gt[0]*s,gt[1]*s,gt.length>2?gt[2]*s:0);function Dt(or){return or=gt(or[0]*s,or[1]*s),or[0]*=d,or[1]*=d,or}return Dt.invert=function(or){return or=gt.invert(or[0]*s,or[1]*s),or[0]*=d,or[1]*=d,or},Dt}function ir(gt,Dt,or,er,Er,en){if(!!or){var pn=v(Dt),An=w(Dt),Ln=er*or;Er==null?(Er=Dt+er*r,en=Dt-Ln/2):(Er=vr(pn,Er),en=vr(pn,en),(er>0?Er<en:Er>en)&&(Er+=er*r));for(var Hn,yn=Er;er>0?yn>en:yn<en;yn-=Ln)Hn=re([pn,-An*v(yn),-An*w(yn)]),gt.point(Hn[0],Hn[1])}}function vr(gt,Dt){Dt=j(Dt),Dt[0]-=gt,pe(Dt);var or=h(-Dt[1]);return((-Dt[2]<0?-or:or)+r-g)%r}function _r(){var gt=Ke([0,0]),Dt=Ke(90),or=Ke(6),er,Er,en={point:pn};function pn(Ln,Hn){er.push(Ln=Er(Ln,Hn)),Ln[0]*=d,Ln[1]*=d}function An(){var Ln=gt.apply(this,arguments),Hn=Dt.apply(this,arguments)*s,yn=or.apply(this,arguments)*s;return er=[],Er=vt(-Ln[0]*s,-Ln[1]*s,0).invert,ir(en,Hn,yn,1),Ln={type:"Polygon",coordinates:[er]},er=Er=null,Ln}return An.center=function(Ln){return arguments.length?(gt=typeof Ln=="function"?Ln:Ke([+Ln[0],+Ln[1]]),An):gt},An.radius=function(Ln){return arguments.length?(Dt=typeof Ln=="function"?Ln:Ke(+Ln),An):Dt},An.precision=function(Ln){return arguments.length?(or=typeof Ln=="function"?Ln:Ke(+Ln),An):or},An}function ln(){var gt=[],Dt;return{point:function(or,er,Er){Dt.push([or,er,Er])},lineStart:function(){gt.push(Dt=[])},lineEnd:R,rejoin:function(){gt.length>1&&gt.push(gt.pop().concat(gt.shift()))},result:function(){var or=gt;return gt=[],Dt=null,or}}}function Cr(gt,Dt){return m(gt[0]-Dt[0])<g&&m(gt[1]-Dt[1])<g}function Gr(gt,Dt,or,er){this.x=gt,this.z=Dt,this.o=or,this.e=er,this.v=!1,this.n=this.p=null}function sn(gt,Dt,or,er,Er){var en=[],pn=[],An,Ln;if(gt.forEach(function($n){if(!((Ha=$n.length-1)<=0)){var Ha,La=$n[0],Fa=$n[Ha],Na;if(Cr(La,Fa)){if(!La[2]&&!Fa[2]){for(Er.lineStart(),An=0;An<Ha;++An)Er.point((La=$n[An])[0],La[1]);Er.lineEnd();return}Fa[0]+=2*g}en.push(Na=new Gr(La,$n,null,!0)),pn.push(Na.o=new Gr(La,null,Na,!1)),en.push(Na=new Gr(Fa,$n,null,!1)),pn.push(Na.o=new Gr(Fa,null,Na,!0))}}),!!en.length){for(pn.sort(Dt),yr(en),yr(pn),An=0,Ln=pn.length;An<Ln;++An)pn[An].e=or=!or;for(var Hn=en[0],yn,Fn;;){for(var Pn=Hn,Gn=!0;Pn.v;)if((Pn=Pn.n)===Hn)return;yn=Pn.z,Er.lineStart();do{if(Pn.v=Pn.o.v=!0,Pn.e){if(Gn)for(An=0,Ln=yn.length;An<Ln;++An)Er.point((Fn=yn[An])[0],Fn[1]);else er(Pn.x,Pn.n.x,1,Er);Pn=Pn.n}else{if(Gn)for(yn=Pn.p.z,An=yn.length-1;An>=0;--An)Er.point((Fn=yn[An])[0],Fn[1]);else er(Pn.x,Pn.p.x,-1,Er);Pn=Pn.p}Pn=Pn.o,yn=Pn.z,Gn=!Gn}while(!Pn.v);Er.lineEnd()}}}function yr(gt){if(!!(Dt=gt.length)){for(var Dt,or=0,er=gt[0],Er;++or<Dt;)er.n=Er=gt[or],Er.p=er,er=Er;er.n=Er=gt[0],Er.p=er}}var mr=P();function Or(gt){return m(gt[0])<=t?gt[0]:A(gt[0])*((m(gt[0])+t)%r-t)}function zr(gt,Dt){var or=Or(Dt),er=Dt[1],Er=w(er),en=[w(or),-v(or),0],pn=0,An=0;mr.reset(),Er===1?er=i+g:Er===-1&&(er=-i-g);for(var Ln=0,Hn=gt.length;Ln<Hn;++Ln)if(!!(Fn=(yn=gt[Ln]).length))for(var yn,Fn,Pn=yn[Fn-1],Gn=Or(Pn),$n=Pn[1]/2+n,Ha=w($n),La=v($n),Fa=0;Fa<Fn;++Fa,Gn=qn,Ha=ja,La=qa,Pn=Na){var Na=yn[Fa],qn=Or(Na),va=Na[1]/2+n,ja=w(va),qa=v(va),Ti=qn-Gn,xi=Ti>=0?1:-1,bi=xi*Ti,Di=bi>t,li=Ha*ja;if(mr.add(M(li*xi*w(bi),La*qa+li*v(bi))),pn+=Di?Ti+xi*r:Ti,Di^Gn>=or^qn>=or){var To=ne(j(Pn),j(Na));pe(To);var so=ne(en,To);pe(so);var ti=(Di^Ti>=0?-1:1)*o(so[2]);(er>ti||er===ti&&(To[0]||To[1]))&&(An+=Di^Ti>=0?1:-1)}}return(pn<-g||pn<g&&mr<-g)^An&1}function Sr(gt,Dt,or,er){return function(Er){var en=Dt(Er),pn=ln(),An=Dt(pn),Ln=!1,Hn,yn,Fn,Pn={point:Gn,lineStart:Ha,lineEnd:La,polygonStart:function(){Pn.point=Fa,Pn.lineStart=Na,Pn.lineEnd=qn,yn=[],Hn=[]},polygonEnd:function(){Pn.point=Gn,Pn.lineStart=Ha,Pn.lineEnd=La,yn=k.merge(yn);var va=zr(Hn,er);yn.length?(Ln||(Er.polygonStart(),Ln=!0),sn(yn,Lt,va,or,Er)):va&&(Ln||(Er.polygonStart(),Ln=!0),Er.lineStart(),or(null,null,1,Er),Er.lineEnd()),Ln&&(Er.polygonEnd(),Ln=!1),yn=Hn=null},sphere:function(){Er.polygonStart(),Er.lineStart(),or(null,null,1,Er),Er.lineEnd(),Er.polygonEnd()}};function Gn(va,ja){gt(va,ja)&&Er.point(va,ja)}function $n(va,ja){en.point(va,ja)}function Ha(){Pn.point=$n,en.lineStart()}function La(){Pn.point=Gn,en.lineEnd()}function Fa(va,ja){Fn.push([va,ja]),An.point(va,ja)}function Na(){An.lineStart(),Fn=[]}function qn(){Fa(Fn[0][0],Fn[0][1]),An.lineEnd();var va=An.clean(),ja=pn.result(),qa,Ti=ja.length,xi,bi,Di;if(Fn.pop(),Hn.push(Fn),Fn=null,!!Ti){if(va&1){if(bi=ja[0],(xi=bi.length-1)>0){for(Ln||(Er.polygonStart(),Ln=!0),Er.lineStart(),qa=0;qa<xi;++qa)Er.point((Di=bi[qa])[0],Di[1]);Er.lineEnd()}return}Ti>1&&va&2&&ja.push(ja.pop().concat(ja.shift())),yn.push(ja.filter(ot))}}return Pn}}function ot(gt){return gt.length>1}function Lt(gt,Dt){return((gt=gt.x)[0]<0?gt[1]-i-g:i-gt[1])-((Dt=Dt.x)[0]<0?Dt[1]-i-g:i-Dt[1])}var Xt=Sr(function(){return!0},tr,Nr,[-t,-i]);function tr(gt){var Dt=NaN,or=NaN,er=NaN,Er;return{lineStart:function(){gt.lineStart(),Er=1},point:function(en,pn){var An=en>0?t:-t,Ln=m(en-Dt);m(Ln-t)<g?(gt.point(Dt,or=(or+pn)/2>0?i:-i),gt.point(er,or),gt.lineEnd(),gt.lineStart(),gt.point(An,or),gt.point(en,or),Er=0):er!==An&&Ln>=t&&(m(Dt-er)<g&&(Dt-=er*g),m(en-An)<g&&(en-=An*g),or=Lr(Dt,or,en,pn),gt.point(er,or),gt.lineEnd(),gt.lineStart(),gt.point(An,or),Er=0),gt.point(Dt=en,or=pn),er=An},lineEnd:function(){gt.lineEnd(),Dt=or=NaN},clean:function(){return 2-Er}}}function Lr(gt,Dt,or,er){var Er,en,pn=w(gt-or);return m(pn)>g?x((w(Dt)*(en=v(er))*w(or)-w(er)*(Er=v(Dt))*w(gt))/(Er*en*pn)):(Dt+er)/2}function Nr(gt,Dt,or,er){var Er;if(gt==null)Er=or*i,er.point(-t,Er),er.point(0,Er),er.point(t,Er),er.point(t,0),er.point(t,-Er),er.point(0,-Er),er.point(-t,-Er),er.point(-t,0),er.point(-t,Er);else if(m(gt[0]-Dt[0])>g){var en=gt[0]<Dt[0]?t:-t;Er=or*en/2,er.point(-en,Er),er.point(0,Er),er.point(en,Er)}else er.point(Dt[0],Dt[1])}function Rr(gt){var Dt=v(gt),or=6*s,er=Dt>0,Er=m(Dt)>g;function en(yn,Fn,Pn,Gn){ir(Gn,gt,or,Pn,yn,Fn)}function pn(yn,Fn){return v(yn)*v(Fn)>Dt}function An(yn){var Fn,Pn,Gn,$n,Ha;return{lineStart:function(){$n=Gn=!1,Ha=1},point:function(La,Fa){var Na=[La,Fa],qn,va=pn(La,Fa),ja=er?va?0:Hn(La,Fa):va?Hn(La+(La<0?t:-t),Fa):0;if(!Fn&&($n=Gn=va)&&yn.lineStart(),va!==Gn&&(qn=Ln(Fn,Na),(!qn||Cr(Fn,qn)||Cr(Na,qn))&&(Na[2]=1)),va!==Gn)Ha=0,va?(yn.lineStart(),qn=Ln(Na,Fn),yn.point(qn[0],qn[1])):(qn=Ln(Fn,Na),yn.point(qn[0],qn[1],2),yn.lineEnd()),Fn=qn;else if(Er&&Fn&&er^va){var qa;!(ja&Pn)&&(qa=Ln(Na,Fn,!0))&&(Ha=0,er?(yn.lineStart(),yn.point(qa[0][0],qa[0][1]),yn.point(qa[1][0],qa[1][1]),yn.lineEnd()):(yn.point(qa[1][0],qa[1][1]),yn.lineEnd(),yn.lineStart(),yn.point(qa[0][0],qa[0][1],3)))}va&&(!Fn||!Cr(Fn,Na))&&yn.point(Na[0],Na[1]),Fn=Na,Gn=va,Pn=ja},lineEnd:function(){Gn&&yn.lineEnd(),Fn=null},clean:function(){return Ha|($n&&Gn)<<1}}}function Ln(yn,Fn,Pn){var Gn=j(yn),$n=j(Fn),Ha=[1,0,0],La=ne(Gn,$n),Fa=Z(La,La),Na=La[0],qn=Fa-Na*Na;if(!qn)return!Pn&&yn;var va=Dt*Fa/qn,ja=-Dt*Na/qn,qa=ne(Ha,La),Ti=ge(Ha,va),xi=ge(La,ja);le(Ti,xi);var bi=qa,Di=Z(Ti,bi),li=Z(bi,bi),To=Di*Di-li*(Z(Ti,Ti)-1);if(!(To<0)){var so=f(To),ti=ge(bi,(-Di-so)/li);if(le(ti,Ti),ti=re(ti),!Pn)return ti;var pa=yn[0],Ai=Fn[0],vo=yn[1],xo=Fn[1],ss;Ai<pa&&(ss=pa,pa=Ai,Ai=ss);var Ss=Ai-pa,ls=m(Ss-t)<g,hl=ls||Ss<g;if(!ls&&xo<vo&&(ss=vo,vo=xo,xo=ss),hl?ls?vo+xo>0^ti[1]<(m(ti[0]-pa)<g?vo:xo):vo<=ti[1]&&ti[1]<=xo:Ss>t^(pa<=ti[0]&&ti[0]<=Ai)){var gs=ge(bi,(-Di+so)/li);return le(gs,Ti),[ti,re(gs)]}}}function Hn(yn,Fn){var Pn=er?gt:t-gt,Gn=0;return yn<-Pn?Gn|=1:yn>Pn&&(Gn|=2),Fn<-Pn?Gn|=4:Fn>Pn&&(Gn|=8),Gn}return Sr(pn,An,en,er?[0,-gt]:[-t,gt-t])}function Ar(gt,Dt,or,er,Er,en){var pn=gt[0],An=gt[1],Ln=Dt[0],Hn=Dt[1],yn=0,Fn=1,Pn=Ln-pn,Gn=Hn-An,$n;if($n=or-pn,!(!Pn&&$n>0)){if($n/=Pn,Pn<0){if($n<yn)return;$n<Fn&&(Fn=$n)}else if(Pn>0){if($n>Fn)return;$n>yn&&(yn=$n)}if($n=Er-pn,!(!Pn&&$n<0)){if($n/=Pn,Pn<0){if($n>Fn)return;$n>yn&&(yn=$n)}else if(Pn>0){if($n<yn)return;$n<Fn&&(Fn=$n)}if($n=er-An,!(!Gn&&$n>0)){if($n/=Gn,Gn<0){if($n<yn)return;$n<Fn&&(Fn=$n)}else if(Gn>0){if($n>Fn)return;$n>yn&&(yn=$n)}if($n=en-An,!(!Gn&&$n<0)){if($n/=Gn,Gn<0){if($n>Fn)return;$n>yn&&(yn=$n)}else if(Gn>0){if($n<yn)return;$n<Fn&&(Fn=$n)}return yn>0&&(gt[0]=pn+yn*Pn,gt[1]=An+yn*Gn),Fn<1&&(Dt[0]=pn+Fn*Pn,Dt[1]=An+Fn*Gn),!0}}}}}var Kr=1e9,Dn=-Kr;function Sn(gt,Dt,or,er){function Er(Hn,yn){return gt<=Hn&&Hn<=or&&Dt<=yn&&yn<=er}function en(Hn,yn,Fn,Pn){var Gn=0,$n=0;if(Hn==null||(Gn=pn(Hn,Fn))!==($n=pn(yn,Fn))||Ln(Hn,yn)<0^Fn>0)do Pn.point(Gn===0||Gn===3?gt:or,Gn>1?er:Dt);while((Gn=(Gn+Fn+4)%4)!==$n);else Pn.point(yn[0],yn[1])}function pn(Hn,yn){return m(Hn[0]-gt)<g?yn>0?0:3:m(Hn[0]-or)<g?yn>0?2:1:m(Hn[1]-Dt)<g?yn>0?1:0:yn>0?3:2}function An(Hn,yn){return Ln(Hn.x,yn.x)}function Ln(Hn,yn){var Fn=pn(Hn,1),Pn=pn(yn,1);return Fn!==Pn?Fn-Pn:Fn===0?yn[1]-Hn[1]:Fn===1?Hn[0]-yn[0]:Fn===2?Hn[1]-yn[1]:yn[0]-Hn[0]}return function(Hn){var yn=Hn,Fn=ln(),Pn,Gn,$n,Ha,La,Fa,Na,qn,va,ja,qa,Ti={point:xi,lineStart:To,lineEnd:so,polygonStart:Di,polygonEnd:li};function xi(pa,Ai){Er(pa,Ai)&&yn.point(pa,Ai)}function bi(){for(var pa=0,Ai=0,vo=Gn.length;Ai<vo;++Ai)for(var xo=Gn[Ai],ss=1,Ss=xo.length,ls=xo[0],hl,gs,ys=ls[0],Is=ls[1];ss<Ss;++ss)hl=ys,gs=Is,ls=xo[ss],ys=ls[0],Is=ls[1],gs<=er?Is>er&&(ys-hl)*(er-gs)>(Is-gs)*(gt-hl)&&++pa:Is<=er&&(ys-hl)*(er-gs)<(Is-gs)*(gt-hl)&&--pa;return pa}function Di(){yn=Fn,Pn=[],Gn=[],qa=!0}function li(){var pa=bi(),Ai=qa&&pa,vo=(Pn=k.merge(Pn)).length;(Ai||vo)&&(Hn.polygonStart(),Ai&&(Hn.lineStart(),en(null,null,1,Hn),Hn.lineEnd()),vo&&sn(Pn,An,pa,en,Hn),Hn.polygonEnd()),yn=Hn,Pn=Gn=$n=null}function To(){Ti.point=ti,Gn&&Gn.push($n=[]),ja=!0,va=!1,Na=qn=NaN}function so(){Pn&&(ti(Ha,La),Fa&&va&&Fn.rejoin(),Pn.push(Fn.result())),Ti.point=xi,va&&yn.lineEnd()}function ti(pa,Ai){var vo=Er(pa,Ai);if(Gn&&$n.push([pa,Ai]),ja)Ha=pa,La=Ai,Fa=vo,ja=!1,vo&&(yn.lineStart(),yn.point(pa,Ai));else if(vo&&va)yn.point(pa,Ai);else{var xo=[Na=Math.max(Dn,Math.min(Kr,Na)),qn=Math.max(Dn,Math.min(Kr,qn))],ss=[pa=Math.max(Dn,Math.min(Kr,pa)),Ai=Math.max(Dn,Math.min(Kr,Ai))];Ar(xo,ss,gt,Dt,or,er)?(va||(yn.lineStart(),yn.point(xo[0],xo[1])),yn.point(ss[0],ss[1]),vo||yn.lineEnd(),qa=!1):vo&&(yn.lineStart(),yn.point(pa,Ai),qa=!1)}Na=pa,qn=Ai,va=vo}return Ti}}function Jn(){var gt=0,Dt=0,or=960,er=500,Er,en,pn;return pn={stream:function(An){return Er&&en===An?Er:Er=Sn(gt,Dt,or,er)(en=An)},extent:function(An){return arguments.length?(gt=+An[0][0],Dt=+An[0][1],or=+An[1][0],er=+An[1][1],Er=en=null,pn):[[gt,Dt],[or,er]]}}}var Bn=P(),Xn,ea,ka,Ya={sphere:R,point:R,lineStart:fi,lineEnd:R,polygonStart:R,polygonEnd:R};function fi(){Ya.point=hi,Ya.lineEnd=pi}function pi(){Ya.point=Ya.lineEnd=R}function hi(gt,Dt){gt*=s,Dt*=s,Xn=gt,ea=w(Dt),ka=v(Dt),Ya.point=Ka}function Ka(gt,Dt){gt*=s,Dt*=s;var or=w(Dt),er=v(Dt),Er=m(gt-Xn),en=v(Er),pn=w(Er),An=er*pn,Ln=ka*or-ea*er*en,Hn=ea*or+ka*er*en;Bn.add(M(f(An*An+Ln*Ln),Hn)),Xn=gt,ea=or,ka=er}function wr(gt){return Bn.reset(),B(gt,Ya),+Bn}var gn=[null,null],hn={type:"LineString",coordinates:gn};function Tn(gt,Dt){return gn[0]=gt,gn[1]=Dt,wr(hn)}var Vn={Feature:function(gt,Dt){return na(gt.geometry,Dt)},FeatureCollection:function(gt,Dt){for(var or=gt.features,er=-1,Er=or.length;++er<Er;)if(na(or[er].geometry,Dt))return!0;return!1}},oa={Sphere:function(){return!0},Point:function(gt,Dt){return On(gt.coordinates,Dt)},MultiPoint:function(gt,Dt){for(var or=gt.coordinates,er=-1,Er=or.length;++er<Er;)if(On(or[er],Dt))return!0;return!1},LineString:function(gt,Dt){return ta(gt.coordinates,Dt)},MultiLineString:function(gt,Dt){for(var or=gt.coordinates,er=-1,Er=or.length;++er<Er;)if(ta(or[er],Dt))return!0;return!1},Polygon:function(gt,Dt){return Ua(gt.coordinates,Dt)},MultiPolygon:function(gt,Dt){for(var or=gt.coordinates,er=-1,Er=or.length;++er<Er;)if(Ua(or[er],Dt))return!0;return!1},GeometryCollection:function(gt,Dt){for(var or=gt.geometries,er=-1,Er=or.length;++er<Er;)if(na(or[er],Dt))return!0;return!1}};function na(gt,Dt){return gt&&oa.hasOwnProperty(gt.type)?oa[gt.type](gt,Dt):!1}function On(gt,Dt){return Tn(gt,Dt)===0}function ta(gt,Dt){for(var or,er,Er,en=0,pn=gt.length;en<pn;en++){if(er=Tn(gt[en],Dt),er===0||en>0&&(Er=Tn(gt[en],gt[en-1]),Er>0&&or<=Er&&er<=Er&&(or+er-Er)*(1-Math.pow((or-er)/Er,2))<a*Er))return!0;or=er}return!1}function Ua(gt,Dt){return!!zr(gt.map(di),Ft(Dt))}function di(gt){return gt=gt.map(Ft),gt.pop(),gt}function Ft(gt){return[gt[0]*s,gt[1]*s]}function cr(gt,Dt){return(gt&&Vn.hasOwnProperty(gt.type)?Vn[gt.type]:na)(gt,Dt)}function nn(gt,Dt,or){var er=k.range(gt,Dt-g,or).concat(Dt);return function(Er){return er.map(function(en){return[Er,en]})}}function vn(gt,Dt,or){var er=k.range(gt,Dt-g,or).concat(Dt);return function(Er){return er.map(function(en){return[en,Er]})}}function on(){var gt,Dt,or,er,Er,en,pn,An,Ln=10,Hn=Ln,yn=90,Fn=360,Pn,Gn,$n,Ha,La=2.5;function Fa(){return{type:"MultiLineString",coordinates:Na()}}function Na(){return k.range(_(er/yn)*yn,or,yn).map($n).concat(k.range(_(An/Fn)*Fn,pn,Fn).map(Ha)).concat(k.range(_(Dt/Ln)*Ln,gt,Ln).filter(function(qn){return m(qn%yn)>g}).map(Pn)).concat(k.range(_(en/Hn)*Hn,Er,Hn).filter(function(qn){return m(qn%Fn)>g}).map(Gn))}return Fa.lines=function(){return Na().map(function(qn){return{type:"LineString",coordinates:qn}})},Fa.outline=function(){return{type:"Polygon",coordinates:[$n(er).concat(Ha(pn).slice(1),$n(or).reverse().slice(1),Ha(An).reverse().slice(1))]}},Fa.extent=function(qn){return arguments.length?Fa.extentMajor(qn).extentMinor(qn):Fa.extentMinor()},Fa.extentMajor=function(qn){return arguments.length?(er=+qn[0][0],or=+qn[1][0],An=+qn[0][1],pn=+qn[1][1],er>or&&(qn=er,er=or,or=qn),An>pn&&(qn=An,An=pn,pn=qn),Fa.precision(La)):[[er,An],[or,pn]]},Fa.extentMinor=function(qn){return arguments.length?(Dt=+qn[0][0],gt=+qn[1][0],en=+qn[0][1],Er=+qn[1][1],Dt>gt&&(qn=Dt,Dt=gt,gt=qn),en>Er&&(qn=en,en=Er,Er=qn),Fa.precision(La)):[[Dt,en],[gt,Er]]},Fa.step=function(qn){return arguments.length?Fa.stepMajor(qn).stepMinor(qn):Fa.stepMinor()},Fa.stepMajor=function(qn){return arguments.length?(yn=+qn[0],Fn=+qn[1],Fa):[yn,Fn]},Fa.stepMinor=function(qn){return arguments.length?(Ln=+qn[0],Hn=+qn[1],Fa):[Ln,Hn]},Fa.precision=function(qn){return arguments.length?(La=+qn,Pn=nn(en,Er,90),Gn=vn(Dt,gt,La),$n=nn(An,pn,90),Ha=vn(er,or,La),Fa):La},Fa.extentMajor([[-180,-90+g],[180,90-g]]).extentMinor([[-180,-80-g],[180,80+g]])}function Cn(){return on()()}function _n(gt,Dt){var or=gt[0]*s,er=gt[1]*s,Er=Dt[0]*s,en=Dt[1]*s,pn=v(er),An=w(er),Ln=v(en),Hn=w(en),yn=pn*v(or),Fn=pn*w(or),Pn=Ln*v(Er),Gn=Ln*w(Er),$n=2*o(f(S(en-er)+pn*Ln*S(Er-or))),Ha=w($n),La=$n?function(Fa){var Na=w(Fa*=$n)/Ha,qn=w($n-Fa)/Ha,va=qn*yn+Na*Pn,ja=qn*Fn+Na*Gn,qa=qn*An+Na*Hn;return[M(ja,va)*d,M(qa,f(va*va+ja*ja))*d]}:function(){return[or*d,er*d]};return La.distance=$n,La}function un(gt){return gt}var dr=P(),pr=P(),Pr,dn,Un,ra,bn={point:R,lineStart:R,lineEnd:R,polygonStart:function(){bn.lineStart=Zn,bn.lineEnd=wa},polygonEnd:function(){bn.lineStart=bn.lineEnd=bn.point=R,dr.add(m(pr)),pr.reset()},result:function(){var gt=dr/2;return dr.reset(),gt}};function Zn(){bn.point=sa}function sa(gt,Dt){bn.point=ga,Pr=Un=gt,dn=ra=Dt}function ga(gt,Dt){pr.add(ra*gt-Un*Dt),Un=gt,ra=Dt}function wa(){ga(Pr,dn)}var ua=1/0,Aa=ua,_o=-ua,So=_o,Fo={point:cs,lineStart:R,lineEnd:R,polygonStart:R,polygonEnd:R,result:function(){var gt=[[ua,Aa],[_o,So]];return _o=So=-(Aa=ua=1/0),gt}};function cs(gt,Dt){gt<ua&&(ua=gt),gt>_o&&(_o=gt),Dt<Aa&&(Aa=Dt),Dt>So&&(So=Dt)}var Jl=0,Tl=0,mi=0,hs=0,Gs=0,no=0,ko=0,Fl=0,Ho=0,ao,Ys,io,Si,Eo={point:oo,lineStart:$o,lineEnd:Yo,polygonStart:function(){Eo.lineStart=Eu,Eo.lineEnd=Ws},polygonEnd:function(){Eo.point=oo,Eo.lineStart=$o,Eo.lineEnd=Yo},result:function(){var gt=Ho?[ko/Ho,Fl/Ho]:no?[hs/no,Gs/no]:mi?[Jl/mi,Tl/mi]:[NaN,NaN];return Jl=Tl=mi=hs=Gs=no=ko=Fl=Ho=0,gt}};function oo(gt,Dt){Jl+=gt,Tl+=Dt,++mi}function $o(){Eo.point=Go}function Go(gt,Dt){Eo.point=Al,oo(io=gt,Si=Dt)}function Al(gt,Dt){var or=gt-io,er=Dt-Si,Er=f(or*or+er*er);hs+=Er*(io+gt)/2,Gs+=Er*(Si+Dt)/2,no+=Er,oo(io=gt,Si=Dt)}function Yo(){Eo.point=oo}function Eu(){Eo.point=Co}function Ws(){du(ao,Ys)}function Co(gt,Dt){Eo.point=du,oo(ao=io=gt,Ys=Si=Dt)}function du(gt,Dt){var or=gt-io,er=Dt-Si,Er=f(or*or+er*er);hs+=Er*(io+gt)/2,Gs+=Er*(Si+Dt)/2,no+=Er,Er=Si*gt-io*Dt,ko+=Er*(io+gt),Fl+=Er*(Si+Dt),Ho+=Er*3,oo(io=gt,Si=Dt)}function _s(gt){this._context=gt}_s.prototype={_radius:4.5,pointRadius:function(gt){return this._radius=gt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(gt,Dt){switch(this._point){case 0:{this._context.moveTo(gt,Dt),this._point=1;break}case 1:{this._context.lineTo(gt,Dt);break}default:{this._context.moveTo(gt+this._radius,Dt),this._context.arc(gt,Dt,this._radius,0,r);break}}},result:R};var ws=P(),Ol,Cu,Lu,Xs,Bl,Ts={point:R,lineStart:function(){Ts.point=Ql},lineEnd:function(){Ol&&il(Cu,Lu),Ts.point=R},polygonStart:function(){Ol=!0},polygonEnd:function(){Ol=null},result:function(){var gt=+ws;return ws.reset(),gt}};function Ql(gt,Dt){Ts.point=il,Cu=Xs=gt,Lu=Bl=Dt}function il(gt,Dt){Xs-=gt,Bl-=Dt,ws.add(f(Xs*Xs+Bl*Bl)),Xs=gt,Bl=Dt}function $l(){this._string=[]}$l.prototype={_radius:4.5,_circle:Pu(4.5),pointRadius:function(gt){return(gt=+gt)!==this._radius&&(this._radius=gt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(gt,Dt){switch(this._point){case 0:{this._string.push("M",gt,",",Dt),this._point=1;break}case 1:{this._string.push("L",gt,",",Dt);break}default:{this._circle==null&&(this._circle=Pu(this._radius)),this._string.push("M",gt,",",Dt,this._circle);break}}},result:function(){if(this._string.length){var gt=this._string.join("");return this._string=[],gt}else return null}};function Pu(gt){return"m0,"+gt+"a"+gt+","+gt+" 0 1,1 0,"+-2*gt+"a"+gt+","+gt+" 0 1,1 0,"+2*gt+"z"}function ql(gt,Dt){var or=4.5,er,Er;function en(pn){return pn&&(typeof or=="function"&&Er.pointRadius(+or.apply(this,arguments)),B(pn,er(Er))),Er.result()}return en.area=function(pn){return B(pn,er(bn)),bn.result()},en.measure=function(pn){return B(pn,er(Ts)),Ts.result()},en.bounds=function(pn){return B(pn,er(Fo)),Fo.result()},en.centroid=function(pn){return B(pn,er(Eo)),Eo.result()},en.projection=function(pn){return arguments.length?(er=pn==null?(gt=null,un):(gt=pn).stream,en):gt},en.context=function(pn){return arguments.length?(Er=pn==null?(Dt=null,new $l):new _s(Dt=pn),typeof or!="function"&&Er.pointRadius(or),en):Dt},en.pointRadius=function(pn){return arguments.length?(or=typeof pn=="function"?pn:(Er.pointRadius(+pn),+pn),en):or},en.projection(gt).context(Dt)}function Zu(gt){return{stream:Zs(gt)}}function Zs(gt){return function(Dt){var or=new Nl;for(var er in gt)or[er]=gt[er];return or.stream=Dt,or}}function Nl(){}Nl.prototype={constructor:Nl,point:function(gt,Dt){this.stream.point(gt,Dt)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Ml(gt,Dt,or){var er=gt.clipExtent&&gt.clipExtent();return gt.scale(150).translate([0,0]),er!=null&&gt.clipExtent(null),B(or,gt.stream(Fo)),Dt(Fo.result()),er!=null&&gt.clipExtent(er),gt}function ol(gt,Dt,or){return Ml(gt,function(er){var Er=Dt[1][0]-Dt[0][0],en=Dt[1][1]-Dt[0][1],pn=Math.min(Er/(er[1][0]-er[0][0]),en/(er[1][1]-er[0][1])),An=+Dt[0][0]+(Er-pn*(er[1][0]+er[0][0]))/2,Ln=+Dt[0][1]+(en-pn*(er[1][1]+er[0][1]))/2;gt.scale(150*pn).translate([An,Ln])},or)}function Sl(gt,Dt,or){return ol(gt,[[0,0],Dt],or)}function eu(gt,Dt,or){return Ml(gt,function(er){var Er=+Dt,en=Er/(er[1][0]-er[0][0]),pn=(Er-en*(er[1][0]+er[0][0]))/2,An=-en*er[0][1];gt.scale(150*en).translate([pn,An])},or)}function js(gt,Dt,or){return Ml(gt,function(er){var Er=+Dt,en=Er/(er[1][1]-er[0][1]),pn=-en*er[0][0],An=(Er-en*(er[1][1]+er[0][1]))/2;gt.scale(150*en).translate([pn,An])},or)}var gu=16,tu=v(30*s);function Du(gt,Dt){return+Dt?Wo(gt,Dt):yu(gt)}function yu(gt){return Zs({point:function(Dt,or){Dt=gt(Dt,or),this.stream.point(Dt[0],Dt[1])}})}function Wo(gt,Dt){function or(er,Er,en,pn,An,Ln,Hn,yn,Fn,Pn,Gn,$n,Ha,La){var Fa=Hn-er,Na=yn-Er,qn=Fa*Fa+Na*Na;if(qn>4*Dt&&Ha--){var va=pn+Pn,ja=An+Gn,qa=Ln+$n,Ti=f(va*va+ja*ja+qa*qa),xi=o(qa/=Ti),bi=m(m(qa)-1)<g||m(en-Fn)<g?(en+Fn)/2:M(ja,va),Di=gt(bi,xi),li=Di[0],To=Di[1],so=li-er,ti=To-Er,pa=Na*so-Fa*ti;(pa*pa/qn>Dt||m((Fa*so+Na*ti)/qn-.5)>.3||pn*Pn+An*Gn+Ln*$n<tu)&&(or(er,Er,en,pn,An,Ln,li,To,bi,va/=Ti,ja/=Ti,qa,Ha,La),La.point(li,To),or(li,To,bi,va,ja,qa,Hn,yn,Fn,Pn,Gn,$n,Ha,La))}}return function(er){var Er,en,pn,An,Ln,Hn,yn,Fn,Pn,Gn,$n,Ha,La={point:Fa,lineStart:Na,lineEnd:va,polygonStart:function(){er.polygonStart(),La.lineStart=ja},polygonEnd:function(){er.polygonEnd(),La.lineStart=Na}};function Fa(xi,bi){xi=gt(xi,bi),er.point(xi[0],xi[1])}function Na(){Fn=NaN,La.point=qn,er.lineStart()}function qn(xi,bi){var Di=j([xi,bi]),li=gt(xi,bi);or(Fn,Pn,yn,Gn,$n,Ha,Fn=li[0],Pn=li[1],yn=xi,Gn=Di[0],$n=Di[1],Ha=Di[2],gu,er),er.point(Fn,Pn)}function va(){La.point=Fa,er.lineEnd()}function ja(){Na(),La.point=qa,La.lineEnd=Ti}function qa(xi,bi){qn(Er=xi,bi),en=Fn,pn=Pn,An=Gn,Ln=$n,Hn=Ha,La.point=qn}function Ti(){or(Fn,Pn,yn,Gn,$n,Ha,en,pn,Er,An,Ln,Hn,gu,er),La.lineEnd=va,va()}return La}}var kl=Zs({point:function(gt,Dt){this.stream.point(gt*s,Dt*s)}});function sl(gt){return Zs({point:function(Dt,or){var er=gt(Dt,or);return this.stream.point(er[0],er[1])}})}function ru(gt,Dt,or,er,Er){function en(pn,An){return pn*=er,An*=Er,[Dt+gt*pn,or-gt*An]}return en.invert=function(pn,An){return[(pn-Dt)/gt*er,(or-An)/gt*Er]},en}function as(gt,Dt,or,er,Er,en){var pn=v(en),An=w(en),Ln=pn*gt,Hn=An*gt,yn=pn/gt,Fn=An/gt,Pn=(An*or-pn*Dt)/gt,Gn=(An*Dt+pn*or)/gt;function $n(Ha,La){return Ha*=er,La*=Er,[Ln*Ha-Hn*La+Dt,or-Hn*Ha-Ln*La]}return $n.invert=function(Ha,La){return[er*(yn*Ha-Fn*La+Pn),Er*(Gn-Fn*Ha-yn*La)]},$n}function Lo(gt){return Ul(function(){return gt})()}function Ul(gt){var Dt,or=150,er=480,Er=250,en=0,pn=0,An=0,Ln=0,Hn=0,yn,Fn=0,Pn=1,Gn=1,$n=null,Ha=Xt,La=null,Fa,Na,qn,va=un,ja=.5,qa,Ti,xi,bi,Di;function li(pa){return xi(pa[0]*s,pa[1]*s)}function To(pa){return pa=xi.invert(pa[0],pa[1]),pa&&[pa[0]*d,pa[1]*d]}li.stream=function(pa){return bi&&Di===pa?bi:bi=kl(sl(yn)(Ha(qa(va(Di=pa)))))},li.preclip=function(pa){return arguments.length?(Ha=pa,$n=void 0,ti()):Ha},li.postclip=function(pa){return arguments.length?(va=pa,La=Fa=Na=qn=null,ti()):va},li.clipAngle=function(pa){return arguments.length?(Ha=+pa?Rr($n=pa*s):($n=null,Xt),ti()):$n*d},li.clipExtent=function(pa){return arguments.length?(va=pa==null?(La=Fa=Na=qn=null,un):Sn(La=+pa[0][0],Fa=+pa[0][1],Na=+pa[1][0],qn=+pa[1][1]),ti()):La==null?null:[[La,Fa],[Na,qn]]},li.scale=function(pa){return arguments.length?(or=+pa,so()):or},li.translate=function(pa){return arguments.length?(er=+pa[0],Er=+pa[1],so()):[er,Er]},li.center=function(pa){return arguments.length?(en=pa[0]%360*s,pn=pa[1]%360*s,so()):[en*d,pn*d]},li.rotate=function(pa){return arguments.length?(An=pa[0]%360*s,Ln=pa[1]%360*s,Hn=pa.length>2?pa[2]%360*s:0,so()):[An*d,Ln*d,Hn*d]},li.angle=function(pa){return arguments.length?(Fn=pa%360*s,so()):Fn*d},li.reflectX=function(pa){return arguments.length?(Pn=pa?-1:1,so()):Pn<0},li.reflectY=function(pa){return arguments.length?(Gn=pa?-1:1,so()):Gn<0},li.precision=function(pa){return arguments.length?(qa=Du(Ti,ja=pa*pa),ti()):f(ja)},li.fitExtent=function(pa,Ai){return ol(li,pa,Ai)},li.fitSize=function(pa,Ai){return Sl(li,pa,Ai)},li.fitWidth=function(pa,Ai){return eu(li,pa,Ai)},li.fitHeight=function(pa,Ai){return js(li,pa,Ai)};function so(){var pa=as(or,0,0,Pn,Gn,Fn).apply(null,Dt(en,pn)),Ai=(Fn?as:ru)(or,er-pa[0],Er-pa[1],Pn,Gn,Fn);return yn=vt(An,Ln,Hn),Ti=rt(Dt,Ai),xi=rt(yn,Ti),qa=Du(Ti,ja),ti()}function ti(){return bi=Di=null,li}return function(){return Dt=gt.apply(this,arguments),li.invert=Dt.invert&&To,so()}}function Ps(gt){var Dt=0,or=t/3,er=Ul(gt),Er=er(Dt,or);return Er.parallels=function(en){return arguments.length?er(Dt=en[0]*s,or=en[1]*s):[Dt*d,or*d]},Er}function As(gt){var Dt=v(gt);function or(er,Er){return[er*Dt,w(Er)/Dt]}return or.invert=function(er,Er){return[er/Dt,o(Er*Dt)]},or}function ho(gt,Dt){var or=w(gt),er=(or+w(Dt))/2;if(m(er)<g)return As(gt);var Er=1+or*(2*er-or),en=f(Er)/er;function pn(An,Ln){var Hn=f(Er-2*er*w(Ln))/er;return[Hn*w(An*=er),en-Hn*v(An)]}return pn.invert=function(An,Ln){var Hn=en-Ln,yn=M(An,m(Hn))*A(Hn);return Hn*er<0&&(yn-=t*A(An)*A(Hn)),[yn/er,o((Er-(An*An+Hn*Hn)*er*er)/(2*er))]},pn}function ll(){return Ps(ho).scale(155.424).center([0,33.6442])}function Ru(){return ll().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function nu(gt){var Dt=gt.length;return{point:function(or,er){for(var Er=-1;++Er<Dt;)gt[Er].point(or,er)},sphere:function(){for(var or=-1;++or<Dt;)gt[or].sphere()},lineStart:function(){for(var or=-1;++or<Dt;)gt[or].lineStart()},lineEnd:function(){for(var or=-1;++or<Dt;)gt[or].lineEnd()},polygonStart:function(){for(var or=-1;++or<Dt;)gt[or].polygonStart()},polygonEnd:function(){for(var or=-1;++or<Dt;)gt[or].polygonEnd()}}}function Iu(){var gt,Dt,or=Ru(),er,Er=ll().rotate([154,0]).center([-2,58.5]).parallels([55,65]),en,pn=ll().rotate([157,0]).center([-3,19.9]).parallels([8,18]),An,Ln,Hn={point:function(Pn,Gn){Ln=[Pn,Gn]}};function yn(Pn){var Gn=Pn[0],$n=Pn[1];return Ln=null,er.point(Gn,$n),Ln||(en.point(Gn,$n),Ln)||(An.point(Gn,$n),Ln)}yn.invert=function(Pn){var Gn=or.scale(),$n=or.translate(),Ha=(Pn[0]-$n[0])/Gn,La=(Pn[1]-$n[1])/Gn;return(La>=.12&&La<.234&&Ha>=-.425&&Ha<-.214?Er:La>=.166&&La<.234&&Ha>=-.214&&Ha<-.115?pn:or).invert(Pn)},yn.stream=function(Pn){return gt&&Dt===Pn?gt:gt=nu([or.stream(Dt=Pn),Er.stream(Pn),pn.stream(Pn)])},yn.precision=function(Pn){return arguments.length?(or.precision(Pn),Er.precision(Pn),pn.precision(Pn),Fn()):or.precision()},yn.scale=function(Pn){return arguments.length?(or.scale(Pn),Er.scale(Pn*.35),pn.scale(Pn),yn.translate(or.translate())):or.scale()},yn.translate=function(Pn){if(!arguments.length)return or.translate();var Gn=or.scale(),$n=+Pn[0],Ha=+Pn[1];return er=or.translate(Pn).clipExtent([[$n-.455*Gn,Ha-.238*Gn],[$n+.455*Gn,Ha+.238*Gn]]).stream(Hn),en=Er.translate([$n-.307*Gn,Ha+.201*Gn]).clipExtent([[$n-.425*Gn+g,Ha+.12*Gn+g],[$n-.214*Gn-g,Ha+.234*Gn-g]]).stream(Hn),An=pn.translate([$n-.205*Gn,Ha+.212*Gn]).clipExtent([[$n-.214*Gn+g,Ha+.166*Gn+g],[$n-.115*Gn-g,Ha+.234*Gn-g]]).stream(Hn),Fn()},yn.fitExtent=function(Pn,Gn){return ol(yn,Pn,Gn)},yn.fitSize=function(Pn,Gn){return Sl(yn,Pn,Gn)},yn.fitWidth=function(Pn,Gn){return eu(yn,Pn,Gn)},yn.fitHeight=function(Pn,Gn){return js(yn,Pn,Gn)};function Fn(){return gt=Dt=null,yn}return yn.scale(1070)}function Ms(gt){return function(Dt,or){var er=v(Dt),Er=v(or),en=gt(er*Er);return[en*Er*w(Dt),en*w(or)]}}function vs(gt){return function(Dt,or){var er=f(Dt*Dt+or*or),Er=gt(er),en=w(Er),pn=v(Er);return[M(Dt*en,er*pn),o(er&&or*en/er)]}}var Xo=Ms(function(gt){return f(2/(1+gt))});Xo.invert=vs(function(gt){return 2*o(gt/2)});function El(){return Lo(Xo).scale(124.75).clipAngle(180-.001)}var ul=Ms(function(gt){return(gt=h(gt))&&gt/w(gt)});ul.invert=vs(function(gt){return gt});function zu(){return Lo(ul).scale(79.4188).clipAngle(180-.001)}function is(gt,Dt){return[gt,y(u((i+Dt)/2))]}is.invert=function(gt,Dt){return[gt,2*x(l(Dt))-i]};function Fu(){return au(is).scale(961/r)}function au(gt){var Dt=Lo(gt),or=Dt.center,er=Dt.scale,Er=Dt.translate,en=Dt.clipExtent,pn=null,An,Ln,Hn;Dt.scale=function(Fn){return arguments.length?(er(Fn),yn()):er()},Dt.translate=function(Fn){return arguments.length?(Er(Fn),yn()):Er()},Dt.center=function(Fn){return arguments.length?(or(Fn),yn()):or()},Dt.clipExtent=function(Fn){return arguments.length?(Fn==null?pn=An=Ln=Hn=null:(pn=+Fn[0][0],An=+Fn[0][1],Ln=+Fn[1][0],Hn=+Fn[1][1]),yn()):pn==null?null:[[pn,An],[Ln,Hn]]};function yn(){var Fn=t*er(),Pn=Dt(Ot(Dt.rotate()).invert([0,0]));return en(pn==null?[[Pn[0]-Fn,Pn[1]-Fn],[Pn[0]+Fn,Pn[1]+Fn]]:gt===is?[[Math.max(Pn[0]-Fn,pn),An],[Math.min(Pn[0]+Fn,Ln),Hn]]:[[pn,Math.max(Pn[1]-Fn,An)],[Ln,Math.min(Pn[1]+Fn,Hn)]])}return yn()}function fl(gt){return u((i+gt)/2)}function iu(gt,Dt){var or=v(gt),er=gt===Dt?w(gt):y(or/v(Dt))/y(fl(Dt)/fl(gt)),Er=or*T(fl(gt),er)/er;if(!er)return is;function en(pn,An){Er>0?An<-i+g&&(An=-i+g):An>i-g&&(An=i-g);var Ln=Er/T(fl(An),er);return[Ln*w(er*pn),Er-Ln*v(er*pn)]}return en.invert=function(pn,An){var Ln=Er-An,Hn=A(er)*f(pn*pn+Ln*Ln),yn=M(pn,m(Ln))*A(Ln);return Ln*er<0&&(yn-=t*A(pn)*A(Ln)),[yn/er,2*x(T(Er/Hn,1/er))-i]},en}function Cl(){return Ps(iu).scale(109.5).parallels([30,30])}function Ll(gt,Dt){return[gt,Dt]}Ll.invert=Ll;function Vl(){return Lo(Ll).scale(152.63)}function Hl(gt,Dt){var or=v(gt),er=gt===Dt?w(gt):(or-v(Dt))/(Dt-gt),Er=or/er+gt;if(m(er)<g)return Ll;function en(pn,An){var Ln=Er-An,Hn=er*pn;return[Ln*w(Hn),Er-Ln*v(Hn)]}return en.invert=function(pn,An){var Ln=Er-An,Hn=M(pn,m(Ln))*A(Ln);return Ln*er<0&&(Hn-=t*A(pn)*A(Ln)),[Hn/er,Er-A(er)*f(pn*pn+Ln*Ln)]},en}function ju(){return Ps(Hl).scale(131.154).center([0,13.9389])}var Vi=1.340264,cl=-.081106,Ks=893e-6,os=.003796,ps=f(3)/2,Gl=12;function co(gt,Dt){var or=o(ps*w(Dt)),er=or*or,Er=er*er*er;return[gt*v(or)/(ps*(Vi+3*cl*er+Er*(7*Ks+9*os*er))),or*(Vi+cl*er+Er*(Ks+os*er))]}co.invert=function(gt,Dt){for(var or=Dt,er=or*or,Er=er*er*er,en=0,pn,An,Ln;en<Gl&&(An=or*(Vi+cl*er+Er*(Ks+os*er))-Dt,Ln=Vi+3*cl*er+Er*(7*Ks+9*os*er),or-=pn=An/Ln,er=or*or,Er=er*er*er,!(m(pn)<a));++en);return[ps*gt*(Vi+3*cl*er+Er*(7*Ks+9*os*er))/v(or),o(w(or)/ps)]};function ou(){return Lo(co).scale(177.158)}function qo(gt,Dt){var or=v(Dt),er=v(gt)*or;return[or*w(gt)/er,w(Dt)/er]}qo.invert=vs(x);function Ds(){return Lo(qo).scale(144.049).clipAngle(60)}function Js(){var gt=1,Dt=0,or=0,er=1,Er=1,en=0,pn,An,Ln=null,Hn,yn,Fn,Pn=1,Gn=1,$n=Zs({point:function(va,ja){var qa=qn([va,ja]);this.stream.point(qa[0],qa[1])}}),Ha=un,La,Fa;function Na(){return Pn=gt*er,Gn=gt*Er,La=Fa=null,qn}function qn(va){var ja=va[0]*Pn,qa=va[1]*Gn;if(en){var Ti=qa*pn-ja*An;ja=ja*pn+qa*An,qa=Ti}return[ja+Dt,qa+or]}return qn.invert=function(va){var ja=va[0]-Dt,qa=va[1]-or;if(en){var Ti=qa*pn+ja*An;ja=ja*pn-qa*An,qa=Ti}return[ja/Pn,qa/Gn]},qn.stream=function(va){return La&&Fa===va?La:La=$n(Ha(Fa=va))},qn.postclip=function(va){return arguments.length?(Ha=va,Ln=Hn=yn=Fn=null,Na()):Ha},qn.clipExtent=function(va){return arguments.length?(Ha=va==null?(Ln=Hn=yn=Fn=null,un):Sn(Ln=+va[0][0],Hn=+va[0][1],yn=+va[1][0],Fn=+va[1][1]),Na()):Ln==null?null:[[Ln,Hn],[yn,Fn]]},qn.scale=function(va){return arguments.length?(gt=+va,Na()):gt},qn.translate=function(va){return arguments.length?(Dt=+va[0],or=+va[1],Na()):[Dt,or]},qn.angle=function(va){return arguments.length?(en=va%360*s,An=w(en),pn=v(en),Na()):en*d},qn.reflectX=function(va){return arguments.length?(er=va?-1:1,Na()):er<0},qn.reflectY=function(va){return arguments.length?(Er=va?-1:1,Na()):Er<0},qn.fitExtent=function(va,ja){return ol(qn,va,ja)},qn.fitSize=function(va,ja){return Sl(qn,va,ja)},qn.fitWidth=function(va,ja){return eu(qn,va,ja)},qn.fitHeight=function(va,ja){return js(qn,va,ja)},qn}function Rs(gt,Dt){var or=Dt*Dt,er=or*or;return[gt*(.8707-.131979*or+er*(-.013791+er*(.003971*or-.001529*er))),Dt*(1.007226+or*(.015085+er*(-.044475+.028874*or-.005916*er)))]}Rs.invert=function(gt,Dt){var or=Dt,er=25,Er;do{var en=or*or,pn=en*en;or-=Er=(or*(1.007226+en*(.015085+pn*(-.044475+.028874*en-.005916*pn)))-Dt)/(1.007226+en*(.015085*3+pn*(-.044475*7+.028874*9*en-.005916*11*pn)))}while(m(Er)>g&&--er>0);return[gt/(.8707+(en=or*or)*(-.131979+en*(-.013791+en*en*en*(.003971-.001529*en)))),or]};function ds(){return Lo(Rs).scale(175.295)}function Ji(gt,Dt){return[v(Dt)*w(gt),w(Dt)]}Ji.invert=vs(o);function wo(){return Lo(Ji).scale(249.5).clipAngle(90+g)}function Zo(gt,Dt){var or=v(Dt),er=1+v(gt)*or;return[or*w(gt)/er,w(Dt)/er]}Zo.invert=vs(function(gt){return 2*x(gt)});function Yl(){return Lo(Zo).scale(250).clipAngle(142)}function Wl(gt,Dt){return[y(u((i+Dt)/2)),-gt]}Wl.invert=function(gt,Dt){return[-Dt,2*x(l(gt))-i]};function mu(){var gt=au(Wl),Dt=gt.center,or=gt.rotate;return gt.center=function(er){return arguments.length?Dt([-er[1],er[0]]):(er=Dt(),[er[1],-er[0]])},gt.rotate=function(er){return arguments.length?or([er[0],er[1],er.length>2?er[2]+90:90]):(er=or(),[er[0],er[1],er[2]-90])},or([0,0,90]).scale(159.155)}b.geoAlbers=Ru,b.geoAlbersUsa=Iu,b.geoArea=W,b.geoAzimuthalEqualArea=El,b.geoAzimuthalEqualAreaRaw=Xo,b.geoAzimuthalEquidistant=zu,b.geoAzimuthalEquidistantRaw=ul,b.geoBounds=it,b.geoCentroid=Xe,b.geoCircle=_r,b.geoClipAntimeridian=Xt,b.geoClipCircle=Rr,b.geoClipExtent=Jn,b.geoClipRectangle=Sn,b.geoConicConformal=Cl,b.geoConicConformalRaw=iu,b.geoConicEqualArea=ll,b.geoConicEqualAreaRaw=ho,b.geoConicEquidistant=ju,b.geoConicEquidistantRaw=Hl,b.geoContains=cr,b.geoDistance=Tn,b.geoEqualEarth=ou,b.geoEqualEarthRaw=co,b.geoEquirectangular=Vl,b.geoEquirectangularRaw=Ll,b.geoGnomonic=Ds,b.geoGnomonicRaw=qo,b.geoGraticule=on,b.geoGraticule10=Cn,b.geoIdentity=Js,b.geoInterpolate=_n,b.geoLength=wr,b.geoMercator=Fu,b.geoMercatorRaw=is,b.geoNaturalEarth1=ds,b.geoNaturalEarth1Raw=Rs,b.geoOrthographic=wo,b.geoOrthographicRaw=Ji,b.geoPath=ql,b.geoProjection=Lo,b.geoProjectionMutator=Ul,b.geoRotation=Ot,b.geoStereographic=Yl,b.geoStereographicRaw=Zo,b.geoStream=B,b.geoTransform=Zu,b.geoTransverseMercator=mu,b.geoTransverseMercatorRaw=Wl,Object.defineProperty(b,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):(b=b||self,k(b.d3=b.d3||{}))})(this,function(b){"use strict";function k(et,Pe){return et.parent===Pe.parent?1:2}function P(et){return et.reduce(E,0)/et.length}function E(et,Pe){return et+Pe.x}function e(et){return 1+et.reduce(p,0)}function p(et,Pe){return Math.max(et,Pe.y)}function g(et){for(var Pe;Pe=et.children;)et=Pe[0];return et}function a(et){for(var Pe;Pe=et.children;)et=Pe[Pe.length-1];return et}function t(){var et=k,Pe=1,We=1,je=!1;function nt(kt){var wt,Vt=0;kt.eachAfter(function(Qt){var fr=Qt.children;fr?(Qt.x=P(fr),Qt.y=e(fr)):(Qt.x=wt?Vt+=et(Qt,wt):0,Qt.y=0,wt=Qt)});var qt=g(kt),zt=a(kt),Ht=qt.x-et(qt,zt)/2,$t=zt.x+et(zt,qt)/2;return kt.eachAfter(je?function(Qt){Qt.x=(Qt.x-kt.x)*Pe,Qt.y=(kt.y-Qt.y)*We}:function(Qt){Qt.x=(Qt.x-Ht)/($t-Ht)*Pe,Qt.y=(1-(kt.y?Qt.y/kt.y:1))*We})}return nt.separation=function(kt){return arguments.length?(et=kt,nt):et},nt.size=function(kt){return arguments.length?(je=!1,Pe=+kt[0],We=+kt[1],nt):je?null:[Pe,We]},nt.nodeSize=function(kt){return arguments.length?(je=!0,Pe=+kt[0],We=+kt[1],nt):je?[Pe,We]:null},nt}function i(et){var Pe=0,We=et.children,je=We&&We.length;if(!je)Pe=1;else for(;--je>=0;)Pe+=We[je].value;et.value=Pe}function n(){return this.eachAfter(i)}function r(et){var Pe=this,We,je=[Pe],nt,kt,wt;do for(We=je.reverse(),je=[];Pe=We.pop();)if(et(Pe),nt=Pe.children,nt)for(kt=0,wt=nt.length;kt<wt;++kt)je.push(nt[kt]);while(je.length);return this}function d(et){for(var Pe=this,We=[Pe],je,nt;Pe=We.pop();)if(et(Pe),je=Pe.children,je)for(nt=je.length-1;nt>=0;--nt)We.push(je[nt]);return this}function s(et){for(var Pe=this,We=[Pe],je=[],nt,kt,wt;Pe=We.pop();)if(je.push(Pe),nt=Pe.children,nt)for(kt=0,wt=nt.length;kt<wt;++kt)We.push(nt[kt]);for(;Pe=je.pop();)et(Pe);return this}function m(et){return this.eachAfter(function(Pe){for(var We=+et(Pe.data)||0,je=Pe.children,nt=je&&je.length;--nt>=0;)We+=je[nt].value;Pe.value=We})}function x(et){return this.eachBefore(function(Pe){Pe.children&&Pe.children.sort(et)})}function M(et){for(var Pe=this,We=v(Pe,et),je=[Pe];Pe!==We;)Pe=Pe.parent,je.push(Pe);for(var nt=je.length;et!==We;)je.splice(nt,0,et),et=et.parent;return je}function v(et,Pe){if(et===Pe)return et;var We=et.ancestors(),je=Pe.ancestors(),nt=null;for(et=We.pop(),Pe=je.pop();et===Pe;)nt=et,et=We.pop(),Pe=je.pop();return nt}function _(){for(var et=this,Pe=[et];et=et.parent;)Pe.push(et);return Pe}function l(){var et=[];return this.each(function(Pe){et.push(Pe)}),et}function y(){var et=[];return this.eachBefore(function(Pe){Pe.children||et.push(Pe)}),et}function T(){var et=this,Pe=[];return et.each(function(We){We!==et&&Pe.push({source:We.parent,target:We})}),Pe}function w(et,Pe){var We=new o(et),je=+et.value&&(We.value=et.value),nt,kt=[We],wt,Vt,qt,zt;for(Pe==null&&(Pe=f);nt=kt.pop();)if(je&&(nt.value=+nt.data.value),(Vt=Pe(nt.data))&&(zt=Vt.length))for(nt.children=new Array(zt),qt=zt-1;qt>=0;--qt)kt.push(wt=nt.children[qt]=new o(Vt[qt])),wt.parent=nt,wt.depth=nt.depth+1;return We.eachBefore(h)}function A(){return w(this).eachBefore(u)}function f(et){return et.children}function u(et){et.data=et.data.data}function h(et){var Pe=0;do et.height=Pe;while((et=et.parent)&&et.height<++Pe)}function o(et){this.data=et,this.depth=this.height=0,this.parent=null}o.prototype=w.prototype={constructor:o,count:n,each:r,eachAfter:s,eachBefore:d,sum:m,sort:x,path:M,ancestors:_,descendants:l,leaves:y,links:T,copy:A};var S=Array.prototype.slice;function R(et){for(var Pe=et.length,We,je;Pe;)je=Math.random()*Pe--|0,We=et[Pe],et[Pe]=et[je],et[je]=We;return et}function z(et){for(var Pe=0,We=(et=R(S.call(et))).length,je=[],nt,kt;Pe<We;)nt=et[Pe],kt&&F(kt,nt)?++Pe:(kt=B(je=O(je,nt)),Pe=0);return kt}function O(et,Pe){var We,je;if(D(Pe,et))return[Pe];for(We=0;We<et.length;++We)if(I(Pe,et[We])&&D(X(et[We],Pe),et))return[et[We],Pe];for(We=0;We<et.length-1;++We)for(je=We+1;je<et.length;++je)if(I(X(et[We],et[je]),Pe)&&I(X(et[We],Pe),et[je])&&I(X(et[je],Pe),et[We])&&D(oe(et[We],et[je],Pe),et))return[et[We],et[je],Pe];throw new Error}function I(et,Pe){var We=et.r-Pe.r,je=Pe.x-et.x,nt=Pe.y-et.y;return We<0||We*We<je*je+nt*nt}function F(et,Pe){var We=et.r-Pe.r+1e-6,je=Pe.x-et.x,nt=Pe.y-et.y;return We>0&&We*We>je*je+nt*nt}function D(et,Pe){for(var We=0;We<Pe.length;++We)if(!F(et,Pe[We]))return!1;return!0}function B(et){switch(et.length){case 1:return U(et[0]);case 2:return X(et[0],et[1]);case 3:return oe(et[0],et[1],et[2])}}function U(et){return{x:et.x,y:et.y,r:et.r}}function X(et,Pe){var We=et.x,je=et.y,nt=et.r,kt=Pe.x,wt=Pe.y,Vt=Pe.r,qt=kt-We,zt=wt-je,Ht=Vt-nt,$t=Math.sqrt(qt*qt+zt*zt);return{x:(We+kt+qt/$t*Ht)/2,y:(je+wt+zt/$t*Ht)/2,r:($t+nt+Vt)/2}}function oe(et,Pe,We){var je=et.x,nt=et.y,kt=et.r,wt=Pe.x,Vt=Pe.y,qt=Pe.r,zt=We.x,Ht=We.y,$t=We.r,Qt=je-wt,fr=je-zt,jr=nt-Vt,cn=nt-Ht,Qr=qt-kt,lt=$t-kt,Gt=je*je+nt*nt-kt*kt,Kt=Gt-wt*wt-Vt*Vt+qt*qt,Nt=Gt-zt*zt-Ht*Ht+$t*$t,gr=fr*jr-Qt*cn,tt=(jr*Nt-cn*Kt)/(gr*2)-je,we=(cn*Qr-jr*lt)/gr,Me=(fr*Kt-Qt*Nt)/(gr*2)-nt,Ne=(Qt*lt-fr*Qr)/gr,Xe=we*we+Ne*Ne-1,Ke=2*(kt+tt*we+Me*Ne),rt=tt*tt+Me*Me-kt*kt,Je=-(Xe?(Ke+Math.sqrt(Ke*Ke-4*Xe*rt))/(2*Xe):rt/Ke);return{x:je+tt+we*Je,y:nt+Me+Ne*Je,r:Je}}function se(et,Pe,We){var je=et.x-Pe.x,nt,kt,wt=et.y-Pe.y,Vt,qt,zt=je*je+wt*wt;zt?(kt=Pe.r+We.r,kt*=kt,qt=et.r+We.r,qt*=qt,kt>qt?(nt=(zt+qt-kt)/(2*zt),Vt=Math.sqrt(Math.max(0,qt/zt-nt*nt)),We.x=et.x-nt*je-Vt*wt,We.y=et.y-nt*wt+Vt*je):(nt=(zt+kt-qt)/(2*zt),Vt=Math.sqrt(Math.max(0,kt/zt-nt*nt)),We.x=Pe.x+nt*je-Vt*wt,We.y=Pe.y+nt*wt+Vt*je)):(We.x=Pe.x+We.r,We.y=Pe.y)}function q(et,Pe){var We=et.r+Pe.r-1e-6,je=Pe.x-et.x,nt=Pe.y-et.y;return We>0&&We*We>je*je+nt*nt}function K(et){var Pe=et._,We=et.next._,je=Pe.r+We.r,nt=(Pe.x*We.r+We.x*Pe.r)/je,kt=(Pe.y*We.r+We.y*Pe.r)/je;return nt*nt+kt*kt}function G(et){this._=et,this.next=null,this.previous=null}function Q(et){if(!(nt=et.length))return 0;var Pe,We,je,nt,kt,wt,Vt,qt,zt,Ht,$t;if(Pe=et[0],Pe.x=0,Pe.y=0,!(nt>1))return Pe.r;if(We=et[1],Pe.x=-We.r,We.x=Pe.r,We.y=0,!(nt>2))return Pe.r+We.r;se(We,Pe,je=et[2]),Pe=new G(Pe),We=new G(We),je=new G(je),Pe.next=je.previous=We,We.next=Pe.previous=je,je.next=We.previous=Pe;e:for(Vt=3;Vt<nt;++Vt){se(Pe._,We._,je=et[Vt]),je=new G(je),qt=We.next,zt=Pe.previous,Ht=We._.r,$t=Pe._.r;do if(Ht<=$t){if(q(qt._,je._)){We=qt,Pe.next=We,We.previous=Pe,--Vt;continue e}Ht+=qt._.r,qt=qt.next}else{if(q(zt._,je._)){Pe=zt,Pe.next=We,We.previous=Pe,--Vt;continue e}$t+=zt._.r,zt=zt.previous}while(qt!==zt.next);for(je.previous=Pe,je.next=We,Pe.next=We.previous=We=je,kt=K(Pe);(je=je.next)!==We;)(wt=K(je))<kt&&(Pe=je,kt=wt);We=Pe.next}for(Pe=[We._],je=We;(je=je.next)!==We;)Pe.push(je._);for(je=z(Pe),Vt=0;Vt<nt;++Vt)Pe=et[Vt],Pe.x-=je.x,Pe.y-=je.y;return je.r}function V(et){return Q(et),et}function H(et){return et==null?null:ee(et)}function ee(et){if(typeof et!="function")throw new Error;return et}function J(){return 0}function W(et){return function(){return et}}function re(et){return Math.sqrt(et.value)}function j(){var et=null,Pe=1,We=1,je=J;function nt(kt){return kt.x=Pe/2,kt.y=We/2,et?kt.eachBefore(Z(et)).eachAfter(ne(je,.5)).eachBefore(le(1)):kt.eachBefore(Z(re)).eachAfter(ne(J,1)).eachAfter(ne(je,kt.r/Math.min(Pe,We))).eachBefore(le(Math.min(Pe,We)/(2*kt.r))),kt}return nt.radius=function(kt){return arguments.length?(et=H(kt),nt):et},nt.size=function(kt){return arguments.length?(Pe=+kt[0],We=+kt[1],nt):[Pe,We]},nt.padding=function(kt){return arguments.length?(je=typeof kt=="function"?kt:W(+kt),nt):je},nt}function Z(et){return function(Pe){Pe.children||(Pe.r=Math.max(0,+et(Pe)||0))}}function ne(et,Pe){return function(We){if(je=We.children){var je,nt,kt=je.length,wt=et(We)*Pe||0,Vt;if(wt)for(nt=0;nt<kt;++nt)je[nt].r+=wt;if(Vt=Q(je),wt)for(nt=0;nt<kt;++nt)je[nt].r-=wt;We.r=Vt+wt}}}function le(et){return function(Pe){var We=Pe.parent;Pe.r*=et,We&&(Pe.x=We.x+et*Pe.x,Pe.y=We.y+et*Pe.y)}}function ge(et){et.x0=Math.round(et.x0),et.y0=Math.round(et.y0),et.x1=Math.round(et.x1),et.y1=Math.round(et.y1)}function pe(et,Pe,We,je,nt){for(var kt=et.children,wt,Vt=-1,qt=kt.length,zt=et.value&&(je-Pe)/et.value;++Vt<qt;)wt=kt[Vt],wt.y0=We,wt.y1=nt,wt.x0=Pe,wt.x1=Pe+=wt.value*zt}function xe(){var et=1,Pe=1,We=0,je=!1;function nt(wt){var Vt=wt.height+1;return wt.x0=wt.y0=We,wt.x1=et,wt.y1=Pe/Vt,wt.eachBefore(kt(Pe,Vt)),je&&wt.eachBefore(ge),wt}function kt(wt,Vt){return function(qt){qt.children&&pe(qt,qt.x0,wt*(qt.depth+1)/Vt,qt.x1,wt*(qt.depth+2)/Vt);var zt=qt.x0,Ht=qt.y0,$t=qt.x1-We,Qt=qt.y1-We;$t<zt&&(zt=$t=(zt+$t)/2),Qt<Ht&&(Ht=Qt=(Ht+Qt)/2),qt.x0=zt,qt.y0=Ht,qt.x1=$t,qt.y1=Qt}}return nt.round=function(wt){return arguments.length?(je=!!wt,nt):je},nt.size=function(wt){return arguments.length?(et=+wt[0],Pe=+wt[1],nt):[et,Pe]},nt.padding=function(wt){return arguments.length?(We=+wt,nt):We},nt}var Ee="$",Te={depth:-1},de={};function be(et){return et.id}function Le(et){return et.parentId}function De(){var et=be,Pe=Le;function We(je){var nt,kt,wt=je.length,Vt,qt,zt,Ht=new Array(wt),$t,Qt,fr={};for(kt=0;kt<wt;++kt)nt=je[kt],zt=Ht[kt]=new o(nt),($t=et(nt,kt,je))!=null&&($t+="")&&(Qt=Ee+(zt.id=$t),fr[Qt]=Qt in fr?de:zt);for(kt=0;kt<wt;++kt)if(zt=Ht[kt],$t=Pe(je[kt],kt,je),$t==null||!($t+="")){if(Vt)throw new Error("multiple roots");Vt=zt}else{if(qt=fr[Ee+$t],!qt)throw new Error("missing: "+$t);if(qt===de)throw new Error("ambiguous: "+$t);qt.children?qt.children.push(zt):qt.children=[zt],zt.parent=qt}if(!Vt)throw new Error("no root");if(Vt.parent=Te,Vt.eachBefore(function(jr){jr.depth=jr.parent.depth+1,--wt}).eachBefore(h),Vt.parent=null,wt>0)throw new Error("cycle");return Vt}return We.id=function(je){return arguments.length?(et=ee(je),We):et},We.parentId=function(je){return arguments.length?(Pe=ee(je),We):Pe},We}function ye(et,Pe){return et.parent===Pe.parent?1:2}function ke(et){var Pe=et.children;return Pe?Pe[0]:et.t}function Oe(et){var Pe=et.children;return Pe?Pe[Pe.length-1]:et.t}function Qe(et,Pe,We){var je=We/(Pe.i-et.i);Pe.c-=je,Pe.s+=We,et.c+=je,Pe.z+=We,Pe.m+=We}function Ve(et){for(var Pe=0,We=0,je=et.children,nt=je.length,kt;--nt>=0;)kt=je[nt],kt.z+=Pe,kt.m+=Pe,Pe+=kt.s+(We+=kt.c)}function Ue(et,Pe,We){return et.a.parent===Pe.parent?et.a:We}function Ie(et,Pe){this._=et,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=Pe}Ie.prototype=Object.create(o.prototype);function at(et){for(var Pe=new Ie(et,0),We,je=[Pe],nt,kt,wt,Vt;We=je.pop();)if(kt=We._.children)for(We.children=new Array(Vt=kt.length),wt=Vt-1;wt>=0;--wt)je.push(nt=We.children[wt]=new Ie(kt[wt],wt)),nt.parent=We;return(Pe.parent=new Ie(null,0)).children=[Pe],Pe}function pt(){var et=ye,Pe=1,We=1,je=null;function nt(zt){var Ht=at(zt);if(Ht.eachAfter(kt),Ht.parent.m=-Ht.z,Ht.eachBefore(wt),je)zt.eachBefore(qt);else{var $t=zt,Qt=zt,fr=zt;zt.eachBefore(function(Gt){Gt.x<$t.x&&($t=Gt),Gt.x>Qt.x&&(Qt=Gt),Gt.depth>fr.depth&&(fr=Gt)});var jr=$t===Qt?1:et($t,Qt)/2,cn=jr-$t.x,Qr=Pe/(Qt.x+jr+cn),lt=We/(fr.depth||1);zt.eachBefore(function(Gt){Gt.x=(Gt.x+cn)*Qr,Gt.y=Gt.depth*lt})}return zt}function kt(zt){var Ht=zt.children,$t=zt.parent.children,Qt=zt.i?$t[zt.i-1]:null;if(Ht){Ve(zt);var fr=(Ht[0].z+Ht[Ht.length-1].z)/2;Qt?(zt.z=Qt.z+et(zt._,Qt._),zt.m=zt.z-fr):zt.z=fr}else Qt&&(zt.z=Qt.z+et(zt._,Qt._));zt.parent.A=Vt(zt,Qt,zt.parent.A||$t[0])}function wt(zt){zt._.x=zt.z+zt.parent.m,zt.m+=zt.parent.m}function Vt(zt,Ht,$t){if(Ht){for(var Qt=zt,fr=zt,jr=Ht,cn=Qt.parent.children[0],Qr=Qt.m,lt=fr.m,Gt=jr.m,Kt=cn.m,Nt;jr=Oe(jr),Qt=ke(Qt),jr&&Qt;)cn=ke(cn),fr=Oe(fr),fr.a=zt,Nt=jr.z+Gt-Qt.z-Qr+et(jr._,Qt._),Nt>0&&(Qe(Ue(jr,zt,$t),zt,Nt),Qr+=Nt,lt+=Nt),Gt+=jr.m,Qr+=Qt.m,Kt+=cn.m,lt+=fr.m;jr&&!Oe(fr)&&(fr.t=jr,fr.m+=Gt-lt),Qt&&!ke(cn)&&(cn.t=Qt,cn.m+=Qr-Kt,$t=zt)}return $t}function qt(zt){zt.x*=Pe,zt.y=zt.depth*We}return nt.separation=function(zt){return arguments.length?(et=zt,nt):et},nt.size=function(zt){return arguments.length?(je=!1,Pe=+zt[0],We=+zt[1],nt):je?null:[Pe,We]},nt.nodeSize=function(zt){return arguments.length?(je=!0,Pe=+zt[0],We=+zt[1],nt):je?[Pe,We]:null},nt}function Rt(et,Pe,We,je,nt){for(var kt=et.children,wt,Vt=-1,qt=kt.length,zt=et.value&&(nt-We)/et.value;++Vt<qt;)wt=kt[Vt],wt.x0=Pe,wt.x1=je,wt.y0=We,wt.y1=We+=wt.value*zt}var Mt=(1+Math.sqrt(5))/2;function It(et,Pe,We,je,nt,kt){for(var wt=[],Vt=Pe.children,qt,zt,Ht=0,$t=0,Qt=Vt.length,fr,jr,cn=Pe.value,Qr,lt,Gt,Kt,Nt,gr,tt;Ht<Qt;){fr=nt-We,jr=kt-je;do Qr=Vt[$t++].value;while(!Qr&&$t<Qt);for(lt=Gt=Qr,gr=Math.max(jr/fr,fr/jr)/(cn*et),tt=Qr*Qr*gr,Nt=Math.max(Gt/tt,tt/lt);$t<Qt;++$t){if(Qr+=zt=Vt[$t].value,zt<lt&&(lt=zt),zt>Gt&&(Gt=zt),tt=Qr*Qr*gr,Kt=Math.max(Gt/tt,tt/lt),Kt>Nt){Qr-=zt;break}Nt=Kt}wt.push(qt={value:Qr,dice:fr<jr,children:Vt.slice(Ht,$t)}),qt.dice?pe(qt,We,je,nt,cn?je+=jr*Qr/cn:kt):Rt(qt,We,je,cn?We+=fr*Qr/cn:nt,kt),cn-=Qr,Ht=$t}return wt}var Bt=function et(Pe){function We(je,nt,kt,wt,Vt){It(Pe,je,nt,kt,wt,Vt)}return We.ratio=function(je){return et((je=+je)>1?je:1)},We}(Mt);function St(){var et=Bt,Pe=!1,We=1,je=1,nt=[0],kt=J,wt=J,Vt=J,qt=J,zt=J;function Ht(Qt){return Qt.x0=Qt.y0=0,Qt.x1=We,Qt.y1=je,Qt.eachBefore($t),nt=[0],Pe&&Qt.eachBefore(ge),Qt}function $t(Qt){var fr=nt[Qt.depth],jr=Qt.x0+fr,cn=Qt.y0+fr,Qr=Qt.x1-fr,lt=Qt.y1-fr;Qr<jr&&(jr=Qr=(jr+Qr)/2),lt<cn&&(cn=lt=(cn+lt)/2),Qt.x0=jr,Qt.y0=cn,Qt.x1=Qr,Qt.y1=lt,Qt.children&&(fr=nt[Qt.depth+1]=kt(Qt)/2,jr+=zt(Qt)-fr,cn+=wt(Qt)-fr,Qr-=Vt(Qt)-fr,lt-=qt(Qt)-fr,Qr<jr&&(jr=Qr=(jr+Qr)/2),lt<cn&&(cn=lt=(cn+lt)/2),et(Qt,jr,cn,Qr,lt))}return Ht.round=function(Qt){return arguments.length?(Pe=!!Qt,Ht):Pe},Ht.size=function(Qt){return arguments.length?(We=+Qt[0],je=+Qt[1],Ht):[We,je]},Ht.tile=function(Qt){return arguments.length?(et=ee(Qt),Ht):et},Ht.padding=function(Qt){return arguments.length?Ht.paddingInner(Qt).paddingOuter(Qt):Ht.paddingInner()},Ht.paddingInner=function(Qt){return arguments.length?(kt=typeof Qt=="function"?Qt:W(+Qt),Ht):kt},Ht.paddingOuter=function(Qt){return arguments.length?Ht.paddingTop(Qt).paddingRight(Qt).paddingBottom(Qt).paddingLeft(Qt):Ht.paddingTop()},Ht.paddingTop=function(Qt){return arguments.length?(wt=typeof Qt=="function"?Qt:W(+Qt),Ht):wt},Ht.paddingRight=function(Qt){return arguments.length?(Vt=typeof Qt=="function"?Qt:W(+Qt),Ht):Vt},Ht.paddingBottom=function(Qt){return arguments.length?(qt=typeof Qt=="function"?Qt:W(+Qt),Ht):qt},Ht.paddingLeft=function(Qt){return arguments.length?(zt=typeof Qt=="function"?Qt:W(+Qt),Ht):zt},Ht}function _t(et,Pe,We,je,nt){var kt=et.children,wt,Vt=kt.length,qt,zt=new Array(Vt+1);for(zt[0]=qt=wt=0;wt<Vt;++wt)zt[wt+1]=qt+=kt[wt].value;Ht(0,Vt,et.value,Pe,We,je,nt);function Ht($t,Qt,fr,jr,cn,Qr,lt){if($t>=Qt-1){var Gt=kt[$t];Gt.x0=jr,Gt.y0=cn,Gt.x1=Qr,Gt.y1=lt;return}for(var Kt=zt[$t],Nt=fr/2+Kt,gr=$t+1,tt=Qt-1;gr<tt;){var we=gr+tt>>>1;zt[we]<Nt?gr=we+1:tt=we}Nt-zt[gr-1]<zt[gr]-Nt&&$t+1<gr&&--gr;var Me=zt[gr]-Kt,Ne=fr-Me;if(Qr-jr>lt-cn){var Xe=(jr*Ne+Qr*Me)/fr;Ht($t,gr,Me,jr,cn,Xe,lt),Ht(gr,Qt,Ne,Xe,cn,Qr,lt)}else{var Ke=(cn*Ne+lt*Me)/fr;Ht($t,gr,Me,jr,cn,Qr,Ke),Ht(gr,Qt,Ne,jr,Ke,Qr,lt)}}}function it(et,Pe,We,je,nt){(et.depth&1?Rt:pe)(et,Pe,We,je,nt)}var ct=function et(Pe){function We(je,nt,kt,wt,Vt){if((qt=je._squarify)&&qt.ratio===Pe)for(var qt,zt,Ht,$t,Qt=-1,fr,jr=qt.length,cn=je.value;++Qt<jr;){for(zt=qt[Qt],Ht=zt.children,$t=zt.value=0,fr=Ht.length;$t<fr;++$t)zt.value+=Ht[$t].value;zt.dice?pe(zt,nt,kt,wt,kt+=(Vt-kt)*zt.value/cn):Rt(zt,nt,kt,nt+=(wt-nt)*zt.value/cn,Vt),cn-=zt.value}else je._squarify=qt=It(Pe,je,nt,kt,wt,Vt),qt.ratio=Pe}return We.ratio=function(je){return et((je=+je)>1?je:1)},We}(Mt);b.cluster=t,b.hierarchy=w,b.pack=j,b.packEnclose=z,b.packSiblings=V,b.partition=xe,b.stratify=De,b.tree=pt,b.treemap=St,b.treemapBinary=_t,b.treemapDice=pe,b.treemapResquarify=ct,b.treemapSlice=Rt,b.treemapSliceDice=it,b.treemapSquarify=Bt,Object.defineProperty(b,"__esModule",{value:!0})})},{}],116:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie,c("d3-color")):typeof Vr=="function"&&Vr.amd?Vr(["exports","d3-color"],k):(b=b||self,k(b.d3=b.d3||{},b.d3))})(this,function(b,k){"use strict";function P(ye,ke,Oe,Qe,Ve){var Ue=ye*ye,Ie=Ue*ye;return((1-3*ye+3*Ue-Ie)*ke+(4-6*Ue+3*Ie)*Oe+(1+3*ye+3*Ue-3*Ie)*Qe+Ie*Ve)/6}function E(ye){var ke=ye.length-1;return function(Oe){var Qe=Oe<=0?Oe=0:Oe>=1?(Oe=1,ke-1):Math.floor(Oe*ke),Ve=ye[Qe],Ue=ye[Qe+1],Ie=Qe>0?ye[Qe-1]:2*Ve-Ue,at=Qe<ke-1?ye[Qe+2]:2*Ue-Ve;return P((Oe-Qe/ke)*ke,Ie,Ve,Ue,at)}}function e(ye){var ke=ye.length;return function(Oe){var Qe=Math.floor(((Oe%=1)<0?++Oe:Oe)*ke),Ve=ye[(Qe+ke-1)%ke],Ue=ye[Qe%ke],Ie=ye[(Qe+1)%ke],at=ye[(Qe+2)%ke];return P((Oe-Qe/ke)*ke,Ve,Ue,Ie,at)}}function p(ye){return function(){return ye}}function g(ye,ke){return function(Oe){return ye+Oe*ke}}function a(ye,ke,Oe){return ye=Math.pow(ye,Oe),ke=Math.pow(ke,Oe)-ye,Oe=1/Oe,function(Qe){return Math.pow(ye+Qe*ke,Oe)}}function t(ye,ke){var Oe=ke-ye;return Oe?g(ye,Oe>180||Oe<-180?Oe-360*Math.round(Oe/360):Oe):p(isNaN(ye)?ke:ye)}function i(ye){return(ye=+ye)==1?n:function(ke,Oe){return Oe-ke?a(ke,Oe,ye):p(isNaN(ke)?Oe:ke)}}function n(ye,ke){var Oe=ke-ye;return Oe?g(ye,Oe):p(isNaN(ye)?ke:ye)}var r=function ye(ke){var Oe=i(ke);function Qe(Ve,Ue){var Ie=Oe((Ve=k.rgb(Ve)).r,(Ue=k.rgb(Ue)).r),at=Oe(Ve.g,Ue.g),pt=Oe(Ve.b,Ue.b),Rt=n(Ve.opacity,Ue.opacity);return function(Mt){return Ve.r=Ie(Mt),Ve.g=at(Mt),Ve.b=pt(Mt),Ve.opacity=Rt(Mt),Ve+""}}return Qe.gamma=ye,Qe}(1);function d(ye){return function(ke){var Oe=ke.length,Qe=new Array(Oe),Ve=new Array(Oe),Ue=new Array(Oe),Ie,at;for(Ie=0;Ie<Oe;++Ie)at=k.rgb(ke[Ie]),Qe[Ie]=at.r||0,Ve[Ie]=at.g||0,Ue[Ie]=at.b||0;return Qe=ye(Qe),Ve=ye(Ve),Ue=ye(Ue),at.opacity=1,function(pt){return at.r=Qe(pt),at.g=Ve(pt),at.b=Ue(pt),at+""}}}var s=d(E),m=d(e);function x(ye,ke){ke||(ke=[]);var Oe=ye?Math.min(ke.length,ye.length):0,Qe=ke.slice(),Ve;return function(Ue){for(Ve=0;Ve<Oe;++Ve)Qe[Ve]=ye[Ve]*(1-Ue)+ke[Ve]*Ue;return Qe}}function M(ye){return ArrayBuffer.isView(ye)&&!(ye instanceof DataView)}function v(ye,ke){return(M(ke)?x:_)(ye,ke)}function _(ye,ke){var Oe=ke?ke.length:0,Qe=ye?Math.min(Oe,ye.length):0,Ve=new Array(Qe),Ue=new Array(Oe),Ie;for(Ie=0;Ie<Qe;++Ie)Ve[Ie]=o(ye[Ie],ke[Ie]);for(;Ie<Oe;++Ie)Ue[Ie]=ke[Ie];return function(at){for(Ie=0;Ie<Qe;++Ie)Ue[Ie]=Ve[Ie](at);return Ue}}function l(ye,ke){var Oe=new Date;return ye=+ye,ke=+ke,function(Qe){return Oe.setTime(ye*(1-Qe)+ke*Qe),Oe}}function y(ye,ke){return ye=+ye,ke=+ke,function(Oe){return ye*(1-Oe)+ke*Oe}}function T(ye,ke){var Oe={},Qe={},Ve;(ye===null||typeof ye!="object")&&(ye={}),(ke===null||typeof ke!="object")&&(ke={});for(Ve in ke)Ve in ye?Oe[Ve]=o(ye[Ve],ke[Ve]):Qe[Ve]=ke[Ve];return function(Ue){for(Ve in Oe)Qe[Ve]=Oe[Ve](Ue);return Qe}}var w=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,A=new RegExp(w.source,"g");function f(ye){return function(){return ye}}function u(ye){return function(ke){return ye(ke)+""}}function h(ye,ke){var Oe=w.lastIndex=A.lastIndex=0,Qe,Ve,Ue,Ie=-1,at=[],pt=[];for(ye=ye+"",ke=ke+"";(Qe=w.exec(ye))&&(Ve=A.exec(ke));)(Ue=Ve.index)>Oe&&(Ue=ke.slice(Oe,Ue),at[Ie]?at[Ie]+=Ue:at[++Ie]=Ue),(Qe=Qe[0])===(Ve=Ve[0])?at[Ie]?at[Ie]+=Ve:at[++Ie]=Ve:(at[++Ie]=null,pt.push({i:Ie,x:y(Qe,Ve)})),Oe=A.lastIndex;return Oe<ke.length&&(Ue=ke.slice(Oe),at[Ie]?at[Ie]+=Ue:at[++Ie]=Ue),at.length<2?pt[0]?u(pt[0].x):f(ke):(ke=pt.length,function(Rt){for(var Mt=0,It;Mt<ke;++Mt)at[(It=pt[Mt]).i]=It.x(Rt);return at.join("")})}function o(ye,ke){var Oe=typeof ke,Qe;return ke==null||Oe==="boolean"?p(ke):(Oe==="number"?y:Oe==="string"?(Qe=k.color(ke))?(ke=Qe,r):h:ke instanceof k.color?r:ke instanceof Date?l:M(ke)?x:Array.isArray(ke)?_:typeof ke.valueOf!="function"&&typeof ke.toString!="function"||isNaN(ke)?T:y)(ye,ke)}function S(ye){var ke=ye.length;return function(Oe){return ye[Math.max(0,Math.min(ke-1,Math.floor(Oe*ke)))]}}function R(ye,ke){var Oe=t(+ye,+ke);return function(Qe){var Ve=Oe(Qe);return Ve-360*Math.floor(Ve/360)}}function z(ye,ke){return ye=+ye,ke=+ke,function(Oe){return Math.round(ye*(1-Oe)+ke*Oe)}}var O=180/Math.PI,I={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function F(ye,ke,Oe,Qe,Ve,Ue){var Ie,at,pt;return(Ie=Math.sqrt(ye*ye+ke*ke))&&(ye/=Ie,ke/=Ie),(pt=ye*Oe+ke*Qe)&&(Oe-=ye*pt,Qe-=ke*pt),(at=Math.sqrt(Oe*Oe+Qe*Qe))&&(Oe/=at,Qe/=at,pt/=at),ye*Qe<ke*Oe&&(ye=-ye,ke=-ke,pt=-pt,Ie=-Ie),{translateX:Ve,translateY:Ue,rotate:Math.atan2(ke,ye)*O,skewX:Math.atan(pt)*O,scaleX:Ie,scaleY:at}}var D,B,U,X;function oe(ye){return ye==="none"?I:(D||(D=document.createElement("DIV"),B=document.documentElement,U=document.defaultView),D.style.transform=ye,ye=U.getComputedStyle(B.appendChild(D),null).getPropertyValue("transform"),B.removeChild(D),ye=ye.slice(7,-1).split(","),F(+ye[0],+ye[1],+ye[2],+ye[3],+ye[4],+ye[5]))}function se(ye){return ye==null||(X||(X=document.createElementNS("http://www.w3.org/2000/svg","g")),X.setAttribute("transform",ye),!(ye=X.transform.baseVal.consolidate()))?I:(ye=ye.matrix,F(ye.a,ye.b,ye.c,ye.d,ye.e,ye.f))}function q(ye,ke,Oe,Qe){function Ve(Rt){return Rt.length?Rt.pop()+" ":""}function Ue(Rt,Mt,It,Bt,St,_t){if(Rt!==It||Mt!==Bt){var it=St.push("translate(",null,ke,null,Oe);_t.push({i:it-4,x:y(Rt,It)},{i:it-2,x:y(Mt,Bt)})}else(It||Bt)&&St.push("translate("+It+ke+Bt+Oe)}function Ie(Rt,Mt,It,Bt){Rt!==Mt?(Rt-Mt>180?Mt+=360:Mt-Rt>180&&(Rt+=360),Bt.push({i:It.push(Ve(It)+"rotate(",null,Qe)-2,x:y(Rt,Mt)})):Mt&&It.push(Ve(It)+"rotate("+Mt+Qe)}function at(Rt,Mt,It,Bt){Rt!==Mt?Bt.push({i:It.push(Ve(It)+"skewX(",null,Qe)-2,x:y(Rt,Mt)}):Mt&&It.push(Ve(It)+"skewX("+Mt+Qe)}function pt(Rt,Mt,It,Bt,St,_t){if(Rt!==It||Mt!==Bt){var it=St.push(Ve(St)+"scale(",null,",",null,")");_t.push({i:it-4,x:y(Rt,It)},{i:it-2,x:y(Mt,Bt)})}else(It!==1||Bt!==1)&&St.push(Ve(St)+"scale("+It+","+Bt+")")}return function(Rt,Mt){var It=[],Bt=[];return Rt=ye(Rt),Mt=ye(Mt),Ue(Rt.translateX,Rt.translateY,Mt.translateX,Mt.translateY,It,Bt),Ie(Rt.rotate,Mt.rotate,It,Bt),at(Rt.skewX,Mt.skewX,It,Bt),pt(Rt.scaleX,Rt.scaleY,Mt.scaleX,Mt.scaleY,It,Bt),Rt=Mt=null,function(St){for(var _t=-1,it=Bt.length,ct;++_t<it;)It[(ct=Bt[_t]).i]=ct.x(St);return It.join("")}}}var K=q(oe,"px, ","px)","deg)"),G=q(se,", ",")",")"),Q=Math.SQRT2,V=2,H=4,ee=1e-12;function J(ye){return((ye=Math.exp(ye))+1/ye)/2}function W(ye){return((ye=Math.exp(ye))-1/ye)/2}function re(ye){return((ye=Math.exp(2*ye))-1)/(ye+1)}function j(ye,ke){var Oe=ye[0],Qe=ye[1],Ve=ye[2],Ue=ke[0],Ie=ke[1],at=ke[2],pt=Ue-Oe,Rt=Ie-Qe,Mt=pt*pt+Rt*Rt,It,Bt;if(Mt<ee)Bt=Math.log(at/Ve)/Q,It=function(Pe){return[Oe+Pe*pt,Qe+Pe*Rt,Ve*Math.exp(Q*Pe*Bt)]};else{var St=Math.sqrt(Mt),_t=(at*at-Ve*Ve+H*Mt)/(2*Ve*V*St),it=(at*at-Ve*Ve-H*Mt)/(2*at*V*St),ct=Math.log(Math.sqrt(_t*_t+1)-_t),et=Math.log(Math.sqrt(it*it+1)-it);Bt=(et-ct)/Q,It=function(Pe){var We=Pe*Bt,je=J(ct),nt=Ve/(V*St)*(je*re(Q*We+ct)-W(ct));return[Oe+nt*pt,Qe+nt*Rt,Ve*je/J(Q*We+ct)]}}return It.duration=Bt*1e3,It}function Z(ye){return function(ke,Oe){var Qe=ye((ke=k.hsl(ke)).h,(Oe=k.hsl(Oe)).h),Ve=n(ke.s,Oe.s),Ue=n(ke.l,Oe.l),Ie=n(ke.opacity,Oe.opacity);return function(at){return ke.h=Qe(at),ke.s=Ve(at),ke.l=Ue(at),ke.opacity=Ie(at),ke+""}}}var ne=Z(t),le=Z(n);function ge(ye,ke){var Oe=n((ye=k.lab(ye)).l,(ke=k.lab(ke)).l),Qe=n(ye.a,ke.a),Ve=n(ye.b,ke.b),Ue=n(ye.opacity,ke.opacity);return function(Ie){return ye.l=Oe(Ie),ye.a=Qe(Ie),ye.b=Ve(Ie),ye.opacity=Ue(Ie),ye+""}}function pe(ye){return function(ke,Oe){var Qe=ye((ke=k.hcl(ke)).h,(Oe=k.hcl(Oe)).h),Ve=n(ke.c,Oe.c),Ue=n(ke.l,Oe.l),Ie=n(ke.opacity,Oe.opacity);return function(at){return ke.h=Qe(at),ke.c=Ve(at),ke.l=Ue(at),ke.opacity=Ie(at),ke+""}}}var xe=pe(t),Ee=pe(n);function Te(ye){return function ke(Oe){Oe=+Oe;function Qe(Ve,Ue){var Ie=ye((Ve=k.cubehelix(Ve)).h,(Ue=k.cubehelix(Ue)).h),at=n(Ve.s,Ue.s),pt=n(Ve.l,Ue.l),Rt=n(Ve.opacity,Ue.opacity);return function(Mt){return Ve.h=Ie(Mt),Ve.s=at(Mt),Ve.l=pt(Math.pow(Mt,Oe)),Ve.opacity=Rt(Mt),Ve+""}}return Qe.gamma=ke,Qe}(1)}var de=Te(t),be=Te(n);function Le(ye,ke){for(var Oe=0,Qe=ke.length-1,Ve=ke[0],Ue=new Array(Qe<0?0:Qe);Oe<Qe;)Ue[Oe]=ye(Ve,Ve=ke[++Oe]);return function(Ie){var at=Math.max(0,Math.min(Qe-1,Math.floor(Ie*=Qe)));return Ue[at](Ie-at)}}function De(ye,ke){for(var Oe=new Array(ke),Qe=0;Qe<ke;++Qe)Oe[Qe]=ye(Qe/(ke-1));return Oe}b.interpolate=o,b.interpolateArray=v,b.interpolateBasis=E,b.interpolateBasisClosed=e,b.interpolateCubehelix=de,b.interpolateCubehelixLong=be,b.interpolateDate=l,b.interpolateDiscrete=S,b.interpolateHcl=xe,b.interpolateHclLong=Ee,b.interpolateHsl=ne,b.interpolateHslLong=le,b.interpolateHue=R,b.interpolateLab=ge,b.interpolateNumber=y,b.interpolateNumberArray=x,b.interpolateObject=T,b.interpolateRgb=r,b.interpolateRgbBasis=s,b.interpolateRgbBasisClosed=m,b.interpolateRound=z,b.interpolateString=h,b.interpolateTransformCss=K,b.interpolateTransformSvg=G,b.interpolateZoom=j,b.piecewise=Le,b.quantize=De,Object.defineProperty(b,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):(b=b||self,k(b.d3=b.d3||{}))})(this,function(b){"use strict";var k=Math.PI,P=2*k,E=1e-6,e=P-E;function p(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function g(){return new p}p.prototype=g.prototype={constructor:p,moveTo:function(a,t){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(a,t){this._+="L"+(this._x1=+a)+","+(this._y1=+t)},quadraticCurveTo:function(a,t,i,n){this._+="Q"+ +a+","+ +t+","+(this._x1=+i)+","+(this._y1=+n)},bezierCurveTo:function(a,t,i,n,r,d){this._+="C"+ +a+","+ +t+","+ +i+","+ +n+","+(this._x1=+r)+","+(this._y1=+d)},arcTo:function(a,t,i,n,r){a=+a,t=+t,i=+i,n=+n,r=+r;var d=this._x1,s=this._y1,m=i-a,x=n-t,M=d-a,v=s-t,_=M*M+v*v;if(r<0)throw new Error("negative radius: "+r);if(this._x1===null)this._+="M"+(this._x1=a)+","+(this._y1=t);else if(_>E)if(!(Math.abs(v*m-x*M)>E)||!r)this._+="L"+(this._x1=a)+","+(this._y1=t);else{var l=i-d,y=n-s,T=m*m+x*x,w=l*l+y*y,A=Math.sqrt(T),f=Math.sqrt(_),u=r*Math.tan((k-Math.acos((T+_-w)/(2*A*f)))/2),h=u/f,o=u/A;Math.abs(h-1)>E&&(this._+="L"+(a+h*M)+","+(t+h*v)),this._+="A"+r+","+r+",0,0,"+ +(v*l>M*y)+","+(this._x1=a+o*m)+","+(this._y1=t+o*x)}},arc:function(a,t,i,n,r,d){a=+a,t=+t,i=+i,d=!!d;var s=i*Math.cos(n),m=i*Math.sin(n),x=a+s,M=t+m,v=1^d,_=d?n-r:r-n;if(i<0)throw new Error("negative radius: "+i);this._x1===null?this._+="M"+x+","+M:(Math.abs(this._x1-x)>E||Math.abs(this._y1-M)>E)&&(this._+="L"+x+","+M),i&&(_<0&&(_=_%P+P),_>e?this._+="A"+i+","+i+",0,1,"+v+","+(a-s)+","+(t-m)+"A"+i+","+i+",0,1,"+v+","+(this._x1=x)+","+(this._y1=M):_>E&&(this._+="A"+i+","+i+",0,"+ +(_>=k)+","+v+","+(this._x1=a+i*Math.cos(r))+","+(this._y1=t+i*Math.sin(r))))},rect:function(a,t,i,n){this._+="M"+(this._x0=this._x1=+a)+","+(this._y0=this._y1=+t)+"h"+ +i+"v"+ +n+"h"+-i+"Z"},toString:function(){return this._}},b.path=g,Object.defineProperty(b,"__esModule",{value:!0})})},{}],118:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):(b=b||self,k(b.d3=b.d3||{}))})(this,function(b){"use strict";function k(A){var f=+this._x.call(null,A),u=+this._y.call(null,A);return P(this.cover(f,u),f,u,A)}function P(A,f,u,h){if(isNaN(f)||isNaN(u))return A;var o,S=A._root,R={data:h},z=A._x0,O=A._y0,I=A._x1,F=A._y1,D,B,U,X,oe,se,q,K;if(!S)return A._root=R,A;for(;S.length;)if((oe=f>=(D=(z+I)/2))?z=D:I=D,(se=u>=(B=(O+F)/2))?O=B:F=B,o=S,!(S=S[q=se<<1|oe]))return o[q]=R,A;if(U=+A._x.call(null,S.data),X=+A._y.call(null,S.data),f===U&&u===X)return R.next=S,o?o[q]=R:A._root=R,A;do o=o?o[q]=new Array(4):A._root=new Array(4),(oe=f>=(D=(z+I)/2))?z=D:I=D,(se=u>=(B=(O+F)/2))?O=B:F=B;while((q=se<<1|oe)===(K=(X>=B)<<1|U>=D));return o[K]=S,o[q]=R,A}function E(A){var f,u,h=A.length,o,S,R=new Array(h),z=new Array(h),O=1/0,I=1/0,F=-1/0,D=-1/0;for(u=0;u<h;++u)isNaN(o=+this._x.call(null,f=A[u]))||isNaN(S=+this._y.call(null,f))||(R[u]=o,z[u]=S,o<O&&(O=o),o>F&&(F=o),S<I&&(I=S),S>D&&(D=S));if(O>F||I>D)return this;for(this.cover(O,I).cover(F,D),u=0;u<h;++u)P(this,R[u],z[u],A[u]);return this}function e(A,f){if(isNaN(A=+A)||isNaN(f=+f))return this;var u=this._x0,h=this._y0,o=this._x1,S=this._y1;if(isNaN(u))o=(u=Math.floor(A))+1,S=(h=Math.floor(f))+1;else{for(var R=o-u,z=this._root,O,I;u>A||A>=o||h>f||f>=S;)switch(I=(f<h)<<1|A<u,O=new Array(4),O[I]=z,z=O,R*=2,I){case 0:o=u+R,S=h+R;break;case 1:u=o-R,S=h+R;break;case 2:o=u+R,h=S-R;break;case 3:u=o-R,h=S-R;break}this._root&&this._root.length&&(this._root=z)}return this._x0=u,this._y0=h,this._x1=o,this._y1=S,this}function p(){var A=[];return this.visit(function(f){if(!f.length)do A.push(f.data);while(f=f.next)}),A}function g(A){return arguments.length?this.cover(+A[0][0],+A[0][1]).cover(+A[1][0],+A[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function a(A,f,u,h,o){this.node=A,this.x0=f,this.y0=u,this.x1=h,this.y1=o}function t(A,f,u){var h,o=this._x0,S=this._y0,R,z,O,I,F=this._x1,D=this._y1,B=[],U=this._root,X,oe;for(U&&B.push(new a(U,o,S,F,D)),u==null?u=1/0:(o=A-u,S=f-u,F=A+u,D=f+u,u*=u);X=B.pop();)if(!(!(U=X.node)||(R=X.x0)>F||(z=X.y0)>D||(O=X.x1)<o||(I=X.y1)<S))if(U.length){var se=(R+O)/2,q=(z+I)/2;B.push(new a(U[3],se,q,O,I),new a(U[2],R,q,se,I),new a(U[1],se,z,O,q),new a(U[0],R,z,se,q)),(oe=(f>=q)<<1|A>=se)&&(X=B[B.length-1],B[B.length-1]=B[B.length-1-oe],B[B.length-1-oe]=X)}else{var K=A-+this._x.call(null,U.data),G=f-+this._y.call(null,U.data),Q=K*K+G*G;if(Q<u){var V=Math.sqrt(u=Q);o=A-V,S=f-V,F=A+V,D=f+V,h=U.data}}return h}function i(A){if(isNaN(F=+this._x.call(null,A))||isNaN(D=+this._y.call(null,A)))return this;var f,u=this._root,h,o,S,R=this._x0,z=this._y0,O=this._x1,I=this._y1,F,D,B,U,X,oe,se,q;if(!u)return this;if(u.length)for(;;){if((X=F>=(B=(R+O)/2))?R=B:O=B,(oe=D>=(U=(z+I)/2))?z=U:I=U,f=u,!(u=u[se=oe<<1|X]))return this;if(!u.length)break;(f[se+1&3]||f[se+2&3]||f[se+3&3])&&(h=f,q=se)}for(;u.data!==A;)if(o=u,!(u=u.next))return this;return(S=u.next)&&delete u.next,o?(S?o.next=S:delete o.next,this):f?(S?f[se]=S:delete f[se],(u=f[0]||f[1]||f[2]||f[3])&&u===(f[3]||f[2]||f[1]||f[0])&&!u.length&&(h?h[q]=u:this._root=u),this):(this._root=S,this)}function n(A){for(var f=0,u=A.length;f<u;++f)this.remove(A[f]);return this}function r(){return this._root}function d(){var A=0;return this.visit(function(f){if(!f.length)do++A;while(f=f.next)}),A}function s(A){var f=[],u,h=this._root,o,S,R,z,O;for(h&&f.push(new a(h,this._x0,this._y0,this._x1,this._y1));u=f.pop();)if(!A(h=u.node,S=u.x0,R=u.y0,z=u.x1,O=u.y1)&&h.length){var I=(S+z)/2,F=(R+O)/2;(o=h[3])&&f.push(new a(o,I,F,z,O)),(o=h[2])&&f.push(new a(o,S,F,I,O)),(o=h[1])&&f.push(new a(o,I,R,z,F)),(o=h[0])&&f.push(new a(o,S,R,I,F))}return this}function m(A){var f=[],u=[],h;for(this._root&&f.push(new a(this._root,this._x0,this._y0,this._x1,this._y1));h=f.pop();){var o=h.node;if(o.length){var S,R=h.x0,z=h.y0,O=h.x1,I=h.y1,F=(R+O)/2,D=(z+I)/2;(S=o[0])&&f.push(new a(S,R,z,F,D)),(S=o[1])&&f.push(new a(S,F,z,O,D)),(S=o[2])&&f.push(new a(S,R,D,F,I)),(S=o[3])&&f.push(new a(S,F,D,O,I))}u.push(h)}for(;h=u.pop();)A(h.node,h.x0,h.y0,h.x1,h.y1);return this}function x(A){return A[0]}function M(A){return arguments.length?(this._x=A,this):this._x}function v(A){return A[1]}function _(A){return arguments.length?(this._y=A,this):this._y}function l(A,f,u){var h=new y(f??x,u??v,NaN,NaN,NaN,NaN);return A==null?h:h.addAll(A)}function y(A,f,u,h,o,S){this._x=A,this._y=f,this._x0=u,this._y0=h,this._x1=o,this._y1=S,this._root=void 0}function T(A){for(var f={data:A.data},u=f;A=A.next;)u=u.next={data:A.data};return f}var w=l.prototype=y.prototype;w.copy=function(){var A=new y(this._x,this._y,this._x0,this._y0,this._x1,this._y1),f=this._root,u,h;if(!f)return A;if(!f.length)return A._root=T(f),A;for(u=[{source:f,target:A._root=new Array(4)}];f=u.pop();)for(var o=0;o<4;++o)(h=f.source[o])&&(h.length?u.push({source:h,target:f.target[o]=new Array(4)}):f.target[o]=T(h));return A},w.add=k,w.addAll=E,w.cover=e,w.data=p,w.extent=g,w.find=t,w.remove=i,w.removeAll=n,w.root=r,w.size=d,w.visit=s,w.visitAfter=m,w.x=M,w.y=_,b.quadtree=l,Object.defineProperty(b,"__esModule",{value:!0})})},{}],119:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie,c("d3-path")):typeof Vr=="function"&&Vr.amd?Vr(["exports","d3-path"],k):(b=b||self,k(b.d3=b.d3||{},b.d3))})(this,function(b,k){"use strict";function P(ot){return function(){return ot}}var E=Math.abs,e=Math.atan2,p=Math.cos,g=Math.max,a=Math.min,t=Math.sin,i=Math.sqrt,n=1e-12,r=Math.PI,d=r/2,s=2*r;function m(ot){return ot>1?0:ot<-1?r:Math.acos(ot)}function x(ot){return ot>=1?d:ot<=-1?-d:Math.asin(ot)}function M(ot){return ot.innerRadius}function v(ot){return ot.outerRadius}function _(ot){return ot.startAngle}function l(ot){return ot.endAngle}function y(ot){return ot&&ot.padAngle}function T(ot,Lt,Xt,tr,Lr,Nr,Rr,Ar){var Kr=Xt-ot,Dn=tr-Lt,Sn=Rr-Lr,Jn=Ar-Nr,Bn=Jn*Kr-Sn*Dn;if(!(Bn*Bn<n))return Bn=(Sn*(Lt-Nr)-Jn*(ot-Lr))/Bn,[ot+Bn*Kr,Lt+Bn*Dn]}function w(ot,Lt,Xt,tr,Lr,Nr,Rr){var Ar=ot-Xt,Kr=Lt-tr,Dn=(Rr?Nr:-Nr)/i(Ar*Ar+Kr*Kr),Sn=Dn*Kr,Jn=-Dn*Ar,Bn=ot+Sn,Xn=Lt+Jn,ea=Xt+Sn,ka=tr+Jn,Ya=(Bn+ea)/2,fi=(Xn+ka)/2,pi=ea-Bn,hi=ka-Xn,Ka=pi*pi+hi*hi,wr=Lr-Nr,gn=Bn*ka-ea*Xn,hn=(hi<0?-1:1)*i(g(0,wr*wr*Ka-gn*gn)),Tn=(gn*hi-pi*hn)/Ka,Vn=(-gn*pi-hi*hn)/Ka,oa=(gn*hi+pi*hn)/Ka,na=(-gn*pi+hi*hn)/Ka,On=Tn-Ya,ta=Vn-fi,Ua=oa-Ya,di=na-fi;return On*On+ta*ta>Ua*Ua+di*di&&(Tn=oa,Vn=na),{cx:Tn,cy:Vn,x01:-Sn,y01:-Jn,x11:Tn*(Lr/wr-1),y11:Vn*(Lr/wr-1)}}function A(){var ot=M,Lt=v,Xt=P(0),tr=null,Lr=_,Nr=l,Rr=y,Ar=null;function Kr(){var Dn,Sn,Jn=+ot.apply(this,arguments),Bn=+Lt.apply(this,arguments),Xn=Lr.apply(this,arguments)-d,ea=Nr.apply(this,arguments)-d,ka=E(ea-Xn),Ya=ea>Xn;if(Ar||(Ar=Dn=k.path()),Bn<Jn&&(Sn=Bn,Bn=Jn,Jn=Sn),!(Bn>n))Ar.moveTo(0,0);else if(ka>s-n)Ar.moveTo(Bn*p(Xn),Bn*t(Xn)),Ar.arc(0,0,Bn,Xn,ea,!Ya),Jn>n&&(Ar.moveTo(Jn*p(ea),Jn*t(ea)),Ar.arc(0,0,Jn,ea,Xn,Ya));else{var fi=Xn,pi=ea,hi=Xn,Ka=ea,wr=ka,gn=ka,hn=Rr.apply(this,arguments)/2,Tn=hn>n&&(tr?+tr.apply(this,arguments):i(Jn*Jn+Bn*Bn)),Vn=a(E(Bn-Jn)/2,+Xt.apply(this,arguments)),oa=Vn,na=Vn,On,ta;if(Tn>n){var Ua=x(Tn/Jn*t(hn)),di=x(Tn/Bn*t(hn));(wr-=Ua*2)>n?(Ua*=Ya?1:-1,hi+=Ua,Ka-=Ua):(wr=0,hi=Ka=(Xn+ea)/2),(gn-=di*2)>n?(di*=Ya?1:-1,fi+=di,pi-=di):(gn=0,fi=pi=(Xn+ea)/2)}var Ft=Bn*p(fi),cr=Bn*t(fi),nn=Jn*p(Ka),vn=Jn*t(Ka);if(Vn>n){var on=Bn*p(pi),Cn=Bn*t(pi),_n=Jn*p(hi),un=Jn*t(hi),dr;if(ka<r&&(dr=T(Ft,cr,_n,un,on,Cn,nn,vn))){var pr=Ft-dr[0],Pr=cr-dr[1],dn=on-dr[0],Un=Cn-dr[1],ra=1/t(m((pr*dn+Pr*Un)/(i(pr*pr+Pr*Pr)*i(dn*dn+Un*Un)))/2),bn=i(dr[0]*dr[0]+dr[1]*dr[1]);oa=a(Vn,(Jn-bn)/(ra-1)),na=a(Vn,(Bn-bn)/(ra+1))}}gn>n?na>n?(On=w(_n,un,Ft,cr,Bn,na,Ya),ta=w(on,Cn,nn,vn,Bn,na,Ya),Ar.moveTo(On.cx+On.x01,On.cy+On.y01),na<Vn?Ar.arc(On.cx,On.cy,na,e(On.y01,On.x01),e(ta.y01,ta.x01),!Ya):(Ar.arc(On.cx,On.cy,na,e(On.y01,On.x01),e(On.y11,On.x11),!Ya),Ar.arc(0,0,Bn,e(On.cy+On.y11,On.cx+On.x11),e(ta.cy+ta.y11,ta.cx+ta.x11),!Ya),Ar.arc(ta.cx,ta.cy,na,e(ta.y11,ta.x11),e(ta.y01,ta.x01),!Ya))):(Ar.moveTo(Ft,cr),Ar.arc(0,0,Bn,fi,pi,!Ya)):Ar.moveTo(Ft,cr),!(Jn>n)||!(wr>n)?Ar.lineTo(nn,vn):oa>n?(On=w(nn,vn,on,Cn,Jn,-oa,Ya),ta=w(Ft,cr,_n,un,Jn,-oa,Ya),Ar.lineTo(On.cx+On.x01,On.cy+On.y01),oa<Vn?Ar.arc(On.cx,On.cy,oa,e(On.y01,On.x01),e(ta.y01,ta.x01),!Ya):(Ar.arc(On.cx,On.cy,oa,e(On.y01,On.x01),e(On.y11,On.x11),!Ya),Ar.arc(0,0,Jn,e(On.cy+On.y11,On.cx+On.x11),e(ta.cy+ta.y11,ta.cx+ta.x11),Ya),Ar.arc(ta.cx,ta.cy,oa,e(ta.y11,ta.x11),e(ta.y01,ta.x01),!Ya))):Ar.arc(0,0,Jn,Ka,hi,Ya)}if(Ar.closePath(),Dn)return Ar=null,Dn+""||null}return Kr.centroid=function(){var Dn=(+ot.apply(this,arguments)+ +Lt.apply(this,arguments))/2,Sn=(+Lr.apply(this,arguments)+ +Nr.apply(this,arguments))/2-r/2;return[p(Sn)*Dn,t(Sn)*Dn]},Kr.innerRadius=function(Dn){return arguments.length?(ot=typeof Dn=="function"?Dn:P(+Dn),Kr):ot},Kr.outerRadius=function(Dn){return arguments.length?(Lt=typeof Dn=="function"?Dn:P(+Dn),Kr):Lt},Kr.cornerRadius=function(Dn){return arguments.length?(Xt=typeof Dn=="function"?Dn:P(+Dn),Kr):Xt},Kr.padRadius=function(Dn){return arguments.length?(tr=Dn==null?null:typeof Dn=="function"?Dn:P(+Dn),Kr):tr},Kr.startAngle=function(Dn){return arguments.length?(Lr=typeof Dn=="function"?Dn:P(+Dn),Kr):Lr},Kr.endAngle=function(Dn){return arguments.length?(Nr=typeof Dn=="function"?Dn:P(+Dn),Kr):Nr},Kr.padAngle=function(Dn){return arguments.length?(Rr=typeof Dn=="function"?Dn:P(+Dn),Kr):Rr},Kr.context=function(Dn){return arguments.length?(Ar=Dn??null,Kr):Ar},Kr}function f(ot){this._context=ot}f.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(ot,Lt){switch(ot=+ot,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(ot,Lt):this._context.moveTo(ot,Lt);break;case 1:this._point=2;default:this._context.lineTo(ot,Lt);break}}};function u(ot){return new f(ot)}function h(ot){return ot[0]}function o(ot){return ot[1]}function S(){var ot=h,Lt=o,Xt=P(!0),tr=null,Lr=u,Nr=null;function Rr(Ar){var Kr,Dn=Ar.length,Sn,Jn=!1,Bn;for(tr==null&&(Nr=Lr(Bn=k.path())),Kr=0;Kr<=Dn;++Kr)!(Kr<Dn&&Xt(Sn=Ar[Kr],Kr,Ar))===Jn&&((Jn=!Jn)?Nr.lineStart():Nr.lineEnd()),Jn&&Nr.point(+ot(Sn,Kr,Ar),+Lt(Sn,Kr,Ar));if(Bn)return Nr=null,Bn+""||null}return Rr.x=function(Ar){return arguments.length?(ot=typeof Ar=="function"?Ar:P(+Ar),Rr):ot},Rr.y=function(Ar){return arguments.length?(Lt=typeof Ar=="function"?Ar:P(+Ar),Rr):Lt},Rr.defined=function(Ar){return arguments.length?(Xt=typeof Ar=="function"?Ar:P(!!Ar),Rr):Xt},Rr.curve=function(Ar){return arguments.length?(Lr=Ar,tr!=null&&(Nr=Lr(tr)),Rr):Lr},Rr.context=function(Ar){return arguments.length?(Ar==null?tr=Nr=null:Nr=Lr(tr=Ar),Rr):tr},Rr}function R(){var ot=h,Lt=null,Xt=P(0),tr=o,Lr=P(!0),Nr=null,Rr=u,Ar=null;function Kr(Sn){var Jn,Bn,Xn,ea=Sn.length,ka,Ya=!1,fi,pi=new Array(ea),hi=new Array(ea);for(Nr==null&&(Ar=Rr(fi=k.path())),Jn=0;Jn<=ea;++Jn){if(!(Jn<ea&&Lr(ka=Sn[Jn],Jn,Sn))===Ya)if(Ya=!Ya)Bn=Jn,Ar.areaStart(),Ar.lineStart();else{for(Ar.lineEnd(),Ar.lineStart(),Xn=Jn-1;Xn>=Bn;--Xn)Ar.point(pi[Xn],hi[Xn]);Ar.lineEnd(),Ar.areaEnd()}Ya&&(pi[Jn]=+ot(ka,Jn,Sn),hi[Jn]=+Xt(ka,Jn,Sn),Ar.point(Lt?+Lt(ka,Jn,Sn):pi[Jn],tr?+tr(ka,Jn,Sn):hi[Jn]))}if(fi)return Ar=null,fi+""||null}function Dn(){return S().defined(Lr).curve(Rr).context(Nr)}return Kr.x=function(Sn){return arguments.length?(ot=typeof Sn=="function"?Sn:P(+Sn),Lt=null,Kr):ot},Kr.x0=function(Sn){return arguments.length?(ot=typeof Sn=="function"?Sn:P(+Sn),Kr):ot},Kr.x1=function(Sn){return arguments.length?(Lt=Sn==null?null:typeof Sn=="function"?Sn:P(+Sn),Kr):Lt},Kr.y=function(Sn){return arguments.length?(Xt=typeof Sn=="function"?Sn:P(+Sn),tr=null,Kr):Xt},Kr.y0=function(Sn){return arguments.length?(Xt=typeof Sn=="function"?Sn:P(+Sn),Kr):Xt},Kr.y1=function(Sn){return arguments.length?(tr=Sn==null?null:typeof Sn=="function"?Sn:P(+Sn),Kr):tr},Kr.lineX0=Kr.lineY0=function(){return Dn().x(ot).y(Xt)},Kr.lineY1=function(){return Dn().x(ot).y(tr)},Kr.lineX1=function(){return Dn().x(Lt).y(Xt)},Kr.defined=function(Sn){return arguments.length?(Lr=typeof Sn=="function"?Sn:P(!!Sn),Kr):Lr},Kr.curve=function(Sn){return arguments.length?(Rr=Sn,Nr!=null&&(Ar=Rr(Nr)),Kr):Rr},Kr.context=function(Sn){return arguments.length?(Sn==null?Nr=Ar=null:Ar=Rr(Nr=Sn),Kr):Nr},Kr}function z(ot,Lt){return Lt<ot?-1:Lt>ot?1:Lt>=ot?0:NaN}function O(ot){return ot}function I(){var ot=O,Lt=z,Xt=null,tr=P(0),Lr=P(s),Nr=P(0);function Rr(Ar){var Kr,Dn=Ar.length,Sn,Jn,Bn=0,Xn=new Array(Dn),ea=new Array(Dn),ka=+tr.apply(this,arguments),Ya=Math.min(s,Math.max(-s,Lr.apply(this,arguments)-ka)),fi,pi=Math.min(Math.abs(Ya)/Dn,Nr.apply(this,arguments)),hi=pi*(Ya<0?-1:1),Ka;for(Kr=0;Kr<Dn;++Kr)(Ka=ea[Xn[Kr]=Kr]=+ot(Ar[Kr],Kr,Ar))>0&&(Bn+=Ka);for(Lt!=null?Xn.sort(function(wr,gn){return Lt(ea[wr],ea[gn])}):Xt!=null&&Xn.sort(function(wr,gn){return Xt(Ar[wr],Ar[gn])}),Kr=0,Jn=Bn?(Ya-Dn*hi)/Bn:0;Kr<Dn;++Kr,ka=fi)Sn=Xn[Kr],Ka=ea[Sn],fi=ka+(Ka>0?Ka*Jn:0)+hi,ea[Sn]={data:Ar[Sn],index:Kr,value:Ka,startAngle:ka,endAngle:fi,padAngle:pi};return ea}return Rr.value=function(Ar){return arguments.length?(ot=typeof Ar=="function"?Ar:P(+Ar),Rr):ot},Rr.sortValues=function(Ar){return arguments.length?(Lt=Ar,Xt=null,Rr):Lt},Rr.sort=function(Ar){return arguments.length?(Xt=Ar,Lt=null,Rr):Xt},Rr.startAngle=function(Ar){return arguments.length?(tr=typeof Ar=="function"?Ar:P(+Ar),Rr):tr},Rr.endAngle=function(Ar){return arguments.length?(Lr=typeof Ar=="function"?Ar:P(+Ar),Rr):Lr},Rr.padAngle=function(Ar){return arguments.length?(Nr=typeof Ar=="function"?Ar:P(+Ar),Rr):Nr},Rr}var F=B(u);function D(ot){this._curve=ot}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(ot,Lt){this._curve.point(Lt*Math.sin(ot),Lt*-Math.cos(ot))}};function B(ot){function Lt(Xt){return new D(ot(Xt))}return Lt._curve=ot,Lt}function U(ot){var Lt=ot.curve;return ot.angle=ot.x,delete ot.x,ot.radius=ot.y,delete ot.y,ot.curve=function(Xt){return arguments.length?Lt(B(Xt)):Lt()._curve},ot}function X(){return U(S().curve(F))}function oe(){var ot=R().curve(F),Lt=ot.curve,Xt=ot.lineX0,tr=ot.lineX1,Lr=ot.lineY0,Nr=ot.lineY1;return ot.angle=ot.x,delete ot.x,ot.startAngle=ot.x0,delete ot.x0,ot.endAngle=ot.x1,delete ot.x1,ot.radius=ot.y,delete ot.y,ot.innerRadius=ot.y0,delete ot.y0,ot.outerRadius=ot.y1,delete ot.y1,ot.lineStartAngle=function(){return U(Xt())},delete ot.lineX0,ot.lineEndAngle=function(){return U(tr())},delete ot.lineX1,ot.lineInnerRadius=function(){return U(Lr())},delete ot.lineY0,ot.lineOuterRadius=function(){return U(Nr())},delete ot.lineY1,ot.curve=function(Rr){return arguments.length?Lt(B(Rr)):Lt()._curve},ot}function se(ot,Lt){return[(Lt=+Lt)*Math.cos(ot-=Math.PI/2),Lt*Math.sin(ot)]}var q=Array.prototype.slice;function K(ot){return ot.source}function G(ot){return ot.target}function Q(ot){var Lt=K,Xt=G,tr=h,Lr=o,Nr=null;function Rr(){var Ar,Kr=q.call(arguments),Dn=Lt.apply(this,Kr),Sn=Xt.apply(this,Kr);if(Nr||(Nr=Ar=k.path()),ot(Nr,+tr.apply(this,(Kr[0]=Dn,Kr)),+Lr.apply(this,Kr),+tr.apply(this,(Kr[0]=Sn,Kr)),+Lr.apply(this,Kr)),Ar)return Nr=null,Ar+""||null}return Rr.source=function(Ar){return arguments.length?(Lt=Ar,Rr):Lt},Rr.target=function(Ar){return arguments.length?(Xt=Ar,Rr):Xt},Rr.x=function(Ar){return arguments.length?(tr=typeof Ar=="function"?Ar:P(+Ar),Rr):tr},Rr.y=function(Ar){return arguments.length?(Lr=typeof Ar=="function"?Ar:P(+Ar),Rr):Lr},Rr.context=function(Ar){return arguments.length?(Nr=Ar??null,Rr):Nr},Rr}function V(ot,Lt,Xt,tr,Lr){ot.moveTo(Lt,Xt),ot.bezierCurveTo(Lt=(Lt+tr)/2,Xt,Lt,Lr,tr,Lr)}function H(ot,Lt,Xt,tr,Lr){ot.moveTo(Lt,Xt),ot.bezierCurveTo(Lt,Xt=(Xt+Lr)/2,tr,Xt,tr,Lr)}function ee(ot,Lt,Xt,tr,Lr){var Nr=se(Lt,Xt),Rr=se(Lt,Xt=(Xt+Lr)/2),Ar=se(tr,Xt),Kr=se(tr,Lr);ot.moveTo(Nr[0],Nr[1]),ot.bezierCurveTo(Rr[0],Rr[1],Ar[0],Ar[1],Kr[0],Kr[1])}function J(){return Q(V)}function W(){return Q(H)}function re(){var ot=Q(ee);return ot.angle=ot.x,delete ot.x,ot.radius=ot.y,delete ot.y,ot}var j={draw:function(ot,Lt){var Xt=Math.sqrt(Lt/r);ot.moveTo(Xt,0),ot.arc(0,0,Xt,0,s)}},Z={draw:function(ot,Lt){var Xt=Math.sqrt(Lt/5)/2;ot.moveTo(-3*Xt,-Xt),ot.lineTo(-Xt,-Xt),ot.lineTo(-Xt,-3*Xt),ot.lineTo(Xt,-3*Xt),ot.lineTo(Xt,-Xt),ot.lineTo(3*Xt,-Xt),ot.lineTo(3*Xt,Xt),ot.lineTo(Xt,Xt),ot.lineTo(Xt,3*Xt),ot.lineTo(-Xt,3*Xt),ot.lineTo(-Xt,Xt),ot.lineTo(-3*Xt,Xt),ot.closePath()}},ne=Math.sqrt(1/3),le=ne*2,ge={draw:function(ot,Lt){var Xt=Math.sqrt(Lt/le),tr=Xt*ne;ot.moveTo(0,-Xt),ot.lineTo(tr,0),ot.lineTo(0,Xt),ot.lineTo(-tr,0),ot.closePath()}},pe=.8908130915292852,xe=Math.sin(r/10)/Math.sin(7*r/10),Ee=Math.sin(s/10)*xe,Te=-Math.cos(s/10)*xe,de={draw:function(ot,Lt){var Xt=Math.sqrt(Lt*pe),tr=Ee*Xt,Lr=Te*Xt;ot.moveTo(0,-Xt),ot.lineTo(tr,Lr);for(var Nr=1;Nr<5;++Nr){var Rr=s*Nr/5,Ar=Math.cos(Rr),Kr=Math.sin(Rr);ot.lineTo(Kr*Xt,-Ar*Xt),ot.lineTo(Ar*tr-Kr*Lr,Kr*tr+Ar*Lr)}ot.closePath()}},be={draw:function(ot,Lt){var Xt=Math.sqrt(Lt),tr=-Xt/2;ot.rect(tr,tr,Xt,Xt)}},Le=Math.sqrt(3),De={draw:function(ot,Lt){var Xt=-Math.sqrt(Lt/(Le*3));ot.moveTo(0,Xt*2),ot.lineTo(-Le*Xt,-Xt),ot.lineTo(Le*Xt,-Xt),ot.closePath()}},ye=-.5,ke=Math.sqrt(3)/2,Oe=1/Math.sqrt(12),Qe=(Oe/2+1)*3,Ve={draw:function(ot,Lt){var Xt=Math.sqrt(Lt/Qe),tr=Xt/2,Lr=Xt*Oe,Nr=tr,Rr=Xt*Oe+Xt,Ar=-Nr,Kr=Rr;ot.moveTo(tr,Lr),ot.lineTo(Nr,Rr),ot.lineTo(Ar,Kr),ot.lineTo(ye*tr-ke*Lr,ke*tr+ye*Lr),ot.lineTo(ye*Nr-ke*Rr,ke*Nr+ye*Rr),ot.lineTo(ye*Ar-ke*Kr,ke*Ar+ye*Kr),ot.lineTo(ye*tr+ke*Lr,ye*Lr-ke*tr),ot.lineTo(ye*Nr+ke*Rr,ye*Rr-ke*Nr),ot.lineTo(ye*Ar+ke*Kr,ye*Kr-ke*Ar),ot.closePath()}},Ue=[j,Z,ge,be,de,De,Ve];function Ie(){var ot=P(j),Lt=P(64),Xt=null;function tr(){var Lr;if(Xt||(Xt=Lr=k.path()),ot.apply(this,arguments).draw(Xt,+Lt.apply(this,arguments)),Lr)return Xt=null,Lr+""||null}return tr.type=function(Lr){return arguments.length?(ot=typeof Lr=="function"?Lr:P(Lr),tr):ot},tr.size=function(Lr){return arguments.length?(Lt=typeof Lr=="function"?Lr:P(+Lr),tr):Lt},tr.context=function(Lr){return arguments.length?(Xt=Lr??null,tr):Xt},tr}function at(){}function pt(ot,Lt,Xt){ot._context.bezierCurveTo((2*ot._x0+ot._x1)/3,(2*ot._y0+ot._y1)/3,(ot._x0+2*ot._x1)/3,(ot._y0+2*ot._y1)/3,(ot._x0+4*ot._x1+Lt)/6,(ot._y0+4*ot._y1+Xt)/6)}function Rt(ot){this._context=ot}Rt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:pt(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(ot,Lt){switch(ot=+ot,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(ot,Lt):this._context.moveTo(ot,Lt);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:pt(this,ot,Lt);break}this._x0=this._x1,this._x1=ot,this._y0=this._y1,this._y1=Lt}};function Mt(ot){return new Rt(ot)}function It(ot){this._context=ot}It.prototype={areaStart:at,areaEnd:at,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(ot,Lt){switch(ot=+ot,Lt=+Lt,this._point){case 0:this._point=1,this._x2=ot,this._y2=Lt;break;case 1:this._point=2,this._x3=ot,this._y3=Lt;break;case 2:this._point=3,this._x4=ot,this._y4=Lt,this._context.moveTo((this._x0+4*this._x1+ot)/6,(this._y0+4*this._y1+Lt)/6);break;default:pt(this,ot,Lt);break}this._x0=this._x1,this._x1=ot,this._y0=this._y1,this._y1=Lt}};function Bt(ot){return new It(ot)}function St(ot){this._context=ot}St.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(ot,Lt){switch(ot=+ot,Lt=+Lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var Xt=(this._x0+4*this._x1+ot)/6,tr=(this._y0+4*this._y1+Lt)/6;this._line?this._context.lineTo(Xt,tr):this._context.moveTo(Xt,tr);break;case 3:this._point=4;default:pt(this,ot,Lt);break}this._x0=this._x1,this._x1=ot,this._y0=this._y1,this._y1=Lt}};function _t(ot){return new St(ot)}function it(ot,Lt){this._basis=new Rt(ot),this._beta=Lt}it.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var ot=this._x,Lt=this._y,Xt=ot.length-1;if(Xt>0)for(var tr=ot[0],Lr=Lt[0],Nr=ot[Xt]-tr,Rr=Lt[Xt]-Lr,Ar=-1,Kr;++Ar<=Xt;)Kr=Ar/Xt,this._basis.point(this._beta*ot[Ar]+(1-this._beta)*(tr+Kr*Nr),this._beta*Lt[Ar]+(1-this._beta)*(Lr+Kr*Rr));this._x=this._y=null,this._basis.lineEnd()},point:function(ot,Lt){this._x.push(+ot),this._y.push(+Lt)}};var ct=function ot(Lt){function Xt(tr){return Lt===1?new Rt(tr):new it(tr,Lt)}return Xt.beta=function(tr){return ot(+tr)},Xt}(.85);function et(ot,Lt,Xt){ot._context.bezierCurveTo(ot._x1+ot._k*(ot._x2-ot._x0),ot._y1+ot._k*(ot._y2-ot._y0),ot._x2+ot._k*(ot._x1-Lt),ot._y2+ot._k*(ot._y1-Xt),ot._x2,ot._y2)}function Pe(ot,Lt){this._context=ot,this._k=(1-Lt)/6}Pe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:et(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(ot,Lt){switch(ot=+ot,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(ot,Lt):this._context.moveTo(ot,Lt);break;case 1:this._point=2,this._x1=ot,this._y1=Lt;break;case 2:this._point=3;default:et(this,ot,Lt);break}this._x0=this._x1,this._x1=this._x2,this._x2=ot,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var We=function ot(Lt){function Xt(tr){return new Pe(tr,Lt)}return Xt.tension=function(tr){return ot(+tr)},Xt}(0);function je(ot,Lt){this._context=ot,this._k=(1-Lt)/6}je.prototype={areaStart:at,areaEnd:at,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(ot,Lt){switch(ot=+ot,Lt=+Lt,this._point){case 0:this._point=1,this._x3=ot,this._y3=Lt;break;case 1:this._point=2,this._context.moveTo(this._x4=ot,this._y4=Lt);break;case 2:this._point=3,this._x5=ot,this._y5=Lt;break;default:et(this,ot,Lt);break}this._x0=this._x1,this._x1=this._x2,this._x2=ot,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var nt=function ot(Lt){function Xt(tr){return new je(tr,Lt)}return Xt.tension=function(tr){return ot(+tr)},Xt}(0);function kt(ot,Lt){this._context=ot,this._k=(1-Lt)/6}kt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(ot,Lt){switch(ot=+ot,Lt=+Lt,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:et(this,ot,Lt);break}this._x0=this._x1,this._x1=this._x2,this._x2=ot,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var wt=function ot(Lt){function Xt(tr){return new kt(tr,Lt)}return Xt.tension=function(tr){return ot(+tr)},Xt}(0);function Vt(ot,Lt,Xt){var tr=ot._x1,Lr=ot._y1,Nr=ot._x2,Rr=ot._y2;if(ot._l01_a>n){var Ar=2*ot._l01_2a+3*ot._l01_a*ot._l12_a+ot._l12_2a,Kr=3*ot._l01_a*(ot._l01_a+ot._l12_a);tr=(tr*Ar-ot._x0*ot._l12_2a+ot._x2*ot._l01_2a)/Kr,Lr=(Lr*Ar-ot._y0*ot._l12_2a+ot._y2*ot._l01_2a)/Kr}if(ot._l23_a>n){var Dn=2*ot._l23_2a+3*ot._l23_a*ot._l12_a+ot._l12_2a,Sn=3*ot._l23_a*(ot._l23_a+ot._l12_a);Nr=(Nr*Dn+ot._x1*ot._l23_2a-Lt*ot._l12_2a)/Sn,Rr=(Rr*Dn+ot._y1*ot._l23_2a-Xt*ot._l12_2a)/Sn}ot._context.bezierCurveTo(tr,Lr,Nr,Rr,ot._x2,ot._y2)}function qt(ot,Lt){this._context=ot,this._alpha=Lt}qt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(ot,Lt){if(ot=+ot,Lt=+Lt,this._point){var Xt=this._x2-ot,tr=this._y2-Lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Xt*Xt+tr*tr,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(ot,Lt):this._context.moveTo(ot,Lt);break;case 1:this._point=2;break;case 2:this._point=3;default:Vt(this,ot,Lt);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=ot,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var zt=function ot(Lt){function Xt(tr){return Lt?new qt(tr,Lt):new Pe(tr,0)}return Xt.alpha=function(tr){return ot(+tr)},Xt}(.5);function Ht(ot,Lt){this._context=ot,this._alpha=Lt}Ht.prototype={areaStart:at,areaEnd:at,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(ot,Lt){if(ot=+ot,Lt=+Lt,this._point){var Xt=this._x2-ot,tr=this._y2-Lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Xt*Xt+tr*tr,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=ot,this._y3=Lt;break;case 1:this._point=2,this._context.moveTo(this._x4=ot,this._y4=Lt);break;case 2:this._point=3,this._x5=ot,this._y5=Lt;break;default:Vt(this,ot,Lt);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=ot,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var $t=function ot(Lt){function Xt(tr){return Lt?new Ht(tr,Lt):new je(tr,0)}return Xt.alpha=function(tr){return ot(+tr)},Xt}(.5);function Qt(ot,Lt){this._context=ot,this._alpha=Lt}Qt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(ot,Lt){if(ot=+ot,Lt=+Lt,this._point){var Xt=this._x2-ot,tr=this._y2-Lt;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Xt*Xt+tr*tr,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Vt(this,ot,Lt);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=ot,this._y0=this._y1,this._y1=this._y2,this._y2=Lt}};var fr=function ot(Lt){function Xt(tr){return Lt?new Qt(tr,Lt):new kt(tr,0)}return Xt.alpha=function(tr){return ot(+tr)},Xt}(.5);function jr(ot){this._context=ot}jr.prototype={areaStart:at,areaEnd:at,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(ot,Lt){ot=+ot,Lt=+Lt,this._point?this._context.lineTo(ot,Lt):(this._point=1,this._context.moveTo(ot,Lt))}};function cn(ot){return new jr(ot)}function Qr(ot){return ot<0?-1:1}function lt(ot,Lt,Xt){var tr=ot._x1-ot._x0,Lr=Lt-ot._x1,Nr=(ot._y1-ot._y0)/(tr||Lr<0&&-0),Rr=(Xt-ot._y1)/(Lr||tr<0&&-0),Ar=(Nr*Lr+Rr*tr)/(tr+Lr);return(Qr(Nr)+Qr(Rr))*Math.min(Math.abs(Nr),Math.abs(Rr),.5*Math.abs(Ar))||0}function Gt(ot,Lt){var Xt=ot._x1-ot._x0;return Xt?(3*(ot._y1-ot._y0)/Xt-Lt)/2:Lt}function Kt(ot,Lt,Xt){var tr=ot._x0,Lr=ot._y0,Nr=ot._x1,Rr=ot._y1,Ar=(Nr-tr)/3;ot._context.bezierCurveTo(tr+Ar,Lr+Ar*Lt,Nr-Ar,Rr-Ar*Xt,Nr,Rr)}function Nt(ot){this._context=ot}Nt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Kt(this,this._t0,Gt(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(ot,Lt){var Xt=NaN;if(ot=+ot,Lt=+Lt,!(ot===this._x1&&Lt===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(ot,Lt):this._context.moveTo(ot,Lt);break;case 1:this._point=2;break;case 2:this._point=3,Kt(this,Gt(this,Xt=lt(this,ot,Lt)),Xt);break;default:Kt(this,this._t0,Xt=lt(this,ot,Lt));break}this._x0=this._x1,this._x1=ot,this._y0=this._y1,this._y1=Lt,this._t0=Xt}}};function gr(ot){this._context=new tt(ot)}(gr.prototype=Object.create(Nt.prototype)).point=function(ot,Lt){Nt.prototype.point.call(this,Lt,ot)};function tt(ot){this._context=ot}tt.prototype={moveTo:function(ot,Lt){this._context.moveTo(Lt,ot)},closePath:function(){this._context.closePath()},lineTo:function(ot,Lt){this._context.lineTo(Lt,ot)},bezierCurveTo:function(ot,Lt,Xt,tr,Lr,Nr){this._context.bezierCurveTo(Lt,ot,tr,Xt,Nr,Lr)}};function we(ot){return new Nt(ot)}function Me(ot){return new gr(ot)}function Ne(ot){this._context=ot}Ne.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var ot=this._x,Lt=this._y,Xt=ot.length;if(Xt)if(this._line?this._context.lineTo(ot[0],Lt[0]):this._context.moveTo(ot[0],Lt[0]),Xt===2)this._context.lineTo(ot[1],Lt[1]);else for(var tr=Xe(ot),Lr=Xe(Lt),Nr=0,Rr=1;Rr<Xt;++Nr,++Rr)this._context.bezierCurveTo(tr[0][Nr],Lr[0][Nr],tr[1][Nr],Lr[1][Nr],ot[Rr],Lt[Rr]);(this._line||this._line!==0&&Xt===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(ot,Lt){this._x.push(+ot),this._y.push(+Lt)}};function Xe(ot){var Lt,Xt=ot.length-1,tr,Lr=new Array(Xt),Nr=new Array(Xt),Rr=new Array(Xt);for(Lr[0]=0,Nr[0]=2,Rr[0]=ot[0]+2*ot[1],Lt=1;Lt<Xt-1;++Lt)Lr[Lt]=1,Nr[Lt]=4,Rr[Lt]=4*ot[Lt]+2*ot[Lt+1];for(Lr[Xt-1]=2,Nr[Xt-1]=7,Rr[Xt-1]=8*ot[Xt-1]+ot[Xt],Lt=1;Lt<Xt;++Lt)tr=Lr[Lt]/Nr[Lt-1],Nr[Lt]-=tr,Rr[Lt]-=tr*Rr[Lt-1];for(Lr[Xt-1]=Rr[Xt-1]/Nr[Xt-1],Lt=Xt-2;Lt>=0;--Lt)Lr[Lt]=(Rr[Lt]-Lr[Lt+1])/Nr[Lt];for(Nr[Xt-1]=(ot[Xt]+Lr[Xt-1])/2,Lt=0;Lt<Xt-1;++Lt)Nr[Lt]=2*ot[Lt+1]-Lr[Lt+1];return[Lr,Nr]}function Ke(ot){return new Ne(ot)}function rt(ot,Lt){this._context=ot,this._t=Lt}rt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(ot,Lt){switch(ot=+ot,Lt=+Lt,this._point){case 0:this._point=1,this._line?this._context.lineTo(ot,Lt):this._context.moveTo(ot,Lt);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,Lt),this._context.lineTo(ot,Lt);else{var Xt=this._x*(1-this._t)+ot*this._t;this._context.lineTo(Xt,this._y),this._context.lineTo(Xt,Lt)}break}}this._x=ot,this._y=Lt}};function Je(ot){return new rt(ot,.5)}function vt(ot){return new rt(ot,0)}function bt(ot){return new rt(ot,1)}function Et(ot,Lt){if((Rr=ot.length)>1)for(var Xt=1,tr,Lr,Nr=ot[Lt[0]],Rr,Ar=Nr.length;Xt<Rr;++Xt)for(Lr=Nr,Nr=ot[Lt[Xt]],tr=0;tr<Ar;++tr)Nr[tr][1]+=Nr[tr][0]=isNaN(Lr[tr][1])?Lr[tr][0]:Lr[tr][1]}function Wt(ot){for(var Lt=ot.length,Xt=new Array(Lt);--Lt>=0;)Xt[Lt]=Lt;return Xt}function Ot(ot,Lt){return ot[Lt]}function ir(){var ot=P([]),Lt=Wt,Xt=Et,tr=Ot;function Lr(Nr){var Rr=ot.apply(this,arguments),Ar,Kr=Nr.length,Dn=Rr.length,Sn=new Array(Dn),Jn;for(Ar=0;Ar<Dn;++Ar){for(var Bn=Rr[Ar],Xn=Sn[Ar]=new Array(Kr),ea=0,ka;ea<Kr;++ea)Xn[ea]=ka=[0,+tr(Nr[ea],Bn,ea,Nr)],ka.data=Nr[ea];Xn.key=Bn}for(Ar=0,Jn=Lt(Sn);Ar<Dn;++Ar)Sn[Jn[Ar]].index=Ar;return Xt(Sn,Jn),Sn}return Lr.keys=function(Nr){return arguments.length?(ot=typeof Nr=="function"?Nr:P(q.call(Nr)),Lr):ot},Lr.value=function(Nr){return arguments.length?(tr=typeof Nr=="function"?Nr:P(+Nr),Lr):tr},Lr.order=function(Nr){return arguments.length?(Lt=Nr==null?Wt:typeof Nr=="function"?Nr:P(q.call(Nr)),Lr):Lt},Lr.offset=function(Nr){return arguments.length?(Xt=Nr??Et,Lr):Xt},Lr}function vr(ot,Lt){if((tr=ot.length)>0){for(var Xt,tr,Lr=0,Nr=ot[0].length,Rr;Lr<Nr;++Lr){for(Rr=Xt=0;Xt<tr;++Xt)Rr+=ot[Xt][Lr][1]||0;if(Rr)for(Xt=0;Xt<tr;++Xt)ot[Xt][Lr][1]/=Rr}Et(ot,Lt)}}function _r(ot,Lt){if((Kr=ot.length)>0)for(var Xt,tr=0,Lr,Nr,Rr,Ar,Kr,Dn=ot[Lt[0]].length;tr<Dn;++tr)for(Rr=Ar=0,Xt=0;Xt<Kr;++Xt)(Nr=(Lr=ot[Lt[Xt]][tr])[1]-Lr[0])>0?(Lr[0]=Rr,Lr[1]=Rr+=Nr):Nr<0?(Lr[1]=Ar,Lr[0]=Ar+=Nr):(Lr[0]=0,Lr[1]=Nr)}function ln(ot,Lt){if((Lr=ot.length)>0){for(var Xt=0,tr=ot[Lt[0]],Lr,Nr=tr.length;Xt<Nr;++Xt){for(var Rr=0,Ar=0;Rr<Lr;++Rr)Ar+=ot[Rr][Xt][1]||0;tr[Xt][1]+=tr[Xt][0]=-Ar/2}Et(ot,Lt)}}function Cr(ot,Lt){if(!(!((Rr=ot.length)>0)||!((Nr=(Lr=ot[Lt[0]]).length)>0))){for(var Xt=0,tr=1,Lr,Nr,Rr;tr<Nr;++tr){for(var Ar=0,Kr=0,Dn=0;Ar<Rr;++Ar){for(var Sn=ot[Lt[Ar]],Jn=Sn[tr][1]||0,Bn=Sn[tr-1][1]||0,Xn=(Jn-Bn)/2,ea=0;ea<Ar;++ea){var ka=ot[Lt[ea]],Ya=ka[tr][1]||0,fi=ka[tr-1][1]||0;Xn+=Ya-fi}Kr+=Jn,Dn+=Xn*Jn}Lr[tr-1][1]+=Lr[tr-1][0]=Xt,Kr&&(Xt-=Dn/Kr)}Lr[tr-1][1]+=Lr[tr-1][0]=Xt,Et(ot,Lt)}}function Gr(ot){var Lt=ot.map(sn);return Wt(ot).sort(function(Xt,tr){return Lt[Xt]-Lt[tr]})}function sn(ot){for(var Lt=-1,Xt=0,tr=ot.length,Lr,Nr=-1/0;++Lt<tr;)(Lr=+ot[Lt][1])>Nr&&(Nr=Lr,Xt=Lt);return Xt}function yr(ot){var Lt=ot.map(mr);return Wt(ot).sort(function(Xt,tr){return Lt[Xt]-Lt[tr]})}function mr(ot){for(var Lt=0,Xt=-1,tr=ot.length,Lr;++Xt<tr;)(Lr=+ot[Xt][1])&&(Lt+=Lr);return Lt}function Or(ot){return yr(ot).reverse()}function zr(ot){var Lt=ot.length,Xt,tr,Lr=ot.map(mr),Nr=Gr(ot),Rr=0,Ar=0,Kr=[],Dn=[];for(Xt=0;Xt<Lt;++Xt)tr=Nr[Xt],Rr<Ar?(Rr+=Lr[tr],Kr.push(tr)):(Ar+=Lr[tr],Dn.push(tr));return Dn.reverse().concat(Kr)}function Sr(ot){return Wt(ot).reverse()}b.arc=A,b.area=R,b.areaRadial=oe,b.curveBasis=Mt,b.curveBasisClosed=Bt,b.curveBasisOpen=_t,b.curveBundle=ct,b.curveCardinal=We,b.curveCardinalClosed=nt,b.curveCardinalOpen=wt,b.curveCatmullRom=zt,b.curveCatmullRomClosed=$t,b.curveCatmullRomOpen=fr,b.curveLinear=u,b.curveLinearClosed=cn,b.curveMonotoneX=we,b.curveMonotoneY=Me,b.curveNatural=Ke,b.curveStep=Je,b.curveStepAfter=bt,b.curveStepBefore=vt,b.line=S,b.lineRadial=X,b.linkHorizontal=J,b.linkRadial=re,b.linkVertical=W,b.pie=I,b.pointRadial=se,b.radialArea=oe,b.radialLine=X,b.stack=ir,b.stackOffsetDiverging=_r,b.stackOffsetExpand=vr,b.stackOffsetNone=Et,b.stackOffsetSilhouette=ln,b.stackOffsetWiggle=Cr,b.stackOrderAppearance=Gr,b.stackOrderAscending=yr,b.stackOrderDescending=Or,b.stackOrderInsideOut=zr,b.stackOrderNone=Wt,b.stackOrderReverse=Sr,b.symbol=Ie,b.symbolCircle=j,b.symbolCross=Z,b.symbolDiamond=ge,b.symbolSquare=be,b.symbolStar=de,b.symbolTriangle=De,b.symbolWye=Ve,b.symbols=Ue,Object.defineProperty(b,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie,c("d3-time")):typeof Vr=="function"&&Vr.amd?Vr(["exports","d3-time"],k):(b=b||self,k(b.d3=b.d3||{},b.d3))})(this,function(b,k){"use strict";function P(it){if(0<=it.y&&it.y<100){var ct=new Date(-1,it.m,it.d,it.H,it.M,it.S,it.L);return ct.setFullYear(it.y),ct}return new Date(it.y,it.m,it.d,it.H,it.M,it.S,it.L)}function E(it){if(0<=it.y&&it.y<100){var ct=new Date(Date.UTC(-1,it.m,it.d,it.H,it.M,it.S,it.L));return ct.setUTCFullYear(it.y),ct}return new Date(Date.UTC(it.y,it.m,it.d,it.H,it.M,it.S,it.L))}function e(it,ct,et){return{y:it,m:ct,d:et,H:0,M:0,S:0,L:0}}function p(it){var ct=it.dateTime,et=it.date,Pe=it.time,We=it.periods,je=it.days,nt=it.shortDays,kt=it.months,wt=it.shortMonths,Vt=d(We),qt=s(We),zt=d(je),Ht=s(je),$t=d(nt),Qt=s(nt),fr=d(kt),jr=s(kt),cn=d(wt),Qr=s(wt),lt={a:bt,A:Et,b:Wt,B:Ot,c:null,d:D,e:D,f:se,H:B,I:U,j:X,L:oe,m:q,M:K,p:ir,q:vr,Q:Ie,s:at,S:G,u:Q,U:V,V:H,w:ee,W:J,x:null,X:null,y:W,Y:re,Z:j,"%":Ue},Gt={a:_r,A:ln,b:Cr,B:Gr,c:null,d:Z,e:Z,f:xe,H:ne,I:le,j:ge,L:pe,m:Ee,M:Te,p:sn,q:yr,Q:Ie,s:at,S:de,u:be,U:Le,V:De,w:ye,W:ke,x:null,X:null,y:Oe,Y:Qe,Z:Ve,"%":Ue},Kt={a:Me,A:Ne,b:Xe,B:Ke,c:rt,d:f,e:f,f:z,H:h,I:h,j:u,L:R,m:A,M:o,p:we,q:w,Q:I,s:F,S,u:x,U:M,V:v,w:m,W:_,x:Je,X:vt,y,Y:l,Z:T,"%":O};lt.x=Nt(et,lt),lt.X=Nt(Pe,lt),lt.c=Nt(ct,lt),Gt.x=Nt(et,Gt),Gt.X=Nt(Pe,Gt),Gt.c=Nt(ct,Gt);function Nt(mr,Or){return function(zr){var Sr=[],ot=-1,Lt=0,Xt=mr.length,tr,Lr,Nr;for(zr instanceof Date||(zr=new Date(+zr));++ot<Xt;)mr.charCodeAt(ot)===37&&(Sr.push(mr.slice(Lt,ot)),(Lr=g[tr=mr.charAt(++ot)])!=null?tr=mr.charAt(++ot):Lr=tr==="e"?" ":"0",(Nr=Or[tr])&&(tr=Nr(zr,Lr)),Sr.push(tr),Lt=ot+1);return Sr.push(mr.slice(Lt,ot)),Sr.join("")}}function gr(mr,Or){return function(zr){var Sr=e(1900,void 0,1),ot=tt(Sr,mr,zr+="",0),Lt,Xt;if(ot!=zr.length)return null;if("Q"in Sr)return new Date(Sr.Q);if("s"in Sr)return new Date(Sr.s*1e3+("L"in Sr?Sr.L:0));if(Or&&!("Z"in Sr)&&(Sr.Z=0),"p"in Sr&&(Sr.H=Sr.H%12+Sr.p*12),Sr.m===void 0&&(Sr.m="q"in Sr?Sr.q:0),"V"in Sr){if(Sr.V<1||Sr.V>53)return null;"w"in Sr||(Sr.w=1),"Z"in Sr?(Lt=E(e(Sr.y,0,1)),Xt=Lt.getUTCDay(),Lt=Xt>4||Xt===0?k.utcMonday.ceil(Lt):k.utcMonday(Lt),Lt=k.utcDay.offset(Lt,(Sr.V-1)*7),Sr.y=Lt.getUTCFullYear(),Sr.m=Lt.getUTCMonth(),Sr.d=Lt.getUTCDate()+(Sr.w+6)%7):(Lt=P(e(Sr.y,0,1)),Xt=Lt.getDay(),Lt=Xt>4||Xt===0?k.timeMonday.ceil(Lt):k.timeMonday(Lt),Lt=k.timeDay.offset(Lt,(Sr.V-1)*7),Sr.y=Lt.getFullYear(),Sr.m=Lt.getMonth(),Sr.d=Lt.getDate()+(Sr.w+6)%7)}else("W"in Sr||"U"in Sr)&&("w"in Sr||(Sr.w="u"in Sr?Sr.u%7:"W"in Sr?1:0),Xt="Z"in Sr?E(e(Sr.y,0,1)).getUTCDay():P(e(Sr.y,0,1)).getDay(),Sr.m=0,Sr.d="W"in Sr?(Sr.w+6)%7+Sr.W*7-(Xt+5)%7:Sr.w+Sr.U*7-(Xt+6)%7);return"Z"in Sr?(Sr.H+=Sr.Z/100|0,Sr.M+=Sr.Z%100,E(Sr)):P(Sr)}}function tt(mr,Or,zr,Sr){for(var ot=0,Lt=Or.length,Xt=zr.length,tr,Lr;ot<Lt;){if(Sr>=Xt)return-1;if(tr=Or.charCodeAt(ot++),tr===37){if(tr=Or.charAt(ot++),Lr=Kt[tr in g?Or.charAt(ot++):tr],!Lr||(Sr=Lr(mr,zr,Sr))<0)return-1}else if(tr!=zr.charCodeAt(Sr++))return-1}return Sr}function we(mr,Or,zr){var Sr=Vt.exec(Or.slice(zr));return Sr?(mr.p=qt[Sr[0].toLowerCase()],zr+Sr[0].length):-1}function Me(mr,Or,zr){var Sr=$t.exec(Or.slice(zr));return Sr?(mr.w=Qt[Sr[0].toLowerCase()],zr+Sr[0].length):-1}function Ne(mr,Or,zr){var Sr=zt.exec(Or.slice(zr));return Sr?(mr.w=Ht[Sr[0].toLowerCase()],zr+Sr[0].length):-1}function Xe(mr,Or,zr){var Sr=cn.exec(Or.slice(zr));return Sr?(mr.m=Qr[Sr[0].toLowerCase()],zr+Sr[0].length):-1}function Ke(mr,Or,zr){var Sr=fr.exec(Or.slice(zr));return Sr?(mr.m=jr[Sr[0].toLowerCase()],zr+Sr[0].length):-1}function rt(mr,Or,zr){return tt(mr,ct,Or,zr)}function Je(mr,Or,zr){return tt(mr,et,Or,zr)}function vt(mr,Or,zr){return tt(mr,Pe,Or,zr)}function bt(mr){return nt[mr.getDay()]}function Et(mr){return je[mr.getDay()]}function Wt(mr){return wt[mr.getMonth()]}function Ot(mr){return kt[mr.getMonth()]}function ir(mr){return We[+(mr.getHours()>=12)]}function vr(mr){return 1+~~(mr.getMonth()/3)}function _r(mr){return nt[mr.getUTCDay()]}function ln(mr){return je[mr.getUTCDay()]}function Cr(mr){return wt[mr.getUTCMonth()]}function Gr(mr){return kt[mr.getUTCMonth()]}function sn(mr){return We[+(mr.getUTCHours()>=12)]}function yr(mr){return 1+~~(mr.getUTCMonth()/3)}return{format:function(mr){var Or=Nt(mr+="",lt);return Or.toString=function(){return mr},Or},parse:function(mr){var Or=gr(mr+="",!1);return Or.toString=function(){return mr},Or},utcFormat:function(mr){var Or=Nt(mr+="",Gt);return Or.toString=function(){return mr},Or},utcParse:function(mr){var Or=gr(mr+="",!0);return Or.toString=function(){return mr},Or}}}var g={"-":"",_:" ","0":"0"},a=/^\s*\d+/,t=/^%/,i=/[\\^$*+?|[\]().{}]/g;function n(it,ct,et){var Pe=it<0?"-":"",We=(Pe?-it:it)+"",je=We.length;return Pe+(je<et?new Array(et-je+1).join(ct)+We:We)}function r(it){return it.replace(i,"\\$&")}function d(it){return new RegExp("^(?:"+it.map(r).join("|")+")","i")}function s(it){for(var ct={},et=-1,Pe=it.length;++et<Pe;)ct[it[et].toLowerCase()]=et;return ct}function m(it,ct,et){var Pe=a.exec(ct.slice(et,et+1));return Pe?(it.w=+Pe[0],et+Pe[0].length):-1}function x(it,ct,et){var Pe=a.exec(ct.slice(et,et+1));return Pe?(it.u=+Pe[0],et+Pe[0].length):-1}function M(it,ct,et){var Pe=a.exec(ct.slice(et,et+2));return Pe?(it.U=+Pe[0],et+Pe[0].length):-1}function v(it,ct,et){var Pe=a.exec(ct.slice(et,et+2));return Pe?(it.V=+Pe[0],et+Pe[0].length):-1}function _(it,ct,et){var Pe=a.exec(ct.slice(et,et+2));return Pe?(it.W=+Pe[0],et+Pe[0].length):-1}function l(it,ct,et){var Pe=a.exec(ct.slice(et,et+4));return Pe?(it.y=+Pe[0],et+Pe[0].length):-1}function y(it,ct,et){var Pe=a.exec(ct.slice(et,et+2));return Pe?(it.y=+Pe[0]+(+Pe[0]>68?1900:2e3),et+Pe[0].length):-1}function T(it,ct,et){var Pe=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(ct.slice(et,et+6));return Pe?(it.Z=Pe[1]?0:-(Pe[2]+(Pe[3]||"00")),et+Pe[0].length):-1}function w(it,ct,et){var Pe=a.exec(ct.slice(et,et+1));return Pe?(it.q=Pe[0]*3-3,et+Pe[0].length):-1}function A(it,ct,et){var Pe=a.exec(ct.slice(et,et+2));return Pe?(it.m=Pe[0]-1,et+Pe[0].length):-1}function f(it,ct,et){var Pe=a.exec(ct.slice(et,et+2));return Pe?(it.d=+Pe[0],et+Pe[0].length):-1}function u(it,ct,et){var Pe=a.exec(ct.slice(et,et+3));return Pe?(it.m=0,it.d=+Pe[0],et+Pe[0].length):-1}function h(it,ct,et){var Pe=a.exec(ct.slice(et,et+2));return Pe?(it.H=+Pe[0],et+Pe[0].length):-1}function o(it,ct,et){var Pe=a.exec(ct.slice(et,et+2));return Pe?(it.M=+Pe[0],et+Pe[0].length):-1}function S(it,ct,et){var Pe=a.exec(ct.slice(et,et+2));return Pe?(it.S=+Pe[0],et+Pe[0].length):-1}function R(it,ct,et){var Pe=a.exec(ct.slice(et,et+3));return Pe?(it.L=+Pe[0],et+Pe[0].length):-1}function z(it,ct,et){var Pe=a.exec(ct.slice(et,et+6));return Pe?(it.L=Math.floor(Pe[0]/1e3),et+Pe[0].length):-1}function O(it,ct,et){var Pe=t.exec(ct.slice(et,et+1));return Pe?et+Pe[0].length:-1}function I(it,ct,et){var Pe=a.exec(ct.slice(et));return Pe?(it.Q=+Pe[0],et+Pe[0].length):-1}function F(it,ct,et){var Pe=a.exec(ct.slice(et));return Pe?(it.s=+Pe[0],et+Pe[0].length):-1}function D(it,ct){return n(it.getDate(),ct,2)}function B(it,ct){return n(it.getHours(),ct,2)}function U(it,ct){return n(it.getHours()%12||12,ct,2)}function X(it,ct){return n(1+k.timeDay.count(k.timeYear(it),it),ct,3)}function oe(it,ct){return n(it.getMilliseconds(),ct,3)}function se(it,ct){return oe(it,ct)+"000"}function q(it,ct){return n(it.getMonth()+1,ct,2)}function K(it,ct){return n(it.getMinutes(),ct,2)}function G(it,ct){return n(it.getSeconds(),ct,2)}function Q(it){var ct=it.getDay();return ct===0?7:ct}function V(it,ct){return n(k.timeSunday.count(k.timeYear(it)-1,it),ct,2)}function H(it,ct){var et=it.getDay();return it=et>=4||et===0?k.timeThursday(it):k.timeThursday.ceil(it),n(k.timeThursday.count(k.timeYear(it),it)+(k.timeYear(it).getDay()===4),ct,2)}function ee(it){return it.getDay()}function J(it,ct){return n(k.timeMonday.count(k.timeYear(it)-1,it),ct,2)}function W(it,ct){return n(it.getFullYear()%100,ct,2)}function re(it,ct){return n(it.getFullYear()%1e4,ct,4)}function j(it){var ct=it.getTimezoneOffset();return(ct>0?"-":(ct*=-1,"+"))+n(ct/60|0,"0",2)+n(ct%60,"0",2)}function Z(it,ct){return n(it.getUTCDate(),ct,2)}function ne(it,ct){return n(it.getUTCHours(),ct,2)}function le(it,ct){return n(it.getUTCHours()%12||12,ct,2)}function ge(it,ct){return n(1+k.utcDay.count(k.utcYear(it),it),ct,3)}function pe(it,ct){return n(it.getUTCMilliseconds(),ct,3)}function xe(it,ct){return pe(it,ct)+"000"}function Ee(it,ct){return n(it.getUTCMonth()+1,ct,2)}function Te(it,ct){return n(it.getUTCMinutes(),ct,2)}function de(it,ct){return n(it.getUTCSeconds(),ct,2)}function be(it){var ct=it.getUTCDay();return ct===0?7:ct}function Le(it,ct){return n(k.utcSunday.count(k.utcYear(it)-1,it),ct,2)}function De(it,ct){var et=it.getUTCDay();return it=et>=4||et===0?k.utcThursday(it):k.utcThursday.ceil(it),n(k.utcThursday.count(k.utcYear(it),it)+(k.utcYear(it).getUTCDay()===4),ct,2)}function ye(it){return it.getUTCDay()}function ke(it,ct){return n(k.utcMonday.count(k.utcYear(it)-1,it),ct,2)}function Oe(it,ct){return n(it.getUTCFullYear()%100,ct,2)}function Qe(it,ct){return n(it.getUTCFullYear()%1e4,ct,4)}function Ve(){return"+0000"}function Ue(){return"%"}function Ie(it){return+it}function at(it){return Math.floor(+it/1e3)}var pt;Rt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Rt(it){return pt=p(it),b.timeFormat=pt.format,b.timeParse=pt.parse,b.utcFormat=pt.utcFormat,b.utcParse=pt.utcParse,pt}var Mt="%Y-%m-%dT%H:%M:%S.%LZ";function It(it){return it.toISOString()}var Bt=Date.prototype.toISOString?It:b.utcFormat(Mt);function St(it){var ct=new Date(it);return isNaN(ct)?null:ct}var _t=+new Date("2000-01-01T00:00:00.000Z")?St:b.utcParse(Mt);b.isoFormat=Bt,b.isoParse=_t,b.timeFormatDefaultLocale=Rt,b.timeFormatLocale=p,Object.defineProperty(b,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):(b=b||self,k(b.d3=b.d3||{}))})(this,function(b){"use strict";var k=new Date,P=new Date;function E(ye,ke,Oe,Qe){function Ve(Ue){return ye(Ue=arguments.length===0?new Date:new Date(+Ue)),Ue}return Ve.floor=function(Ue){return ye(Ue=new Date(+Ue)),Ue},Ve.ceil=function(Ue){return ye(Ue=new Date(Ue-1)),ke(Ue,1),ye(Ue),Ue},Ve.round=function(Ue){var Ie=Ve(Ue),at=Ve.ceil(Ue);return Ue-Ie<at-Ue?Ie:at},Ve.offset=function(Ue,Ie){return ke(Ue=new Date(+Ue),Ie==null?1:Math.floor(Ie)),Ue},Ve.range=function(Ue,Ie,at){var pt=[],Rt;if(Ue=Ve.ceil(Ue),at=at==null?1:Math.floor(at),!(Ue<Ie)||!(at>0))return pt;do pt.push(Rt=new Date(+Ue)),ke(Ue,at),ye(Ue);while(Rt<Ue&&Ue<Ie);return pt},Ve.filter=function(Ue){return E(function(Ie){if(Ie>=Ie)for(;ye(Ie),!Ue(Ie);)Ie.setTime(Ie-1)},function(Ie,at){if(Ie>=Ie)if(at<0)for(;++at<=0;)for(;ke(Ie,-1),!Ue(Ie););else for(;--at>=0;)for(;ke(Ie,1),!Ue(Ie););})},Oe&&(Ve.count=function(Ue,Ie){return k.setTime(+Ue),P.setTime(+Ie),ye(k),ye(P),Math.floor(Oe(k,P))},Ve.every=function(Ue){return Ue=Math.floor(Ue),!isFinite(Ue)||!(Ue>0)?null:Ue>1?Ve.filter(Qe?function(Ie){return Qe(Ie)%Ue===0}:function(Ie){return Ve.count(0,Ie)%Ue===0}):Ve}),Ve}var e=E(function(){},function(ye,ke){ye.setTime(+ye+ke)},function(ye,ke){return ke-ye});e.every=function(ye){return ye=Math.floor(ye),!isFinite(ye)||!(ye>0)?null:ye>1?E(function(ke){ke.setTime(Math.floor(ke/ye)*ye)},function(ke,Oe){ke.setTime(+ke+Oe*ye)},function(ke,Oe){return(Oe-ke)/ye}):e};var p=e.range,g=1e3,a=6e4,t=36e5,i=864e5,n=6048e5,r=E(function(ye){ye.setTime(ye-ye.getMilliseconds())},function(ye,ke){ye.setTime(+ye+ke*g)},function(ye,ke){return(ke-ye)/g},function(ye){return ye.getUTCSeconds()}),d=r.range,s=E(function(ye){ye.setTime(ye-ye.getMilliseconds()-ye.getSeconds()*g)},function(ye,ke){ye.setTime(+ye+ke*a)},function(ye,ke){return(ke-ye)/a},function(ye){return ye.getMinutes()}),m=s.range,x=E(function(ye){ye.setTime(ye-ye.getMilliseconds()-ye.getSeconds()*g-ye.getMinutes()*a)},function(ye,ke){ye.setTime(+ye+ke*t)},function(ye,ke){return(ke-ye)/t},function(ye){return ye.getHours()}),M=x.range,v=E(function(ye){ye.setHours(0,0,0,0)},function(ye,ke){ye.setDate(ye.getDate()+ke)},function(ye,ke){return(ke-ye-(ke.getTimezoneOffset()-ye.getTimezoneOffset())*a)/i},function(ye){return ye.getDate()-1}),_=v.range;function l(ye){return E(function(ke){ke.setDate(ke.getDate()-(ke.getDay()+7-ye)%7),ke.setHours(0,0,0,0)},function(ke,Oe){ke.setDate(ke.getDate()+Oe*7)},function(ke,Oe){return(Oe-ke-(Oe.getTimezoneOffset()-ke.getTimezoneOffset())*a)/n})}var y=l(0),T=l(1),w=l(2),A=l(3),f=l(4),u=l(5),h=l(6),o=y.range,S=T.range,R=w.range,z=A.range,O=f.range,I=u.range,F=h.range,D=E(function(ye){ye.setDate(1),ye.setHours(0,0,0,0)},function(ye,ke){ye.setMonth(ye.getMonth()+ke)},function(ye,ke){return ke.getMonth()-ye.getMonth()+(ke.getFullYear()-ye.getFullYear())*12},function(ye){return ye.getMonth()}),B=D.range,U=E(function(ye){ye.setMonth(0,1),ye.setHours(0,0,0,0)},function(ye,ke){ye.setFullYear(ye.getFullYear()+ke)},function(ye,ke){return ke.getFullYear()-ye.getFullYear()},function(ye){return ye.getFullYear()});U.every=function(ye){return!isFinite(ye=Math.floor(ye))||!(ye>0)?null:E(function(ke){ke.setFullYear(Math.floor(ke.getFullYear()/ye)*ye),ke.setMonth(0,1),ke.setHours(0,0,0,0)},function(ke,Oe){ke.setFullYear(ke.getFullYear()+Oe*ye)})};var X=U.range,oe=E(function(ye){ye.setUTCSeconds(0,0)},function(ye,ke){ye.setTime(+ye+ke*a)},function(ye,ke){return(ke-ye)/a},function(ye){return ye.getUTCMinutes()}),se=oe.range,q=E(function(ye){ye.setUTCMinutes(0,0,0)},function(ye,ke){ye.setTime(+ye+ke*t)},function(ye,ke){return(ke-ye)/t},function(ye){return ye.getUTCHours()}),K=q.range,G=E(function(ye){ye.setUTCHours(0,0,0,0)},function(ye,ke){ye.setUTCDate(ye.getUTCDate()+ke)},function(ye,ke){return(ke-ye)/i},function(ye){return ye.getUTCDate()-1}),Q=G.range;function V(ye){return E(function(ke){ke.setUTCDate(ke.getUTCDate()-(ke.getUTCDay()+7-ye)%7),ke.setUTCHours(0,0,0,0)},function(ke,Oe){ke.setUTCDate(ke.getUTCDate()+Oe*7)},function(ke,Oe){return(Oe-ke)/n})}var H=V(0),ee=V(1),J=V(2),W=V(3),re=V(4),j=V(5),Z=V(6),ne=H.range,le=ee.range,ge=J.range,pe=W.range,xe=re.range,Ee=j.range,Te=Z.range,de=E(function(ye){ye.setUTCDate(1),ye.setUTCHours(0,0,0,0)},function(ye,ke){ye.setUTCMonth(ye.getUTCMonth()+ke)},function(ye,ke){return ke.getUTCMonth()-ye.getUTCMonth()+(ke.getUTCFullYear()-ye.getUTCFullYear())*12},function(ye){return ye.getUTCMonth()}),be=de.range,Le=E(function(ye){ye.setUTCMonth(0,1),ye.setUTCHours(0,0,0,0)},function(ye,ke){ye.setUTCFullYear(ye.getUTCFullYear()+ke)},function(ye,ke){return ke.getUTCFullYear()-ye.getUTCFullYear()},function(ye){return ye.getUTCFullYear()});Le.every=function(ye){return!isFinite(ye=Math.floor(ye))||!(ye>0)?null:E(function(ke){ke.setUTCFullYear(Math.floor(ke.getUTCFullYear()/ye)*ye),ke.setUTCMonth(0,1),ke.setUTCHours(0,0,0,0)},function(ke,Oe){ke.setUTCFullYear(ke.getUTCFullYear()+Oe*ye)})};var De=Le.range;b.timeDay=v,b.timeDays=_,b.timeFriday=u,b.timeFridays=I,b.timeHour=x,b.timeHours=M,b.timeInterval=E,b.timeMillisecond=e,b.timeMilliseconds=p,b.timeMinute=s,b.timeMinutes=m,b.timeMonday=T,b.timeMondays=S,b.timeMonth=D,b.timeMonths=B,b.timeSaturday=h,b.timeSaturdays=F,b.timeSecond=r,b.timeSeconds=d,b.timeSunday=y,b.timeSundays=o,b.timeThursday=f,b.timeThursdays=O,b.timeTuesday=w,b.timeTuesdays=R,b.timeWednesday=A,b.timeWednesdays=z,b.timeWeek=y,b.timeWeeks=o,b.timeYear=U,b.timeYears=X,b.utcDay=G,b.utcDays=Q,b.utcFriday=j,b.utcFridays=Ee,b.utcHour=q,b.utcHours=K,b.utcMillisecond=e,b.utcMilliseconds=p,b.utcMinute=oe,b.utcMinutes=se,b.utcMonday=ee,b.utcMondays=le,b.utcMonth=de,b.utcMonths=be,b.utcSaturday=Z,b.utcSaturdays=Te,b.utcSecond=r,b.utcSeconds=d,b.utcSunday=H,b.utcSundays=ne,b.utcThursday=re,b.utcThursdays=xe,b.utcTuesday=J,b.utcTuesdays=ge,b.utcWednesday=W,b.utcWednesdays=pe,b.utcWeek=H,b.utcWeeks=ne,b.utcYear=Le,b.utcYears=De,Object.defineProperty(b,"__esModule",{value:!0})})},{}],122:[function(c,ae,ie){arguments[4][121][0].apply(ie,arguments)},{dup:121}],123:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):(b=b||self,k(b.d3=b.d3||{}))})(this,function(b){"use strict";var k=0,P=0,E=0,e=1e3,p,g,a=0,t=0,i=0,n=typeof performance=="object"&&performance.now?performance:Date,r=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(A){setTimeout(A,17)};function d(){return t||(r(s),t=n.now()+i)}function s(){t=0}function m(){this._call=this._time=this._next=null}m.prototype=x.prototype={constructor:m,restart:function(A,f,u){if(typeof A!="function")throw new TypeError("callback is not a function");u=(u==null?d():+u)+(f==null?0:+f),!this._next&&g!==this&&(g?g._next=this:p=this,g=this),this._call=A,this._time=u,y()},stop:function(){this._call&&(this._call=null,this._time=1/0,y())}};function x(A,f,u){var h=new m;return h.restart(A,f,u),h}function M(){d(),++k;for(var A=p,f;A;)(f=t-A._time)>=0&&A._call.call(null,f),A=A._next;--k}function v(){t=(a=n.now())+i,k=P=0;try{M()}finally{k=0,l(),t=0}}function _(){var A=n.now(),f=A-a;f>e&&(i-=f,a=A)}function l(){for(var A,f=p,u,h=1/0;f;)f._call?(h>f._time&&(h=f._time),A=f,f=f._next):(u=f._next,f._next=null,f=A?A._next=u:p=u);g=A,y(h)}function y(A){if(!k){P&&(P=clearTimeout(P));var f=A-t;f>24?(A<1/0&&(P=setTimeout(v,A-n.now()-i)),E&&(E=clearInterval(E))):(E||(a=n.now(),E=setInterval(_,e)),k=1,r(v))}}function T(A,f,u){var h=new m;return f=f==null?0:+f,h.restart(function(o){h.stop(),A(o+f)},f,u),h}function w(A,f,u){var h=new m,o=f;return f==null?(h.restart(A,f,u),h):(f=+f,u=u==null?d():+u,h.restart(function S(R){R+=o,h.restart(S,o+=f,u),A(R)},f,u),h)}b.interval=w,b.now=d,b.timeout=T,b.timer=x,b.timerFlush=M,Object.defineProperty(b,"__esModule",{value:!0})})},{}],124:[function(c,ae,ie){ae.exports=function(){for(var b=0;b<arguments.length;b++)if(arguments[b]!==void 0)return arguments[b]}},{}],125:[function(c,ae,ie){"use strict";ae.exports=E;var b=E.canvas=document.createElement("canvas"),k=b.getContext("2d"),P=e([32,126]);E.createPairs=e,E.ascii=P;function E(p,g){Array.isArray(p)&&(p=p.join(", "));var a={},t,i=16,n=.05;g&&(g.length===2&&typeof g[0]=="number"?t=e(g):Array.isArray(g)?t=g:(g.o?t=e(g.o):g.pairs&&(t=g.pairs),g.fontSize&&(i=g.fontSize),g.threshold!=null&&(n=g.threshold))),t||(t=P),k.font=i+"px "+p;for(var r=0;r<t.length;r++){var d=t[r],s=k.measureText(d[0]).width+k.measureText(d[1]).width,m=k.measureText(d).width;if(Math.abs(s-m)>i*n){var x=(m-s)/i;a[d]=x*1e3}}return a}function e(p){for(var g=[],a=p[0];a<=p[1];a++)for(var t=String.fromCharCode(a),i=p[0];i<p[1];i++){var n=String.fromCharCode(i),r=t+n;g.push(r)}return g}},{}],126:[function(c,ae,ie){var b=c("abs-svg-path"),k=c("normalize-svg-path"),P={M:"moveTo",C:"bezierCurveTo"};ae.exports=function(E,e){E.beginPath(),k(b(e)).forEach(function(p){var g=p[0],a=p.slice(1);E[P[g]].apply(E,a)}),E.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(c,ae,ie){ae.exports=function(b){switch(b){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(c,ae,ie){"use strict";function b(E,e,p){var g=E[p]|0;if(g<=0)return[];var a=new Array(g),t;if(p===E.length-1)for(t=0;t<g;++t)a[t]=e;else for(t=0;t<g;++t)a[t]=b(E,e,p+1);return a}function k(E,e){var p,g;for(p=new Array(E),g=0;g<E;++g)p[g]=e;return p}function P(E,e){switch(typeof e>"u"&&(e=0),typeof E){case"number":if(E>0)return k(E|0,e);break;case"object":if(typeof E.length=="number")return b(E,e,0);break}return[]}ae.exports=P},{}],129:[function(c,ae,ie){"use strict";ae.exports=b,ae.exports.default=b;function b(I,F,D){D=D||2;var B=F&&F.length,U=B?F[0]*D:I.length,X=k(I,0,U,D,!0),oe=[];if(!X||X.next===X.prev)return oe;var se,q,K,G,Q,V,H;if(B&&(X=t(I,F,X,D)),I.length>80*D){se=K=I[0],q=G=I[1];for(var ee=D;ee<U;ee+=D)Q=I[ee],V=I[ee+1],Q<se&&(se=Q),V<q&&(q=V),Q>K&&(K=Q),V>G&&(G=V);H=Math.max(K-se,G-q),H=H!==0?1/H:0}return E(X,oe,D,se,q,H),oe}function k(I,F,D,B,U){var X,oe;if(U===O(I,F,D,B)>0)for(X=F;X<D;X+=B)oe=S(X,I[X],I[X+1],oe);else for(X=D-B;X>=F;X-=B)oe=S(X,I[X],I[X+1],oe);return oe&&y(oe,oe.next)&&(R(oe),oe=oe.next),oe}function P(I,F){if(!I)return I;F||(F=I);var D=I,B;do if(B=!1,!D.steiner&&(y(D,D.next)||l(D.prev,D,D.next)===0)){if(R(D),D=F=D.prev,D===D.next)break;B=!0}else D=D.next;while(B||D!==F);return F}function E(I,F,D,B,U,X,oe){if(!!I){!oe&&X&&s(I,B,U,X);for(var se=I,q,K;I.prev!==I.next;){if(q=I.prev,K=I.next,X?p(I,B,U,X):e(I)){F.push(q.i/D),F.push(I.i/D),F.push(K.i/D),R(I),I=K.next,se=K.next;continue}if(I=K,I===se){oe?oe===1?(I=g(P(I),F,D),E(I,F,D,B,U,X,2)):oe===2&&a(I,F,D,B,U,X):E(P(I),F,D,B,U,X,1);break}}}}function e(I){var F=I.prev,D=I,B=I.next;if(l(F,D,B)>=0)return!1;for(var U=I.next.next;U!==I.prev;){if(v(F.x,F.y,D.x,D.y,B.x,B.y,U.x,U.y)&&l(U.prev,U,U.next)>=0)return!1;U=U.next}return!0}function p(I,F,D,B){var U=I.prev,X=I,oe=I.next;if(l(U,X,oe)>=0)return!1;for(var se=U.x<X.x?U.x<oe.x?U.x:oe.x:X.x<oe.x?X.x:oe.x,q=U.y<X.y?U.y<oe.y?U.y:oe.y:X.y<oe.y?X.y:oe.y,K=U.x>X.x?U.x>oe.x?U.x:oe.x:X.x>oe.x?X.x:oe.x,G=U.y>X.y?U.y>oe.y?U.y:oe.y:X.y>oe.y?X.y:oe.y,Q=x(se,q,F,D,B),V=x(K,G,F,D,B),H=I.prevZ,ee=I.nextZ;H&&H.z>=Q&&ee&&ee.z<=V;){if(H!==I.prev&&H!==I.next&&v(U.x,U.y,X.x,X.y,oe.x,oe.y,H.x,H.y)&&l(H.prev,H,H.next)>=0||(H=H.prevZ,ee!==I.prev&&ee!==I.next&&v(U.x,U.y,X.x,X.y,oe.x,oe.y,ee.x,ee.y)&&l(ee.prev,ee,ee.next)>=0))return!1;ee=ee.nextZ}for(;H&&H.z>=Q;){if(H!==I.prev&&H!==I.next&&v(U.x,U.y,X.x,X.y,oe.x,oe.y,H.x,H.y)&&l(H.prev,H,H.next)>=0)return!1;H=H.prevZ}for(;ee&&ee.z<=V;){if(ee!==I.prev&&ee!==I.next&&v(U.x,U.y,X.x,X.y,oe.x,oe.y,ee.x,ee.y)&&l(ee.prev,ee,ee.next)>=0)return!1;ee=ee.nextZ}return!0}function g(I,F,D){var B=I;do{var U=B.prev,X=B.next.next;!y(U,X)&&T(U,B,B.next,X)&&u(U,X)&&u(X,U)&&(F.push(U.i/D),F.push(B.i/D),F.push(X.i/D),R(B),R(B.next),B=I=X),B=B.next}while(B!==I);return P(B)}function a(I,F,D,B,U,X){var oe=I;do{for(var se=oe.next.next;se!==oe.prev;){if(oe.i!==se.i&&_(oe,se)){var q=o(oe,se);oe=P(oe,oe.next),q=P(q,q.next),E(oe,F,D,B,U,X),E(q,F,D,B,U,X);return}se=se.next}oe=oe.next}while(oe!==I)}function t(I,F,D,B){var U=[],X,oe,se,q,K;for(X=0,oe=F.length;X<oe;X++)se=F[X]*B,q=X<oe-1?F[X+1]*B:I.length,K=k(I,se,q,B,!1),K===K.next&&(K.steiner=!0),U.push(M(K));for(U.sort(i),X=0;X<U.length;X++)n(U[X],D),D=P(D,D.next);return D}function i(I,F){return I.x-F.x}function n(I,F){if(F=r(I,F),F){var D=o(F,I);P(F,F.next),P(D,D.next)}}function r(I,F){var D=F,B=I.x,U=I.y,X=-1/0,oe;do{if(U<=D.y&&U>=D.next.y&&D.next.y!==D.y){var se=D.x+(U-D.y)*(D.next.x-D.x)/(D.next.y-D.y);if(se<=B&&se>X){if(X=se,se===B){if(U===D.y)return D;if(U===D.next.y)return D.next}oe=D.x<D.next.x?D:D.next}}D=D.next}while(D!==F);if(!oe)return null;if(B===X)return oe;var q=oe,K=oe.x,G=oe.y,Q=1/0,V;D=oe;do B>=D.x&&D.x>=K&&B!==D.x&&v(U<G?B:X,U,K,G,U<G?X:B,U,D.x,D.y)&&(V=Math.abs(U-D.y)/(B-D.x),u(D,I)&&(V<Q||V===Q&&(D.x>oe.x||D.x===oe.x&&d(oe,D)))&&(oe=D,Q=V)),D=D.next;while(D!==q);return oe}function d(I,F){return l(I.prev,I,F.prev)<0&&l(F.next,I,I.next)<0}function s(I,F,D,B){var U=I;do U.z===null&&(U.z=x(U.x,U.y,F,D,B)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==I);U.prevZ.nextZ=null,U.prevZ=null,m(U)}function m(I){var F,D,B,U,X,oe,se,q,K=1;do{for(D=I,I=null,X=null,oe=0;D;){for(oe++,B=D,se=0,F=0;F<K&&(se++,B=B.nextZ,!!B);F++);for(q=K;se>0||q>0&&B;)se!==0&&(q===0||!B||D.z<=B.z)?(U=D,D=D.nextZ,se--):(U=B,B=B.nextZ,q--),X?X.nextZ=U:I=U,U.prevZ=X,X=U;D=B}X.nextZ=null,K*=2}while(oe>1);return I}function x(I,F,D,B,U){return I=32767*(I-D)*U,F=32767*(F-B)*U,I=(I|I<<8)&16711935,I=(I|I<<4)&252645135,I=(I|I<<2)&858993459,I=(I|I<<1)&1431655765,F=(F|F<<8)&16711935,F=(F|F<<4)&252645135,F=(F|F<<2)&858993459,F=(F|F<<1)&1431655765,I|F<<1}function M(I){var F=I,D=I;do(F.x<D.x||F.x===D.x&&F.y<D.y)&&(D=F),F=F.next;while(F!==I);return D}function v(I,F,D,B,U,X,oe,se){return(U-oe)*(F-se)-(I-oe)*(X-se)>=0&&(I-oe)*(B-se)-(D-oe)*(F-se)>=0&&(D-oe)*(X-se)-(U-oe)*(B-se)>=0}function _(I,F){return I.next.i!==F.i&&I.prev.i!==F.i&&!f(I,F)&&(u(I,F)&&u(F,I)&&h(I,F)&&(l(I.prev,I,F.prev)||l(I,F.prev,F))||y(I,F)&&l(I.prev,I,I.next)>0&&l(F.prev,F,F.next)>0)}function l(I,F,D){return(F.y-I.y)*(D.x-F.x)-(F.x-I.x)*(D.y-F.y)}function y(I,F){return I.x===F.x&&I.y===F.y}function T(I,F,D,B){var U=A(l(I,F,D)),X=A(l(I,F,B)),oe=A(l(D,B,I)),se=A(l(D,B,F));return!!(U!==X&&oe!==se||U===0&&w(I,D,F)||X===0&&w(I,B,F)||oe===0&&w(D,I,B)||se===0&&w(D,F,B))}function w(I,F,D){return F.x<=Math.max(I.x,D.x)&&F.x>=Math.min(I.x,D.x)&&F.y<=Math.max(I.y,D.y)&&F.y>=Math.min(I.y,D.y)}function A(I){return I>0?1:I<0?-1:0}function f(I,F){var D=I;do{if(D.i!==I.i&&D.next.i!==I.i&&D.i!==F.i&&D.next.i!==F.i&&T(D,D.next,I,F))return!0;D=D.next}while(D!==I);return!1}function u(I,F){return l(I.prev,I,I.next)<0?l(I,F,I.next)>=0&&l(I,I.prev,F)>=0:l(I,F,I.prev)<0||l(I,I.next,F)<0}function h(I,F){var D=I,B=!1,U=(I.x+F.x)/2,X=(I.y+F.y)/2;do D.y>X!=D.next.y>X&&D.next.y!==D.y&&U<(D.next.x-D.x)*(X-D.y)/(D.next.y-D.y)+D.x&&(B=!B),D=D.next;while(D!==I);return B}function o(I,F){var D=new z(I.i,I.x,I.y),B=new z(F.i,F.x,F.y),U=I.next,X=F.prev;return I.next=F,F.prev=I,D.next=U,U.prev=D,B.next=D,D.prev=B,X.next=B,B.prev=X,B}function S(I,F,D,B){var U=new z(I,F,D);return B?(U.next=B.next,U.prev=B,B.next.prev=U,B.next=U):(U.prev=U,U.next=U),U}function R(I){I.next.prev=I.prev,I.prev.next=I.next,I.prevZ&&(I.prevZ.nextZ=I.nextZ),I.nextZ&&(I.nextZ.prevZ=I.prevZ)}function z(I,F,D){this.i=I,this.x=F,this.y=D,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}b.deviation=function(I,F,D,B){var U=F&&F.length,X=U?F[0]*D:I.length,oe=Math.abs(O(I,0,X,D));if(U)for(var se=0,q=F.length;se<q;se++){var K=F[se]*D,G=se<q-1?F[se+1]*D:I.length;oe-=Math.abs(O(I,K,G,D))}var Q=0;for(se=0;se<B.length;se+=3){var V=B[se]*D,H=B[se+1]*D,ee=B[se+2]*D;Q+=Math.abs((I[V]-I[ee])*(I[H+1]-I[V+1])-(I[V]-I[H])*(I[ee+1]-I[V+1]))}return oe===0&&Q===0?0:Math.abs((Q-oe)/oe)};function O(I,F,D,B){for(var U=0,X=F,oe=D-B;X<D;X+=B)U+=(I[oe]-I[X])*(I[X+1]+I[oe+1]),oe=X;return U}b.flatten=function(I){for(var F=I[0][0].length,D={vertices:[],holes:[],dimensions:F},B=0,U=0;U<I.length;U++){for(var X=0;X<I[U].length;X++)for(var oe=0;oe<F;oe++)D.vertices.push(I[U][X][oe]);U>0&&(B+=I[U-1].length,D.holes.push(B))}return D}},{}],130:[function(c,ae,ie){var b=c("strongly-connected-components");ae.exports=function(P,E){var e=[],p=[],g=[],a={},t=[],i;function n(y){g[y]=!1,a.hasOwnProperty(y)&&Object.keys(a[y]).forEach(function(T){delete a[y][T],g[T]&&n(T)})}function r(y){var T=!1;p.push(y),g[y]=!0;var w,A;for(w=0;w<t[y].length;w++)A=t[y][w],A===i?(d(i,p),T=!0):g[A]||(T=r(A));if(T)n(y);else for(w=0;w<t[y].length;w++){A=t[y][w];var f=a[A];f||(f={},a[A]=f),f[A]=!0}return p.pop(),T}function d(y,T){var w=[].concat(T).concat(y);E?E(r):e.push(w)}function s(y){for(var T=0;T<P.length;T++)T<y&&(P[T]=[]),P[T]=P[T].filter(function(w){return w>=y})}function m(y){s(y);for(var T=P,w=b(T),A=w.components.filter(function(z){return z.length>1}),f=1/0,u,h=0;h<A.length;h++)for(var o=0;o<A[h].length;o++)A[h][o]<f&&(f=A[h][o],u=h);var S=A[u];if(!S)return!1;var R=P.map(function(z,O){return S.indexOf(O)===-1?[]:z.filter(function(I){return S.indexOf(I)!==-1})});return{leastVertex:f,adjList:R}}i=0;for(var x=P.length;i<x;){var M=m(i);if(i=M.leastVertex,t=M.adjList,t){for(var v=0;v<t.length;v++)for(var _=0;_<t[v].length;_++){var l=t[v][_];g[+l]=!1,a[l]={}}r(i),i=i+1}else i=x}if(!E)return e}},{"strongly-connected-components":306}],131:[function(c,ae,ie){"use strict";var b=c("../../object/valid-value");ae.exports=function(){return b(this).length=0,this}},{"../../object/valid-value":162}],132:[function(c,ae,ie){"use strict";ae.exports=c("./is-implemented")()?Array.from:c("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(c,ae,ie){"use strict";ae.exports=function(){var b=Array.from,k,P;return typeof b!="function"?!1:(k=["raz","dwa"],P=b(k),Boolean(P&&P!==k&&P[1]==="dwa"))}},{}],134:[function(c,ae,ie){"use strict";var b=c("es6-symbol").iterator,k=c("../../function/is-arguments"),P=c("../../function/is-function"),E=c("../../number/to-pos-integer"),e=c("../../object/valid-callable"),p=c("../../object/valid-value"),g=c("../../object/is-value"),a=c("../../string/is-string"),t=Array.isArray,i=Function.prototype.call,n={configurable:!0,enumerable:!0,writable:!0,value:null},r=Object.defineProperty;ae.exports=function(d){var s=arguments[1],m=arguments[2],x,M,v,_,l,y,T,w,A,f;if(d=Object(p(d)),g(s)&&e(s),!this||this===Array||!P(this)){if(!s){if(k(d))return l=d.length,l!==1?Array.apply(null,d):(_=new Array(1),_[0]=d[0],_);if(t(d)){for(_=new Array(l=d.length),M=0;M<l;++M)_[M]=d[M];return _}}_=[]}else x=this;if(!t(d)){if((A=d[b])!==void 0){for(T=e(A).call(d),x&&(_=new x),w=T.next(),M=0;!w.done;)f=s?i.call(s,m,w.value,M):w.value,x?(n.value=f,r(_,M,n)):_[M]=f,w=T.next(),++M;l=M}else if(a(d)){for(l=d.length,x&&(_=new x),M=0,v=0;M<l;++M)f=d[M],M+1<l&&(y=f.charCodeAt(0),y>=55296&&y<=56319&&(f+=d[++M])),f=s?i.call(s,m,f,v):f,x?(n.value=f,r(_,v,n)):_[v]=f,++v;l=v}}if(l===void 0)for(l=E(d.length),x&&(_=new x(l)),M=0;M<l;++M)f=s?i.call(s,m,d[M],M):d[M],x?(n.value=f,r(_,M,n)):_[M]=f;return x&&(n.value=null,_.length=l),_}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(c,ae,ie){"use strict";var b=Object.prototype.toString,k=b.call(function(){return arguments}());ae.exports=function(P){return b.call(P)===k}},{}],136:[function(c,ae,ie){"use strict";var b=Object.prototype.toString,k=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);ae.exports=function(P){return typeof P=="function"&&k(b.call(P))}},{}],137:[function(c,ae,ie){"use strict";ae.exports=function(){}},{}],138:[function(c,ae,ie){"use strict";ae.exports=c("./is-implemented")()?Math.sign:c("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(c,ae,ie){"use strict";ae.exports=function(){var b=Math.sign;return typeof b!="function"?!1:b(10)===1&&b(-20)===-1}},{}],140:[function(c,ae,ie){"use strict";ae.exports=function(b){return b=Number(b),isNaN(b)||b===0?b:b>0?1:-1}},{}],141:[function(c,ae,ie){"use strict";var b=c("../math/sign"),k=Math.abs,P=Math.floor;ae.exports=function(E){return isNaN(E)?0:(E=Number(E),E===0||!isFinite(E)?E:b(E)*P(k(E)))}},{"../math/sign":138}],142:[function(c,ae,ie){"use strict";var b=c("./to-integer"),k=Math.max;ae.exports=function(P){return k(0,b(P))}},{"./to-integer":141}],143:[function(c,ae,ie){"use strict";var b=c("./valid-callable"),k=c("./valid-value"),P=Function.prototype.bind,E=Function.prototype.call,e=Object.keys,p=Object.prototype.propertyIsEnumerable;ae.exports=function(g,a){return function(t,i){var n,r=arguments[2],d=arguments[3];return t=Object(k(t)),b(i),n=e(t),d&&n.sort(typeof d=="function"?P.call(d,t):void 0),typeof g!="function"&&(g=n[g]),E.call(g,n,function(s,m){return p.call(t,s)?E.call(i,r,t[s],s,t,m):a})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(c,ae,ie){"use strict";ae.exports=c("./is-implemented")()?Object.assign:c("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(c,ae,ie){"use strict";ae.exports=function(){var b=Object.assign,k;return typeof b!="function"?!1:(k={foo:"raz"},b(k,{bar:"dwa"},{trzy:"trzy"}),k.foo+k.bar+k.trzy==="razdwatrzy")}},{}],146:[function(c,ae,ie){"use strict";var b=c("../keys"),k=c("../valid-value"),P=Math.max;ae.exports=function(E,e){var p,g,a=P(arguments.length,2),t;for(E=Object(k(E)),t=function(i){try{E[i]=e[i]}catch(n){p||(p=n)}},g=1;g<a;++g)e=arguments[g],b(e).forEach(t);if(p!==void 0)throw p;return E}},{"../keys":152,"../valid-value":162}],147:[function(c,ae,ie){"use strict";var b=c("../array/from"),k=c("./assign"),P=c("./valid-value");ae.exports=function(E){var e=Object(P(E)),p=arguments[1],g=Object(arguments[2]);if(e!==E&&!p)return e;var a={};return p?b(p,function(t){(g.ensure||t in E)&&(a[t]=E[t])}):k(a,E),a}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(c,ae,ie){"use strict";var b=Object.create,k;c("./set-prototype-of/is-implemented")()||(k=c("./set-prototype-of/shim")),ae.exports=function(){var P,E,e;return!k||k.level!==1?b:(P={},E={},e={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(p){if(p==="__proto__"){E[p]={configurable:!0,enumerable:!1,writable:!0,value:void 0};return}E[p]=e}),Object.defineProperties(P,E),Object.defineProperty(k,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:P}),function(p,g){return b(p===null?P:p,g)})}()},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(c,ae,ie){"use strict";ae.exports=c("./_iterate")("forEach")},{"./_iterate":143}],150:[function(c,ae,ie){"use strict";var b=c("./is-value"),k={function:!0,object:!0};ae.exports=function(P){return b(P)&&k[typeof P]||!1}},{"./is-value":151}],151:[function(c,ae,ie){"use strict";var b=c("../function/noop")();ae.exports=function(k){return k!==b&&k!==null}},{"../function/noop":137}],152:[function(c,ae,ie){"use strict";ae.exports=c("./is-implemented")()?Object.keys:c("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(c,ae,ie){"use strict";ae.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(c,ae,ie){"use strict";var b=c("../is-value"),k=Object.keys;ae.exports=function(P){return k(b(P)?Object(P):P)}},{"../is-value":151}],155:[function(c,ae,ie){"use strict";var b=c("./valid-callable"),k=c("./for-each"),P=Function.prototype.call;ae.exports=function(E,e){var p={},g=arguments[2];return b(e),k(E,function(a,t,i,n){p[t]=P.call(e,g,a,t,i,n)}),p}},{"./for-each":149,"./valid-callable":160}],156:[function(c,ae,ie){"use strict";var b=c("./is-value"),k=Array.prototype.forEach,P=Object.create,E=function(e,p){var g;for(g in e)p[g]=e[g]};ae.exports=function(e){var p=P(null);return k.call(arguments,function(g){!b(g)||E(Object(g),p)}),p}},{"./is-value":151}],157:[function(c,ae,ie){"use strict";ae.exports=c("./is-implemented")()?Object.setPrototypeOf:c("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(c,ae,ie){"use strict";var b=Object.create,k=Object.getPrototypeOf,P={};ae.exports=function(){var E=Object.setPrototypeOf,e=arguments[0]||b;return typeof E!="function"?!1:k(E(e(null),P))===P}},{}],159:[function(c,ae,ie){"use strict";var b=c("../is-object"),k=c("../valid-value"),P=Object.prototype.isPrototypeOf,E=Object.defineProperty,e={configurable:!0,enumerable:!1,writable:!0,value:void 0},p;p=function(g,a){if(k(g),a===null||b(a))return g;throw new TypeError("Prototype must be null or an object")},ae.exports=function(g){var a,t;return g?(g.level===2?g.set?(t=g.set,a=function(i,n){return t.call(p(i,n),n),i}):a=function(i,n){return p(i,n).__proto__=n,i}:a=function i(n,r){var d;return p(n,r),d=P.call(i.nullPolyfill,n),d&&delete i.nullPolyfill.__proto__,r===null&&(r=i.nullPolyfill),n.__proto__=r,d&&E(i.nullPolyfill,"__proto__",e),n},Object.defineProperty(a,"level",{configurable:!1,enumerable:!1,writable:!1,value:g.level})):null}(function(){var g=Object.create(null),a={},t,i=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(i){try{t=i.set,t.call(g,a)}catch{}if(Object.getPrototypeOf(g)===a)return{set:t,level:2}}return g.__proto__=a,Object.getPrototypeOf(g)===a?{level:2}:(g={},g.__proto__=a,Object.getPrototypeOf(g)===a?{level:1}:!1)}()),c("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(c,ae,ie){"use strict";ae.exports=function(b){if(typeof b!="function")throw new TypeError(b+" is not a function");return b}},{}],161:[function(c,ae,ie){"use strict";var b=c("./is-object");ae.exports=function(k){if(!b(k))throw new TypeError(k+" is not an Object");return k}},{"./is-object":150}],162:[function(c,ae,ie){"use strict";var b=c("./is-value");ae.exports=function(k){if(!b(k))throw new TypeError("Cannot use null or undefined");return k}},{"./is-value":151}],163:[function(c,ae,ie){"use strict";ae.exports=c("./is-implemented")()?String.prototype.contains:c("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(c,ae,ie){"use strict";var b="razdwatrzy";ae.exports=function(){return typeof b.contains!="function"?!1:b.contains("dwa")===!0&&b.contains("foo")===!1}},{}],165:[function(c,ae,ie){"use strict";var b=String.prototype.indexOf;ae.exports=function(k){return b.call(this,k,arguments[1])>-1}},{}],166:[function(c,ae,ie){"use strict";var b=Object.prototype.toString,k=b.call("");ae.exports=function(P){return typeof P=="string"||P&&typeof P=="object"&&(P instanceof String||b.call(P)===k)||!1}},{}],167:[function(c,ae,ie){"use strict";var b=Object.create(null),k=Math.random;ae.exports=function(){var P;do P=k().toString(36).slice(2);while(b[P]);return P}},{}],168:[function(c,ae,ie){"use strict";var b=c("es5-ext/object/set-prototype-of"),k=c("es5-ext/string/#/contains"),P=c("d"),E=c("es6-symbol"),e=c("./"),p=Object.defineProperty,g;g=ae.exports=function(a,t){if(!(this instanceof g))throw new TypeError("Constructor requires 'new'");e.call(this,a),t?k.call(t,"key+value")?t="key+value":k.call(t,"key")?t="key":t="value":t="value",p(this,"__kind__",P("",t))},b&&b(g,e),delete g.prototype.constructor,g.prototype=Object.create(e.prototype,{_resolve:P(function(a){return this.__kind__==="value"?this.__list__[a]:this.__kind__==="key+value"?[a,this.__list__[a]]:a})}),p(g.prototype,E.toStringTag,P("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(c,ae,ie){"use strict";var b=c("es5-ext/function/is-arguments"),k=c("es5-ext/object/valid-callable"),P=c("es5-ext/string/is-string"),E=c("./get"),e=Array.isArray,p=Function.prototype.call,g=Array.prototype.some;ae.exports=function(a,t){var i,n=arguments[2],r,d,s,m,x,M,v;if(e(a)||b(a)?i="array":P(a)?i="string":a=E(a),k(t),d=function(){s=!0},i==="array"){g.call(a,function(_){return p.call(t,n,_,d),s});return}if(i==="string"){for(x=a.length,m=0;m<x&&(M=a[m],m+1<x&&(v=M.charCodeAt(0),v>=55296&&v<=56319&&(M+=a[++m])),p.call(t,n,M,d),!s);++m);return}for(r=a.next();!r.done;){if(p.call(t,n,r.value,d),s)return;r=a.next()}}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(c,ae,ie){"use strict";var b=c("es5-ext/function/is-arguments"),k=c("es5-ext/string/is-string"),P=c("./array"),E=c("./string"),e=c("./valid-iterable"),p=c("es6-symbol").iterator;ae.exports=function(g){return typeof e(g)[p]=="function"?g[p]():b(g)?new P(g):k(g)?new E(g):new P(g)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(c,ae,ie){"use strict";var b=c("es5-ext/array/#/clear"),k=c("es5-ext/object/assign"),P=c("es5-ext/object/valid-callable"),E=c("es5-ext/object/valid-value"),e=c("d"),p=c("d/auto-bind"),g=c("es6-symbol"),a=Object.defineProperty,t=Object.defineProperties,i;ae.exports=i=function(n,r){if(!(this instanceof i))throw new TypeError("Constructor requires 'new'");t(this,{__list__:e("w",E(n)),__context__:e("w",r),__nextIndex__:e("w",0)}),r&&(P(r.on),r.on("_add",this._onAdd),r.on("_delete",this._onDelete),r.on("_clear",this._onClear))},delete i.prototype.constructor,t(i.prototype,k({_next:e(function(){var n;if(!!this.__list__){if(this.__redo__&&(n=this.__redo__.shift(),n!==void 0))return n;if(this.__nextIndex__<this.__list__.length)return this.__nextIndex__++;this._unBind()}}),next:e(function(){return this._createResult(this._next())}),_createResult:e(function(n){return n===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(n)}}),_resolve:e(function(n){return this.__list__[n]}),_unBind:e(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:e(function(){return"[object "+(this[g.toStringTag]||"Object")+"]"})},p({_onAdd:e(function(n){if(!(n>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__){a(this,"__redo__",e("c",[n]));return}this.__redo__.forEach(function(r,d){r>=n&&(this.__redo__[d]=++r)},this),this.__redo__.push(n)}}),_onDelete:e(function(n){var r;n>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(r=this.__redo__.indexOf(n),r!==-1&&this.__redo__.splice(r,1),this.__redo__.forEach(function(d,s){d>n&&(this.__redo__[s]=--d)},this)))}),_onClear:e(function(){this.__redo__&&b.call(this.__redo__),this.__nextIndex__=0})}))),a(i.prototype,g.iterator,e(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(c,ae,ie){"use strict";var b=c("es5-ext/function/is-arguments"),k=c("es5-ext/object/is-value"),P=c("es5-ext/string/is-string"),E=c("es6-symbol").iterator,e=Array.isArray;ae.exports=function(p){return k(p)?e(p)||P(p)||b(p)?!0:typeof p[E]=="function":!1}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(c,ae,ie){"use strict";var b=c("es5-ext/object/set-prototype-of"),k=c("d"),P=c("es6-symbol"),E=c("./"),e=Object.defineProperty,p;p=ae.exports=function(g){if(!(this instanceof p))throw new TypeError("Constructor requires 'new'");g=String(g),E.call(this,g),e(this,"__length__",k("",g.length))},b&&b(p,E),delete p.prototype.constructor,p.prototype=Object.create(E.prototype,{_next:k(function(){if(!!this.__list__){if(this.__nextIndex__<this.__length__)return this.__nextIndex__++;this._unBind()}}),_resolve:k(function(g){var a=this.__list__[g],t;return this.__nextIndex__===this.__length__?a:(t=a.charCodeAt(0),t>=55296&&t<=56319?a+this.__list__[this.__nextIndex__++]:a)})}),e(p.prototype,P.toStringTag,k("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(c,ae,ie){"use strict";var b=c("./is-iterable");ae.exports=function(k){if(!b(k))throw new TypeError(k+" is not iterable");return k}},{"./is-iterable":172}],175:[function(c,ae,ie){"use strict";ae.exports=c("./is-implemented")()?c("ext/global-this").Symbol:c("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(c,ae,ie){"use strict";var b=c("ext/global-this"),k={object:!0,symbol:!0};ae.exports=function(){var P=b.Symbol,E;if(typeof P!="function")return!1;E=P("test symbol");try{String(E)}catch{return!1}return!(!k[typeof P.iterator]||!k[typeof P.toPrimitive]||!k[typeof P.toStringTag])}},{"ext/global-this":188}],177:[function(c,ae,ie){"use strict";ae.exports=function(b){return b?typeof b=="symbol"?!0:!b.constructor||b.constructor.name!=="Symbol"?!1:b[b.constructor.toStringTag]==="Symbol":!1}},{}],178:[function(c,ae,ie){"use strict";var b=c("d"),k=Object.create,P=Object.defineProperty,E=Object.prototype,e=k(null);ae.exports=function(p){for(var g=0,a,t;e[p+(g||"")];)++g;return p+=g||"",e[p]=!0,a="@@"+p,P(E,a,b.gs(null,function(i){t||(t=!0,P(this,a,b(i)),t=!1)})),a}},{d:106}],179:[function(c,ae,ie){"use strict";var b=c("d"),k=c("ext/global-this").Symbol;ae.exports=function(P){return Object.defineProperties(P,{hasInstance:b("",k&&k.hasInstance||P("hasInstance")),isConcatSpreadable:b("",k&&k.isConcatSpreadable||P("isConcatSpreadable")),iterator:b("",k&&k.iterator||P("iterator")),match:b("",k&&k.match||P("match")),replace:b("",k&&k.replace||P("replace")),search:b("",k&&k.search||P("search")),species:b("",k&&k.species||P("species")),split:b("",k&&k.split||P("split")),toPrimitive:b("",k&&k.toPrimitive||P("toPrimitive")),toStringTag:b("",k&&k.toStringTag||P("toStringTag")),unscopables:b("",k&&k.unscopables||P("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(c,ae,ie){"use strict";var b=c("d"),k=c("../../../validate-symbol"),P=Object.create(null);ae.exports=function(E){return Object.defineProperties(E,{for:b(function(e){return P[e]?P[e]:P[e]=E(String(e))}),keyFor:b(function(e){var p;k(e);for(p in P)if(P[p]===e)return p})})}},{"../../../validate-symbol":182,d:106}],181:[function(c,ae,ie){"use strict";var b=c("d"),k=c("./validate-symbol"),P=c("ext/global-this").Symbol,E=c("./lib/private/generate-name"),e=c("./lib/private/setup/standard-symbols"),p=c("./lib/private/setup/symbol-registry"),g=Object.create,a=Object.defineProperties,t=Object.defineProperty,i,n,r;if(typeof P=="function")try{String(P()),r=!0}catch{}else P=null;n=function(s){if(this instanceof n)throw new TypeError("Symbol is not a constructor");return i(s)},ae.exports=i=function d(s){var m;if(this instanceof d)throw new TypeError("Symbol is not a constructor");return r?P(s):(m=g(n.prototype),s=s===void 0?"":String(s),a(m,{__description__:b("",s),__name__:b("",E(s))}))},e(i),p(i),a(n.prototype,{constructor:b(i),toString:b("",function(){return this.__name__})}),a(i.prototype,{toString:b(function(){return"Symbol ("+k(this).__description__+")"}),valueOf:b(function(){return k(this)})}),t(i.prototype,i.toPrimitive,b("",function(){var d=k(this);return typeof d=="symbol"?d:d.toString()})),t(i.prototype,i.toStringTag,b("c","Symbol")),t(n.prototype,i.toStringTag,b("c",i.prototype[i.toStringTag])),t(n.prototype,i.toPrimitive,b("c",i.prototype[i.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(c,ae,ie){"use strict";var b=c("./is-symbol");ae.exports=function(k){if(!b(k))throw new TypeError(k+" is not a symbol");return k}},{"./is-symbol":177}],183:[function(c,ae,ie){"use strict";ae.exports=c("./is-implemented")()?WeakMap:c("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(c,ae,ie){"use strict";ae.exports=function(){var b,k;if(typeof WeakMap!="function")return!1;try{b=new WeakMap([[k={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return!(String(b)!=="[object WeakMap]"||typeof b.set!="function"||b.set({},1)!==b||typeof b.delete!="function"||typeof b.has!="function"||b.get(k)!=="one")}},{}],185:[function(c,ae,ie){"use strict";ae.exports=function(){return typeof WeakMap!="function"?!1:Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"}()},{}],186:[function(c,ae,ie){"use strict";var b=c("es5-ext/object/is-value"),k=c("es5-ext/object/set-prototype-of"),P=c("es5-ext/object/valid-object"),E=c("es5-ext/object/valid-value"),e=c("es5-ext/string/random-uniq"),p=c("d"),g=c("es6-iterator/get"),a=c("es6-iterator/for-of"),t=c("es6-symbol").toStringTag,i=c("./is-native-implemented"),n=Array.isArray,r=Object.defineProperty,d=Object.prototype.hasOwnProperty,s=Object.getPrototypeOf,m;ae.exports=m=function(){var x=arguments[0],M;if(!(this instanceof m))throw new TypeError("Constructor requires 'new'");return M=i&&k&&WeakMap!==m?k(new WeakMap,s(this)):this,b(x)&&(n(x)||(x=g(x))),r(M,"__weakMapData__",p("c","$weakMap$"+e())),x&&a(x,function(v){E(v),M.set(v[0],v[1])}),M},i&&(k&&k(m,WeakMap),m.prototype=Object.create(WeakMap.prototype,{constructor:p(m)})),Object.defineProperties(m.prototype,{delete:p(function(x){return d.call(P(x),this.__weakMapData__)?(delete x[this.__weakMapData__],!0):!1}),get:p(function(x){if(!!d.call(P(x),this.__weakMapData__))return x[this.__weakMapData__]}),has:p(function(x){return d.call(P(x),this.__weakMapData__)}),set:p(function(x,M){return r(P(x),this.__weakMapData__,p("c",M)),this}),toString:p(function(){return"[object WeakMap]"})}),r(m.prototype,t,p("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(c,ae,ie){var b=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};ae.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return b()}try{return __global__||b()}finally{delete Object.prototype.__global__}}()},{}],188:[function(c,ae,ie){"use strict";ae.exports=c("./is-implemented")()?globalThis:c("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(c,ae,ie){"use strict";ae.exports=function(){return typeof globalThis!="object"||!globalThis?!1:globalThis.Array===Array}},{}],190:[function(c,ae,ie){"use strict";var b=c("is-string-blank");ae.exports=function(k){var P=typeof k;if(P==="string"){var E=k;if(k=+k,k===0&&b(E))return!1}else if(P!=="number")return!1;return k-k<1}},{"is-string-blank":237}],191:[function(c,ae,ie){var b=c("dtype");ae.exports=k;function k(P,E,e){if(!P)throw new TypeError("must specify data as first parameter");if(e=+(e||0)|0,Array.isArray(P)&&P[0]&&typeof P[0][0]=="number"){var p=P[0].length,g=P.length*p,a,t,i,n;(!E||typeof E=="string")&&(E=new(b(E||"float32"))(g+e));var r=E.length-e;if(g!==r)throw new Error("source length "+g+" ("+p+"x"+P.length+") does not match destination length "+r);for(a=0,i=e;a<P.length;a++)for(t=0;t<p;t++)E[i++]=P[a][t]===null?NaN:P[a][t]}else if(!E||typeof E=="string"){var d=b(E||"float32");if(Array.isArray(P)||E==="array")for(E=new d(P.length+e),a=0,i=e,n=E.length;i<n;i++,a++)E[i]=P[a]===null?NaN:P[a];else e===0?E=new d(P):(E=new d(P.length+e),E.set(P,e))}else E.set(P,e);return E}},{dtype:127}],192:[function(c,ae,ie){"use strict";var b=c("css-font/stringify"),k=[32,126];ae.exports=P;function P(E){E=E||{};var e=E.shape?E.shape:E.canvas?[E.canvas.width,E.canvas.height]:[512,512],p=E.canvas||document.createElement("canvas"),g=E.font,a=typeof E.step=="number"?[E.step,E.step]:E.step||[32,32],t=E.chars||k;if(g&&typeof g!="string"&&(g=b(g)),!Array.isArray(t))t=String(t).split("");else if(t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"){for(var i=[],n=t[0],r=0;n<=t[1];n++)i[r++]=String.fromCharCode(n);t=i}e=e.slice(),p.width=e[0],p.height=e[1];var d=p.getContext("2d");d.fillStyle="#000",d.fillRect(0,0,p.width,p.height),d.font=g,d.textAlign="center",d.textBaseline="middle",d.fillStyle="#fff";for(var s=a[0]/2,m=a[1]/2,n=0;n<t.length;n++)d.fillText(t[n],s,m),(s+=a[0])>e[0]-a[0]/2&&(s=a[0]/2,m+=a[1]);return p}},{"css-font/stringify":102}],193:[function(c,ae,ie){"use strict";ae.exports=b,b.canvas=document.createElement("canvas"),b.cache={};function b(n,p){p||(p={}),(typeof n=="string"||Array.isArray(n))&&(p.family=n);var g=Array.isArray(p.family)?p.family.join(", "):p.family;if(!g)throw Error("`family` must be defined");var a=p.size||p.fontSize||p.em||48,t=p.weight||p.fontWeight||"",i=p.style||p.fontStyle||"",n=[i,t,a].join(" ")+"px "+g,r=p.origin||"top";if(b.cache[g]&&a<=b.cache[g].em)return k(b.cache[g],r);var d=p.canvas||b.canvas,s=d.getContext("2d"),m={upper:p.upper!==void 0?p.upper:"H",lower:p.lower!==void 0?p.lower:"x",descent:p.descent!==void 0?p.descent:"p",ascent:p.ascent!==void 0?p.ascent:"h",tittle:p.tittle!==void 0?p.tittle:"i",overshoot:p.overshoot!==void 0?p.overshoot:"O"},x=Math.ceil(a*1.5);d.height=x,d.width=x*.5,s.font=n;var M="H",v={top:0};s.clearRect(0,0,x,x),s.textBaseline="top",s.fillStyle="black",s.fillText(M,0,0);var _=P(s.getImageData(0,0,x,x));s.clearRect(0,0,x,x),s.textBaseline="bottom",s.fillText(M,0,x);var l=P(s.getImageData(0,0,x,x));v.lineHeight=v.bottom=x-l+_,s.clearRect(0,0,x,x),s.textBaseline="alphabetic",s.fillText(M,0,x);var y=P(s.getImageData(0,0,x,x)),T=x-y-1+_;v.baseline=v.alphabetic=T,s.clearRect(0,0,x,x),s.textBaseline="middle",s.fillText(M,0,x*.5);var w=P(s.getImageData(0,0,x,x));v.median=v.middle=x-w-1+_-x*.5,s.clearRect(0,0,x,x),s.textBaseline="hanging",s.fillText(M,0,x*.5);var A=P(s.getImageData(0,0,x,x));v.hanging=x-A-1+_-x*.5,s.clearRect(0,0,x,x),s.textBaseline="ideographic",s.fillText(M,0,x);var f=P(s.getImageData(0,0,x,x));if(v.ideographic=x-f-1+_,m.upper&&(s.clearRect(0,0,x,x),s.textBaseline="top",s.fillText(m.upper,0,0),v.upper=P(s.getImageData(0,0,x,x)),v.capHeight=v.baseline-v.upper),m.lower&&(s.clearRect(0,0,x,x),s.textBaseline="top",s.fillText(m.lower,0,0),v.lower=P(s.getImageData(0,0,x,x)),v.xHeight=v.baseline-v.lower),m.tittle&&(s.clearRect(0,0,x,x),s.textBaseline="top",s.fillText(m.tittle,0,0),v.tittle=P(s.getImageData(0,0,x,x))),m.ascent&&(s.clearRect(0,0,x,x),s.textBaseline="top",s.fillText(m.ascent,0,0),v.ascent=P(s.getImageData(0,0,x,x))),m.descent&&(s.clearRect(0,0,x,x),s.textBaseline="top",s.fillText(m.descent,0,0),v.descent=E(s.getImageData(0,0,x,x))),m.overshoot){s.clearRect(0,0,x,x),s.textBaseline="top",s.fillText(m.overshoot,0,0);var u=E(s.getImageData(0,0,x,x));v.overshoot=u-T}for(var h in v)v[h]/=a;return v.em=a,b.cache[g]=v,k(v,r)}function k(e,p){var g={};typeof p=="string"&&(p=e[p]);for(var a in e)a!=="em"&&(g[a]=e[a]-p);return g}function P(e){for(var p=e.height,g=e.data,a=3;a<g.length;a+=4)if(g[a]!==0)return Math.floor((a-3)*.25/p)}function E(e){for(var p=e.height,g=e.data,a=g.length-1;a>0;a-=4)if(g[a]!==0)return Math.floor((a-3)*.25/p)}},{}],194:[function(c,ae,ie){ae.exports=b;function b(k,P){if(typeof k!="string")throw new TypeError("must specify type string");if(P=P||{},typeof document>"u"&&!P.canvas)return null;var E=P.canvas||document.createElement("canvas");typeof P.width=="number"&&(E.width=P.width),typeof P.height=="number"&&(E.height=P.height);var e=P,p;try{var g=[k];k.indexOf("webgl")===0&&g.push("experimental-"+k);for(var a=0;a<g.length;a++)if(p=E.getContext(g[a],e),p)return p}catch{p=null}return p||null}},{}],195:[function(c,ae,ie){ae.exports=b;function b(k,P){var E=P[0],e=P[1],p=P[2],g=P[3],a=P[4],t=P[5],i=P[6],n=P[7],r=P[8],d=P[9],s=P[10],m=P[11],x=P[12],M=P[13],v=P[14],_=P[15];return k[0]=t*(s*_-m*v)-d*(i*_-n*v)+M*(i*m-n*s),k[1]=-(e*(s*_-m*v)-d*(p*_-g*v)+M*(p*m-g*s)),k[2]=e*(i*_-n*v)-t*(p*_-g*v)+M*(p*n-g*i),k[3]=-(e*(i*m-n*s)-t*(p*m-g*s)+d*(p*n-g*i)),k[4]=-(a*(s*_-m*v)-r*(i*_-n*v)+x*(i*m-n*s)),k[5]=E*(s*_-m*v)-r*(p*_-g*v)+x*(p*m-g*s),k[6]=-(E*(i*_-n*v)-a*(p*_-g*v)+x*(p*n-g*i)),k[7]=E*(i*m-n*s)-a*(p*m-g*s)+r*(p*n-g*i),k[8]=a*(d*_-m*M)-r*(t*_-n*M)+x*(t*m-n*d),k[9]=-(E*(d*_-m*M)-r*(e*_-g*M)+x*(e*m-g*d)),k[10]=E*(t*_-n*M)-a*(e*_-g*M)+x*(e*n-g*t),k[11]=-(E*(t*m-n*d)-a*(e*m-g*d)+r*(e*n-g*t)),k[12]=-(a*(d*v-s*M)-r*(t*v-i*M)+x*(t*s-i*d)),k[13]=E*(d*v-s*M)-r*(e*v-p*M)+x*(e*s-p*d),k[14]=-(E*(t*v-i*M)-a*(e*v-p*M)+x*(e*i-p*t)),k[15]=E*(t*s-i*d)-a*(e*s-p*d)+r*(e*i-p*t),k}},{}],196:[function(c,ae,ie){ae.exports=b;function b(k){var P=new Float32Array(16);return P[0]=k[0],P[1]=k[1],P[2]=k[2],P[3]=k[3],P[4]=k[4],P[5]=k[5],P[6]=k[6],P[7]=k[7],P[8]=k[8],P[9]=k[9],P[10]=k[10],P[11]=k[11],P[12]=k[12],P[13]=k[13],P[14]=k[14],P[15]=k[15],P}},{}],197:[function(c,ae,ie){ae.exports=b;function b(k,P){return k[0]=P[0],k[1]=P[1],k[2]=P[2],k[3]=P[3],k[4]=P[4],k[5]=P[5],k[6]=P[6],k[7]=P[7],k[8]=P[8],k[9]=P[9],k[10]=P[10],k[11]=P[11],k[12]=P[12],k[13]=P[13],k[14]=P[14],k[15]=P[15],k}},{}],198:[function(c,ae,ie){ae.exports=b;function b(){var k=new Float32Array(16);return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k}},{}],199:[function(c,ae,ie){ae.exports=b;function b(k){var P=k[0],E=k[1],e=k[2],p=k[3],g=k[4],a=k[5],t=k[6],i=k[7],n=k[8],r=k[9],d=k[10],s=k[11],m=k[12],x=k[13],M=k[14],v=k[15],_=P*a-E*g,l=P*t-e*g,y=P*i-p*g,T=E*t-e*a,w=E*i-p*a,A=e*i-p*t,f=n*x-r*m,u=n*M-d*m,h=n*v-s*m,o=r*M-d*x,S=r*v-s*x,R=d*v-s*M;return _*R-l*S+y*o+T*h-w*u+A*f}},{}],200:[function(c,ae,ie){ae.exports=b;function b(k,P){var E=P[0],e=P[1],p=P[2],g=P[3],a=E+E,t=e+e,i=p+p,n=E*a,r=e*a,d=e*t,s=p*a,m=p*t,x=p*i,M=g*a,v=g*t,_=g*i;return k[0]=1-d-x,k[1]=r+_,k[2]=s-v,k[3]=0,k[4]=r-_,k[5]=1-n-x,k[6]=m+M,k[7]=0,k[8]=s+v,k[9]=m-M,k[10]=1-n-d,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k}},{}],201:[function(c,ae,ie){ae.exports=b;function b(k,P,E){var e,p,g,a=E[0],t=E[1],i=E[2],n=Math.sqrt(a*a+t*t+i*i);return Math.abs(n)<1e-6?null:(n=1/n,a*=n,t*=n,i*=n,e=Math.sin(P),p=Math.cos(P),g=1-p,k[0]=a*a*g+p,k[1]=t*a*g+i*e,k[2]=i*a*g-t*e,k[3]=0,k[4]=a*t*g-i*e,k[5]=t*t*g+p,k[6]=i*t*g+a*e,k[7]=0,k[8]=a*i*g+t*e,k[9]=t*i*g-a*e,k[10]=i*i*g+p,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k)}},{}],202:[function(c,ae,ie){ae.exports=b;function b(k,P,E){var e=P[0],p=P[1],g=P[2],a=P[3],t=e+e,i=p+p,n=g+g,r=e*t,d=e*i,s=e*n,m=p*i,x=p*n,M=g*n,v=a*t,_=a*i,l=a*n;return k[0]=1-(m+M),k[1]=d+l,k[2]=s-_,k[3]=0,k[4]=d-l,k[5]=1-(r+M),k[6]=x+v,k[7]=0,k[8]=s+_,k[9]=x-v,k[10]=1-(r+m),k[11]=0,k[12]=E[0],k[13]=E[1],k[14]=E[2],k[15]=1,k}},{}],203:[function(c,ae,ie){ae.exports=b;function b(k,P){return k[0]=P[0],k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=P[1],k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=P[2],k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k}},{}],204:[function(c,ae,ie){ae.exports=b;function b(k,P){return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=P[0],k[13]=P[1],k[14]=P[2],k[15]=1,k}},{}],205:[function(c,ae,ie){ae.exports=b;function b(k,P){var E=Math.sin(P),e=Math.cos(P);return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=e,k[6]=E,k[7]=0,k[8]=0,k[9]=-E,k[10]=e,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k}},{}],206:[function(c,ae,ie){ae.exports=b;function b(k,P){var E=Math.sin(P),e=Math.cos(P);return k[0]=e,k[1]=0,k[2]=-E,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=E,k[9]=0,k[10]=e,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k}},{}],207:[function(c,ae,ie){ae.exports=b;function b(k,P){var E=Math.sin(P),e=Math.cos(P);return k[0]=e,k[1]=E,k[2]=0,k[3]=0,k[4]=-E,k[5]=e,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k}},{}],208:[function(c,ae,ie){ae.exports=b;function b(k,P,E,e,p,g,a){var t=1/(E-P),i=1/(p-e),n=1/(g-a);return k[0]=g*2*t,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=g*2*i,k[6]=0,k[7]=0,k[8]=(E+P)*t,k[9]=(p+e)*i,k[10]=(a+g)*n,k[11]=-1,k[12]=0,k[13]=0,k[14]=a*g*2*n,k[15]=0,k}},{}],209:[function(c,ae,ie){ae.exports=b;function b(k){return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=1,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=1,k[11]=0,k[12]=0,k[13]=0,k[14]=0,k[15]=1,k}},{}],210:[function(c,ae,ie){ae.exports={create:c("./create"),clone:c("./clone"),copy:c("./copy"),identity:c("./identity"),transpose:c("./transpose"),invert:c("./invert"),adjoint:c("./adjoint"),determinant:c("./determinant"),multiply:c("./multiply"),translate:c("./translate"),scale:c("./scale"),rotate:c("./rotate"),rotateX:c("./rotateX"),rotateY:c("./rotateY"),rotateZ:c("./rotateZ"),fromRotation:c("./fromRotation"),fromRotationTranslation:c("./fromRotationTranslation"),fromScaling:c("./fromScaling"),fromTranslation:c("./fromTranslation"),fromXRotation:c("./fromXRotation"),fromYRotation:c("./fromYRotation"),fromZRotation:c("./fromZRotation"),fromQuat:c("./fromQuat"),frustum:c("./frustum"),perspective:c("./perspective"),perspectiveFromFieldOfView:c("./perspectiveFromFieldOfView"),ortho:c("./ortho"),lookAt:c("./lookAt"),str:c("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(c,ae,ie){ae.exports=b;function b(k,P){var E=P[0],e=P[1],p=P[2],g=P[3],a=P[4],t=P[5],i=P[6],n=P[7],r=P[8],d=P[9],s=P[10],m=P[11],x=P[12],M=P[13],v=P[14],_=P[15],l=E*t-e*a,y=E*i-p*a,T=E*n-g*a,w=e*i-p*t,A=e*n-g*t,f=p*n-g*i,u=r*M-d*x,h=r*v-s*x,o=r*_-m*x,S=d*v-s*M,R=d*_-m*M,z=s*_-m*v,O=l*z-y*R+T*S+w*o-A*h+f*u;return O?(O=1/O,k[0]=(t*z-i*R+n*S)*O,k[1]=(p*R-e*z-g*S)*O,k[2]=(M*f-v*A+_*w)*O,k[3]=(s*A-d*f-m*w)*O,k[4]=(i*o-a*z-n*h)*O,k[5]=(E*z-p*o+g*h)*O,k[6]=(v*T-x*f-_*y)*O,k[7]=(r*f-s*T+m*y)*O,k[8]=(a*R-t*o+n*u)*O,k[9]=(e*o-E*R-g*u)*O,k[10]=(x*A-M*T+_*l)*O,k[11]=(d*T-r*A-m*l)*O,k[12]=(t*h-a*S-i*u)*O,k[13]=(E*S-e*h+p*u)*O,k[14]=(M*y-x*w-v*l)*O,k[15]=(r*w-d*y+s*l)*O,k):null}},{}],212:[function(c,ae,ie){var b=c("./identity");ae.exports=k;function k(P,E,e,p){var g,a,t,i,n,r,d,s,m,x,M=E[0],v=E[1],_=E[2],l=p[0],y=p[1],T=p[2],w=e[0],A=e[1],f=e[2];return Math.abs(M-w)<1e-6&&Math.abs(v-A)<1e-6&&Math.abs(_-f)<1e-6?b(P):(d=M-w,s=v-A,m=_-f,x=1/Math.sqrt(d*d+s*s+m*m),d*=x,s*=x,m*=x,g=y*m-T*s,a=T*d-l*m,t=l*s-y*d,x=Math.sqrt(g*g+a*a+t*t),x?(x=1/x,g*=x,a*=x,t*=x):(g=0,a=0,t=0),i=s*t-m*a,n=m*g-d*t,r=d*a-s*g,x=Math.sqrt(i*i+n*n+r*r),x?(x=1/x,i*=x,n*=x,r*=x):(i=0,n=0,r=0),P[0]=g,P[1]=i,P[2]=d,P[3]=0,P[4]=a,P[5]=n,P[6]=s,P[7]=0,P[8]=t,P[9]=r,P[10]=m,P[11]=0,P[12]=-(g*M+a*v+t*_),P[13]=-(i*M+n*v+r*_),P[14]=-(d*M+s*v+m*_),P[15]=1,P)}},{"./identity":209}],213:[function(c,ae,ie){ae.exports=b;function b(k,P,E){var e=P[0],p=P[1],g=P[2],a=P[3],t=P[4],i=P[5],n=P[6],r=P[7],d=P[8],s=P[9],m=P[10],x=P[11],M=P[12],v=P[13],_=P[14],l=P[15],y=E[0],T=E[1],w=E[2],A=E[3];return k[0]=y*e+T*t+w*d+A*M,k[1]=y*p+T*i+w*s+A*v,k[2]=y*g+T*n+w*m+A*_,k[3]=y*a+T*r+w*x+A*l,y=E[4],T=E[5],w=E[6],A=E[7],k[4]=y*e+T*t+w*d+A*M,k[5]=y*p+T*i+w*s+A*v,k[6]=y*g+T*n+w*m+A*_,k[7]=y*a+T*r+w*x+A*l,y=E[8],T=E[9],w=E[10],A=E[11],k[8]=y*e+T*t+w*d+A*M,k[9]=y*p+T*i+w*s+A*v,k[10]=y*g+T*n+w*m+A*_,k[11]=y*a+T*r+w*x+A*l,y=E[12],T=E[13],w=E[14],A=E[15],k[12]=y*e+T*t+w*d+A*M,k[13]=y*p+T*i+w*s+A*v,k[14]=y*g+T*n+w*m+A*_,k[15]=y*a+T*r+w*x+A*l,k}},{}],214:[function(c,ae,ie){ae.exports=b;function b(k,P,E,e,p,g,a){var t=1/(P-E),i=1/(e-p),n=1/(g-a);return k[0]=-2*t,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=-2*i,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=2*n,k[11]=0,k[12]=(P+E)*t,k[13]=(p+e)*i,k[14]=(a+g)*n,k[15]=1,k}},{}],215:[function(c,ae,ie){ae.exports=b;function b(k,P,E,e,p){var g=1/Math.tan(P/2),a=1/(e-p);return k[0]=g/E,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=g,k[6]=0,k[7]=0,k[8]=0,k[9]=0,k[10]=(p+e)*a,k[11]=-1,k[12]=0,k[13]=0,k[14]=2*p*e*a,k[15]=0,k}},{}],216:[function(c,ae,ie){ae.exports=b;function b(k,P,E,e){var p=Math.tan(P.upDegrees*Math.PI/180),g=Math.tan(P.downDegrees*Math.PI/180),a=Math.tan(P.leftDegrees*Math.PI/180),t=Math.tan(P.rightDegrees*Math.PI/180),i=2/(a+t),n=2/(p+g);return k[0]=i,k[1]=0,k[2]=0,k[3]=0,k[4]=0,k[5]=n,k[6]=0,k[7]=0,k[8]=-((a-t)*i*.5),k[9]=(p-g)*n*.5,k[10]=e/(E-e),k[11]=-1,k[12]=0,k[13]=0,k[14]=e*E/(E-e),k[15]=0,k}},{}],217:[function(c,ae,ie){ae.exports=b;function b(k,P,E,e){var p=e[0],g=e[1],a=e[2],t=Math.sqrt(p*p+g*g+a*a),i,n,r,d,s,m,x,M,v,_,l,y,T,w,A,f,u,h,o,S,R,z,O,I;return Math.abs(t)<1e-6?null:(t=1/t,p*=t,g*=t,a*=t,i=Math.sin(E),n=Math.cos(E),r=1-n,d=P[0],s=P[1],m=P[2],x=P[3],M=P[4],v=P[5],_=P[6],l=P[7],y=P[8],T=P[9],w=P[10],A=P[11],f=p*p*r+n,u=g*p*r+a*i,h=a*p*r-g*i,o=p*g*r-a*i,S=g*g*r+n,R=a*g*r+p*i,z=p*a*r+g*i,O=g*a*r-p*i,I=a*a*r+n,k[0]=d*f+M*u+y*h,k[1]=s*f+v*u+T*h,k[2]=m*f+_*u+w*h,k[3]=x*f+l*u+A*h,k[4]=d*o+M*S+y*R,k[5]=s*o+v*S+T*R,k[6]=m*o+_*S+w*R,k[7]=x*o+l*S+A*R,k[8]=d*z+M*O+y*I,k[9]=s*z+v*O+T*I,k[10]=m*z+_*O+w*I,k[11]=x*z+l*O+A*I,P!==k&&(k[12]=P[12],k[13]=P[13],k[14]=P[14],k[15]=P[15]),k)}},{}],218:[function(c,ae,ie){ae.exports=b;function b(k,P,E){var e=Math.sin(E),p=Math.cos(E),g=P[4],a=P[5],t=P[6],i=P[7],n=P[8],r=P[9],d=P[10],s=P[11];return P!==k&&(k[0]=P[0],k[1]=P[1],k[2]=P[2],k[3]=P[3],k[12]=P[12],k[13]=P[13],k[14]=P[14],k[15]=P[15]),k[4]=g*p+n*e,k[5]=a*p+r*e,k[6]=t*p+d*e,k[7]=i*p+s*e,k[8]=n*p-g*e,k[9]=r*p-a*e,k[10]=d*p-t*e,k[11]=s*p-i*e,k}},{}],219:[function(c,ae,ie){ae.exports=b;function b(k,P,E){var e=Math.sin(E),p=Math.cos(E),g=P[0],a=P[1],t=P[2],i=P[3],n=P[8],r=P[9],d=P[10],s=P[11];return P!==k&&(k[4]=P[4],k[5]=P[5],k[6]=P[6],k[7]=P[7],k[12]=P[12],k[13]=P[13],k[14]=P[14],k[15]=P[15]),k[0]=g*p-n*e,k[1]=a*p-r*e,k[2]=t*p-d*e,k[3]=i*p-s*e,k[8]=g*e+n*p,k[9]=a*e+r*p,k[10]=t*e+d*p,k[11]=i*e+s*p,k}},{}],220:[function(c,ae,ie){ae.exports=b;function b(k,P,E){var e=Math.sin(E),p=Math.cos(E),g=P[0],a=P[1],t=P[2],i=P[3],n=P[4],r=P[5],d=P[6],s=P[7];return P!==k&&(k[8]=P[8],k[9]=P[9],k[10]=P[10],k[11]=P[11],k[12]=P[12],k[13]=P[13],k[14]=P[14],k[15]=P[15]),k[0]=g*p+n*e,k[1]=a*p+r*e,k[2]=t*p+d*e,k[3]=i*p+s*e,k[4]=n*p-g*e,k[5]=r*p-a*e,k[6]=d*p-t*e,k[7]=s*p-i*e,k}},{}],221:[function(c,ae,ie){ae.exports=b;function b(k,P,E){var e=E[0],p=E[1],g=E[2];return k[0]=P[0]*e,k[1]=P[1]*e,k[2]=P[2]*e,k[3]=P[3]*e,k[4]=P[4]*p,k[5]=P[5]*p,k[6]=P[6]*p,k[7]=P[7]*p,k[8]=P[8]*g,k[9]=P[9]*g,k[10]=P[10]*g,k[11]=P[11]*g,k[12]=P[12],k[13]=P[13],k[14]=P[14],k[15]=P[15],k}},{}],222:[function(c,ae,ie){ae.exports=b;function b(k){return"mat4("+k[0]+", "+k[1]+", "+k[2]+", "+k[3]+", "+k[4]+", "+k[5]+", "+k[6]+", "+k[7]+", "+k[8]+", "+k[9]+", "+k[10]+", "+k[11]+", "+k[12]+", "+k[13]+", "+k[14]+", "+k[15]+")"}},{}],223:[function(c,ae,ie){ae.exports=b;function b(k,P,E){var e=E[0],p=E[1],g=E[2],a,t,i,n,r,d,s,m,x,M,v,_;return P===k?(k[12]=P[0]*e+P[4]*p+P[8]*g+P[12],k[13]=P[1]*e+P[5]*p+P[9]*g+P[13],k[14]=P[2]*e+P[6]*p+P[10]*g+P[14],k[15]=P[3]*e+P[7]*p+P[11]*g+P[15]):(a=P[0],t=P[1],i=P[2],n=P[3],r=P[4],d=P[5],s=P[6],m=P[7],x=P[8],M=P[9],v=P[10],_=P[11],k[0]=a,k[1]=t,k[2]=i,k[3]=n,k[4]=r,k[5]=d,k[6]=s,k[7]=m,k[8]=x,k[9]=M,k[10]=v,k[11]=_,k[12]=a*e+r*p+x*g+P[12],k[13]=t*e+d*p+M*g+P[13],k[14]=i*e+s*p+v*g+P[14],k[15]=n*e+m*p+_*g+P[15]),k}},{}],224:[function(c,ae,ie){ae.exports=b;function b(k,P){if(k===P){var E=P[1],e=P[2],p=P[3],g=P[6],a=P[7],t=P[11];k[1]=P[4],k[2]=P[8],k[3]=P[12],k[4]=E,k[6]=P[9],k[7]=P[13],k[8]=e,k[9]=g,k[11]=P[14],k[12]=p,k[13]=a,k[14]=t}else k[0]=P[0],k[1]=P[4],k[2]=P[8],k[3]=P[12],k[4]=P[1],k[5]=P[5],k[6]=P[9],k[7]=P[13],k[8]=P[2],k[9]=P[6],k[10]=P[10],k[11]=P[14],k[12]=P[3],k[13]=P[7],k[14]=P[11],k[15]=P[15];return k}},{}],225:[function(c,ae,ie){"use strict";var b=c("css-font"),k=c("pick-by-alias"),P=c("regl"),E=c("gl-util/context"),e=c("es6-weak-map"),p=c("color-normalize"),g=c("font-atlas"),a=c("typedarray-pool"),t=c("parse-rect"),i=c("is-plain-obj"),n=c("parse-unit"),r=c("to-px"),d=c("detect-kerning"),s=c("object-assign"),m=c("font-measure"),x=c("flatten-vertex-data"),M=c("bit-twiddle"),v=M.nextPow2,_=new e,l=!1;if(document.body){var y=document.body.appendChild(document.createElement("div"));y.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(y).fontStretch&&(l=!0),document.body.removeChild(y)}var T=function(f){w(f)?(f={regl:f},this.gl=f.regl._gl):this.gl=E(f),this.shader=_.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=f.regl||P({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),_.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(i(f)?f:{})};T.prototype.createShader=function(){var f=this.regl,u=f({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:f.prop("count"),offset:f.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:f.this("sizeBuffer")},width:{offset:0,stride:8,buffer:f.this("sizeBuffer")},char:f.this("charBuffer"),position:f.this("position")},uniforms:{atlasSize:function(o,S){return[S.atlas.width,S.atlas.height]},atlasDim:function(o,S){return[S.atlas.cols,S.atlas.rows]},atlas:function(o,S){return S.atlas.texture},charStep:function(o,S){return S.atlas.step},em:function(o,S){return S.atlas.em},color:f.prop("color"),opacity:f.prop("opacity"),viewport:f.this("viewportArray"),scale:f.this("scale"),align:f.prop("align"),baseline:f.prop("baseline"),translate:f.this("translate"),positionOffset:f.prop("positionOffset")},primitive:"points",viewport:f.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`}),h={};return{regl:f,draw:u,atlas:h}},T.prototype.update=function(f){var u=this;if(typeof f=="string")f={text:f};else if(!f)return;f=k(f,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0),f.opacity!=null&&(Array.isArray(f.opacity)?this.opacity=f.opacity.map(function(ye){return parseFloat(ye)}):this.opacity=parseFloat(f.opacity)),f.viewport!=null&&(this.viewport=t(f.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),f.kerning!=null&&(this.kerning=f.kerning),f.offset!=null&&(typeof f.offset=="number"&&(f.offset=[f.offset,0]),this.positionOffset=x(f.offset)),f.direction&&(this.direction=f.direction),f.range&&(this.range=f.range,this.scale=[1/(f.range[2]-f.range[0]),1/(f.range[3]-f.range[1])],this.translate=[-f.range[0],-f.range[1]]),f.scale&&(this.scale=f.scale),f.translate&&(this.translate=f.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),!this.font.length&&!f.font&&(f.font=T.baseFontSize+"px sans-serif");var h=!1,o=!1;if(f.font&&(Array.isArray(f.font)?f.font:[f.font]).forEach(function(ye,ke){if(typeof ye=="string")try{ye=b.parse(ye)}catch{ye=b.parse(T.baseFontSize+"px "+ye)}else ye=b.parse(b.stringify(ye));var Oe=b.stringify({size:T.baseFontSize,family:ye.family,stretch:l?ye.stretch:void 0,variant:ye.variant,weight:ye.weight,style:ye.style}),Qe=n(ye.size),Ve=Math.round(Qe[0]*r(Qe[1]));if(Ve!==u.fontSize[ke]&&(o=!0,u.fontSize[ke]=Ve),(!u.font[ke]||Oe!=u.font[ke].baseString)&&(h=!0,u.font[ke]=T.fonts[Oe],!u.font[ke])){var Ue=ye.family.join(", "),Ie=[ye.style];ye.style!=ye.variant&&Ie.push(ye.variant),ye.variant!=ye.weight&&Ie.push(ye.weight),l&&ye.weight!=ye.stretch&&Ie.push(ye.stretch),u.font[ke]={baseString:Oe,family:Ue,weight:ye.weight,stretch:ye.stretch,style:ye.style,variant:ye.variant,width:{},kerning:{},metrics:m(Ue,{origin:"top",fontSize:T.baseFontSize,fontStyle:Ie.join(" ")})},T.fonts[Oe]=u.font[ke]}}),(h||o)&&this.font.forEach(function(ye,ke){var Oe=b.stringify({size:u.fontSize[ke],family:ye.family,stretch:l?ye.stretch:void 0,variant:ye.variant,weight:ye.weight,style:ye.style});if(u.fontAtlas[ke]=u.shader.atlas[Oe],!u.fontAtlas[ke]){var Qe=ye.metrics;u.shader.atlas[Oe]=u.fontAtlas[ke]={fontString:Oe,step:Math.ceil(u.fontSize[ke]*Qe.bottom*.5)*2,em:u.fontSize[ke],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:u.regl.texture()}}f.text==null&&(f.text=u.text)}),typeof f.text=="string"&&f.position&&f.position.length>2){for(var S=Array(f.position.length*.5),R=0;R<S.length;R++)S[R]=f.text;f.text=S}var z;if(f.text!=null||h){if(this.textOffsets=[0],Array.isArray(f.text)){this.count=f.text[0].length,this.counts=[this.count];for(var O=1;O<f.text.length;O++)this.textOffsets[O]=this.textOffsets[O-1]+f.text[O-1].length,this.count+=f.text[O].length,this.counts.push(f.text[O].length);this.text=f.text.join("")}else this.text=f.text,this.count=this.text.length,this.counts=[this.count];z=[],this.font.forEach(function(ye,ke){T.atlasContext.font=ye.baseString;for(var Oe=u.fontAtlas[ke],Qe=0;Qe<u.text.length;Qe++){var Ve=u.text.charAt(Qe);if(Oe.ids[Ve]==null&&(Oe.ids[Ve]=Oe.chars.length,Oe.chars.push(Ve),z.push(Ve)),ye.width[Ve]==null&&(ye.width[Ve]=T.atlasContext.measureText(Ve).width/T.baseFontSize,u.kerning)){var Ue=[];for(var Ie in ye.width)Ue.push(Ie+Ve,Ve+Ie);s(ye.kerning,d(ye.family,{pairs:Ue}))}}})}if(f.position)if(f.position.length>2){for(var I=!f.position[0].length,F=a.mallocFloat(this.count*2),D=0,B=0;D<this.counts.length;D++){var U=this.counts[D];if(I)for(var X=0;X<U;X++)F[B++]=f.position[D*2],F[B++]=f.position[D*2+1];else for(var oe=0;oe<U;oe++)F[B++]=f.position[D][0],F[B++]=f.position[D][1]}this.position.call?this.position({type:"float",data:F}):this.position=this.regl.buffer({type:"float",data:F}),a.freeFloat(F)}else this.position.destroy&&this.position.destroy(),this.position={constant:f.position};if(f.text||h){var se=a.mallocUint8(this.count),q=a.mallocFloat(this.count*2);this.textWidth=[];for(var K=0,G=0;K<this.counts.length;K++){for(var Q=this.counts[K],V=this.font[K]||this.font[0],H=this.fontAtlas[K]||this.fontAtlas[0],ee=0;ee<Q;ee++){var J=this.text.charAt(G),W=this.text.charAt(G-1);if(se[G]=H.ids[J],q[G*2]=V.width[J],ee){var re=q[G*2-2],j=q[G*2],Z=q[G*2-1],ne=Z+re*.5+j*.5;if(this.kerning){var le=V.kerning[W+J];le&&(ne+=le*.001)}q[G*2+1]=ne}else q[G*2+1]=q[G*2]*.5;G++}this.textWidth.push(q.length?q[G*2-2]*.5+q[G*2-1]:0)}f.align||(f.align=this.align),this.charBuffer({data:se,type:"uint8",usage:"stream"}),this.sizeBuffer({data:q,type:"float",usage:"stream"}),a.freeUint8(se),a.freeFloat(q),z.length&&this.font.forEach(function(ye,ke){var Oe=u.fontAtlas[ke],Qe=Oe.step,Ve=Math.floor(T.maxAtlasSize/Qe),Ue=Math.min(Ve,Oe.chars.length),Ie=Math.ceil(Oe.chars.length/Ue),at=v(Ue*Qe),pt=v(Ie*Qe);Oe.width=at,Oe.height=pt,Oe.rows=Ie,Oe.cols=Ue,Oe.em&&Oe.texture({data:g({canvas:T.atlasCanvas,font:Oe.fontString,chars:Oe.chars,shape:[at,pt],step:[Qe,Qe]})})})}if(f.align&&(this.align=f.align,this.alignOffset=this.textWidth.map(function(ye,ke){var Oe=Array.isArray(u.align)?u.align.length>1?u.align[ke]:u.align[0]:u.align;if(typeof Oe=="number")return Oe;switch(Oe){case"right":case"end":return-ye;case"center":case"centre":case"middle":return-ye*.5}return 0})),this.baseline==null&&f.baseline==null&&(f.baseline=0),f.baseline!=null&&(this.baseline=f.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(ye,ke){var Oe=(u.font[ke]||u.font[0]).metrics,Qe=0;return Qe+=Oe.bottom*.5,typeof ye=="number"?Qe+=ye-Oe.baseline:Qe+=-Oe[ye],Qe*=-1,Qe})),f.color!=null)if(f.color||(f.color="transparent"),typeof f.color=="string"||!isNaN(f.color))this.color=p(f.color,"uint8");else{var ge;if(typeof f.color[0]=="number"&&f.color.length>this.counts.length){var pe=f.color.length;ge=a.mallocUint8(pe);for(var xe=(f.color.subarray||f.color.slice).bind(f.color),Ee=0;Ee<pe;Ee+=4)ge.set(p(xe(Ee,Ee+4),"uint8"),Ee)}else{var Te=f.color.length;ge=a.mallocUint8(Te*4);for(var de=0;de<Te;de++)ge.set(p(f.color[de]||0,"uint8"),de*4)}this.color=ge}if(f.position||f.text||f.color||f.baseline||f.align||f.font||f.offset||f.opacity){var be=this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2;if(be){var Le=Math.max(this.position.length*.5||0,this.color.length*.25||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,this.positionOffset.length*.5||0);this.batch=Array(Le);for(var De=0;De<this.batch.length;De++)this.batch[De]={count:this.counts.length>1?this.counts[De]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[De]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(De*4,De*4+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[De]:this.opacity,baseline:this.baselineOffset[De]!=null?this.baselineOffset[De]:this.baselineOffset[0],align:this.align?this.alignOffset[De]!=null?this.alignOffset[De]:this.alignOffset[0]:0,atlas:this.fontAtlas[De]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(De*2,De*2+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]}},T.prototype.destroy=function(){},T.prototype.kerning=!0,T.prototype.position={constant:new Float32Array(2)},T.prototype.translate=null,T.prototype.scale=null,T.prototype.font=null,T.prototype.text="",T.prototype.positionOffset=[0,0],T.prototype.opacity=1,T.prototype.color=new Uint8Array([0,0,0,255]),T.prototype.alignOffset=[0,0],T.maxAtlasSize=1024,T.atlasCanvas=document.createElement("canvas"),T.atlasContext=T.atlasCanvas.getContext("2d",{alpha:!1}),T.baseFontSize=64,T.fonts={};function w(A){return typeof A=="function"&&A._gl&&A.prop&&A.texture&&A.buffer}ae.exports=T},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:283,"to-px":314,"typedarray-pool":327}],226:[function(c,ae,ie){(function(b){(function(){"use strict";var k=c("pick-by-alias");ae.exports=function(t){if(t?typeof t=="string"&&(t={container:t}):t={},E(t)?t={container:t}:e(t)?t={container:t}:p(t)?t={gl:t}:t=k(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),t.pixelRatio||(t.pixelRatio=b.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if(typeof t.container=="string"){var i=document.querySelector(t.container);if(!i)throw Error("Element "+t.container+" is not found");t.container=i}E(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):t.canvas||(t.canvas=g(),t.container.appendChild(t.canvas),P(t))}else if(!t.canvas)if(typeof document<"u")t.container=document.body||document.documentElement,t.canvas=g(),t.container.appendChild(t.canvas),P(t);else throw Error("Not DOM environment. Use headless-gl.");return t.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(n){try{t.gl=t.canvas.getContext(n,t.attrs)}catch{}return t.gl}),t.gl};function P(a){if(a.container)if(a.container==document.body)document.body.style.width||(a.canvas.width=a.width||a.pixelRatio*b.innerWidth),document.body.style.height||(a.canvas.height=a.height||a.pixelRatio*b.innerHeight);else{var t=a.container.getBoundingClientRect();a.canvas.width=a.width||t.right-t.left,a.canvas.height=a.height||t.bottom-t.top}}function E(a){return typeof a.getContext=="function"&&"width"in a&&"height"in a}function e(a){return typeof a.nodeName=="string"&&typeof a.appendChild=="function"&&typeof a.getBoundingClientRect=="function"}function p(a){return typeof a.drawArrays=="function"||typeof a.drawElements=="function"}function g(){var a=document.createElement("canvas");return a.style.position="absolute",a.style.top=0,a.style.left=0,a}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(c,ae,ie){ae.exports=function(b){typeof b=="string"&&(b=[b]);for(var k=[].slice.call(arguments,1),P=[],E=0;E<b.length-1;E++)P.push(b[E],k[E]||"");return P.push(b[E]),P.join("")}},{}],228:[function(c,ae,ie){(function(b){(function(){"use strict";var k=c("is-browser"),P;typeof b.matchMedia=="function"?P=!b.matchMedia("(hover: none)").matches:P=k,ae.exports=P}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(c,ae,ie){"use strict";var b=c("is-browser");function k(){var P=!1;try{var E=Object.defineProperty({},"passive",{get:function(){P=!0}});window.addEventListener("test",null,E),window.removeEventListener("test",null,E)}catch{P=!1}return P}ae.exports=b&&k()},{"is-browser":232}],230:[function(c,ae,ie){ie.read=function(b,k,P,E,e){var p,g,a=e*8-E-1,t=(1<<a)-1,i=t>>1,n=-7,r=P?e-1:0,d=P?-1:1,s=b[k+r];for(r+=d,p=s&(1<<-n)-1,s>>=-n,n+=a;n>0;p=p*256+b[k+r],r+=d,n-=8);for(g=p&(1<<-n)-1,p>>=-n,n+=E;n>0;g=g*256+b[k+r],r+=d,n-=8);if(p===0)p=1-i;else{if(p===t)return g?NaN:(s?-1:1)*(1/0);g=g+Math.pow(2,E),p=p-i}return(s?-1:1)*g*Math.pow(2,p-E)},ie.write=function(b,k,P,E,e,p){var g,a,t,i=p*8-e-1,n=(1<<i)-1,r=n>>1,d=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,s=E?0:p-1,m=E?1:-1,x=k<0||k===0&&1/k<0?1:0;for(k=Math.abs(k),isNaN(k)||k===1/0?(a=isNaN(k)?1:0,g=n):(g=Math.floor(Math.log(k)/Math.LN2),k*(t=Math.pow(2,-g))<1&&(g--,t*=2),g+r>=1?k+=d/t:k+=d*Math.pow(2,1-r),k*t>=2&&(g++,t/=2),g+r>=n?(a=0,g=n):g+r>=1?(a=(k*t-1)*Math.pow(2,e),g=g+r):(a=k*Math.pow(2,r-1)*Math.pow(2,e),g=0));e>=8;b[P+s]=a&255,s+=m,a/=256,e-=8);for(g=g<<e|a,i+=e;i>0;b[P+s]=g&255,s+=m,g/=256,i-=8);b[P+s-m]|=x*128}},{}],231:[function(c,ae,ie){typeof Object.create=="function"?ae.exports=function(k,P){P&&(k.super_=P,k.prototype=Object.create(P.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}))}:ae.exports=function(k,P){if(P){k.super_=P;var E=function(){};E.prototype=P.prototype,k.prototype=new E,k.prototype.constructor=k}}},{}],232:[function(c,ae,ie){ae.exports=!0},{}],233:[function(c,ae,ie){"use strict";ae.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(c,ae,ie){"use strict";ae.exports=P,ae.exports.isMobile=P,ae.exports.default=P;var b=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,k=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function P(E){E||(E={});var e=E.ua;if(!e&&typeof navigator<"u"&&(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var p=E.tablet?k.test(e):b.test(e);return!p&&E.tablet&&E.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(p=!0),p}},{}],235:[function(c,ae,ie){"use strict";ae.exports=function(b){var k=typeof b;return b!==null&&(k==="object"||k==="function")}},{}],236:[function(c,ae,ie){"use strict";var b=Object.prototype.toString;ae.exports=function(k){var P;return b.call(k)==="[object Object]"&&(P=Object.getPrototypeOf(k),P===null||P===Object.getPrototypeOf({}))}},{}],237:[function(c,ae,ie){"use strict";ae.exports=function(b){for(var k=b.length,P,E=0;E<k;E++)if(P=b.charCodeAt(E),(P<9||P>13)&&P!==32&&P!==133&&P!==160&&P!==5760&&P!==6158&&(P<8192||P>8205)&&P!==8232&&P!==8233&&P!==8239&&P!==8287&&P!==8288&&P!==12288&&P!==65279)return!1;return!0}},{}],238:[function(c,ae,ie){"use strict";ae.exports=function(k){return typeof k!="string"?!1:(k=k.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(k)&&/[\dz]$/i.test(k)&&k.length>4))}},{}],239:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?ae.exports=k():typeof Vr=="function"&&Vr.amd?Vr(k):(b=b||self,b.mapboxgl=k())})(this,function(){"use strict";var b,k,P;function E(e,p){if(!b)b=p;else if(!k)k=p;else{var g="var sharedChunk = {}; ("+b+")(sharedChunk); ("+k+")(sharedChunk);",a={};b(a),P=p(a),P.workerUrl=window.URL.createObjectURL(new Blob([g],{type:"text/javascript"}))}}return E(["exports"],function(e){"use strict";function p(C,L){return L={exports:{}},C(L,L.exports),L.exports}var g="1.10.1",a=t;function t(C,L,N,te){this.cx=3*C,this.bx=3*(N-C)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*L,this.by=3*(te-L)-this.cy,this.ay=1-this.cy-this.by,this.p1x=C,this.p1y=te,this.p2x=N,this.p2y=te}t.prototype.sampleCurveX=function(C){return((this.ax*C+this.bx)*C+this.cx)*C},t.prototype.sampleCurveY=function(C){return((this.ay*C+this.by)*C+this.cy)*C},t.prototype.sampleCurveDerivativeX=function(C){return(3*this.ax*C+2*this.bx)*C+this.cx},t.prototype.solveCurveX=function(C,L){typeof L>"u"&&(L=1e-6);var N,te,ce,me,Ae;for(ce=C,Ae=0;Ae<8;Ae++){if(me=this.sampleCurveX(ce)-C,Math.abs(me)<L)return ce;var Fe=this.sampleCurveDerivativeX(ce);if(Math.abs(Fe)<1e-6)break;ce=ce-me/Fe}if(N=0,te=1,ce=C,ce<N)return N;if(ce>te)return te;for(;N<te;){if(me=this.sampleCurveX(ce),Math.abs(me-C)<L)return ce;C>me?N=ce:te=ce,ce=(te-N)*.5+N}return ce},t.prototype.solve=function(C,L){return this.sampleCurveY(this.solveCurveX(C,L))};var i=n;function n(C,L){this.x=C,this.y=L}n.prototype={clone:function(){return new n(this.x,this.y)},add:function(C){return this.clone()._add(C)},sub:function(C){return this.clone()._sub(C)},multByPoint:function(C){return this.clone()._multByPoint(C)},divByPoint:function(C){return this.clone()._divByPoint(C)},mult:function(C){return this.clone()._mult(C)},div:function(C){return this.clone()._div(C)},rotate:function(C){return this.clone()._rotate(C)},rotateAround:function(C,L){return this.clone()._rotateAround(C,L)},matMult:function(C){return this.clone()._matMult(C)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(C){return this.x===C.x&&this.y===C.y},dist:function(C){return Math.sqrt(this.distSqr(C))},distSqr:function(C){var L=C.x-this.x,N=C.y-this.y;return L*L+N*N},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(C){return Math.atan2(this.y-C.y,this.x-C.x)},angleWith:function(C){return this.angleWithSep(C.x,C.y)},angleWithSep:function(C,L){return Math.atan2(this.x*L-this.y*C,this.x*C+this.y*L)},_matMult:function(C){var L=C[0]*this.x+C[1]*this.y,N=C[2]*this.x+C[3]*this.y;return this.x=L,this.y=N,this},_add:function(C){return this.x+=C.x,this.y+=C.y,this},_sub:function(C){return this.x-=C.x,this.y-=C.y,this},_mult:function(C){return this.x*=C,this.y*=C,this},_div:function(C){return this.x/=C,this.y/=C,this},_multByPoint:function(C){return this.x*=C.x,this.y*=C.y,this},_divByPoint:function(C){return this.x/=C.x,this.y/=C.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var C=this.y;return this.y=this.x,this.x=-C,this},_rotate:function(C){var L=Math.cos(C),N=Math.sin(C),te=L*this.x-N*this.y,ce=N*this.x+L*this.y;return this.x=te,this.y=ce,this},_rotateAround:function(C,L){var N=Math.cos(C),te=Math.sin(C),ce=L.x+N*(this.x-L.x)-te*(this.y-L.y),me=L.y+te*(this.x-L.x)+N*(this.y-L.y);return this.x=ce,this.y=me,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},n.convert=function(C){return C instanceof n?C:Array.isArray(C)?new n(C[0],C[1]):C};function r(C,L){if(Array.isArray(C)){if(!Array.isArray(L)||C.length!==L.length)return!1;for(var N=0;N<C.length;N++)if(!r(C[N],L[N]))return!1;return!0}if(typeof C=="object"&&C!==null&&L!==null){if(typeof L!="object")return!1;var te=Object.keys(C);if(te.length!==Object.keys(L).length)return!1;for(var ce in C)if(!r(C[ce],L[ce]))return!1;return!0}return C===L}function d(C){if(C<=0)return 0;if(C>=1)return 1;var L=C*C,N=L*C;return 4*(C<.5?N:3*(C-L)+N-.75)}function s(C,L,N,te){var ce=new a(C,L,N,te);return function(me){return ce.solve(me)}}var m=s(.25,.1,.25,1);function x(C,L,N){return Math.min(N,Math.max(L,C))}function M(C,L,N){var te=N-L,ce=((C-L)%te+te)%te+L;return ce===L?N:ce}function v(C,L,N){if(!C.length)return N(null,[]);var te=C.length,ce=new Array(C.length),me=null;C.forEach(function(Ae,Fe){L(Ae,function($e,ft){$e&&(me=$e),ce[Fe]=ft,--te===0&&N(me,ce)})})}function _(C){var L=[];for(var N in C)L.push(C[N]);return L}function l(C,L){var N=[];for(var te in C)te in L||N.push(te);return N}function y(C){for(var L=[],N=arguments.length-1;N-- >0;)L[N]=arguments[N+1];for(var te=0,ce=L;te<ce.length;te+=1){var me=ce[te];for(var Ae in me)C[Ae]=me[Ae]}return C}function T(C,L){for(var N={},te=0;te<L.length;te++){var ce=L[te];ce in C&&(N[ce]=C[ce])}return N}var w=1;function A(){return w++}function f(){function C(L){return L?(L^Math.random()*16>>L/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,C)}return C()}function u(C){return C?/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(C):!1}function h(C,L){C.forEach(function(N){!L[N]||(L[N]=L[N].bind(L))})}function o(C,L){return C.indexOf(L,C.length-L.length)!==-1}function S(C,L,N){var te={};for(var ce in C)te[ce]=L.call(N||this,C[ce],ce,C);return te}function R(C,L,N){var te={};for(var ce in C)L.call(N||this,C[ce],ce,C)&&(te[ce]=C[ce]);return te}function z(C){return Array.isArray(C)?C.map(z):typeof C=="object"&&C?S(C,z):C}function O(C,L){for(var N=0;N<C.length;N++)if(L.indexOf(C[N])>=0)return!0;return!1}var I={};function F(C){I[C]||(typeof console<"u"&&console.warn(C),I[C]=!0)}function D(C,L,N){return(N.y-C.y)*(L.x-C.x)>(L.y-C.y)*(N.x-C.x)}function B(C){for(var L=0,N=0,te=C.length,ce=te-1,me=void 0,Ae=void 0;N<te;ce=N++)me=C[N],Ae=C[ce],L+=(Ae.x-me.x)*(me.y+Ae.y);return L}function U(C){var L=C[0],N=C[1],te=C[2];return N+=90,N*=Math.PI/180,te*=Math.PI/180,{x:L*Math.cos(N)*Math.sin(te),y:L*Math.sin(N)*Math.sin(te),z:L*Math.cos(te)}}function X(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function oe(C){var L=/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,N={};if(C.replace(L,function(ce,me,Ae,Fe){var $e=Ae||Fe;return N[me]=$e?$e.toLowerCase():!0,""}),N["max-age"]){var te=parseInt(N["max-age"],10);isNaN(te)?delete N["max-age"]:N["max-age"]=te}return N}var se=null;function q(C){if(se==null){var L=C.navigator?C.navigator.userAgent:null;se=!!C.safari||!!(L&&(/\b(iPad|iPhone|iPod)\b/.test(L)||!!L.match("Safari")&&!L.match("Chrome")))}return se}function K(C){try{var L=self[C];return L.setItem("_mapbox_test_",1),L.removeItem("_mapbox_test_"),!0}catch{return!1}}function G(C){return self.btoa(encodeURIComponent(C).replace(/%([0-9A-F]{2})/g,function(L,N){return String.fromCharCode(Number("0x"+N))}))}function Q(C){return decodeURIComponent(self.atob(C).split("").map(function(L){return"%"+("00"+L.charCodeAt(0).toString(16)).slice(-2)}).join(""))}var V=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),H=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,ee=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,J,W,re={now:V,frame:function(L){var N=H(L);return{cancel:function(){return ee(N)}}},getImageData:function(L,N){N===void 0&&(N=0);var te=self.document.createElement("canvas"),ce=te.getContext("2d");if(!ce)throw new Error("failed to create canvas 2d context");return te.width=L.width,te.height=L.height,ce.drawImage(L,0,0,L.width,L.height),ce.getImageData(-N,-N,L.width+2*N,L.height+2*N)},resolveURL:function(L){return J||(J=self.document.createElement("a")),J.href=L,J.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return self.matchMedia?(W==null&&(W=self.matchMedia("(prefers-reduced-motion: reduce)")),W.matches):!1}},j={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Z={supported:!1,testSupport:xe},ne,le=!1,ge,pe=!1;self.document&&(ge=self.document.createElement("img"),ge.onload=function(){ne&&Ee(ne),ne=null,pe=!0},ge.onerror=function(){le=!0,ne=null},ge.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");function xe(C){le||!ge||(pe?Ee(C):ne=C)}function Ee(C){var L=C.createTexture();C.bindTexture(C.TEXTURE_2D,L);try{if(C.texImage2D(C.TEXTURE_2D,0,C.RGBA,C.RGBA,C.UNSIGNED_BYTE,ge),C.isContextLost())return;Z.supported=!0}catch{}C.deleteTexture(L),le=!0}var Te="01";function de(){for(var C="1",L="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",N="",te=0;te<10;te++)N+=L[Math.floor(Math.random()*62)];var ce=12*60*60*1e3,me=[C,Te,N].join(""),Ae=Date.now()+ce;return{token:me,tokenExpiresAt:Ae}}var be=function(L,N){this._transformRequestFn=L,this._customAccessToken=N,this._createSkuToken()};be.prototype._createSkuToken=function(){var L=de();this._skuToken=L.token,this._skuTokenExpiresAt=L.tokenExpiresAt},be.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},be.prototype.transformRequest=function(L,N){return this._transformRequestFn?this._transformRequestFn(L,N)||{url:L}:{url:L}},be.prototype.normalizeStyleURL=function(L,N){if(!Le(L))return L;var te=Ve(L);return te.path="/styles/v1"+te.path,this._makeAPIURL(te,this._customAccessToken||N)},be.prototype.normalizeGlyphsURL=function(L,N){if(!Le(L))return L;var te=Ve(L);return te.path="/fonts/v1"+te.path,this._makeAPIURL(te,this._customAccessToken||N)},be.prototype.normalizeSourceURL=function(L,N){if(!Le(L))return L;var te=Ve(L);return te.path="/v4/"+te.authority+".json",te.params.push("secure"),this._makeAPIURL(te,this._customAccessToken||N)},be.prototype.normalizeSpriteURL=function(L,N,te,ce){var me=Ve(L);return Le(L)?(me.path="/styles/v1"+me.path+"/sprite"+N+te,this._makeAPIURL(me,this._customAccessToken||ce)):(me.path+=""+N+te,Ue(me))},be.prototype.normalizeTileURL=function(L,N){if(this._isSkuTokenExpired()&&this._createSkuToken(),L&&!Le(L))return L;var te=Ve(L),ce=/(\.(png|jpg)\d*)(?=$)/,me=/^.+\/v4\//,Ae=re.devicePixelRatio>=2||N===512?"@2x":"",Fe=Z.supported?".webp":"$1";te.path=te.path.replace(ce,""+Ae+Fe),te.path=te.path.replace(me,"/"),te.path="/v4"+te.path;var $e=this._customAccessToken||Oe(te.params)||j.ACCESS_TOKEN;return j.REQUIRE_ACCESS_TOKEN&&$e&&this._skuToken&&te.params.push("sku="+this._skuToken),this._makeAPIURL(te,$e)},be.prototype.canonicalizeTileURL=function(L,N){var te="/v4/",ce=/\.[\w]+$/,me=Ve(L);if(!me.path.match(/(^\/v4\/)/)||!me.path.match(ce))return L;var Ae="mapbox://tiles/";Ae+=me.path.replace(te,"");var Fe=me.params;return N&&(Fe=Fe.filter(function($e){return!$e.match(/^access_token=/)})),Fe.length&&(Ae+="?"+Fe.join("&")),Ae},be.prototype.canonicalizeTileset=function(L,N){for(var te=N?Le(N):!1,ce=[],me=0,Ae=L.tiles||[];me<Ae.length;me+=1){var Fe=Ae[me];ye(Fe)?ce.push(this.canonicalizeTileURL(Fe,te)):ce.push(Fe)}return ce},be.prototype._makeAPIURL=function(L,N){var te="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",ce=Ve(j.API_URL);if(L.protocol=ce.protocol,L.authority=ce.authority,ce.path!=="/"&&(L.path=""+ce.path+L.path),!j.REQUIRE_ACCESS_TOKEN)return Ue(L);if(N=N||j.ACCESS_TOKEN,!N)throw new Error("An API access token is required to use Mapbox GL. "+te);if(N[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+te);return L.params=L.params.filter(function(me){return me.indexOf("access_token")===-1}),L.params.push("access_token="+N),Ue(L)};function Le(C){return C.indexOf("mapbox:")===0}var De=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function ye(C){return De.test(C)}function ke(C){return C.indexOf("sku=")>0&&ye(C)}function Oe(C){for(var L=0,N=C;L<N.length;L+=1){var te=N[L],ce=te.match(/^access_token=(.*)$/);if(ce)return ce[1]}return null}var Qe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ve(C){var L=C.match(Qe);if(!L)throw new Error("Unable to parse URL object");return{protocol:L[1],authority:L[2],path:L[3]||"/",params:L[4]?L[4].split("&"):[]}}function Ue(C){var L=C.params.length?"?"+C.params.join("&"):"";return C.protocol+"://"+C.authority+C.path+L}var Ie="mapbox.eventData";function at(C){if(!C)return null;var L=C.split(".");if(!L||L.length!==3)return null;try{var N=JSON.parse(Q(L[1]));return N}catch{return null}}var pt=function(L){this.type=L,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};pt.prototype.getStorageKey=function(L){var N=at(j.ACCESS_TOKEN),te="";return N&&N.u?te=G(N.u):te=j.ACCESS_TOKEN||"",L?Ie+"."+L+":"+te:Ie+":"+te},pt.prototype.fetchEventData=function(){var L=K("localStorage"),N=this.getStorageKey(),te=this.getStorageKey("uuid");if(L)try{var ce=self.localStorage.getItem(N);ce&&(this.eventData=JSON.parse(ce));var me=self.localStorage.getItem(te);me&&(this.anonId=me)}catch{F("Unable to read from LocalStorage")}},pt.prototype.saveEventData=function(){var L=K("localStorage"),N=this.getStorageKey(),te=this.getStorageKey("uuid");if(L)try{self.localStorage.setItem(te,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(N,JSON.stringify(this.eventData))}catch{F("Unable to write to LocalStorage")}},pt.prototype.processRequests=function(L){},pt.prototype.postEvent=function(L,N,te,ce){var me=this;if(!!j.EVENTS_URL){var Ae=Ve(j.EVENTS_URL);Ae.params.push("access_token="+(ce||j.ACCESS_TOKEN||""));var Fe={event:this.type,created:new Date(L).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:g,skuId:Te,userId:this.anonId},$e=N?y(Fe,N):Fe,ft={url:Ue(Ae),headers:{"Content-Type":"text/plain"},body:JSON.stringify([$e])};this.pendingRequest=Xe(ft,function(dt){me.pendingRequest=null,te(dt),me.saveEventData(),me.processRequests(ce)})}},pt.prototype.queueRequest=function(L,N){this.queue.push(L),this.processRequests(N)};var Rt=function(C){function L(){C.call(this,"map.load"),this.success={},this.skuToken=""}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.postMapLoadEvent=function(te,ce,me,Ae){this.skuToken=me,(j.EVENTS_URL&&Ae||j.ACCESS_TOKEN&&Array.isArray(te)&&te.some(function(Fe){return Le(Fe)||ye(Fe)}))&&this.queueRequest({id:ce,timestamp:Date.now()},Ae)},L.prototype.processRequests=function(te){var ce=this;if(!(this.pendingRequest||this.queue.length===0)){var me=this.queue.shift(),Ae=me.id,Fe=me.timestamp;Ae&&this.success[Ae]||(this.anonId||this.fetchEventData(),u(this.anonId)||(this.anonId=f()),this.postEvent(Fe,{skuToken:this.skuToken},function($e){$e||Ae&&(ce.success[Ae]=!0)},te))}},L}(pt),Mt=function(C){function L(N){C.call(this,"appUserTurnstile"),this._customAccessToken=N}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.postTurnstileEvent=function(te,ce){j.EVENTS_URL&&j.ACCESS_TOKEN&&Array.isArray(te)&&te.some(function(me){return Le(me)||ye(me)})&&this.queueRequest(Date.now(),ce)},L.prototype.processRequests=function(te){var ce=this;if(!(this.pendingRequest||this.queue.length===0)){(!this.anonId||!this.eventData.lastSuccess||!this.eventData.tokenU)&&this.fetchEventData();var me=at(j.ACCESS_TOKEN),Ae=me?me.u:j.ACCESS_TOKEN,Fe=Ae!==this.eventData.tokenU;u(this.anonId)||(this.anonId=f(),Fe=!0);var $e=this.queue.shift();if(this.eventData.lastSuccess){var ft=new Date(this.eventData.lastSuccess),dt=new Date($e),Pt=($e-this.eventData.lastSuccess)/(24*60*60*1e3);Fe=Fe||Pt>=1||Pt<-1||ft.getDate()!==dt.getDate()}else Fe=!0;if(!Fe)return this.processRequests();this.postEvent($e,{"enabled.telemetry":!1},function(Jt){Jt||(ce.eventData.lastSuccess=$e,ce.eventData.tokenU=Ae)},te)}},L}(pt),It=new Mt,Bt=It.postTurnstileEvent.bind(It),St=new Rt,_t=St.postMapLoadEvent.bind(St),it="mapbox-tiles",ct=500,et=50,Pe=1e3*60*7,We;function je(){self.caches&&!We&&(We=self.caches.open(it))}var nt;function kt(C,L){if(nt===void 0)try{new Response(new ReadableStream),nt=!0}catch{nt=!1}nt?L(C.body):C.blob().then(L)}function wt(C,L,N){if(je(),!!We){var te={status:L.status,statusText:L.statusText,headers:new self.Headers};L.headers.forEach(function(Ae,Fe){return te.headers.set(Fe,Ae)});var ce=oe(L.headers.get("Cache-Control")||"");if(!ce["no-store"]){ce["max-age"]&&te.headers.set("Expires",new Date(N+ce["max-age"]*1e3).toUTCString());var me=new Date(te.headers.get("Expires")).getTime()-N;me<Pe||kt(L,function(Ae){var Fe=new self.Response(Ae,te);je(),We&&We.then(function($e){return $e.put(Vt(C.url),Fe)}).catch(function($e){return F($e.message)})})}}}function Vt(C){var L=C.indexOf("?");return L<0?C:C.slice(0,L)}function qt(C,L){if(je(),!We)return L(null);var N=Vt(C.url);We.then(function(te){te.match(N).then(function(ce){var me=zt(ce);te.delete(N),me&&te.put(N,ce.clone()),L(null,ce,me)}).catch(L)}).catch(L)}function zt(C){if(!C)return!1;var L=new Date(C.headers.get("Expires")||0),N=oe(C.headers.get("Cache-Control")||"");return L>Date.now()&&!N["no-cache"]}var Ht=1/0;function $t(C){Ht++,Ht>et&&(C.getActor().send("enforceCacheSizeLimit",ct),Ht=0)}function Qt(C){je(),We&&We.then(function(L){L.keys().then(function(N){for(var te=0;te<N.length-C;te++)L.delete(N[te])})})}function fr(C){var L=self.caches.delete(it);C&&L.catch(C).then(function(){return C()})}function jr(C,L){ct=C,et=L}var cn;function Qr(){return cn==null&&(cn=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),cn}var lt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(lt);var Gt=function(C){function L(N,te,ce){te===401&&ye(ce)&&(N+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),C.call(this,N),this.status=te,this.url=ce,this.name=this.constructor.name,this.message=N}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},L}(Error),Kt=X()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href},Nt=function(C){return/^file:/.test(C)||/^file:/.test(Kt())&&!/^\w+:/.test(C)};function gr(C,L){var N=new self.AbortController,te=new self.Request(C.url,{method:C.method||"GET",body:C.body,credentials:C.credentials,headers:C.headers,referrer:Kt(),signal:N.signal}),ce=!1,me=!1,Ae=ke(te.url);C.type==="json"&&te.headers.set("Accept","application/json");var Fe=function(ft,dt,Pt){if(!me){if(ft&&ft.message!=="SecurityError"&&F(ft),dt&&Pt)return $e(dt);var Jt=Date.now();self.fetch(te).then(function(Yt){if(Yt.ok){var ur=Ae?Yt.clone():null;return $e(Yt,ur,Jt)}else return L(new Gt(Yt.statusText,Yt.status,C.url))}).catch(function(Yt){Yt.code!==20&&L(new Error(Yt.message))})}},$e=function(ft,dt,Pt){(C.type==="arrayBuffer"?ft.arrayBuffer():C.type==="json"?ft.json():ft.text()).then(function(Jt){me||(dt&&Pt&&wt(te,dt,Pt),ce=!0,L(null,Jt,ft.headers.get("Cache-Control"),ft.headers.get("Expires")))}).catch(function(Jt){me||L(new Error(Jt.message))})};return Ae?qt(te,Fe):Fe(null,null),{cancel:function(){me=!0,ce||N.abort()}}}function tt(C,L){var N=new self.XMLHttpRequest;N.open(C.method||"GET",C.url,!0),C.type==="arrayBuffer"&&(N.responseType="arraybuffer");for(var te in C.headers)N.setRequestHeader(te,C.headers[te]);return C.type==="json"&&(N.responseType="text",N.setRequestHeader("Accept","application/json")),N.withCredentials=C.credentials==="include",N.onerror=function(){L(new Error(N.statusText))},N.onload=function(){if((N.status>=200&&N.status<300||N.status===0)&&N.response!==null){var ce=N.response;if(C.type==="json")try{ce=JSON.parse(N.response)}catch(me){return L(me)}L(null,ce,N.getResponseHeader("Cache-Control"),N.getResponseHeader("Expires"))}else L(new Gt(N.statusText,N.status,C.url))},N.send(C.body),{cancel:function(){return N.abort()}}}var we=function(C,L){if(!Nt(C.url)){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return gr(C,L);if(X()&&self.worker&&self.worker.actor){var N=!0;return self.worker.actor.send("getResource",C,L,void 0,N)}}return tt(C,L)},Me=function(C,L){return we(y(C,{type:"json"}),L)},Ne=function(C,L){return we(y(C,{type:"arrayBuffer"}),L)},Xe=function(C,L){return we(y(C,{method:"POST"}),L)};function Ke(C){var L=self.document.createElement("a");return L.href=C,L.protocol===self.document.location.protocol&&L.host===self.document.location.host}var rt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Je(C,L,N,te){var ce=new self.Image,me=self.URL;ce.onload=function(){L(null,ce),me.revokeObjectURL(ce.src)},ce.onerror=function(){return L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Ae=new self.Blob([new Uint8Array(C)],{type:"image/png"});ce.cacheControl=N,ce.expires=te,ce.src=C.byteLength?me.createObjectURL(Ae):rt}function vt(C,L){var N=new self.Blob([new Uint8Array(C)],{type:"image/png"});self.createImageBitmap(N).then(function(te){L(null,te)}).catch(function(te){L(new Error("Could not load image because of "+te.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}var bt,Et,Wt=function(){bt=[],Et=0};Wt();var Ot=function(C,L){if(Z.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*"),Et>=j.MAX_PARALLEL_IMAGE_REQUESTS){var N={requestParameters:C,callback:L,cancelled:!1,cancel:function(){this.cancelled=!0}};return bt.push(N),N}Et++;var te=!1,ce=function(){if(!te)for(te=!0,Et--;bt.length&&Et<j.MAX_PARALLEL_IMAGE_REQUESTS;){var Ae=bt.shift(),Fe=Ae.requestParameters,$e=Ae.callback,ft=Ae.cancelled;ft||(Ae.cancel=Ot(Fe,$e).cancel)}},me=Ne(C,function(Ae,Fe,$e,ft){ce(),Ae?L(Ae):Fe&&(Qr()?vt(Fe,L):Je(Fe,L,$e,ft))});return{cancel:function(){me.cancel(),ce()}}},ir=function(C,L){var N=self.document.createElement("video");N.muted=!0,N.onloadstart=function(){L(null,N)};for(var te=0;te<C.length;te++){var ce=self.document.createElement("source");Ke(C[te])||(N.crossOrigin="Anonymous"),ce.src=C[te],N.appendChild(ce)}return{cancel:function(){}}};function vr(C,L,N){var te=N[C]&&N[C].indexOf(L)!==-1;te||(N[C]=N[C]||[],N[C].push(L))}function _r(C,L,N){if(N&&N[C]){var te=N[C].indexOf(L);te!==-1&&N[C].splice(te,1)}}var ln=function(L,N){N===void 0&&(N={}),y(this,N),this.type=L},Cr=function(C){function L(N,te){te===void 0&&(te={}),C.call(this,"error",y({error:N},te))}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L}(ln),Gr=function(){};Gr.prototype.on=function(L,N){return this._listeners=this._listeners||{},vr(L,N,this._listeners),this},Gr.prototype.off=function(L,N){return _r(L,N,this._listeners),_r(L,N,this._oneTimeListeners),this},Gr.prototype.once=function(L,N){return this._oneTimeListeners=this._oneTimeListeners||{},vr(L,N,this._oneTimeListeners),this},Gr.prototype.fire=function(L,N){typeof L=="string"&&(L=new ln(L,N||{}));var te=L.type;if(this.listens(te)){L.target=this;for(var ce=this._listeners&&this._listeners[te]?this._listeners[te].slice():[],me=0,Ae=ce;me<Ae.length;me+=1){var Fe=Ae[me];Fe.call(this,L)}for(var $e=this._oneTimeListeners&&this._oneTimeListeners[te]?this._oneTimeListeners[te].slice():[],ft=0,dt=$e;ft<dt.length;ft+=1){var Pt=dt[ft];_r(te,Pt,this._oneTimeListeners),Pt.call(this,L)}var Jt=this._eventedParent;Jt&&(y(L,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),Jt.fire(L))}else L instanceof Cr&&console.error(L.error);return this},Gr.prototype.listens=function(L){return this._listeners&&this._listeners[L]&&this._listeners[L].length>0||this._oneTimeListeners&&this._oneTimeListeners[L]&&this._oneTimeListeners[L].length>0||this._eventedParent&&this._eventedParent.listens(L)},Gr.prototype.setEventedParent=function(L,N){return this._eventedParent=L,this._eventedParentData=N,this};var sn=8,yr={version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},mr={"*":{type:"source"}},Or=["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],zr={type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},Sr={type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},ot={type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},Lt={type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},Xt={type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},tr={type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},Lr={id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},Nr=["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],Rr={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Ar={"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Kr={"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Dn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Sn={"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Jn={"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Bn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},Xn={visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},ea={type:"array",value:"*"},ka={type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},Ya={type:"enum",values:{Point:{},LineString:{},Polygon:{}}},fi={type:"array",minimum:0,maximum:24,value:["number","color"],length:2},pi={type:"array",value:"*",minimum:1},hi={type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},Ka={anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},wr=["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],gn={"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},hn={"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},Tn={"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},Vn={"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},oa={"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},na={"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},On={"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},ta={"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},Ua={duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},di={"*":{type:"string"}},Ft={$version:sn,$root:yr,sources:mr,source:Or,source_vector:zr,source_raster:Sr,source_raster_dem:ot,source_geojson:Lt,source_video:Xt,source_image:tr,layer:Lr,layout:Nr,layout_background:Rr,layout_fill:Ar,layout_circle:Kr,layout_heatmap:Dn,"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:Sn,layout_symbol:Jn,layout_raster:Bn,layout_hillshade:Xn,filter:ea,filter_operator:ka,geometry_type:Ya,function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:fi,expression:pi,expression_name:hi,light:Ka,paint:wr,paint_fill:gn,"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:hn,paint_circle:Tn,paint_heatmap:Vn,paint_symbol:oa,paint_raster:na,paint_hillshade:On,paint_background:ta,transition:Ua,"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:di},cr=function(L,N,te,ce){this.message=(L?L+": ":"")+te,ce&&(this.identifier=ce),N!=null&&N.__line__&&(this.line=N.__line__)};function nn(C){var L=C.key,N=C.value;return N?[new cr(L,N,"constants have been deprecated as of v8")]:[]}function vn(C){for(var L=[],N=arguments.length-1;N-- >0;)L[N]=arguments[N+1];for(var te=0,ce=L;te<ce.length;te+=1){var me=ce[te];for(var Ae in me)C[Ae]=me[Ae]}return C}function on(C){return C instanceof Number||C instanceof String||C instanceof Boolean?C.valueOf():C}function Cn(C){if(Array.isArray(C))return C.map(Cn);if(C instanceof Object&&!(C instanceof Number||C instanceof String||C instanceof Boolean)){var L={};for(var N in C)L[N]=Cn(C[N]);return L}return on(C)}var _n=function(C){function L(N,te){C.call(this,te),this.message=te,this.key=N}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L}(Error),un=function(L,N){N===void 0&&(N=[]),this.parent=L,this.bindings={};for(var te=0,ce=N;te<ce.length;te+=1){var me=ce[te],Ae=me[0],Fe=me[1];this.bindings[Ae]=Fe}};un.prototype.concat=function(L){return new un(this,L)},un.prototype.get=function(L){if(this.bindings[L])return this.bindings[L];if(this.parent)return this.parent.get(L);throw new Error(L+" not found in scope.")},un.prototype.has=function(L){return this.bindings[L]?!0:this.parent?this.parent.has(L):!1};var dr={kind:"null"},pr={kind:"number"},Pr={kind:"string"},dn={kind:"boolean"},Un={kind:"color"},ra={kind:"object"},bn={kind:"value"},Zn={kind:"error"},sa={kind:"collator"},ga={kind:"formatted"},wa={kind:"resolvedImage"};function ua(C,L){return{kind:"array",itemType:C,N:L}}function Aa(C){if(C.kind==="array"){var L=Aa(C.itemType);return typeof C.N=="number"?"array<"+L+", "+C.N+">":C.itemType.kind==="value"?"array":"array<"+L+">"}else return C.kind}var _o=[dr,pr,Pr,dn,Un,ga,ra,ua(bn),wa];function So(C,L){if(L.kind==="error")return null;if(C.kind==="array"){if(L.kind==="array"&&(L.N===0&&L.itemType.kind==="value"||!So(C.itemType,L.itemType))&&(typeof C.N!="number"||C.N===L.N))return null}else{if(C.kind===L.kind)return null;if(C.kind==="value")for(var N=0,te=_o;N<te.length;N+=1){var ce=te[N];if(!So(ce,L))return null}}return"Expected "+Aa(C)+" but found "+Aa(L)+" instead."}function Fo(C,L){return L.some(function(N){return N.kind===C.kind})}function cs(C,L){return L.some(function(N){return N==="null"?C===null:N==="array"?Array.isArray(C):N==="object"?C&&!Array.isArray(C)&&typeof C=="object":N===typeof C})}var Jl=p(function(C,L){var N={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function te(ft){return ft=Math.round(ft),ft<0?0:ft>255?255:ft}function ce(ft){return ft<0?0:ft>1?1:ft}function me(ft){return ft[ft.length-1]==="%"?te(parseFloat(ft)/100*255):te(parseInt(ft))}function Ae(ft){return ft[ft.length-1]==="%"?ce(parseFloat(ft)/100):ce(parseFloat(ft))}function Fe(ft,dt,Pt){return Pt<0?Pt+=1:Pt>1&&(Pt-=1),Pt*6<1?ft+(dt-ft)*Pt*6:Pt*2<1?dt:Pt*3<2?ft+(dt-ft)*(2/3-Pt)*6:ft}function $e(ft){var dt=ft.replace(/ /g,"").toLowerCase();if(dt in N)return N[dt].slice();if(dt[0]==="#"){if(dt.length===4){var Pt=parseInt(dt.substr(1),16);return Pt>=0&&Pt<=4095?[(Pt&3840)>>4|(Pt&3840)>>8,Pt&240|(Pt&240)>>4,Pt&15|(Pt&15)<<4,1]:null}else if(dt.length===7){var Pt=parseInt(dt.substr(1),16);return Pt>=0&&Pt<=16777215?[(Pt&16711680)>>16,(Pt&65280)>>8,Pt&255,1]:null}return null}var Jt=dt.indexOf("("),Yt=dt.indexOf(")");if(Jt!==-1&&Yt+1===dt.length){var ur=dt.substr(0,Jt),Dr=dt.substr(Jt+1,Yt-(Jt+1)).split(","),rn=1;switch(ur){case"rgba":if(Dr.length!==4)return null;rn=Ae(Dr.pop());case"rgb":return Dr.length!==3?null:[me(Dr[0]),me(Dr[1]),me(Dr[2]),rn];case"hsla":if(Dr.length!==4)return null;rn=Ae(Dr.pop());case"hsl":if(Dr.length!==3)return null;var Jr=(parseFloat(Dr[0])%360+360)%360/360,kn=Ae(Dr[1]),mn=Ae(Dr[2]),Mn=mn<=.5?mn*(kn+1):mn+kn-mn*kn,zn=mn*2-Mn;return[te(Fe(zn,Mn,Jr+1/3)*255),te(Fe(zn,Mn,Jr)*255),te(Fe(zn,Mn,Jr-1/3)*255),rn];default:return null}}return null}try{L.parseCSSColor=$e}catch{}}),Tl=Jl.parseCSSColor,mi=function(L,N,te,ce){ce===void 0&&(ce=1),this.r=L,this.g=N,this.b=te,this.a=ce};mi.parse=function(L){if(!!L){if(L instanceof mi)return L;if(typeof L=="string"){var N=Tl(L);if(!!N)return new mi(N[0]/255*N[3],N[1]/255*N[3],N[2]/255*N[3],N[3])}}},mi.prototype.toString=function(){var L=this.toArray(),N=L[0],te=L[1],ce=L[2],me=L[3];return"rgba("+Math.round(N)+","+Math.round(te)+","+Math.round(ce)+","+me+")"},mi.prototype.toArray=function(){var L=this,N=L.r,te=L.g,ce=L.b,me=L.a;return me===0?[0,0,0,0]:[N*255/me,te*255/me,ce*255/me,me]},mi.black=new mi(0,0,0,1),mi.white=new mi(1,1,1,1),mi.transparent=new mi(0,0,0,0),mi.red=new mi(1,0,0,1);var hs=function(L,N,te){L?this.sensitivity=N?"variant":"case":this.sensitivity=N?"accent":"base",this.locale=te,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};hs.prototype.compare=function(L,N){return this.collator.compare(L,N)},hs.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Gs=function(L,N,te,ce,me){this.text=L,this.image=N,this.scale=te,this.fontStack=ce,this.textColor=me},no=function(L){this.sections=L};no.fromString=function(L){return new no([new Gs(L,null,null,null,null)])},no.prototype.isEmpty=function(){return this.sections.length===0?!0:!this.sections.some(function(L){return L.text.length!==0||L.image&&L.image.name.length!==0})},no.factory=function(L){return L instanceof no?L:no.fromString(L)},no.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(L){return L.text}).join("")},no.prototype.serialize=function(){for(var L=["format"],N=0,te=this.sections;N<te.length;N+=1){var ce=te[N];if(ce.image){L.push(["image",ce.image.name]);continue}L.push(ce.text);var me={};ce.fontStack&&(me["text-font"]=["literal",ce.fontStack.split(",")]),ce.scale&&(me["font-scale"]=ce.scale),ce.textColor&&(me["text-color"]=["rgba"].concat(ce.textColor.toArray())),L.push(me)}return L};var ko=function(L){this.name=L.name,this.available=L.available};ko.prototype.toString=function(){return this.name},ko.fromString=function(L){return L?new ko({name:L,available:!1}):null},ko.prototype.serialize=function(){return["image",this.name]};function Fl(C,L,N,te){if(!(typeof C=="number"&&C>=0&&C<=255&&typeof L=="number"&&L>=0&&L<=255&&typeof N=="number"&&N>=0&&N<=255)){var ce=typeof te=="number"?[C,L,N,te]:[C,L,N];return"Invalid rgba value ["+ce.join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}return typeof te>"u"||typeof te=="number"&&te>=0&&te<=1?null:"Invalid rgba value ["+[C,L,N,te].join(", ")+"]: 'a' must be between 0 and 1."}function Ho(C){if(C===null)return!0;if(typeof C=="string")return!0;if(typeof C=="boolean")return!0;if(typeof C=="number")return!0;if(C instanceof mi)return!0;if(C instanceof hs)return!0;if(C instanceof no)return!0;if(C instanceof ko)return!0;if(Array.isArray(C)){for(var L=0,N=C;L<N.length;L+=1){var te=N[L];if(!Ho(te))return!1}return!0}else if(typeof C=="object"){for(var ce in C)if(!Ho(C[ce]))return!1;return!0}else return!1}function ao(C){if(C===null)return dr;if(typeof C=="string")return Pr;if(typeof C=="boolean")return dn;if(typeof C=="number")return pr;if(C instanceof mi)return Un;if(C instanceof hs)return sa;if(C instanceof no)return ga;if(C instanceof ko)return wa;if(Array.isArray(C)){for(var L=C.length,N,te=0,ce=C;te<ce.length;te+=1){var me=ce[te],Ae=ao(me);if(!N)N=Ae;else{if(N===Ae)continue;N=bn;break}}return ua(N||bn,L)}else return ra}function Ys(C){var L=typeof C;return C===null?"":L==="string"||L==="number"||L==="boolean"?String(C):C instanceof mi||C instanceof no||C instanceof ko?C.toString():JSON.stringify(C)}var io=function(L,N){this.type=L,this.value=N};io.parse=function(L,N){if(L.length!==2)return N.error("'literal' expression requires exactly one argument, but found "+(L.length-1)+" instead.");if(!Ho(L[1]))return N.error("invalid value");var te=L[1],ce=ao(te),me=N.expectedType;return ce.kind==="array"&&ce.N===0&&me&&me.kind==="array"&&(typeof me.N!="number"||me.N===0)&&(ce=me),new io(ce,te)},io.prototype.evaluate=function(){return this.value},io.prototype.eachChild=function(){},io.prototype.outputDefined=function(){return!0},io.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof mi?["rgba"].concat(this.value.toArray()):this.value instanceof no?this.value.serialize():this.value};var Si=function(L){this.name="ExpressionEvaluationError",this.message=L};Si.prototype.toJSON=function(){return this.message};var Eo={string:Pr,number:pr,boolean:dn,object:ra},oo=function(L,N){this.type=L,this.args=N};oo.parse=function(L,N){if(L.length<2)return N.error("Expected at least one argument.");var te=1,ce,me=L[0];if(me==="array"){var Ae;if(L.length>2){var Fe=L[1];if(typeof Fe!="string"||!(Fe in Eo)||Fe==="object")return N.error('The item type argument of "array" must be one of string, number, boolean',1);Ae=Eo[Fe],te++}else Ae=bn;var $e;if(L.length>3){if(L[2]!==null&&(typeof L[2]!="number"||L[2]<0||L[2]!==Math.floor(L[2])))return N.error('The length argument to "array" must be a positive integer literal',2);$e=L[2],te++}ce=ua(Ae,$e)}else ce=Eo[me];for(var ft=[];te<L.length;te++){var dt=N.parse(L[te],te,bn);if(!dt)return null;ft.push(dt)}return new oo(ce,ft)},oo.prototype.evaluate=function(L){for(var N=0;N<this.args.length;N++){var te=this.args[N].evaluate(L),ce=So(this.type,ao(te));if(ce){if(N===this.args.length-1)throw new Si("Expected value to be of type "+Aa(this.type)+", but found "+Aa(ao(te))+" instead.")}else return te}return null},oo.prototype.eachChild=function(L){this.args.forEach(L)},oo.prototype.outputDefined=function(){return this.args.every(function(L){return L.outputDefined()})},oo.prototype.serialize=function(){var L=this.type,N=[L.kind];if(L.kind==="array"){var te=L.itemType;if(te.kind==="string"||te.kind==="number"||te.kind==="boolean"){N.push(te.kind);var ce=L.N;(typeof ce=="number"||this.args.length>1)&&N.push(ce)}}return N.concat(this.args.map(function(me){return me.serialize()}))};var $o=function(L){this.type=ga,this.sections=L};$o.parse=function(L,N){if(L.length<2)return N.error("Expected at least one argument.");var te=L[1];if(!Array.isArray(te)&&typeof te=="object")return N.error("First argument must be an image or text section.");for(var ce=[],me=!1,Ae=1;Ae<=L.length-1;++Ae){var Fe=L[Ae];if(me&&typeof Fe=="object"&&!Array.isArray(Fe)){me=!1;var $e=null;if(Fe["font-scale"]&&($e=N.parse(Fe["font-scale"],1,pr),!$e))return null;var ft=null;if(Fe["text-font"]&&(ft=N.parse(Fe["text-font"],1,ua(Pr)),!ft))return null;var dt=null;if(Fe["text-color"]&&(dt=N.parse(Fe["text-color"],1,Un),!dt))return null;var Pt=ce[ce.length-1];Pt.scale=$e,Pt.font=ft,Pt.textColor=dt}else{var Jt=N.parse(L[Ae],1,bn);if(!Jt)return null;var Yt=Jt.type.kind;if(Yt!=="string"&&Yt!=="value"&&Yt!=="null"&&Yt!=="resolvedImage")return N.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");me=!0,ce.push({content:Jt,scale:null,font:null,textColor:null})}}return new $o(ce)},$o.prototype.evaluate=function(L){var N=function(te){var ce=te.content.evaluate(L);return ao(ce)===wa?new Gs("",ce,null,null,null):new Gs(Ys(ce),null,te.scale?te.scale.evaluate(L):null,te.font?te.font.evaluate(L).join(","):null,te.textColor?te.textColor.evaluate(L):null)};return new no(this.sections.map(N))},$o.prototype.eachChild=function(L){for(var N=0,te=this.sections;N<te.length;N+=1){var ce=te[N];L(ce.content),ce.scale&&L(ce.scale),ce.font&&L(ce.font),ce.textColor&&L(ce.textColor)}},$o.prototype.outputDefined=function(){return!1},$o.prototype.serialize=function(){for(var L=["format"],N=0,te=this.sections;N<te.length;N+=1){var ce=te[N];L.push(ce.content.serialize());var me={};ce.scale&&(me["font-scale"]=ce.scale.serialize()),ce.font&&(me["text-font"]=ce.font.serialize()),ce.textColor&&(me["text-color"]=ce.textColor.serialize()),L.push(me)}return L};var Go=function(L){this.type=wa,this.input=L};Go.parse=function(L,N){if(L.length!==2)return N.error("Expected two arguments.");var te=N.parse(L[1],1,Pr);return te?new Go(te):N.error("No image name provided.")},Go.prototype.evaluate=function(L){var N=this.input.evaluate(L),te=ko.fromString(N);return te&&L.availableImages&&(te.available=L.availableImages.indexOf(N)>-1),te},Go.prototype.eachChild=function(L){L(this.input)},Go.prototype.outputDefined=function(){return!1},Go.prototype.serialize=function(){return["image",this.input.serialize()]};var Al={"to-boolean":dn,"to-color":Un,"to-number":pr,"to-string":Pr},Yo=function(L,N){this.type=L,this.args=N};Yo.parse=function(L,N){if(L.length<2)return N.error("Expected at least one argument.");var te=L[0];if((te==="to-boolean"||te==="to-string")&&L.length!==2)return N.error("Expected one argument.");for(var ce=Al[te],me=[],Ae=1;Ae<L.length;Ae++){var Fe=N.parse(L[Ae],Ae,bn);if(!Fe)return null;me.push(Fe)}return new Yo(ce,me)},Yo.prototype.evaluate=function(L){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(L));if(this.type.kind==="color"){for(var N,te,ce=0,me=this.args;ce<me.length;ce+=1){var Ae=me[ce];if(N=Ae.evaluate(L),te=null,N instanceof mi)return N;if(typeof N=="string"){var Fe=L.parseColor(N);if(Fe)return Fe}else if(Array.isArray(N)&&(N.length<3||N.length>4?te="Invalid rbga value "+JSON.stringify(N)+": expected an array containing either three or four numeric values.":te=Fl(N[0],N[1],N[2],N[3]),!te))return new mi(N[0]/255,N[1]/255,N[2]/255,N[3])}throw new Si(te||"Could not parse color from value '"+(typeof N=="string"?N:String(JSON.stringify(N)))+"'")}else if(this.type.kind==="number"){for(var $e=null,ft=0,dt=this.args;ft<dt.length;ft+=1){var Pt=dt[ft];if($e=Pt.evaluate(L),$e===null)return 0;var Jt=Number($e);if(!isNaN(Jt))return Jt}throw new Si("Could not convert "+JSON.stringify($e)+" to number.")}else return this.type.kind==="formatted"?no.fromString(Ys(this.args[0].evaluate(L))):this.type.kind==="resolvedImage"?ko.fromString(Ys(this.args[0].evaluate(L))):Ys(this.args[0].evaluate(L))},Yo.prototype.eachChild=function(L){this.args.forEach(L)},Yo.prototype.outputDefined=function(){return this.args.every(function(L){return L.outputDefined()})},Yo.prototype.serialize=function(){if(this.type.kind==="formatted")return new $o([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Go(this.args[0]).serialize();var L=["to-"+this.type.kind];return this.eachChild(function(N){L.push(N.serialize())}),L};var Eu=["Unknown","Point","LineString","Polygon"],Ws=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Ws.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Ws.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Eu[this.feature.type]:this.feature.type:null},Ws.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Ws.prototype.canonicalID=function(){return this.canonical},Ws.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Ws.prototype.parseColor=function(L){var N=this._parseColorCache[L];return N||(N=this._parseColorCache[L]=mi.parse(L)),N};var Co=function(L,N,te,ce){this.name=L,this.type=N,this._evaluate=te,this.args=ce};Co.prototype.evaluate=function(L){return this._evaluate(L,this.args)},Co.prototype.eachChild=function(L){this.args.forEach(L)},Co.prototype.outputDefined=function(){return!1},Co.prototype.serialize=function(){return[this.name].concat(this.args.map(function(L){return L.serialize()}))},Co.parse=function(L,N){var te,ce=L[0],me=Co.definitions[ce];if(!me)return N.error('Unknown expression "'+ce+'". If you wanted a literal array, use ["literal", [...]].',0);for(var Ae=Array.isArray(me)?me[0]:me.type,Fe=Array.isArray(me)?[[me[1],me[2]]]:me.overloads,$e=Fe.filter(function(Da){var za=Da[0];return!Array.isArray(za)||za.length===L.length-1}),ft=null,dt=0,Pt=$e;dt<Pt.length;dt+=1){var Jt=Pt[dt],Yt=Jt[0],ur=Jt[1];ft=new Lo(N.registry,N.path,null,N.scope);for(var Dr=[],rn=!1,Jr=1;Jr<L.length;Jr++){var kn=L[Jr],mn=Array.isArray(Yt)?Yt[Jr-1]:Yt.type,Mn=ft.parse(kn,1+Dr.length,mn);if(!Mn){rn=!0;break}Dr.push(Mn)}if(!rn){if(Array.isArray(Yt)&&Yt.length!==Dr.length){ft.error("Expected "+Yt.length+" arguments, but found "+Dr.length+" instead.");continue}for(var zn=0;zn<Dr.length;zn++){var Yn=Array.isArray(Yt)?Yt[zn]:Yt.type,la=Dr[zn];ft.concat(zn+1).checkSubtype(Yn,la.type)}if(ft.errors.length===0)return new Co(ce,Ae,ur,Dr)}}if($e.length===1)(te=N.errors).push.apply(te,ft.errors);else{for(var ia=$e.length?$e:Fe,Ba=ia.map(function(Da){var za=Da[0];return du(za)}).join(" | "),_a=[],Sa=1;Sa<L.length;Sa++){var ni=N.parse(L[Sa],1+_a.length);if(!ni)return null;_a.push(Aa(ni.type))}N.error("Expected arguments of type "+Ba+", but found ("+_a.join(", ")+") instead.")}return null},Co.register=function(L,N){Co.definitions=N;for(var te in N)L[te]=Co};function du(C){return Array.isArray(C)?"("+C.map(Aa).join(", ")+")":"("+Aa(C.type)+"...)"}var _s=function(L,N,te){this.type=sa,this.locale=te,this.caseSensitive=L,this.diacriticSensitive=N};_s.parse=function(L,N){if(L.length!==2)return N.error("Expected one argument.");var te=L[1];if(typeof te!="object"||Array.isArray(te))return N.error("Collator options argument must be an object.");var ce=N.parse(te["case-sensitive"]===void 0?!1:te["case-sensitive"],1,dn);if(!ce)return null;var me=N.parse(te["diacritic-sensitive"]===void 0?!1:te["diacritic-sensitive"],1,dn);if(!me)return null;var Ae=null;return te.locale&&(Ae=N.parse(te.locale,1,Pr),!Ae)?null:new _s(ce,me,Ae)},_s.prototype.evaluate=function(L){return new hs(this.caseSensitive.evaluate(L),this.diacriticSensitive.evaluate(L),this.locale?this.locale.evaluate(L):null)},_s.prototype.eachChild=function(L){L(this.caseSensitive),L(this.diacriticSensitive),this.locale&&L(this.locale)},_s.prototype.outputDefined=function(){return!1},_s.prototype.serialize=function(){var L={};return L["case-sensitive"]=this.caseSensitive.serialize(),L["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(L.locale=this.locale.serialize()),["collator",L]};var ws=8192;function Ol(C,L){C[0]=Math.min(C[0],L[0]),C[1]=Math.min(C[1],L[1]),C[2]=Math.max(C[2],L[0]),C[3]=Math.max(C[3],L[1])}function Cu(C){return(180+C)/360}function Lu(C){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+C*Math.PI/360)))/360}function Xs(C,L){return!(C[0]<=L[0]||C[2]>=L[2]||C[1]<=L[1]||C[3]>=L[3])}function Bl(C,L){var N=Cu(C[0]),te=Lu(C[1]),ce=Math.pow(2,L.z);return[Math.round(N*ce*ws),Math.round(te*ce*ws)]}function Ts(C,L,N){var te=C[0]-L[0],ce=C[1]-L[1],me=C[0]-N[0],Ae=C[1]-N[1];return te*Ae-me*ce===0&&te*me<=0&&ce*Ae<=0}function Ql(C,L,N){return L[1]>C[1]!=N[1]>C[1]&&C[0]<(N[0]-L[0])*(C[1]-L[1])/(N[1]-L[1])+L[0]}function il(C,L){for(var N=!1,te=0,ce=L.length;te<ce;te++)for(var me=L[te],Ae=0,Fe=me.length;Ae<Fe-1;Ae++){if(Ts(C,me[Ae],me[Ae+1]))return!1;Ql(C,me[Ae],me[Ae+1])&&(N=!N)}return N}function $l(C,L){for(var N=0;N<L.length;N++)if(il(C,L[N]))return!0;return!1}function Pu(C,L){return C[0]*L[1]-C[1]*L[0]}function ql(C,L,N,te){var ce=C[0]-N[0],me=C[1]-N[1],Ae=L[0]-N[0],Fe=L[1]-N[1],$e=te[0]-N[0],ft=te[1]-N[1],dt=ce*ft-$e*me,Pt=Ae*ft-$e*Fe;return dt>0&&Pt<0||dt<0&&Pt>0}function Zu(C,L,N,te){var ce=[L[0]-C[0],L[1]-C[1]],me=[te[0]-N[0],te[1]-N[1]];return Pu(me,ce)===0?!1:!!(ql(C,L,N,te)&&ql(N,te,C,L))}function Zs(C,L,N){for(var te=0,ce=N;te<ce.length;te+=1)for(var me=ce[te],Ae=0;Ae<me.length-1;++Ae)if(Zu(C,L,me[Ae],me[Ae+1]))return!0;return!1}function Nl(C,L){for(var N=0;N<C.length;++N)if(!il(C[N],L))return!1;for(var te=0;te<C.length-1;++te)if(Zs(C[te],C[te+1],L))return!1;return!0}function Ml(C,L){for(var N=0;N<L.length;N++)if(Nl(C,L[N]))return!0;return!1}function ol(C,L,N){for(var te=[],ce=0;ce<C.length;ce++){for(var me=[],Ae=0;Ae<C[ce].length;Ae++){var Fe=Bl(C[ce][Ae],N);Ol(L,Fe),me.push(Fe)}te.push(me)}return te}function Sl(C,L,N){for(var te=[],ce=0;ce<C.length;ce++){var me=ol(C[ce],L,N);te.push(me)}return te}function eu(C,L,N,te){if(C[0]<N[0]||C[0]>N[2]){var ce=te*.5,me=C[0]-N[0]>ce?-te:N[0]-C[0]>ce?te:0;me===0&&(me=C[0]-N[2]>ce?-te:N[2]-C[0]>ce?te:0),C[0]+=me}Ol(L,C)}function js(C){C[0]=C[1]=1/0,C[2]=C[3]=-1/0}function gu(C,L,N,te){for(var ce=Math.pow(2,te.z)*ws,me=[te.x*ws,te.y*ws],Ae=[],Fe=0,$e=C;Fe<$e.length;Fe+=1)for(var ft=$e[Fe],dt=0,Pt=ft;dt<Pt.length;dt+=1){var Jt=Pt[dt],Yt=[Jt.x+me[0],Jt.y+me[1]];eu(Yt,L,N,ce),Ae.push(Yt)}return Ae}function tu(C,L,N,te){for(var ce=Math.pow(2,te.z)*ws,me=[te.x*ws,te.y*ws],Ae=[],Fe=0,$e=C;Fe<$e.length;Fe+=1){for(var ft=$e[Fe],dt=[],Pt=0,Jt=ft;Pt<Jt.length;Pt+=1){var Yt=Jt[Pt],ur=[Yt.x+me[0],Yt.y+me[1]];Ol(L,ur),dt.push(ur)}Ae.push(dt)}if(L[2]-L[0]<=ce/2){js(L);for(var Dr=0,rn=Ae;Dr<rn.length;Dr+=1)for(var Jr=rn[Dr],kn=0,mn=Jr;kn<mn.length;kn+=1){var Mn=mn[kn];eu(Mn,L,N,ce)}}return Ae}function Du(C,L){var N=[1/0,1/0,-1/0,-1/0],te=[1/0,1/0,-1/0,-1/0],ce=C.canonicalID();if(L.type==="Polygon"){var me=ol(L.coordinates,te,ce),Ae=gu(C.geometry(),N,te,ce);if(!Xs(N,te))return!1;for(var Fe=0,$e=Ae;Fe<$e.length;Fe+=1){var ft=$e[Fe];if(!il(ft,me))return!1}}if(L.type==="MultiPolygon"){var dt=Sl(L.coordinates,te,ce),Pt=gu(C.geometry(),N,te,ce);if(!Xs(N,te))return!1;for(var Jt=0,Yt=Pt;Jt<Yt.length;Jt+=1){var ur=Yt[Jt];if(!$l(ur,dt))return!1}}return!0}function yu(C,L){var N=[1/0,1/0,-1/0,-1/0],te=[1/0,1/0,-1/0,-1/0],ce=C.canonicalID();if(L.type==="Polygon"){var me=ol(L.coordinates,te,ce),Ae=tu(C.geometry(),N,te,ce);if(!Xs(N,te))return!1;for(var Fe=0,$e=Ae;Fe<$e.length;Fe+=1){var ft=$e[Fe];if(!Nl(ft,me))return!1}}if(L.type==="MultiPolygon"){var dt=Sl(L.coordinates,te,ce),Pt=tu(C.geometry(),N,te,ce);if(!Xs(N,te))return!1;for(var Jt=0,Yt=Pt;Jt<Yt.length;Jt+=1){var ur=Yt[Jt];if(!Ml(ur,dt))return!1}}return!0}var Wo=function(L,N){this.type=dn,this.geojson=L,this.geometries=N};Wo.parse=function(L,N){if(L.length!==2)return N.error("'within' expression requires exactly one argument, but found "+(L.length-1)+" instead.");if(Ho(L[1])){var te=L[1];if(te.type==="FeatureCollection")for(var ce=0;ce<te.features.length;++ce){var me=te.features[ce].geometry.type;if(me==="Polygon"||me==="MultiPolygon")return new Wo(te,te.features[ce].geometry)}else if(te.type==="Feature"){var Ae=te.geometry.type;if(Ae==="Polygon"||Ae==="MultiPolygon")return new Wo(te,te.geometry)}else if(te.type==="Polygon"||te.type==="MultiPolygon")return new Wo(te,te)}return N.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Wo.prototype.evaluate=function(L){if(L.geometry()!=null&&L.canonicalID()!=null){if(L.geometryType()==="Point")return Du(L,this.geometries);if(L.geometryType()==="LineString")return yu(L,this.geometries)}return!1},Wo.prototype.eachChild=function(){},Wo.prototype.outputDefined=function(){return!0},Wo.prototype.serialize=function(){return["within",this.geojson]};function kl(C){if(C instanceof Co){if(C.name==="get"&&C.args.length===1)return!1;if(C.name==="feature-state")return!1;if(C.name==="has"&&C.args.length===1)return!1;if(C.name==="properties"||C.name==="geometry-type"||C.name==="id")return!1;if(/^filter-/.test(C.name))return!1}if(C instanceof Wo)return!1;var L=!0;return C.eachChild(function(N){L&&!kl(N)&&(L=!1)}),L}function sl(C){if(C instanceof Co&&C.name==="feature-state")return!1;var L=!0;return C.eachChild(function(N){L&&!sl(N)&&(L=!1)}),L}function ru(C,L){if(C instanceof Co&&L.indexOf(C.name)>=0)return!1;var N=!0;return C.eachChild(function(te){N&&!ru(te,L)&&(N=!1)}),N}var as=function(L,N){this.type=N.type,this.name=L,this.boundExpression=N};as.parse=function(L,N){if(L.length!==2||typeof L[1]!="string")return N.error("'var' expression requires exactly one string literal argument.");var te=L[1];return N.scope.has(te)?new as(te,N.scope.get(te)):N.error('Unknown variable "'+te+'". Make sure "'+te+'" has been bound in an enclosing "let" expression before using it.',1)},as.prototype.evaluate=function(L){return this.boundExpression.evaluate(L)},as.prototype.eachChild=function(){},as.prototype.outputDefined=function(){return!1},as.prototype.serialize=function(){return["var",this.name]};var Lo=function(L,N,te,ce,me){N===void 0&&(N=[]),ce===void 0&&(ce=new un),me===void 0&&(me=[]),this.registry=L,this.path=N,this.key=N.map(function(Ae){return"["+Ae+"]"}).join(""),this.scope=ce,this.errors=me,this.expectedType=te};Lo.prototype.parse=function(L,N,te,ce,me){return me===void 0&&(me={}),N?this.concat(N,te,ce)._parse(L,me):this._parse(L,me)},Lo.prototype._parse=function(L,N){(L===null||typeof L=="string"||typeof L=="boolean"||typeof L=="number")&&(L=["literal",L]);function te(dt,Pt,Jt){return Jt==="assert"?new oo(Pt,[dt]):Jt==="coerce"?new Yo(Pt,[dt]):dt}if(Array.isArray(L)){if(L.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var ce=L[0];if(typeof ce!="string")return this.error("Expression name must be a string, but found "+typeof ce+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var me=this.registry[ce];if(me){var Ae=me.parse(L,this);if(!Ae)return null;if(this.expectedType){var Fe=this.expectedType,$e=Ae.type;if((Fe.kind==="string"||Fe.kind==="number"||Fe.kind==="boolean"||Fe.kind==="object"||Fe.kind==="array")&&$e.kind==="value")Ae=te(Ae,Fe,N.typeAnnotation||"assert");else if((Fe.kind==="color"||Fe.kind==="formatted"||Fe.kind==="resolvedImage")&&($e.kind==="value"||$e.kind==="string"))Ae=te(Ae,Fe,N.typeAnnotation||"coerce");else if(this.checkSubtype(Fe,$e))return null}if(!(Ae instanceof io)&&Ae.type.kind!=="resolvedImage"&&Ul(Ae)){var ft=new Ws;try{Ae=new io(Ae.type,Ae.evaluate(ft))}catch(dt){return this.error(dt.message),null}}return Ae}return this.error('Unknown expression "'+ce+'". If you wanted a literal array, use ["literal", [...]].',0)}else return typeof L>"u"?this.error("'undefined' value invalid. Use null instead."):typeof L=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof L+" instead.")},Lo.prototype.concat=function(L,N,te){var ce=typeof L=="number"?this.path.concat(L):this.path,me=te?this.scope.concat(te):this.scope;return new Lo(this.registry,ce,N||null,me,this.errors)},Lo.prototype.error=function(L){for(var N=[],te=arguments.length-1;te-- >0;)N[te]=arguments[te+1];var ce=""+this.key+N.map(function(me){return"["+me+"]"}).join("");this.errors.push(new _n(ce,L))},Lo.prototype.checkSubtype=function(L,N){var te=So(L,N);return te&&this.error(te),te};function Ul(C){if(C instanceof as)return Ul(C.boundExpression);if(C instanceof Co&&C.name==="error")return!1;if(C instanceof _s)return!1;if(C instanceof Wo)return!1;var L=C instanceof Yo||C instanceof oo,N=!0;return C.eachChild(function(te){L?N=N&&Ul(te):N=N&&te instanceof io}),N?kl(C)&&ru(C,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}function Ps(C,L){for(var N=C.length-1,te=0,ce=N,me=0,Ae,Fe;te<=ce;)if(me=Math.floor((te+ce)/2),Ae=C[me],Fe=C[me+1],Ae<=L){if(me===N||L<Fe)return me;te=me+1}else if(Ae>L)ce=me-1;else throw new Si("Input is not a number.");return 0}var As=function(L,N,te){this.type=L,this.input=N,this.labels=[],this.outputs=[];for(var ce=0,me=te;ce<me.length;ce+=1){var Ae=me[ce],Fe=Ae[0],$e=Ae[1];this.labels.push(Fe),this.outputs.push($e)}};As.parse=function(L,N){if(L.length-1<4)return N.error("Expected at least 4 arguments, but found only "+(L.length-1)+".");if((L.length-1)%2!==0)return N.error("Expected an even number of arguments.");var te=N.parse(L[1],1,pr);if(!te)return null;var ce=[],me=null;N.expectedType&&N.expectedType.kind!=="value"&&(me=N.expectedType);for(var Ae=1;Ae<L.length;Ae+=2){var Fe=Ae===1?-1/0:L[Ae],$e=L[Ae+1],ft=Ae,dt=Ae+1;if(typeof Fe!="number")return N.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ft);if(ce.length&&ce[ce.length-1][0]>=Fe)return N.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ft);var Pt=N.parse($e,dt,me);if(!Pt)return null;me=me||Pt.type,ce.push([Fe,Pt])}return new As(me,te,ce)},As.prototype.evaluate=function(L){var N=this.labels,te=this.outputs;if(N.length===1)return te[0].evaluate(L);var ce=this.input.evaluate(L);if(ce<=N[0])return te[0].evaluate(L);var me=N.length;if(ce>=N[me-1])return te[me-1].evaluate(L);var Ae=Ps(N,ce);return te[Ae].evaluate(L)},As.prototype.eachChild=function(L){L(this.input);for(var N=0,te=this.outputs;N<te.length;N+=1){var ce=te[N];L(ce)}},As.prototype.outputDefined=function(){return this.outputs.every(function(L){return L.outputDefined()})},As.prototype.serialize=function(){for(var L=["step",this.input.serialize()],N=0;N<this.labels.length;N++)N>0&&L.push(this.labels[N]),L.push(this.outputs[N].serialize());return L};function ho(C,L,N){return C*(1-N)+L*N}function ll(C,L,N){return new mi(ho(C.r,L.r,N),ho(C.g,L.g,N),ho(C.b,L.b,N),ho(C.a,L.a,N))}function Ru(C,L,N){return C.map(function(te,ce){return ho(te,L[ce],N)})}var nu=Object.freeze({__proto__:null,number:ho,color:ll,array:Ru}),Iu=.95047,Ms=1,vs=1.08883,Xo=4/29,El=6/29,ul=3*El*El,zu=El*El*El,is=Math.PI/180,Fu=180/Math.PI;function au(C){return C>zu?Math.pow(C,1/3):C/ul+Xo}function fl(C){return C>El?C*C*C:ul*(C-Xo)}function iu(C){return 255*(C<=.0031308?12.92*C:1.055*Math.pow(C,1/2.4)-.055)}function Cl(C){return C/=255,C<=.04045?C/12.92:Math.pow((C+.055)/1.055,2.4)}function Ll(C){var L=Cl(C.r),N=Cl(C.g),te=Cl(C.b),ce=au((.4124564*L+.3575761*N+.1804375*te)/Iu),me=au((.2126729*L+.7151522*N+.072175*te)/Ms),Ae=au((.0193339*L+.119192*N+.9503041*te)/vs);return{l:116*me-16,a:500*(ce-me),b:200*(me-Ae),alpha:C.a}}function Vl(C){var L=(C.l+16)/116,N=isNaN(C.a)?L:L+C.a/500,te=isNaN(C.b)?L:L-C.b/200;return L=Ms*fl(L),N=Iu*fl(N),te=vs*fl(te),new mi(iu(3.2404542*N-1.5371385*L-.4985314*te),iu(-.969266*N+1.8760108*L+.041556*te),iu(.0556434*N-.2040259*L+1.0572252*te),C.alpha)}function Hl(C,L,N){return{l:ho(C.l,L.l,N),a:ho(C.a,L.a,N),b:ho(C.b,L.b,N),alpha:ho(C.alpha,L.alpha,N)}}function ju(C){var L=Ll(C),N=L.l,te=L.a,ce=L.b,me=Math.atan2(ce,te)*Fu;return{h:me<0?me+360:me,c:Math.sqrt(te*te+ce*ce),l:N,alpha:C.a}}function Vi(C){var L=C.h*is,N=C.c,te=C.l;return Vl({l:te,a:Math.cos(L)*N,b:Math.sin(L)*N,alpha:C.alpha})}function cl(C,L,N){var te=L-C;return C+N*(te>180||te<-180?te-360*Math.round(te/360):te)}function Ks(C,L,N){return{h:cl(C.h,L.h,N),c:ho(C.c,L.c,N),l:ho(C.l,L.l,N),alpha:ho(C.alpha,L.alpha,N)}}var os={forward:Ll,reverse:Vl,interpolate:Hl},ps={forward:ju,reverse:Vi,interpolate:Ks},Gl=Object.freeze({__proto__:null,lab:os,hcl:ps}),co=function(L,N,te,ce,me){this.type=L,this.operator=N,this.interpolation=te,this.input=ce,this.labels=[],this.outputs=[];for(var Ae=0,Fe=me;Ae<Fe.length;Ae+=1){var $e=Fe[Ae],ft=$e[0],dt=$e[1];this.labels.push(ft),this.outputs.push(dt)}};co.interpolationFactor=function(L,N,te,ce){var me=0;if(L.name==="exponential")me=ou(N,L.base,te,ce);else if(L.name==="linear")me=ou(N,1,te,ce);else if(L.name==="cubic-bezier"){var Ae=L.controlPoints,Fe=new a(Ae[0],Ae[1],Ae[2],Ae[3]);me=Fe.solve(ou(N,1,te,ce))}return me},co.parse=function(L,N){var te=L[0],ce=L[1],me=L[2],Ae=L.slice(3);if(!Array.isArray(ce)||ce.length===0)return N.error("Expected an interpolation type expression.",1);if(ce[0]==="linear")ce={name:"linear"};else if(ce[0]==="exponential"){var Fe=ce[1];if(typeof Fe!="number")return N.error("Exponential interpolation requires a numeric base.",1,1);ce={name:"exponential",base:Fe}}else if(ce[0]==="cubic-bezier"){var $e=ce.slice(1);if($e.length!==4||$e.some(function(Jr){return typeof Jr!="number"||Jr<0||Jr>1}))return N.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ce={name:"cubic-bezier",controlPoints:$e}}else return N.error("Unknown interpolation type "+String(ce[0]),1,0);if(L.length-1<4)return N.error("Expected at least 4 arguments, but found only "+(L.length-1)+".");if((L.length-1)%2!==0)return N.error("Expected an even number of arguments.");if(me=N.parse(me,2,pr),!me)return null;var ft=[],dt=null;te==="interpolate-hcl"||te==="interpolate-lab"?dt=Un:N.expectedType&&N.expectedType.kind!=="value"&&(dt=N.expectedType);for(var Pt=0;Pt<Ae.length;Pt+=2){var Jt=Ae[Pt],Yt=Ae[Pt+1],ur=Pt+3,Dr=Pt+4;if(typeof Jt!="number")return N.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ur);if(ft.length&&ft[ft.length-1][0]>=Jt)return N.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ur);var rn=N.parse(Yt,Dr,dt);if(!rn)return null;dt=dt||rn.type,ft.push([Jt,rn])}return dt.kind!=="number"&&dt.kind!=="color"&&!(dt.kind==="array"&&dt.itemType.kind==="number"&&typeof dt.N=="number")?N.error("Type "+Aa(dt)+" is not interpolatable."):new co(dt,te,ce,me,ft)},co.prototype.evaluate=function(L){var N=this.labels,te=this.outputs;if(N.length===1)return te[0].evaluate(L);var ce=this.input.evaluate(L);if(ce<=N[0])return te[0].evaluate(L);var me=N.length;if(ce>=N[me-1])return te[me-1].evaluate(L);var Ae=Ps(N,ce),Fe=N[Ae],$e=N[Ae+1],ft=co.interpolationFactor(this.interpolation,ce,Fe,$e),dt=te[Ae].evaluate(L),Pt=te[Ae+1].evaluate(L);return this.operator==="interpolate"?nu[this.type.kind.toLowerCase()](dt,Pt,ft):this.operator==="interpolate-hcl"?ps.reverse(ps.interpolate(ps.forward(dt),ps.forward(Pt),ft)):os.reverse(os.interpolate(os.forward(dt),os.forward(Pt),ft))},co.prototype.eachChild=function(L){L(this.input);for(var N=0,te=this.outputs;N<te.length;N+=1){var ce=te[N];L(ce)}},co.prototype.outputDefined=function(){return this.outputs.every(function(L){return L.outputDefined()})},co.prototype.serialize=function(){var L;this.interpolation.name==="linear"?L=["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?L=["linear"]:L=["exponential",this.interpolation.base]:L=["cubic-bezier"].concat(this.interpolation.controlPoints);for(var N=[this.operator,L,this.input.serialize()],te=0;te<this.labels.length;te++)N.push(this.labels[te],this.outputs[te].serialize());return N};function ou(C,L,N,te){var ce=te-N,me=C-N;return ce===0?0:L===1?me/ce:(Math.pow(L,me)-1)/(Math.pow(L,ce)-1)}var qo=function(L,N){this.type=L,this.args=N};qo.parse=function(L,N){if(L.length<2)return N.error("Expectected at least one argument.");var te=null,ce=N.expectedType;ce&&ce.kind!=="value"&&(te=ce);for(var me=[],Ae=0,Fe=L.slice(1);Ae<Fe.length;Ae+=1){var $e=Fe[Ae],ft=N.parse($e,1+me.length,te,void 0,{typeAnnotation:"omit"});if(!ft)return null;te=te||ft.type,me.push(ft)}var dt=ce&&me.some(function(Pt){return So(ce,Pt.type)});return dt?new qo(bn,me):new qo(te,me)},qo.prototype.evaluate=function(L){for(var N=null,te=0,ce,me=0,Ae=this.args;me<Ae.length;me+=1){var Fe=Ae[me];if(te++,N=Fe.evaluate(L),N&&N instanceof ko&&!N.available&&(ce||(ce=N.name),N=null,te===this.args.length&&(N=ce)),N!==null)break}return N},qo.prototype.eachChild=function(L){this.args.forEach(L)},qo.prototype.outputDefined=function(){return this.args.every(function(L){return L.outputDefined()})},qo.prototype.serialize=function(){var L=["coalesce"];return this.eachChild(function(N){L.push(N.serialize())}),L};var Ds=function(L,N){this.type=N.type,this.bindings=[].concat(L),this.result=N};Ds.prototype.evaluate=function(L){return this.result.evaluate(L)},Ds.prototype.eachChild=function(L){for(var N=0,te=this.bindings;N<te.length;N+=1){var ce=te[N];L(ce[1])}L(this.result)},Ds.parse=function(L,N){if(L.length<4)return N.error("Expected at least 3 arguments, but found "+(L.length-1)+" instead.");for(var te=[],ce=1;ce<L.length-1;ce+=2){var me=L[ce];if(typeof me!="string")return N.error("Expected string, but found "+typeof me+" instead.",ce);if(/[^a-zA-Z0-9_]/.test(me))return N.error("Variable names must contain only alphanumeric characters or '_'.",ce);var Ae=N.parse(L[ce+1],ce+1);if(!Ae)return null;te.push([me,Ae])}var Fe=N.parse(L[L.length-1],L.length-1,N.expectedType,te);return Fe?new Ds(te,Fe):null},Ds.prototype.outputDefined=function(){return this.result.outputDefined()},Ds.prototype.serialize=function(){for(var L=["let"],N=0,te=this.bindings;N<te.length;N+=1){var ce=te[N],me=ce[0],Ae=ce[1];L.push(me,Ae.serialize())}return L.push(this.result.serialize()),L};var Js=function(L,N,te){this.type=L,this.index=N,this.input=te};Js.parse=function(L,N){if(L.length!==3)return N.error("Expected 2 arguments, but found "+(L.length-1)+" instead.");var te=N.parse(L[1],1,pr),ce=N.parse(L[2],2,ua(N.expectedType||bn));if(!te||!ce)return null;var me=ce.type;return new Js(me.itemType,te,ce)},Js.prototype.evaluate=function(L){var N=this.index.evaluate(L),te=this.input.evaluate(L);if(N<0)throw new Si("Array index out of bounds: "+N+" < 0.");if(N>=te.length)throw new Si("Array index out of bounds: "+N+" > "+(te.length-1)+".");if(N!==Math.floor(N))throw new Si("Array index must be an integer, but found "+N+" instead.");return te[N]},Js.prototype.eachChild=function(L){L(this.index),L(this.input)},Js.prototype.outputDefined=function(){return!1},Js.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Rs=function(L,N){this.type=dn,this.needle=L,this.haystack=N};Rs.parse=function(L,N){if(L.length!==3)return N.error("Expected 2 arguments, but found "+(L.length-1)+" instead.");var te=N.parse(L[1],1,bn),ce=N.parse(L[2],2,bn);return!te||!ce?null:Fo(te.type,[dn,Pr,pr,dr,bn])?new Rs(te,ce):N.error("Expected first argument to be of type boolean, string, number or null, but found "+Aa(te.type)+" instead")},Rs.prototype.evaluate=function(L){var N=this.needle.evaluate(L),te=this.haystack.evaluate(L);if(!te)return!1;if(!cs(N,["boolean","string","number","null"]))throw new Si("Expected first argument to be of type boolean, string, number or null, but found "+Aa(ao(N))+" instead.");if(!cs(te,["string","array"]))throw new Si("Expected second argument to be of type array or string, but found "+Aa(ao(te))+" instead.");return te.indexOf(N)>=0},Rs.prototype.eachChild=function(L){L(this.needle),L(this.haystack)},Rs.prototype.outputDefined=function(){return!0},Rs.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ds=function(L,N,te){this.type=pr,this.needle=L,this.haystack=N,this.fromIndex=te};ds.parse=function(L,N){if(L.length<=2||L.length>=5)return N.error("Expected 3 or 4 arguments, but found "+(L.length-1)+" instead.");var te=N.parse(L[1],1,bn),ce=N.parse(L[2],2,bn);if(!te||!ce)return null;if(!Fo(te.type,[dn,Pr,pr,dr,bn]))return N.error("Expected first argument to be of type boolean, string, number or null, but found "+Aa(te.type)+" instead");if(L.length===4){var me=N.parse(L[3],3,pr);return me?new ds(te,ce,me):null}else return new ds(te,ce)},ds.prototype.evaluate=function(L){var N=this.needle.evaluate(L),te=this.haystack.evaluate(L);if(!cs(N,["boolean","string","number","null"]))throw new Si("Expected first argument to be of type boolean, string, number or null, but found "+Aa(ao(N))+" instead.");if(!cs(te,["string","array"]))throw new Si("Expected second argument to be of type array or string, but found "+Aa(ao(te))+" instead.");if(this.fromIndex){var ce=this.fromIndex.evaluate(L);return te.indexOf(N,ce)}return te.indexOf(N)},ds.prototype.eachChild=function(L){L(this.needle),L(this.haystack),this.fromIndex&&L(this.fromIndex)},ds.prototype.outputDefined=function(){return!1},ds.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var L=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),L]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Ji=function(L,N,te,ce,me,Ae){this.inputType=L,this.type=N,this.input=te,this.cases=ce,this.outputs=me,this.otherwise=Ae};Ji.parse=function(L,N){if(L.length<5)return N.error("Expected at least 4 arguments, but found only "+(L.length-1)+".");if(L.length%2!==1)return N.error("Expected an even number of arguments.");var te,ce;N.expectedType&&N.expectedType.kind!=="value"&&(ce=N.expectedType);for(var me={},Ae=[],Fe=2;Fe<L.length-1;Fe+=2){var $e=L[Fe],ft=L[Fe+1];Array.isArray($e)||($e=[$e]);var dt=N.concat(Fe);if($e.length===0)return dt.error("Expected at least one branch label.");for(var Pt=0,Jt=$e;Pt<Jt.length;Pt+=1){var Yt=Jt[Pt];if(typeof Yt!="number"&&typeof Yt!="string")return dt.error("Branch labels must be numbers or strings.");if(typeof Yt=="number"&&Math.abs(Yt)>Number.MAX_SAFE_INTEGER)return dt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Yt=="number"&&Math.floor(Yt)!==Yt)return dt.error("Numeric branch labels must be integer values.");if(!te)te=ao(Yt);else if(dt.checkSubtype(te,ao(Yt)))return null;if(typeof me[String(Yt)]<"u")return dt.error("Branch labels must be unique.");me[String(Yt)]=Ae.length}var ur=N.parse(ft,Fe,ce);if(!ur)return null;ce=ce||ur.type,Ae.push(ur)}var Dr=N.parse(L[1],1,bn);if(!Dr)return null;var rn=N.parse(L[L.length-1],L.length-1,ce);return!rn||Dr.type.kind!=="value"&&N.concat(1).checkSubtype(te,Dr.type)?null:new Ji(te,ce,Dr,me,Ae,rn)},Ji.prototype.evaluate=function(L){var N=this.input.evaluate(L),te=ao(N)===this.inputType&&this.outputs[this.cases[N]]||this.otherwise;return te.evaluate(L)},Ji.prototype.eachChild=function(L){L(this.input),this.outputs.forEach(L),L(this.otherwise)},Ji.prototype.outputDefined=function(){return this.outputs.every(function(L){return L.outputDefined()})&&this.otherwise.outputDefined()},Ji.prototype.serialize=function(){for(var L=this,N=["match",this.input.serialize()],te=Object.keys(this.cases).sort(),ce=[],me={},Ae=0,Fe=te;Ae<Fe.length;Ae+=1){var $e=Fe[Ae],ft=me[this.cases[$e]];ft===void 0?(me[this.cases[$e]]=ce.length,ce.push([this.cases[$e],[$e]])):ce[ft][1].push($e)}for(var dt=function(Dr){return L.inputType.kind==="number"?Number(Dr):Dr},Pt=0,Jt=ce;Pt<Jt.length;Pt+=1){var Yt=Jt[Pt],ft=Yt[0],ur=Yt[1];ur.length===1?N.push(dt(ur[0])):N.push(ur.map(dt)),N.push(this.outputs[outputIndex$1].serialize())}return N.push(this.otherwise.serialize()),N};var wo=function(L,N,te){this.type=L,this.branches=N,this.otherwise=te};wo.parse=function(L,N){if(L.length<4)return N.error("Expected at least 3 arguments, but found only "+(L.length-1)+".");if(L.length%2!==0)return N.error("Expected an odd number of arguments.");var te;N.expectedType&&N.expectedType.kind!=="value"&&(te=N.expectedType);for(var ce=[],me=1;me<L.length-1;me+=2){var Ae=N.parse(L[me],me,dn);if(!Ae)return null;var Fe=N.parse(L[me+1],me+1,te);if(!Fe)return null;ce.push([Ae,Fe]),te=te||Fe.type}var $e=N.parse(L[L.length-1],L.length-1,te);return $e?new wo(te,ce,$e):null},wo.prototype.evaluate=function(L){for(var N=0,te=this.branches;N<te.length;N+=1){var ce=te[N],me=ce[0],Ae=ce[1];if(me.evaluate(L))return Ae.evaluate(L)}return this.otherwise.evaluate(L)},wo.prototype.eachChild=function(L){for(var N=0,te=this.branches;N<te.length;N+=1){var ce=te[N],me=ce[0],Ae=ce[1];L(me),L(Ae)}L(this.otherwise)},wo.prototype.outputDefined=function(){return this.branches.every(function(L){var N=L[0],te=L[1];return te.outputDefined()})&&this.otherwise.outputDefined()},wo.prototype.serialize=function(){var L=["case"];return this.eachChild(function(N){L.push(N.serialize())}),L};var Zo=function(L,N,te,ce){this.type=L,this.input=N,this.beginIndex=te,this.endIndex=ce};Zo.parse=function(L,N){if(L.length<=2||L.length>=5)return N.error("Expected 3 or 4 arguments, but found "+(L.length-1)+" instead.");var te=N.parse(L[1],1,bn),ce=N.parse(L[2],2,pr);if(!te||!ce)return null;if(!Fo(te.type,[ua(bn),Pr,bn]))return N.error("Expected first argument to be of type array or string, but found "+Aa(te.type)+" instead");if(L.length===4){var me=N.parse(L[3],3,pr);return me?new Zo(te.type,te,ce,me):null}else return new Zo(te.type,te,ce)},Zo.prototype.evaluate=function(L){var N=this.input.evaluate(L),te=this.beginIndex.evaluate(L);if(!cs(N,["string","array"]))throw new Si("Expected first argument to be of type array or string, but found "+Aa(ao(N))+" instead.");if(this.endIndex){var ce=this.endIndex.evaluate(L);return N.slice(te,ce)}return N.slice(te)},Zo.prototype.eachChild=function(L){L(this.input),L(this.beginIndex),this.endIndex&&L(this.endIndex)},Zo.prototype.outputDefined=function(){return!1},Zo.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var L=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),L]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};function Yl(C,L){return C==="=="||C==="!="?L.kind==="boolean"||L.kind==="string"||L.kind==="number"||L.kind==="null"||L.kind==="value":L.kind==="string"||L.kind==="number"||L.kind==="value"}function Wl(C,L,N){return L===N}function mu(C,L,N){return L!==N}function gt(C,L,N){return L<N}function Dt(C,L,N){return L>N}function or(C,L,N){return L<=N}function er(C,L,N){return L>=N}function Er(C,L,N,te){return te.compare(L,N)===0}function en(C,L,N,te){return!Er(C,L,N,te)}function pn(C,L,N,te){return te.compare(L,N)<0}function An(C,L,N,te){return te.compare(L,N)>0}function Ln(C,L,N,te){return te.compare(L,N)<=0}function Hn(C,L,N,te){return te.compare(L,N)>=0}function yn(C,L,N){var te=C!=="=="&&C!=="!=";return function(){function ce(me,Ae,Fe){this.type=dn,this.lhs=me,this.rhs=Ae,this.collator=Fe,this.hasUntypedArgument=me.type.kind==="value"||Ae.type.kind==="value"}return ce.parse=function(Ae,Fe){if(Ae.length!==3&&Ae.length!==4)return Fe.error("Expected two or three arguments.");var $e=Ae[0],ft=Fe.parse(Ae[1],1,bn);if(!ft)return null;if(!Yl($e,ft.type))return Fe.concat(1).error('"'+$e+`" comparisons are not supported for type '`+Aa(ft.type)+"'.");var dt=Fe.parse(Ae[2],2,bn);if(!dt)return null;if(!Yl($e,dt.type))return Fe.concat(2).error('"'+$e+`" comparisons are not supported for type '`+Aa(dt.type)+"'.");if(ft.type.kind!==dt.type.kind&&ft.type.kind!=="value"&&dt.type.kind!=="value")return Fe.error("Cannot compare types '"+Aa(ft.type)+"' and '"+Aa(dt.type)+"'.");te&&(ft.type.kind==="value"&&dt.type.kind!=="value"?ft=new oo(dt.type,[ft]):ft.type.kind!=="value"&&dt.type.kind==="value"&&(dt=new oo(ft.type,[dt])));var Pt=null;if(Ae.length===4){if(ft.type.kind!=="string"&&dt.type.kind!=="string"&&ft.type.kind!=="value"&&dt.type.kind!=="value")return Fe.error("Cannot use collator to compare non-string types.");if(Pt=Fe.parse(Ae[3],3,sa),!Pt)return null}return new ce(ft,dt,Pt)},ce.prototype.evaluate=function(Ae){var Fe=this.lhs.evaluate(Ae),$e=this.rhs.evaluate(Ae);if(te&&this.hasUntypedArgument){var ft=ao(Fe),dt=ao($e);if(ft.kind!==dt.kind||!(ft.kind==="string"||ft.kind==="number"))throw new Si('Expected arguments for "'+C+'" to be (string, string) or (number, number), but found ('+ft.kind+", "+dt.kind+") instead.")}if(this.collator&&!te&&this.hasUntypedArgument){var Pt=ao(Fe),Jt=ao($e);if(Pt.kind!=="string"||Jt.kind!=="string")return L(Ae,Fe,$e)}return this.collator?N(Ae,Fe,$e,this.collator.evaluate(Ae)):L(Ae,Fe,$e)},ce.prototype.eachChild=function(Ae){Ae(this.lhs),Ae(this.rhs),this.collator&&Ae(this.collator)},ce.prototype.outputDefined=function(){return!0},ce.prototype.serialize=function(){var Ae=[C];return this.eachChild(function(Fe){Ae.push(Fe.serialize())}),Ae},ce}()}var Fn=yn("==",Wl,Er),Pn=yn("!=",mu,en),Gn=yn("<",gt,pn),$n=yn(">",Dt,An),Ha=yn("<=",or,Ln),La=yn(">=",er,Hn),Fa=function(L,N,te,ce,me){this.type=Pr,this.number=L,this.locale=N,this.currency=te,this.minFractionDigits=ce,this.maxFractionDigits=me};Fa.parse=function(L,N){if(L.length!==3)return N.error("Expected two arguments.");var te=N.parse(L[1],1,pr);if(!te)return null;var ce=L[2];if(typeof ce!="object"||Array.isArray(ce))return N.error("NumberFormat options argument must be an object.");var me=null;if(ce.locale&&(me=N.parse(ce.locale,1,Pr),!me))return null;var Ae=null;if(ce.currency&&(Ae=N.parse(ce.currency,1,Pr),!Ae))return null;var Fe=null;if(ce["min-fraction-digits"]&&(Fe=N.parse(ce["min-fraction-digits"],1,pr),!Fe))return null;var $e=null;return ce["max-fraction-digits"]&&($e=N.parse(ce["max-fraction-digits"],1,pr),!$e)?null:new Fa(te,me,Ae,Fe,$e)},Fa.prototype.evaluate=function(L){return new Intl.NumberFormat(this.locale?this.locale.evaluate(L):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(L):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(L):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(L):void 0}).format(this.number.evaluate(L))},Fa.prototype.eachChild=function(L){L(this.number),this.locale&&L(this.locale),this.currency&&L(this.currency),this.minFractionDigits&&L(this.minFractionDigits),this.maxFractionDigits&&L(this.maxFractionDigits)},Fa.prototype.outputDefined=function(){return!1},Fa.prototype.serialize=function(){var L={};return this.locale&&(L.locale=this.locale.serialize()),this.currency&&(L.currency=this.currency.serialize()),this.minFractionDigits&&(L["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(L["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),L]};var Na=function(L){this.type=pr,this.input=L};Na.parse=function(L,N){if(L.length!==2)return N.error("Expected 1 argument, but found "+(L.length-1)+" instead.");var te=N.parse(L[1],1);return te?te.type.kind!=="array"&&te.type.kind!=="string"&&te.type.kind!=="value"?N.error("Expected argument of type string or array, but found "+Aa(te.type)+" instead."):new Na(te):null},Na.prototype.evaluate=function(L){var N=this.input.evaluate(L);if(typeof N=="string")return N.length;if(Array.isArray(N))return N.length;throw new Si("Expected value to be of type string or array, but found "+Aa(ao(N))+" instead.")},Na.prototype.eachChild=function(L){L(this.input)},Na.prototype.outputDefined=function(){return!1},Na.prototype.serialize=function(){var L=["length"];return this.eachChild(function(N){L.push(N.serialize())}),L};var qn={"==":Fn,"!=":Pn,">":$n,"<":Gn,">=":La,"<=":Ha,array:oo,at:Js,boolean:oo,case:wo,coalesce:qo,collator:_s,format:$o,image:Go,in:Rs,"index-of":ds,interpolate:co,"interpolate-hcl":co,"interpolate-lab":co,length:Na,let:Ds,literal:io,match:Ji,number:oo,"number-format":Fa,object:oo,slice:Zo,step:As,string:oo,"to-boolean":Yo,"to-color":Yo,"to-number":Yo,"to-string":Yo,var:as,within:Wo};function va(C,L){var N=L[0],te=L[1],ce=L[2],me=L[3];N=N.evaluate(C),te=te.evaluate(C),ce=ce.evaluate(C);var Ae=me?me.evaluate(C):1,Fe=Fl(N,te,ce,Ae);if(Fe)throw new Si(Fe);return new mi(N/255*Ae,te/255*Ae,ce/255*Ae,Ae)}function ja(C,L){return C in L}function qa(C,L){var N=L[C];return typeof N>"u"?null:N}function Ti(C,L,N,te){for(;N<=te;){var ce=N+te>>1;if(L[ce]===C)return!0;L[ce]>C?te=ce-1:N=ce+1}return!1}function xi(C){return{type:C}}Co.register(qn,{error:[Zn,[Pr],function(C,L){var N=L[0];throw new Si(N.evaluate(C))}],typeof:[Pr,[bn],function(C,L){var N=L[0];return Aa(ao(N.evaluate(C)))}],"to-rgba":[ua(pr,4),[Un],function(C,L){var N=L[0];return N.evaluate(C).toArray()}],rgb:[Un,[pr,pr,pr],va],rgba:[Un,[pr,pr,pr,pr],va],has:{type:dn,overloads:[[[Pr],function(C,L){var N=L[0];return ja(N.evaluate(C),C.properties())}],[[Pr,ra],function(C,L){var N=L[0],te=L[1];return ja(N.evaluate(C),te.evaluate(C))}]]},get:{type:bn,overloads:[[[Pr],function(C,L){var N=L[0];return qa(N.evaluate(C),C.properties())}],[[Pr,ra],function(C,L){var N=L[0],te=L[1];return qa(N.evaluate(C),te.evaluate(C))}]]},"feature-state":[bn,[Pr],function(C,L){var N=L[0];return qa(N.evaluate(C),C.featureState||{})}],properties:[ra,[],function(C){return C.properties()}],"geometry-type":[Pr,[],function(C){return C.geometryType()}],id:[bn,[],function(C){return C.id()}],zoom:[pr,[],function(C){return C.globals.zoom}],"heatmap-density":[pr,[],function(C){return C.globals.heatmapDensity||0}],"line-progress":[pr,[],function(C){return C.globals.lineProgress||0}],accumulated:[bn,[],function(C){return C.globals.accumulated===void 0?null:C.globals.accumulated}],"+":[pr,xi(pr),function(C,L){for(var N=0,te=0,ce=L;te<ce.length;te+=1){var me=ce[te];N+=me.evaluate(C)}return N}],"*":[pr,xi(pr),function(C,L){for(var N=1,te=0,ce=L;te<ce.length;te+=1){var me=ce[te];N*=me.evaluate(C)}return N}],"-":{type:pr,overloads:[[[pr,pr],function(C,L){var N=L[0],te=L[1];return N.evaluate(C)-te.evaluate(C)}],[[pr],function(C,L){var N=L[0];return-N.evaluate(C)}]]},"/":[pr,[pr,pr],function(C,L){var N=L[0],te=L[1];return N.evaluate(C)/te.evaluate(C)}],"%":[pr,[pr,pr],function(C,L){var N=L[0],te=L[1];return N.evaluate(C)%te.evaluate(C)}],ln2:[pr,[],function(){return Math.LN2}],pi:[pr,[],function(){return Math.PI}],e:[pr,[],function(){return Math.E}],"^":[pr,[pr,pr],function(C,L){var N=L[0],te=L[1];return Math.pow(N.evaluate(C),te.evaluate(C))}],sqrt:[pr,[pr],function(C,L){var N=L[0];return Math.sqrt(N.evaluate(C))}],log10:[pr,[pr],function(C,L){var N=L[0];return Math.log(N.evaluate(C))/Math.LN10}],ln:[pr,[pr],function(C,L){var N=L[0];return Math.log(N.evaluate(C))}],log2:[pr,[pr],function(C,L){var N=L[0];return Math.log(N.evaluate(C))/Math.LN2}],sin:[pr,[pr],function(C,L){var N=L[0];return Math.sin(N.evaluate(C))}],cos:[pr,[pr],function(C,L){var N=L[0];return Math.cos(N.evaluate(C))}],tan:[pr,[pr],function(C,L){var N=L[0];return Math.tan(N.evaluate(C))}],asin:[pr,[pr],function(C,L){var N=L[0];return Math.asin(N.evaluate(C))}],acos:[pr,[pr],function(C,L){var N=L[0];return Math.acos(N.evaluate(C))}],atan:[pr,[pr],function(C,L){var N=L[0];return Math.atan(N.evaluate(C))}],min:[pr,xi(pr),function(C,L){return Math.min.apply(Math,L.map(function(N){return N.evaluate(C)}))}],max:[pr,xi(pr),function(C,L){return Math.max.apply(Math,L.map(function(N){return N.evaluate(C)}))}],abs:[pr,[pr],function(C,L){var N=L[0];return Math.abs(N.evaluate(C))}],round:[pr,[pr],function(C,L){var N=L[0],te=N.evaluate(C);return te<0?-Math.round(-te):Math.round(te)}],floor:[pr,[pr],function(C,L){var N=L[0];return Math.floor(N.evaluate(C))}],ceil:[pr,[pr],function(C,L){var N=L[0];return Math.ceil(N.evaluate(C))}],"filter-==":[dn,[Pr,bn],function(C,L){var N=L[0],te=L[1];return C.properties()[N.value]===te.value}],"filter-id-==":[dn,[bn],function(C,L){var N=L[0];return C.id()===N.value}],"filter-type-==":[dn,[Pr],function(C,L){var N=L[0];return C.geometryType()===N.value}],"filter-<":[dn,[Pr,bn],function(C,L){var N=L[0],te=L[1],ce=C.properties()[N.value],me=te.value;return typeof ce==typeof me&&ce<me}],"filter-id-<":[dn,[bn],function(C,L){var N=L[0],te=C.id(),ce=N.value;return typeof te==typeof ce&&te<ce}],"filter->":[dn,[Pr,bn],function(C,L){var N=L[0],te=L[1],ce=C.properties()[N.value],me=te.value;return typeof ce==typeof me&&ce>me}],"filter-id->":[dn,[bn],function(C,L){var N=L[0],te=C.id(),ce=N.value;return typeof te==typeof ce&&te>ce}],"filter-<=":[dn,[Pr,bn],function(C,L){var N=L[0],te=L[1],ce=C.properties()[N.value],me=te.value;return typeof ce==typeof me&&ce<=me}],"filter-id-<=":[dn,[bn],function(C,L){var N=L[0],te=C.id(),ce=N.value;return typeof te==typeof ce&&te<=ce}],"filter->=":[dn,[Pr,bn],function(C,L){var N=L[0],te=L[1],ce=C.properties()[N.value],me=te.value;return typeof ce==typeof me&&ce>=me}],"filter-id->=":[dn,[bn],function(C,L){var N=L[0],te=C.id(),ce=N.value;return typeof te==typeof ce&&te>=ce}],"filter-has":[dn,[bn],function(C,L){var N=L[0];return N.value in C.properties()}],"filter-has-id":[dn,[],function(C){return C.id()!==null&&C.id()!==void 0}],"filter-type-in":[dn,[ua(Pr)],function(C,L){var N=L[0];return N.value.indexOf(C.geometryType())>=0}],"filter-id-in":[dn,[ua(bn)],function(C,L){var N=L[0];return N.value.indexOf(C.id())>=0}],"filter-in-small":[dn,[Pr,ua(bn)],function(C,L){var N=L[0],te=L[1];return te.value.indexOf(C.properties()[N.value])>=0}],"filter-in-large":[dn,[Pr,ua(bn)],function(C,L){var N=L[0],te=L[1];return Ti(C.properties()[N.value],te.value,0,te.value.length-1)}],all:{type:dn,overloads:[[[dn,dn],function(C,L){var N=L[0],te=L[1];return N.evaluate(C)&&te.evaluate(C)}],[xi(dn),function(C,L){for(var N=0,te=L;N<te.length;N+=1){var ce=te[N];if(!ce.evaluate(C))return!1}return!0}]]},any:{type:dn,overloads:[[[dn,dn],function(C,L){var N=L[0],te=L[1];return N.evaluate(C)||te.evaluate(C)}],[xi(dn),function(C,L){for(var N=0,te=L;N<te.length;N+=1){var ce=te[N];if(ce.evaluate(C))return!0}return!1}]]},"!":[dn,[dn],function(C,L){var N=L[0];return!N.evaluate(C)}],"is-supported-script":[dn,[Pr],function(C,L){var N=L[0],te=C.globals&&C.globals.isSupportedScript;return te?te(N.evaluate(C)):!0}],upcase:[Pr,[Pr],function(C,L){var N=L[0];return N.evaluate(C).toUpperCase()}],downcase:[Pr,[Pr],function(C,L){var N=L[0];return N.evaluate(C).toLowerCase()}],concat:[Pr,xi(bn),function(C,L){return L.map(function(N){return Ys(N.evaluate(C))}).join("")}],"resolved-locale":[Pr,[sa],function(C,L){var N=L[0];return N.evaluate(C).resolvedLocale()}]});function bi(C){return{result:"success",value:C}}function Di(C){return{result:"error",value:C}}function li(C){return C["property-type"]==="data-driven"||C["property-type"]==="cross-faded-data-driven"}function To(C){return!!C.expression&&C.expression.parameters.indexOf("zoom")>-1}function so(C){return!!C.expression&&C.expression.interpolated}function ti(C){return C instanceof Number?"number":C instanceof String?"string":C instanceof Boolean?"boolean":Array.isArray(C)?"array":C===null?"null":typeof C}function pa(C){return typeof C=="object"&&C!==null&&!Array.isArray(C)}function Ai(C){return C}function vo(C,L){var N=L.type==="color",te=C.stops&&typeof C.stops[0][0]=="object",ce=te||C.property!==void 0,me=te||!ce,Ae=C.type||(so(L)?"exponential":"interval");if(N&&(C=vn({},C),C.stops&&(C.stops=C.stops.map(function(ia){return[ia[0],mi.parse(ia[1])]})),C.default?C.default=mi.parse(C.default):C.default=mi.parse(L.default)),C.colorSpace&&C.colorSpace!=="rgb"&&!Gl[C.colorSpace])throw new Error("Unknown color space: "+C.colorSpace);var Fe,$e,ft;if(Ae==="exponential")Fe=ls;else if(Ae==="interval")Fe=Ss;else if(Ae==="categorical"){Fe=ss,$e=Object.create(null);for(var dt=0,Pt=C.stops;dt<Pt.length;dt+=1){var Jt=Pt[dt];$e[Jt[0]]=Jt[1]}ft=typeof C.stops[0][0]}else if(Ae==="identity")Fe=hl;else throw new Error('Unknown function type "'+Ae+'"');if(te){for(var Yt={},ur=[],Dr=0;Dr<C.stops.length;Dr++){var rn=C.stops[Dr],Jr=rn[0].zoom;Yt[Jr]===void 0&&(Yt[Jr]={zoom:Jr,type:C.type,property:C.property,default:C.default,stops:[]},ur.push(Jr)),Yt[Jr].stops.push([rn[0].value,rn[1]])}for(var kn=[],mn=0,Mn=ur;mn<Mn.length;mn+=1){var zn=Mn[mn];kn.push([Yt[zn].zoom,vo(Yt[zn],L)])}var Yn={name:"linear"};return{kind:"composite",interpolationType:Yn,interpolationFactor:co.interpolationFactor.bind(void 0,Yn),zoomStops:kn.map(function(ia){return ia[0]}),evaluate:function(Ba,_a){var Sa=Ba.zoom;return ls({stops:kn,base:C.base},L,Sa).evaluate(Sa,_a)}}}else if(me){var la=Ae==="exponential"?{name:"exponential",base:C.base!==void 0?C.base:1}:null;return{kind:"camera",interpolationType:la,interpolationFactor:co.interpolationFactor.bind(void 0,la),zoomStops:C.stops.map(function(ia){return ia[0]}),evaluate:function(ia){var Ba=ia.zoom;return Fe(C,L,Ba,$e,ft)}}}else return{kind:"source",evaluate:function(Ba,_a){var Sa=_a&&_a.properties?_a.properties[C.property]:void 0;return Sa===void 0?xo(C.default,L.default):Fe(C,L,Sa,$e,ft)}}}function xo(C,L,N){if(C!==void 0)return C;if(L!==void 0)return L;if(N!==void 0)return N}function ss(C,L,N,te,ce){var me=typeof N===ce?te[N]:void 0;return xo(me,C.default,L.default)}function Ss(C,L,N){if(ti(N)!=="number")return xo(C.default,L.default);var te=C.stops.length;if(te===1||N<=C.stops[0][0])return C.stops[0][1];if(N>=C.stops[te-1][0])return C.stops[te-1][1];var ce=Ps(C.stops.map(function(me){return me[0]}),N);return C.stops[ce][1]}function ls(C,L,N){var te=C.base!==void 0?C.base:1;if(ti(N)!=="number")return xo(C.default,L.default);var ce=C.stops.length;if(ce===1||N<=C.stops[0][0])return C.stops[0][1];if(N>=C.stops[ce-1][0])return C.stops[ce-1][1];var me=Ps(C.stops.map(function(Pt){return Pt[0]}),N),Ae=gs(N,te,C.stops[me][0],C.stops[me+1][0]),Fe=C.stops[me][1],$e=C.stops[me+1][1],ft=nu[L.type]||Ai;if(C.colorSpace&&C.colorSpace!=="rgb"){var dt=Gl[C.colorSpace];ft=function(Pt,Jt){return dt.reverse(dt.interpolate(dt.forward(Pt),dt.forward(Jt),Ae))}}return typeof Fe.evaluate=="function"?{evaluate:function(){for(var Jt=[],Yt=arguments.length;Yt--;)Jt[Yt]=arguments[Yt];var ur=Fe.evaluate.apply(void 0,Jt),Dr=$e.evaluate.apply(void 0,Jt);if(!(ur===void 0||Dr===void 0))return ft(ur,Dr,Ae)}}:ft(Fe,$e,Ae)}function hl(C,L,N){return L.type==="color"?N=mi.parse(N):L.type==="formatted"?N=no.fromString(N.toString()):L.type==="resolvedImage"?N=ko.fromString(N.toString()):ti(N)!==L.type&&(L.type!=="enum"||!L.values[N])&&(N=void 0),xo(N,C.default,L.default)}function gs(C,L,N,te){var ce=te-N,me=C-N;return ce===0?0:L===1?me/ce:(Math.pow(L,me)-1)/(Math.pow(L,ce)-1)}var ys=function(L,N){this.expression=L,this._warningHistory={},this._evaluator=new Ws,this._defaultValue=N?Bu(N):null,this._enumValues=N&&N.type==="enum"?N.values:null};ys.prototype.evaluateWithoutErrorHandling=function(L,N,te,ce,me,Ae){return this._evaluator.globals=L,this._evaluator.feature=N,this._evaluator.featureState=te,this._evaluator.canonical=ce,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=Ae,this.expression.evaluate(this._evaluator)},ys.prototype.evaluate=function(L,N,te,ce,me,Ae){this._evaluator.globals=L,this._evaluator.feature=N||null,this._evaluator.featureState=te||null,this._evaluator.canonical=ce,this._evaluator.availableImages=me||null,this._evaluator.formattedSection=Ae||null;try{var Fe=this.expression.evaluate(this._evaluator);if(Fe==null||typeof Fe=="number"&&Fe!==Fe)return this._defaultValue;if(this._enumValues&&!(Fe in this._enumValues))throw new Si("Expected value to be one of "+Object.keys(this._enumValues).map(function($e){return JSON.stringify($e)}).join(", ")+", but found "+JSON.stringify(Fe)+" instead.");return Fe}catch($e){return this._warningHistory[$e.message]||(this._warningHistory[$e.message]=!0,typeof console<"u"&&console.warn($e.message)),this._defaultValue}};function Is(C){return Array.isArray(C)&&C.length>0&&typeof C[0]=="string"&&C[0]in qn}function vl(C,L){var N=new Lo(qn,[],L?nf(L):void 0),te=N.parse(C,void 0,void 0,void 0,L&&L.type==="string"?{typeAnnotation:"coerce"}:void 0);return te?bi(new ys(te,L)):Di(N.errors)}var pl=function(L,N){this.kind=L,this._styleExpression=N,this.isStateDependent=L!=="constant"&&!sl(N.expression)};pl.prototype.evaluateWithoutErrorHandling=function(L,N,te,ce,me,Ae){return this._styleExpression.evaluateWithoutErrorHandling(L,N,te,ce,me,Ae)},pl.prototype.evaluate=function(L,N,te,ce,me,Ae){return this._styleExpression.evaluate(L,N,te,ce,me,Ae)};var ms=function(L,N,te,ce){this.kind=L,this.zoomStops=te,this._styleExpression=N,this.isStateDependent=L!=="camera"&&!sl(N.expression),this.interpolationType=ce};ms.prototype.evaluateWithoutErrorHandling=function(L,N,te,ce,me,Ae){return this._styleExpression.evaluateWithoutErrorHandling(L,N,te,ce,me,Ae)},ms.prototype.evaluate=function(L,N,te,ce,me,Ae){return this._styleExpression.evaluate(L,N,te,ce,me,Ae)},ms.prototype.interpolationFactor=function(L,N,te){return this.interpolationType?co.interpolationFactor(this.interpolationType,L,N,te):0};function Ou(C,L){if(C=vl(C,L),C.result==="error")return C;var N=C.value.expression,te=kl(N);if(!te&&!li(L))return Di([new _n("","data expressions not supported")]);var ce=ru(N,["zoom"]);if(!ce&&!To(L))return Di([new _n("","zoom expressions not supported")]);var me=xu(N);if(!me&&!ce)return Di([new _n("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(me instanceof _n)return Di([me]);if(me instanceof co&&!so(L))return Di([new _n("",'"interpolate" expressions cannot be used with this property')]);if(!me)return bi(te?new pl("constant",C.value):new pl("source",C.value));var Ae=me instanceof co?me.interpolation:void 0;return bi(te?new ms("camera",C.value,me.labels,Ae):new ms("composite",C.value,me.labels,Ae))}var dl=function(L,N){this._parameters=L,this._specification=N,vn(this,vo(this._parameters,this._specification))};dl.deserialize=function(L){return new dl(L._parameters,L._specification)},dl.serialize=function(L){return{_parameters:L._parameters,_specification:L._specification}};function zs(C,L){if(pa(C))return new dl(C,L);if(Is(C)){var N=Ou(C,L);if(N.result==="error")throw new Error(N.value.map(function(ce){return ce.key+": "+ce.message}).join(", "));return N.value}else{var te=C;return typeof C=="string"&&L.type==="color"&&(te=mi.parse(C)),{kind:"constant",evaluate:function(){return te}}}}function xu(C){var L=null;if(C instanceof Ds)L=xu(C.result);else if(C instanceof qo)for(var N=0,te=C.args;N<te.length;N+=1){var ce=te[N];if(L=xu(ce),L)break}else(C instanceof As||C instanceof co)&&C.input instanceof Co&&C.input.name==="zoom"&&(L=C);return L instanceof _n||C.eachChild(function(me){var Ae=xu(me);Ae instanceof _n?L=Ae:!L&&Ae?L=new _n("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):L&&Ae&&L!==Ae&&(L=new _n("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),L}function nf(C){var L={color:Un,string:Pr,number:pr,enum:Pr,boolean:dn,formatted:ga,resolvedImage:wa};return C.type==="array"?ua(L[C.value]||bn,C.length):L[C.type]}function Bu(C){return C.type==="color"&&pa(C.default)?new mi(0,0,0,0):C.type==="color"?mi.parse(C.default)||null:C.default===void 0?null:C.default}function xs(C){var L=C.key,N=C.value,te=C.valueSpec||{},ce=C.objectElementValidators||{},me=C.style,Ae=C.styleSpec,Fe=[],$e=ti(N);if($e!=="object")return[new cr(L,N,"object expected, "+$e+" found")];for(var ft in N){var dt=ft.split(".")[0],Pt=te[dt]||te["*"],Jt=void 0;if(ce[dt])Jt=ce[dt];else if(te[dt])Jt=yi;else if(ce["*"])Jt=ce["*"];else if(te["*"])Jt=yi;else{Fe.push(new cr(L,N[ft],'unknown property "'+ft+'"'));continue}Fe=Fe.concat(Jt({key:(L&&L+".")+ft,value:N[ft],valueSpec:Pt,style:me,styleSpec:Ae,object:N,objectKey:ft},N))}for(var Yt in te)ce[Yt]||te[Yt].required&&te[Yt].default===void 0&&N[Yt]===void 0&&Fe.push(new cr(L,N,'missing required property "'+Yt+'"'));return Fe}function Ku(C){var L=C.value,N=C.valueSpec,te=C.style,ce=C.styleSpec,me=C.key,Ae=C.arrayElementValidator||yi;if(ti(L)!=="array")return[new cr(me,L,"array expected, "+ti(L)+" found")];if(N.length&&L.length!==N.length)return[new cr(me,L,"array length "+N.length+" expected, length "+L.length+" found")];if(N["min-length"]&&L.length<N["min-length"])return[new cr(me,L,"array length at least "+N["min-length"]+" expected, length "+L.length+" found")];var Fe={type:N.value,values:N.values};ce.$version<7&&(Fe.function=N.function),ti(N.value)==="object"&&(Fe=N.value);for(var $e=[],ft=0;ft<L.length;ft++)$e=$e.concat(Ae({array:L,arrayIndex:ft,value:L[ft],valueSpec:Fe,style:te,styleSpec:ce,key:me+"["+ft+"]"}));return $e}function Nu(C){var L=C.key,N=C.value,te=C.valueSpec,ce=ti(N);return ce==="number"&&N!==N&&(ce="NaN"),ce!=="number"?[new cr(L,N,"number expected, "+ce+" found")]:"minimum"in te&&N<te.minimum?[new cr(L,N,N+" is less than the minimum value "+te.minimum)]:"maximum"in te&&N>te.maximum?[new cr(L,N,N+" is greater than the maximum value "+te.maximum)]:[]}function Uu(C){var L=C.valueSpec,N=on(C.value.type),te,ce={},me,Ae,Fe=N!=="categorical"&&C.value.property===void 0,$e=!Fe,ft=ti(C.value.stops)==="array"&&ti(C.value.stops[0])==="array"&&ti(C.value.stops[0][0])==="object",dt=xs({key:C.key,value:C.value,valueSpec:C.styleSpec.function,style:C.style,styleSpec:C.styleSpec,objectElementValidators:{stops:Pt,default:ur}});return N==="identity"&&Fe&&dt.push(new cr(C.key,C.value,'missing required property "property"')),N!=="identity"&&!C.value.stops&&dt.push(new cr(C.key,C.value,'missing required property "stops"')),N==="exponential"&&C.valueSpec.expression&&!so(C.valueSpec)&&dt.push(new cr(C.key,C.value,"exponential functions not supported")),C.styleSpec.$version>=8&&($e&&!li(C.valueSpec)?dt.push(new cr(C.key,C.value,"property functions not supported")):Fe&&!To(C.valueSpec)&&dt.push(new cr(C.key,C.value,"zoom functions not supported"))),(N==="categorical"||ft)&&C.value.property===void 0&&dt.push(new cr(C.key,C.value,'"property" property is required')),dt;function Pt(Dr){if(N==="identity")return[new cr(Dr.key,Dr.value,'identity function may not have a "stops" property')];var rn=[],Jr=Dr.value;return rn=rn.concat(Ku({key:Dr.key,value:Jr,valueSpec:Dr.valueSpec,style:Dr.style,styleSpec:Dr.styleSpec,arrayElementValidator:Jt})),ti(Jr)==="array"&&Jr.length===0&&rn.push(new cr(Dr.key,Jr,"array must have at least one stop")),rn}function Jt(Dr){var rn=[],Jr=Dr.value,kn=Dr.key;if(ti(Jr)!=="array")return[new cr(kn,Jr,"array expected, "+ti(Jr)+" found")];if(Jr.length!==2)return[new cr(kn,Jr,"array length 2 expected, length "+Jr.length+" found")];if(ft){if(ti(Jr[0])!=="object")return[new cr(kn,Jr,"object expected, "+ti(Jr[0])+" found")];if(Jr[0].zoom===void 0)return[new cr(kn,Jr,"object stop key must have zoom")];if(Jr[0].value===void 0)return[new cr(kn,Jr,"object stop key must have value")];if(Ae&&Ae>on(Jr[0].zoom))return[new cr(kn,Jr[0].zoom,"stop zoom values must appear in ascending order")];on(Jr[0].zoom)!==Ae&&(Ae=on(Jr[0].zoom),me=void 0,ce={}),rn=rn.concat(xs({key:kn+"[0]",value:Jr[0],valueSpec:{zoom:{}},style:Dr.style,styleSpec:Dr.styleSpec,objectElementValidators:{zoom:Nu,value:Yt}}))}else rn=rn.concat(Yt({key:kn+"[0]",value:Jr[0],valueSpec:{},style:Dr.style,styleSpec:Dr.styleSpec},Jr));return Is(Cn(Jr[1]))?rn.concat([new cr(kn+"[1]",Jr[1],"expressions are not allowed in function stops.")]):rn.concat(yi({key:kn+"[1]",value:Jr[1],valueSpec:L,style:Dr.style,styleSpec:Dr.styleSpec}))}function Yt(Dr,rn){var Jr=ti(Dr.value),kn=on(Dr.value),mn=Dr.value!==null?Dr.value:rn;if(!te)te=Jr;else if(Jr!==te)return[new cr(Dr.key,mn,Jr+" stop domain type must match previous stop domain type "+te)];if(Jr!=="number"&&Jr!=="string"&&Jr!=="boolean")return[new cr(Dr.key,mn,"stop domain value must be a number, string, or boolean")];if(Jr!=="number"&&N!=="categorical"){var Mn="number expected, "+Jr+" found";return li(L)&&N===void 0&&(Mn+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new cr(Dr.key,mn,Mn)]}return N==="categorical"&&Jr==="number"&&(!isFinite(kn)||Math.floor(kn)!==kn)?[new cr(Dr.key,mn,"integer expected, found "+kn)]:N!=="categorical"&&Jr==="number"&&me!==void 0&&kn<me?[new cr(Dr.key,mn,"stop domain values must appear in ascending order")]:(me=kn,N==="categorical"&&kn in ce?[new cr(Dr.key,mn,"stop domain values must be unique")]:(ce[kn]=!0,[]))}function ur(Dr){return yi({key:Dr.key,value:Dr.value,valueSpec:L,style:Dr.style,styleSpec:Dr.styleSpec})}}function yl(C){var L=(C.expressionContext==="property"?Ou:vl)(Cn(C.value),C.valueSpec);if(L.result==="error")return L.value.map(function(te){return new cr(""+C.key+te.key,C.value,te.message)});var N=L.value.expression||L.value._styleExpression.expression;if(C.expressionContext==="property"&&C.propertyKey==="text-font"&&!N.outputDefined())return[new cr(C.key,C.value,'Invalid data expression for "'+C.propertyKey+'". Output values must be contained as literals within the expression.')];if(C.expressionContext==="property"&&C.propertyType==="layout"&&!sl(N))return[new cr(C.key,C.value,'"feature-state" data expressions are not supported with layout properties.')];if(C.expressionContext==="filter"&&!sl(N))return[new cr(C.key,C.value,'"feature-state" data expressions are not supported with filters.')];if(C.expressionContext&&C.expressionContext.indexOf("cluster")===0){if(!ru(N,["zoom","feature-state"]))return[new cr(C.key,C.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(C.expressionContext==="cluster-initial"&&!kl(N))return[new cr(C.key,C.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function bu(C){var L=C.value,N=C.key,te=ti(L);return te!=="boolean"?[new cr(N,L,"boolean expected, "+te+" found")]:[]}function af(C){var L=C.key,N=C.value,te=ti(N);return te!=="string"?[new cr(L,N,"color expected, "+te+" found")]:Tl(N)===null?[new cr(L,N,'color expected, "'+N+'" found')]:[]}function su(C){var L=C.key,N=C.value,te=C.valueSpec,ce=[];return Array.isArray(te.values)?te.values.indexOf(on(N))===-1&&ce.push(new cr(L,N,"expected one of ["+te.values.join(", ")+"], "+JSON.stringify(N)+" found")):Object.keys(te.values).indexOf(on(N))===-1&&ce.push(new cr(L,N,"expected one of ["+Object.keys(te.values).join(", ")+"], "+JSON.stringify(N)+" found")),ce}function Ju(C){if(C===!0||C===!1)return!0;if(!Array.isArray(C)||C.length===0)return!1;switch(C[0]){case"has":return C.length>=2&&C[1]!=="$id"&&C[1]!=="$type";case"in":return C.length>=3&&(typeof C[1]!="string"||Array.isArray(C[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return C.length!==3||Array.isArray(C[1])||Array.isArray(C[2]);case"any":case"all":for(var L=0,N=C.slice(1);L<N.length;L+=1){var te=N[L];if(!Ju(te)&&typeof te!="boolean")return!1}return!0;default:return!0}}var Qu={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function es(C){if(C==null)return{filter:function(){return!0},needGeometry:!1};Ju(C)||(C=qe(C));var L=vl(C,Qu);if(L.result==="error")throw new Error(L.value.map(function(te){return te.key+": "+te.message}).join(", "));var N=Ye(C);return{filter:function(te,ce,me){return L.value.evaluate(te,ce,{},me)},needGeometry:N}}function ze(C,L){return C<L?-1:C>L?1:0}function Ye(C){if(!Array.isArray(C))return!1;if(C[0]==="within")return!0;for(var L=1;L<C.length;L++)if(Ye(C[L]))return!0;return!1}function qe(C){if(!C)return!0;var L=C[0];if(C.length<=1)return L!=="any";var N=L==="=="?st(C[1],C[2],"=="):L==="!="?ar(st(C[1],C[2],"==")):L==="<"||L===">"||L==="<="||L===">="?st(C[1],C[2],L):L==="any"?mt(C.slice(1)):L==="all"?["all"].concat(C.slice(1).map(qe)):L==="none"?["all"].concat(C.slice(1).map(qe).map(ar)):L==="in"?yt(C[1],C.slice(2)):L==="!in"?ar(yt(C[1],C.slice(2))):L==="has"?Tt(C[1]):L==="!has"?ar(Tt(C[1])):L==="within"?C:!0;return N}function st(C,L,N){switch(C){case"$type":return["filter-type-"+N,L];case"$id":return["filter-id-"+N,L];default:return["filter-"+N,C,L]}}function mt(C){return["any"].concat(C.map(qe))}function yt(C,L){if(L.length===0)return!1;switch(C){case"$type":return["filter-type-in",["literal",L]];case"$id":return["filter-id-in",["literal",L]];default:return L.length>200&&!L.some(function(N){return typeof N!=typeof L[0]})?["filter-in-large",C,["literal",L.sort(ze)]]:["filter-in-small",C,["literal",L]]}}function Tt(C){switch(C){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",C]}}function ar(C){return["!",C]}function lr(C){return Ju(Cn(C.value))?yl(vn({},C,{expressionContext:"filter",valueSpec:{value:"boolean"}})):rr(C)}function rr(C){var L=C.value,N=C.key;if(ti(L)!=="array")return[new cr(N,L,"array expected, "+ti(L)+" found")];var te=C.styleSpec,ce,me=[];if(L.length<1)return[new cr(N,L,"filter array must have at least 1 element")];switch(me=me.concat(su({key:N+"[0]",value:L[0],valueSpec:te.filter_operator,style:C.style,styleSpec:C.styleSpec})),on(L[0])){case"<":case"<=":case">":case">=":L.length>=2&&on(L[1])==="$type"&&me.push(new cr(N,L,'"$type" cannot be use with operator "'+L[0]+'"'));case"==":case"!=":L.length!==3&&me.push(new cr(N,L,'filter array for operator "'+L[0]+'" must have 3 elements'));case"in":case"!in":L.length>=2&&(ce=ti(L[1]),ce!=="string"&&me.push(new cr(N+"[1]",L[1],"string expected, "+ce+" found")));for(var Ae=2;Ae<L.length;Ae++)ce=ti(L[Ae]),on(L[1])==="$type"?me=me.concat(su({key:N+"["+Ae+"]",value:L[Ae],valueSpec:te.geometry_type,style:C.style,styleSpec:C.styleSpec})):ce!=="string"&&ce!=="number"&&ce!=="boolean"&&me.push(new cr(N+"["+Ae+"]",L[Ae],"string, number, or boolean expected, "+ce+" found"));break;case"any":case"all":case"none":for(var Fe=1;Fe<L.length;Fe++)me=me.concat(rr({key:N+"["+Fe+"]",value:L[Fe],style:C.style,styleSpec:C.styleSpec}));break;case"has":case"!has":ce=ti(L[1]),L.length!==2?me.push(new cr(N,L,'filter array for "'+L[0]+'" operator must have 2 elements')):ce!=="string"&&me.push(new cr(N+"[1]",L[1],"string expected, "+ce+" found"));break;case"within":ce=ti(L[1]),L.length!==2?me.push(new cr(N,L,'filter array for "'+L[0]+'" operator must have 2 elements')):ce!=="object"&&me.push(new cr(N+"[1]",L[1],"object expected, "+ce+" found"));break}return me}function hr(C,L){var N=C.key,te=C.style,ce=C.styleSpec,me=C.value,Ae=C.objectKey,Fe=ce[L+"_"+C.layerType];if(!Fe)return[];var $e=Ae.match(/^(.*)-transition$/);if(L==="paint"&&$e&&Fe[$e[1]]&&Fe[$e[1]].transition)return yi({key:N,value:me,valueSpec:ce.transition,style:te,styleSpec:ce});var ft=C.valueSpec||Fe[Ae];if(!ft)return[new cr(N,me,'unknown property "'+Ae+'"')];var dt;if(ti(me)==="string"&&li(ft)&&!ft.tokens&&(dt=/^{([^}]+)}$/.exec(me)))return[new cr(N,me,'"'+Ae+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(dt[1])+" }`.")];var Pt=[];return C.layerType==="symbol"&&(Ae==="text-field"&&te&&!te.glyphs&&Pt.push(new cr(N,me,'use of "text-field" requires a style "glyphs" property')),Ae==="text-font"&&pa(Cn(me))&&on(me.type)==="identity"&&Pt.push(new cr(N,me,'"text-font" does not support identity functions'))),Pt.concat(yi({key:C.key,value:me,valueSpec:ft,style:te,styleSpec:ce,expressionContext:"property",propertyType:L,propertyKey:Ae}))}function kr(C){return hr(C,"paint")}function Yr(C){return hr(C,"layout")}function $r(C){var L=[],N=C.value,te=C.key,ce=C.style,me=C.styleSpec;!N.type&&!N.ref&&L.push(new cr(te,N,'either "type" or "ref" is required'));var Ae=on(N.type),Fe=on(N.ref);if(N.id)for(var $e=on(N.id),ft=0;ft<C.arrayIndex;ft++){var dt=ce.layers[ft];on(dt.id)===$e&&L.push(new cr(te,N.id,'duplicate layer id "'+N.id+'", previously used at line '+dt.id.__line__))}if("ref"in N){["type","source","source-layer","filter","layout"].forEach(function(ur){ur in N&&L.push(new cr(te,N[ur],'"'+ur+'" is prohibited for ref layers'))});var Pt;ce.layers.forEach(function(ur){on(ur.id)===Fe&&(Pt=ur)}),Pt?Pt.ref?L.push(new cr(te,N.ref,"ref cannot reference another ref layer")):Ae=on(Pt.type):L.push(new cr(te,N.ref,'ref layer "'+Fe+'" not found'))}else if(Ae!=="background")if(!N.source)L.push(new cr(te,N,'missing required property "source"'));else{var Jt=ce.sources&&ce.sources[N.source],Yt=Jt&&on(Jt.type);Jt?Yt==="vector"&&Ae==="raster"?L.push(new cr(te,N.source,'layer "'+N.id+'" requires a raster source')):Yt==="raster"&&Ae!=="raster"?L.push(new cr(te,N.source,'layer "'+N.id+'" requires a vector source')):Yt==="vector"&&!N["source-layer"]?L.push(new cr(te,N,'layer "'+N.id+'" must specify a "source-layer"')):Yt==="raster-dem"&&Ae!=="hillshade"?L.push(new cr(te,N.source,"raster-dem source can only be used with layer type 'hillshade'.")):Ae==="line"&&N.paint&&N.paint["line-gradient"]&&(Yt!=="geojson"||!Jt.lineMetrics)&&L.push(new cr(te,N,'layer "'+N.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):L.push(new cr(te,N.source,'source "'+N.source+'" not found'))}return L=L.concat(xs({key:te,value:N,valueSpec:me.layer,style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return yi({key:te+".type",value:N.type,valueSpec:me.layer.type,style:C.style,styleSpec:C.styleSpec,object:N,objectKey:"type"})},filter:lr,layout:function(Dr){return xs({layer:N,key:Dr.key,value:Dr.value,style:Dr.style,styleSpec:Dr.styleSpec,objectElementValidators:{"*":function(Jr){return Yr(vn({layerType:Ae},Jr))}}})},paint:function(Dr){return xs({layer:N,key:Dr.key,value:Dr.value,style:Dr.style,styleSpec:Dr.styleSpec,objectElementValidators:{"*":function(Jr){return kr(vn({layerType:Ae},Jr))}}})}}})),L}function xn(C){var L=C.value,N=C.key,te=ti(L);return te!=="string"?[new cr(N,L,"string expected, "+te+" found")]:[]}var Rn={promoteId:ba};function Wn(C){var L=C.value,N=C.key,te=C.styleSpec,ce=C.style;if(!L.type)return[new cr(N,L,'"type" is required')];var me=on(L.type),Ae;switch(me){case"vector":case"raster":case"raster-dem":return Ae=xs({key:N,value:L,valueSpec:te["source_"+me.replace("-","_")],style:C.style,styleSpec:te,objectElementValidators:Rn}),Ae;case"geojson":if(Ae=xs({key:N,value:L,valueSpec:te.source_geojson,style:ce,styleSpec:te,objectElementValidators:Rn}),L.cluster)for(var Fe in L.clusterProperties){var $e=L.clusterProperties[Fe],ft=$e[0],dt=$e[1],Pt=typeof ft=="string"?[ft,["accumulated"],["get",Fe]]:ft;Ae.push.apply(Ae,yl({key:N+"."+Fe+".map",value:dt,expressionContext:"cluster-map"})),Ae.push.apply(Ae,yl({key:N+"."+Fe+".reduce",value:Pt,expressionContext:"cluster-reduce"}))}return Ae;case"video":return xs({key:N,value:L,valueSpec:te.source_video,style:ce,styleSpec:te});case"image":return xs({key:N,value:L,valueSpec:te.source_image,style:ce,styleSpec:te});case"canvas":return[new cr(N,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return su({key:N+".type",value:L.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:ce,styleSpec:te})}}function ba(C){var L=C.key,N=C.value;if(ti(N)==="string")return xn({key:L,value:N});var te=[];for(var ce in N)te.push.apply(te,xn({key:L+"."+ce,value:N[ce]}));return te}function Wa(C){var L=C.value,N=C.styleSpec,te=N.light,ce=C.style,me=[],Ae=ti(L);if(L===void 0)return me;if(Ae!=="object")return me=me.concat([new cr("light",L,"object expected, "+Ae+" found")]),me;for(var Fe in L){var $e=Fe.match(/^(.*)-transition$/);$e&&te[$e[1]]&&te[$e[1]].transition?me=me.concat(yi({key:Fe,value:L[Fe],valueSpec:N.transition,style:ce,styleSpec:N})):te[Fe]?me=me.concat(yi({key:Fe,value:L[Fe],valueSpec:te[Fe],style:ce,styleSpec:N})):me=me.concat([new cr(Fe,L[Fe],'unknown property "'+Fe+'"')])}return me}function Ja(C){return xn(C).length===0?[]:yl(C)}function Qa(C){return xn(C).length===0?[]:yl(C)}var ri={"*":function(){return[]},array:Ku,boolean:bu,number:Nu,color:af,constants:nn,enum:su,filter:lr,function:Uu,layer:$r,object:xs,source:Wn,light:Wa,string:xn,formatted:Ja,resolvedImage:Qa};function yi(C){var L=C.value,N=C.valueSpec,te=C.styleSpec;if(N.expression&&pa(on(L)))return Uu(C);if(N.expression&&Is(Cn(L)))return yl(C);if(N.type&&ri[N.type])return ri[N.type](C);var ce=xs(vn({},C,{valueSpec:N.type?te[N.type]:N}));return ce}function Xi(C){var L=C.value,N=C.key,te=xn(C);return te.length||(L.indexOf("{fontstack}")===-1&&te.push(new cr(N,L,'"glyphs" url must include a "{fontstack}" token')),L.indexOf("{range}")===-1&&te.push(new cr(N,L,'"glyphs" url must include a "{range}" token'))),te}function Ga(C,L){L===void 0&&(L=Ft);var N=[];return N=N.concat(yi({key:"",value:C,valueSpec:L.$root,styleSpec:L,style:C,objectElementValidators:{glyphs:Xi,"*":function(){return[]}}})),C.constants&&(N=N.concat(nn({key:"constants",value:C.constants,style:C,styleSpec:L}))),qi(N)}Ga.source=Zi(Wn),Ga.light=Zi(Wa),Ga.layer=Zi($r),Ga.filter=Zi(lr),Ga.paintProperty=Zi(kr),Ga.layoutProperty=Zi(Yr);function qi(C){return[].concat(C).sort(function(L,N){return L.line-N.line})}function Zi(C){return function(){for(var L=[],N=arguments.length;N--;)L[N]=arguments[N];return qi(C.apply(this,L))}}var po=Ga,_i=po.light,Ri=po.paintProperty,jo=po.layoutProperty;function go(C,L){var N=!1;if(L&&L.length)for(var te=0,ce=L;te<ce.length;te+=1){var me=ce[te];C.fire(new Cr(new Error(me.message))),N=!0}return N}var Po=Io,Ko=3;function Io(C,L,N){var te=this.cells=[];if(C instanceof ArrayBuffer){this.arrayBuffer=C;var ce=new Int32Array(this.arrayBuffer);C=ce[0],L=ce[1],N=ce[2],this.d=L+2*N;for(var me=0;me<this.d*this.d;me++){var Ae=ce[Ko+me],Fe=ce[Ko+me+1];te.push(Ae===Fe?null:ce.subarray(Ae,Fe))}var $e=ce[Ko+te.length],ft=ce[Ko+te.length+1];this.keys=ce.subarray($e,ft),this.bboxes=ce.subarray(ft),this.insert=this._insertReadonly}else{this.d=L+2*N;for(var dt=0;dt<this.d*this.d;dt++)te.push([]);this.keys=[],this.bboxes=[]}this.n=L,this.extent=C,this.padding=N,this.scale=L/C,this.uid=0;var Pt=N/L*C;this.min=-Pt,this.max=C+Pt}Io.prototype.insert=function(C,L,N,te,ce){this._forEachCell(L,N,te,ce,this._insertCell,this.uid++),this.keys.push(C),this.bboxes.push(L),this.bboxes.push(N),this.bboxes.push(te),this.bboxes.push(ce)},Io.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Io.prototype._insertCell=function(C,L,N,te,ce,me){this.cells[ce].push(me)},Io.prototype.query=function(C,L,N,te,ce){var me=this.min,Ae=this.max;if(C<=me&&L<=me&&Ae<=N&&Ae<=te&&!ce)return Array.prototype.slice.call(this.keys);var Fe=[],$e={};return this._forEachCell(C,L,N,te,this._queryCell,Fe,$e,ce),Fe},Io.prototype._queryCell=function(C,L,N,te,ce,me,Ae,Fe){var $e=this.cells[ce];if($e!==null)for(var ft=this.keys,dt=this.bboxes,Pt=0;Pt<$e.length;Pt++){var Jt=$e[Pt];if(Ae[Jt]===void 0){var Yt=Jt*4;(Fe?Fe(dt[Yt+0],dt[Yt+1],dt[Yt+2],dt[Yt+3]):C<=dt[Yt+2]&&L<=dt[Yt+3]&&N>=dt[Yt+0]&&te>=dt[Yt+1])?(Ae[Jt]=!0,me.push(ft[Jt])):Ae[Jt]=!1}}},Io.prototype._forEachCell=function(C,L,N,te,ce,me,Ae,Fe){for(var $e=this._convertToCellCoord(C),ft=this._convertToCellCoord(L),dt=this._convertToCellCoord(N),Pt=this._convertToCellCoord(te),Jt=$e;Jt<=dt;Jt++)for(var Yt=ft;Yt<=Pt;Yt++){var ur=this.d*Yt+Jt;if(!(Fe&&!Fe(this._convertFromCellCoord(Jt),this._convertFromCellCoord(Yt),this._convertFromCellCoord(Jt+1),this._convertFromCellCoord(Yt+1)))&&ce.call(this,C,L,N,te,ur,me,Ae,Fe))return}},Io.prototype._convertFromCellCoord=function(C){return(C-this.padding)/this.scale},Io.prototype._convertToCellCoord=function(C){return Math.max(0,Math.min(this.d-1,Math.floor(C*this.scale)+this.padding))},Io.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var C=this.cells,L=Ko+this.cells.length+1+1,N=0,te=0;te<this.cells.length;te++)N+=this.cells[te].length;var ce=new Int32Array(L+N+this.keys.length+this.bboxes.length);ce[0]=this.extent,ce[1]=this.n,ce[2]=this.padding;for(var me=L,Ae=0;Ae<C.length;Ae++){var Fe=C[Ae];ce[Ko+Ae]=me,ce.set(Fe,me),me+=Fe.length}return ce[Ko+C.length]=me,ce.set(this.keys,me),me+=this.keys.length,ce[Ko+C.length+1]=me,ce.set(this.bboxes,me),me+=this.bboxes.length,ce.buffer};var Qs=self.ImageData,ml=self.ImageBitmap,zo={};function Ea(C,L,N){N===void 0&&(N={}),Object.defineProperty(L,"_classRegistryKey",{value:C,writeable:!1}),zo[C]={klass:L,omit:N.omit||[],shallow:N.shallow||[]}}Ea("Object",Object),Po.serialize=function(L,N){var te=L.toArrayBuffer();return N&&N.push(te),{buffer:te}},Po.deserialize=function(L){return new Po(L.buffer)},Ea("Grid",Po),Ea("Color",mi),Ea("Error",Error),Ea("ResolvedImage",ko),Ea("StylePropertyFunction",dl),Ea("StyleExpression",ys,{omit:["_evaluator"]}),Ea("ZoomDependentExpression",ms),Ea("ZoomConstantExpression",pl),Ea("CompoundExpression",Co,{omit:["_evaluate"]});for(var $s in qn)qn[$s]._classRegistryKey||Ea("Expression_"+$s,qn[$s]);function ue(C){return C&&typeof ArrayBuffer<"u"&&(C instanceof ArrayBuffer||C.constructor&&C.constructor.name==="ArrayBuffer")}function _e(C){return ml&&C instanceof ml}function Ce(C,L){if(C==null||typeof C=="boolean"||typeof C=="number"||typeof C=="string"||C instanceof Boolean||C instanceof Number||C instanceof String||C instanceof Date||C instanceof RegExp)return C;if(ue(C)||_e(C))return L&&L.push(C),C;if(ArrayBuffer.isView(C)){var N=C;return L&&L.push(N.buffer),N}if(C instanceof Qs)return L&&L.push(C.data.buffer),C;if(Array.isArray(C)){for(var te=[],ce=0,me=C;ce<me.length;ce+=1){var Ae=me[ce];te.push(Ce(Ae,L))}return te}if(typeof C=="object"){var Fe=C.constructor,$e=Fe._classRegistryKey;if(!$e)throw new Error("can't serialize object of unregistered class");var ft=Fe.serialize?Fe.serialize(C,L):{};if(!Fe.serialize){for(var dt in C)if(!!C.hasOwnProperty(dt)&&!(zo[$e].omit.indexOf(dt)>=0)){var Pt=C[dt];ft[dt]=zo[$e].shallow.indexOf(dt)>=0?Pt:Ce(Pt,L)}C instanceof Error&&(ft.message=C.message)}if(ft.$name)throw new Error("$name property is reserved for worker serialization logic.");return $e!=="Object"&&(ft.$name=$e),ft}throw new Error("can't serialize object of type "+typeof C)}function Be(C){if(C==null||typeof C=="boolean"||typeof C=="number"||typeof C=="string"||C instanceof Boolean||C instanceof Number||C instanceof String||C instanceof Date||C instanceof RegExp||ue(C)||_e(C)||ArrayBuffer.isView(C)||C instanceof Qs)return C;if(Array.isArray(C))return C.map(Be);if(typeof C=="object"){var L=C.$name||"Object",N=zo[L],te=N.klass;if(!te)throw new Error("can't deserialize unregistered class "+L);if(te.deserialize)return te.deserialize(C);for(var ce=Object.create(te.prototype),me=0,Ae=Object.keys(C);me<Ae.length;me+=1){var Fe=Ae[me];if(Fe!=="$name"){var $e=C[Fe];ce[Fe]=zo[L].shallow.indexOf(Fe)>=0?$e:Be($e)}}return ce}throw new Error("can't deserialize object of type "+typeof C)}var Ge=function(){this.first=!0};Ge.prototype.update=function(L,N){var te=Math.floor(L);return this.first?(this.first=!1,this.lastIntegerZoom=te,this.lastIntegerZoomTime=0,this.lastZoom=L,this.lastFloorZoom=te,!0):(this.lastFloorZoom>te?(this.lastIntegerZoom=te+1,this.lastIntegerZoomTime=N):this.lastFloorZoom<te&&(this.lastIntegerZoom=te,this.lastIntegerZoomTime=N),L!==this.lastZoom?(this.lastZoom=L,this.lastFloorZoom=te,!0):!1)};var He={"Latin-1 Supplement":function(C){return C>=128&&C<=255},Arabic:function(C){return C>=1536&&C<=1791},"Arabic Supplement":function(C){return C>=1872&&C<=1919},"Arabic Extended-A":function(C){return C>=2208&&C<=2303},"Hangul Jamo":function(C){return C>=4352&&C<=4607},"Unified Canadian Aboriginal Syllabics":function(C){return C>=5120&&C<=5759},Khmer:function(C){return C>=6016&&C<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(C){return C>=6320&&C<=6399},"General Punctuation":function(C){return C>=8192&&C<=8303},"Letterlike Symbols":function(C){return C>=8448&&C<=8527},"Number Forms":function(C){return C>=8528&&C<=8591},"Miscellaneous Technical":function(C){return C>=8960&&C<=9215},"Control Pictures":function(C){return C>=9216&&C<=9279},"Optical Character Recognition":function(C){return C>=9280&&C<=9311},"Enclosed Alphanumerics":function(C){return C>=9312&&C<=9471},"Geometric Shapes":function(C){return C>=9632&&C<=9727},"Miscellaneous Symbols":function(C){return C>=9728&&C<=9983},"Miscellaneous Symbols and Arrows":function(C){return C>=11008&&C<=11263},"CJK Radicals Supplement":function(C){return C>=11904&&C<=12031},"Kangxi Radicals":function(C){return C>=12032&&C<=12255},"Ideographic Description Characters":function(C){return C>=12272&&C<=12287},"CJK Symbols and Punctuation":function(C){return C>=12288&&C<=12351},Hiragana:function(C){return C>=12352&&C<=12447},Katakana:function(C){return C>=12448&&C<=12543},Bopomofo:function(C){return C>=12544&&C<=12591},"Hangul Compatibility Jamo":function(C){return C>=12592&&C<=12687},Kanbun:function(C){return C>=12688&&C<=12703},"Bopomofo Extended":function(C){return C>=12704&&C<=12735},"CJK Strokes":function(C){return C>=12736&&C<=12783},"Katakana Phonetic Extensions":function(C){return C>=12784&&C<=12799},"Enclosed CJK Letters and Months":function(C){return C>=12800&&C<=13055},"CJK Compatibility":function(C){return C>=13056&&C<=13311},"CJK Unified Ideographs Extension A":function(C){return C>=13312&&C<=19903},"Yijing Hexagram Symbols":function(C){return C>=19904&&C<=19967},"CJK Unified Ideographs":function(C){return C>=19968&&C<=40959},"Yi Syllables":function(C){return C>=40960&&C<=42127},"Yi Radicals":function(C){return C>=42128&&C<=42191},"Hangul Jamo Extended-A":function(C){return C>=43360&&C<=43391},"Hangul Syllables":function(C){return C>=44032&&C<=55215},"Hangul Jamo Extended-B":function(C){return C>=55216&&C<=55295},"Private Use Area":function(C){return C>=57344&&C<=63743},"CJK Compatibility Ideographs":function(C){return C>=63744&&C<=64255},"Arabic Presentation Forms-A":function(C){return C>=64336&&C<=65023},"Vertical Forms":function(C){return C>=65040&&C<=65055},"CJK Compatibility Forms":function(C){return C>=65072&&C<=65103},"Small Form Variants":function(C){return C>=65104&&C<=65135},"Arabic Presentation Forms-B":function(C){return C>=65136&&C<=65279},"Halfwidth and Fullwidth Forms":function(C){return C>=65280&&C<=65519}};function xt(C){for(var L=0,N=C;L<N.length;L+=1){var te=N[L];if(jt(te.charCodeAt(0)))return!0}return!1}function ht(C){for(var L=0,N=C;L<N.length;L+=1){var te=N[L];if(!Ct(te.charCodeAt(0)))return!1}return!0}function Ct(C){return!(He.Arabic(C)||He["Arabic Supplement"](C)||He["Arabic Extended-A"](C)||He["Arabic Presentation Forms-A"](C)||He["Arabic Presentation Forms-B"](C))}function Zt(C){return C<11904?!1:!!(He["Bopomofo Extended"](C)||He.Bopomofo(C)||He["CJK Compatibility Forms"](C)||He["CJK Compatibility Ideographs"](C)||He["CJK Compatibility"](C)||He["CJK Radicals Supplement"](C)||He["CJK Strokes"](C)||He["CJK Symbols and Punctuation"](C)||He["CJK Unified Ideographs Extension A"](C)||He["CJK Unified Ideographs"](C)||He["Enclosed CJK Letters and Months"](C)||He["Halfwidth and Fullwidth Forms"](C)||He.Hiragana(C)||He["Ideographic Description Characters"](C)||He["Kangxi Radicals"](C)||He["Katakana Phonetic Extensions"](C)||He.Katakana(C)||He["Vertical Forms"](C)||He["Yi Radicals"](C)||He["Yi Syllables"](C))}function jt(C){return C===746||C===747?!0:C<4352?!1:!!(He["Bopomofo Extended"](C)||He.Bopomofo(C)||He["CJK Compatibility Forms"](C)&&!(C>=65097&&C<=65103)||He["CJK Compatibility Ideographs"](C)||He["CJK Compatibility"](C)||He["CJK Radicals Supplement"](C)||He["CJK Strokes"](C)||He["CJK Symbols and Punctuation"](C)&&!(C>=12296&&C<=12305)&&!(C>=12308&&C<=12319)&&C!==12336||He["CJK Unified Ideographs Extension A"](C)||He["CJK Unified Ideographs"](C)||He["Enclosed CJK Letters and Months"](C)||He["Hangul Compatibility Jamo"](C)||He["Hangul Jamo Extended-A"](C)||He["Hangul Jamo Extended-B"](C)||He["Hangul Jamo"](C)||He["Hangul Syllables"](C)||He.Hiragana(C)||He["Ideographic Description Characters"](C)||He.Kanbun(C)||He["Kangxi Radicals"](C)||He["Katakana Phonetic Extensions"](C)||He.Katakana(C)&&C!==12540||He["Halfwidth and Fullwidth Forms"](C)&&C!==65288&&C!==65289&&C!==65293&&!(C>=65306&&C<=65310)&&C!==65339&&C!==65341&&C!==65343&&!(C>=65371&&C<=65503)&&C!==65507&&!(C>=65512&&C<=65519)||He["Small Form Variants"](C)&&!(C>=65112&&C<=65118)&&!(C>=65123&&C<=65126)||He["Unified Canadian Aboriginal Syllabics"](C)||He["Unified Canadian Aboriginal Syllabics Extended"](C)||He["Vertical Forms"](C)||He["Yijing Hexagram Symbols"](C)||He["Yi Syllables"](C)||He["Yi Radicals"](C))}function br(C){return!!(He["Latin-1 Supplement"](C)&&(C===167||C===169||C===174||C===177||C===188||C===189||C===190||C===215||C===247)||He["General Punctuation"](C)&&(C===8214||C===8224||C===8225||C===8240||C===8241||C===8251||C===8252||C===8258||C===8263||C===8264||C===8265||C===8273)||He["Letterlike Symbols"](C)||He["Number Forms"](C)||He["Miscellaneous Technical"](C)&&(C>=8960&&C<=8967||C>=8972&&C<=8991||C>=8996&&C<=9e3||C===9003||C>=9085&&C<=9114||C>=9150&&C<=9165||C===9167||C>=9169&&C<=9179||C>=9186&&C<=9215)||He["Control Pictures"](C)&&C!==9251||He["Optical Character Recognition"](C)||He["Enclosed Alphanumerics"](C)||He["Geometric Shapes"](C)||He["Miscellaneous Symbols"](C)&&!(C>=9754&&C<=9759)||He["Miscellaneous Symbols and Arrows"](C)&&(C>=11026&&C<=11055||C>=11088&&C<=11097||C>=11192&&C<=11243)||He["CJK Symbols and Punctuation"](C)||He.Katakana(C)||He["Private Use Area"](C)||He["CJK Compatibility Forms"](C)||He["Small Form Variants"](C)||He["Halfwidth and Fullwidth Forms"](C)||C===8734||C===8756||C===8757||C>=9984&&C<=10087||C>=10102&&C<=10131||C===65532||C===65533)}function xr(C){return!(jt(C)||br(C))}function Wr(C){return He.Arabic(C)||He["Arabic Supplement"](C)||He["Arabic Extended-A"](C)||He["Arabic Presentation Forms-A"](C)||He["Arabic Presentation Forms-B"](C)}function tn(C){return C>=1424&&C<=2303||He["Arabic Presentation Forms-A"](C)||He["Arabic Presentation Forms-B"](C)}function Mr(C,L){return!(!L&&tn(C)||C>=2304&&C<=3583||C>=3840&&C<=4255||He.Khmer(C))}function Ir(C){for(var L=0,N=C;L<N.length;L+=1){var te=N[L];if(tn(te.charCodeAt(0)))return!0}return!1}function Xr(C,L){for(var N=0,te=C;N<te.length;N+=1){var ce=te[N];if(!Mr(ce.charCodeAt(0),L))return!1}return!0}var qr={unavailable:"unavailable",deferred:"deferred",loading:"loading",loaded:"loaded",error:"error"},an=null,Br=qr.unavailable,In=null,fa=function(C){C&&typeof C=="string"&&C.indexOf("NetworkError")>-1&&(Br=qr.error),an&&an(C)};function ya(){da.fire(new ln("pluginStateChange",{pluginStatus:Br,pluginURL:In}))}var da=new Gr,Ca=function(){return Br},Ra=function(C){return C({pluginStatus:Br,pluginURL:In}),da.on("pluginStateChange",C),C},ii=function(C,L,N){if(N===void 0&&(N=!1),Br===qr.deferred||Br===qr.loading||Br===qr.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");In=re.resolveURL(C),Br=qr.deferred,an=L,ya(),N||Oa()},Oa=function(){if(Br!==qr.deferred||!In)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Br=qr.loading,ya(),In&&Ne({url:In},function(C){C?fa(C):(Br=qr.loaded,ya())})},Xa={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Br===qr.loaded||Xa.applyArabicShaping!=null},isLoading:function(){return Br===qr.loading},setState:function(L){Br=L.pluginStatus,In=L.pluginURL},isParsed:function(){return Xa.applyArabicShaping!=null&&Xa.processBidirectionalText!=null&&Xa.processStyledBidirectionalText!=null},getPluginURL:function(){return In}},Ii=function(){!Xa.isLoading()&&!Xa.isLoaded()&&Ca()==="deferred"&&Oa()},ci=function(L,N){this.zoom=L,N?(this.now=N.now,this.fadeDuration=N.fadeDuration,this.zoomHistory=N.zoomHistory,this.transition=N.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ge,this.transition={})};ci.prototype.isSupportedScript=function(L){return Xr(L,Xa.isLoaded())},ci.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ci.prototype.getCrossfadeParameters=function(){var L=this.zoom,N=L-Math.floor(L),te=this.crossFadingFactor();return L>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:N+(1-N)*te}:{fromScale:.5,toScale:1,t:1-(1-te)*N}};var ki=function(L,N){this.property=L,this.value=N,this.expression=zs(N===void 0?L.specification.default:N,L.specification)};ki.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},ki.prototype.possiblyEvaluate=function(L,N,te){return this.property.possiblyEvaluate(this,L,N,te)};var aa=function(L){this.property=L,this.value=new ki(L,void 0)};aa.prototype.transitioned=function(L,N){return new si(this.property,this.value,N,y({},L.transition,this.transition),L.now)},aa.prototype.untransitioned=function(){return new si(this.property,this.value,null,{},0)};var $a=function(L){this._properties=L,this._values=Object.create(L.defaultTransitionablePropertyValues)};$a.prototype.getValue=function(L){return z(this._values[L].value.value)},$a.prototype.setValue=function(L,N){this._values.hasOwnProperty(L)||(this._values[L]=new aa(this._values[L].property)),this._values[L].value=new ki(this._values[L].property,N===null?void 0:z(N))},$a.prototype.getTransition=function(L){return z(this._values[L].transition)},$a.prototype.setTransition=function(L,N){this._values.hasOwnProperty(L)||(this._values[L]=new aa(this._values[L].property)),this._values[L].transition=z(N)||void 0},$a.prototype.serialize=function(){for(var L={},N=0,te=Object.keys(this._values);N<te.length;N+=1){var ce=te[N],me=this.getValue(ce);me!==void 0&&(L[ce]=me);var Ae=this.getTransition(ce);Ae!==void 0&&(L[ce+"-transition"]=Ae)}return L},$a.prototype.transitioned=function(L,N){for(var te=new Mi(this._properties),ce=0,me=Object.keys(this._values);ce<me.length;ce+=1){var Ae=me[ce];te._values[Ae]=this._values[Ae].transitioned(L,N._values[Ae])}return te},$a.prototype.untransitioned=function(){for(var L=new Mi(this._properties),N=0,te=Object.keys(this._values);N<te.length;N+=1){var ce=te[N];L._values[ce]=this._values[ce].untransitioned()}return L};var si=function(L,N,te,ce,me){this.property=L,this.value=N,this.begin=me+ce.delay||0,this.end=this.begin+ce.duration||0,L.specification.transition&&(ce.delay||ce.duration)&&(this.prior=te)};si.prototype.possiblyEvaluate=function(L,N,te){var ce=L.now||0,me=this.value.possiblyEvaluate(L,N,te),Ae=this.prior;if(Ae){if(ce>this.end)return this.prior=null,me;if(this.value.isDataDriven())return this.prior=null,me;if(ce<this.begin)return Ae.possiblyEvaluate(L,N,te);var Fe=(ce-this.begin)/(this.end-this.begin);return this.property.interpolate(Ae.possiblyEvaluate(L,N,te),me,d(Fe))}else return me};var Mi=function(L){this._properties=L,this._values=Object.create(L.defaultTransitioningPropertyValues)};Mi.prototype.possiblyEvaluate=function(L,N,te){for(var ce=new Bi(this._properties),me=0,Ae=Object.keys(this._values);me<Ae.length;me+=1){var Fe=Ae[me];ce._values[Fe]=this._values[Fe].possiblyEvaluate(L,N,te)}return ce},Mi.prototype.hasTransition=function(){for(var L=0,N=Object.keys(this._values);L<N.length;L+=1){var te=N[L];if(this._values[te].prior)return!0}return!1};var Qi=function(L){this._properties=L,this._values=Object.create(L.defaultPropertyValues)};Qi.prototype.getValue=function(L){return z(this._values[L].value)},Qi.prototype.setValue=function(L,N){this._values[L]=new ki(this._values[L].property,N===null?void 0:z(N))},Qi.prototype.serialize=function(){for(var L={},N=0,te=Object.keys(this._values);N<te.length;N+=1){var ce=te[N],me=this.getValue(ce);me!==void 0&&(L[ce]=me)}return L},Qi.prototype.possiblyEvaluate=function(L,N,te){for(var ce=new Bi(this._properties),me=0,Ae=Object.keys(this._values);me<Ae.length;me+=1){var Fe=Ae[me];ce._values[Fe]=this._values[Fe].possiblyEvaluate(L,N,te)}return ce};var Hi=function(L,N,te){this.property=L,this.value=N,this.parameters=te};Hi.prototype.isConstant=function(){return this.value.kind==="constant"},Hi.prototype.constantOr=function(L){return this.value.kind==="constant"?this.value.value:L},Hi.prototype.evaluate=function(L,N,te,ce){return this.property.evaluate(this.value,this.parameters,L,N,te,ce)};var Bi=function(L){this._properties=L,this._values=Object.create(L.defaultPossiblyEvaluatedValues)};Bi.prototype.get=function(L){return this._values[L]};var Ma=function(L){this.specification=L};Ma.prototype.possiblyEvaluate=function(L,N){return L.expression.evaluate(N)},Ma.prototype.interpolate=function(L,N,te){var ce=nu[this.specification.type];return ce?ce(L,N,te):L};var Ia=function(L,N){this.specification=L,this.overrides=N};Ia.prototype.possiblyEvaluate=function(L,N,te,ce){return L.expression.kind==="constant"||L.expression.kind==="camera"?new Hi(this,{kind:"constant",value:L.expression.evaluate(N,null,{},te,ce)},N):new Hi(this,L.expression,N)},Ia.prototype.interpolate=function(L,N,te){if(L.value.kind!=="constant"||N.value.kind!=="constant")return L;if(L.value.value===void 0||N.value.value===void 0)return new Hi(this,{kind:"constant",value:void 0},L.parameters);var ce=nu[this.specification.type];return ce?new Hi(this,{kind:"constant",value:ce(L.value.value,N.value.value,te)},L.parameters):L},Ia.prototype.evaluate=function(L,N,te,ce,me,Ae){return L.kind==="constant"?L.value:L.evaluate(N,te,ce,me,Ae)};var eo=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.possiblyEvaluate=function(te,ce,me,Ae){if(te.value===void 0)return new Hi(this,{kind:"constant",value:void 0},ce);if(te.expression.kind==="constant"){var Fe=te.expression.evaluate(ce,null,{},me,Ae),$e=te.property.specification.type==="resolvedImage",ft=$e&&typeof Fe!="string"?Fe.name:Fe,dt=this._calculate(ft,ft,ft,ce);return new Hi(this,{kind:"constant",value:dt},ce)}else if(te.expression.kind==="camera"){var Pt=this._calculate(te.expression.evaluate({zoom:ce.zoom-1}),te.expression.evaluate({zoom:ce.zoom}),te.expression.evaluate({zoom:ce.zoom+1}),ce);return new Hi(this,{kind:"constant",value:Pt},ce)}else return new Hi(this,te.expression,ce)},L.prototype.evaluate=function(te,ce,me,Ae,Fe,$e){if(te.kind==="source"){var ft=te.evaluate(ce,me,Ae,Fe,$e);return this._calculate(ft,ft,ft,ce)}else return te.kind==="composite"?this._calculate(te.evaluate({zoom:Math.floor(ce.zoom)-1},me,Ae),te.evaluate({zoom:Math.floor(ce.zoom)},me,Ae),te.evaluate({zoom:Math.floor(ce.zoom)+1},me,Ae),ce):te.value},L.prototype._calculate=function(te,ce,me,Ae){var Fe=Ae.zoom;return Fe>Ae.zoomHistory.lastIntegerZoom?{from:te,to:ce}:{from:me,to:ce}},L.prototype.interpolate=function(te){return te},L}(Ia),bo=function(L){this.specification=L};bo.prototype.possiblyEvaluate=function(L,N,te,ce){if(L.value!==void 0)if(L.expression.kind==="constant"){var me=L.expression.evaluate(N,null,{},te,ce);return this._calculate(me,me,me,N)}else return this._calculate(L.expression.evaluate(new ci(Math.floor(N.zoom-1),N)),L.expression.evaluate(new ci(Math.floor(N.zoom),N)),L.expression.evaluate(new ci(Math.floor(N.zoom+1),N)),N)},bo.prototype._calculate=function(L,N,te,ce){var me=ce.zoom;return me>ce.zoomHistory.lastIntegerZoom?{from:L,to:N}:{from:te,to:N}},bo.prototype.interpolate=function(L){return L};var yo=function(L){this.specification=L};yo.prototype.possiblyEvaluate=function(L,N,te,ce){return!!L.expression.evaluate(N,null,{},te,ce)},yo.prototype.interpolate=function(){return!1};var Yi=function(L){this.properties=L,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(var N in L){var te=L[N];te.specification.overridable&&this.overridableProperties.push(N);var ce=this.defaultPropertyValues[N]=new ki(te,void 0),me=this.defaultTransitionablePropertyValues[N]=new aa(te);this.defaultTransitioningPropertyValues[N]=me.untransitioned(),this.defaultPossiblyEvaluatedValues[N]=ce.possiblyEvaluate({})}};Ea("DataDrivenProperty",Ia),Ea("DataConstantProperty",Ma),Ea("CrossFadedDataDrivenProperty",eo),Ea("CrossFadedProperty",bo),Ea("ColorRampProperty",yo);var Fs="-transition",Pl=function(C){function L(N,te){if(C.call(this),this.id=N.id,this.type=N.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},N.type!=="custom"&&(N=N,this.metadata=N.metadata,this.minzoom=N.minzoom,this.maxzoom=N.maxzoom,N.type!=="background"&&(this.source=N.source,this.sourceLayer=N["source-layer"],this.filter=N.filter),te.layout&&(this._unevaluatedLayout=new Qi(te.layout)),te.paint)){this._transitionablePaint=new $a(te.paint);for(var ce in N.paint)this.setPaintProperty(ce,N.paint[ce],{validate:!1});for(var me in N.layout)this.setLayoutProperty(me,N.layout[me],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Bi(te.paint)}}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},L.prototype.getLayoutProperty=function(te){return te==="visibility"?this.visibility:this._unevaluatedLayout.getValue(te)},L.prototype.setLayoutProperty=function(te,ce,me){if(me===void 0&&(me={}),ce!=null){var Ae="layers."+this.id+".layout."+te;if(this._validate(jo,Ae,te,ce,me))return}if(te==="visibility"){this.visibility=ce;return}this._unevaluatedLayout.setValue(te,ce)},L.prototype.getPaintProperty=function(te){return o(te,Fs)?this._transitionablePaint.getTransition(te.slice(0,-Fs.length)):this._transitionablePaint.getValue(te)},L.prototype.setPaintProperty=function(te,ce,me){if(me===void 0&&(me={}),ce!=null){var Ae="layers."+this.id+".paint."+te;if(this._validate(Ri,Ae,te,ce,me))return!1}if(o(te,Fs))return this._transitionablePaint.setTransition(te.slice(0,-Fs.length),ce||void 0),!1;var Fe=this._transitionablePaint._values[te],$e=Fe.property.specification["property-type"]==="cross-faded-data-driven",ft=Fe.value.isDataDriven(),dt=Fe.value;this._transitionablePaint.setValue(te,ce),this._handleSpecialPaintPropertyUpdate(te);var Pt=this._transitionablePaint._values[te].value,Jt=Pt.isDataDriven();return Jt||ft||$e||this._handleOverridablePaintPropertyUpdate(te,dt,Pt)},L.prototype._handleSpecialPaintPropertyUpdate=function(te){},L.prototype._handleOverridablePaintPropertyUpdate=function(te,ce,me){return!1},L.prototype.isHidden=function(te){return this.minzoom&&te<this.minzoom||this.maxzoom&&te>=this.maxzoom?!0:this.visibility==="none"},L.prototype.updateTransitions=function(te){this._transitioningPaint=this._transitionablePaint.transitioned(te,this._transitioningPaint)},L.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},L.prototype.recalculate=function(te,ce){te.getCrossfadeParameters&&(this._crossfadeParameters=te.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(te,void 0,ce)),this.paint=this._transitioningPaint.possiblyEvaluate(te,void 0,ce)},L.prototype.serialize=function(){var te={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(te.layout=te.layout||{},te.layout.visibility=this.visibility),R(te,function(ce,me){return ce!==void 0&&!(me==="layout"&&!Object.keys(ce).length)&&!(me==="paint"&&!Object.keys(ce).length)})},L.prototype._validate=function(te,ce,me,Ae,Fe){return Fe===void 0&&(Fe={}),Fe&&Fe.validate===!1?!1:go(this,te.call(po,{key:ce,layerType:this.type,objectKey:me,value:Ae,styleSpec:Ft,style:{glyphs:!0,sprite:!0}}))},L.prototype.is3D=function(){return!1},L.prototype.isTileClipped=function(){return!1},L.prototype.hasOffscreenPass=function(){return!1},L.prototype.resize=function(){},L.prototype.isStateDependent=function(){for(var te in this.paint._values){var ce=this.paint.get(te);if(!(!(ce instanceof Hi)||!li(ce.property.specification))&&(ce.value.kind==="source"||ce.value.kind==="composite")&&ce.value.isStateDependent)return!0}return!1},L}(Gr),Os={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ei=function(L,N){this._structArray=L,this._pos1=N*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},qs=128,Jo=5,gi=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};gi.serialize=function(L,N){return L._trim(),N&&(L.isTransferred=!0,N.push(L.arrayBuffer)),{length:L.length,arrayBuffer:L.arrayBuffer}},gi.deserialize=function(L){var N=Object.create(this.prototype);return N.arrayBuffer=L.arrayBuffer,N.length=L.length,N.capacity=L.arrayBuffer.byteLength/N.bytesPerElement,N._refreshViews(),N},gi.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},gi.prototype.clear=function(){this.length=0},gi.prototype.resize=function(L){this.reserve(L),this.length=L},gi.prototype.reserve=function(L){if(L>this.capacity){this.capacity=Math.max(L,Math.floor(this.capacity*Jo),qs),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var N=this.uint8;this._refreshViews(),N&&this.uint8.set(N)}},gi.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};function lo(C,L){L===void 0&&(L=1);var N=0,te=0,ce=C.map(function(Ae){var Fe=_u(Ae.type),$e=N=xl(N,Math.max(L,Fe)),ft=Ae.components||1;return te=Math.max(te,Fe),N+=Fe*ft,{name:Ae.name,type:Ae.type,components:ft,offset:$e}}),me=xl(N,Math.max(te,L));return{members:ce,size:me,alignment:L}}function _u(C){return Os[C].BYTES_PER_ELEMENT}function xl(C,L){return Math.ceil(C/L)*L}var lu=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce){var me=this.length;return this.resize(me+1),this.emplace(me,te,ce)},L.prototype.emplace=function(te,ce,me){var Ae=te*2;return this.int16[Ae+0]=ce,this.int16[Ae+1]=me,te},L}(gi);lu.prototype.bytesPerElement=4,Ea("StructArrayLayout2i4",lu);var Xl=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae){var Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,te,ce,me,Ae)},L.prototype.emplace=function(te,ce,me,Ae,Fe){var $e=te*4;return this.int16[$e+0]=ce,this.int16[$e+1]=me,this.int16[$e+2]=Ae,this.int16[$e+3]=Fe,te},L}(gi);Xl.prototype.bytesPerElement=8,Ea("StructArrayLayout4i8",Xl);var of=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae,Fe,$e){var ft=this.length;return this.resize(ft+1),this.emplace(ft,te,ce,me,Ae,Fe,$e)},L.prototype.emplace=function(te,ce,me,Ae,Fe,$e,ft){var dt=te*6;return this.int16[dt+0]=ce,this.int16[dt+1]=me,this.int16[dt+2]=Ae,this.int16[dt+3]=Fe,this.int16[dt+4]=$e,this.int16[dt+5]=ft,te},L}(gi);of.prototype.bytesPerElement=12,Ea("StructArrayLayout2i4i12",of);var Cf=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae,Fe,$e){var ft=this.length;return this.resize(ft+1),this.emplace(ft,te,ce,me,Ae,Fe,$e)},L.prototype.emplace=function(te,ce,me,Ae,Fe,$e,ft){var dt=te*4,Pt=te*8;return this.int16[dt+0]=ce,this.int16[dt+1]=me,this.uint8[Pt+4]=Ae,this.uint8[Pt+5]=Fe,this.uint8[Pt+6]=$e,this.uint8[Pt+7]=ft,te},L}(gi);Cf.prototype.bytesPerElement=8,Ea("StructArrayLayout2i4ub8",Cf);var Bs=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt){var Yt=this.length;return this.resize(Yt+1),this.emplace(Yt,te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt)},L.prototype.emplace=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt){var ur=te*9,Dr=te*18;return this.uint16[ur+0]=ce,this.uint16[ur+1]=me,this.uint16[ur+2]=Ae,this.uint16[ur+3]=Fe,this.uint16[ur+4]=$e,this.uint16[ur+5]=ft,this.uint16[ur+6]=dt,this.uint16[ur+7]=Pt,this.uint8[Dr+16]=Jt,this.uint8[Dr+17]=Yt,te},L}(gi);Bs.prototype.bytesPerElement=18,Ea("StructArrayLayout8ui2ub18",Bs);var Vu=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur){var Dr=this.length;return this.resize(Dr+1),this.emplace(Dr,te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur)},L.prototype.emplace=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr){var rn=te*12;return this.int16[rn+0]=ce,this.int16[rn+1]=me,this.int16[rn+2]=Ae,this.int16[rn+3]=Fe,this.uint16[rn+4]=$e,this.uint16[rn+5]=ft,this.uint16[rn+6]=dt,this.uint16[rn+7]=Pt,this.int16[rn+8]=Jt,this.int16[rn+9]=Yt,this.int16[rn+10]=ur,this.int16[rn+11]=Dr,te},L}(gi);Vu.prototype.bytesPerElement=24,Ea("StructArrayLayout4i4ui4i24",Vu);var rc=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,te,ce,me)},L.prototype.emplace=function(te,ce,me,Ae){var Fe=te*3;return this.float32[Fe+0]=ce,this.float32[Fe+1]=me,this.float32[Fe+2]=Ae,te},L}(gi);rc.prototype.bytesPerElement=12,Ea("StructArrayLayout3f12",rc);var nc=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te){var ce=this.length;return this.resize(ce+1),this.emplace(ce,te)},L.prototype.emplace=function(te,ce){var me=te*1;return this.uint32[me+0]=ce,te},L}(gi);nc.prototype.bytesPerElement=4,Ea("StructArrayLayout1ul4",nc);var mf=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt){var Jt=this.length;return this.resize(Jt+1),this.emplace(Jt,te,ce,me,Ae,Fe,$e,ft,dt,Pt)},L.prototype.emplace=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt){var Yt=te*10,ur=te*5;return this.int16[Yt+0]=ce,this.int16[Yt+1]=me,this.int16[Yt+2]=Ae,this.int16[Yt+3]=Fe,this.int16[Yt+4]=$e,this.int16[Yt+5]=ft,this.uint32[ur+3]=dt,this.uint16[Yt+8]=Pt,this.uint16[Yt+9]=Jt,te},L}(gi);mf.prototype.bytesPerElement=20,Ea("StructArrayLayout6i1ul2ui20",mf);var Lf=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae,Fe,$e){var ft=this.length;return this.resize(ft+1),this.emplace(ft,te,ce,me,Ae,Fe,$e)},L.prototype.emplace=function(te,ce,me,Ae,Fe,$e,ft){var dt=te*6;return this.int16[dt+0]=ce,this.int16[dt+1]=me,this.int16[dt+2]=Ae,this.int16[dt+3]=Fe,this.int16[dt+4]=$e,this.int16[dt+5]=ft,te},L}(gi);Lf.prototype.bytesPerElement=12,Ea("StructArrayLayout2i2i2i12",Lf);var wu=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae,Fe){var $e=this.length;return this.resize($e+1),this.emplace($e,te,ce,me,Ae,Fe)},L.prototype.emplace=function(te,ce,me,Ae,Fe,$e){var ft=te*4,dt=te*8;return this.float32[ft+0]=ce,this.float32[ft+1]=me,this.float32[ft+2]=Ae,this.int16[dt+6]=Fe,this.int16[dt+7]=$e,te},L}(gi);wu.prototype.bytesPerElement=16,Ea("StructArrayLayout2f1f2i16",wu);var el=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae){var Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,te,ce,me,Ae)},L.prototype.emplace=function(te,ce,me,Ae,Fe){var $e=te*12,ft=te*3;return this.uint8[$e+0]=ce,this.uint8[$e+1]=me,this.float32[ft+1]=Ae,this.float32[ft+2]=Fe,te},L}(gi);el.prototype.bytesPerElement=12,Ea("StructArrayLayout2ub2f12",el);var Tu=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,te,ce,me)},L.prototype.emplace=function(te,ce,me,Ae){var Fe=te*3;return this.uint16[Fe+0]=ce,this.uint16[Fe+1]=me,this.uint16[Fe+2]=Ae,te},L}(gi);Tu.prototype.bytesPerElement=6,Ea("StructArrayLayout3ui6",Tu);var xf=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr,rn,Jr,kn,mn){var Mn=this.length;return this.resize(Mn+1),this.emplace(Mn,te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr,rn,Jr,kn,mn)},L.prototype.emplace=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr,rn,Jr,kn,mn,Mn){var zn=te*24,Yn=te*12,la=te*48;return this.int16[zn+0]=ce,this.int16[zn+1]=me,this.uint16[zn+2]=Ae,this.uint16[zn+3]=Fe,this.uint32[Yn+2]=$e,this.uint32[Yn+3]=ft,this.uint32[Yn+4]=dt,this.uint16[zn+10]=Pt,this.uint16[zn+11]=Jt,this.uint16[zn+12]=Yt,this.float32[Yn+7]=ur,this.float32[Yn+8]=Dr,this.uint8[la+36]=rn,this.uint8[la+37]=Jr,this.uint8[la+38]=kn,this.uint32[Yn+10]=mn,this.int16[zn+22]=Mn,te},L}(gi);xf.prototype.bytesPerElement=48,Ea("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",xf);var Pf=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr,rn,Jr,kn,mn,Mn,zn,Yn,la,ia,Ba,_a,Sa,ni,Da,za){var vi=this.length;return this.resize(vi+1),this.emplace(vi,te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr,rn,Jr,kn,mn,Mn,zn,Yn,la,ia,Ba,_a,Sa,ni,Da,za)},L.prototype.emplace=function(te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr,rn,Jr,kn,mn,Mn,zn,Yn,la,ia,Ba,_a,Sa,ni,Da,za,vi){var ei=te*34,zi=te*17;return this.int16[ei+0]=ce,this.int16[ei+1]=me,this.int16[ei+2]=Ae,this.int16[ei+3]=Fe,this.int16[ei+4]=$e,this.int16[ei+5]=ft,this.int16[ei+6]=dt,this.int16[ei+7]=Pt,this.uint16[ei+8]=Jt,this.uint16[ei+9]=Yt,this.uint16[ei+10]=ur,this.uint16[ei+11]=Dr,this.uint16[ei+12]=rn,this.uint16[ei+13]=Jr,this.uint16[ei+14]=kn,this.uint16[ei+15]=mn,this.uint16[ei+16]=Mn,this.uint16[ei+17]=zn,this.uint16[ei+18]=Yn,this.uint16[ei+19]=la,this.uint16[ei+20]=ia,this.uint16[ei+21]=Ba,this.uint16[ei+22]=_a,this.uint32[zi+12]=Sa,this.float32[zi+13]=ni,this.float32[zi+14]=Da,this.float32[zi+15]=za,this.float32[zi+16]=vi,te},L}(gi);Pf.prototype.bytesPerElement=68,Ea("StructArrayLayout8i15ui1ul4f68",Pf);var sf=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te){var ce=this.length;return this.resize(ce+1),this.emplace(ce,te)},L.prototype.emplace=function(te,ce){var me=te*1;return this.float32[me+0]=ce,te},L}(gi);sf.prototype.bytesPerElement=4,Ea("StructArrayLayout1f4",sf);var ac=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,te,ce,me)},L.prototype.emplace=function(te,ce,me,Ae){var Fe=te*3;return this.int16[Fe+0]=ce,this.int16[Fe+1]=me,this.int16[Fe+2]=Ae,te},L}(gi);ac.prototype.bytesPerElement=6,Ea("StructArrayLayout3i6",ac);var Hu=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me){var Ae=this.length;return this.resize(Ae+1),this.emplace(Ae,te,ce,me)},L.prototype.emplace=function(te,ce,me,Ae){var Fe=te*2,$e=te*4;return this.uint32[Fe+0]=ce,this.uint16[$e+2]=me,this.uint16[$e+3]=Ae,te},L}(gi);Hu.prototype.bytesPerElement=8,Ea("StructArrayLayout1ul2ui8",Hu);var bf=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce){var me=this.length;return this.resize(me+1),this.emplace(me,te,ce)},L.prototype.emplace=function(te,ce,me){var Ae=te*2;return this.uint16[Ae+0]=ce,this.uint16[Ae+1]=me,te},L}(gi);bf.prototype.bytesPerElement=4,Ea("StructArrayLayout2ui4",bf);var lf=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te){var ce=this.length;return this.resize(ce+1),this.emplace(ce,te)},L.prototype.emplace=function(te,ce){var me=te*1;return this.uint16[me+0]=ce,te},L}(gi);lf.prototype.bytesPerElement=2,Ea("StructArrayLayout1ui2",lf);var Gu=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce){var me=this.length;return this.resize(me+1),this.emplace(me,te,ce)},L.prototype.emplace=function(te,ce,me){var Ae=te*2;return this.float32[Ae+0]=ce,this.float32[Ae+1]=me,te},L}(gi);Gu.prototype.bytesPerElement=8,Ea("StructArrayLayout2f8",Gu);var ic=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},L.prototype.emplaceBack=function(te,ce,me,Ae){var Fe=this.length;return this.resize(Fe+1),this.emplace(Fe,te,ce,me,Ae)},L.prototype.emplace=function(te,ce,me,Ae,Fe){var $e=te*4;return this.float32[$e+0]=ce,this.float32[$e+1]=me,this.float32[$e+2]=Ae,this.float32[$e+3]=Fe,te},L}(gi);ic.prototype.bytesPerElement=16,Ea("StructArrayLayout4f16",ic);var Sc=function(C){function L(){C.apply(this,arguments)}C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L;var N={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return N.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},N.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},N.x1.get=function(){return this._structArray.int16[this._pos2+2]},N.y1.get=function(){return this._structArray.int16[this._pos2+3]},N.x2.get=function(){return this._structArray.int16[this._pos2+4]},N.y2.get=function(){return this._structArray.int16[this._pos2+5]},N.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},N.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},N.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},N.anchorPoint.get=function(){return new i(this.anchorPointX,this.anchorPointY)},Object.defineProperties(L.prototype,N),L}(Ei);Sc.prototype.size=20;var Yu=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.get=function(te){return new Sc(this,te)},L}(mf);Ea("CollisionBoxArray",Yu);var oc=function(C){function L(){C.apply(this,arguments)}C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L;var N={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return N.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},N.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},N.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},N.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},N.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},N.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},N.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},N.segment.get=function(){return this._structArray.uint16[this._pos2+10]},N.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},N.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},N.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},N.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},N.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},N.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},N.placedOrientation.set=function(te){this._structArray.uint8[this._pos1+37]=te},N.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},N.hidden.set=function(te){this._structArray.uint8[this._pos1+38]=te},N.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},N.crossTileID.set=function(te){this._structArray.uint32[this._pos4+10]=te},N.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(L.prototype,N),L}(Ei);oc.prototype.size=48;var uf=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.get=function(te){return new oc(this,te)},L}(xf);Ea("PlacedSymbolArray",uf);var kc=function(C){function L(){C.apply(this,arguments)}C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L;var N={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return N.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},N.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},N.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},N.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},N.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},N.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},N.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},N.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},N.key.get=function(){return this._structArray.uint16[this._pos2+8]},N.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},N.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},N.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},N.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},N.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},N.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},N.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},N.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},N.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},N.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},N.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},N.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},N.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},N.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},N.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},N.crossTileID.set=function(te){this._structArray.uint32[this._pos4+12]=te},N.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},N.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},N.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},N.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(L.prototype,N),L}(Ei);kc.prototype.size=68;var Ec=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.get=function(te){return new kc(this,te)},L}(Pf);Ea("SymbolInstanceArray",Ec);var Zl=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.getoffsetX=function(te){return this.float32[te*1+0]},L}(sf);Ea("GlyphOffsetArray",Zl);var Cc=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.getx=function(te){return this.int16[te*3+0]},L.prototype.gety=function(te){return this.int16[te*3+1]},L.prototype.gettileUnitDistanceFromAnchor=function(te){return this.int16[te*3+2]},L}(ac);Ea("SymbolLineVertexArray",Cc);var Lc=function(C){function L(){C.apply(this,arguments)}C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L;var N={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return N.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},N.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},N.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(L.prototype,N),L}(Ei);Lc.prototype.size=8;var sc=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.get=function(te){return new Lc(this,te)},L}(Hu);Ea("FeatureIndexArray",sc);var Pc=lo([{name:"a_pos",components:2,type:"Int16"}],4),fe=Pc.members,Y=function(L){L===void 0&&(L=[]),this.segments=L};Y.prototype.prepareSegment=function(L,N,te,ce){var me=this.segments[this.segments.length-1];return L>Y.MAX_VERTEX_ARRAY_LENGTH&&F("Max vertices per segment is "+Y.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+L),(!me||me.vertexLength+L>Y.MAX_VERTEX_ARRAY_LENGTH||me.sortKey!==ce)&&(me={vertexOffset:N.length,primitiveOffset:te.length,vertexLength:0,primitiveLength:0},ce!==void 0&&(me.sortKey=ce),this.segments.push(me)),me},Y.prototype.get=function(){return this.segments},Y.prototype.destroy=function(){for(var L=0,N=this.segments;L<N.length;L+=1){var te=N[L];for(var ce in te.vaos)te.vaos[ce].destroy()}},Y.simpleSegment=function(L,N,te,ce){return new Y([{vertexOffset:L,primitiveOffset:N,vertexLength:te,primitiveLength:ce,vaos:{},sortKey:0}])},Y.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ea("SegmentVector",Y);function he(C,L){return C=x(Math.floor(C),0,255),L=x(Math.floor(L),0,255),256*C+L}var $=lo([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),ve=p(function(C){function L(N,te){var ce,me,Ae,Fe,$e,ft,dt,Pt;for(ce=N.length&3,me=N.length-ce,Ae=te,$e=3432918353,ft=461845907,Pt=0;Pt<me;)dt=N.charCodeAt(Pt)&255|(N.charCodeAt(++Pt)&255)<<8|(N.charCodeAt(++Pt)&255)<<16|(N.charCodeAt(++Pt)&255)<<24,++Pt,dt=(dt&65535)*$e+(((dt>>>16)*$e&65535)<<16)&4294967295,dt=dt<<15|dt>>>17,dt=(dt&65535)*ft+(((dt>>>16)*ft&65535)<<16)&4294967295,Ae^=dt,Ae=Ae<<13|Ae>>>19,Fe=(Ae&65535)*5+(((Ae>>>16)*5&65535)<<16)&4294967295,Ae=(Fe&65535)+27492+(((Fe>>>16)+58964&65535)<<16);switch(dt=0,ce){case 3:dt^=(N.charCodeAt(Pt+2)&255)<<16;case 2:dt^=(N.charCodeAt(Pt+1)&255)<<8;case 1:dt^=N.charCodeAt(Pt)&255,dt=(dt&65535)*$e+(((dt>>>16)*$e&65535)<<16)&4294967295,dt=dt<<15|dt>>>17,dt=(dt&65535)*ft+(((dt>>>16)*ft&65535)<<16)&4294967295,Ae^=dt}return Ae^=N.length,Ae^=Ae>>>16,Ae=(Ae&65535)*2246822507+(((Ae>>>16)*2246822507&65535)<<16)&4294967295,Ae^=Ae>>>13,Ae=(Ae&65535)*3266489909+(((Ae>>>16)*3266489909&65535)<<16)&4294967295,Ae^=Ae>>>16,Ae>>>0}C.exports=L}),Se=p(function(C){function L(N,te){for(var ce=N.length,me=te^ce,Ae=0,Fe;ce>=4;)Fe=N.charCodeAt(Ae)&255|(N.charCodeAt(++Ae)&255)<<8|(N.charCodeAt(++Ae)&255)<<16|(N.charCodeAt(++Ae)&255)<<24,Fe=(Fe&65535)*1540483477+(((Fe>>>16)*1540483477&65535)<<16),Fe^=Fe>>>24,Fe=(Fe&65535)*1540483477+(((Fe>>>16)*1540483477&65535)<<16),me=(me&65535)*1540483477+(((me>>>16)*1540483477&65535)<<16)^Fe,ce-=4,++Ae;switch(ce){case 3:me^=(N.charCodeAt(Ae+2)&255)<<16;case 2:me^=(N.charCodeAt(Ae+1)&255)<<8;case 1:me^=N.charCodeAt(Ae)&255,me=(me&65535)*1540483477+(((me>>>16)*1540483477&65535)<<16)}return me^=me>>>13,me=(me&65535)*1540483477+(((me>>>16)*1540483477&65535)<<16),me^=me>>>15,me>>>0}C.exports=L}),Re=ve,Ze=ve,ut=Se;Re.murmur3=Ze,Re.murmur2=ut;var At=function(){this.ids=[],this.positions=[],this.indexed=!1};At.prototype.add=function(L,N,te,ce){this.ids.push(nr(L)),this.positions.push(N,te,ce)},At.prototype.getPositions=function(L){for(var N=nr(L),te=0,ce=this.ids.length-1;te<ce;){var me=te+ce>>1;this.ids[me]>=N?ce=me:te=me+1}for(var Ae=[];this.ids[te]===N;){var Fe=this.positions[3*te],$e=this.positions[3*te+1],ft=this.positions[3*te+2];Ae.push({index:Fe,start:$e,end:ft}),te++}return Ae},At.serialize=function(L,N){var te=new Float64Array(L.ids),ce=new Uint32Array(L.positions);return sr(te,ce,0,te.length-1),N&&N.push(te.buffer,ce.buffer),{ids:te,positions:ce}},At.deserialize=function(L){var N=new At;return N.ids=L.ids,N.positions=L.positions,N.indexed=!0,N};var Ut=Math.pow(2,53)-1;function nr(C){var L=+C;return!isNaN(L)&&L<=Ut?L:Re(String(C))}function sr(C,L,N,te){for(;N<te;){for(var ce=C[N+te>>1],me=N-1,Ae=te+1;;){do me++;while(C[me]<ce);do Ae--;while(C[Ae]>ce);if(me>=Ae)break;Tr(C,me,Ae),Tr(L,3*me,3*Ae),Tr(L,3*me+1,3*Ae+1),Tr(L,3*me+2,3*Ae+2)}Ae-N<te-Ae?(sr(C,L,N,Ae),N=Ae+1):(sr(C,L,Ae+1,te),te=Ae)}}function Tr(C,L,N){var te=C[L];C[L]=C[N],C[N]=te}Ea("FeaturePositionMap",At);var Ur=function(L,N){this.gl=L.gl,this.location=N},Hr=function(C){function L(N,te){C.call(this,N,te),this.current=0}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.set=function(te){this.current!==te&&(this.current=te,this.gl.uniform1i(this.location,te))},L}(Ur),Fr=function(C){function L(N,te){C.call(this,N,te),this.current=0}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.set=function(te){this.current!==te&&(this.current=te,this.gl.uniform1f(this.location,te))},L}(Ur),Zr=function(C){function L(N,te){C.call(this,N,te),this.current=[0,0]}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.set=function(te){(te[0]!==this.current[0]||te[1]!==this.current[1])&&(this.current=te,this.gl.uniform2f(this.location,te[0],te[1]))},L}(Ur),fn=function(C){function L(N,te){C.call(this,N,te),this.current=[0,0,0]}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.set=function(te){(te[0]!==this.current[0]||te[1]!==this.current[1]||te[2]!==this.current[2])&&(this.current=te,this.gl.uniform3f(this.location,te[0],te[1],te[2]))},L}(Ur),En=function(C){function L(N,te){C.call(this,N,te),this.current=[0,0,0,0]}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.set=function(te){(te[0]!==this.current[0]||te[1]!==this.current[1]||te[2]!==this.current[2]||te[3]!==this.current[3])&&(this.current=te,this.gl.uniform4f(this.location,te[0],te[1],te[2],te[3]))},L}(Ur),Nn=function(C){function L(N,te){C.call(this,N,te),this.current=mi.transparent}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.set=function(te){(te.r!==this.current.r||te.g!==this.current.g||te.b!==this.current.b||te.a!==this.current.a)&&(this.current=te,this.gl.uniform4f(this.location,te.r,te.g,te.b,te.a))},L}(Ur),jn=new Float32Array(16),Qn=function(C){function L(N,te){C.call(this,N,te),this.current=jn}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.set=function(te){if(te[12]!==this.current[12]||te[0]!==this.current[0]){this.current=te,this.gl.uniformMatrix4fv(this.location,!1,te);return}for(var ce=1;ce<16;ce++)if(te[ce]!==this.current[ce]){this.current=te,this.gl.uniformMatrix4fv(this.location,!1,te);break}},L}(Ur);function Kn(C){return[he(255*C.r,255*C.g),he(255*C.b,255*C.a)]}var ha=function(L,N,te){this.value=L,this.uniformNames=N.map(function(ce){return"u_"+ce}),this.type=te};ha.prototype.setUniform=function(L,N,te){L.set(te.constantOr(this.value))},ha.prototype.getBinding=function(L,N,te){return this.type==="color"?new Nn(L,N):new Fr(L,N)};var xa=function(L,N){this.uniformNames=N.map(function(te){return"u_"+te}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};xa.prototype.setConstantPatternPositions=function(L,N){this.pixelRatioFrom=N.pixelRatio,this.pixelRatioTo=L.pixelRatio,this.patternFrom=N.tlbr,this.patternTo=L.tlbr},xa.prototype.setUniform=function(L,N,te,ce){var me=ce==="u_pattern_to"?this.patternTo:ce==="u_pattern_from"?this.patternFrom:ce==="u_pixel_ratio_to"?this.pixelRatioTo:ce==="u_pixel_ratio_from"?this.pixelRatioFrom:null;me&&L.set(me)},xa.prototype.getBinding=function(L,N,te){return te.substr(0,9)==="u_pattern"?new En(L,N):new Fr(L,N)};var ma=function(L,N,te,ce){this.expression=L,this.type=te,this.maxValue=0,this.paintVertexAttributes=N.map(function(me){return{name:"a_"+me,type:"Float32",components:te==="color"?2:1,offset:0}}),this.paintVertexArray=new ce};ma.prototype.populatePaintArray=function(L,N,te,ce,me){var Ae=this.paintVertexArray.length,Fe=this.expression.evaluate(new ci(0),N,{},ce,[],me);this.paintVertexArray.resize(L),this._setPaintValue(Ae,L,Fe)},ma.prototype.updatePaintArray=function(L,N,te,ce){var me=this.expression.evaluate({zoom:0},te,ce);this._setPaintValue(L,N,me)},ma.prototype._setPaintValue=function(L,N,te){if(this.type==="color")for(var ce=Kn(te),me=L;me<N;me++)this.paintVertexArray.emplace(me,ce[0],ce[1]);else{for(var Ae=L;Ae<N;Ae++)this.paintVertexArray.emplace(Ae,te);this.maxValue=Math.max(this.maxValue,Math.abs(te))}},ma.prototype.upload=function(L){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=L.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ma.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ta=function(L,N,te,ce,me,Ae){this.expression=L,this.uniformNames=N.map(function(Fe){return"u_"+Fe+"_t"}),this.type=te,this.useIntegerZoom=ce,this.zoom=me,this.maxValue=0,this.paintVertexAttributes=N.map(function(Fe){return{name:"a_"+Fe,type:"Float32",components:te==="color"?4:2,offset:0}}),this.paintVertexArray=new Ae};Ta.prototype.populatePaintArray=function(L,N,te,ce,me){var Ae=this.expression.evaluate(new ci(this.zoom),N,{},ce,[],me),Fe=this.expression.evaluate(new ci(this.zoom+1),N,{},ce,[],me),$e=this.paintVertexArray.length;this.paintVertexArray.resize(L),this._setPaintValue($e,L,Ae,Fe)},Ta.prototype.updatePaintArray=function(L,N,te,ce){var me=this.expression.evaluate({zoom:this.zoom},te,ce),Ae=this.expression.evaluate({zoom:this.zoom+1},te,ce);this._setPaintValue(L,N,me,Ae)},Ta.prototype._setPaintValue=function(L,N,te,ce){if(this.type==="color")for(var me=Kn(te),Ae=Kn(ce),Fe=L;Fe<N;Fe++)this.paintVertexArray.emplace(Fe,me[0],me[1],Ae[0],Ae[1]);else{for(var $e=L;$e<N;$e++)this.paintVertexArray.emplace($e,te,ce);this.maxValue=Math.max(this.maxValue,Math.abs(te),Math.abs(ce))}},Ta.prototype.upload=function(L){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=L.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ta.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ta.prototype.setUniform=function(L,N){var te=this.useIntegerZoom?Math.floor(N.zoom):N.zoom,ce=x(this.expression.interpolationFactor(te,this.zoom,this.zoom+1),0,1);L.set(ce)},Ta.prototype.getBinding=function(L,N,te){return new Fr(L,N)};var Pa=function(L,N,te,ce,me,Ae){this.expression=L,this.type=N,this.useIntegerZoom=te,this.zoom=ce,this.layerId=Ae,this.zoomInPaintVertexArray=new me,this.zoomOutPaintVertexArray=new me};Pa.prototype.populatePaintArray=function(L,N,te){var ce=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(L),this.zoomOutPaintVertexArray.resize(L),this._setPaintValues(ce,L,N.patterns&&N.patterns[this.layerId],te)},Pa.prototype.updatePaintArray=function(L,N,te,ce,me){this._setPaintValues(L,N,te.patterns&&te.patterns[this.layerId],me)},Pa.prototype._setPaintValues=function(L,N,te,ce){if(!(!ce||!te)){var me=te.min,Ae=te.mid,Fe=te.max,$e=ce[me],ft=ce[Ae],dt=ce[Fe];if(!(!$e||!ft||!dt))for(var Pt=L;Pt<N;Pt++)this.zoomInPaintVertexArray.emplace(Pt,ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],$e.tl[0],$e.tl[1],$e.br[0],$e.br[1],ft.pixelRatio,$e.pixelRatio),this.zoomOutPaintVertexArray.emplace(Pt,ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],dt.tl[0],dt.tl[1],dt.br[0],dt.br[1],ft.pixelRatio,dt.pixelRatio)}},Pa.prototype.upload=function(L){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=L.createVertexBuffer(this.zoomInPaintVertexArray,$.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=L.createVertexBuffer(this.zoomOutPaintVertexArray,$.members,this.expression.isStateDependent))},Pa.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Za=function(L,N,te,ce){this.binders={},this.layoutAttributes=ce,this._buffers=[];var me=[];for(var Ae in L.paint._values)if(!!te(Ae)){var Fe=L.paint.get(Ae);if(!(!(Fe instanceof Hi)||!li(Fe.property.specification))){var $e=Ni(Ae,L.type),ft=Fe.value,dt=Fe.property.specification.type,Pt=Fe.property.useIntegerZoom,Jt=Fe.property.specification["property-type"],Yt=Jt==="cross-faded"||Jt==="cross-faded-data-driven";if(ft.kind==="constant")this.binders[Ae]=Yt?new xa(ft.value,$e):new ha(ft.value,$e,dt),me.push("/u_"+Ae);else if(ft.kind==="source"||Yt){var ur=wi(Ae,dt,"source");this.binders[Ae]=Yt?new Pa(ft,dt,Pt,N,ur,L.id):new ma(ft,$e,dt,ur),me.push("/a_"+Ae)}else{var Dr=wi(Ae,dt,"composite");this.binders[Ae]=new Ta(ft,$e,dt,Pt,N,Dr),me.push("/z_"+Ae)}}}this.cacheKey=me.sort().join("")};Za.prototype.getMaxValue=function(L){var N=this.binders[L];return N instanceof ma||N instanceof Ta?N.maxValue:0},Za.prototype.populatePaintArrays=function(L,N,te,ce,me){for(var Ae in this.binders){var Fe=this.binders[Ae];(Fe instanceof ma||Fe instanceof Ta||Fe instanceof Pa)&&Fe.populatePaintArray(L,N,te,ce,me)}},Za.prototype.setConstantPatternPositions=function(L,N){for(var te in this.binders){var ce=this.binders[te];ce instanceof xa&&ce.setConstantPatternPositions(L,N)}},Za.prototype.updatePaintArrays=function(L,N,te,ce,me){var Ae=!1;for(var Fe in L)for(var $e=N.getPositions(Fe),ft=0,dt=$e;ft<dt.length;ft+=1){var Pt=dt[ft],Jt=te.feature(Pt.index);for(var Yt in this.binders){var ur=this.binders[Yt];if((ur instanceof ma||ur instanceof Ta||ur instanceof Pa)&&ur.expression.isStateDependent===!0){var Dr=ce.paint.get(Yt);ur.expression=Dr.value,ur.updatePaintArray(Pt.start,Pt.end,Jt,L[Fe],me),Ae=!0}}}return Ae},Za.prototype.defines=function(){var L=[];for(var N in this.binders){var te=this.binders[N];(te instanceof ha||te instanceof xa)&&L.push.apply(L,te.uniformNames.map(function(ce){return"#define HAS_UNIFORM_"+ce}))}return L},Za.prototype.getPaintVertexBuffers=function(){return this._buffers},Za.prototype.getUniforms=function(L,N){var te=[];for(var ce in this.binders){var me=this.binders[ce];if(me instanceof ha||me instanceof xa||me instanceof Ta)for(var Ae=0,Fe=me.uniformNames;Ae<Fe.length;Ae+=1){var $e=Fe[Ae];if(N[$e]){var ft=me.getBinding(L,N[$e],$e);te.push({name:$e,property:ce,binding:ft})}}}return te},Za.prototype.setUniforms=function(L,N,te,ce){for(var me=0,Ae=N;me<Ae.length;me+=1){var Fe=Ae[me],$e=Fe.name,ft=Fe.property,dt=Fe.binding;this.binders[ft].setUniform(dt,ce,te.get(ft),$e)}},Za.prototype.updatePaintBuffers=function(L){this._buffers=[];for(var N in this.binders){var te=this.binders[N];if(L&&te instanceof Pa){var ce=L.fromScale===2?te.zoomInPaintVertexBuffer:te.zoomOutPaintVertexBuffer;ce&&this._buffers.push(ce)}else(te instanceof ma||te instanceof Ta)&&te.paintVertexBuffer&&this._buffers.push(te.paintVertexBuffer)}},Za.prototype.upload=function(L){for(var N in this.binders){var te=this.binders[N];(te instanceof ma||te instanceof Ta||te instanceof Pa)&&te.upload(L)}this.updatePaintBuffers()},Za.prototype.destroy=function(){for(var L in this.binders){var N=this.binders[L];(N instanceof ma||N instanceof Ta||N instanceof Pa)&&N.destroy()}};var ai=function(L,N,te,ce){ce===void 0&&(ce=function(){return!0}),this.programConfigurations={};for(var me=0,Ae=N;me<Ae.length;me+=1){var Fe=Ae[me];this.programConfigurations[Fe.id]=new Za(Fe,te,ce,L)}this.needsUpload=!1,this._featureMap=new At,this._bufferOffset=0};ai.prototype.populatePaintArrays=function(L,N,te,ce,me,Ae){for(var Fe in this.programConfigurations)this.programConfigurations[Fe].populatePaintArrays(L,N,ce,me,Ae);N.id!==void 0&&this._featureMap.add(N.id,te,this._bufferOffset,L),this._bufferOffset=L,this.needsUpload=!0},ai.prototype.updatePaintArrays=function(L,N,te,ce){for(var me=0,Ae=te;me<Ae.length;me+=1){var Fe=Ae[me];this.needsUpload=this.programConfigurations[Fe.id].updatePaintArrays(L,this._featureMap,N,Fe,ce)||this.needsUpload}},ai.prototype.get=function(L){return this.programConfigurations[L]},ai.prototype.upload=function(L){if(!!this.needsUpload){for(var N in this.programConfigurations)this.programConfigurations[N].upload(L);this.needsUpload=!1}},ai.prototype.destroy=function(){for(var L in this.programConfigurations)this.programConfigurations[L].destroy()};function Ni(C,L){var N={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]};return N[C]||[C.replace(L+"-","").replace(/-/g,"_")]}function ui(C){var L={"line-pattern":{source:Bs,composite:Bs},"fill-pattern":{source:Bs,composite:Bs},"fill-extrusion-pattern":{source:Bs,composite:Bs}};return L[C]}function wi(C,L,N){var te={color:{source:Gu,composite:ic},number:{source:sf,composite:Gu}},ce=ui(C);return ce&&ce[N]||te[L][N]}Ea("ConstantBinder",ha),Ea("CrossFadedConstantBinder",xa),Ea("SourceExpressionBinder",ma),Ea("CrossFadedCompositeBinder",Pa),Ea("CompositeExpressionBinder",Ta),Ea("ProgramConfiguration",Za,{omit:["_buffers"]}),Ea("ProgramConfigurationSet",ai);var Va=8192;function Ui(C){return{min:-1*Math.pow(2,C-1),max:Math.pow(2,C-1)-1}}var Gi=Ui(15);function Wi(C){for(var L=Va/C.extent,N=C.loadGeometry(),te=0;te<N.length;te++)for(var ce=N[te],me=0;me<ce.length;me++){var Ae=ce[me];Ae.x=Math.round(Ae.x*L),Ae.y=Math.round(Ae.y*L),(Ae.x<Gi.min||Ae.x>Gi.max||Ae.y<Gi.min||Ae.y>Gi.max)&&(F("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Ae.x=x(Ae.x,Gi.min,Gi.max),Ae.y=x(Ae.y,Gi.min,Gi.max))}return N}function Ci(C,L,N,te,ce){C.emplaceBack(L*2+(te+1)/2,N*2+(ce+1)/2)}var $i=function(L){this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function(N){return N.id}),this.index=L.index,this.hasPattern=!1,this.layoutVertexArray=new lu,this.indexArray=new Tu,this.segments=new Y,this.programConfigurations=new ai(fe,L.layers,L.zoom),this.stateDependentLayerIds=this.layers.filter(function(N){return N.isStateDependent()}).map(function(N){return N.id})};$i.prototype.populate=function(L,N,te){var ce=this.layers[0],me=[],Ae=null;ce.type==="circle"&&(Ae=ce.layout.get("circle-sort-key"));for(var Fe=0,$e=L;Fe<$e.length;Fe+=1){var ft=$e[Fe],dt=ft.feature,Pt=ft.id,Jt=ft.index,Yt=ft.sourceLayerIndex,ur=this.layers[0]._featureFilter.needGeometry,Dr={type:dt.type,id:Pt,properties:dt.properties,geometry:ur?Wi(dt):[]};if(!!this.layers[0]._featureFilter.filter(new ci(this.zoom),Dr,te)){ur||(Dr.geometry=Wi(dt));var rn=Ae?Ae.evaluate(Dr,{},te):void 0,Jr={id:Pt,properties:dt.properties,type:dt.type,sourceLayerIndex:Yt,index:Jt,geometry:Dr.geometry,patterns:{},sortKey:rn};me.push(Jr)}}Ae&&me.sort(function(_a,Sa){return _a.sortKey-Sa.sortKey});for(var kn=0,mn=me;kn<mn.length;kn+=1){var Mn=mn[kn],zn=Mn,Yn=zn.geometry,la=zn.index,ia=zn.sourceLayerIndex,Ba=L[la].feature;this.addFeature(Mn,Yn,la,te),N.featureIndex.insert(Ba,Yn,la,ia,this.index)}},$i.prototype.update=function(L,N,te){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(L,N,this.stateDependentLayers,te)},$i.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},$i.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},$i.prototype.upload=function(L){this.uploaded||(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,fe),this.indexBuffer=L.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(L),this.uploaded=!0},$i.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},$i.prototype.addFeature=function(L,N,te,ce){for(var me=0,Ae=N;me<Ae.length;me+=1)for(var Fe=Ae[me],$e=0,ft=Fe;$e<ft.length;$e+=1){var dt=ft[$e],Pt=dt.x,Jt=dt.y;if(!(Pt<0||Pt>=Va||Jt<0||Jt>=Va)){var Yt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,L.sortKey),ur=Yt.vertexLength;Ci(this.layoutVertexArray,Pt,Jt,-1,-1),Ci(this.layoutVertexArray,Pt,Jt,1,-1),Ci(this.layoutVertexArray,Pt,Jt,1,1),Ci(this.layoutVertexArray,Pt,Jt,-1,1),this.indexArray.emplaceBack(ur,ur+1,ur+2),this.indexArray.emplaceBack(ur,ur+3,ur+2),Yt.vertexLength+=4,Yt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,L,te,{},ce)},Ea("CircleBucket",$i,{omit:["layers"]});function oi(C,L){for(var N=0;N<C.length;N++)if(Ns(L,C[N]))return!0;for(var te=0;te<L.length;te++)if(Ns(C,L[te]))return!0;return!!Rl(C,L)}function Li(C,L,N){return!!(Ns(C,L)||fu(L,C,N))}function Ao(C,L){if(C.length===1)return cu(L,C[0]);for(var N=0;N<L.length;N++)for(var te=L[N],ce=0;ce<te.length;ce++)if(Ns(C,te[ce]))return!0;for(var me=0;me<C.length;me++)if(cu(L,C[me]))return!0;for(var Ae=0;Ae<L.length;Ae++)if(Rl(C,L[Ae]))return!0;return!1}function Oo(C,L,N){for(var te=0;te<L.length;te++){var ce=L[te];if(C.length>=3){for(var me=0;me<ce.length;me++)if(Ns(C,ce[me]))return!0}if(Dl(C,ce,N))return!0}return!1}function Dl(C,L,N){if(C.length>1){if(Rl(C,L))return!0;for(var te=0;te<L.length;te++)if(fu(L[te],C,N))return!0}for(var ce=0;ce<C.length;ce++)if(fu(C[ce],L,N))return!0;return!1}function Rl(C,L){if(C.length===0||L.length===0)return!1;for(var N=0;N<C.length-1;N++)for(var te=C[N],ce=C[N+1],me=0;me<L.length-1;me++){var Ae=L[me],Fe=L[me+1];if(uu(te,ce,Ae,Fe))return!0}return!1}function uu(C,L,N,te){return D(C,N,te)!==D(L,N,te)&&D(C,L,N)!==D(C,L,te)}function fu(C,L,N){var te=N*N;if(L.length===1)return C.distSqr(L[0])<te;for(var ce=1;ce<L.length;ce++){var me=L[ce-1],Ae=L[ce];if(Au(C,me,Ae)<te)return!0}return!1}function Au(C,L,N){var te=L.distSqr(N);if(te===0)return C.distSqr(L);var ce=((C.x-L.x)*(N.x-L.x)+(C.y-L.y)*(N.y-L.y))/te;return ce<0?C.distSqr(L):ce>1?C.distSqr(N):C.distSqr(N.sub(L)._mult(ce)._add(L))}function cu(C,L){for(var N=!1,te,ce,me,Ae=0;Ae<C.length;Ae++){te=C[Ae];for(var Fe=0,$e=te.length-1;Fe<te.length;$e=Fe++)ce=te[Fe],me=te[$e],ce.y>L.y!=me.y>L.y&&L.x<(me.x-ce.x)*(L.y-ce.y)/(me.y-ce.y)+ce.x&&(N=!N)}return N}function Ns(C,L){for(var N=!1,te=0,ce=C.length-1;te<C.length;ce=te++){var me=C[te],Ae=C[ce];me.y>L.y!=Ae.y>L.y&&L.x<(Ae.x-me.x)*(L.y-me.y)/(Ae.y-me.y)+me.x&&(N=!N)}return N}function Wu(C,L,N,te,ce){for(var me=0,Ae=C;me<Ae.length;me+=1){var Fe=Ae[me];if(L<=Fe.x&&N<=Fe.y&&te>=Fe.x&&ce>=Fe.y)return!0}var $e=[new i(L,N),new i(L,ce),new i(te,ce),new i(te,N)];if(C.length>2)for(var ft=0,dt=$e;ft<dt.length;ft+=1){var Pt=dt[ft];if(Ns(C,Pt))return!0}for(var Jt=0;Jt<C.length-1;Jt++){var Yt=C[Jt],ur=C[Jt+1];if(bs(Yt,ur,$e))return!0}return!1}function bs(C,L,N){var te=N[0],ce=N[2];if(C.x<te.x&&L.x<te.x||C.x>ce.x&&L.x>ce.x||C.y<te.y&&L.y<te.y||C.y>ce.y&&L.y>ce.y)return!1;var me=D(C,L,N[0]);return me!==D(C,L,N[1])||me!==D(C,L,N[2])||me!==D(C,L,N[3])}function bl(C,L,N){var te=L.paint.get(C).value;return te.kind==="constant"?te.value:N.programConfigurations.get(L.id).getMaxValue(C)}function hu(C){return Math.sqrt(C[0]*C[0]+C[1]*C[1])}function jl(C,L,N,te,ce){if(!L[0]&&!L[1])return C;var me=i.convert(L)._mult(ce);N==="viewport"&&me._rotate(-te);for(var Ae=[],Fe=0;Fe<C.length;Fe++){var $e=C[Fe];Ae.push($e.sub(me))}return Ae}var vu=new Yi({"circle-sort-key":new Ia(Ft.layout_circle["circle-sort-key"])}),Df=new Yi({"circle-radius":new Ia(Ft.paint_circle["circle-radius"]),"circle-color":new Ia(Ft.paint_circle["circle-color"]),"circle-blur":new Ia(Ft.paint_circle["circle-blur"]),"circle-opacity":new Ia(Ft.paint_circle["circle-opacity"]),"circle-translate":new Ma(Ft.paint_circle["circle-translate"]),"circle-translate-anchor":new Ma(Ft.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ma(Ft.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ma(Ft.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ia(Ft.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ia(Ft.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ia(Ft.paint_circle["circle-stroke-opacity"])}),$u={paint:Df,layout:vu},us=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var C=arguments,L=0,N=arguments.length;N--;)L+=C[N]*C[N];return Math.sqrt(L)});function _f(){var C=new us(4);return us!=Float32Array&&(C[1]=0,C[2]=0),C[0]=1,C[3]=1,C}function ks(C,L,N){var te=L[0],ce=L[1],me=L[2],Ae=L[3],Fe=Math.sin(N),$e=Math.cos(N);return C[0]=te*$e+me*Fe,C[1]=ce*$e+Ae*Fe,C[2]=te*-Fe+me*$e,C[3]=ce*-Fe+Ae*$e,C}function wf(){var C=new us(9);return us!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[5]=0,C[6]=0,C[7]=0),C[0]=1,C[4]=1,C[8]=1,C}function Rf(C,L){var N=Math.sin(L),te=Math.cos(L);return C[0]=te,C[1]=N,C[2]=0,C[3]=-N,C[4]=te,C[5]=0,C[6]=0,C[7]=0,C[8]=1,C}function If(){var C=new us(16);return us!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=0,C[12]=0,C[13]=0,C[14]=0),C[0]=1,C[5]=1,C[10]=1,C[15]=1,C}function Dc(C){var L=new us(16);return L[0]=C[0],L[1]=C[1],L[2]=C[2],L[3]=C[3],L[4]=C[4],L[5]=C[5],L[6]=C[6],L[7]=C[7],L[8]=C[8],L[9]=C[9],L[10]=C[10],L[11]=C[11],L[12]=C[12],L[13]=C[13],L[14]=C[14],L[15]=C[15],L}function zf(C){return C[0]=1,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=1,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=1,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,C}function ff(C,L){var N=L[0],te=L[1],ce=L[2],me=L[3],Ae=L[4],Fe=L[5],$e=L[6],ft=L[7],dt=L[8],Pt=L[9],Jt=L[10],Yt=L[11],ur=L[12],Dr=L[13],rn=L[14],Jr=L[15],kn=N*Fe-te*Ae,mn=N*$e-ce*Ae,Mn=N*ft-me*Ae,zn=te*$e-ce*Fe,Yn=te*ft-me*Fe,la=ce*ft-me*$e,ia=dt*Dr-Pt*ur,Ba=dt*rn-Jt*ur,_a=dt*Jr-Yt*ur,Sa=Pt*rn-Jt*Dr,ni=Pt*Jr-Yt*Dr,Da=Jt*Jr-Yt*rn,za=kn*Da-mn*ni+Mn*Sa+zn*_a-Yn*Ba+la*ia;return za?(za=1/za,C[0]=(Fe*Da-$e*ni+ft*Sa)*za,C[1]=(ce*ni-te*Da-me*Sa)*za,C[2]=(Dr*la-rn*Yn+Jr*zn)*za,C[3]=(Jt*Yn-Pt*la-Yt*zn)*za,C[4]=($e*_a-Ae*Da-ft*Ba)*za,C[5]=(N*Da-ce*_a+me*Ba)*za,C[6]=(rn*Mn-ur*la-Jr*mn)*za,C[7]=(dt*la-Jt*Mn+Yt*mn)*za,C[8]=(Ae*ni-Fe*_a+ft*ia)*za,C[9]=(te*_a-N*ni-me*ia)*za,C[10]=(ur*Yn-Dr*Mn+Jr*kn)*za,C[11]=(Pt*Mn-dt*Yn-Yt*kn)*za,C[12]=(Fe*Ba-Ae*Sa-$e*ia)*za,C[13]=(N*Sa-te*Ba+ce*ia)*za,C[14]=(Dr*mn-ur*zn-rn*kn)*za,C[15]=(dt*zn-Pt*mn+Jt*kn)*za,C):null}function cf(C,L,N){var te=L[0],ce=L[1],me=L[2],Ae=L[3],Fe=L[4],$e=L[5],ft=L[6],dt=L[7],Pt=L[8],Jt=L[9],Yt=L[10],ur=L[11],Dr=L[12],rn=L[13],Jr=L[14],kn=L[15],mn=N[0],Mn=N[1],zn=N[2],Yn=N[3];return C[0]=mn*te+Mn*Fe+zn*Pt+Yn*Dr,C[1]=mn*ce+Mn*$e+zn*Jt+Yn*rn,C[2]=mn*me+Mn*ft+zn*Yt+Yn*Jr,C[3]=mn*Ae+Mn*dt+zn*ur+Yn*kn,mn=N[4],Mn=N[5],zn=N[6],Yn=N[7],C[4]=mn*te+Mn*Fe+zn*Pt+Yn*Dr,C[5]=mn*ce+Mn*$e+zn*Jt+Yn*rn,C[6]=mn*me+Mn*ft+zn*Yt+Yn*Jr,C[7]=mn*Ae+Mn*dt+zn*ur+Yn*kn,mn=N[8],Mn=N[9],zn=N[10],Yn=N[11],C[8]=mn*te+Mn*Fe+zn*Pt+Yn*Dr,C[9]=mn*ce+Mn*$e+zn*Jt+Yn*rn,C[10]=mn*me+Mn*ft+zn*Yt+Yn*Jr,C[11]=mn*Ae+Mn*dt+zn*ur+Yn*kn,mn=N[12],Mn=N[13],zn=N[14],Yn=N[15],C[12]=mn*te+Mn*Fe+zn*Pt+Yn*Dr,C[13]=mn*ce+Mn*$e+zn*Jt+Yn*rn,C[14]=mn*me+Mn*ft+zn*Yt+Yn*Jr,C[15]=mn*Ae+Mn*dt+zn*ur+Yn*kn,C}function Do(C,L,N){var te=N[0],ce=N[1],me=N[2],Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr,rn,Jr;return L===C?(C[12]=L[0]*te+L[4]*ce+L[8]*me+L[12],C[13]=L[1]*te+L[5]*ce+L[9]*me+L[13],C[14]=L[2]*te+L[6]*ce+L[10]*me+L[14],C[15]=L[3]*te+L[7]*ce+L[11]*me+L[15]):(Ae=L[0],Fe=L[1],$e=L[2],ft=L[3],dt=L[4],Pt=L[5],Jt=L[6],Yt=L[7],ur=L[8],Dr=L[9],rn=L[10],Jr=L[11],C[0]=Ae,C[1]=Fe,C[2]=$e,C[3]=ft,C[4]=dt,C[5]=Pt,C[6]=Jt,C[7]=Yt,C[8]=ur,C[9]=Dr,C[10]=rn,C[11]=Jr,C[12]=Ae*te+dt*ce+ur*me+L[12],C[13]=Fe*te+Pt*ce+Dr*me+L[13],C[14]=$e*te+Jt*ce+rn*me+L[14],C[15]=ft*te+Yt*ce+Jr*me+L[15]),C}function tl(C,L,N){var te=N[0],ce=N[1],me=N[2];return C[0]=L[0]*te,C[1]=L[1]*te,C[2]=L[2]*te,C[3]=L[3]*te,C[4]=L[4]*ce,C[5]=L[5]*ce,C[6]=L[6]*ce,C[7]=L[7]*ce,C[8]=L[8]*me,C[9]=L[9]*me,C[10]=L[10]*me,C[11]=L[11]*me,C[12]=L[12],C[13]=L[13],C[14]=L[14],C[15]=L[15],C}function rl(C,L,N){var te=Math.sin(N),ce=Math.cos(N),me=L[4],Ae=L[5],Fe=L[6],$e=L[7],ft=L[8],dt=L[9],Pt=L[10],Jt=L[11];return L!==C&&(C[0]=L[0],C[1]=L[1],C[2]=L[2],C[3]=L[3],C[12]=L[12],C[13]=L[13],C[14]=L[14],C[15]=L[15]),C[4]=me*ce+ft*te,C[5]=Ae*ce+dt*te,C[6]=Fe*ce+Pt*te,C[7]=$e*ce+Jt*te,C[8]=ft*ce-me*te,C[9]=dt*ce-Ae*te,C[10]=Pt*ce-Fe*te,C[11]=Jt*ce-$e*te,C}function Ff(C,L,N){var te=Math.sin(N),ce=Math.cos(N),me=L[0],Ae=L[1],Fe=L[2],$e=L[3],ft=L[4],dt=L[5],Pt=L[6],Jt=L[7];return L!==C&&(C[8]=L[8],C[9]=L[9],C[10]=L[10],C[11]=L[11],C[12]=L[12],C[13]=L[13],C[14]=L[14],C[15]=L[15]),C[0]=me*ce+ft*te,C[1]=Ae*ce+dt*te,C[2]=Fe*ce+Pt*te,C[3]=$e*ce+Jt*te,C[4]=ft*ce-me*te,C[5]=dt*ce-Ae*te,C[6]=Pt*ce-Fe*te,C[7]=Jt*ce-$e*te,C}function lc(C,L,N,te,ce){var me=1/Math.tan(L/2),Ae;return C[0]=me/N,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=me,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[11]=-1,C[12]=0,C[13]=0,C[15]=0,ce!=null&&ce!==1/0?(Ae=1/(te-ce),C[10]=(ce+te)*Ae,C[14]=2*ce*te*Ae):(C[10]=-1,C[14]=-2*te),C}function th(C,L,N,te,ce,me,Ae){var Fe=1/(L-N),$e=1/(te-ce),ft=1/(me-Ae);return C[0]=-2*Fe,C[1]=0,C[2]=0,C[3]=0,C[4]=0,C[5]=-2*$e,C[6]=0,C[7]=0,C[8]=0,C[9]=0,C[10]=2*ft,C[11]=0,C[12]=(L+N)*Fe,C[13]=(ce+te)*$e,C[14]=(Ae+me)*ft,C[15]=1,C}var rh=cf;function Tf(){var C=new us(3);return us!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0),C}function nh(C){var L=new us(3);return L[0]=C[0],L[1]=C[1],L[2]=C[2],L}function Of(C,L,N){return C[0]=L[0]+N[0],C[1]=L[1]+N[1],C[2]=L[2]+N[2],C}function ah(C,L,N){return C[0]=L[0]-N[0],C[1]=L[1]-N[1],C[2]=L[2]-N[2],C}function ih(C,L,N){return C[0]=L[0]*N,C[1]=L[1]*N,C[2]=L[2]*N,C}function uc(C,L){var N=L[0],te=L[1],ce=L[2],me=N*N+te*te+ce*ce;return me>0&&(me=1/Math.sqrt(me)),C[0]=L[0]*me,C[1]=L[1]*me,C[2]=L[2]*me,C}function rp(C,L){return C[0]*L[0]+C[1]*L[1]+C[2]*L[2]}function np(C,L,N){var te=L[0],ce=L[1],me=L[2],Ae=N[0],Fe=N[1],$e=N[2];return C[0]=ce*$e-me*Fe,C[1]=me*Ae-te*$e,C[2]=te*Fe-ce*Ae,C}function ap(C,L,N){var te=L[0],ce=L[1],me=L[2];return C[0]=te*N[0]+ce*N[3]+me*N[6],C[1]=te*N[1]+ce*N[4]+me*N[7],C[2]=te*N[2]+ce*N[5]+me*N[8],C}var ip=ah,ag=function(){var C=Tf();return function(L,N,te,ce,me,Ae){var Fe,$e;for(N||(N=3),te||(te=0),ce?$e=Math.min(ce*N+te,L.length):$e=L.length,Fe=te;Fe<$e;Fe+=N)C[0]=L[Fe],C[1]=L[Fe+1],C[2]=L[Fe+2],me(C,C,Ae),L[Fe]=C[0],L[Fe+1]=C[1],L[Fe+2]=C[2];return L}}();function op(){var C=new us(4);return us!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[3]=0),C}function sp(C,L,N){return C[0]=L[0]*N,C[1]=L[1]*N,C[2]=L[2]*N,C[3]=L[3]*N,C}function lp(C,L){return C[0]*L[0]+C[1]*L[1]+C[2]*L[2]+C[3]*L[3]}function Rc(C,L,N){var te=L[0],ce=L[1],me=L[2],Ae=L[3];return C[0]=N[0]*te+N[4]*ce+N[8]*me+N[12]*Ae,C[1]=N[1]*te+N[5]*ce+N[9]*me+N[13]*Ae,C[2]=N[2]*te+N[6]*ce+N[10]*me+N[14]*Ae,C[3]=N[3]*te+N[7]*ce+N[11]*me+N[15]*Ae,C}var ig=function(){var C=op();return function(L,N,te,ce,me,Ae){var Fe,$e;for(N||(N=4),te||(te=0),ce?$e=Math.min(ce*N+te,L.length):$e=L.length,Fe=te;Fe<$e;Fe+=N)C[0]=L[Fe],C[1]=L[Fe+1],C[2]=L[Fe+2],C[3]=L[Fe+3],me(C,C,Ae),L[Fe]=C[0],L[Fe+1]=C[1],L[Fe+2]=C[2],L[Fe+3]=C[3];return L}}();function up(){var C=new us(2);return us!=Float32Array&&(C[0]=0,C[1]=0),C}function fp(C){var L=C[0],N=C[1];return L*L+N*N}var cp=fp,og=function(){var C=up();return function(L,N,te,ce,me,Ae){var Fe,$e;for(N||(N=2),te||(te=0),ce?$e=Math.min(ce*N+te,L.length):$e=L.length,Fe=te;Fe<$e;Fe+=N)C[0]=L[Fe],C[1]=L[Fe+1],me(C,C,Ae),L[Fe]=C[0],L[Fe+1]=C[1];return L}}(),hp=function(C){function L(N){C.call(this,N,$u)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.createBucket=function(te){return new $i(te)},L.prototype.queryRadius=function(te){var ce=te;return bl("circle-radius",this,ce)+bl("circle-stroke-width",this,ce)+hu(this.paint.get("circle-translate"))},L.prototype.queryIntersectsFeature=function(te,ce,me,Ae,Fe,$e,ft,dt){for(var Pt=jl(te,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),$e.angle,ft),Jt=this.paint.get("circle-radius").evaluate(ce,me),Yt=this.paint.get("circle-stroke-width").evaluate(ce,me),ur=Jt+Yt,Dr=this.paint.get("circle-pitch-alignment")==="map",rn=Dr?Pt:vp(Pt,dt),Jr=Dr?ur*ft:ur,kn=0,mn=Ae;kn<mn.length;kn+=1)for(var Mn=mn[kn],zn=0,Yn=Mn;zn<Yn.length;zn+=1){var la=Yn[zn],ia=Dr?la:Oh(la,dt),Ba=Jr,_a=Rc([],[la.x,la.y,0,1],dt);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ba*=_a[3]/$e.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ba*=$e.cameraToCenterDistance/_a[3]),Li(rn,ia,Ba))return!0}return!1},L}(Pl);function Oh(C,L){var N=Rc([],[C.x,C.y,0,1],L);return new i(N[0]/N[3],N[1]/N[3])}function vp(C,L){return C.map(function(N){return Oh(N,L)})}var Bh=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L}($i);Ea("HeatmapBucket",Bh,{omit:["layers"]});function oh(C,L,N,te){var ce=L.width,me=L.height;if(!te)te=new Uint8Array(ce*me*N);else if(te instanceof Uint8ClampedArray)te=new Uint8Array(te.buffer);else if(te.length!==ce*me*N)throw new RangeError("mismatched image size");return C.width=ce,C.height=me,C.data=te,C}function Nh(C,L,N){var te=L.width,ce=L.height;if(!(te===C.width&&ce===C.height)){var me=oh({},{width:te,height:ce},N);sh(C,me,{x:0,y:0},{x:0,y:0},{width:Math.min(C.width,te),height:Math.min(C.height,ce)},N),C.width=te,C.height=ce,C.data=me.data}}function sh(C,L,N,te,ce,me){if(ce.width===0||ce.height===0)return L;if(ce.width>C.width||ce.height>C.height||N.x>C.width-ce.width||N.y>C.height-ce.height)throw new RangeError("out of range source coordinates for image copy");if(ce.width>L.width||ce.height>L.height||te.x>L.width-ce.width||te.y>L.height-ce.height)throw new RangeError("out of range destination coordinates for image copy");for(var Ae=C.data,Fe=L.data,$e=0;$e<ce.height;$e++)for(var ft=((N.y+$e)*C.width+N.x)*me,dt=((te.y+$e)*L.width+te.x)*me,Pt=0;Pt<ce.width*me;Pt++)Fe[dt+Pt]=Ae[ft+Pt];return L}var Af=function(L,N){oh(this,L,1,N)};Af.prototype.resize=function(L){Nh(this,L,1)},Af.prototype.clone=function(){return new Af({width:this.width,height:this.height},new Uint8Array(this.data))},Af.copy=function(L,N,te,ce,me){sh(L,N,te,ce,me,1)};var nl=function(L,N){oh(this,L,4,N)};nl.prototype.resize=function(L){Nh(this,L,4)},nl.prototype.replace=function(L,N){N?this.data.set(L):L instanceof Uint8ClampedArray?this.data=new Uint8Array(L.buffer):this.data=L},nl.prototype.clone=function(){return new nl({width:this.width,height:this.height},new Uint8Array(this.data))},nl.copy=function(L,N,te,ce,me){sh(L,N,te,ce,me,4)},Ea("AlphaImage",Af),Ea("RGBAImage",nl);var pp=new Yi({"heatmap-radius":new Ia(Ft.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ia(Ft.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ma(Ft.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yo(Ft.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ma(Ft.paint_heatmap["heatmap-opacity"])}),dp={paint:pp};function Uh(C,L){for(var N=new Uint8Array(1024),te={},ce=0,me=0;ce<256;ce++,me+=4){te[L]=ce/255;var Ae=C.evaluate(te);N[me+0]=Math.floor(Ae.r*255/Ae.a),N[me+1]=Math.floor(Ae.g*255/Ae.a),N[me+2]=Math.floor(Ae.b*255/Ae.a),N[me+3]=Math.floor(Ae.a*255)}return new nl({width:256,height:1},N)}var gp=function(C){function L(N){C.call(this,N,dp),this._updateColorRamp()}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.createBucket=function(te){return new Bh(te)},L.prototype._handleSpecialPaintPropertyUpdate=function(te){te==="heatmap-color"&&this._updateColorRamp()},L.prototype._updateColorRamp=function(){var te=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Uh(te,"heatmapDensity"),this.colorRampTexture=null},L.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},L.prototype.queryRadius=function(){return 0},L.prototype.queryIntersectsFeature=function(){return!1},L.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},L}(Pl),yp=new Yi({"hillshade-illumination-direction":new Ma(Ft.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ma(Ft.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ma(Ft.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ma(Ft.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ma(Ft.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ma(Ft.paint_hillshade["hillshade-accent-color"])}),mp={paint:yp},xp=function(C){function L(N){C.call(this,N,mp)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},L}(Pl),bp=lo([{name:"a_pos",components:2,type:"Int16"}],4),Vh=bp.members,lh=Ic,_p=Ic;function Ic(C,L,N){N=N||2;var te=L&&L.length,ce=te?L[0]*N:C.length,me=Hh(C,0,ce,N,!0),Ae=[];if(!me||me.next===me.prev)return Ae;var Fe,$e,ft,dt,Pt,Jt,Yt;if(te&&(me=Sp(C,L,me,N)),C.length>80*N){Fe=ft=C[0],$e=dt=C[1];for(var ur=N;ur<ce;ur+=N)Pt=C[ur],Jt=C[ur+1],Pt<Fe&&(Fe=Pt),Jt<$e&&($e=Jt),Pt>ft&&(ft=Pt),Jt>dt&&(dt=Jt);Yt=Math.max(ft-Fe,dt-$e),Yt=Yt!==0?1/Yt:0}return fc(me,Ae,N,Fe,$e,Yt),Ae}function Hh(C,L,N,te,ce){var me,Ae;if(ce===ch(C,L,N,te)>0)for(me=L;me<N;me+=te)Ae=Wh(me,C[me],C[me+1],Ae);else for(me=N-te;me>=L;me-=te)Ae=Wh(me,C[me],C[me+1],Ae);return Ae&&zc(Ae,Ae.next)&&(hc(Ae),Ae=Ae.next),Ae}function hf(C,L){if(!C)return C;L||(L=C);var N=C,te;do if(te=!1,!N.steiner&&(zc(N,N.next)||Bo(N.prev,N,N.next)===0)){if(hc(N),N=L=N.prev,N===N.next)break;te=!0}else N=N.next;while(te||N!==L);return L}function fc(C,L,N,te,ce,me,Ae){if(!!C){!Ae&&me&&Pp(C,te,ce,me);for(var Fe=C,$e,ft;C.prev!==C.next;){if($e=C.prev,ft=C.next,me?Tp(C,te,ce,me):wp(C)){L.push($e.i/N),L.push(C.i/N),L.push(ft.i/N),hc(C),C=ft.next,Fe=ft.next;continue}if(C=ft,C===Fe){Ae?Ae===1?(C=Ap(hf(C),L,N),fc(C,L,N,te,ce,me,2)):Ae===2&&Mp(C,L,N,te,ce,me):fc(hf(C),L,N,te,ce,me,1);break}}}}function wp(C){var L=C.prev,N=C,te=C.next;if(Bo(L,N,te)>=0)return!1;for(var ce=C.next.next;ce!==C.prev;){if(Bf(L.x,L.y,N.x,N.y,te.x,te.y,ce.x,ce.y)&&Bo(ce.prev,ce,ce.next)>=0)return!1;ce=ce.next}return!0}function Tp(C,L,N,te){var ce=C.prev,me=C,Ae=C.next;if(Bo(ce,me,Ae)>=0)return!1;for(var Fe=ce.x<me.x?ce.x<Ae.x?ce.x:Ae.x:me.x<Ae.x?me.x:Ae.x,$e=ce.y<me.y?ce.y<Ae.y?ce.y:Ae.y:me.y<Ae.y?me.y:Ae.y,ft=ce.x>me.x?ce.x>Ae.x?ce.x:Ae.x:me.x>Ae.x?me.x:Ae.x,dt=ce.y>me.y?ce.y>Ae.y?ce.y:Ae.y:me.y>Ae.y?me.y:Ae.y,Pt=uh(Fe,$e,L,N,te),Jt=uh(ft,dt,L,N,te),Yt=C.prevZ,ur=C.nextZ;Yt&&Yt.z>=Pt&&ur&&ur.z<=Jt;){if(Yt!==C.prev&&Yt!==C.next&&Bf(ce.x,ce.y,me.x,me.y,Ae.x,Ae.y,Yt.x,Yt.y)&&Bo(Yt.prev,Yt,Yt.next)>=0||(Yt=Yt.prevZ,ur!==C.prev&&ur!==C.next&&Bf(ce.x,ce.y,me.x,me.y,Ae.x,Ae.y,ur.x,ur.y)&&Bo(ur.prev,ur,ur.next)>=0))return!1;ur=ur.nextZ}for(;Yt&&Yt.z>=Pt;){if(Yt!==C.prev&&Yt!==C.next&&Bf(ce.x,ce.y,me.x,me.y,Ae.x,Ae.y,Yt.x,Yt.y)&&Bo(Yt.prev,Yt,Yt.next)>=0)return!1;Yt=Yt.prevZ}for(;ur&&ur.z<=Jt;){if(ur!==C.prev&&ur!==C.next&&Bf(ce.x,ce.y,me.x,me.y,Ae.x,Ae.y,ur.x,ur.y)&&Bo(ur.prev,ur,ur.next)>=0)return!1;ur=ur.nextZ}return!0}function Ap(C,L,N){var te=C;do{var ce=te.prev,me=te.next.next;!zc(ce,me)&&Gh(ce,te,te.next,me)&&cc(ce,me)&&cc(me,ce)&&(L.push(ce.i/N),L.push(te.i/N),L.push(me.i/N),hc(te),hc(te.next),te=C=me),te=te.next}while(te!==C);return hf(te)}function Mp(C,L,N,te,ce,me){var Ae=C;do{for(var Fe=Ae.next.next;Fe!==Ae.prev;){if(Ae.i!==Fe.i&&Ip(Ae,Fe)){var $e=Yh(Ae,Fe);Ae=hf(Ae,Ae.next),$e=hf($e,$e.next),fc(Ae,L,N,te,ce,me),fc($e,L,N,te,ce,me);return}Fe=Fe.next}Ae=Ae.next}while(Ae!==C)}function Sp(C,L,N,te){var ce=[],me,Ae,Fe,$e,ft;for(me=0,Ae=L.length;me<Ae;me++)Fe=L[me]*te,$e=me<Ae-1?L[me+1]*te:C.length,ft=Hh(C,Fe,$e,te,!1),ft===ft.next&&(ft.steiner=!0),ce.push(Rp(ft));for(ce.sort(kp),me=0;me<ce.length;me++)Ep(ce[me],N),N=hf(N,N.next);return N}function kp(C,L){return C.x-L.x}function Ep(C,L){if(L=Cp(C,L),L){var N=Yh(L,C);hf(L,L.next),hf(N,N.next)}}function Cp(C,L){var N=L,te=C.x,ce=C.y,me=-1/0,Ae;do{if(ce<=N.y&&ce>=N.next.y&&N.next.y!==N.y){var Fe=N.x+(ce-N.y)*(N.next.x-N.x)/(N.next.y-N.y);if(Fe<=te&&Fe>me){if(me=Fe,Fe===te){if(ce===N.y)return N;if(ce===N.next.y)return N.next}Ae=N.x<N.next.x?N:N.next}}N=N.next}while(N!==L);if(!Ae)return null;if(te===me)return Ae;var $e=Ae,ft=Ae.x,dt=Ae.y,Pt=1/0,Jt;N=Ae;do te>=N.x&&N.x>=ft&&te!==N.x&&Bf(ce<dt?te:me,ce,ft,dt,ce<dt?me:te,ce,N.x,N.y)&&(Jt=Math.abs(ce-N.y)/(te-N.x),cc(N,C)&&(Jt<Pt||Jt===Pt&&(N.x>Ae.x||N.x===Ae.x&&Lp(Ae,N)))&&(Ae=N,Pt=Jt)),N=N.next;while(N!==$e);return Ae}function Lp(C,L){return Bo(C.prev,C,L.prev)<0&&Bo(L.next,C,C.next)<0}function Pp(C,L,N,te){var ce=C;do ce.z===null&&(ce.z=uh(ce.x,ce.y,L,N,te)),ce.prevZ=ce.prev,ce.nextZ=ce.next,ce=ce.next;while(ce!==C);ce.prevZ.nextZ=null,ce.prevZ=null,Dp(ce)}function Dp(C){var L,N,te,ce,me,Ae,Fe,$e,ft=1;do{for(N=C,C=null,me=null,Ae=0;N;){for(Ae++,te=N,Fe=0,L=0;L<ft&&(Fe++,te=te.nextZ,!!te);L++);for($e=ft;Fe>0||$e>0&&te;)Fe!==0&&($e===0||!te||N.z<=te.z)?(ce=N,N=N.nextZ,Fe--):(ce=te,te=te.nextZ,$e--),me?me.nextZ=ce:C=ce,ce.prevZ=me,me=ce;N=te}me.nextZ=null,ft*=2}while(Ae>1);return C}function uh(C,L,N,te,ce){return C=32767*(C-N)*ce,L=32767*(L-te)*ce,C=(C|C<<8)&16711935,C=(C|C<<4)&252645135,C=(C|C<<2)&858993459,C=(C|C<<1)&1431655765,L=(L|L<<8)&16711935,L=(L|L<<4)&252645135,L=(L|L<<2)&858993459,L=(L|L<<1)&1431655765,C|L<<1}function Rp(C){var L=C,N=C;do(L.x<N.x||L.x===N.x&&L.y<N.y)&&(N=L),L=L.next;while(L!==C);return N}function Bf(C,L,N,te,ce,me,Ae,Fe){return(ce-Ae)*(L-Fe)-(C-Ae)*(me-Fe)>=0&&(C-Ae)*(te-Fe)-(N-Ae)*(L-Fe)>=0&&(N-Ae)*(me-Fe)-(ce-Ae)*(te-Fe)>=0}function Ip(C,L){return C.next.i!==L.i&&C.prev.i!==L.i&&!zp(C,L)&&(cc(C,L)&&cc(L,C)&&Fp(C,L)&&(Bo(C.prev,C,L.prev)||Bo(C,L.prev,L))||zc(C,L)&&Bo(C.prev,C,C.next)>0&&Bo(L.prev,L,L.next)>0)}function Bo(C,L,N){return(L.y-C.y)*(N.x-L.x)-(L.x-C.x)*(N.y-L.y)}function zc(C,L){return C.x===L.x&&C.y===L.y}function Gh(C,L,N,te){var ce=Oc(Bo(C,L,N)),me=Oc(Bo(C,L,te)),Ae=Oc(Bo(N,te,C)),Fe=Oc(Bo(N,te,L));return!!(ce!==me&&Ae!==Fe||ce===0&&Fc(C,N,L)||me===0&&Fc(C,te,L)||Ae===0&&Fc(N,C,te)||Fe===0&&Fc(N,L,te))}function Fc(C,L,N){return L.x<=Math.max(C.x,N.x)&&L.x>=Math.min(C.x,N.x)&&L.y<=Math.max(C.y,N.y)&&L.y>=Math.min(C.y,N.y)}function Oc(C){return C>0?1:C<0?-1:0}function zp(C,L){var N=C;do{if(N.i!==C.i&&N.next.i!==C.i&&N.i!==L.i&&N.next.i!==L.i&&Gh(N,N.next,C,L))return!0;N=N.next}while(N!==C);return!1}function cc(C,L){return Bo(C.prev,C,C.next)<0?Bo(C,L,C.next)>=0&&Bo(C,C.prev,L)>=0:Bo(C,L,C.prev)<0||Bo(C,C.next,L)<0}function Fp(C,L){var N=C,te=!1,ce=(C.x+L.x)/2,me=(C.y+L.y)/2;do N.y>me!=N.next.y>me&&N.next.y!==N.y&&ce<(N.next.x-N.x)*(me-N.y)/(N.next.y-N.y)+N.x&&(te=!te),N=N.next;while(N!==C);return te}function Yh(C,L){var N=new fh(C.i,C.x,C.y),te=new fh(L.i,L.x,L.y),ce=C.next,me=L.prev;return C.next=L,L.prev=C,N.next=ce,ce.prev=N,te.next=N,N.prev=te,me.next=te,te.prev=me,te}function Wh(C,L,N,te){var ce=new fh(C,L,N);return te?(ce.next=te.next,ce.prev=te,te.next.prev=ce,te.next=ce):(ce.prev=ce,ce.next=ce),ce}function hc(C){C.next.prev=C.prev,C.prev.next=C.next,C.prevZ&&(C.prevZ.nextZ=C.nextZ),C.nextZ&&(C.nextZ.prevZ=C.prevZ)}function fh(C,L,N){this.i=C,this.x=L,this.y=N,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ic.deviation=function(C,L,N,te){var ce=L&&L.length,me=ce?L[0]*N:C.length,Ae=Math.abs(ch(C,0,me,N));if(ce)for(var Fe=0,$e=L.length;Fe<$e;Fe++){var ft=L[Fe]*N,dt=Fe<$e-1?L[Fe+1]*N:C.length;Ae-=Math.abs(ch(C,ft,dt,N))}var Pt=0;for(Fe=0;Fe<te.length;Fe+=3){var Jt=te[Fe]*N,Yt=te[Fe+1]*N,ur=te[Fe+2]*N;Pt+=Math.abs((C[Jt]-C[ur])*(C[Yt+1]-C[Jt+1])-(C[Jt]-C[Yt])*(C[ur+1]-C[Jt+1]))}return Ae===0&&Pt===0?0:Math.abs((Pt-Ae)/Ae)};function ch(C,L,N,te){for(var ce=0,me=L,Ae=N-te;me<N;me+=te)ce+=(C[Ae]-C[me])*(C[me+1]+C[Ae+1]),Ae=me;return ce}Ic.flatten=function(C){for(var L=C[0][0].length,N={vertices:[],holes:[],dimensions:L},te=0,ce=0;ce<C.length;ce++){for(var me=0;me<C[ce].length;me++)for(var Ae=0;Ae<L;Ae++)N.vertices.push(C[ce][me][Ae]);ce>0&&(te+=C[ce-1].length,N.holes.push(te))}return N},lh.default=_p;function Op(C,L,N,te,ce){Xh(C,L,N||0,te||C.length-1,ce||Bp)}function Xh(C,L,N,te,ce){for(;te>N;){if(te-N>600){var me=te-N+1,Ae=L-N+1,Fe=Math.log(me),$e=.5*Math.exp(2*Fe/3),ft=.5*Math.sqrt(Fe*$e*(me-$e)/me)*(Ae-me/2<0?-1:1),dt=Math.max(N,Math.floor(L-Ae*$e/me+ft)),Pt=Math.min(te,Math.floor(L+(me-Ae)*$e/me+ft));Xh(C,L,dt,Pt,ce)}var Jt=C[L],Yt=N,ur=te;for(vc(C,N,L),ce(C[te],Jt)>0&&vc(C,N,te);Yt<ur;){for(vc(C,Yt,ur),Yt++,ur--;ce(C[Yt],Jt)<0;)Yt++;for(;ce(C[ur],Jt)>0;)ur--}ce(C[N],Jt)===0?vc(C,N,ur):(ur++,vc(C,ur,te)),ur<=L&&(N=ur+1),L<=ur&&(te=ur-1)}}function vc(C,L,N){var te=C[L];C[L]=C[N],C[N]=te}function Bp(C,L){return C<L?-1:C>L?1:0}function hh(C,L){var N=C.length;if(N<=1)return[C];for(var te=[],ce,me,Ae=0;Ae<N;Ae++){var Fe=B(C[Ae]);Fe!==0&&(C[Ae].area=Math.abs(Fe),me===void 0&&(me=Fe<0),me===Fe<0?(ce&&te.push(ce),ce=[C[Ae]]):ce.push(C[Ae]))}if(ce&&te.push(ce),L>1)for(var $e=0;$e<te.length;$e++)te[$e].length<=L||(Op(te[$e],L,1,te[$e].length-1,Np),te[$e]=te[$e].slice(0,L));return te}function Np(C,L){return L.area-C.area}function vh(C,L,N){for(var te=N.patternDependencies,ce=!1,me=0,Ae=L;me<Ae.length;me+=1){var Fe=Ae[me],$e=Fe.paint.get(C+"-pattern");$e.isConstant()||(ce=!0);var ft=$e.constantOr(null);ft&&(ce=!0,te[ft.to]=!0,te[ft.from]=!0)}return ce}function ph(C,L,N,te,ce){for(var me=ce.patternDependencies,Ae=0,Fe=L;Ae<Fe.length;Ae+=1){var $e=Fe[Ae],ft=$e.paint.get(C+"-pattern"),dt=ft.value;if(dt.kind!=="constant"){var Pt=dt.evaluate({zoom:te-1},N,{},ce.availableImages),Jt=dt.evaluate({zoom:te},N,{},ce.availableImages),Yt=dt.evaluate({zoom:te+1},N,{},ce.availableImages);Pt=Pt&&Pt.name?Pt.name:Pt,Jt=Jt&&Jt.name?Jt.name:Jt,Yt=Yt&&Yt.name?Yt.name:Yt,me[Pt]=!0,me[Jt]=!0,me[Yt]=!0,N.patterns[$e.id]={min:Pt,mid:Jt,max:Yt}}}return N}var Up=500,Mu=function(L){this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function(N){return N.id}),this.index=L.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new lu,this.indexArray=new Tu,this.indexArray2=new bf,this.programConfigurations=new ai(Vh,L.layers,L.zoom),this.segments=new Y,this.segments2=new Y,this.stateDependentLayerIds=this.layers.filter(function(N){return N.isStateDependent()}).map(function(N){return N.id})};Mu.prototype.populate=function(L,N,te){this.hasPattern=vh("fill",this.layers,N);for(var ce=this.layers[0].layout.get("fill-sort-key"),me=[],Ae=0,Fe=L;Ae<Fe.length;Ae+=1){var $e=Fe[Ae],ft=$e.feature,dt=$e.id,Pt=$e.index,Jt=$e.sourceLayerIndex,Yt=this.layers[0]._featureFilter.needGeometry,ur={type:ft.type,id:dt,properties:ft.properties,geometry:Yt?Wi(ft):[]};if(!!this.layers[0]._featureFilter.filter(new ci(this.zoom),ur,te)){Yt||(ur.geometry=Wi(ft));var Dr=ce?ce.evaluate(ur,{},te,N.availableImages):void 0,rn={id:dt,properties:ft.properties,type:ft.type,sourceLayerIndex:Jt,index:Pt,geometry:ur.geometry,patterns:{},sortKey:Dr};me.push(rn)}}ce&&me.sort(function(_a,Sa){return _a.sortKey-Sa.sortKey});for(var Jr=0,kn=me;Jr<kn.length;Jr+=1){var mn=kn[Jr],Mn=mn,zn=Mn.geometry,Yn=Mn.index,la=Mn.sourceLayerIndex;if(this.hasPattern){var ia=ph("fill",this.layers,mn,this.zoom,N);this.patternFeatures.push(ia)}else this.addFeature(mn,zn,Yn,te,{});var Ba=L[Yn].feature;N.featureIndex.insert(Ba,zn,Yn,la,this.index)}},Mu.prototype.update=function(L,N,te){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(L,N,this.stateDependentLayers,te)},Mu.prototype.addFeatures=function(L,N,te){for(var ce=0,me=this.patternFeatures;ce<me.length;ce+=1){var Ae=me[ce];this.addFeature(Ae,Ae.geometry,Ae.index,N,te)}},Mu.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Mu.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Mu.prototype.upload=function(L){this.uploaded||(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,Vh),this.indexBuffer=L.createIndexBuffer(this.indexArray),this.indexBuffer2=L.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(L),this.uploaded=!0},Mu.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Mu.prototype.addFeature=function(L,N,te,ce,me){for(var Ae=0,Fe=hh(N,Up);Ae<Fe.length;Ae+=1){for(var $e=Fe[Ae],ft=0,dt=0,Pt=$e;dt<Pt.length;dt+=1){var Jt=Pt[dt];ft+=Jt.length}for(var Yt=this.segments.prepareSegment(ft,this.layoutVertexArray,this.indexArray),ur=Yt.vertexLength,Dr=[],rn=[],Jr=0,kn=$e;Jr<kn.length;Jr+=1){var mn=kn[Jr];if(mn.length!==0){mn!==$e[0]&&rn.push(Dr.length/2);var Mn=this.segments2.prepareSegment(mn.length,this.layoutVertexArray,this.indexArray2),zn=Mn.vertexLength;this.layoutVertexArray.emplaceBack(mn[0].x,mn[0].y),this.indexArray2.emplaceBack(zn+mn.length-1,zn),Dr.push(mn[0].x),Dr.push(mn[0].y);for(var Yn=1;Yn<mn.length;Yn++)this.layoutVertexArray.emplaceBack(mn[Yn].x,mn[Yn].y),this.indexArray2.emplaceBack(zn+Yn-1,zn+Yn),Dr.push(mn[Yn].x),Dr.push(mn[Yn].y);Mn.vertexLength+=mn.length,Mn.primitiveLength+=mn.length}}for(var la=lh(Dr,rn),ia=0;ia<la.length;ia+=3)this.indexArray.emplaceBack(ur+la[ia],ur+la[ia+1],ur+la[ia+2]);Yt.vertexLength+=ft,Yt.primitiveLength+=la.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,L,te,me,ce)},Ea("FillBucket",Mu,{omit:["layers","patternFeatures"]});var Vp=new Yi({"fill-sort-key":new Ia(Ft.layout_fill["fill-sort-key"])}),Hp=new Yi({"fill-antialias":new Ma(Ft.paint_fill["fill-antialias"]),"fill-opacity":new Ia(Ft.paint_fill["fill-opacity"]),"fill-color":new Ia(Ft.paint_fill["fill-color"]),"fill-outline-color":new Ia(Ft.paint_fill["fill-outline-color"]),"fill-translate":new Ma(Ft.paint_fill["fill-translate"]),"fill-translate-anchor":new Ma(Ft.paint_fill["fill-translate-anchor"]),"fill-pattern":new eo(Ft.paint_fill["fill-pattern"])}),Gp={paint:Hp,layout:Vp},Yp=function(C){function L(N){C.call(this,N,Gp)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.recalculate=function(te,ce){C.prototype.recalculate.call(this,te,ce);var me=this.paint._values["fill-outline-color"];me.value.kind==="constant"&&me.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},L.prototype.createBucket=function(te){return new Mu(te)},L.prototype.queryRadius=function(){return hu(this.paint.get("fill-translate"))},L.prototype.queryIntersectsFeature=function(te,ce,me,Ae,Fe,$e,ft){var dt=jl(te,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),$e.angle,ft);return Ao(dt,Ae)},L.prototype.isTileClipped=function(){return!0},L}(Pl),Wp=lo([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Zh=Wp.members,jh=Nf;function Nf(C,L,N,te,ce){this.properties={},this.extent=N,this.type=0,this._pbf=C,this._geometry=-1,this._keys=te,this._values=ce,C.readFields(Xp,this,L)}function Xp(C,L,N){C==1?L.id=N.readVarint():C==2?Zp(N,L):C==3?L.type=N.readVarint():C==4&&(L._geometry=N.pos)}function Zp(C,L){for(var N=C.readVarint()+C.pos;C.pos<N;){var te=L._keys[C.readVarint()],ce=L._values[C.readVarint()];L.properties[te]=ce}}Nf.types=["Unknown","Point","LineString","Polygon"],Nf.prototype.loadGeometry=function(){var C=this._pbf;C.pos=this._geometry;for(var L=C.readVarint()+C.pos,N=1,te=0,ce=0,me=0,Ae=[],Fe;C.pos<L;){if(te<=0){var $e=C.readVarint();N=$e&7,te=$e>>3}if(te--,N===1||N===2)ce+=C.readSVarint(),me+=C.readSVarint(),N===1&&(Fe&&Ae.push(Fe),Fe=[]),Fe.push(new i(ce,me));else if(N===7)Fe&&Fe.push(Fe[0].clone());else throw new Error("unknown command "+N)}return Fe&&Ae.push(Fe),Ae},Nf.prototype.bbox=function(){var C=this._pbf;C.pos=this._geometry;for(var L=C.readVarint()+C.pos,N=1,te=0,ce=0,me=0,Ae=1/0,Fe=-1/0,$e=1/0,ft=-1/0;C.pos<L;){if(te<=0){var dt=C.readVarint();N=dt&7,te=dt>>3}if(te--,N===1||N===2)ce+=C.readSVarint(),me+=C.readSVarint(),ce<Ae&&(Ae=ce),ce>Fe&&(Fe=ce),me<$e&&($e=me),me>ft&&(ft=me);else if(N!==7)throw new Error("unknown command "+N)}return[Ae,$e,Fe,ft]},Nf.prototype.toGeoJSON=function(C,L,N){var te=this.extent*Math.pow(2,N),ce=this.extent*C,me=this.extent*L,Ae=this.loadGeometry(),Fe=Nf.types[this.type],$e,ft;function dt(Yt){for(var ur=0;ur<Yt.length;ur++){var Dr=Yt[ur],rn=180-(Dr.y+me)*360/te;Yt[ur]=[(Dr.x+ce)*360/te-180,360/Math.PI*Math.atan(Math.exp(rn*Math.PI/180))-90]}}switch(this.type){case 1:var Pt=[];for($e=0;$e<Ae.length;$e++)Pt[$e]=Ae[$e][0];Ae=Pt,dt(Ae);break;case 2:for($e=0;$e<Ae.length;$e++)dt(Ae[$e]);break;case 3:for(Ae=jp(Ae),$e=0;$e<Ae.length;$e++)for(ft=0;ft<Ae[$e].length;ft++)dt(Ae[$e][ft]);break}Ae.length===1?Ae=Ae[0]:Fe="Multi"+Fe;var Jt={type:"Feature",geometry:{type:Fe,coordinates:Ae},properties:this.properties};return"id"in this&&(Jt.id=this.id),Jt};function jp(C){var L=C.length;if(L<=1)return[C];for(var N=[],te,ce,me=0;me<L;me++){var Ae=Kp(C[me]);Ae!==0&&(ce===void 0&&(ce=Ae<0),ce===Ae<0?(te&&N.push(te),te=[C[me]]):te.push(C[me]))}return te&&N.push(te),N}function Kp(C){for(var L=0,N=0,te=C.length,ce=te-1,me,Ae;N<te;ce=N++)me=C[N],Ae=C[ce],L+=(Ae.x-me.x)*(me.y+Ae.y);return L}var Kh=Jh;function Jh(C,L){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=C,this._keys=[],this._values=[],this._features=[],C.readFields(Jp,this,L),this.length=this._features.length}function Jp(C,L,N){C===15?L.version=N.readVarint():C===1?L.name=N.readString():C===5?L.extent=N.readVarint():C===2?L._features.push(N.pos):C===3?L._keys.push(N.readString()):C===4&&L._values.push(Qp(N))}function Qp(C){for(var L=null,N=C.readVarint()+C.pos;C.pos<N;){var te=C.readVarint()>>3;L=te===1?C.readString():te===2?C.readFloat():te===3?C.readDouble():te===4?C.readVarint64():te===5?C.readVarint():te===6?C.readSVarint():te===7?C.readBoolean():null}return L}Jh.prototype.feature=function(C){if(C<0||C>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[C];var L=this._pbf.readVarint()+this._pbf.pos;return new jh(this._pbf,L,this.extent,this._keys,this._values)};var $p=qp;function qp(C,L){this.layers=C.readFields(ed,{},L)}function ed(C,L,N){if(C===3){var te=new Kh(N,N.readVarint()+N.pos);te.length&&(L[te.name]=te)}}var td=$p,rd=jh,nd=Kh,Uf={VectorTile:td,VectorTileFeature:rd,VectorTileLayer:nd},ad=Uf.VectorTileFeature.types,id=500,dh=Math.pow(2,13);function pc(C,L,N,te,ce,me,Ae,Fe){C.emplaceBack(L,N,Math.floor(te*dh)*2+Ae,ce*dh*2,me*dh*2,Math.round(Fe))}var Su=function(L){this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function(N){return N.id}),this.index=L.index,this.hasPattern=!1,this.layoutVertexArray=new of,this.indexArray=new Tu,this.programConfigurations=new ai(Zh,L.layers,L.zoom),this.segments=new Y,this.stateDependentLayerIds=this.layers.filter(function(N){return N.isStateDependent()}).map(function(N){return N.id})};Su.prototype.populate=function(L,N,te){this.features=[],this.hasPattern=vh("fill-extrusion",this.layers,N);for(var ce=0,me=L;ce<me.length;ce+=1){var Ae=me[ce],Fe=Ae.feature,$e=Ae.id,ft=Ae.index,dt=Ae.sourceLayerIndex,Pt=this.layers[0]._featureFilter.needGeometry,Jt={type:Fe.type,id:$e,properties:Fe.properties,geometry:Pt?Wi(Fe):[]};if(!!this.layers[0]._featureFilter.filter(new ci(this.zoom),Jt,te)){var Yt={id:$e,sourceLayerIndex:dt,index:ft,geometry:Pt?Jt.geometry:Wi(Fe),properties:Fe.properties,type:Fe.type,patterns:{}};typeof Fe.id<"u"&&(Yt.id=Fe.id),this.hasPattern?this.features.push(ph("fill-extrusion",this.layers,Yt,this.zoom,N)):this.addFeature(Yt,Yt.geometry,ft,te,{}),N.featureIndex.insert(Fe,Yt.geometry,ft,dt,this.index,!0)}}},Su.prototype.addFeatures=function(L,N,te){for(var ce=0,me=this.features;ce<me.length;ce+=1){var Ae=me[ce],Fe=Ae.geometry;this.addFeature(Ae,Fe,Ae.index,N,te)}},Su.prototype.update=function(L,N,te){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(L,N,this.stateDependentLayers,te)},Su.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Su.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Su.prototype.upload=function(L){this.uploaded||(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,Zh),this.indexBuffer=L.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(L),this.uploaded=!0},Su.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Su.prototype.addFeature=function(L,N,te,ce,me){for(var Ae=0,Fe=hh(N,id);Ae<Fe.length;Ae+=1){for(var $e=Fe[Ae],ft=0,dt=0,Pt=$e;dt<Pt.length;dt+=1){var Jt=Pt[dt];ft+=Jt.length}for(var Yt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),ur=0,Dr=$e;ur<Dr.length;ur+=1){var rn=Dr[ur];if(rn.length!==0&&!sd(rn))for(var Jr=0,kn=0;kn<rn.length;kn++){var mn=rn[kn];if(kn>=1){var Mn=rn[kn-1];if(!od(mn,Mn)){Yt.vertexLength+4>Y.MAX_VERTEX_ARRAY_LENGTH&&(Yt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var zn=mn.sub(Mn)._perp()._unit(),Yn=Mn.dist(mn);Jr+Yn>32768&&(Jr=0),pc(this.layoutVertexArray,mn.x,mn.y,zn.x,zn.y,0,0,Jr),pc(this.layoutVertexArray,mn.x,mn.y,zn.x,zn.y,0,1,Jr),Jr+=Yn,pc(this.layoutVertexArray,Mn.x,Mn.y,zn.x,zn.y,0,0,Jr),pc(this.layoutVertexArray,Mn.x,Mn.y,zn.x,zn.y,0,1,Jr);var la=Yt.vertexLength;this.indexArray.emplaceBack(la,la+2,la+1),this.indexArray.emplaceBack(la+1,la+2,la+3),Yt.vertexLength+=4,Yt.primitiveLength+=2}}}}if(Yt.vertexLength+ft>Y.MAX_VERTEX_ARRAY_LENGTH&&(Yt=this.segments.prepareSegment(ft,this.layoutVertexArray,this.indexArray)),ad[L.type]==="Polygon"){for(var ia=[],Ba=[],_a=Yt.vertexLength,Sa=0,ni=$e;Sa<ni.length;Sa+=1){var Da=ni[Sa];if(Da.length!==0){Da!==$e[0]&&Ba.push(ia.length/2);for(var za=0;za<Da.length;za++){var vi=Da[za];pc(this.layoutVertexArray,vi.x,vi.y,0,0,1,1,0),ia.push(vi.x),ia.push(vi.y)}}}for(var ei=lh(ia,Ba),zi=0;zi<ei.length;zi+=3)this.indexArray.emplaceBack(_a+ei[zi],_a+ei[zi+2],_a+ei[zi+1]);Yt.primitiveLength+=ei.length/3,Yt.vertexLength+=ft}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,L,te,me,ce)},Ea("FillExtrusionBucket",Su,{omit:["layers","features"]});function od(C,L){return C.x===L.x&&(C.x<0||C.x>Va)||C.y===L.y&&(C.y<0||C.y>Va)}function sd(C){return C.every(function(L){return L.x<0})||C.every(function(L){return L.x>Va})||C.every(function(L){return L.y<0})||C.every(function(L){return L.y>Va})}var ld=new Yi({"fill-extrusion-opacity":new Ma(Ft["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ia(Ft["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ma(Ft["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ma(Ft["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new eo(Ft["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ia(Ft["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ia(Ft["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ma(Ft["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])}),ud={paint:ld},fd=function(C){function L(N){C.call(this,N,ud)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.createBucket=function(te){return new Su(te)},L.prototype.queryRadius=function(){return hu(this.paint.get("fill-extrusion-translate"))},L.prototype.is3D=function(){return!0},L.prototype.queryIntersectsFeature=function(te,ce,me,Ae,Fe,$e,ft,dt){var Pt=jl(te,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),$e.angle,ft),Jt=this.paint.get("fill-extrusion-height").evaluate(ce,me),Yt=this.paint.get("fill-extrusion-base").evaluate(ce,me),ur=vd(Pt,dt,$e,0),Dr=hd(Ae,Yt,Jt,dt),rn=Dr[0],Jr=Dr[1];return cd(rn,Jr,ur)},L}(Pl);function dc(C,L){return C.x*L.x+C.y*L.y}function Qh(C,L){if(C.length===1){for(var N=0,te=L[N++],ce;!ce||te.equals(ce);)if(ce=L[N++],!ce)return 1/0;for(;N<L.length;N++){var me=L[N],Ae=C[0],Fe=ce.sub(te),$e=me.sub(te),ft=Ae.sub(te),dt=dc(Fe,Fe),Pt=dc(Fe,$e),Jt=dc($e,$e),Yt=dc(ft,Fe),ur=dc(ft,$e),Dr=dt*Jt-Pt*Pt,rn=(Jt*Yt-Pt*ur)/Dr,Jr=(dt*ur-Pt*Yt)/Dr,kn=1-rn-Jr,mn=te.z*kn+ce.z*rn+me.z*Jr;if(isFinite(mn))return mn}return 1/0}else{for(var Mn=1/0,zn=0,Yn=L;zn<Yn.length;zn+=1){var la=Yn[zn];Mn=Math.min(Mn,la.z)}return Mn}}function cd(C,L,N){var te=1/0;Ao(N,L)&&(te=Qh(N,L[0]));for(var ce=0;ce<L.length;ce++)for(var me=L[ce],Ae=C[ce],Fe=0;Fe<me.length-1;Fe++){var $e=me[Fe],ft=me[Fe+1],dt=Ae[Fe],Pt=Ae[Fe+1],Jt=[$e,ft,Pt,dt,$e];oi(N,Jt)&&(te=Math.min(te,Qh(N,Jt)))}return te===1/0?!1:te}function hd(C,L,N,te){for(var ce=[],me=[],Ae=te[8]*L,Fe=te[9]*L,$e=te[10]*L,ft=te[11]*L,dt=te[8]*N,Pt=te[9]*N,Jt=te[10]*N,Yt=te[11]*N,ur=0,Dr=C;ur<Dr.length;ur+=1){for(var rn=Dr[ur],Jr=[],kn=[],mn=0,Mn=rn;mn<Mn.length;mn+=1){var zn=Mn[mn],Yn=zn.x,la=zn.y,ia=te[0]*Yn+te[4]*la+te[12],Ba=te[1]*Yn+te[5]*la+te[13],_a=te[2]*Yn+te[6]*la+te[14],Sa=te[3]*Yn+te[7]*la+te[15],ni=ia+Ae,Da=Ba+Fe,za=_a+$e,vi=Sa+ft,ei=ia+dt,zi=Ba+Pt,Ki=_a+Jt,Fi=Sa+Yt,Oi=new i(ni/vi,Da/vi);Oi.z=za/vi,Jr.push(Oi);var Pi=new i(ei/Fi,zi/Fi);Pi.z=Ki/Fi,kn.push(Pi)}ce.push(Jr),me.push(kn)}return[ce,me]}function vd(C,L,N,te){for(var ce=[],me=0,Ae=C;me<Ae.length;me+=1){var Fe=Ae[me],$e=[Fe.x,Fe.y,te,1];Rc($e,$e,L),ce.push(new i($e[0]/$e[3],$e[1]/$e[3]))}return ce}var pd=lo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),$h=pd.members,dd=Uf.VectorTileFeature.types,qh=63,gd=Math.cos(75/2*(Math.PI/180)),yd=15,md=20,xd=15,ev=1/2,tv=Math.pow(2,xd-1)/ev,al=function(L){this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function(N){return N.id}),this.index=L.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Cf,this.indexArray=new Tu,this.programConfigurations=new ai($h,L.layers,L.zoom),this.segments=new Y,this.stateDependentLayerIds=this.layers.filter(function(N){return N.isStateDependent()}).map(function(N){return N.id})};al.prototype.populate=function(L,N,te){this.hasPattern=vh("line",this.layers,N);for(var ce=this.layers[0].layout.get("line-sort-key"),me=[],Ae=0,Fe=L;Ae<Fe.length;Ae+=1){var $e=Fe[Ae],ft=$e.feature,dt=$e.id,Pt=$e.index,Jt=$e.sourceLayerIndex,Yt=this.layers[0]._featureFilter.needGeometry,ur={type:ft.type,id:dt,properties:ft.properties,geometry:Yt?Wi(ft):[]};if(!!this.layers[0]._featureFilter.filter(new ci(this.zoom),ur,te)){Yt||(ur.geometry=Wi(ft));var Dr=ce?ce.evaluate(ur,{},te):void 0,rn={id:dt,properties:ft.properties,type:ft.type,sourceLayerIndex:Jt,index:Pt,geometry:ur.geometry,patterns:{},sortKey:Dr};me.push(rn)}}ce&&me.sort(function(_a,Sa){return _a.sortKey-Sa.sortKey});for(var Jr=0,kn=me;Jr<kn.length;Jr+=1){var mn=kn[Jr],Mn=mn,zn=Mn.geometry,Yn=Mn.index,la=Mn.sourceLayerIndex;if(this.hasPattern){var ia=ph("line",this.layers,mn,this.zoom,N);this.patternFeatures.push(ia)}else this.addFeature(mn,zn,Yn,te,{});var Ba=L[Yn].feature;N.featureIndex.insert(Ba,zn,Yn,la,this.index)}},al.prototype.update=function(L,N,te){!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(L,N,this.stateDependentLayers,te)},al.prototype.addFeatures=function(L,N,te){for(var ce=0,me=this.patternFeatures;ce<me.length;ce+=1){var Ae=me[ce];this.addFeature(Ae,Ae.geometry,Ae.index,N,te)}},al.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},al.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},al.prototype.upload=function(L){this.uploaded||(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,$h),this.indexBuffer=L.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(L),this.uploaded=!0},al.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},al.prototype.addFeature=function(L,N,te,ce,me){for(var Ae=this.layers[0].layout,Fe=Ae.get("line-join").evaluate(L,{}),$e=Ae.get("line-cap"),ft=Ae.get("line-miter-limit"),dt=Ae.get("line-round-limit"),Pt=0,Jt=N;Pt<Jt.length;Pt+=1){var Yt=Jt[Pt];this.addLine(Yt,L,Fe,$e,ft,dt)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,L,te,me,ce)},al.prototype.addLine=function(L,N,te,ce,me,Ae){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,!!N.properties&&N.properties.hasOwnProperty("mapbox_clip_start")&&N.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+N.properties.mapbox_clip_start,this.clipEnd=+N.properties.mapbox_clip_end;for(var Fe=0;Fe<L.length-1;Fe++)this.totalDistance+=L[Fe].dist(L[Fe+1]);this.updateScaledDistance()}for(var $e=dd[N.type]==="Polygon",ft=L.length;ft>=2&&L[ft-1].equals(L[ft-2]);)ft--;for(var dt=0;dt<ft-1&&L[dt].equals(L[dt+1]);)dt++;if(!(ft<($e?3:2))){te==="bevel"&&(me=1.05);var Pt=this.overscaling<=16?yd*Va/(512*this.overscaling):0,Jt=this.segments.prepareSegment(ft*10,this.layoutVertexArray,this.indexArray),Yt,ur=void 0,Dr=void 0,rn=void 0,Jr=void 0;this.e1=this.e2=-1,$e&&(Yt=L[ft-2],Jr=L[dt].sub(Yt)._unit()._perp());for(var kn=dt;kn<ft;kn++)if(Dr=kn===ft-1?$e?L[dt+1]:void 0:L[kn+1],!(Dr&&L[kn].equals(Dr))){Jr&&(rn=Jr),Yt&&(ur=Yt),Yt=L[kn],Jr=Dr?Dr.sub(Yt)._unit()._perp():rn,rn=rn||Jr;var mn=rn.add(Jr);(mn.x!==0||mn.y!==0)&&mn._unit();var Mn=rn.x*Jr.x+rn.y*Jr.y,zn=mn.x*Jr.x+mn.y*Jr.y,Yn=zn!==0?1/zn:1/0,la=2*Math.sqrt(2-2*zn),ia=zn<gd&&ur&&Dr,Ba=rn.x*Jr.y-rn.y*Jr.x>0;if(ia&&kn>dt){var _a=Yt.dist(ur);if(_a>2*Pt){var Sa=Yt.sub(Yt.sub(ur)._mult(Pt/_a)._round());this.updateDistance(ur,Sa),this.addCurrentVertex(Sa,rn,0,0,Jt),ur=Sa}}var ni=ur&&Dr,Da=ni?te:$e?"butt":ce;if(ni&&Da==="round"&&(Yn<Ae?Da="miter":Yn<=2&&(Da="fakeround")),Da==="miter"&&Yn>me&&(Da="bevel"),Da==="bevel"&&(Yn>2&&(Da="flipbevel"),Yn<me&&(Da="miter")),ur&&this.updateDistance(ur,Yt),Da==="miter")mn._mult(Yn),this.addCurrentVertex(Yt,mn,0,0,Jt);else if(Da==="flipbevel"){if(Yn>100)mn=Jr.mult(-1);else{var za=Yn*rn.add(Jr).mag()/rn.sub(Jr).mag();mn._perp()._mult(za*(Ba?-1:1))}this.addCurrentVertex(Yt,mn,0,0,Jt),this.addCurrentVertex(Yt,mn.mult(-1),0,0,Jt)}else if(Da==="bevel"||Da==="fakeround"){var vi=-Math.sqrt(Yn*Yn-1),ei=Ba?vi:0,zi=Ba?0:vi;if(ur&&this.addCurrentVertex(Yt,rn,ei,zi,Jt),Da==="fakeround")for(var Ki=Math.round(la*180/Math.PI/md),Fi=1;Fi<Ki;Fi++){var Oi=Fi/Ki;if(Oi!==.5){var Pi=Oi-.5,to=1.0904+Mn*(-3.2452+Mn*(3.55645-Mn*1.43519)),fo=.848013+Mn*(-1.06021+Mn*.215638);Oi=Oi+Oi*Pi*(Oi-1)*(to*Pi*Pi+fo)}var Mo=Jr.sub(rn)._mult(Oi)._add(rn)._unit()._mult(Ba?-1:1);this.addHalfVertex(Yt,Mo.x,Mo.y,!1,Ba,0,Jt)}Dr&&this.addCurrentVertex(Yt,Jr,-ei,-zi,Jt)}else if(Da==="butt")this.addCurrentVertex(Yt,mn,0,0,Jt);else if(Da==="square"){var Ro=ur?1:-1;this.addCurrentVertex(Yt,mn,Ro,Ro,Jt)}else Da==="round"&&(ur&&(this.addCurrentVertex(Yt,rn,0,0,Jt),this.addCurrentVertex(Yt,rn,1,1,Jt,!0)),Dr&&(this.addCurrentVertex(Yt,Jr,-1,-1,Jt,!0),this.addCurrentVertex(Yt,Jr,0,0,Jt)));if(ia&&kn<ft-1){var rs=Yt.dist(Dr);if(rs>2*Pt){var Vo=Yt.add(Dr.sub(Yt)._mult(Pt/rs)._round());this.updateDistance(Yt,Vo),this.addCurrentVertex(Vo,Jr,0,0,Jt),Yt=Vo}}}}},al.prototype.addCurrentVertex=function(L,N,te,ce,me,Ae){Ae===void 0&&(Ae=!1);var Fe=N.x+N.y*te,$e=N.y-N.x*te,ft=-N.x+N.y*ce,dt=-N.y-N.x*ce;this.addHalfVertex(L,Fe,$e,Ae,!1,te,me),this.addHalfVertex(L,ft,dt,Ae,!0,-ce,me),this.distance>tv/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(L,N,te,ce,me,Ae))},al.prototype.addHalfVertex=function(L,N,te,ce,me,Ae,Fe){var $e=L.x,ft=L.y,dt=this.scaledDistance*ev;this.layoutVertexArray.emplaceBack(($e<<1)+(ce?1:0),(ft<<1)+(me?1:0),Math.round(qh*N)+128,Math.round(qh*te)+128,(Ae===0?0:Ae<0?-1:1)+1|(dt&63)<<2,dt>>6);var Pt=Fe.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,Pt),Fe.primitiveLength++),me?this.e2=Pt:this.e1=Pt},al.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(tv-1):this.distance},al.prototype.updateDistance=function(L,N){this.distance+=L.dist(N),this.updateScaledDistance()},Ea("LineBucket",al,{omit:["layers","patternFeatures"]});var bd=new Yi({"line-cap":new Ma(Ft.layout_line["line-cap"]),"line-join":new Ia(Ft.layout_line["line-join"]),"line-miter-limit":new Ma(Ft.layout_line["line-miter-limit"]),"line-round-limit":new Ma(Ft.layout_line["line-round-limit"]),"line-sort-key":new Ia(Ft.layout_line["line-sort-key"])}),_d=new Yi({"line-opacity":new Ia(Ft.paint_line["line-opacity"]),"line-color":new Ia(Ft.paint_line["line-color"]),"line-translate":new Ma(Ft.paint_line["line-translate"]),"line-translate-anchor":new Ma(Ft.paint_line["line-translate-anchor"]),"line-width":new Ia(Ft.paint_line["line-width"]),"line-gap-width":new Ia(Ft.paint_line["line-gap-width"]),"line-offset":new Ia(Ft.paint_line["line-offset"]),"line-blur":new Ia(Ft.paint_line["line-blur"]),"line-dasharray":new bo(Ft.paint_line["line-dasharray"]),"line-pattern":new eo(Ft.paint_line["line-pattern"]),"line-gradient":new yo(Ft.paint_line["line-gradient"])}),rv={paint:_d,layout:bd},wd=function(C){function L(){C.apply(this,arguments)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.possiblyEvaluate=function(te,ce){return ce=new ci(Math.floor(ce.zoom),{now:ce.now,fadeDuration:ce.fadeDuration,zoomHistory:ce.zoomHistory,transition:ce.transition}),C.prototype.possiblyEvaluate.call(this,te,ce)},L.prototype.evaluate=function(te,ce,me,Ae){return ce=y({},ce,{zoom:Math.floor(ce.zoom)}),C.prototype.evaluate.call(this,te,ce,me,Ae)},L}(Ia),nv=new wd(rv.paint.properties["line-width"].specification);nv.useIntegerZoom=!0;var Td=function(C){function L(N){C.call(this,N,rv)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype._handleSpecialPaintPropertyUpdate=function(te){te==="line-gradient"&&this._updateGradient()},L.prototype._updateGradient=function(){var te=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Uh(te,"lineProgress"),this.gradientTexture=null},L.prototype.recalculate=function(te,ce){C.prototype.recalculate.call(this,te,ce),this.paint._values["line-floorwidth"]=nv.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,te)},L.prototype.createBucket=function(te){return new al(te)},L.prototype.queryRadius=function(te){var ce=te,me=av(bl("line-width",this,ce),bl("line-gap-width",this,ce)),Ae=bl("line-offset",this,ce);return me/2+Math.abs(Ae)+hu(this.paint.get("line-translate"))},L.prototype.queryIntersectsFeature=function(te,ce,me,Ae,Fe,$e,ft){var dt=jl(te,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),$e.angle,ft),Pt=ft/2*av(this.paint.get("line-width").evaluate(ce,me),this.paint.get("line-gap-width").evaluate(ce,me)),Jt=this.paint.get("line-offset").evaluate(ce,me);return Jt&&(Ae=Ad(Ae,Jt*ft)),Oo(dt,Ae,Pt)},L.prototype.isTileClipped=function(){return!0},L}(Pl);function av(C,L){return L>0?L+2*C:C}function Ad(C,L){for(var N=[],te=new i(0,0),ce=0;ce<C.length;ce++){for(var me=C[ce],Ae=[],Fe=0;Fe<me.length;Fe++){var $e=me[Fe-1],ft=me[Fe],dt=me[Fe+1],Pt=Fe===0?te:ft.sub($e)._unit()._perp(),Jt=Fe===me.length-1?te:dt.sub(ft)._unit()._perp(),Yt=Pt._add(Jt)._unit(),ur=Yt.x*Jt.x+Yt.y*Jt.y;Yt._mult(1/ur),Ae.push(Yt._mult(L)._add(ft))}N.push(Ae)}return N}var gh=lo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Md=lo([{name:"a_projected_pos",components:3,type:"Float32"}],4),sg=lo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Sd=lo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),lg=lo([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),iv=lo([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),kd=lo([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4),ug=lo([{name:"triangle",components:3,type:"Uint16"}]),fg=lo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),cg=lo([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),hg=lo([{type:"Float32",name:"offsetX"}]),vg=lo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function Ed(C,L,N){var te=L.layout.get("text-transform").evaluate(N,{});return te==="uppercase"?C=C.toLocaleUpperCase():te==="lowercase"&&(C=C.toLocaleLowerCase()),Xa.applyArabicShaping&&(C=Xa.applyArabicShaping(C)),C}function Cd(C,L,N){return C.sections.forEach(function(te){te.text=Ed(te.text,L,N)}),C}function Ld(C){var L={},N={},te=[],ce=0;function me(Jr){te.push(C[Jr]),ce++}function Ae(Jr,kn,mn){var Mn=N[Jr];return delete N[Jr],N[kn]=Mn,te[Mn].geometry[0].pop(),te[Mn].geometry[0]=te[Mn].geometry[0].concat(mn[0]),Mn}function Fe(Jr,kn,mn){var Mn=L[kn];return delete L[kn],L[Jr]=Mn,te[Mn].geometry[0].shift(),te[Mn].geometry[0]=mn[0].concat(te[Mn].geometry[0]),Mn}function $e(Jr,kn,mn){var Mn=mn?kn[0][kn[0].length-1]:kn[0][0];return Jr+":"+Mn.x+":"+Mn.y}for(var ft=0;ft<C.length;ft++){var dt=C[ft],Pt=dt.geometry,Jt=dt.text?dt.text.toString():null;if(!Jt){me(ft);continue}var Yt=$e(Jt,Pt),ur=$e(Jt,Pt,!0);if(Yt in N&&ur in L&&N[Yt]!==L[ur]){var Dr=Fe(Yt,ur,Pt),rn=Ae(Yt,ur,te[Dr].geometry);delete L[Yt],delete N[ur],N[$e(Jt,te[rn].geometry,!0)]=rn,te[Dr].geometry=null}else Yt in N?Ae(Yt,ur,Pt):ur in L?Fe(Yt,ur,Pt):(me(ft),L[Yt]=ce-1,N[ur]=ce-1)}return te.filter(function(Jr){return Jr.geometry})}var gc={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function Pd(C){for(var L="",N=0;N<C.length;N++){var te=C.charCodeAt(N+1)||null,ce=C.charCodeAt(N-1)||null,me=(!te||!xr(te)||gc[C[N+1]])&&(!ce||!xr(ce)||gc[C[N-1]]);me&&gc[C[N]]?L+=gc[C[N]]:L+=C[N]}return L}var fs=24,Dd=function(C,L,N,te,ce){var me,Ae,Fe=ce*8-te-1,$e=(1<<Fe)-1,ft=$e>>1,dt=-7,Pt=N?ce-1:0,Jt=N?-1:1,Yt=C[L+Pt];for(Pt+=Jt,me=Yt&(1<<-dt)-1,Yt>>=-dt,dt+=Fe;dt>0;me=me*256+C[L+Pt],Pt+=Jt,dt-=8);for(Ae=me&(1<<-dt)-1,me>>=-dt,dt+=te;dt>0;Ae=Ae*256+C[L+Pt],Pt+=Jt,dt-=8);if(me===0)me=1-ft;else{if(me===$e)return Ae?NaN:(Yt?-1:1)*(1/0);Ae=Ae+Math.pow(2,te),me=me-ft}return(Yt?-1:1)*Ae*Math.pow(2,me-te)},Rd=function(C,L,N,te,ce,me){var Ae,Fe,$e,ft=me*8-ce-1,dt=(1<<ft)-1,Pt=dt>>1,Jt=ce===23?Math.pow(2,-24)-Math.pow(2,-77):0,Yt=te?0:me-1,ur=te?1:-1,Dr=L<0||L===0&&1/L<0?1:0;for(L=Math.abs(L),isNaN(L)||L===1/0?(Fe=isNaN(L)?1:0,Ae=dt):(Ae=Math.floor(Math.log(L)/Math.LN2),L*($e=Math.pow(2,-Ae))<1&&(Ae--,$e*=2),Ae+Pt>=1?L+=Jt/$e:L+=Jt*Math.pow(2,1-Pt),L*$e>=2&&(Ae++,$e/=2),Ae+Pt>=dt?(Fe=0,Ae=dt):Ae+Pt>=1?(Fe=(L*$e-1)*Math.pow(2,ce),Ae=Ae+Pt):(Fe=L*Math.pow(2,Pt-1)*Math.pow(2,ce),Ae=0));ce>=8;C[N+Yt]=Fe&255,Yt+=ur,Fe/=256,ce-=8);for(Ae=Ae<<ce|Fe,ft+=ce;ft>0;C[N+Yt]=Ae&255,Yt+=ur,Ae/=256,ft-=8);C[N+Yt-ur]|=Dr*128},Bc={read:Dd,write:Rd},Nc=uo;function uo(C){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(C)?C:new Uint8Array(C||0),this.pos=0,this.type=0,this.length=this.buf.length}uo.Varint=0,uo.Fixed64=1,uo.Bytes=2,uo.Fixed32=5;var yh=(1<<16)*(1<<16),ov=1/yh,Id=12,sv=typeof TextDecoder>"u"?null:new TextDecoder("utf8");uo.prototype={destroy:function(){this.buf=null},readFields:function(C,L,N){for(N=N||this.length;this.pos<N;){var te=this.readVarint(),ce=te>>3,me=this.pos;this.type=te&7,C(ce,L,this),this.pos===me&&this.skip(te)}return L},readMessage:function(C,L){return this.readFields(C,L,this.readVarint()+this.pos)},readFixed32:function(){var C=Uc(this.buf,this.pos);return this.pos+=4,C},readSFixed32:function(){var C=uv(this.buf,this.pos);return this.pos+=4,C},readFixed64:function(){var C=Uc(this.buf,this.pos)+Uc(this.buf,this.pos+4)*yh;return this.pos+=8,C},readSFixed64:function(){var C=Uc(this.buf,this.pos)+uv(this.buf,this.pos+4)*yh;return this.pos+=8,C},readFloat:function(){var C=Bc.read(this.buf,this.pos,!0,23,4);return this.pos+=4,C},readDouble:function(){var C=Bc.read(this.buf,this.pos,!0,52,8);return this.pos+=8,C},readVarint:function(C){var L=this.buf,N,te;return te=L[this.pos++],N=te&127,te<128||(te=L[this.pos++],N|=(te&127)<<7,te<128)||(te=L[this.pos++],N|=(te&127)<<14,te<128)||(te=L[this.pos++],N|=(te&127)<<21,te<128)?N:(te=L[this.pos],N|=(te&15)<<28,zd(N,C,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var C=this.readVarint();return C%2===1?(C+1)/-2:C/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var C=this.readVarint()+this.pos,L=this.pos;return this.pos=C,C-L>=Id&&sv?Kd(this.buf,L,C):jd(this.buf,L,C)},readBytes:function(){var C=this.readVarint()+this.pos,L=this.buf.subarray(this.pos,C);return this.pos=C,L},readPackedVarint:function(C,L){if(this.type!==uo.Bytes)return C.push(this.readVarint(L));var N=qu(this);for(C=C||[];this.pos<N;)C.push(this.readVarint(L));return C},readPackedSVarint:function(C){if(this.type!==uo.Bytes)return C.push(this.readSVarint());var L=qu(this);for(C=C||[];this.pos<L;)C.push(this.readSVarint());return C},readPackedBoolean:function(C){if(this.type!==uo.Bytes)return C.push(this.readBoolean());var L=qu(this);for(C=C||[];this.pos<L;)C.push(this.readBoolean());return C},readPackedFloat:function(C){if(this.type!==uo.Bytes)return C.push(this.readFloat());var L=qu(this);for(C=C||[];this.pos<L;)C.push(this.readFloat());return C},readPackedDouble:function(C){if(this.type!==uo.Bytes)return C.push(this.readDouble());var L=qu(this);for(C=C||[];this.pos<L;)C.push(this.readDouble());return C},readPackedFixed32:function(C){if(this.type!==uo.Bytes)return C.push(this.readFixed32());var L=qu(this);for(C=C||[];this.pos<L;)C.push(this.readFixed32());return C},readPackedSFixed32:function(C){if(this.type!==uo.Bytes)return C.push(this.readSFixed32());var L=qu(this);for(C=C||[];this.pos<L;)C.push(this.readSFixed32());return C},readPackedFixed64:function(C){if(this.type!==uo.Bytes)return C.push(this.readFixed64());var L=qu(this);for(C=C||[];this.pos<L;)C.push(this.readFixed64());return C},readPackedSFixed64:function(C){if(this.type!==uo.Bytes)return C.push(this.readSFixed64());var L=qu(this);for(C=C||[];this.pos<L;)C.push(this.readSFixed64());return C},skip:function(C){var L=C&7;if(L===uo.Varint)for(;this.buf[this.pos++]>127;);else if(L===uo.Bytes)this.pos=this.readVarint()+this.pos;else if(L===uo.Fixed32)this.pos+=4;else if(L===uo.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+L)},writeTag:function(C,L){this.writeVarint(C<<3|L)},realloc:function(C){for(var L=this.length||16;L<this.pos+C;)L*=2;if(L!==this.length){var N=new Uint8Array(L);N.set(this.buf),this.buf=N,this.length=L}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(C){this.realloc(4),Hf(this.buf,C,this.pos),this.pos+=4},writeSFixed32:function(C){this.realloc(4),Hf(this.buf,C,this.pos),this.pos+=4},writeFixed64:function(C){this.realloc(8),Hf(this.buf,C&-1,this.pos),Hf(this.buf,Math.floor(C*ov),this.pos+4),this.pos+=8},writeSFixed64:function(C){this.realloc(8),Hf(this.buf,C&-1,this.pos),Hf(this.buf,Math.floor(C*ov),this.pos+4),this.pos+=8},writeVarint:function(C){if(C=+C||0,C>268435455||C<0){Fd(C,this);return}this.realloc(4),this.buf[this.pos++]=C&127|(C>127?128:0),!(C<=127)&&(this.buf[this.pos++]=(C>>>=7)&127|(C>127?128:0),!(C<=127)&&(this.buf[this.pos++]=(C>>>=7)&127|(C>127?128:0),!(C<=127)&&(this.buf[this.pos++]=C>>>7&127)))},writeSVarint:function(C){this.writeVarint(C<0?-C*2-1:C*2)},writeBoolean:function(C){this.writeVarint(Boolean(C))},writeString:function(C){C=String(C),this.realloc(C.length*4),this.pos++;var L=this.pos;this.pos=Jd(this.buf,C,this.pos);var N=this.pos-L;N>=128&&lv(L,N,this),this.pos=L-1,this.writeVarint(N),this.pos+=N},writeFloat:function(C){this.realloc(4),Bc.write(this.buf,C,this.pos,!0,23,4),this.pos+=4},writeDouble:function(C){this.realloc(8),Bc.write(this.buf,C,this.pos,!0,52,8),this.pos+=8},writeBytes:function(C){var L=C.length;this.writeVarint(L),this.realloc(L);for(var N=0;N<L;N++)this.buf[this.pos++]=C[N]},writeRawMessage:function(C,L){this.pos++;var N=this.pos;C(L,this);var te=this.pos-N;te>=128&&lv(N,te,this),this.pos=N-1,this.writeVarint(te),this.pos+=te},writeMessage:function(C,L,N){this.writeTag(C,uo.Bytes),this.writeRawMessage(L,N)},writePackedVarint:function(C,L){L.length&&this.writeMessage(C,Nd,L)},writePackedSVarint:function(C,L){L.length&&this.writeMessage(C,Ud,L)},writePackedBoolean:function(C,L){L.length&&this.writeMessage(C,Gd,L)},writePackedFloat:function(C,L){L.length&&this.writeMessage(C,Vd,L)},writePackedDouble:function(C,L){L.length&&this.writeMessage(C,Hd,L)},writePackedFixed32:function(C,L){L.length&&this.writeMessage(C,Yd,L)},writePackedSFixed32:function(C,L){L.length&&this.writeMessage(C,Wd,L)},writePackedFixed64:function(C,L){L.length&&this.writeMessage(C,Xd,L)},writePackedSFixed64:function(C,L){L.length&&this.writeMessage(C,Zd,L)},writeBytesField:function(C,L){this.writeTag(C,uo.Bytes),this.writeBytes(L)},writeFixed32Field:function(C,L){this.writeTag(C,uo.Fixed32),this.writeFixed32(L)},writeSFixed32Field:function(C,L){this.writeTag(C,uo.Fixed32),this.writeSFixed32(L)},writeFixed64Field:function(C,L){this.writeTag(C,uo.Fixed64),this.writeFixed64(L)},writeSFixed64Field:function(C,L){this.writeTag(C,uo.Fixed64),this.writeSFixed64(L)},writeVarintField:function(C,L){this.writeTag(C,uo.Varint),this.writeVarint(L)},writeSVarintField:function(C,L){this.writeTag(C,uo.Varint),this.writeSVarint(L)},writeStringField:function(C,L){this.writeTag(C,uo.Bytes),this.writeString(L)},writeFloatField:function(C,L){this.writeTag(C,uo.Fixed32),this.writeFloat(L)},writeDoubleField:function(C,L){this.writeTag(C,uo.Fixed64),this.writeDouble(L)},writeBooleanField:function(C,L){this.writeVarintField(C,Boolean(L))}};function zd(C,L,N){var te=N.buf,ce,me;if(me=te[N.pos++],ce=(me&112)>>4,me<128||(me=te[N.pos++],ce|=(me&127)<<3,me<128)||(me=te[N.pos++],ce|=(me&127)<<10,me<128)||(me=te[N.pos++],ce|=(me&127)<<17,me<128)||(me=te[N.pos++],ce|=(me&127)<<24,me<128)||(me=te[N.pos++],ce|=(me&1)<<31,me<128))return Vf(C,ce,L);throw new Error("Expected varint not more than 10 bytes")}function qu(C){return C.type===uo.Bytes?C.readVarint()+C.pos:C.pos+1}function Vf(C,L,N){return N?L*4294967296+(C>>>0):(L>>>0)*4294967296+(C>>>0)}function Fd(C,L){var N,te;if(C>=0?(N=C%4294967296|0,te=C/4294967296|0):(N=~(-C%4294967296),te=~(-C/4294967296),N^4294967295?N=N+1|0:(N=0,te=te+1|0)),C>=18446744073709552e3||C<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");L.realloc(10),Od(N,te,L),Bd(te,L)}function Od(C,L,N){N.buf[N.pos++]=C&127|128,C>>>=7,N.buf[N.pos++]=C&127|128,C>>>=7,N.buf[N.pos++]=C&127|128,C>>>=7,N.buf[N.pos++]=C&127|128,C>>>=7,N.buf[N.pos]=C&127}function Bd(C,L){var N=(C&7)<<4;L.buf[L.pos++]|=N|((C>>>=3)?128:0),C&&(L.buf[L.pos++]=C&127|((C>>>=7)?128:0),C&&(L.buf[L.pos++]=C&127|((C>>>=7)?128:0),C&&(L.buf[L.pos++]=C&127|((C>>>=7)?128:0),C&&(L.buf[L.pos++]=C&127|((C>>>=7)?128:0),C&&(L.buf[L.pos++]=C&127)))))}function lv(C,L,N){var te=L<=16383?1:L<=2097151?2:L<=268435455?3:Math.floor(Math.log(L)/(Math.LN2*7));N.realloc(te);for(var ce=N.pos-1;ce>=C;ce--)N.buf[ce+te]=N.buf[ce]}function Nd(C,L){for(var N=0;N<C.length;N++)L.writeVarint(C[N])}function Ud(C,L){for(var N=0;N<C.length;N++)L.writeSVarint(C[N])}function Vd(C,L){for(var N=0;N<C.length;N++)L.writeFloat(C[N])}function Hd(C,L){for(var N=0;N<C.length;N++)L.writeDouble(C[N])}function Gd(C,L){for(var N=0;N<C.length;N++)L.writeBoolean(C[N])}function Yd(C,L){for(var N=0;N<C.length;N++)L.writeFixed32(C[N])}function Wd(C,L){for(var N=0;N<C.length;N++)L.writeSFixed32(C[N])}function Xd(C,L){for(var N=0;N<C.length;N++)L.writeFixed64(C[N])}function Zd(C,L){for(var N=0;N<C.length;N++)L.writeSFixed64(C[N])}function Uc(C,L){return(C[L]|C[L+1]<<8|C[L+2]<<16)+C[L+3]*16777216}function Hf(C,L,N){C[N]=L,C[N+1]=L>>>8,C[N+2]=L>>>16,C[N+3]=L>>>24}function uv(C,L){return(C[L]|C[L+1]<<8|C[L+2]<<16)+(C[L+3]<<24)}function jd(C,L,N){for(var te="",ce=L;ce<N;){var me=C[ce],Ae=null,Fe=me>239?4:me>223?3:me>191?2:1;if(ce+Fe>N)break;var $e,ft,dt;Fe===1?me<128&&(Ae=me):Fe===2?($e=C[ce+1],($e&192)===128&&(Ae=(me&31)<<6|$e&63,Ae<=127&&(Ae=null))):Fe===3?($e=C[ce+1],ft=C[ce+2],($e&192)===128&&(ft&192)===128&&(Ae=(me&15)<<12|($e&63)<<6|ft&63,(Ae<=2047||Ae>=55296&&Ae<=57343)&&(Ae=null))):Fe===4&&($e=C[ce+1],ft=C[ce+2],dt=C[ce+3],($e&192)===128&&(ft&192)===128&&(dt&192)===128&&(Ae=(me&15)<<18|($e&63)<<12|(ft&63)<<6|dt&63,(Ae<=65535||Ae>=1114112)&&(Ae=null))),Ae===null?(Ae=65533,Fe=1):Ae>65535&&(Ae-=65536,te+=String.fromCharCode(Ae>>>10&1023|55296),Ae=56320|Ae&1023),te+=String.fromCharCode(Ae),ce+=Fe}return te}function Kd(C,L,N){return sv.decode(C.subarray(L,N))}function Jd(C,L,N){for(var te=0,ce,me;te<L.length;te++){if(ce=L.charCodeAt(te),ce>55295&&ce<57344)if(me)if(ce<56320){C[N++]=239,C[N++]=191,C[N++]=189,me=ce;continue}else ce=me-55296<<10|ce-56320|65536,me=null;else{ce>56319||te+1===L.length?(C[N++]=239,C[N++]=191,C[N++]=189):me=ce;continue}else me&&(C[N++]=239,C[N++]=191,C[N++]=189,me=null);ce<128?C[N++]=ce:(ce<2048?C[N++]=ce>>6|192:(ce<65536?C[N++]=ce>>12|224:(C[N++]=ce>>18|240,C[N++]=ce>>12&63|128),C[N++]=ce>>6&63|128),C[N++]=ce&63|128)}return N}var mh=3;function Qd(C,L,N){C===1&&N.readMessage($d,L)}function $d(C,L,N){if(C===3){var te=N.readMessage(qd,{}),ce=te.id,me=te.bitmap,Ae=te.width,Fe=te.height,$e=te.left,ft=te.top,dt=te.advance;L.push({id:ce,bitmap:new Af({width:Ae+2*mh,height:Fe+2*mh},me),metrics:{width:Ae,height:Fe,left:$e,top:ft,advance:dt}})}}function qd(C,L,N){C===1?L.id=N.readVarint():C===2?L.bitmap=N.readBytes():C===3?L.width=N.readVarint():C===4?L.height=N.readVarint():C===5?L.left=N.readSVarint():C===6?L.top=N.readSVarint():C===7&&(L.advance=N.readVarint())}function e0(C){return new Nc(C).readFields(Qd,[])}var fv=mh;function cv(C){for(var L=0,N=0,te=0,ce=C;te<ce.length;te+=1){var me=ce[te];L+=me.w*me.h,N=Math.max(N,me.w)}C.sort(function(rn,Jr){return Jr.h-rn.h});for(var Ae=Math.max(Math.ceil(Math.sqrt(L/.95)),N),Fe=[{x:0,y:0,w:Ae,h:1/0}],$e=0,ft=0,dt=0,Pt=C;dt<Pt.length;dt+=1)for(var Jt=Pt[dt],Yt=Fe.length-1;Yt>=0;Yt--){var ur=Fe[Yt];if(!(Jt.w>ur.w||Jt.h>ur.h)){if(Jt.x=ur.x,Jt.y=ur.y,ft=Math.max(ft,Jt.y+Jt.h),$e=Math.max($e,Jt.x+Jt.w),Jt.w===ur.w&&Jt.h===ur.h){var Dr=Fe.pop();Yt<Fe.length&&(Fe[Yt]=Dr)}else Jt.h===ur.h?(ur.x+=Jt.w,ur.w-=Jt.w):Jt.w===ur.w?(ur.y+=Jt.h,ur.h-=Jt.h):(Fe.push({x:ur.x+Jt.w,y:ur.y,w:ur.w-Jt.w,h:Jt.h}),ur.y+=Jt.h,ur.h-=Jt.h);break}}return{w:$e,h:ft,fill:L/($e*ft)||0}}var _l=1,Vc=function(L,N){var te=N.pixelRatio,ce=N.version,me=N.stretchX,Ae=N.stretchY,Fe=N.content;this.paddedRect=L,this.pixelRatio=te,this.stretchX=me,this.stretchY=Ae,this.content=Fe,this.version=ce},yc={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};yc.tl.get=function(){return[this.paddedRect.x+_l,this.paddedRect.y+_l]},yc.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-_l,this.paddedRect.y+this.paddedRect.h-_l]},yc.tlbr.get=function(){return this.tl.concat(this.br)},yc.displaySize.get=function(){return[(this.paddedRect.w-_l*2)/this.pixelRatio,(this.paddedRect.h-_l*2)/this.pixelRatio]},Object.defineProperties(Vc.prototype,yc);var mc=function(L,N){var te={},ce={};this.haveRenderCallbacks=[];var me=[];this.addImages(L,te,me),this.addImages(N,ce,me);var Ae=cv(me),Fe=Ae.w,$e=Ae.h,ft=new nl({width:Fe||1,height:$e||1});for(var dt in L){var Pt=L[dt],Jt=te[dt].paddedRect;nl.copy(Pt.data,ft,{x:0,y:0},{x:Jt.x+_l,y:Jt.y+_l},Pt.data)}for(var Yt in N){var ur=N[Yt],Dr=ce[Yt].paddedRect,rn=Dr.x+_l,Jr=Dr.y+_l,kn=ur.data.width,mn=ur.data.height;nl.copy(ur.data,ft,{x:0,y:0},{x:rn,y:Jr},ur.data),nl.copy(ur.data,ft,{x:0,y:mn-1},{x:rn,y:Jr-1},{width:kn,height:1}),nl.copy(ur.data,ft,{x:0,y:0},{x:rn,y:Jr+mn},{width:kn,height:1}),nl.copy(ur.data,ft,{x:kn-1,y:0},{x:rn-1,y:Jr},{width:1,height:mn}),nl.copy(ur.data,ft,{x:0,y:0},{x:rn+kn,y:Jr},{width:1,height:mn})}this.image=ft,this.iconPositions=te,this.patternPositions=ce};mc.prototype.addImages=function(L,N,te){for(var ce in L){var me=L[ce],Ae={x:0,y:0,w:me.data.width+2*_l,h:me.data.height+2*_l};te.push(Ae),N[ce]=new Vc(Ae,me),me.hasRenderCallback&&this.haveRenderCallbacks.push(ce)}},mc.prototype.patchUpdatedImages=function(L,N){L.dispatchRenderCallbacks(this.haveRenderCallbacks);for(var te in L.updatedImages)this.patchUpdatedImage(this.iconPositions[te],L.getImage(te),N),this.patchUpdatedImage(this.patternPositions[te],L.getImage(te),N)},mc.prototype.patchUpdatedImage=function(L,N,te){if(!(!L||!N)&&L.version!==N.version){L.version=N.version;var ce=L.tl,me=ce[0],Ae=ce[1];te.update(N.data,void 0,{x:me,y:Ae})}},Ea("ImagePosition",Vc),Ea("ImageAtlas",mc);var Il={horizontal:1,vertical:2,horizontalOnly:3},xc=-17;function t0(C){for(var L=0,N=C;L<N.length;L+=1){var te=N[L];if(te.positionedGlyphs.length!==0)return!1}return!0}var hv=57344,vv=63743,Gf=function(){this.scale=1,this.fontStack="",this.imageName=null};Gf.forText=function(L,N){var te=new Gf;return te.scale=L||1,te.fontStack=N,te},Gf.forImage=function(L){var N=new Gf;return N.imageName=L,N};var Es=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};Es.fromFeature=function(L,N){for(var te=new Es,ce=0;ce<L.sections.length;ce++){var me=L.sections[ce];me.image?te.addImageSection(me):te.addTextSection(me,N)}return te},Es.prototype.length=function(){return this.text.length},Es.prototype.getSection=function(L){return this.sections[this.sectionIndex[L]]},Es.prototype.getSectionIndex=function(L){return this.sectionIndex[L]},Es.prototype.getCharCode=function(L){return this.text.charCodeAt(L)},Es.prototype.verticalizePunctuation=function(){this.text=Pd(this.text)},Es.prototype.trim=function(){for(var L=0,N=0;N<this.text.length&&Xu[this.text.charCodeAt(N)];N++)L++;for(var te=this.text.length,ce=this.text.length-1;ce>=0&&ce>=L&&Xu[this.text.charCodeAt(ce)];ce--)te--;this.text=this.text.substring(L,te),this.sectionIndex=this.sectionIndex.slice(L,te)},Es.prototype.substring=function(L,N){var te=new Es;return te.text=this.text.substring(L,N),te.sectionIndex=this.sectionIndex.slice(L,N),te.sections=this.sections,te},Es.prototype.toString=function(){return this.text},Es.prototype.getMaxScale=function(){var L=this;return this.sectionIndex.reduce(function(N,te){return Math.max(N,L.sections[te].scale)},0)},Es.prototype.addTextSection=function(L,N){this.text+=L.text,this.sections.push(Gf.forText(L.scale,L.fontStack||N));for(var te=this.sections.length-1,ce=0;ce<L.text.length;++ce)this.sectionIndex.push(te)},Es.prototype.addImageSection=function(L){var N=L.image?L.image.name:"";if(N.length===0){F("Can't add FormattedSection with an empty image.");return}var te=this.getNextImageSectionCharCode();if(!te){F("Reached maximum number of images "+(vv-hv+2));return}this.text+=String.fromCharCode(te),this.sections.push(Gf.forImage(N)),this.sectionIndex.push(this.sections.length-1)},Es.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=vv?null:++this.imageSectionID:(this.imageSectionID=hv,this.imageSectionID)};function r0(C,L){for(var N=[],te=C.text,ce=0,me=0,Ae=L;me<Ae.length;me+=1){var Fe=Ae[me];N.push(C.substring(ce,Fe)),ce=Fe}return ce<te.length&&N.push(C.substring(ce,te.length)),N}function Hc(C,L,N,te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr){var rn=Es.fromFeature(C,ce);Pt===Il.vertical&&rn.verticalizePunctuation();var Jr,kn=Xa.processBidirectionalText,mn=Xa.processStyledBidirectionalText;if(kn&&rn.sections.length===1){Jr=[];for(var Mn=kn(rn.toString(),xh(rn,ft,me,L,te,Yt,ur)),zn=0,Yn=Mn;zn<Yn.length;zn+=1){var la=Yn[zn],ia=new Es;ia.text=la,ia.sections=rn.sections;for(var Ba=0;Ba<la.length;Ba++)ia.sectionIndex.push(0);Jr.push(ia)}}else if(mn){Jr=[];for(var _a=mn(rn.text,rn.sectionIndex,xh(rn,ft,me,L,te,Yt,ur)),Sa=0,ni=_a;Sa<ni.length;Sa+=1){var Da=ni[Sa],za=new Es;za.text=Da[0],za.sectionIndex=Da[1],za.sections=rn.sections,Jr.push(za)}}else Jr=r0(rn,xh(rn,ft,me,L,te,Yt,ur));var vi=[],ei={positionedLines:vi,text:rn.toString(),top:dt[1],bottom:dt[1],left:dt[0],right:dt[0],writingMode:Pt,iconsInText:!1,verticalizable:!1};return i0(ei,L,N,te,Jr,Ae,Fe,$e,Pt,ft,Jt,Dr),t0(vi)?!1:ei}var Xu={};Xu[9]=!0,Xu[10]=!0,Xu[11]=!0,Xu[12]=!0,Xu[13]=!0,Xu[32]=!0;var wl={};wl[10]=!0,wl[32]=!0,wl[38]=!0,wl[40]=!0,wl[41]=!0,wl[43]=!0,wl[45]=!0,wl[47]=!0,wl[173]=!0,wl[183]=!0,wl[8203]=!0,wl[8208]=!0,wl[8211]=!0,wl[8231]=!0;function pv(C,L,N,te,ce,me){if(L.imageName){var $e=te[L.imageName];return $e?$e.displaySize[0]*L.scale*fs/me+ce:0}else{var Ae=N[L.fontStack],Fe=Ae&&Ae[C];return Fe?Fe.metrics.advance*L.scale+ce:0}}function n0(C,L,N,te,ce,me){for(var Ae=0,Fe=0;Fe<C.length();Fe++){var $e=C.getSection(Fe);Ae+=pv(C.getCharCode(Fe),$e,te,ce,L,me)}var ft=Math.max(1,Math.ceil(Ae/N));return Ae/ft}function dv(C,L,N,te){var ce=Math.pow(C-L,2);return te?C<L?ce/2:ce*2:ce+Math.abs(N)*N}function a0(C,L,N){var te=0;return C===10&&(te-=1e4),N&&(te+=150),(C===40||C===65288)&&(te+=50),(L===41||L===65289)&&(te+=50),te}function gv(C,L,N,te,ce,me){for(var Ae=null,Fe=dv(L,N,ce,me),$e=0,ft=te;$e<ft.length;$e+=1){var dt=ft[$e],Pt=L-dt.x,Jt=dv(Pt,N,ce,me)+dt.badness;Jt<=Fe&&(Ae=dt,Fe=Jt)}return{index:C,x:L,priorBreak:Ae,badness:Fe}}function yv(C){return C?yv(C.priorBreak).concat(C.index):[]}function xh(C,L,N,te,ce,me,Ae){if(me!=="point")return[];if(!C)return[];for(var Fe=[],$e=n0(C,L,N,te,ce,Ae),ft=C.text.indexOf("\u200B")>=0,dt=0,Pt=0;Pt<C.length();Pt++){var Jt=C.getSection(Pt),Yt=C.getCharCode(Pt);if(Xu[Yt]||(dt+=pv(Yt,Jt,te,ce,L,Ae)),Pt<C.length()-1){var ur=Zt(Yt);(wl[Yt]||ur||Jt.imageName)&&Fe.push(gv(Pt+1,dt,$e,Fe,a0(Yt,C.getCharCode(Pt+1),ur&&ft),!1))}}return yv(gv(C.length(),dt,$e,Fe,0,!0))}function bh(C){var L=.5,N=.5;switch(C){case"right":case"top-right":case"bottom-right":L=1;break;case"left":case"top-left":case"bottom-left":L=0;break}switch(C){case"bottom":case"bottom-right":case"bottom-left":N=1;break;case"top":case"top-right":case"top-left":N=0;break}return{horizontalAlign:L,verticalAlign:N}}function i0(C,L,N,te,ce,me,Ae,Fe,$e,ft,dt,Pt){for(var Jt=0,Yt=xc,ur=0,Dr=0,rn=Fe==="right"?1:Fe==="left"?0:.5,Jr=0,kn=0,mn=ce;kn<mn.length;kn+=1){var Mn=mn[kn];Mn.trim();var zn=Mn.getMaxScale(),Yn=(zn-1)*fs,la={positionedGlyphs:[],lineOffset:0};C.positionedLines[Jr]=la;var ia=la.positionedGlyphs,Ba=0;if(!Mn.length()){Yt+=me,++Jr;continue}for(var _a=0;_a<Mn.length();_a++){var Sa=Mn.getSection(_a),ni=Mn.getSectionIndex(_a),Da=Mn.getCharCode(_a),za=0,vi=null,ei=null,zi=null,Ki=fs,Fi=!($e===Il.horizontal||!dt&&!jt(Da)||dt&&(Xu[Da]||Wr(Da)));if(Sa.imageName){var Mo=te[Sa.imageName];if(!Mo)continue;zi=Sa.imageName,C.iconsInText=C.iconsInText||!0,ei=Mo.paddedRect;var Ro=Mo.displaySize;Sa.scale=Sa.scale*fs/Pt,vi={width:Ro[0],height:Ro[1],left:_l,top:-fv,advance:Fi?Ro[1]:Ro[0]};var rs=fs-Ro[1]*Sa.scale;za=Yn+rs,Ki=vi.advance;var Vo=Fi?Ro[0]*Sa.scale-fs*zn:Ro[1]*Sa.scale-fs*zn;Vo>0&&Vo>Ba&&(Ba=Vo)}else{var Oi=N[Sa.fontStack],Pi=Oi&&Oi[Da];if(Pi&&Pi.rect)ei=Pi.rect,vi=Pi.metrics;else{var to=L[Sa.fontStack],fo=to&&to[Da];if(!fo)continue;vi=fo.metrics}za=(zn-Sa.scale)*fs}Fi?(C.verticalizable=!0,ia.push({glyph:Da,imageName:zi,x:Jt,y:Yt+za,vertical:Fi,scale:Sa.scale,fontStack:Sa.fontStack,sectionIndex:ni,metrics:vi,rect:ei}),Jt+=Ki*Sa.scale+ft):(ia.push({glyph:Da,imageName:zi,x:Jt,y:Yt+za,vertical:Fi,scale:Sa.scale,fontStack:Sa.fontStack,sectionIndex:ni,metrics:vi,rect:ei}),Jt+=vi.advance*Sa.scale+ft)}if(ia.length!==0){var Cs=Jt-ft;ur=Math.max(Cs,ur),o0(ia,0,ia.length-1,rn,Ba)}Jt=0;var Ls=me*zn+Ba;la.lineOffset=Math.max(Ba,Yn),Yt+=Ls,Dr=Math.max(Ls,Dr),++Jr}var ns=Yt-xc,Us=bh(Ae),Vs=Us.horizontalAlign,Qo=Us.verticalAlign;s0(C.positionedLines,rn,Vs,Qo,ur,Dr,me,ns,ce.length),C.top+=-Qo*ns,C.bottom=C.top+ns,C.left+=-Vs*ur,C.right=C.left+ur}function o0(C,L,N,te,ce){if(!(!te&&!ce))for(var me=C[N],Ae=me.metrics.advance*me.scale,Fe=(C[N].x+Ae)*te,$e=L;$e<=N;$e++)C[$e].x-=Fe,C[$e].y+=ce}function s0(C,L,N,te,ce,me,Ae,Fe,$e){var ft=(L-N)*ce,dt=0;me!==Ae?dt=-Fe*te-xc:dt=(-te*$e+.5)*Ae;for(var Pt=0,Jt=C;Pt<Jt.length;Pt+=1)for(var Yt=Jt[Pt],ur=0,Dr=Yt.positionedGlyphs;ur<Dr.length;ur+=1){var rn=Dr[ur];rn.x+=ft,rn.y+=dt}}function l0(C,L,N){var te=bh(N),ce=te.horizontalAlign,me=te.verticalAlign,Ae=L[0],Fe=L[1],$e=Ae-C.displaySize[0]*ce,ft=$e+C.displaySize[0],dt=Fe-C.displaySize[1]*me,Pt=dt+C.displaySize[1];return{image:C,top:dt,bottom:Pt,left:$e,right:ft}}function mv(C,L,N,te,ce,me){var Ae=C.image,Fe;if(Ae.content){var $e=Ae.content,ft=Ae.pixelRatio||1;Fe=[$e[0]/ft,$e[1]/ft,Ae.displaySize[0]-$e[2]/ft,Ae.displaySize[1]-$e[3]/ft]}var dt=L.left*me,Pt=L.right*me,Jt,Yt,ur,Dr;N==="width"||N==="both"?(Dr=ce[0]+dt-te[3],Yt=ce[0]+Pt+te[1]):(Dr=ce[0]+(dt+Pt-Ae.displaySize[0])/2,Yt=Dr+Ae.displaySize[0]);var rn=L.top*me,Jr=L.bottom*me;return N==="height"||N==="both"?(Jt=ce[1]+rn-te[0],ur=ce[1]+Jr+te[2]):(Jt=ce[1]+(rn+Jr-Ae.displaySize[1])/2,ur=Jt+Ae.displaySize[1]),{image:Ae,top:Jt,right:Yt,bottom:ur,left:Dr,collisionPadding:Fe}}var Yf=function(C){function L(N,te,ce,me){C.call(this,N,te),this.angle=ce,me!==void 0&&(this.segment=me)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.clone=function(){return new L(this.x,this.y,this.angle,this.segment)},L}(i);Ea("Anchor",Yf);var ku=128;function _h(C,L){var N=L.expression;if(N.kind==="constant"){var te=N.evaluate(new ci(C+1));return{kind:"constant",layoutSize:te}}else{if(N.kind==="source")return{kind:"source"};for(var ce=N.zoomStops,me=N.interpolationType,Ae=0;Ae<ce.length&&ce[Ae]<=C;)Ae++;Ae=Math.max(0,Ae-1);for(var Fe=Ae;Fe<ce.length&&ce[Fe]<C+1;)Fe++;Fe=Math.min(ce.length-1,Fe);var $e=ce[Ae],ft=ce[Fe];if(N.kind==="composite")return{kind:"composite",minZoom:$e,maxZoom:ft,interpolationType:me};var dt=N.evaluate(new ci($e)),Pt=N.evaluate(new ci(ft));return{kind:"camera",minZoom:$e,maxZoom:ft,minSize:dt,maxSize:Pt,interpolationType:me}}}function xv(C,L,N){var te=L.uSize,ce=L.uSizeT,me=N.lowerSize,Ae=N.upperSize;return C.kind==="source"?me/ku:C.kind==="composite"?ho(me/ku,Ae/ku,ce):te}function bv(C,L){var N=0,te=0;if(C.kind==="constant")te=C.layoutSize;else if(C.kind!=="source"){var ce=C.interpolationType,me=C.minZoom,Ae=C.maxZoom,Fe=ce?x(co.interpolationFactor(ce,L,me,Ae),0,1):0;C.kind==="camera"?te=ho(C.minSize,C.maxSize,Fe):N=Fe}return{uSizeT:N,uSize:te}}var u0=Object.freeze({__proto__:null,getSizeData:_h,evaluateSizeForFeature:xv,evaluateSizeForZoom:bv,SIZE_PACK_FACTOR:ku});function _v(C,L,N,te,ce){if(L.segment===void 0)return!0;for(var me=L,Ae=L.segment+1,Fe=0;Fe>-N/2;){if(Ae--,Ae<0)return!1;Fe-=C[Ae].dist(me),me=C[Ae]}Fe+=C[Ae].dist(C[Ae+1]),Ae++;for(var $e=[],ft=0;Fe<N/2;){var dt=C[Ae-1],Pt=C[Ae],Jt=C[Ae+1];if(!Jt)return!1;var Yt=dt.angleTo(Pt)-Pt.angleTo(Jt);for(Yt=Math.abs((Yt+3*Math.PI)%(Math.PI*2)-Math.PI),$e.push({distance:Fe,angleDelta:Yt}),ft+=Yt;Fe-$e[0].distance>te;)ft-=$e.shift().angleDelta;if(ft>ce)return!1;Ae++,Fe+=Pt.dist(Jt)}return!0}function wv(C){for(var L=0,N=0;N<C.length-1;N++)L+=C[N].dist(C[N+1]);return L}function Tv(C,L,N){return C?3/5*L*N:0}function Av(C,L){return Math.max(C?C.right-C.left:0,L?L.right-L.left:0)}function f0(C,L,N,te,ce,me){for(var Ae=Tv(N,ce,me),Fe=Av(N,te)*me,$e=0,ft=wv(C)/2,dt=0;dt<C.length-1;dt++){var Pt=C[dt],Jt=C[dt+1],Yt=Pt.dist(Jt);if($e+Yt>ft){var ur=(ft-$e)/Yt,Dr=ho(Pt.x,Jt.x,ur),rn=ho(Pt.y,Jt.y,ur),Jr=new Yf(Dr,rn,Jt.angleTo(Pt),dt);return Jr._round(),!Ae||_v(C,Jr,Fe,Ae,L)?Jr:void 0}$e+=Yt}}function c0(C,L,N,te,ce,me,Ae,Fe,$e){var ft=Tv(te,me,Ae),dt=Av(te,ce),Pt=dt*Ae,Jt=C[0].x===0||C[0].x===$e||C[0].y===0||C[0].y===$e;L-Pt<L/4&&(L=Pt+L/4);var Yt=me*2,ur=Jt?L/2*Fe%L:(dt/2+Yt)*Ae*Fe%L;return Mv(C,ur,L,ft,N,Pt,Jt,!1,$e)}function Mv(C,L,N,te,ce,me,Ae,Fe,$e){for(var ft=me/2,dt=wv(C),Pt=0,Jt=L-N,Yt=[],ur=0;ur<C.length-1;ur++){for(var Dr=C[ur],rn=C[ur+1],Jr=Dr.dist(rn),kn=rn.angleTo(Dr);Jt+N<Pt+Jr;){Jt+=N;var mn=(Jt-Pt)/Jr,Mn=ho(Dr.x,rn.x,mn),zn=ho(Dr.y,rn.y,mn);if(Mn>=0&&Mn<$e&&zn>=0&&zn<$e&&Jt-ft>=0&&Jt+ft<=dt){var Yn=new Yf(Mn,zn,kn,ur);Yn._round(),(!te||_v(C,Yn,me,te,ce))&&Yt.push(Yn)}}Pt+=Jr}return!Fe&&!Yt.length&&!Ae&&(Yt=Mv(C,Pt/2,N,te,ce,me,Ae,!0,$e)),Yt}function Sv(C,L,N,te,ce){for(var me=[],Ae=0;Ae<C.length;Ae++)for(var Fe=C[Ae],$e=void 0,ft=0;ft<Fe.length-1;ft++){var dt=Fe[ft],Pt=Fe[ft+1];dt.x<L&&Pt.x<L||(dt.x<L?dt=new i(L,dt.y+(Pt.y-dt.y)*((L-dt.x)/(Pt.x-dt.x)))._round():Pt.x<L&&(Pt=new i(L,dt.y+(Pt.y-dt.y)*((L-dt.x)/(Pt.x-dt.x)))._round()),!(dt.y<N&&Pt.y<N)&&(dt.y<N?dt=new i(dt.x+(Pt.x-dt.x)*((N-dt.y)/(Pt.y-dt.y)),N)._round():Pt.y<N&&(Pt=new i(dt.x+(Pt.x-dt.x)*((N-dt.y)/(Pt.y-dt.y)),N)._round()),!(dt.x>=te&&Pt.x>=te)&&(dt.x>=te?dt=new i(te,dt.y+(Pt.y-dt.y)*((te-dt.x)/(Pt.x-dt.x)))._round():Pt.x>=te&&(Pt=new i(te,dt.y+(Pt.y-dt.y)*((te-dt.x)/(Pt.x-dt.x)))._round()),!(dt.y>=ce&&Pt.y>=ce)&&(dt.y>=ce?dt=new i(dt.x+(Pt.x-dt.x)*((ce-dt.y)/(Pt.y-dt.y)),ce)._round():Pt.y>=ce&&(Pt=new i(dt.x+(Pt.x-dt.x)*((ce-dt.y)/(Pt.y-dt.y)),ce)._round()),(!$e||!dt.equals($e[$e.length-1]))&&($e=[dt],me.push($e)),$e.push(Pt)))))}return me}var Wf=_l;function kv(C,L,N,te){var ce=[],me=C.image,Ae=me.pixelRatio,Fe=me.paddedRect.w-2*Wf,$e=me.paddedRect.h-2*Wf,ft=C.right-C.left,dt=C.bottom-C.top,Pt=me.stretchX||[[0,Fe]],Jt=me.stretchY||[[0,$e]],Yt=function(Oi,Pi){return Oi+Pi[1]-Pi[0]},ur=Pt.reduce(Yt,0),Dr=Jt.reduce(Yt,0),rn=Fe-ur,Jr=$e-Dr,kn=0,mn=ur,Mn=0,zn=Dr,Yn=0,la=rn,ia=0,Ba=Jr;if(me.content&&te){var _a=me.content;kn=Gc(Pt,0,_a[0]),Mn=Gc(Jt,0,_a[1]),mn=Gc(Pt,_a[0],_a[2]),zn=Gc(Jt,_a[1],_a[3]),Yn=_a[0]-kn,ia=_a[1]-Mn,la=_a[2]-_a[0]-mn,Ba=_a[3]-_a[1]-zn}var Sa=function(Oi,Pi,to,fo){var Mo=Yc(Oi.stretch-kn,mn,ft,C.left),Ro=Wc(Oi.fixed-Yn,la,Oi.stretch,ur),rs=Yc(Pi.stretch-Mn,zn,dt,C.top),Vo=Wc(Pi.fixed-ia,Ba,Pi.stretch,Dr),Cs=Yc(to.stretch-kn,mn,ft,C.left),Ls=Wc(to.fixed-Yn,la,to.stretch,ur),ns=Yc(fo.stretch-Mn,zn,dt,C.top),Us=Wc(fo.fixed-ia,Ba,fo.stretch,Dr),Vs=new i(Mo,rs),Qo=new i(Cs,rs),Hs=new i(Cs,ns),zl=new i(Mo,ns),rf=new i(Ro/Ae,Vo/Ae),df=new i(Ls/Ae,Us/Ae),gf=L*Math.PI/180;if(gf){var yf=Math.sin(gf),qf=Math.cos(gf),pu=[qf,-yf,yf,qf];Vs._matMult(pu),Qo._matMult(pu),zl._matMult(pu),Hs._matMult(pu)}var Qc=Oi.stretch+Oi.fixed,Ch=to.stretch+to.fixed,$c=Pi.stretch+Pi.fixed,Lh=fo.stretch+fo.fixed,Kl={x:me.paddedRect.x+Wf+Qc,y:me.paddedRect.y+Wf+$c,w:Ch-Qc,h:Lh-$c},ec=la/Ae/ft,qc=Ba/Ae/dt;return{tl:Vs,tr:Qo,bl:zl,br:Hs,tex:Kl,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:rf,pixelOffsetBR:df,minFontScaleX:ec,minFontScaleY:qc,isSDF:N}};if(!te||!me.stretchX&&!me.stretchY)ce.push(Sa({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:Fe+1},{fixed:0,stretch:$e+1}));else for(var ni=Ev(Pt,rn,ur),Da=Ev(Jt,Jr,Dr),za=0;za<ni.length-1;za++)for(var vi=ni[za],ei=ni[za+1],zi=0;zi<Da.length-1;zi++){var Ki=Da[zi],Fi=Da[zi+1];ce.push(Sa(vi,Ki,ei,Fi))}return ce}function Gc(C,L,N){for(var te=0,ce=0,me=C;ce<me.length;ce+=1){var Ae=me[ce];te+=Math.max(L,Math.min(N,Ae[1]))-Math.max(L,Math.min(N,Ae[0]))}return te}function Ev(C,L,N){for(var te=[{fixed:-Wf,stretch:0}],ce=0,me=C;ce<me.length;ce+=1){var Ae=me[ce],Fe=Ae[0],$e=Ae[1],ft=te[te.length-1];te.push({fixed:Fe-ft.stretch,stretch:ft.stretch}),te.push({fixed:Fe-ft.stretch,stretch:ft.stretch+($e-Fe)})}return te.push({fixed:L+Wf,stretch:N}),te}function Yc(C,L,N,te){return C/L*N+te}function Wc(C,L,N,te){return C-L*N/te}function h0(C,L,N,te,ce,me,Ae,Fe){for(var $e=te.layout.get("text-rotate").evaluate(me,{})*Math.PI/180,ft=[],dt=0,Pt=L.positionedLines;dt<Pt.length;dt+=1)for(var Jt=Pt[dt],Yt=0,ur=Jt.positionedGlyphs;Yt<ur.length;Yt+=1){var Dr=ur[Yt];if(!!Dr.rect){var rn=Dr.rect||{},Jr=1,kn=fv+Jr,mn=!0,Mn=1,zn=0,Yn=(ce||Fe)&&Dr.vertical,la=Dr.metrics.advance*Dr.scale/2;if(Fe&&L.verticalizable){var ia=(Dr.scale-1)*fs,Ba=(fs-Dr.metrics.width*Dr.scale)/2;zn=Jt.lineOffset/2-(Dr.imageName?-Ba:ia)}if(Dr.imageName){var _a=Ae[Dr.imageName];mn=_a.sdf,Mn=_a.pixelRatio,kn=_l/Mn}var Sa=ce?[Dr.x+la,Dr.y]:[0,0],ni=ce?[0,0]:[Dr.x+la+N[0],Dr.y+N[1]-zn],Da=[0,0];Yn&&(Da=ni,ni=[0,0]);var za=(Dr.metrics.left-kn)*Dr.scale-la+ni[0],vi=(-Dr.metrics.top-kn)*Dr.scale+ni[1],ei=za+rn.w*Dr.scale/Mn,zi=vi+rn.h*Dr.scale/Mn,Ki=new i(za,vi),Fi=new i(ei,vi),Oi=new i(za,zi),Pi=new i(ei,zi);if(Yn){var to=new i(-la,la-xc),fo=-Math.PI/2,Mo=fs/2-la,Ro=Dr.imageName?Mo:0,rs=new i(5-xc-Mo,-Ro),Vo=new(Function.prototype.bind.apply(i,[null].concat(Da)));Ki._rotateAround(fo,to)._add(rs)._add(Vo),Fi._rotateAround(fo,to)._add(rs)._add(Vo),Oi._rotateAround(fo,to)._add(rs)._add(Vo),Pi._rotateAround(fo,to)._add(rs)._add(Vo)}if($e){var Cs=Math.sin($e),Ls=Math.cos($e),ns=[Ls,-Cs,Cs,Ls];Ki._matMult(ns),Fi._matMult(ns),Oi._matMult(ns),Pi._matMult(ns)}var Us=new i(0,0),Vs=new i(0,0),Qo=0,Hs=0;ft.push({tl:Ki,tr:Fi,bl:Oi,br:Pi,tex:rn,writingMode:L.writingMode,glyphOffset:Sa,sectionIndex:Dr.sectionIndex,isSDF:mn,pixelOffsetTL:Us,pixelOffsetBR:Vs,minFontScaleX:Qo,minFontScaleY:Hs})}}return ft}var Xc=function(L,N,te,ce,me,Ae,Fe,$e,ft,dt){if(this.boxStartIndex=L.length,ft){var Pt=Ae.top,Jt=Ae.bottom,Yt=Ae.collisionPadding;Yt&&(Pt-=Yt[1],Jt+=Yt[3]);var ur=Jt-Pt;ur>0&&(ur=Math.max(10,ur),this.circleDiameter=ur)}else{var Dr=Ae.top*Fe-$e,rn=Ae.bottom*Fe+$e,Jr=Ae.left*Fe-$e,kn=Ae.right*Fe+$e,mn=Ae.collisionPadding;if(mn&&(Jr-=mn[0]*Fe,Dr-=mn[1]*Fe,kn+=mn[2]*Fe,rn+=mn[3]*Fe),dt){var Mn=new i(Jr,Dr),zn=new i(kn,Dr),Yn=new i(Jr,rn),la=new i(kn,rn),ia=dt*Math.PI/180;Mn._rotate(ia),zn._rotate(ia),Yn._rotate(ia),la._rotate(ia),Jr=Math.min(Mn.x,zn.x,Yn.x,la.x),kn=Math.max(Mn.x,zn.x,Yn.x,la.x),Dr=Math.min(Mn.y,zn.y,Yn.y,la.y),rn=Math.max(Mn.y,zn.y,Yn.y,la.y)}L.emplaceBack(N.x,N.y,Jr,Dr,kn,rn,te,ce,me)}this.boxEndIndex=L.length},Xf=function(L,N){if(L===void 0&&(L=[]),N===void 0&&(N=v0),this.data=L,this.length=this.data.length,this.compare=N,this.length>0)for(var te=(this.length>>1)-1;te>=0;te--)this._down(te)};Xf.prototype.push=function(L){this.data.push(L),this.length++,this._up(this.length-1)},Xf.prototype.pop=function(){if(this.length!==0){var L=this.data[0],N=this.data.pop();return this.length--,this.length>0&&(this.data[0]=N,this._down(0)),L}},Xf.prototype.peek=function(){return this.data[0]},Xf.prototype._up=function(L){for(var N=this,te=N.data,ce=N.compare,me=te[L];L>0;){var Ae=L-1>>1,Fe=te[Ae];if(ce(me,Fe)>=0)break;te[L]=Fe,L=Ae}te[L]=me},Xf.prototype._down=function(L){for(var N=this,te=N.data,ce=N.compare,me=this.length>>1,Ae=te[L];L<me;){var Fe=(L<<1)+1,$e=te[Fe],ft=Fe+1;if(ft<this.length&&ce(te[ft],$e)<0&&(Fe=ft,$e=te[ft]),ce($e,Ae)>=0)break;te[L]=$e,L=Fe}te[L]=Ae};function v0(C,L){return C<L?-1:C>L?1:0}function p0(C,L,N){L===void 0&&(L=1),N===void 0&&(N=!1);for(var te=1/0,ce=1/0,me=-1/0,Ae=-1/0,Fe=C[0],$e=0;$e<Fe.length;$e++){var ft=Fe[$e];(!$e||ft.x<te)&&(te=ft.x),(!$e||ft.y<ce)&&(ce=ft.y),(!$e||ft.x>me)&&(me=ft.x),(!$e||ft.y>Ae)&&(Ae=ft.y)}var dt=me-te,Pt=Ae-ce,Jt=Math.min(dt,Pt),Yt=Jt/2,ur=new Xf([],d0);if(Jt===0)return new i(te,ce);for(var Dr=te;Dr<me;Dr+=Jt)for(var rn=ce;rn<Ae;rn+=Jt)ur.push(new Zf(Dr+Yt,rn+Yt,Yt,C));for(var Jr=y0(C),kn=ur.length;ur.length;){var mn=ur.pop();(mn.d>Jr.d||!Jr.d)&&(Jr=mn,N&&console.log("found best %d after %d probes",Math.round(1e4*mn.d)/1e4,kn)),!(mn.max-Jr.d<=L)&&(Yt=mn.h/2,ur.push(new Zf(mn.p.x-Yt,mn.p.y-Yt,Yt,C)),ur.push(new Zf(mn.p.x+Yt,mn.p.y-Yt,Yt,C)),ur.push(new Zf(mn.p.x-Yt,mn.p.y+Yt,Yt,C)),ur.push(new Zf(mn.p.x+Yt,mn.p.y+Yt,Yt,C)),kn+=4)}return N&&(console.log("num probes: "+kn),console.log("best distance: "+Jr.d)),Jr.p}function d0(C,L){return L.max-C.max}function Zf(C,L,N,te){this.p=new i(C,L),this.h=N,this.d=g0(this.p,te),this.max=this.d+this.h*Math.SQRT2}function g0(C,L){for(var N=!1,te=1/0,ce=0;ce<L.length;ce++)for(var me=L[ce],Ae=0,Fe=me.length,$e=Fe-1;Ae<Fe;$e=Ae++){var ft=me[Ae],dt=me[$e];ft.y>C.y!=dt.y>C.y&&C.x<(dt.x-ft.x)*(C.y-ft.y)/(dt.y-ft.y)+ft.x&&(N=!N),te=Math.min(te,Au(C,ft,dt))}return(N?1:-1)*Math.sqrt(te)}function y0(C){for(var L=0,N=0,te=0,ce=C[0],me=0,Ae=ce.length,Fe=Ae-1;me<Ae;Fe=me++){var $e=ce[me],ft=ce[Fe],dt=$e.x*ft.y-ft.x*$e.y;N+=($e.x+ft.x)*dt,te+=($e.y+ft.y)*dt,L+=dt*3}return new Zf(N/L,te/L,0,C)}var jf=7,wh=Number.POSITIVE_INFINITY;function Cv(C,L){function N(ce,me){var Ae=0,Fe=0;me<0&&(me=0);var $e=me/Math.sqrt(2);switch(ce){case"top-right":case"top-left":Fe=$e-jf;break;case"bottom-right":case"bottom-left":Fe=-$e+jf;break;case"bottom":Fe=-me+jf;break;case"top":Fe=me-jf;break}switch(ce){case"top-right":case"bottom-right":Ae=-$e;break;case"top-left":case"bottom-left":Ae=$e;break;case"left":Ae=me;break;case"right":Ae=-me;break}return[Ae,Fe]}function te(ce,me,Ae){var Fe=0,$e=0;switch(me=Math.abs(me),Ae=Math.abs(Ae),ce){case"top-right":case"top-left":case"top":$e=Ae-jf;break;case"bottom-right":case"bottom-left":case"bottom":$e=-Ae+jf;break}switch(ce){case"top-right":case"bottom-right":case"right":Fe=-me;break;case"top-left":case"bottom-left":case"left":Fe=me;break}return[Fe,$e]}return L[1]!==wh?te(C,L[0],L[1]):N(C,L[0])}function m0(C,L,N,te,ce,me,Ae){C.createArrays();var Fe=512*C.overscaling;C.tilePixelRatio=Va/Fe,C.compareText={},C.iconsNeedLinear=!1;var $e=C.layers[0].layout,ft=C.layers[0]._unevaluatedLayout._values,dt={};if(C.textSizeData.kind==="composite"){var Pt=C.textSizeData,Jt=Pt.minZoom,Yt=Pt.maxZoom;dt.compositeTextSizes=[ft["text-size"].possiblyEvaluate(new ci(Jt),Ae),ft["text-size"].possiblyEvaluate(new ci(Yt),Ae)]}if(C.iconSizeData.kind==="composite"){var ur=C.iconSizeData,Dr=ur.minZoom,rn=ur.maxZoom;dt.compositeIconSizes=[ft["icon-size"].possiblyEvaluate(new ci(Dr),Ae),ft["icon-size"].possiblyEvaluate(new ci(rn),Ae)]}dt.layoutTextSize=ft["text-size"].possiblyEvaluate(new ci(C.zoom+1),Ae),dt.layoutIconSize=ft["icon-size"].possiblyEvaluate(new ci(C.zoom+1),Ae),dt.textMaxSize=ft["text-size"].possiblyEvaluate(new ci(18));for(var Jr=$e.get("text-line-height")*fs,kn=$e.get("text-rotation-alignment")==="map"&&$e.get("symbol-placement")!=="point",mn=$e.get("text-keep-upright"),Mn=$e.get("text-size"),zn=function(){var ia=la[Yn],Ba=$e.get("text-font").evaluate(ia,{},Ae).join(","),_a=Mn.evaluate(ia,{},Ae),Sa=dt.layoutTextSize.evaluate(ia,{},Ae),ni=dt.layoutIconSize.evaluate(ia,{},Ae),Da={horizontal:{},vertical:void 0},za=ia.text,vi=[0,0];if(za){var ei=za.toString(),zi=$e.get("text-letter-spacing").evaluate(ia,{},Ae)*fs,Ki=ht(ei)?zi:0,Fi=$e.get("text-anchor").evaluate(ia,{},Ae),Oi=$e.get("text-variable-anchor");if(!Oi){var Pi=$e.get("text-radial-offset").evaluate(ia,{},Ae);Pi?vi=Cv(Fi,[Pi*fs,wh]):vi=$e.get("text-offset").evaluate(ia,{},Ae).map(function(rf){return rf*fs})}var to=kn?"center":$e.get("text-justify").evaluate(ia,{},Ae),fo=$e.get("symbol-placement"),Mo=fo==="point"?$e.get("text-max-width").evaluate(ia,{},Ae)*fs:0,Ro=function(){C.allowVerticalPlacement&&xt(ei)&&(Da.vertical=Hc(za,L,N,ce,Ba,Mo,Jr,Fi,"left",Ki,vi,Il.vertical,!0,fo,Sa,_a))};if(!kn&&Oi){for(var rs=to==="auto"?Oi.map(function(rf){return Th(rf)}):[to],Vo=!1,Cs=0;Cs<rs.length;Cs++){var Ls=rs[Cs];if(!Da.horizontal[Ls])if(Vo)Da.horizontal[Ls]=Da.horizontal[0];else{var ns=Hc(za,L,N,ce,Ba,Mo,Jr,"center",Ls,Ki,vi,Il.horizontal,!1,fo,Sa,_a);ns&&(Da.horizontal[Ls]=ns,Vo=ns.positionedLines.length===1)}}Ro()}else{to==="auto"&&(to=Th(Fi));var Us=Hc(za,L,N,ce,Ba,Mo,Jr,Fi,to,Ki,vi,Il.horizontal,!1,fo,Sa,_a);Us&&(Da.horizontal[to]=Us),Ro(),xt(ei)&&kn&&mn&&(Da.vertical=Hc(za,L,N,ce,Ba,Mo,Jr,Fi,to,Ki,vi,Il.vertical,!1,fo,Sa,_a))}}var Vs=void 0,Qo=!1;if(ia.icon&&ia.icon.name){var Hs=te[ia.icon.name];Hs&&(Vs=l0(ce[ia.icon.name],$e.get("icon-offset").evaluate(ia,{},Ae),$e.get("icon-anchor").evaluate(ia,{},Ae)),Qo=Hs.sdf,C.sdfIcons===void 0?C.sdfIcons=Hs.sdf:C.sdfIcons!==Hs.sdf&&F("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Hs.pixelRatio!==C.pixelRatio||$e.get("icon-rotate").constantOr(1)!==0)&&(C.iconsNeedLinear=!0))}var zl=Pv(Da.horizontal)||Da.vertical;C.iconsInText=zl?zl.iconsInText:!1,(zl||Vs)&&x0(C,ia,Da,Vs,te,dt,Sa,ni,vi,Qo,Ae)},Yn=0,la=C.features;Yn<la.length;Yn+=1)zn();me&&C.generateCollisionDebugBuffers()}function Th(C){switch(C){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function x0(C,L,N,te,ce,me,Ae,Fe,$e,ft,dt){var Pt=me.textMaxSize.evaluate(L,{});Pt===void 0&&(Pt=Ae);var Jt=C.layers[0].layout,Yt=Jt.get("icon-offset").evaluate(L,{},dt),ur=Pv(N.horizontal),Dr=24,rn=Ae/Dr,Jr=C.tilePixelRatio*rn,kn=C.tilePixelRatio*Pt/Dr,mn=C.tilePixelRatio*Fe,Mn=C.tilePixelRatio*Jt.get("symbol-spacing"),zn=Jt.get("text-padding")*C.tilePixelRatio,Yn=Jt.get("icon-padding")*C.tilePixelRatio,la=Jt.get("text-max-angle")/180*Math.PI,ia=Jt.get("text-rotation-alignment")==="map"&&Jt.get("symbol-placement")!=="point",Ba=Jt.get("icon-rotation-alignment")==="map"&&Jt.get("symbol-placement")!=="point",_a=Jt.get("symbol-placement"),Sa=Mn/2,ni=Jt.get("icon-text-fit"),Da;te&&ni!=="none"&&(C.allowVerticalPlacement&&N.vertical&&(Da=mv(te,N.vertical,ni,Jt.get("icon-text-fit-padding"),Yt,rn)),ur&&(te=mv(te,ur,ni,Jt.get("icon-text-fit-padding"),Yt,rn)));var za=function(qf,pu){pu.x<0||pu.x>=Va||pu.y<0||pu.y>=Va||b0(C,pu,qf,N,te,ce,Da,C.layers[0],C.collisionBoxArray,L.index,L.sourceLayerIndex,C.index,Jr,zn,ia,$e,mn,Yn,Ba,Yt,L,me,ft,dt,Ae)};if(_a==="line")for(var vi=0,ei=Sv(L.geometry,0,0,Va,Va);vi<ei.length;vi+=1)for(var zi=ei[vi],Ki=c0(zi,Mn,la,N.vertical||ur,te,Dr,kn,C.overscaling,Va),Fi=0,Oi=Ki;Fi<Oi.length;Fi+=1){var Pi=Oi[Fi],to=ur;(!to||!_0(C,to.text,Sa,Pi))&&za(zi,Pi)}else if(_a==="line-center")for(var fo=0,Mo=L.geometry;fo<Mo.length;fo+=1){var Ro=Mo[fo];if(Ro.length>1){var rs=f0(Ro,la,N.vertical||ur,te,Dr,kn);rs&&za(Ro,rs)}}else if(L.type==="Polygon")for(var Vo=0,Cs=hh(L.geometry,0);Vo<Cs.length;Vo+=1){var Ls=Cs[Vo],ns=p0(Ls,16);za(Ls[0],new Yf(ns.x,ns.y,0))}else if(L.type==="LineString")for(var Us=0,Vs=L.geometry;Us<Vs.length;Us+=1){var Qo=Vs[Us];za(Qo,new Yf(Qo[0].x,Qo[0].y,0))}else if(L.type==="Point")for(var Hs=0,zl=L.geometry;Hs<zl.length;Hs+=1)for(var rf=zl[Hs],df=0,gf=rf;df<gf.length;df+=1){var yf=gf[df];za([yf],new Yf(yf.x,yf.y,0))}}var bc=255,vf=bc*ku;function Lv(C,L,N,te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur){var Dr=h0(L,N,Fe,ce,me,Ae,te,C.allowVerticalPlacement),rn=C.textSizeData,Jr=null;rn.kind==="source"?(Jr=[ku*ce.layout.get("text-size").evaluate(Ae,{})],Jr[0]>vf&&F(C.layerIds[0]+': Value for "text-size" is >= '+bc+'. Reduce your "text-size".')):rn.kind==="composite"&&(Jr=[ku*Yt.compositeTextSizes[0].evaluate(Ae,{},ur),ku*Yt.compositeTextSizes[1].evaluate(Ae,{},ur)],(Jr[0]>vf||Jr[1]>vf)&&F(C.layerIds[0]+': Value for "text-size" is >= '+bc+'. Reduce your "text-size".')),C.addSymbols(C.text,Dr,Jr,Fe,me,Ae,ft,L,$e.lineStartIndex,$e.lineLength,Jt,ur);for(var kn=0,mn=dt;kn<mn.length;kn+=1){var Mn=mn[kn];Pt[Mn]=C.text.placedSymbolArray.length-1}return Dr.length*4}function Pv(C){for(var L in C)return C[L];return null}function b0(C,L,N,te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt,Yt,ur,Dr,rn,Jr,kn,mn,Mn,zn,Yn,la,ia){var Ba,_a=C.addToLineVertexArray(L,N),Sa,ni,Da,za,vi=0,ei=0,zi=0,Ki=0,Fi=-1,Oi=-1,Pi={},to=Re(""),fo=0,Mo=0;if(Fe._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Ba=Fe.layout.get("text-offset").evaluate(Mn,{},la).map(function(Tc){return Tc*fs}),fo=Ba[0],Mo=Ba[1]):(fo=Fe.layout.get("text-radial-offset").evaluate(Mn,{},la)*fs,Mo=wh),C.allowVerticalPlacement&&te.vertical){var Ro=Fe.layout.get("text-rotate").evaluate(Mn,{},la),rs=Ro+90,Vo=te.vertical;Da=new Xc($e,L,ft,dt,Pt,Vo,Jt,Yt,ur,rs),Ae&&(za=new Xc($e,L,ft,dt,Pt,Ae,rn,Jr,ur,rs))}if(ce){var Cs=Fe.layout.get("icon-rotate").evaluate(Mn,{}),Ls=Fe.layout.get("icon-text-fit")!=="none",ns=kv(ce,Cs,Yn,Ls),Us=Ae?kv(Ae,Cs,Yn,Ls):void 0;ni=new Xc($e,L,ft,dt,Pt,ce,rn,Jr,!1,Cs),vi=ns.length*4;var Vs=C.iconSizeData,Qo=null;Vs.kind==="source"?(Qo=[ku*Fe.layout.get("icon-size").evaluate(Mn,{})],Qo[0]>vf&&F(C.layerIds[0]+': Value for "icon-size" is >= '+bc+'. Reduce your "icon-size".')):Vs.kind==="composite"&&(Qo=[ku*zn.compositeIconSizes[0].evaluate(Mn,{},la),ku*zn.compositeIconSizes[1].evaluate(Mn,{},la)],(Qo[0]>vf||Qo[1]>vf)&&F(C.layerIds[0]+': Value for "icon-size" is >= '+bc+'. Reduce your "icon-size".')),C.addSymbols(C.icon,ns,Qo,mn,kn,Mn,!1,L,_a.lineStartIndex,_a.lineLength,-1,la),Fi=C.icon.placedSymbolArray.length-1,Us&&(ei=Us.length*4,C.addSymbols(C.icon,Us,Qo,mn,kn,Mn,Il.vertical,L,_a.lineStartIndex,_a.lineLength,-1,la),Oi=C.icon.placedSymbolArray.length-1)}for(var Hs in te.horizontal){var zl=te.horizontal[Hs];if(!Sa){to=Re(zl.text);var rf=Fe.layout.get("text-rotate").evaluate(Mn,{},la);Sa=new Xc($e,L,ft,dt,Pt,zl,Jt,Yt,ur,rf)}var df=zl.positionedLines.length===1;if(zi+=Lv(C,L,zl,me,Fe,ur,Mn,Dr,_a,te.vertical?Il.horizontal:Il.horizontalOnly,df?Object.keys(te.horizontal):[Hs],Pi,Fi,zn,la),df)break}te.vertical&&(Ki+=Lv(C,L,te.vertical,me,Fe,ur,Mn,Dr,_a,Il.vertical,["vertical"],Pi,Oi,zn,la));var gf=Sa?Sa.boxStartIndex:C.collisionBoxArray.length,yf=Sa?Sa.boxEndIndex:C.collisionBoxArray.length,qf=Da?Da.boxStartIndex:C.collisionBoxArray.length,pu=Da?Da.boxEndIndex:C.collisionBoxArray.length,Qc=ni?ni.boxStartIndex:C.collisionBoxArray.length,Ch=ni?ni.boxEndIndex:C.collisionBoxArray.length,$c=za?za.boxStartIndex:C.collisionBoxArray.length,Lh=za?za.boxEndIndex:C.collisionBoxArray.length,Kl=-1,ec=function(Tc,Zv){return Tc&&Tc.circleDiameter?Math.max(Tc.circleDiameter,Zv):Zv};Kl=ec(Sa,Kl),Kl=ec(Da,Kl),Kl=ec(ni,Kl),Kl=ec(za,Kl);var qc=Kl>-1?1:0;qc&&(Kl*=ia/fs),C.glyphOffsetArray.length>=ji.MAX_GLYPHS&&F("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Mn.sortKey!==void 0&&C.addToSortKeyRanges(C.symbolInstances.length,Mn.sortKey),C.symbolInstances.emplaceBack(L.x,L.y,Pi.right>=0?Pi.right:-1,Pi.center>=0?Pi.center:-1,Pi.left>=0?Pi.left:-1,Pi.vertical||-1,Fi,Oi,to,gf,yf,qf,pu,Qc,Ch,$c,Lh,ft,zi,Ki,vi,ei,qc,0,Jt,fo,Mo,Kl)}function _0(C,L,N,te){var ce=C.compareText;if(!(L in ce))ce[L]=[];else for(var me=ce[L],Ae=me.length-1;Ae>=0;Ae--)if(te.dist(me[Ae])<N)return!0;return ce[L].push(te),!1}var w0=Uf.VectorTileFeature.types,T0=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Zc(C,L,N,te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt){var Yt=Fe?Math.min(vf,Math.round(Fe[0])):0,ur=Fe?Math.min(vf,Math.round(Fe[1])):0;C.emplaceBack(L,N,Math.round(te*32),Math.round(ce*32),me,Ae,(Yt<<1)+($e?1:0),ur,ft*16,dt*16,Pt*256,Jt*256)}function Ah(C,L,N){C.emplaceBack(L.x,L.y,N),C.emplaceBack(L.x,L.y,N),C.emplaceBack(L.x,L.y,N),C.emplaceBack(L.x,L.y,N)}function A0(C){for(var L=0,N=C.sections;L<N.length;L+=1){var te=N[L];if(Ir(te.text))return!0}return!1}var Kf=function(L){this.layoutVertexArray=new Vu,this.indexArray=new Tu,this.programConfigurations=L,this.segments=new Y,this.dynamicLayoutVertexArray=new rc,this.opacityVertexArray=new nc,this.placedSymbolArray=new uf};Kf.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Kf.prototype.upload=function(L,N,te,ce){this.isEmpty()||(te&&(this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,gh.members),this.indexBuffer=L.createIndexBuffer(this.indexArray,N),this.dynamicLayoutVertexBuffer=L.createVertexBuffer(this.dynamicLayoutVertexArray,Md.members,!0),this.opacityVertexBuffer=L.createVertexBuffer(this.opacityVertexArray,T0,!0),this.opacityVertexBuffer.itemSize=1),(te||ce)&&this.programConfigurations.upload(L))},Kf.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Ea("SymbolBuffers",Kf);var _c=function(L,N,te){this.layoutVertexArray=new L,this.layoutAttributes=N,this.indexArray=new te,this.segments=new Y,this.collisionVertexArray=new el};_c.prototype.upload=function(L){this.layoutVertexBuffer=L.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=L.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=L.createVertexBuffer(this.collisionVertexArray,Sd.members,!0)},_c.prototype.destroy=function(){!this.layoutVertexBuffer||(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Ea("CollisionBuffers",_c);var ji=function(L){this.collisionBoxArray=L.collisionBoxArray,this.zoom=L.zoom,this.overscaling=L.overscaling,this.layers=L.layers,this.layerIds=this.layers.map(function($e){return $e.id}),this.index=L.index,this.pixelRatio=L.pixelRatio,this.sourceLayerIndex=L.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=zf([]),this.placementViewportMatrix=zf([]);var N=this.layers[0],te=N._unevaluatedLayout._values;this.textSizeData=_h(this.zoom,te["text-size"]),this.iconSizeData=_h(this.zoom,te["icon-size"]);var ce=this.layers[0].layout,me=ce.get("symbol-sort-key"),Ae=ce.get("symbol-z-order");this.sortFeaturesByKey=Ae!=="viewport-y"&&me.constantOr(1)!==void 0;var Fe=Ae==="viewport-y"||Ae==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=Fe&&(ce.get("text-allow-overlap")||ce.get("icon-allow-overlap")||ce.get("text-ignore-placement")||ce.get("icon-ignore-placement")),ce.get("symbol-placement")==="point"&&(this.writingModes=ce.get("text-writing-mode").map(function($e){return Il[$e]})),this.stateDependentLayerIds=this.layers.filter(function($e){return $e.isStateDependent()}).map(function($e){return $e.id}),this.sourceID=L.sourceID};ji.prototype.createArrays=function(){this.text=new Kf(new ai(gh.members,this.layers,this.zoom,function(L){return/^text/.test(L)})),this.icon=new Kf(new ai(gh.members,this.layers,this.zoom,function(L){return/^icon/.test(L)})),this.glyphOffsetArray=new Zl,this.lineVertexArray=new Cc,this.symbolInstances=new Ec},ji.prototype.calculateGlyphDependencies=function(L,N,te,ce,me){for(var Ae=0;Ae<L.length;Ae++)if(N[L.charCodeAt(Ae)]=!0,(te||ce)&&me){var Fe=gc[L.charAt(Ae)];Fe&&(N[Fe.charCodeAt(0)]=!0)}},ji.prototype.populate=function(L,N,te){var ce=this.layers[0],me=ce.layout,Ae=me.get("text-font"),Fe=me.get("text-field"),$e=me.get("icon-image"),ft=(Fe.value.kind!=="constant"||Fe.value.value instanceof no&&!Fe.value.value.isEmpty()||Fe.value.value.toString().length>0)&&(Ae.value.kind!=="constant"||Ae.value.value.length>0),dt=$e.value.kind!=="constant"||!!$e.value.value||Object.keys($e.parameters).length>0,Pt=me.get("symbol-sort-key");if(this.features=[],!(!ft&&!dt)){for(var Jt=N.iconDependencies,Yt=N.glyphDependencies,ur=N.availableImages,Dr=new ci(this.zoom),rn=0,Jr=L;rn<Jr.length;rn+=1){var kn=Jr[rn],mn=kn.feature,Mn=kn.id,zn=kn.index,Yn=kn.sourceLayerIndex,la=ce._featureFilter.needGeometry,ia={type:mn.type,id:Mn,properties:mn.properties,geometry:la?Wi(mn):[]};if(!!ce._featureFilter.filter(Dr,ia,te)){la||(ia.geometry=Wi(mn));var Ba=void 0;if(ft){var _a=ce.getValueAndResolveTokens("text-field",ia,te,ur),Sa=no.factory(_a);A0(Sa)&&(this.hasRTLText=!0),(!this.hasRTLText||Ca()==="unavailable"||this.hasRTLText&&Xa.isParsed())&&(Ba=Cd(Sa,ce,ia))}var ni=void 0;if(dt){var Da=ce.getValueAndResolveTokens("icon-image",ia,te,ur);Da instanceof ko?ni=Da:ni=ko.fromString(Da)}if(!(!Ba&&!ni)){var za=this.sortFeaturesByKey?Pt.evaluate(ia,{},te):void 0,vi={id:Mn,text:Ba,icon:ni,index:zn,sourceLayerIndex:Yn,geometry:Wi(mn),properties:mn.properties,type:w0[mn.type],sortKey:za};if(this.features.push(vi),ni&&(Jt[ni.name]=!0),Ba){var ei=Ae.evaluate(ia,{},te).join(","),zi=me.get("text-rotation-alignment")==="map"&&me.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Il.vertical)>=0;for(var Ki=0,Fi=Ba.sections;Ki<Fi.length;Ki+=1){var Oi=Fi[Ki];if(Oi.image)Jt[Oi.image.name]=!0;else{var Pi=xt(Ba.toString()),to=Oi.fontStack||ei,fo=Yt[to]=Yt[to]||{};this.calculateGlyphDependencies(Oi.text,fo,zi,this.allowVerticalPlacement,Pi)}}}}}}me.get("symbol-placement")==="line"&&(this.features=Ld(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Mo,Ro){return Mo.sortKey-Ro.sortKey})}},ji.prototype.update=function(L,N,te){!this.stateDependentLayers.length||(this.text.programConfigurations.updatePaintArrays(L,N,this.layers,te),this.icon.programConfigurations.updatePaintArrays(L,N,this.layers,te))},ji.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},ji.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ji.prototype.upload=function(L){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(L),this.iconCollisionBox.upload(L)),this.text.upload(L,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(L,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ji.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ji.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ji.prototype.addToLineVertexArray=function(L,N){var te=this.lineVertexArray.length;if(L.segment!==void 0){for(var ce=L.dist(N[L.segment+1]),me=L.dist(N[L.segment]),Ae={},Fe=L.segment+1;Fe<N.length;Fe++)Ae[Fe]={x:N[Fe].x,y:N[Fe].y,tileUnitDistanceFromAnchor:ce},Fe<N.length-1&&(ce+=N[Fe+1].dist(N[Fe]));for(var $e=L.segment||0;$e>=0;$e--)Ae[$e]={x:N[$e].x,y:N[$e].y,tileUnitDistanceFromAnchor:me},$e>0&&(me+=N[$e-1].dist(N[$e]));for(var ft=0;ft<N.length;ft++){var dt=Ae[ft];this.lineVertexArray.emplaceBack(dt.x,dt.y,dt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:te,lineLength:this.lineVertexArray.length-te}},ji.prototype.addSymbols=function(L,N,te,ce,me,Ae,Fe,$e,ft,dt,Pt,Jt){for(var Yt=L.indexArray,ur=L.layoutVertexArray,Dr=L.segments.prepareSegment(4*N.length,ur,Yt,Ae.sortKey),rn=this.glyphOffsetArray.length,Jr=Dr.vertexLength,kn=this.allowVerticalPlacement&&Fe===Il.vertical?Math.PI/2:0,mn=Ae.text&&Ae.text.sections,Mn=0;Mn<N.length;Mn++){var zn=N[Mn],Yn=zn.tl,la=zn.tr,ia=zn.bl,Ba=zn.br,_a=zn.tex,Sa=zn.pixelOffsetTL,ni=zn.pixelOffsetBR,Da=zn.minFontScaleX,za=zn.minFontScaleY,vi=zn.glyphOffset,ei=zn.isSDF,zi=zn.sectionIndex,Ki=Dr.vertexLength,Fi=vi[1];Zc(ur,$e.x,$e.y,Yn.x,Fi+Yn.y,_a.x,_a.y,te,ei,Sa.x,Sa.y,Da,za),Zc(ur,$e.x,$e.y,la.x,Fi+la.y,_a.x+_a.w,_a.y,te,ei,ni.x,Sa.y,Da,za),Zc(ur,$e.x,$e.y,ia.x,Fi+ia.y,_a.x,_a.y+_a.h,te,ei,Sa.x,ni.y,Da,za),Zc(ur,$e.x,$e.y,Ba.x,Fi+Ba.y,_a.x+_a.w,_a.y+_a.h,te,ei,ni.x,ni.y,Da,za),Ah(L.dynamicLayoutVertexArray,$e,kn),Yt.emplaceBack(Ki,Ki+1,Ki+2),Yt.emplaceBack(Ki+1,Ki+2,Ki+3),Dr.vertexLength+=4,Dr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(vi[0]),(Mn===N.length-1||zi!==N[Mn+1].sectionIndex)&&L.programConfigurations.populatePaintArrays(ur.length,Ae,Ae.index,{},Jt,mn&&mn[zi])}L.placedSymbolArray.emplaceBack($e.x,$e.y,rn,this.glyphOffsetArray.length-rn,Jr,ft,dt,$e.segment,te?te[0]:0,te?te[1]:0,ce[0],ce[1],Fe,0,!1,0,Pt)},ji.prototype._addCollisionDebugVertex=function(L,N,te,ce,me,Ae){return N.emplaceBack(0,0),L.emplaceBack(te.x,te.y,ce,me,Math.round(Ae.x),Math.round(Ae.y))},ji.prototype.addCollisionDebugVertices=function(L,N,te,ce,me,Ae,Fe){var $e=me.segments.prepareSegment(4,me.layoutVertexArray,me.indexArray),ft=$e.vertexLength,dt=me.layoutVertexArray,Pt=me.collisionVertexArray,Jt=Fe.anchorX,Yt=Fe.anchorY;this._addCollisionDebugVertex(dt,Pt,Ae,Jt,Yt,new i(L,N)),this._addCollisionDebugVertex(dt,Pt,Ae,Jt,Yt,new i(te,N)),this._addCollisionDebugVertex(dt,Pt,Ae,Jt,Yt,new i(te,ce)),this._addCollisionDebugVertex(dt,Pt,Ae,Jt,Yt,new i(L,ce)),$e.vertexLength+=4;var ur=me.indexArray;ur.emplaceBack(ft,ft+1),ur.emplaceBack(ft+1,ft+2),ur.emplaceBack(ft+2,ft+3),ur.emplaceBack(ft+3,ft),$e.primitiveLength+=4},ji.prototype.addDebugCollisionBoxes=function(L,N,te,ce){for(var me=L;me<N;me++){var Ae=this.collisionBoxArray.get(me),Fe=Ae.x1,$e=Ae.y1,ft=Ae.x2,dt=Ae.y2;this.addCollisionDebugVertices(Fe,$e,ft,dt,ce?this.textCollisionBox:this.iconCollisionBox,Ae.anchorPoint,te)}},ji.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new _c(Lf,iv.members,bf),this.iconCollisionBox=new _c(Lf,iv.members,bf);for(var L=0;L<this.symbolInstances.length;L++){var N=this.symbolInstances.get(L);this.addDebugCollisionBoxes(N.textBoxStartIndex,N.textBoxEndIndex,N,!0),this.addDebugCollisionBoxes(N.verticalTextBoxStartIndex,N.verticalTextBoxEndIndex,N,!0),this.addDebugCollisionBoxes(N.iconBoxStartIndex,N.iconBoxEndIndex,N,!1),this.addDebugCollisionBoxes(N.verticalIconBoxStartIndex,N.verticalIconBoxEndIndex,N,!1)}},ji.prototype._deserializeCollisionBoxesForSymbol=function(L,N,te,ce,me,Ae,Fe,$e,ft){for(var dt={},Pt=N;Pt<te;Pt++){var Jt=L.get(Pt);dt.textBox={x1:Jt.x1,y1:Jt.y1,x2:Jt.x2,y2:Jt.y2,anchorPointX:Jt.anchorPointX,anchorPointY:Jt.anchorPointY},dt.textFeatureIndex=Jt.featureIndex;break}for(var Yt=ce;Yt<me;Yt++){var ur=L.get(Yt);dt.verticalTextBox={x1:ur.x1,y1:ur.y1,x2:ur.x2,y2:ur.y2,anchorPointX:ur.anchorPointX,anchorPointY:ur.anchorPointY},dt.verticalTextFeatureIndex=ur.featureIndex;break}for(var Dr=Ae;Dr<Fe;Dr++){var rn=L.get(Dr);dt.iconBox={x1:rn.x1,y1:rn.y1,x2:rn.x2,y2:rn.y2,anchorPointX:rn.anchorPointX,anchorPointY:rn.anchorPointY},dt.iconFeatureIndex=rn.featureIndex;break}for(var Jr=$e;Jr<ft;Jr++){var kn=L.get(Jr);dt.verticalIconBox={x1:kn.x1,y1:kn.y1,x2:kn.x2,y2:kn.y2,anchorPointX:kn.anchorPointX,anchorPointY:kn.anchorPointY},dt.verticalIconFeatureIndex=kn.featureIndex;break}return dt},ji.prototype.deserializeCollisionBoxes=function(L){this.collisionArrays=[];for(var N=0;N<this.symbolInstances.length;N++){var te=this.symbolInstances.get(N);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(L,te.textBoxStartIndex,te.textBoxEndIndex,te.verticalTextBoxStartIndex,te.verticalTextBoxEndIndex,te.iconBoxStartIndex,te.iconBoxEndIndex,te.verticalIconBoxStartIndex,te.verticalIconBoxEndIndex))}},ji.prototype.hasTextData=function(){return this.text.segments.get().length>0},ji.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ji.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ji.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ji.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ji.prototype.addIndicesForPlacedSymbol=function(L,N){for(var te=L.placedSymbolArray.get(N),ce=te.vertexStartIndex+te.numGlyphs*4,me=te.vertexStartIndex;me<ce;me+=4)L.indexArray.emplaceBack(me,me+1,me+2),L.indexArray.emplaceBack(me+1,me+2,me+3)},ji.prototype.getSortedSymbolIndexes=function(L){if(this.sortedAngle===L&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var N=Math.sin(L),te=Math.cos(L),ce=[],me=[],Ae=[],Fe=0;Fe<this.symbolInstances.length;++Fe){Ae.push(Fe);var $e=this.symbolInstances.get(Fe);ce.push(Math.round(N*$e.anchorX+te*$e.anchorY)|0),me.push($e.featureIndex)}return Ae.sort(function(ft,dt){return ce[ft]-ce[dt]||me[dt]-me[ft]}),Ae},ji.prototype.addToSortKeyRanges=function(L,N){var te=this.sortKeyRanges[this.sortKeyRanges.length-1];te&&te.sortKey===N?te.symbolInstanceEnd=L+1:this.sortKeyRanges.push({sortKey:N,symbolInstanceStart:L,symbolInstanceEnd:L+1})},ji.prototype.sortFeatures=function(L){var N=this;if(!!this.sortFeaturesByY&&this.sortedAngle!==L&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(L),this.sortedAngle=L,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var te=0,ce=this.symbolInstanceIndexes;te<ce.length;te+=1){var me=ce[te],Ae=this.symbolInstances.get(me);this.featureSortOrder.push(Ae.featureIndex),[Ae.rightJustifiedTextSymbolIndex,Ae.centerJustifiedTextSymbolIndex,Ae.leftJustifiedTextSymbolIndex].forEach(function(Fe,$e,ft){Fe>=0&&ft.indexOf(Fe)===$e&&N.addIndicesForPlacedSymbol(N.text,Fe)}),Ae.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,Ae.verticalPlacedTextSymbolIndex),Ae.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Ae.placedIconSymbolIndex),Ae.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,Ae.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Ea("SymbolBucket",ji,{omit:["layers","collisionBoxArray","features","compareText"]}),ji.MAX_GLYPHS=65535,ji.addDynamicAttributes=Ah;function M0(C,L){return L.replace(/{([^{}]+)}/g,function(N,te){return te in C?String(C[te]):""})}var S0=new Yi({"symbol-placement":new Ma(Ft.layout_symbol["symbol-placement"]),"symbol-spacing":new Ma(Ft.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ma(Ft.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ia(Ft.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ma(Ft.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ma(Ft.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ma(Ft.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ma(Ft.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ma(Ft.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ia(Ft.layout_symbol["icon-size"]),"icon-text-fit":new Ma(Ft.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ma(Ft.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ia(Ft.layout_symbol["icon-image"]),"icon-rotate":new Ia(Ft.layout_symbol["icon-rotate"]),"icon-padding":new Ma(Ft.layout_symbol["icon-padding"]),"icon-keep-upright":new Ma(Ft.layout_symbol["icon-keep-upright"]),"icon-offset":new Ia(Ft.layout_symbol["icon-offset"]),"icon-anchor":new Ia(Ft.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ma(Ft.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ma(Ft.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ma(Ft.layout_symbol["text-rotation-alignment"]),"text-field":new Ia(Ft.layout_symbol["text-field"]),"text-font":new Ia(Ft.layout_symbol["text-font"]),"text-size":new Ia(Ft.layout_symbol["text-size"]),"text-max-width":new Ia(Ft.layout_symbol["text-max-width"]),"text-line-height":new Ma(Ft.layout_symbol["text-line-height"]),"text-letter-spacing":new Ia(Ft.layout_symbol["text-letter-spacing"]),"text-justify":new Ia(Ft.layout_symbol["text-justify"]),"text-radial-offset":new Ia(Ft.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ma(Ft.layout_symbol["text-variable-anchor"]),"text-anchor":new Ia(Ft.layout_symbol["text-anchor"]),"text-max-angle":new Ma(Ft.layout_symbol["text-max-angle"]),"text-writing-mode":new Ma(Ft.layout_symbol["text-writing-mode"]),"text-rotate":new Ia(Ft.layout_symbol["text-rotate"]),"text-padding":new Ma(Ft.layout_symbol["text-padding"]),"text-keep-upright":new Ma(Ft.layout_symbol["text-keep-upright"]),"text-transform":new Ia(Ft.layout_symbol["text-transform"]),"text-offset":new Ia(Ft.layout_symbol["text-offset"]),"text-allow-overlap":new Ma(Ft.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ma(Ft.layout_symbol["text-ignore-placement"]),"text-optional":new Ma(Ft.layout_symbol["text-optional"])}),k0=new Yi({"icon-opacity":new Ia(Ft.paint_symbol["icon-opacity"]),"icon-color":new Ia(Ft.paint_symbol["icon-color"]),"icon-halo-color":new Ia(Ft.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ia(Ft.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ia(Ft.paint_symbol["icon-halo-blur"]),"icon-translate":new Ma(Ft.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ma(Ft.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ia(Ft.paint_symbol["text-opacity"]),"text-color":new Ia(Ft.paint_symbol["text-color"],{runtimeType:Un,getOverride:function(C){return C.textColor},hasOverride:function(C){return!!C.textColor}}),"text-halo-color":new Ia(Ft.paint_symbol["text-halo-color"]),"text-halo-width":new Ia(Ft.paint_symbol["text-halo-width"]),"text-halo-blur":new Ia(Ft.paint_symbol["text-halo-blur"]),"text-translate":new Ma(Ft.paint_symbol["text-translate"]),"text-translate-anchor":new Ma(Ft.paint_symbol["text-translate-anchor"])}),Mh={paint:k0,layout:S0},Jf=function(L){this.type=L.property.overrides?L.property.overrides.runtimeType:dr,this.defaultValue=L};Jf.prototype.evaluate=function(L){if(L.formattedSection){var N=this.defaultValue.property.overrides;if(N&&N.hasOverride(L.formattedSection))return N.getOverride(L.formattedSection)}return L.feature&&L.featureState?this.defaultValue.evaluate(L.feature,L.featureState):this.defaultValue.property.specification.default},Jf.prototype.eachChild=function(L){if(!this.defaultValue.isConstant()){var N=this.defaultValue.value;L(N._styleExpression.expression)}},Jf.prototype.outputDefined=function(){return!1},Jf.prototype.serialize=function(){return null},Ea("FormatSectionOverride",Jf,{omit:["defaultValue"]});var E0=function(C){function L(N){C.call(this,N,Mh)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.recalculate=function(te,ce){if(C.prototype.recalculate.call(this,te,ce),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var me=this.layout.get("text-writing-mode");if(me){for(var Ae=[],Fe=0,$e=me;Fe<$e.length;Fe+=1){var ft=$e[Fe];Ae.indexOf(ft)<0&&Ae.push(ft)}this.layout._values["text-writing-mode"]=Ae}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},L.prototype.getValueAndResolveTokens=function(te,ce,me,Ae){var Fe=this.layout.get(te).evaluate(ce,{},me,Ae),$e=this._unevaluatedLayout._values[te];return!$e.isDataDriven()&&!Is($e.value)&&Fe?M0(ce.properties,Fe):Fe},L.prototype.createBucket=function(te){return new ji(te)},L.prototype.queryRadius=function(){return 0},L.prototype.queryIntersectsFeature=function(){return!1},L.prototype._setPaintOverrides=function(){for(var te=0,ce=Mh.paint.overridableProperties;te<ce.length;te+=1){var me=ce[te];if(!!L.hasPaintOverride(this.layout,me)){var Ae=this.paint.get(me),Fe=new Jf(Ae),$e=new ys(Fe,Ae.property.specification),ft=null;Ae.value.kind==="constant"||Ae.value.kind==="source"?ft=new pl("source",$e):ft=new ms("composite",$e,Ae.value.zoomStops,Ae.value._interpolationType),this.paint._values[me]=new Hi(Ae.property,ft,Ae.parameters)}}},L.prototype._handleOverridablePaintPropertyUpdate=function(te,ce,me){return!this.layout||ce.isDataDriven()||me.isDataDriven()?!1:L.hasPaintOverride(this.layout,te)},L.hasPaintOverride=function(te,ce){var me=te.get("text-field"),Ae=Mh.paint.properties[ce],Fe=!1,$e=function(Pt){for(var Jt=0,Yt=Pt;Jt<Yt.length;Jt+=1){var ur=Yt[Jt];if(Ae.overrides&&Ae.overrides.hasOverride(ur)){Fe=!0;return}}};if(me.value.kind==="constant"&&me.value.value instanceof no)$e(me.value.value.sections);else if(me.value.kind==="source"){var ft=function(Pt){if(!Fe)if(Pt instanceof io&&ao(Pt.value)===ga){var Jt=Pt.value;$e(Jt.sections)}else Pt instanceof $o?$e(Pt.sections):Pt.eachChild(ft)},dt=me.value;dt._styleExpression&&ft(dt._styleExpression.expression)}return Fe},L}(Pl),C0=new Yi({"background-color":new Ma(Ft.paint_background["background-color"]),"background-pattern":new bo(Ft.paint_background["background-pattern"]),"background-opacity":new Ma(Ft.paint_background["background-opacity"])}),L0={paint:C0},P0=function(C){function L(N){C.call(this,N,L0)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L}(Pl),D0=new Yi({"raster-opacity":new Ma(Ft.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ma(Ft.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ma(Ft.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ma(Ft.paint_raster["raster-brightness-max"]),"raster-saturation":new Ma(Ft.paint_raster["raster-saturation"]),"raster-contrast":new Ma(Ft.paint_raster["raster-contrast"]),"raster-resampling":new Ma(Ft.paint_raster["raster-resampling"]),"raster-fade-duration":new Ma(Ft.paint_raster["raster-fade-duration"])}),R0={paint:D0},I0=function(C){function L(N){C.call(this,N,R0)}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L}(Pl);function z0(C){var L=[],N=C.id;return N===void 0&&L.push({message:"layers."+N+': missing required property "id"'}),C.render===void 0&&L.push({message:"layers."+N+': missing required method "render"'}),C.renderingMode&&C.renderingMode!=="2d"&&C.renderingMode!=="3d"&&L.push({message:"layers."+N+': property "renderingMode" must be either "2d" or "3d"'}),L}var F0=function(C){function L(N){C.call(this,N,{}),this.implementation=N}return C&&(L.__proto__=C),L.prototype=Object.create(C&&C.prototype),L.prototype.constructor=L,L.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},L.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},L.prototype.recalculate=function(){},L.prototype.updateTransitions=function(){},L.prototype.hasTransition=function(){},L.prototype.serialize=function(){},L.prototype.onAdd=function(te){this.implementation.onAdd&&this.implementation.onAdd(te,te.painter.context.gl)},L.prototype.onRemove=function(te){this.implementation.onRemove&&this.implementation.onRemove(te,te.painter.context.gl)},L}(Pl),O0={circle:hp,heatmap:gp,hillshade:xp,fill:Yp,"fill-extrusion":fd,line:Td,symbol:E0,background:P0,raster:I0};function B0(C){return C.type==="custom"?new F0(C):new O0[C.type](C)}var Dv=self.HTMLImageElement,Rv=self.HTMLCanvasElement,Iv=self.HTMLVideoElement,zv=self.ImageData,jc=self.ImageBitmap,Mf=function(L,N,te,ce){this.context=L,this.format=te,this.texture=L.gl.createTexture(),this.update(N,ce)};Mf.prototype.update=function(L,N,te){var ce=L.width,me=L.height,Ae=(!this.size||this.size[0]!==ce||this.size[1]!==me)&&!te,Fe=this,$e=Fe.context,ft=$e.gl;if(this.useMipmap=Boolean(N&&N.useMipmap),ft.bindTexture(ft.TEXTURE_2D,this.texture),$e.pixelStoreUnpackFlipY.set(!1),$e.pixelStoreUnpack.set(1),$e.pixelStoreUnpackPremultiplyAlpha.set(this.format===ft.RGBA&&(!N||N.premultiply!==!1)),Ae)this.size=[ce,me],L instanceof Dv||L instanceof Rv||L instanceof Iv||L instanceof zv||jc&&L instanceof jc?ft.texImage2D(ft.TEXTURE_2D,0,this.format,this.format,ft.UNSIGNED_BYTE,L):ft.texImage2D(ft.TEXTURE_2D,0,this.format,ce,me,0,this.format,ft.UNSIGNED_BYTE,L.data);else{var dt=te||{x:0,y:0},Pt=dt.x,Jt=dt.y;L instanceof Dv||L instanceof Rv||L instanceof Iv||L instanceof zv||jc&&L instanceof jc?ft.texSubImage2D(ft.TEXTURE_2D,0,Pt,Jt,ft.RGBA,ft.UNSIGNED_BYTE,L):ft.texSubImage2D(ft.TEXTURE_2D,0,Pt,Jt,ce,me,ft.RGBA,ft.UNSIGNED_BYTE,L.data)}this.useMipmap&&this.isSizePowerOfTwo()&&ft.generateMipmap(ft.TEXTURE_2D)},Mf.prototype.bind=function(L,N,te){var ce=this,me=ce.context,Ae=me.gl;Ae.bindTexture(Ae.TEXTURE_2D,this.texture),te===Ae.LINEAR_MIPMAP_NEAREST&&!this.isSizePowerOfTwo()&&(te=Ae.LINEAR),L!==this.filter&&(Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_MAG_FILTER,L),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_MIN_FILTER,te||L),this.filter=L),N!==this.wrap&&(Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_WRAP_S,N),Ae.texParameteri(Ae.TEXTURE_2D,Ae.TEXTURE_WRAP_T,N),this.wrap=N)},Mf.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1===0},Mf.prototype.destroy=function(){var L=this.context,N=L.gl;N.deleteTexture(this.texture),this.texture=null};var Sh=function(L){var N=this;this._callback=L,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){N._triggered=!1,N._callback()})};Sh.prototype.trigger=function(){var L=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){L._triggered=!1,L._callback()},0))},Sh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Qf=function(L,N,te){this.target=L,this.parent=N,this.mapId=te,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},h(["receive","process"],this),this.invoker=new Sh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=X()?L:self};Qf.prototype.send=function(L,N,te,ce,me){var Ae=this;me===void 0&&(me=!1);var Fe=Math.round(Math.random()*1e18).toString(36).substring(0,10);te&&(this.callbacks[Fe]=te);var $e=q(this.globalScope)?void 0:[];return this.target.postMessage({id:Fe,type:L,hasCallback:!!te,targetMapId:ce,mustQueue:me,sourceMapId:this.mapId,data:Ce(N,$e)},$e),{cancel:function(){te&&delete Ae.callbacks[Fe],Ae.target.postMessage({id:Fe,type:"<cancel>",targetMapId:ce,sourceMapId:Ae.mapId})}}},Qf.prototype.receive=function(L){var N=L.data,te=N.id;if(!!te&&!(N.targetMapId&&this.mapId!==N.targetMapId))if(N.type==="<cancel>"){delete this.tasks[te];var ce=this.cancelCallbacks[te];delete this.cancelCallbacks[te],ce&&ce()}else X()||N.mustQueue?(this.tasks[te]=N,this.taskQueue.push(te),this.invoker.trigger()):this.processTask(te,N)},Qf.prototype.process=function(){if(!!this.taskQueue.length){var L=this.taskQueue.shift(),N=this.tasks[L];delete this.tasks[L],this.taskQueue.length&&this.invoker.trigger(),N&&this.processTask(L,N)}},Qf.prototype.processTask=function(L,N){var te=this;if(N.type==="<response>"){var ce=this.callbacks[L];delete this.callbacks[L],ce&&(N.error?ce(Be(N.error)):ce(null,Be(N.data)))}else{var me=!1,Ae=q(this.globalScope)?void 0:[],Fe=N.hasCallback?function(Jt,Yt){me=!0,delete te.cancelCallbacks[L],te.target.postMessage({id:L,type:"<response>",sourceMapId:te.mapId,error:Jt?Ce(Jt):null,data:Ce(Yt,Ae)},Ae)}:function(Jt){me=!0},$e=null,ft=Be(N.data);if(this.parent[N.type])$e=this.parent[N.type](N.sourceMapId,ft,Fe);else if(this.parent.getWorkerSource){var dt=N.type.split("."),Pt=this.parent.getWorkerSource(N.sourceMapId,dt[0],ft.source);$e=Pt[dt[1]](ft,Fe)}else Fe(new Error("Could not find function "+N.type));!me&&$e&&$e.cancel&&(this.cancelCallbacks[L]=$e.cancel)}},Qf.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};function N0(C,L,N){L=Math.pow(2,N)-L-1;var te=Fv(C*256,L*256,N),ce=Fv((C+1)*256,(L+1)*256,N);return te[0]+","+te[1]+","+ce[0]+","+ce[1]}function Fv(C,L,N){var te=2*Math.PI*6378137/256/Math.pow(2,N),ce=C*te-2*Math.PI*6378137/2,me=L*te-2*Math.PI*6378137/2;return[ce,me]}var No=function(L,N){L&&(N?this.setSouthWest(L).setNorthEast(N):L.length===4?this.setSouthWest([L[0],L[1]]).setNorthEast([L[2],L[3]]):this.setSouthWest(L[0]).setNorthEast(L[1]))};No.prototype.setNorthEast=function(L){return this._ne=L instanceof mo?new mo(L.lng,L.lat):mo.convert(L),this},No.prototype.setSouthWest=function(L){return this._sw=L instanceof mo?new mo(L.lng,L.lat):mo.convert(L),this},No.prototype.extend=function(L){var N=this._sw,te=this._ne,ce,me;if(L instanceof mo)ce=L,me=L;else if(L instanceof No){if(ce=L._sw,me=L._ne,!ce||!me)return this}else{if(Array.isArray(L))if(L.length===4||L.every(Array.isArray)){var Ae=L;return this.extend(No.convert(Ae))}else{var Fe=L;return this.extend(mo.convert(Fe))}return this}return!N&&!te?(this._sw=new mo(ce.lng,ce.lat),this._ne=new mo(me.lng,me.lat)):(N.lng=Math.min(ce.lng,N.lng),N.lat=Math.min(ce.lat,N.lat),te.lng=Math.max(me.lng,te.lng),te.lat=Math.max(me.lat,te.lat)),this},No.prototype.getCenter=function(){return new mo((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},No.prototype.getSouthWest=function(){return this._sw},No.prototype.getNorthEast=function(){return this._ne},No.prototype.getNorthWest=function(){return new mo(this.getWest(),this.getNorth())},No.prototype.getSouthEast=function(){return new mo(this.getEast(),this.getSouth())},No.prototype.getWest=function(){return this._sw.lng},No.prototype.getSouth=function(){return this._sw.lat},No.prototype.getEast=function(){return this._ne.lng},No.prototype.getNorth=function(){return this._ne.lat},No.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},No.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},No.prototype.isEmpty=function(){return!(this._sw&&this._ne)},No.prototype.contains=function(L){var N=mo.convert(L),te=N.lng,ce=N.lat,me=this._sw.lat<=ce&&ce<=this._ne.lat,Ae=this._sw.lng<=te&&te<=this._ne.lng;return this._sw.lng>this._ne.lng&&(Ae=this._sw.lng>=te&&te>=this._ne.lng),me&&Ae},No.convert=function(L){return!L||L instanceof No?L:new No(L)};var Ov=63710088e-1,mo=function(L,N){if(isNaN(L)||isNaN(N))throw new Error("Invalid LngLat object: ("+L+", "+N+")");if(this.lng=+L,this.lat=+N,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};mo.prototype.wrap=function(){return new mo(M(this.lng,-180,180),this.lat)},mo.prototype.toArray=function(){return[this.lng,this.lat]},mo.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},mo.prototype.distanceTo=function(L){var N=Math.PI/180,te=this.lat*N,ce=L.lat*N,me=Math.sin(te)*Math.sin(ce)+Math.cos(te)*Math.cos(ce)*Math.cos((L.lng-this.lng)*N),Ae=Ov*Math.acos(Math.min(me,1));return Ae},mo.prototype.toBounds=function(L){L===void 0&&(L=0);var N=40075017,te=360*L/N,ce=te/Math.cos(Math.PI/180*this.lat);return new No(new mo(this.lng-ce,this.lat-te),new mo(this.lng+ce,this.lat+te))},mo.convert=function(L){if(L instanceof mo)return L;if(Array.isArray(L)&&(L.length===2||L.length===3))return new mo(Number(L[0]),Number(L[1]));if(!Array.isArray(L)&&typeof L=="object"&&L!==null)return new mo(Number("lng"in L?L.lng:L.lon),Number(L.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var Bv=2*Math.PI*Ov;function Nv(C){return Bv*Math.cos(C*Math.PI/180)}function Uv(C){return(180+C)/360}function Vv(C){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+C*Math.PI/360)))/360}function Hv(C,L){return C/Nv(L)}function U0(C){return C*360-180}function kh(C){var L=180-C*360;return 360/Math.PI*Math.atan(Math.exp(L*Math.PI/180))-90}function V0(C,L){return C*Nv(kh(L))}function H0(C){return 1/Math.cos(C*Math.PI/180)}var Sf=function(L,N,te){te===void 0&&(te=0),this.x=+L,this.y=+N,this.z=+te};Sf.fromLngLat=function(L,N){N===void 0&&(N=0);var te=mo.convert(L);return new Sf(Uv(te.lng),Vv(te.lat),Hv(N,te.lat))},Sf.prototype.toLngLat=function(){return new mo(U0(this.x),kh(this.y))},Sf.prototype.toAltitude=function(){return V0(this.z,this.y)},Sf.prototype.meterInMercatorCoordinateUnits=function(){return 1/Bv*H0(kh(this.y))};var kf=function(L,N,te){this.z=L,this.x=N,this.y=te,this.key=wc(0,L,L,N,te)};kf.prototype.equals=function(L){return this.z===L.z&&this.x===L.x&&this.y===L.y},kf.prototype.url=function(L,N){var te=N0(this.x,this.y,this.z),ce=G0(this.z,this.x,this.y);return L[(this.x+this.y)%L.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(N==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",ce).replace("{bbox-epsg-3857}",te)},kf.prototype.getTilePoint=function(L){var N=Math.pow(2,this.z);return new i((L.x*N-this.x)*Va,(L.y*N-this.y)*Va)},kf.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var Gv=function(L,N){this.wrap=L,this.canonical=N,this.key=wc(L,N.z,N.z,N.x,N.y)},Uo=function(L,N,te,ce,me){this.overscaledZ=L,this.wrap=N,this.canonical=new kf(te,+ce,+me),this.key=wc(N,L,te,ce,me)};Uo.prototype.equals=function(L){return this.overscaledZ===L.overscaledZ&&this.wrap===L.wrap&&this.canonical.equals(L.canonical)},Uo.prototype.scaledTo=function(L){var N=this.canonical.z-L;return L>this.canonical.z?new Uo(L,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Uo(L,this.wrap,L,this.canonical.x>>N,this.canonical.y>>N)},Uo.prototype.calculateScaledKey=function(L,N){var te=this.canonical.z-L;return L>this.canonical.z?wc(this.wrap*+N,L,this.canonical.z,this.canonical.x,this.canonical.y):wc(this.wrap*+N,L,L,this.canonical.x>>te,this.canonical.y>>te)},Uo.prototype.isChildOf=function(L){if(L.wrap!==this.wrap)return!1;var N=this.canonical.z-L.canonical.z;return L.overscaledZ===0||L.overscaledZ<this.overscaledZ&&L.canonical.x===this.canonical.x>>N&&L.canonical.y===this.canonical.y>>N},Uo.prototype.children=function(L){if(this.overscaledZ>=L)return[new Uo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var N=this.canonical.z+1,te=this.canonical.x*2,ce=this.canonical.y*2;return[new Uo(N,this.wrap,N,te,ce),new Uo(N,this.wrap,N,te+1,ce),new Uo(N,this.wrap,N,te,ce+1),new Uo(N,this.wrap,N,te+1,ce+1)]},Uo.prototype.isLessThan=function(L){return this.wrap<L.wrap?!0:this.wrap>L.wrap?!1:this.overscaledZ<L.overscaledZ?!0:this.overscaledZ>L.overscaledZ?!1:this.canonical.x<L.canonical.x?!0:this.canonical.x>L.canonical.x?!1:this.canonical.y<L.canonical.y},Uo.prototype.wrapped=function(){return new Uo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},Uo.prototype.unwrapTo=function(L){return new Uo(this.overscaledZ,L,this.canonical.z,this.canonical.x,this.canonical.y)},Uo.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},Uo.prototype.toUnwrapped=function(){return new Gv(this.wrap,this.canonical)},Uo.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},Uo.prototype.getTilePoint=function(L){return this.canonical.getTilePoint(new Sf(L.x-this.wrap,L.y))};function wc(C,L,N,te,ce){C*=2,C<0&&(C=C*-1-1);var me=1<<N;return(me*me*C+me*ce+te).toString(36)+N.toString(36)+L.toString(36)}function G0(C,L,N){for(var te="",ce,me=C;me>0;me--)ce=1<<me-1,te+=(L&ce?1:0)+(N&ce?2:0);return te}Ea("CanonicalTileID",kf),Ea("OverscaledTileID",Uo,{omit:["posMatrix"]});var ef=function(L,N,te){if(this.uid=L,N.height!==N.width)throw new RangeError("DEM tiles must be square");if(te&&te!=="mapbox"&&te!=="terrarium")return F('"'+te+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=N.height;var ce=this.dim=N.height-2;this.data=new Uint32Array(N.data.buffer),this.encoding=te||"mapbox";for(var me=0;me<ce;me++)this.data[this._idx(-1,me)]=this.data[this._idx(0,me)],this.data[this._idx(ce,me)]=this.data[this._idx(ce-1,me)],this.data[this._idx(me,-1)]=this.data[this._idx(me,0)],this.data[this._idx(me,ce)]=this.data[this._idx(me,ce-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ce,-1)]=this.data[this._idx(ce-1,0)],this.data[this._idx(-1,ce)]=this.data[this._idx(0,ce-1)],this.data[this._idx(ce,ce)]=this.data[this._idx(ce-1,ce-1)]};ef.prototype.get=function(L,N){var te=new Uint8Array(this.data.buffer),ce=this._idx(L,N)*4,me=this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox;return me(te[ce],te[ce+1],te[ce+2])},ef.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},ef.prototype._idx=function(L,N){if(L<-1||L>=this.dim+1||N<-1||N>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(N+1)*this.stride+(L+1)},ef.prototype._unpackMapbox=function(L,N,te){return(L*256*256+N*256+te)/10-1e4},ef.prototype._unpackTerrarium=function(L,N,te){return L*256+N+te/256-32768},ef.prototype.getPixels=function(){return new nl({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},ef.prototype.backfillBorder=function(L,N,te){if(this.dim!==L.dim)throw new Error("dem dimension mismatch");var ce=N*this.dim,me=N*this.dim+this.dim,Ae=te*this.dim,Fe=te*this.dim+this.dim;switch(N){case-1:ce=me-1;break;case 1:me=ce+1;break}switch(te){case-1:Ae=Fe-1;break;case 1:Fe=Ae+1;break}for(var $e=-N*this.dim,ft=-te*this.dim,dt=Ae;dt<Fe;dt++)for(var Pt=ce;Pt<me;Pt++)this.data[this._idx(Pt,dt)]=L.data[this._idx(Pt+$e,dt+ft)]},Ea("DEMData",ef);function Y0(C,L){var N={};if(!L)return N;for(var te=function(){var Ae=me[ce],Fe=Ae.layerIds.map(function(Pt){return L.getLayer(Pt)}).filter(Boolean);if(Fe.length!==0){Ae.layers=Fe,Ae.stateDependentLayerIds&&(Ae.stateDependentLayers=Ae.stateDependentLayerIds.map(function(Pt){return Fe.filter(function(Jt){return Jt.id===Pt})[0]}));for(var $e=0,ft=Fe;$e<ft.length;$e+=1){var dt=ft[$e];N[dt.id]=Ae}}},ce=0,me=C;ce<me.length;ce+=1)te();return N}var Kc=function(L){this._stringToNumber={},this._numberToString=[];for(var N=0;N<L.length;N++){var te=L[N];this._stringToNumber[te]=N,this._numberToString[N]=te}};Kc.prototype.encode=function(L){return this._stringToNumber[L]},Kc.prototype.decode=function(L){return this._numberToString[L]};var Jc=function(L,N,te,ce,me){this.type="Feature",this._vectorTileFeature=L,L._z=N,L._x=te,L._y=ce,this.properties=L.properties,this.id=me},Eh={geometry:{configurable:!0}};Eh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Eh.geometry.set=function(C){this._geometry=C},Jc.prototype.toJSON=function(){var L={geometry:this.geometry};for(var N in this)N==="_geometry"||N==="_vectorTileFeature"||(L[N]=this[N]);return L},Object.defineProperties(Jc.prototype,Eh);var $f=function(){this.state={},this.stateChanges={},this.deletedStates={}};$f.prototype.updateState=function(L,N,te){var ce=String(N);if(this.stateChanges[L]=this.stateChanges[L]||{},this.stateChanges[L][ce]=this.stateChanges[L][ce]||{},y(this.stateChanges[L][ce],te),this.deletedStates[L]===null){this.deletedStates[L]={};for(var me in this.state[L])me!==ce&&(this.deletedStates[L][me]=null)}else{var Ae=this.deletedStates[L]&&this.deletedStates[L][ce]===null;if(Ae){this.deletedStates[L][ce]={};for(var Fe in this.state[L][ce])te[Fe]||(this.deletedStates[L][ce][Fe]=null)}else for(var $e in te){var ft=this.deletedStates[L]&&this.deletedStates[L][ce]&&this.deletedStates[L][ce][$e]===null;ft&&delete this.deletedStates[L][ce][$e]}}},$f.prototype.removeFeatureState=function(L,N,te){var ce=this.deletedStates[L]===null;if(!ce){var me=String(N);if(this.deletedStates[L]=this.deletedStates[L]||{},te&&N!==void 0)this.deletedStates[L][me]!==null&&(this.deletedStates[L][me]=this.deletedStates[L][me]||{},this.deletedStates[L][me][te]=null);else if(N!==void 0){var Ae=this.stateChanges[L]&&this.stateChanges[L][me];if(Ae){this.deletedStates[L][me]={};for(te in this.stateChanges[L][me])this.deletedStates[L][me][te]=null}else this.deletedStates[L][me]=null}else this.deletedStates[L]=null}},$f.prototype.getState=function(L,N){var te=String(N),ce=this.state[L]||{},me=this.stateChanges[L]||{},Ae=y({},ce[te],me[te]);if(this.deletedStates[L]===null)return{};if(this.deletedStates[L]){var Fe=this.deletedStates[L][N];if(Fe===null)return{};for(var $e in Fe)delete Ae[$e]}return Ae},$f.prototype.initializeTileState=function(L,N){L.setFeatureState(this.state,N)},$f.prototype.coalesceChanges=function(L,N){var te={};for(var ce in this.stateChanges){this.state[ce]=this.state[ce]||{};var me={};for(var Ae in this.stateChanges[ce])this.state[ce][Ae]||(this.state[ce][Ae]={}),y(this.state[ce][Ae],this.stateChanges[ce][Ae]),me[Ae]=this.state[ce][Ae];te[ce]=me}for(var Fe in this.deletedStates){this.state[Fe]=this.state[Fe]||{};var $e={};if(this.deletedStates[Fe]===null)for(var ft in this.state[Fe])$e[ft]={},this.state[Fe][ft]={};else for(var dt in this.deletedStates[Fe]){var Pt=this.deletedStates[Fe][dt]===null;if(Pt)this.state[Fe][dt]={};else for(var Jt=0,Yt=Object.keys(this.deletedStates[Fe][dt]);Jt<Yt.length;Jt+=1){var ur=Yt[Jt];delete this.state[Fe][dt][ur]}$e[dt]=this.state[Fe][dt]}te[Fe]=te[Fe]||{},y(te[Fe],$e)}if(this.stateChanges={},this.deletedStates={},Object.keys(te).length!==0)for(var Dr in L){var rn=L[Dr];rn.setFeatureState(te,N)}};var tf=function(L,N){this.tileID=L,this.x=L.canonical.x,this.y=L.canonical.y,this.z=L.canonical.z,this.grid=new Po(Va,16,0),this.grid3D=new Po(Va,16,0),this.featureIndexArray=new sc,this.promoteId=N};tf.prototype.insert=function(L,N,te,ce,me,Ae){var Fe=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(te,ce,me);for(var $e=Ae?this.grid3D:this.grid,ft=0;ft<N.length;ft++){for(var dt=N[ft],Pt=[1/0,1/0,-1/0,-1/0],Jt=0;Jt<dt.length;Jt++){var Yt=dt[Jt];Pt[0]=Math.min(Pt[0],Yt.x),Pt[1]=Math.min(Pt[1],Yt.y),Pt[2]=Math.max(Pt[2],Yt.x),Pt[3]=Math.max(Pt[3],Yt.y)}Pt[0]<Va&&Pt[1]<Va&&Pt[2]>=0&&Pt[3]>=0&&$e.insert(Fe,Pt[0],Pt[1],Pt[2],Pt[3])}},tf.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Uf.VectorTile(new Nc(this.rawTileData)).layers,this.sourceLayerCoder=new Kc(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},tf.prototype.query=function(L,N,te,ce){var me=this;this.loadVTLayers();for(var Ae=L.params||{},Fe=Va/L.tileSize/L.scale,$e=es(Ae.filter),ft=L.queryGeometry,dt=L.queryPadding*Fe,Pt=Wv(ft),Jt=this.grid.query(Pt.minX-dt,Pt.minY-dt,Pt.maxX+dt,Pt.maxY+dt),Yt=Wv(L.cameraQueryGeometry),ur=this.grid3D.query(Yt.minX-dt,Yt.minY-dt,Yt.maxX+dt,Yt.maxY+dt,function(Yn,la,ia,Ba){return Wu(L.cameraQueryGeometry,Yn-dt,la-dt,ia+dt,Ba+dt)}),Dr=0,rn=ur;Dr<rn.length;Dr+=1){var Jr=rn[Dr];Jt.push(Jr)}Jt.sort(W0);for(var kn={},mn,Mn=function(Yn){var la=Jt[Yn];if(la!==mn){mn=la;var ia=me.featureIndexArray.get(la),Ba=null;me.loadMatchingFeature(kn,ia.bucketIndex,ia.sourceLayerIndex,ia.featureIndex,$e,Ae.layers,Ae.availableImages,N,te,ce,function(_a,Sa,ni){return Ba||(Ba=Wi(_a)),Sa.queryIntersectsFeature(ft,_a,ni,Ba,me.z,L.transform,Fe,L.pixelPosMatrix)})}},zn=0;zn<Jt.length;zn++)Mn(zn);return kn},tf.prototype.loadMatchingFeature=function(L,N,te,ce,me,Ae,Fe,$e,ft,dt,Pt){var Jt=this.bucketLayerIDs[N];if(!(Ae&&!O(Ae,Jt))){var Yt=this.sourceLayerCoder.decode(te),ur=this.vtLayers[Yt],Dr=ur.feature(ce);if(!!me.filter(new ci(this.tileID.overscaledZ),Dr))for(var rn=this.getId(Dr,Yt),Jr=0;Jr<Jt.length;Jr++){var kn=Jt[Jr];if(!(Ae&&Ae.indexOf(kn)<0)){var mn=$e[kn];if(!!mn){var Mn={};rn!==void 0&&dt&&(Mn=dt.getState(mn.sourceLayer||"_geojsonTileLayer",rn));var zn=ft[kn];zn.paint=Yv(zn.paint,mn.paint,Dr,Mn,Fe),zn.layout=Yv(zn.layout,mn.layout,Dr,Mn,Fe);var Yn=!Pt||Pt(Dr,mn,Mn);if(!!Yn){var la=new Jc(Dr,this.z,this.x,this.y,rn);la.layer=zn;var ia=L[kn];ia===void 0&&(ia=L[kn]=[]),ia.push({featureIndex:ce,feature:la,intersectionZ:Yn})}}}}}},tf.prototype.lookupSymbolFeatures=function(L,N,te,ce,me,Ae,Fe,$e){var ft={};this.loadVTLayers();for(var dt=es(me),Pt=0,Jt=L;Pt<Jt.length;Pt+=1){var Yt=Jt[Pt];this.loadMatchingFeature(ft,te,ce,Yt,dt,Ae,Fe,$e,N)}return ft},tf.prototype.hasLayer=function(L){for(var N=0,te=this.bucketLayerIDs;N<te.length;N+=1)for(var ce=te[N],me=0,Ae=ce;me<Ae.length;me+=1){var Fe=Ae[me];if(L===Fe)return!0}return!1},tf.prototype.getId=function(L,N){var te=L.id;if(this.promoteId){var ce=typeof this.promoteId=="string"?this.promoteId:this.promoteId[N];te=L.properties[ce],typeof te=="boolean"&&(te=Number(te))}return te},Ea("FeatureIndex",tf,{omit:["rawTileData","sourceLayerCoder"]});function Yv(C,L,N,te,ce){return S(C,function(me,Ae){var Fe=L instanceof Bi?L.get(Ae):null;return Fe&&Fe.evaluate?Fe.evaluate(N,te,ce):Fe})}function Wv(C){for(var L=1/0,N=1/0,te=-1/0,ce=-1/0,me=0,Ae=C;me<Ae.length;me+=1){var Fe=Ae[me];L=Math.min(L,Fe.x),N=Math.min(N,Fe.y),te=Math.max(te,Fe.x),ce=Math.max(ce,Fe.y)}return{minX:L,minY:N,maxX:te,maxY:ce}}function W0(C,L){return L-C}var X0=3e4,ts=function(L,N){this.tileID=L,this.uid=A(),this.uses=0,this.tileSize=N,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};ts.prototype.registerFadeDuration=function(L){var N=L+this.timeAdded;N<re.now()||this.fadeEndTime&&N<this.fadeEndTime||(this.fadeEndTime=N)},ts.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},ts.prototype.loadVectorData=function(L,N,te){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",!L){this.collisionBoxArray=new Yu;return}L.featureIndex&&(this.latestFeatureIndex=L.featureIndex,L.rawTileData?(this.latestRawTileData=L.rawTileData,this.latestFeatureIndex.rawTileData=L.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=L.collisionBoxArray,this.buckets=Y0(L.buckets,N.style),this.hasSymbolBuckets=!1;for(var ce in this.buckets){var me=this.buckets[ce];if(me instanceof ji)if(this.hasSymbolBuckets=!0,te)me.justReloaded=!0;else break}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var Ae in this.buckets){var Fe=this.buckets[Ae];if(Fe instanceof ji&&Fe.hasRTLText){this.hasRTLText=!0,Ii();break}}this.queryPadding=0;for(var $e in this.buckets){var ft=this.buckets[$e];this.queryPadding=Math.max(this.queryPadding,N.style.getLayer($e).queryRadius(ft))}L.imageAtlas&&(this.imageAtlas=L.imageAtlas),L.glyphAtlasImage&&(this.glyphAtlasImage=L.glyphAtlasImage)},ts.prototype.unloadVectorData=function(){for(var L in this.buckets)this.buckets[L].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},ts.prototype.getBucket=function(L){return this.buckets[L.id]},ts.prototype.upload=function(L){for(var N in this.buckets){var te=this.buckets[N];te.uploadPending()&&te.upload(L)}var ce=L.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Mf(L,this.imageAtlas.image,ce.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Mf(L,this.glyphAtlasImage,ce.ALPHA),this.glyphAtlasImage=null)},ts.prototype.prepare=function(L){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(L,this.imageAtlasTexture)},ts.prototype.queryRenderedFeatures=function(L,N,te,ce,me,Ae,Fe,$e,ft,dt){return!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData?{}:this.latestFeatureIndex.query({queryGeometry:ce,cameraQueryGeometry:me,scale:Ae,tileSize:this.tileSize,pixelPosMatrix:dt,transform:$e,params:Fe,queryPadding:this.queryPadding*ft},L,N,te)},ts.prototype.querySourceFeatures=function(L,N){var te=this.latestFeatureIndex;if(!(!te||!te.rawTileData)){var ce=te.loadVTLayers(),me=N?N.sourceLayer:"",Ae=ce._geojsonTileLayer||ce[me];if(!!Ae)for(var Fe=es(N&&N.filter),$e=this.tileID.canonical,ft=$e.z,dt=$e.x,Pt=$e.y,Jt={z:ft,x:dt,y:Pt},Yt=0;Yt<Ae.length;Yt++){var ur=Ae.feature(Yt);if(Fe.filter(new ci(this.tileID.overscaledZ),ur)){var Dr=te.getId(ur,me),rn=new Jc(ur,ft,dt,Pt,Dr);rn.tile=Jt,L.push(rn)}}}},ts.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},ts.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},ts.prototype.setExpiryData=function(L){var N=this.expirationTime;if(L.cacheControl){var te=oe(L.cacheControl);te["max-age"]&&(this.expirationTime=Date.now()+te["max-age"]*1e3)}else L.expires&&(this.expirationTime=new Date(L.expires).getTime());if(this.expirationTime){var ce=Date.now(),me=!1;if(this.expirationTime>ce)me=!1;else if(!N)me=!0;else if(this.expirationTime<N)me=!0;else{var Ae=this.expirationTime-N;Ae?this.expirationTime=ce+Math.max(Ae,X0):me=!0}me?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},ts.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},ts.prototype.setFeatureState=function(L,N){if(!(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(L).length===0)){var te=this.latestFeatureIndex.loadVTLayers();for(var ce in this.buckets)if(!!N.style.hasLayer(ce)){var me=this.buckets[ce],Ae=me.layers[0].sourceLayer||"_geojsonTileLayer",Fe=te[Ae],$e=L[Ae];if(!(!Fe||!$e||Object.keys($e).length===0)){me.update($e,Fe,this.imageAtlas&&this.imageAtlas.patternPositions||{});var ft=N&&N.style&&N.style.getLayer(ce);ft&&(this.queryPadding=Math.max(this.queryPadding,ft.queryRadius(me)))}}}},ts.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},ts.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<re.now()},ts.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},ts.prototype.setHoldDuration=function(L){this.symbolFadeHoldUntil=re.now()+L},ts.prototype.setDependencies=function(L,N){for(var te={},ce=0,me=N;ce<me.length;ce+=1){var Ae=me[ce];te[Ae]=!0}this.dependencies[L]=te},ts.prototype.hasDependency=function(L,N){for(var te=0,ce=L;te<ce.length;te+=1){var me=ce[te],Ae=this.dependencies[me];if(Ae)for(var Fe=0,$e=N;Fe<$e.length;Fe+=1){var ft=$e[Fe];if(Ae[ft])return!0}}return!1};var Z0=["type","source","source-layer","minzoom","maxzoom","filter","layout"],pf=self.performance,Xv=function(L){this._marks={start:[L.url,"start"].join("#"),end:[L.url,"end"].join("#"),measure:L.url.toString()},pf.mark(this._marks.start)};Xv.prototype.finish=function(){pf.mark(this._marks.end);var L=pf.getEntriesByName(this._marks.measure);return L.length===0&&(pf.measure(this._marks.measure,this._marks.start,this._marks.end),L=pf.getEntriesByName(this._marks.measure),pf.clearMarks(this._marks.start),pf.clearMarks(this._marks.end),pf.clearMeasures(this._marks.measure)),L},e.Actor=Qf,e.AlphaImage=Af,e.CanonicalTileID=kf,e.CollisionBoxArray=Yu,e.Color=mi,e.DEMData=ef,e.DataConstantProperty=Ma,e.DictionaryCoder=Kc,e.EXTENT=Va,e.ErrorEvent=Cr,e.EvaluationParameters=ci,e.Event=ln,e.Evented=Gr,e.FeatureIndex=tf,e.FillBucket=Mu,e.FillExtrusionBucket=Su,e.ImageAtlas=mc,e.ImagePosition=Vc,e.LineBucket=al,e.LngLat=mo,e.LngLatBounds=No,e.MercatorCoordinate=Sf,e.ONE_EM=fs,e.OverscaledTileID=Uo,e.Point=i,e.Point$1=i,e.Properties=Yi,e.Protobuf=Nc,e.RGBAImage=nl,e.RequestManager=be,e.RequestPerformance=Xv,e.ResourceType=lt,e.SegmentVector=Y,e.SourceFeatureState=$f,e.StructArrayLayout1ui2=lf,e.StructArrayLayout2f1f2i16=wu,e.StructArrayLayout2i4=lu,e.StructArrayLayout3ui6=Tu,e.StructArrayLayout4i8=Xl,e.SymbolBucket=ji,e.Texture=Mf,e.Tile=ts,e.Transitionable=$a,e.Uniform1f=Fr,e.Uniform1i=Hr,e.Uniform2f=Zr,e.Uniform3f=fn,e.Uniform4f=En,e.UniformColor=Nn,e.UniformMatrix4f=Qn,e.UnwrappedTileID=Gv,e.ValidationError=cr,e.WritingMode=Il,e.ZoomHistory=Ge,e.add=Of,e.addDynamicAttributes=Ah,e.asyncAll=v,e.bezier=s,e.bindAll=h,e.browser=re,e.cacheEntryPossiblyAdded=$t,e.clamp=x,e.clearTileCache=fr,e.clipLine=Sv,e.clone=Dc,e.clone$1=z,e.clone$2=nh,e.collisionCircleLayout=kd,e.config=j,e.create=If,e.create$1=wf,e.create$2=_f,e.createCommonjsModule=p,e.createExpression=vl,e.createLayout=lo,e.createStyleLayer=B0,e.cross=np,e.deepEqual=r,e.dot=rp,e.dot$1=lp,e.ease=m,e.emitValidationErrors=go,e.endsWith=o,e.enforceCacheSizeLimit=Qt,e.evaluateSizeForFeature=xv,e.evaluateSizeForZoom=bv,e.evaluateVariableOffset=Cv,e.evented=da,e.extend=y,e.featureFilter=es,e.filterObject=R,e.fromRotation=Rf,e.getAnchorAlignment=bh,e.getAnchorJustification=Th,e.getArrayBuffer=Ne,e.getImage=Ot,e.getJSON=Me,e.getRTLTextPluginStatus=Ca,e.getReferrer=Kt,e.getVideo=ir,e.identity=zf,e.invert=ff,e.isChar=He,e.isMapboxURL=Le,e.keysDifference=l,e.makeRequest=we,e.mapObject=S,e.mercatorXfromLng=Uv,e.mercatorYfromLat=Vv,e.mercatorZfromAltitude=Hv,e.mul=rh,e.multiply=cf,e.mvt=Uf,e.normalize=uc,e.number=ho,e.offscreenCanvasSupported=Qr,e.ortho=th,e.parseGlyphPBF=e0,e.pbf=Nc,e.performSymbolLayout=m0,e.perspective=lc,e.pick=T,e.plugin=Xa,e.polygonIntersectsPolygon=oi,e.postMapLoadEvent=_t,e.postTurnstileEvent=Bt,e.potpack=cv,e.refProperties=Z0,e.register=Ea,e.registerForPluginStateChange=Ra,e.rotate=ks,e.rotateX=rl,e.rotateZ=Ff,e.scale=tl,e.scale$1=sp,e.scale$2=ih,e.setCacheLimits=jr,e.setRTLTextPlugin=ii,e.sphericalToCartesian=U,e.sqrLen=cp,e.styleSpec=Ft,e.sub=ip,e.symbolSize=u0,e.transformMat3=ap,e.transformMat4=Rc,e.translate=Do,e.triggerPluginCompletionEvent=fa,e.uniqueId=A,e.validateCustomStyleLayer=z0,e.validateLight=_i,e.validateStyle=po,e.values=_,e.vectorTile=Uf,e.version=g,e.warnOnce=F,e.webpSupported=Z,e.window=self,e.wrap=M}),E(["./shared"],function(e){"use strict";function p(tt){var we=typeof tt;if(we==="number"||we==="boolean"||we==="string"||tt===void 0||tt===null)return JSON.stringify(tt);if(Array.isArray(tt)){for(var Me="[",Ne=0,Xe=tt;Ne<Xe.length;Ne+=1){var Ke=Xe[Ne];Me+=p(Ke)+","}return Me+"]"}for(var rt=Object.keys(tt).sort(),Je="{",vt=0;vt<rt.length;vt++)Je+=JSON.stringify(rt[vt])+":"+p(tt[rt[vt]])+",";return Je+"}"}function g(tt){for(var we="",Me=0,Ne=e.refProperties;Me<Ne.length;Me+=1){var Xe=Ne[Me];we+="/"+p(tt[Xe])}return we}function a(tt,we){for(var Me={},Ne=0;Ne<tt.length;Ne++){var Xe=we&&we[tt[Ne].id]||g(tt[Ne]);we&&(we[tt[Ne].id]=Xe);var Ke=Me[Xe];Ke||(Ke=Me[Xe]=[]),Ke.push(tt[Ne])}var rt=[];for(var Je in Me)rt.push(Me[Je]);return rt}var t=function(we){this.keyCache={},we&&this.replace(we)};t.prototype.replace=function(we){this._layerConfigs={},this._layers={},this.update(we,[])},t.prototype.update=function(we,Me){for(var Ne=this,Xe=0,Ke=we;Xe<Ke.length;Xe+=1){var rt=Ke[Xe];this._layerConfigs[rt.id]=rt;var Je=this._layers[rt.id]=e.createStyleLayer(rt);Je._featureFilter=e.featureFilter(Je.filter),this.keyCache[rt.id]&&delete this.keyCache[rt.id]}for(var vt=0,bt=Me;vt<bt.length;vt+=1){var Et=bt[vt];delete this.keyCache[Et],delete this._layerConfigs[Et],delete this._layers[Et]}this.familiesBySource={};for(var Wt=a(e.values(this._layerConfigs),this.keyCache),Ot=0,ir=Wt;Ot<ir.length;Ot+=1){var vr=ir[Ot],_r=vr.map(function(mr){return Ne._layers[mr.id]}),ln=_r[0];if(ln.visibility!=="none"){var Cr=ln.source||"",Gr=this.familiesBySource[Cr];Gr||(Gr=this.familiesBySource[Cr]={});var sn=ln.sourceLayer||"_geojsonTileLayer",yr=Gr[sn];yr||(yr=Gr[sn]=[]),yr.push(_r)}}};var i=1,n=function(we){var Me={},Ne=[];for(var Xe in we){var Ke=we[Xe],rt=Me[Xe]={};for(var Je in Ke){var vt=Ke[+Je];if(!(!vt||vt.bitmap.width===0||vt.bitmap.height===0)){var bt={x:0,y:0,w:vt.bitmap.width+2*i,h:vt.bitmap.height+2*i};Ne.push(bt),rt[Je]={rect:bt,metrics:vt.metrics}}}}var Et=e.potpack(Ne),Wt=Et.w,Ot=Et.h,ir=new e.AlphaImage({width:Wt||1,height:Ot||1});for(var vr in we){var _r=we[vr];for(var ln in _r){var Cr=_r[+ln];if(!(!Cr||Cr.bitmap.width===0||Cr.bitmap.height===0)){var Gr=Me[vr][ln].rect;e.AlphaImage.copy(Cr.bitmap,ir,{x:0,y:0},{x:Gr.x+i,y:Gr.y+i},Cr.bitmap)}}}this.image=ir,this.positions=Me};e.register("GlyphAtlas",n);var r=function(we){this.tileID=new e.OverscaledTileID(we.tileID.overscaledZ,we.tileID.wrap,we.tileID.canonical.z,we.tileID.canonical.x,we.tileID.canonical.y),this.uid=we.uid,this.zoom=we.zoom,this.pixelRatio=we.pixelRatio,this.tileSize=we.tileSize,this.source=we.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=we.showCollisionBoxes,this.collectResourceTiming=!!we.collectResourceTiming,this.returnDependencies=!!we.returnDependencies,this.promoteId=we.promoteId};r.prototype.parse=function(we,Me,Ne,Xe,Ke){var rt=this;this.status="parsing",this.data=we,this.collisionBoxArray=new e.CollisionBoxArray;var Je=new e.DictionaryCoder(Object.keys(we.layers).sort()),vt=new e.FeatureIndex(this.tileID,this.promoteId);vt.bucketLayerIDs=[];var bt={},Et={featureIndex:vt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:Ne},Wt=Me.familiesBySource[this.source];for(var Ot in Wt){var ir=we.layers[Ot];if(!!ir){ir.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+Ot+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var vr=Je.encode(Ot),_r=[],ln=0;ln<ir.length;ln++){var Cr=ir.feature(ln),Gr=vt.getId(Cr,Ot);_r.push({feature:Cr,id:Gr,index:ln,sourceLayerIndex:vr})}for(var sn=0,yr=Wt[Ot];sn<yr.length;sn+=1){var mr=yr[sn],Or=mr[0];if(!(Or.minzoom&&this.zoom<Math.floor(Or.minzoom))&&!(Or.maxzoom&&this.zoom>=Or.maxzoom)&&Or.visibility!=="none"){d(mr,this.zoom,Ne);var zr=bt[Or.id]=Or.createBucket({index:vt.bucketLayerIDs.length,layers:mr,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:vr,sourceID:this.source});zr.populate(_r,Et,this.tileID.canonical),vt.bucketLayerIDs.push(mr.map(function(Ar){return Ar.id}))}}}}var Sr,ot,Lt,Xt,tr=e.mapObject(Et.glyphDependencies,function(Ar){return Object.keys(Ar).map(Number)});Object.keys(tr).length?Xe.send("getGlyphs",{uid:this.uid,stacks:tr},function(Ar,Kr){Sr||(Sr=Ar,ot=Kr,Rr.call(rt))}):ot={};var Lr=Object.keys(Et.iconDependencies);Lr.length?Xe.send("getImages",{icons:Lr,source:this.source,tileID:this.tileID,type:"icons"},function(Ar,Kr){Sr||(Sr=Ar,Lt=Kr,Rr.call(rt))}):Lt={};var Nr=Object.keys(Et.patternDependencies);Nr.length?Xe.send("getImages",{icons:Nr,source:this.source,tileID:this.tileID,type:"patterns"},function(Ar,Kr){Sr||(Sr=Ar,Xt=Kr,Rr.call(rt))}):Xt={},Rr.call(this);function Rr(){if(Sr)return Ke(Sr);if(ot&&Lt&&Xt){var Ar=new n(ot),Kr=new e.ImageAtlas(Lt,Xt);for(var Dn in bt){var Sn=bt[Dn];Sn instanceof e.SymbolBucket?(d(Sn.layers,this.zoom,Ne),e.performSymbolLayout(Sn,ot,Ar.positions,Lt,Kr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Sn.hasPattern&&(Sn instanceof e.LineBucket||Sn instanceof e.FillBucket||Sn instanceof e.FillExtrusionBucket)&&(d(Sn.layers,this.zoom,Ne),Sn.addFeatures(Et,this.tileID.canonical,Kr.patternPositions))}this.status="done",Ke(null,{buckets:e.values(bt).filter(function(Jn){return!Jn.isEmpty()}),featureIndex:vt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ar.image,imageAtlas:Kr,glyphMap:this.returnDependencies?ot:null,iconMap:this.returnDependencies?Lt:null,glyphPositions:this.returnDependencies?Ar.positions:null})}}};function d(tt,we,Me){for(var Ne=new e.EvaluationParameters(we),Xe=0,Ke=tt;Xe<Ke.length;Xe+=1){var rt=Ke[Xe];rt.recalculate(Ne,Me)}}function s(tt,we){var Me=e.getArrayBuffer(tt.request,function(Ne,Xe,Ke,rt){Ne?we(Ne):Xe&&we(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Xe)),rawData:Xe,cacheControl:Ke,expires:rt})});return function(){Me.cancel(),we()}}var m=function(we,Me,Ne,Xe){this.actor=we,this.layerIndex=Me,this.availableImages=Ne,this.loadVectorData=Xe||s,this.loading={},this.loaded={}};m.prototype.loadTile=function(we,Me){var Ne=this,Xe=we.uid;this.loading||(this.loading={});var Ke=we&&we.request&&we.request.collectResourceTiming?new e.RequestPerformance(we.request):!1,rt=this.loading[Xe]=new r(we);rt.abort=this.loadVectorData(we,function(Je,vt){if(delete Ne.loading[Xe],Je||!vt)return rt.status="done",Ne.loaded[Xe]=rt,Me(Je);var bt=vt.rawData,Et={};vt.expires&&(Et.expires=vt.expires),vt.cacheControl&&(Et.cacheControl=vt.cacheControl);var Wt={};if(Ke){var Ot=Ke.finish();Ot&&(Wt.resourceTiming=JSON.parse(JSON.stringify(Ot)))}rt.vectorTile=vt.vectorTile,rt.parse(vt.vectorTile,Ne.layerIndex,Ne.availableImages,Ne.actor,function(ir,vr){if(ir||!vr)return Me(ir);Me(null,e.extend({rawTileData:bt.slice(0)},vr,Et,Wt))}),Ne.loaded=Ne.loaded||{},Ne.loaded[Xe]=rt})},m.prototype.reloadTile=function(we,Me){var Ne=this,Xe=this.loaded,Ke=we.uid,rt=this;if(Xe&&Xe[Ke]){var Je=Xe[Ke];Je.showCollisionBoxes=we.showCollisionBoxes;var vt=function(bt,Et){var Wt=Je.reloadCallback;Wt&&(delete Je.reloadCallback,Je.parse(Je.vectorTile,rt.layerIndex,Ne.availableImages,rt.actor,Wt)),Me(bt,Et)};Je.status==="parsing"?Je.reloadCallback=vt:Je.status==="done"&&(Je.vectorTile?Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,vt):vt())}},m.prototype.abortTile=function(we,Me){var Ne=this.loading,Xe=we.uid;Ne&&Ne[Xe]&&Ne[Xe].abort&&(Ne[Xe].abort(),delete Ne[Xe]),Me()},m.prototype.removeTile=function(we,Me){var Ne=this.loaded,Xe=we.uid;Ne&&Ne[Xe]&&delete Ne[Xe],Me()};var x=e.window.ImageBitmap,M=function(){this.loaded={}};M.prototype.loadTile=function(we,Me){var Ne=we.uid,Xe=we.encoding,Ke=we.rawImageData,rt=x&&Ke instanceof x?this.getImageData(Ke):Ke,Je=new e.DEMData(Ne,rt,Xe);this.loaded=this.loaded||{},this.loaded[Ne]=Je,Me(null,Je)},M.prototype.getImageData=function(we){(!this.offscreenCanvas||!this.offscreenCanvasContext)&&(this.offscreenCanvas=new OffscreenCanvas(we.width,we.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=we.width,this.offscreenCanvas.height=we.height,this.offscreenCanvasContext.drawImage(we,0,0,we.width,we.height);var Me=this.offscreenCanvasContext.getImageData(-1,-1,we.width+2,we.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:Me.width,height:Me.height},Me.data)},M.prototype.removeTile=function(we){var Me=this.loaded,Ne=we.uid;Me&&Me[Ne]&&delete Me[Ne]};var v=_;function _(tt,we){var Me=tt&&tt.type,Ne;if(Me==="FeatureCollection")for(Ne=0;Ne<tt.features.length;Ne++)_(tt.features[Ne],we);else if(Me==="GeometryCollection")for(Ne=0;Ne<tt.geometries.length;Ne++)_(tt.geometries[Ne],we);else if(Me==="Feature")_(tt.geometry,we);else if(Me==="Polygon")l(tt.coordinates,we);else if(Me==="MultiPolygon")for(Ne=0;Ne<tt.coordinates.length;Ne++)l(tt.coordinates[Ne],we);return tt}function l(tt,we){if(tt.length!==0){y(tt[0],we);for(var Me=1;Me<tt.length;Me++)y(tt[Me],!we)}}function y(tt,we){for(var Me=0,Ne=0,Xe=tt.length,Ke=Xe-1;Ne<Xe;Ke=Ne++)Me+=(tt[Ne][0]-tt[Ke][0])*(tt[Ke][1]+tt[Ne][1]);Me>=0!=!!we&&tt.reverse()}var T=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,w=function(we){this._feature=we,this.extent=e.EXTENT,this.type=we.type,this.properties=we.tags,"id"in we&&!isNaN(we.id)&&(this.id=parseInt(we.id,10))};w.prototype.loadGeometry=function(){if(this._feature.type===1){for(var we=[],Me=0,Ne=this._feature.geometry;Me<Ne.length;Me+=1){var Xe=Ne[Me];we.push([new e.Point$1(Xe[0],Xe[1])])}return we}else{for(var Ke=[],rt=0,Je=this._feature.geometry;rt<Je.length;rt+=1){for(var vt=Je[rt],bt=[],Et=0,Wt=vt;Et<Wt.length;Et+=1){var Ot=Wt[Et];bt.push(new e.Point$1(Ot[0],Ot[1]))}Ke.push(bt)}return Ke}},w.prototype.toGeoJSON=function(we,Me,Ne){return T.call(this,we,Me,Ne)};var A=function(we){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=we.length,this._features=we};A.prototype.feature=function(we){return new w(this._features[we])};var f=e.vectorTile.VectorTileFeature,u=h;function h(tt,we){this.options=we||{},this.features=tt,this.length=tt.length}h.prototype.feature=function(tt){return new o(this.features[tt],this.options.extent)};function o(tt,we){this.id=typeof tt.id=="number"?tt.id:void 0,this.type=tt.type,this.rawGeometry=tt.type===1?[tt.geometry]:tt.geometry,this.properties=tt.tags,this.extent=we||4096}o.prototype.loadGeometry=function(){var tt=this.rawGeometry;this.geometry=[];for(var we=0;we<tt.length;we++){for(var Me=tt[we],Ne=[],Xe=0;Xe<Me.length;Xe++)Ne.push(new e.Point$1(Me[Xe][0],Me[Xe][1]));this.geometry.push(Ne)}return this.geometry},o.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var tt=this.geometry,we=1/0,Me=-1/0,Ne=1/0,Xe=-1/0,Ke=0;Ke<tt.length;Ke++)for(var rt=tt[Ke],Je=0;Je<rt.length;Je++){var vt=rt[Je];we=Math.min(we,vt.x),Me=Math.max(Me,vt.x),Ne=Math.min(Ne,vt.y),Xe=Math.max(Xe,vt.y)}return[we,Ne,Me,Xe]},o.prototype.toGeoJSON=f.prototype.toGeoJSON;var S=I,R=I,z=F,O=u;function I(tt){var we=new e.pbf;return D(tt,we),we.finish()}function F(tt,we){we=we||{};var Me={};for(var Ne in tt)Me[Ne]=new u(tt[Ne].features,we),Me[Ne].name=Ne,Me[Ne].version=we.version,Me[Ne].extent=we.extent;return I({layers:Me})}function D(tt,we){for(var Me in tt.layers)we.writeMessage(3,B,tt.layers[Me])}function B(tt,we){we.writeVarintField(15,tt.version||1),we.writeStringField(1,tt.name||""),we.writeVarintField(5,tt.extent||4096);var Me,Ne={keys:[],values:[],keycache:{},valuecache:{}};for(Me=0;Me<tt.length;Me++)Ne.feature=tt.feature(Me),we.writeMessage(2,U,Ne);var Xe=Ne.keys;for(Me=0;Me<Xe.length;Me++)we.writeStringField(3,Xe[Me]);var Ke=Ne.values;for(Me=0;Me<Ke.length;Me++)we.writeMessage(4,K,Ke[Me])}function U(tt,we){var Me=tt.feature;Me.id!==void 0&&we.writeVarintField(1,Me.id),we.writeMessage(2,X,tt),we.writeVarintField(3,Me.type),we.writeMessage(4,q,Me)}function X(tt,we){var Me=tt.feature,Ne=tt.keys,Xe=tt.values,Ke=tt.keycache,rt=tt.valuecache;for(var Je in Me.properties){var vt=Ke[Je];typeof vt>"u"&&(Ne.push(Je),vt=Ne.length-1,Ke[Je]=vt),we.writeVarint(vt);var bt=Me.properties[Je],Et=typeof bt;Et!=="string"&&Et!=="boolean"&&Et!=="number"&&(bt=JSON.stringify(bt));var Wt=Et+":"+bt,Ot=rt[Wt];typeof Ot>"u"&&(Xe.push(bt),Ot=Xe.length-1,rt[Wt]=Ot),we.writeVarint(Ot)}}function oe(tt,we){return(we<<3)+(tt&7)}function se(tt){return tt<<1^tt>>31}function q(tt,we){for(var Me=tt.loadGeometry(),Ne=tt.type,Xe=0,Ke=0,rt=Me.length,Je=0;Je<rt;Je++){var vt=Me[Je],bt=1;Ne===1&&(bt=vt.length),we.writeVarint(oe(1,bt));for(var Et=Ne===3?vt.length-1:vt.length,Wt=0;Wt<Et;Wt++){Wt===1&&Ne!==1&&we.writeVarint(oe(2,Et-1));var Ot=vt[Wt].x-Xe,ir=vt[Wt].y-Ke;we.writeVarint(se(Ot)),we.writeVarint(se(ir)),Xe+=Ot,Ke+=ir}Ne===3&&we.writeVarint(oe(7,1))}}function K(tt,we){var Me=typeof tt;Me==="string"?we.writeStringField(1,tt):Me==="boolean"?we.writeBooleanField(7,tt):Me==="number"&&(tt%1!==0?we.writeDoubleField(3,tt):tt<0?we.writeSVarintField(6,tt):we.writeVarintField(5,tt))}S.fromVectorTileJs=R,S.fromGeojsonVt=z,S.GeoJSONWrapper=O;function G(tt,we,Me,Ne,Xe,Ke){if(!(Xe-Ne<=Me)){var rt=Ne+Xe>>1;Q(tt,we,rt,Ne,Xe,Ke%2),G(tt,we,Me,Ne,rt-1,Ke+1),G(tt,we,Me,rt+1,Xe,Ke+1)}}function Q(tt,we,Me,Ne,Xe,Ke){for(;Xe>Ne;){if(Xe-Ne>600){var rt=Xe-Ne+1,Je=Me-Ne+1,vt=Math.log(rt),bt=.5*Math.exp(2*vt/3),Et=.5*Math.sqrt(vt*bt*(rt-bt)/rt)*(Je-rt/2<0?-1:1),Wt=Math.max(Ne,Math.floor(Me-Je*bt/rt+Et)),Ot=Math.min(Xe,Math.floor(Me+(rt-Je)*bt/rt+Et));Q(tt,we,Me,Wt,Ot,Ke)}var ir=we[2*Me+Ke],vr=Ne,_r=Xe;for(V(tt,we,Ne,Me),we[2*Xe+Ke]>ir&&V(tt,we,Ne,Xe);vr<_r;){for(V(tt,we,vr,_r),vr++,_r--;we[2*vr+Ke]<ir;)vr++;for(;we[2*_r+Ke]>ir;)_r--}we[2*Ne+Ke]===ir?V(tt,we,Ne,_r):(_r++,V(tt,we,_r,Xe)),_r<=Me&&(Ne=_r+1),Me<=_r&&(Xe=_r-1)}}function V(tt,we,Me,Ne){H(tt,Me,Ne),H(we,2*Me,2*Ne),H(we,2*Me+1,2*Ne+1)}function H(tt,we,Me){var Ne=tt[we];tt[we]=tt[Me],tt[Me]=Ne}function ee(tt,we,Me,Ne,Xe,Ke,rt){for(var Je=[0,tt.length-1,0],vt=[],bt,Et;Je.length;){var Wt=Je.pop(),Ot=Je.pop(),ir=Je.pop();if(Ot-ir<=rt){for(var vr=ir;vr<=Ot;vr++)bt=we[2*vr],Et=we[2*vr+1],bt>=Me&&bt<=Xe&&Et>=Ne&&Et<=Ke&&vt.push(tt[vr]);continue}var _r=Math.floor((ir+Ot)/2);bt=we[2*_r],Et=we[2*_r+1],bt>=Me&&bt<=Xe&&Et>=Ne&&Et<=Ke&&vt.push(tt[_r]);var ln=(Wt+1)%2;(Wt===0?Me<=bt:Ne<=Et)&&(Je.push(ir),Je.push(_r-1),Je.push(ln)),(Wt===0?Xe>=bt:Ke>=Et)&&(Je.push(_r+1),Je.push(Ot),Je.push(ln))}return vt}function J(tt,we,Me,Ne,Xe,Ke){for(var rt=[0,tt.length-1,0],Je=[],vt=Xe*Xe;rt.length;){var bt=rt.pop(),Et=rt.pop(),Wt=rt.pop();if(Et-Wt<=Ke){for(var Ot=Wt;Ot<=Et;Ot++)W(we[2*Ot],we[2*Ot+1],Me,Ne)<=vt&&Je.push(tt[Ot]);continue}var ir=Math.floor((Wt+Et)/2),vr=we[2*ir],_r=we[2*ir+1];W(vr,_r,Me,Ne)<=vt&&Je.push(tt[ir]);var ln=(bt+1)%2;(bt===0?Me-Xe<=vr:Ne-Xe<=_r)&&(rt.push(Wt),rt.push(ir-1),rt.push(ln)),(bt===0?Me+Xe>=vr:Ne+Xe>=_r)&&(rt.push(ir+1),rt.push(Et),rt.push(ln))}return Je}function W(tt,we,Me,Ne){var Xe=tt-Me,Ke=we-Ne;return Xe*Xe+Ke*Ke}var re=function(tt){return tt[0]},j=function(tt){return tt[1]},Z=function(we,Me,Ne,Xe,Ke){Me===void 0&&(Me=re),Ne===void 0&&(Ne=j),Xe===void 0&&(Xe=64),Ke===void 0&&(Ke=Float64Array),this.nodeSize=Xe,this.points=we;for(var rt=we.length<65536?Uint16Array:Uint32Array,Je=this.ids=new rt(we.length),vt=this.coords=new Ke(we.length*2),bt=0;bt<we.length;bt++)Je[bt]=bt,vt[2*bt]=Me(we[bt]),vt[2*bt+1]=Ne(we[bt]);G(Je,vt,Xe,0,Je.length-1,0)};Z.prototype.range=function(we,Me,Ne,Xe){return ee(this.ids,this.coords,we,Me,Ne,Xe,this.nodeSize)},Z.prototype.within=function(we,Me,Ne){return J(this.ids,this.coords,we,Me,Ne,this.nodeSize)};var ne={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(tt){return tt}},le=function(we){this.options=De(Object.create(ne),we),this.trees=new Array(this.options.maxZoom+1)};le.prototype.load=function(we){var Me=this.options,Ne=Me.log,Xe=Me.minZoom,Ke=Me.maxZoom,rt=Me.nodeSize;Ne&&console.time("total time");var Je="prepare "+we.length+" points";Ne&&console.time(Je),this.points=we;for(var vt=[],bt=0;bt<we.length;bt++)!we[bt].geometry||vt.push(pe(we[bt],bt));this.trees[Ke+1]=new Z(vt,ye,ke,rt,Float32Array),Ne&&console.timeEnd(Je);for(var Et=Ke;Et>=Xe;Et--){var Wt=+Date.now();vt=this._cluster(vt,Et),this.trees[Et]=new Z(vt,ye,ke,rt,Float32Array),Ne&&console.log("z%d: %d clusters in %dms",Et,vt.length,+Date.now()-Wt)}return Ne&&console.timeEnd("total time"),this},le.prototype.getClusters=function(we,Me){var Ne=((we[0]+180)%360+360)%360-180,Xe=Math.max(-90,Math.min(90,we[1])),Ke=we[2]===180?180:((we[2]+180)%360+360)%360-180,rt=Math.max(-90,Math.min(90,we[3]));if(we[2]-we[0]>=360)Ne=-180,Ke=180;else if(Ne>Ke){var Je=this.getClusters([Ne,Xe,180,rt],Me),vt=this.getClusters([-180,Xe,Ke,rt],Me);return Je.concat(vt)}for(var bt=this.trees[this._limitZoom(Me)],Et=bt.range(Te(Ne),de(rt),Te(Ke),de(Xe)),Wt=[],Ot=0,ir=Et;Ot<ir.length;Ot+=1){var vr=ir[Ot],_r=bt.points[vr];Wt.push(_r.numPoints?xe(_r):this.points[_r.index])}return Wt},le.prototype.getChildren=function(we){var Me=this._getOriginId(we),Ne=this._getOriginZoom(we),Xe="No cluster with the specified id.",Ke=this.trees[Ne];if(!Ke)throw new Error(Xe);var rt=Ke.points[Me];if(!rt)throw new Error(Xe);for(var Je=this.options.radius/(this.options.extent*Math.pow(2,Ne-1)),vt=Ke.within(rt.x,rt.y,Je),bt=[],Et=0,Wt=vt;Et<Wt.length;Et+=1){var Ot=Wt[Et],ir=Ke.points[Ot];ir.parentId===we&&bt.push(ir.numPoints?xe(ir):this.points[ir.index])}if(bt.length===0)throw new Error(Xe);return bt},le.prototype.getLeaves=function(we,Me,Ne){Me=Me||10,Ne=Ne||0;var Xe=[];return this._appendLeaves(Xe,we,Me,Ne,0),Xe},le.prototype.getTile=function(we,Me,Ne){var Xe=this.trees[this._limitZoom(we)],Ke=Math.pow(2,we),rt=this.options,Je=rt.extent,vt=rt.radius,bt=vt/Je,Et=(Ne-bt)/Ke,Wt=(Ne+1+bt)/Ke,Ot={features:[]};return this._addTileFeatures(Xe.range((Me-bt)/Ke,Et,(Me+1+bt)/Ke,Wt),Xe.points,Me,Ne,Ke,Ot),Me===0&&this._addTileFeatures(Xe.range(1-bt/Ke,Et,1,Wt),Xe.points,Ke,Ne,Ke,Ot),Me===Ke-1&&this._addTileFeatures(Xe.range(0,Et,bt/Ke,Wt),Xe.points,-1,Ne,Ke,Ot),Ot.features.length?Ot:null},le.prototype.getClusterExpansionZoom=function(we){for(var Me=this._getOriginZoom(we)-1;Me<=this.options.maxZoom;){var Ne=this.getChildren(we);if(Me++,Ne.length!==1)break;we=Ne[0].properties.cluster_id}return Me},le.prototype._appendLeaves=function(we,Me,Ne,Xe,Ke){for(var rt=this.getChildren(Me),Je=0,vt=rt;Je<vt.length;Je+=1){var bt=vt[Je],Et=bt.properties;if(Et&&Et.cluster?Ke+Et.point_count<=Xe?Ke+=Et.point_count:Ke=this._appendLeaves(we,Et.cluster_id,Ne,Xe,Ke):Ke<Xe?Ke++:we.push(bt),we.length===Ne)break}return Ke},le.prototype._addTileFeatures=function(we,Me,Ne,Xe,Ke,rt){for(var Je=0,vt=we;Je<vt.length;Je+=1){var bt=vt[Je],Et=Me[bt],Wt=Et.numPoints,Ot={type:1,geometry:[[Math.round(this.options.extent*(Et.x*Ke-Ne)),Math.round(this.options.extent*(Et.y*Ke-Xe))]],tags:Wt?Ee(Et):this.points[Et.index].properties},ir=void 0;Wt?ir=Et.id:this.options.generateId?ir=Et.index:this.points[Et.index].id&&(ir=this.points[Et.index].id),ir!==void 0&&(Ot.id=ir),rt.features.push(Ot)}},le.prototype._limitZoom=function(we){return Math.max(this.options.minZoom,Math.min(we,this.options.maxZoom+1))},le.prototype._cluster=function(we,Me){for(var Ne=[],Xe=this.options,Ke=Xe.radius,rt=Xe.extent,Je=Xe.reduce,vt=Ke/(rt*Math.pow(2,Me)),bt=0;bt<we.length;bt++){var Et=we[bt];if(!(Et.zoom<=Me)){Et.zoom=Me;for(var Wt=this.trees[Me+1],Ot=Wt.within(Et.x,Et.y,vt),ir=Et.numPoints||1,vr=Et.x*ir,_r=Et.y*ir,ln=Je&&ir>1?this._map(Et,!0):null,Cr=(bt<<5)+(Me+1)+this.points.length,Gr=0,sn=Ot;Gr<sn.length;Gr+=1){var yr=sn[Gr],mr=Wt.points[yr];if(!(mr.zoom<=Me)){mr.zoom=Me;var Or=mr.numPoints||1;vr+=mr.x*Or,_r+=mr.y*Or,ir+=Or,mr.parentId=Cr,Je&&(ln||(ln=this._map(Et,!0)),Je(ln,this._map(mr)))}}ir===1?Ne.push(Et):(Et.parentId=Cr,Ne.push(ge(vr/ir,_r/ir,Cr,ir,ln)))}}return Ne},le.prototype._getOriginId=function(we){return we-this.points.length>>5},le.prototype._getOriginZoom=function(we){return(we-this.points.length)%32},le.prototype._map=function(we,Me){if(we.numPoints)return Me?De({},we.properties):we.properties;var Ne=this.points[we.index].properties,Xe=this.options.map(Ne);return Me&&Xe===Ne?De({},Xe):Xe};function ge(tt,we,Me,Ne,Xe){return{x:tt,y:we,zoom:1/0,id:Me,parentId:-1,numPoints:Ne,properties:Xe}}function pe(tt,we){var Me=tt.geometry.coordinates,Ne=Me[0],Xe=Me[1];return{x:Te(Ne),y:de(Xe),zoom:1/0,index:we,parentId:-1}}function xe(tt){return{type:"Feature",id:tt.id,properties:Ee(tt),geometry:{type:"Point",coordinates:[be(tt.x),Le(tt.y)]}}}function Ee(tt){var we=tt.numPoints,Me=we>=1e4?Math.round(we/1e3)+"k":we>=1e3?Math.round(we/100)/10+"k":we;return De(De({},tt.properties),{cluster:!0,cluster_id:tt.id,point_count:we,point_count_abbreviated:Me})}function Te(tt){return tt/360+.5}function de(tt){var we=Math.sin(tt*Math.PI/180),Me=.5-.25*Math.log((1+we)/(1-we))/Math.PI;return Me<0?0:Me>1?1:Me}function be(tt){return(tt-.5)*360}function Le(tt){var we=(180-tt*360)*Math.PI/180;return 360*Math.atan(Math.exp(we))/Math.PI-90}function De(tt,we){for(var Me in we)tt[Me]=we[Me];return tt}function ye(tt){return tt.x}function ke(tt){return tt.y}function Oe(tt,we,Me,Ne){for(var Xe=Ne,Ke=Me-we>>1,rt=Me-we,Je,vt=tt[we],bt=tt[we+1],Et=tt[Me],Wt=tt[Me+1],Ot=we+3;Ot<Me;Ot+=3){var ir=Qe(tt[Ot],tt[Ot+1],vt,bt,Et,Wt);if(ir>Xe)Je=Ot,Xe=ir;else if(ir===Xe){var vr=Math.abs(Ot-Ke);vr<rt&&(Je=Ot,rt=vr)}}Xe>Ne&&(Je-we>3&&Oe(tt,we,Je,Ne),tt[Je+2]=Xe,Me-Je>3&&Oe(tt,Je,Me,Ne))}function Qe(tt,we,Me,Ne,Xe,Ke){var rt=Xe-Me,Je=Ke-Ne;if(rt!==0||Je!==0){var vt=((tt-Me)*rt+(we-Ne)*Je)/(rt*rt+Je*Je);vt>1?(Me=Xe,Ne=Ke):vt>0&&(Me+=rt*vt,Ne+=Je*vt)}return rt=tt-Me,Je=we-Ne,rt*rt+Je*Je}function Ve(tt,we,Me,Ne){var Xe={id:typeof tt>"u"?null:tt,type:we,geometry:Me,tags:Ne,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return Ue(Xe),Xe}function Ue(tt){var we=tt.geometry,Me=tt.type;if(Me==="Point"||Me==="MultiPoint"||Me==="LineString")Ie(tt,we);else if(Me==="Polygon"||Me==="MultiLineString")for(var Ne=0;Ne<we.length;Ne++)Ie(tt,we[Ne]);else if(Me==="MultiPolygon")for(Ne=0;Ne<we.length;Ne++)for(var Xe=0;Xe<we[Ne].length;Xe++)Ie(tt,we[Ne][Xe])}function Ie(tt,we){for(var Me=0;Me<we.length;Me+=3)tt.minX=Math.min(tt.minX,we[Me]),tt.minY=Math.min(tt.minY,we[Me+1]),tt.maxX=Math.max(tt.maxX,we[Me]),tt.maxY=Math.max(tt.maxY,we[Me+1])}function at(tt,we){var Me=[];if(tt.type==="FeatureCollection")for(var Ne=0;Ne<tt.features.length;Ne++)pt(Me,tt.features[Ne],we,Ne);else tt.type==="Feature"?pt(Me,tt,we):pt(Me,{geometry:tt},we);return Me}function pt(tt,we,Me,Ne){if(!!we.geometry){var Xe=we.geometry.coordinates,Ke=we.geometry.type,rt=Math.pow(Me.tolerance/((1<<Me.maxZoom)*Me.extent),2),Je=[],vt=we.id;if(Me.promoteId?vt=we.properties[Me.promoteId]:Me.generateId&&(vt=Ne||0),Ke==="Point")Rt(Xe,Je);else if(Ke==="MultiPoint")for(var bt=0;bt<Xe.length;bt++)Rt(Xe[bt],Je);else if(Ke==="LineString")Mt(Xe,Je,rt,!1);else if(Ke==="MultiLineString")if(Me.lineMetrics){for(bt=0;bt<Xe.length;bt++)Je=[],Mt(Xe[bt],Je,rt,!1),tt.push(Ve(vt,"LineString",Je,we.properties));return}else It(Xe,Je,rt,!1);else if(Ke==="Polygon")It(Xe,Je,rt,!0);else if(Ke==="MultiPolygon")for(bt=0;bt<Xe.length;bt++){var Et=[];It(Xe[bt],Et,rt,!0),Je.push(Et)}else if(Ke==="GeometryCollection"){for(bt=0;bt<we.geometry.geometries.length;bt++)pt(tt,{id:vt,geometry:we.geometry.geometries[bt],properties:we.properties},Me,Ne);return}else throw new Error("Input data is not a valid GeoJSON object.");tt.push(Ve(vt,Ke,Je,we.properties))}}function Rt(tt,we){we.push(Bt(tt[0])),we.push(St(tt[1])),we.push(0)}function Mt(tt,we,Me,Ne){for(var Xe,Ke,rt=0,Je=0;Je<tt.length;Je++){var vt=Bt(tt[Je][0]),bt=St(tt[Je][1]);we.push(vt),we.push(bt),we.push(0),Je>0&&(Ne?rt+=(Xe*bt-vt*Ke)/2:rt+=Math.sqrt(Math.pow(vt-Xe,2)+Math.pow(bt-Ke,2))),Xe=vt,Ke=bt}var Et=we.length-3;we[2]=1,Oe(we,0,Et,Me),we[Et+2]=1,we.size=Math.abs(rt),we.start=0,we.end=we.size}function It(tt,we,Me,Ne){for(var Xe=0;Xe<tt.length;Xe++){var Ke=[];Mt(tt[Xe],Ke,Me,Ne),we.push(Ke)}}function Bt(tt){return tt/360+.5}function St(tt){var we=Math.sin(tt*Math.PI/180),Me=.5-.25*Math.log((1+we)/(1-we))/Math.PI;return Me<0?0:Me>1?1:Me}function _t(tt,we,Me,Ne,Xe,Ke,rt,Je){if(Me/=we,Ne/=we,Ke>=Me&&rt<Ne)return tt;if(rt<Me||Ke>=Ne)return null;for(var vt=[],bt=0;bt<tt.length;bt++){var Et=tt[bt],Wt=Et.geometry,Ot=Et.type,ir=Xe===0?Et.minX:Et.minY,vr=Xe===0?Et.maxX:Et.maxY;if(ir>=Me&&vr<Ne){vt.push(Et);continue}else if(vr<Me||ir>=Ne)continue;var _r=[];if(Ot==="Point"||Ot==="MultiPoint")it(Wt,_r,Me,Ne,Xe);else if(Ot==="LineString")ct(Wt,_r,Me,Ne,Xe,!1,Je.lineMetrics);else if(Ot==="MultiLineString")Pe(Wt,_r,Me,Ne,Xe,!1);else if(Ot==="Polygon")Pe(Wt,_r,Me,Ne,Xe,!0);else if(Ot==="MultiPolygon")for(var ln=0;ln<Wt.length;ln++){var Cr=[];Pe(Wt[ln],Cr,Me,Ne,Xe,!0),Cr.length&&_r.push(Cr)}if(_r.length){if(Je.lineMetrics&&Ot==="LineString"){for(ln=0;ln<_r.length;ln++)vt.push(Ve(Et.id,Ot,_r[ln],Et.tags));continue}(Ot==="LineString"||Ot==="MultiLineString")&&(_r.length===1?(Ot="LineString",_r=_r[0]):Ot="MultiLineString"),(Ot==="Point"||Ot==="MultiPoint")&&(Ot=_r.length===3?"Point":"MultiPoint"),vt.push(Ve(Et.id,Ot,_r,Et.tags))}}return vt.length?vt:null}function it(tt,we,Me,Ne,Xe){for(var Ke=0;Ke<tt.length;Ke+=3){var rt=tt[Ke+Xe];rt>=Me&&rt<=Ne&&(we.push(tt[Ke]),we.push(tt[Ke+1]),we.push(tt[Ke+2]))}}function ct(tt,we,Me,Ne,Xe,Ke,rt){for(var Je=et(tt),vt=Xe===0?je:nt,bt=tt.start,Et,Wt,Ot=0;Ot<tt.length-3;Ot+=3){var ir=tt[Ot],vr=tt[Ot+1],_r=tt[Ot+2],ln=tt[Ot+3],Cr=tt[Ot+4],Gr=Xe===0?ir:vr,sn=Xe===0?ln:Cr,yr=!1;rt&&(Et=Math.sqrt(Math.pow(ir-ln,2)+Math.pow(vr-Cr,2))),Gr<Me?sn>Me&&(Wt=vt(Je,ir,vr,ln,Cr,Me),rt&&(Je.start=bt+Et*Wt)):Gr>Ne?sn<Ne&&(Wt=vt(Je,ir,vr,ln,Cr,Ne),rt&&(Je.start=bt+Et*Wt)):We(Je,ir,vr,_r),sn<Me&&Gr>=Me&&(Wt=vt(Je,ir,vr,ln,Cr,Me),yr=!0),sn>Ne&&Gr<=Ne&&(Wt=vt(Je,ir,vr,ln,Cr,Ne),yr=!0),!Ke&&yr&&(rt&&(Je.end=bt+Et*Wt),we.push(Je),Je=et(tt)),rt&&(bt+=Et)}var mr=tt.length-3;ir=tt[mr],vr=tt[mr+1],_r=tt[mr+2],Gr=Xe===0?ir:vr,Gr>=Me&&Gr<=Ne&&We(Je,ir,vr,_r),mr=Je.length-3,Ke&&mr>=3&&(Je[mr]!==Je[0]||Je[mr+1]!==Je[1])&&We(Je,Je[0],Je[1],Je[2]),Je.length&&we.push(Je)}function et(tt){var we=[];return we.size=tt.size,we.start=tt.start,we.end=tt.end,we}function Pe(tt,we,Me,Ne,Xe,Ke){for(var rt=0;rt<tt.length;rt++)ct(tt[rt],we,Me,Ne,Xe,Ke,!1)}function We(tt,we,Me,Ne){tt.push(we),tt.push(Me),tt.push(Ne)}function je(tt,we,Me,Ne,Xe,Ke){var rt=(Ke-we)/(Ne-we);return tt.push(Ke),tt.push(Me+(Xe-Me)*rt),tt.push(1),rt}function nt(tt,we,Me,Ne,Xe,Ke){var rt=(Ke-Me)/(Xe-Me);return tt.push(we+(Ne-we)*rt),tt.push(Ke),tt.push(1),rt}function kt(tt,we){var Me=we.buffer/we.extent,Ne=tt,Xe=_t(tt,1,-1-Me,Me,0,-1,2,we),Ke=_t(tt,1,1-Me,2+Me,0,-1,2,we);return(Xe||Ke)&&(Ne=_t(tt,1,-Me,1+Me,0,-1,2,we)||[],Xe&&(Ne=wt(Xe,1).concat(Ne)),Ke&&(Ne=Ne.concat(wt(Ke,-1)))),Ne}function wt(tt,we){for(var Me=[],Ne=0;Ne<tt.length;Ne++){var Xe=tt[Ne],Ke=Xe.type,rt;if(Ke==="Point"||Ke==="MultiPoint"||Ke==="LineString")rt=Vt(Xe.geometry,we);else if(Ke==="MultiLineString"||Ke==="Polygon"){rt=[];for(var Je=0;Je<Xe.geometry.length;Je++)rt.push(Vt(Xe.geometry[Je],we))}else if(Ke==="MultiPolygon")for(rt=[],Je=0;Je<Xe.geometry.length;Je++){for(var vt=[],bt=0;bt<Xe.geometry[Je].length;bt++)vt.push(Vt(Xe.geometry[Je][bt],we));rt.push(vt)}Me.push(Ve(Xe.id,Ke,rt,Xe.tags))}return Me}function Vt(tt,we){var Me=[];Me.size=tt.size,tt.start!==void 0&&(Me.start=tt.start,Me.end=tt.end);for(var Ne=0;Ne<tt.length;Ne+=3)Me.push(tt[Ne]+we,tt[Ne+1],tt[Ne+2]);return Me}function qt(tt,we){if(tt.transformed)return tt;var Me=1<<tt.z,Ne=tt.x,Xe=tt.y,Ke,rt,Je;for(Ke=0;Ke<tt.features.length;Ke++){var vt=tt.features[Ke],bt=vt.geometry,Et=vt.type;if(vt.geometry=[],Et===1)for(rt=0;rt<bt.length;rt+=2)vt.geometry.push(zt(bt[rt],bt[rt+1],we,Me,Ne,Xe));else for(rt=0;rt<bt.length;rt++){var Wt=[];for(Je=0;Je<bt[rt].length;Je+=2)Wt.push(zt(bt[rt][Je],bt[rt][Je+1],we,Me,Ne,Xe));vt.geometry.push(Wt)}}return tt.transformed=!0,tt}function zt(tt,we,Me,Ne,Xe,Ke){return[Math.round(Me*(tt*Ne-Xe)),Math.round(Me*(we*Ne-Ke))]}function Ht(tt,we,Me,Ne,Xe){for(var Ke=we===Xe.maxZoom?0:Xe.tolerance/((1<<we)*Xe.extent),rt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Me,y:Ne,z:we,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Je=0;Je<tt.length;Je++){rt.numFeatures++,$t(rt,tt[Je],Ke,Xe);var vt=tt[Je].minX,bt=tt[Je].minY,Et=tt[Je].maxX,Wt=tt[Je].maxY;vt<rt.minX&&(rt.minX=vt),bt<rt.minY&&(rt.minY=bt),Et>rt.maxX&&(rt.maxX=Et),Wt>rt.maxY&&(rt.maxY=Wt)}return rt}function $t(tt,we,Me,Ne){var Xe=we.geometry,Ke=we.type,rt=[];if(Ke==="Point"||Ke==="MultiPoint")for(var Je=0;Je<Xe.length;Je+=3)rt.push(Xe[Je]),rt.push(Xe[Je+1]),tt.numPoints++,tt.numSimplified++;else if(Ke==="LineString")Qt(rt,Xe,tt,Me,!1,!1);else if(Ke==="MultiLineString"||Ke==="Polygon")for(Je=0;Je<Xe.length;Je++)Qt(rt,Xe[Je],tt,Me,Ke==="Polygon",Je===0);else if(Ke==="MultiPolygon")for(var vt=0;vt<Xe.length;vt++){var bt=Xe[vt];for(Je=0;Je<bt.length;Je++)Qt(rt,bt[Je],tt,Me,!0,Je===0)}if(rt.length){var Et=we.tags||null;if(Ke==="LineString"&&Ne.lineMetrics){Et={};for(var Wt in we.tags)Et[Wt]=we.tags[Wt];Et.mapbox_clip_start=Xe.start/Xe.size,Et.mapbox_clip_end=Xe.end/Xe.size}var Ot={geometry:rt,type:Ke==="Polygon"||Ke==="MultiPolygon"?3:Ke==="LineString"||Ke==="MultiLineString"?2:1,tags:Et};we.id!==null&&(Ot.id=we.id),tt.features.push(Ot)}}function Qt(tt,we,Me,Ne,Xe,Ke){var rt=Ne*Ne;if(Ne>0&&we.size<(Xe?rt:Ne)){Me.numPoints+=we.length/3;return}for(var Je=[],vt=0;vt<we.length;vt+=3)(Ne===0||we[vt+2]>rt)&&(Me.numSimplified++,Je.push(we[vt]),Je.push(we[vt+1])),Me.numPoints++;Xe&&fr(Je,Ke),tt.push(Je)}function fr(tt,we){for(var Me=0,Ne=0,Xe=tt.length,Ke=Xe-2;Ne<Xe;Ke=Ne,Ne+=2)Me+=(tt[Ne]-tt[Ke])*(tt[Ne+1]+tt[Ke+1]);if(Me>0===we)for(Ne=0,Xe=tt.length;Ne<Xe/2;Ne+=2){var rt=tt[Ne],Je=tt[Ne+1];tt[Ne]=tt[Xe-2-Ne],tt[Ne+1]=tt[Xe-1-Ne],tt[Xe-2-Ne]=rt,tt[Xe-1-Ne]=Je}}function jr(tt,we){return new cn(tt,we)}function cn(tt,we){we=this.options=lt(Object.create(this.options),we);var Me=we.debug;if(Me&&console.time("preprocess data"),we.maxZoom<0||we.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(we.promoteId&&we.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ne=at(tt,we);this.tiles={},this.tileCoords=[],Me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",we.indexMaxZoom,we.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ne=kt(Ne,we),Ne.length&&this.splitTile(Ne,0,0,0),Me&&(Ne.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}cn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},cn.prototype.splitTile=function(tt,we,Me,Ne,Xe,Ke,rt){for(var Je=[tt,we,Me,Ne],vt=this.options,bt=vt.debug;Je.length;){Ne=Je.pop(),Me=Je.pop(),we=Je.pop(),tt=Je.pop();var Et=1<<we,Wt=Qr(we,Me,Ne),Ot=this.tiles[Wt];if(!Ot&&(bt>1&&console.time("creation"),Ot=this.tiles[Wt]=Ht(tt,we,Me,Ne,vt),this.tileCoords.push({z:we,x:Me,y:Ne}),bt)){bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",we,Me,Ne,Ot.numFeatures,Ot.numPoints,Ot.numSimplified),console.timeEnd("creation"));var ir="z"+we;this.stats[ir]=(this.stats[ir]||0)+1,this.total++}if(Ot.source=tt,Xe){if(we===vt.maxZoom||we===Xe)continue;var vr=1<<Xe-we;if(Me!==Math.floor(Ke/vr)||Ne!==Math.floor(rt/vr))continue}else if(we===vt.indexMaxZoom||Ot.numPoints<=vt.indexMaxPoints)continue;if(Ot.source=null,tt.length!==0){bt>1&&console.time("clipping");var _r=.5*vt.buffer/vt.extent,ln=.5-_r,Cr=.5+_r,Gr=1+_r,sn,yr,mr,Or,zr,Sr;sn=yr=mr=Or=null,zr=_t(tt,Et,Me-_r,Me+Cr,0,Ot.minX,Ot.maxX,vt),Sr=_t(tt,Et,Me+ln,Me+Gr,0,Ot.minX,Ot.maxX,vt),tt=null,zr&&(sn=_t(zr,Et,Ne-_r,Ne+Cr,1,Ot.minY,Ot.maxY,vt),yr=_t(zr,Et,Ne+ln,Ne+Gr,1,Ot.minY,Ot.maxY,vt),zr=null),Sr&&(mr=_t(Sr,Et,Ne-_r,Ne+Cr,1,Ot.minY,Ot.maxY,vt),Or=_t(Sr,Et,Ne+ln,Ne+Gr,1,Ot.minY,Ot.maxY,vt),Sr=null),bt>1&&console.timeEnd("clipping"),Je.push(sn||[],we+1,Me*2,Ne*2),Je.push(yr||[],we+1,Me*2,Ne*2+1),Je.push(mr||[],we+1,Me*2+1,Ne*2),Je.push(Or||[],we+1,Me*2+1,Ne*2+1)}}},cn.prototype.getTile=function(tt,we,Me){var Ne=this.options,Xe=Ne.extent,Ke=Ne.debug;if(tt<0||tt>24)return null;var rt=1<<tt;we=(we%rt+rt)%rt;var Je=Qr(tt,we,Me);if(this.tiles[Je])return qt(this.tiles[Je],Xe);Ke>1&&console.log("drilling down to z%d-%d-%d",tt,we,Me);for(var vt=tt,bt=we,Et=Me,Wt;!Wt&&vt>0;)vt--,bt=Math.floor(bt/2),Et=Math.floor(Et/2),Wt=this.tiles[Qr(vt,bt,Et)];return!Wt||!Wt.source?null:(Ke>1&&console.log("found parent tile z%d-%d-%d",vt,bt,Et),Ke>1&&console.time("drilling down"),this.splitTile(Wt.source,vt,bt,Et,tt,we,Me),Ke>1&&console.timeEnd("drilling down"),this.tiles[Je]?qt(this.tiles[Je],Xe):null)};function Qr(tt,we,Me){return((1<<tt)*Me+we)*32+tt}function lt(tt,we){for(var Me in we)tt[Me]=we[Me];return tt}function Gt(tt,we){var Me=tt.tileID.canonical;if(!this._geoJSONIndex)return we(null,null);var Ne=this._geoJSONIndex.getTile(Me.z,Me.x,Me.y);if(!Ne)return we(null,null);var Xe=new A(Ne.features),Ke=S(Xe);(Ke.byteOffset!==0||Ke.byteLength!==Ke.buffer.byteLength)&&(Ke=new Uint8Array(Ke)),we(null,{vectorTile:Xe,rawData:Ke.buffer})}var Kt=function(tt){function we(Me,Ne,Xe,Ke){tt.call(this,Me,Ne,Xe,Gt),Ke&&(this.loadGeoJSON=Ke)}return tt&&(we.__proto__=tt),we.prototype=Object.create(tt&&tt.prototype),we.prototype.constructor=we,we.prototype.loadData=function(Ne,Xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Xe,this._pendingLoadDataParams=Ne,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},we.prototype._loadData=function(){var Ne=this;if(!(!this._pendingCallback||!this._pendingLoadDataParams)){var Xe=this._pendingCallback,Ke=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var rt=Ke&&Ke.request&&Ke.request.collectResourceTiming?new e.RequestPerformance(Ke.request):!1;this.loadGeoJSON(Ke,function(Je,vt){if(Je||!vt)return Xe(Je);if(typeof vt!="object")return Xe(new Error("Input data given to '"+Ke.source+"' is not a valid GeoJSON object."));v(vt,!0);try{Ne._geoJSONIndex=Ke.cluster?new le(Nt(Ke)).load(vt.features):jr(vt,Ke.geojsonVtOptions)}catch(Wt){return Xe(Wt)}Ne.loaded={};var bt={};if(rt){var Et=rt.finish();Et&&(bt.resourceTiming={},bt.resourceTiming[Ke.source]=JSON.parse(JSON.stringify(Et)))}Xe(null,bt)})}},we.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},we.prototype.reloadTile=function(Ne,Xe){var Ke=this.loaded,rt=Ne.uid;return Ke&&Ke[rt]?tt.prototype.reloadTile.call(this,Ne,Xe):this.loadTile(Ne,Xe)},we.prototype.loadGeoJSON=function(Ne,Xe){if(Ne.request)e.getJSON(Ne.request,Xe);else if(typeof Ne.data=="string")try{return Xe(null,JSON.parse(Ne.data))}catch{return Xe(new Error("Input data given to '"+Ne.source+"' is not a valid GeoJSON object."))}else return Xe(new Error("Input data given to '"+Ne.source+"' is not a valid GeoJSON object."))},we.prototype.removeSource=function(Ne,Xe){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Xe()},we.prototype.getClusterExpansionZoom=function(Ne,Xe){try{Xe(null,this._geoJSONIndex.getClusterExpansionZoom(Ne.clusterId))}catch(Ke){Xe(Ke)}},we.prototype.getClusterChildren=function(Ne,Xe){try{Xe(null,this._geoJSONIndex.getChildren(Ne.clusterId))}catch(Ke){Xe(Ke)}},we.prototype.getClusterLeaves=function(Ne,Xe){try{Xe(null,this._geoJSONIndex.getLeaves(Ne.clusterId,Ne.limit,Ne.offset))}catch(Ke){Xe(Ke)}},we}(m);function Nt(tt){var we=tt.superclusterOptions,Me=tt.clusterProperties;if(!Me||!we)return we;for(var Ne={},Xe={},Ke={accumulated:null,zoom:0},rt={properties:null},Je=Object.keys(Me),vt=0,bt=Je;vt<bt.length;vt+=1){var Et=bt[vt],Wt=Me[Et],Ot=Wt[0],ir=Wt[1],vr=e.createExpression(ir),_r=e.createExpression(typeof Ot=="string"?[Ot,["accumulated"],["get",Et]]:Ot);Ne[Et]=vr.value,Xe[Et]=_r.value}return we.map=function(ln){rt.properties=ln;for(var Cr={},Gr=0,sn=Je;Gr<sn.length;Gr+=1){var yr=sn[Gr];Cr[yr]=Ne[yr].evaluate(Ke,rt)}return Cr},we.reduce=function(ln,Cr){rt.properties=Cr;for(var Gr=0,sn=Je;Gr<sn.length;Gr+=1){var yr=sn[Gr];Ke.accumulated=ln[yr],ln[yr]=Xe[yr].evaluate(Ke,rt)}},we}var gr=function(we){var Me=this;this.self=we,this.actor=new e.Actor(we,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:m,geojson:Kt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Ne,Xe){if(Me.workerSourceTypes[Ne])throw new Error('Worker source with name "'+Ne+'" already registered.');Me.workerSourceTypes[Ne]=Xe},this.self.registerRTLTextPlugin=function(Ne){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=Ne.applyArabicShaping,e.plugin.processBidirectionalText=Ne.processBidirectionalText,e.plugin.processStyledBidirectionalText=Ne.processStyledBidirectionalText}};return gr.prototype.setReferrer=function(we,Me){this.referrer=Me},gr.prototype.setImages=function(we,Me,Ne){this.availableImages[we]=Me;for(var Xe in this.workerSources[we]){var Ke=this.workerSources[we][Xe];for(var rt in Ke)Ke[rt].availableImages=Me}Ne()},gr.prototype.setLayers=function(we,Me,Ne){this.getLayerIndex(we).replace(Me),Ne()},gr.prototype.updateLayers=function(we,Me,Ne){this.getLayerIndex(we).update(Me.layers,Me.removedIds),Ne()},gr.prototype.loadTile=function(we,Me,Ne){this.getWorkerSource(we,Me.type,Me.source).loadTile(Me,Ne)},gr.prototype.loadDEMTile=function(we,Me,Ne){this.getDEMWorkerSource(we,Me.source).loadTile(Me,Ne)},gr.prototype.reloadTile=function(we,Me,Ne){this.getWorkerSource(we,Me.type,Me.source).reloadTile(Me,Ne)},gr.prototype.abortTile=function(we,Me,Ne){this.getWorkerSource(we,Me.type,Me.source).abortTile(Me,Ne)},gr.prototype.removeTile=function(we,Me,Ne){this.getWorkerSource(we,Me.type,Me.source).removeTile(Me,Ne)},gr.prototype.removeDEMTile=function(we,Me){this.getDEMWorkerSource(we,Me.source).removeTile(Me)},gr.prototype.removeSource=function(we,Me,Ne){if(!(!this.workerSources[we]||!this.workerSources[we][Me.type]||!this.workerSources[we][Me.type][Me.source])){var Xe=this.workerSources[we][Me.type][Me.source];delete this.workerSources[we][Me.type][Me.source],Xe.removeSource!==void 0?Xe.removeSource(Me,Ne):Ne()}},gr.prototype.loadWorkerSource=function(we,Me,Ne){try{this.self.importScripts(Me.url),Ne()}catch(Xe){Ne(Xe.toString())}},gr.prototype.syncRTLPluginState=function(we,Me,Ne){try{e.plugin.setState(Me);var Xe=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&Xe!=null){this.self.importScripts(Xe);var Ke=e.plugin.isParsed(),rt=Ke?void 0:new Error("RTL Text Plugin failed to import scripts from "+Xe);Ne(rt,Ke)}}catch(Je){Ne(Je.toString())}},gr.prototype.getAvailableImages=function(we){var Me=this.availableImages[we];return Me||(Me=[]),Me},gr.prototype.getLayerIndex=function(we){var Me=this.layerIndexes[we];return Me||(Me=this.layerIndexes[we]=new t),Me},gr.prototype.getWorkerSource=function(we,Me,Ne){var Xe=this;if(this.workerSources[we]||(this.workerSources[we]={}),this.workerSources[we][Me]||(this.workerSources[we][Me]={}),!this.workerSources[we][Me][Ne]){var Ke={send:function(rt,Je,vt){Xe.actor.send(rt,Je,vt,we)}};this.workerSources[we][Me][Ne]=new this.workerSourceTypes[Me](Ke,this.getLayerIndex(we),this.getAvailableImages(we))}return this.workerSources[we][Me][Ne]},gr.prototype.getDEMWorkerSource=function(we,Me){return this.demWorkerSources[we]||(this.demWorkerSources[we]={}),this.demWorkerSources[we][Me]||(this.demWorkerSources[we][Me]=new M),this.demWorkerSources[we][Me]},gr.prototype.enforceCacheSizeLimit=function(we,Me){e.enforceCacheSizeLimit(Me)},typeof WorkerGlobalScope<"u"&&typeof e.window<"u"&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new gr(e.window)),gr}),E(["./shared"],function(e){"use strict";var p=e.createCommonjsModule(function(fe){fe.exports?fe.exports=Y:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=Y,window.mapboxgl.notSupportedReason=he);function Y(Fr){return!he(Fr)}function he(Fr){if(!$())return"not a browser";if(!ve())return"insufficent Array support";if(!Se())return"insufficient Function support";if(!Re())return"insufficient Object support";if(!Ze())return"insufficient JSON support";if(!ut())return"insufficient worker support";if(!At())return"insufficient Uint8ClampedArray support";if(!Ut())return"insufficient ArrayBuffer support";if(!nr())return"insufficient Canvas/getImageData support";if(!Tr(Fr&&Fr.failIfMajorPerformanceCaveat))return"insufficient WebGL support"}function $(){return typeof window<"u"&&typeof document<"u"}function ve(){return Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray}function Se(){return Function.prototype&&Function.prototype.bind}function Re(){return Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions}function Ze(){return"JSON"in window&&"parse"in JSON&&"stringify"in JSON}function ut(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Fr=new Blob([""],{type:"text/javascript"}),Zr=URL.createObjectURL(Fr),fn,En;try{En=new Worker(Zr),fn=!0}catch{fn=!1}return En&&En.terminate(),URL.revokeObjectURL(Zr),fn}function At(){return"Uint8ClampedArray"in window}function Ut(){return ArrayBuffer.isView}function nr(){var Fr=document.createElement("canvas");Fr.width=Fr.height=1;var Zr=Fr.getContext("2d");if(!Zr)return!1;var fn=Zr.getImageData(0,0,1,1);return fn&&fn.width===Fr.width}var sr={};function Tr(Fr){return sr[Fr]===void 0&&(sr[Fr]=Hr(Fr)),sr[Fr]}Y.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};function Ur(Fr){var Zr=document.createElement("canvas"),fn=Object.create(Y.webGLContextAttributes);return fn.failIfMajorPerformanceCaveat=Fr,Zr.probablySupportsContext?Zr.probablySupportsContext("webgl",fn)||Zr.probablySupportsContext("experimental-webgl",fn):Zr.supportsContext?Zr.supportsContext("webgl",fn)||Zr.supportsContext("experimental-webgl",fn):Zr.getContext("webgl",fn)||Zr.getContext("experimental-webgl",fn)}function Hr(Fr){var Zr=Ur(Fr);if(!Zr)return!1;var fn=Zr.createShader(Zr.VERTEX_SHADER);return!fn||Zr.isContextLost()?!1:(Zr.shaderSource(fn,"void main() {}"),Zr.compileShader(fn),Zr.getShaderParameter(fn,Zr.COMPILE_STATUS)===!0)}}),g={};g.create=function(fe,Y,he){var $=e.window.document.createElement(fe);return Y!==void 0&&($.className=Y),he&&he.appendChild($),$},g.createNS=function(fe,Y){var he=e.window.document.createElementNS(fe,Y);return he};var a=e.window.document.documentElement.style;function t(fe){if(!a)return fe[0];for(var Y=0;Y<fe.length;Y++)if(fe[Y]in a)return fe[Y];return fe[0]}var i=t(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),n;g.disableDrag=function(){a&&i&&(n=a[i],a[i]="none")},g.enableDrag=function(){a&&i&&(a[i]=n)};var r=t(["transform","WebkitTransform"]);g.setTransform=function(fe,Y){fe.style[r]=Y};var d=!1;try{var s=Object.defineProperty({},"passive",{get:function(){d=!0}});e.window.addEventListener("test",s,s),e.window.removeEventListener("test",s,s)}catch{d=!1}g.addEventListener=function(fe,Y,he,$){$===void 0&&($={}),"passive"in $&&d?fe.addEventListener(Y,he,$):fe.addEventListener(Y,he,$.capture)},g.removeEventListener=function(fe,Y,he,$){$===void 0&&($={}),"passive"in $&&d?fe.removeEventListener(Y,he,$):fe.removeEventListener(Y,he,$.capture)};var m=function(fe){fe.preventDefault(),fe.stopPropagation(),e.window.removeEventListener("click",m,!0)};g.suppressClick=function(){e.window.addEventListener("click",m,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",m,!0)},0)},g.mousePos=function(fe,Y){var he=fe.getBoundingClientRect();return new e.Point(Y.clientX-he.left-fe.clientLeft,Y.clientY-he.top-fe.clientTop)},g.touchPos=function(fe,Y){for(var he=fe.getBoundingClientRect(),$=[],ve=0;ve<Y.length;ve++)$.push(new e.Point(Y[ve].clientX-he.left-fe.clientLeft,Y[ve].clientY-he.top-fe.clientTop));return $},g.mouseButton=function(fe){return typeof e.window.InstallTrigger<"u"&&fe.button===2&&fe.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:fe.button},g.remove=function(fe){fe.parentNode&&fe.parentNode.removeChild(fe)};function x(fe,Y,he){var $,ve,Se,Re=e.browser.devicePixelRatio>1?"@2x":"",Ze=e.getJSON(Y.transformRequest(Y.normalizeSpriteURL(fe,Re,".json"),e.ResourceType.SpriteJSON),function(Ut,nr){Ze=null,Se||(Se=Ut,$=nr,At())}),ut=e.getImage(Y.transformRequest(Y.normalizeSpriteURL(fe,Re,".png"),e.ResourceType.SpriteImage),function(Ut,nr){ut=null,Se||(Se=Ut,ve=nr,At())});function At(){if(Se)he(Se);else if($&&ve){var Ut=e.browser.getImageData(ve),nr={};for(var sr in $){var Tr=$[sr],Ur=Tr.width,Hr=Tr.height,Fr=Tr.x,Zr=Tr.y,fn=Tr.sdf,En=Tr.pixelRatio,Nn=Tr.stretchX,jn=Tr.stretchY,Qn=Tr.content,Kn=new e.RGBAImage({width:Ur,height:Hr});e.RGBAImage.copy(Ut,Kn,{x:Fr,y:Zr},{x:0,y:0},{width:Ur,height:Hr}),nr[sr]={data:Kn,pixelRatio:En,sdf:fn,stretchX:Nn,stretchY:jn,content:Qn}}he(null,nr)}}return{cancel:function(){Ze&&(Ze.cancel(),Ze=null),ut&&(ut.cancel(),ut=null)}}}function M(fe){var Y=fe.userImage;if(Y&&Y.render){var he=Y.render();if(he)return fe.data.replace(new Uint8Array(Y.data.buffer)),!0}return!1}var v=1,_=function(fe){function Y(){fe.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.isLoaded=function(){return this.loaded},Y.prototype.setLoaded=function($){if(this.loaded!==$&&(this.loaded=$,$)){for(var ve=0,Se=this.requestors;ve<Se.length;ve+=1){var Re=Se[ve],Ze=Re.ids,ut=Re.callback;this._notify(Ze,ut)}this.requestors=[]}},Y.prototype.getImage=function($){return this.images[$]},Y.prototype.addImage=function($,ve){this._validate($,ve)&&(this.images[$]=ve)},Y.prototype._validate=function($,ve){var Se=!0;return this._validateStretch(ve.stretchX,ve.data&&ve.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+$+'" has invalid "stretchX" value'))),Se=!1),this._validateStretch(ve.stretchY,ve.data&&ve.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+$+'" has invalid "stretchY" value'))),Se=!1),this._validateContent(ve.content,ve)||(this.fire(new e.ErrorEvent(new Error('Image "'+$+'" has invalid "content" value'))),Se=!1),Se},Y.prototype._validateStretch=function($,ve){if(!$)return!0;for(var Se=0,Re=0,Ze=$;Re<Ze.length;Re+=1){var ut=Ze[Re];if(ut[0]<Se||ut[1]<ut[0]||ve<ut[1])return!1;Se=ut[1]}return!0},Y.prototype._validateContent=function($,ve){return $?!($.length!==4||$[0]<0||ve.data.width<$[0]||$[1]<0||ve.data.height<$[1]||$[2]<0||ve.data.width<$[2]||$[3]<0||ve.data.height<$[3]||$[2]<$[0]||$[3]<$[1]):!0},Y.prototype.updateImage=function($,ve){var Se=this.images[$];ve.version=Se.version+1,this.images[$]=ve,this.updatedImages[$]=!0},Y.prototype.removeImage=function($){var ve=this.images[$];delete this.images[$],delete this.patterns[$],ve.userImage&&ve.userImage.onRemove&&ve.userImage.onRemove()},Y.prototype.listImages=function(){return Object.keys(this.images)},Y.prototype.getImages=function($,ve){var Se=!0;if(!this.isLoaded())for(var Re=0,Ze=$;Re<Ze.length;Re+=1){var ut=Ze[Re];this.images[ut]||(Se=!1)}this.isLoaded()||Se?this._notify($,ve):this.requestors.push({ids:$,callback:ve})},Y.prototype._notify=function($,ve){for(var Se={},Re=0,Ze=$;Re<Ze.length;Re+=1){var ut=Ze[Re];this.images[ut]||this.fire(new e.Event("styleimagemissing",{id:ut}));var At=this.images[ut];At?Se[ut]={data:At.data.clone(),pixelRatio:At.pixelRatio,sdf:At.sdf,version:At.version,stretchX:At.stretchX,stretchY:At.stretchY,content:At.content,hasRenderCallback:Boolean(At.userImage&&At.userImage.render)}:e.warnOnce('Image "'+ut+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}ve(null,Se)},Y.prototype.getPixelSize=function(){var $=this.atlasImage,ve=$.width,Se=$.height;return{width:ve,height:Se}},Y.prototype.getPattern=function($){var ve=this.patterns[$],Se=this.getImage($);if(!Se)return null;if(ve&&ve.position.version===Se.version)return ve.position;if(ve)ve.position.version=Se.version;else{var Re=Se.data.width+v*2,Ze=Se.data.height+v*2,ut={w:Re,h:Ze,x:0,y:0},At=new e.ImagePosition(ut,Se);this.patterns[$]={bin:ut,position:At}}return this._updatePatternAtlas(),this.patterns[$].position},Y.prototype.bind=function($){var ve=$.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture($,this.atlasImage,ve.RGBA),this.atlasTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE)},Y.prototype._updatePatternAtlas=function(){var $=[];for(var ve in this.patterns)$.push(this.patterns[ve].bin);var Se=e.potpack($),Re=Se.w,Ze=Se.h,ut=this.atlasImage;ut.resize({width:Re||1,height:Ze||1});for(var At in this.patterns){var Ut=this.patterns[At],nr=Ut.bin,sr=nr.x+v,Tr=nr.y+v,Ur=this.images[At].data,Hr=Ur.width,Fr=Ur.height;e.RGBAImage.copy(Ur,ut,{x:0,y:0},{x:sr,y:Tr},{width:Hr,height:Fr}),e.RGBAImage.copy(Ur,ut,{x:0,y:Fr-1},{x:sr,y:Tr-1},{width:Hr,height:1}),e.RGBAImage.copy(Ur,ut,{x:0,y:0},{x:sr,y:Tr+Fr},{width:Hr,height:1}),e.RGBAImage.copy(Ur,ut,{x:Hr-1,y:0},{x:sr-1,y:Tr},{width:1,height:Fr}),e.RGBAImage.copy(Ur,ut,{x:0,y:0},{x:sr+Hr,y:Tr},{width:1,height:Fr})}this.dirty=!0},Y.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},Y.prototype.dispatchRenderCallbacks=function($){for(var ve=0,Se=$;ve<Se.length;ve+=1){var Re=Se[ve];if(!this.callbackDispatchedThisFrame[Re]){this.callbackDispatchedThisFrame[Re]=!0;var Ze=this.images[Re],ut=M(Ze);ut&&this.updateImage(Re,Ze)}}},Y}(e.Evented);function l(fe,Y,he,$,ve){var Se=Y*256,Re=Se+255,Ze=$.transformRequest($.normalizeGlyphsURL(he).replace("{fontstack}",fe).replace("{range}",Se+"-"+Re),e.ResourceType.Glyphs);e.getArrayBuffer(Ze,function(ut,At){if(ut)ve(ut);else if(At){for(var Ut={},nr=0,sr=e.parseGlyphPBF(At);nr<sr.length;nr+=1){var Tr=sr[nr];Ut[Tr.id]=Tr}ve(null,Ut)}})}var y=A,T=A,w=1e20;function A(fe,Y,he,$,ve,Se){this.fontSize=fe||24,this.buffer=Y===void 0?3:Y,this.cutoff=$||.25,this.fontFamily=ve||"sans-serif",this.fontWeight=Se||"normal",this.radius=he||8;var Re=this.size=this.fontSize+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=Re,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(Re*Re),this.gridInner=new Float64Array(Re*Re),this.f=new Float64Array(Re),this.d=new Float64Array(Re),this.z=new Float64Array(Re+1),this.v=new Int16Array(Re),this.middle=Math.round(Re/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}A.prototype.draw=function(fe){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(fe,this.buffer,this.middle);for(var Y=this.ctx.getImageData(0,0,this.size,this.size),he=new Uint8ClampedArray(this.size*this.size),$=0;$<this.size*this.size;$++){var ve=Y.data[$*4+3]/255;this.gridOuter[$]=ve===1?0:ve===0?w:Math.pow(Math.max(0,.5-ve),2),this.gridInner[$]=ve===1?w:ve===0?0:Math.pow(Math.max(0,ve-.5),2)}for(f(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),f(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),$=0;$<this.size*this.size;$++){var Se=this.gridOuter[$]-this.gridInner[$];he[$]=Math.max(0,Math.min(255,Math.round(255-255*(Se/this.radius+this.cutoff))))}return he};function f(fe,Y,he,$,ve,Se,Re){for(var Ze=0;Ze<Y;Ze++){for(var ut=0;ut<he;ut++)$[ut]=fe[ut*Y+Ze];for(u($,ve,Se,Re,he),ut=0;ut<he;ut++)fe[ut*Y+Ze]=ve[ut]}for(ut=0;ut<he;ut++){for(Ze=0;Ze<Y;Ze++)$[Ze]=fe[ut*Y+Ze];for(u($,ve,Se,Re,Y),Ze=0;Ze<Y;Ze++)fe[ut*Y+Ze]=Math.sqrt(ve[Ze])}}function u(fe,Y,he,$,ve){he[0]=0,$[0]=-w,$[1]=+w;for(var Se=1,Re=0;Se<ve;Se++){for(var Ze=(fe[Se]+Se*Se-(fe[he[Re]]+he[Re]*he[Re]))/(2*Se-2*he[Re]);Ze<=$[Re];)Re--,Ze=(fe[Se]+Se*Se-(fe[he[Re]]+he[Re]*he[Re]))/(2*Se-2*he[Re]);Re++,he[Re]=Se,$[Re]=Ze,$[Re+1]=+w}for(Se=0,Re=0;Se<ve;Se++){for(;$[Re+1]<Se;)Re++;Y[Se]=(Se-he[Re])*(Se-he[Re])+fe[he[Re]]}}y.default=T;var h=function(Y,he){this.requestManager=Y,this.localIdeographFontFamily=he,this.entries={}};h.prototype.setURL=function(Y){this.url=Y},h.prototype.getGlyphs=function(Y,he){var $=this,ve=[];for(var Se in Y)for(var Re=0,Ze=Y[Se];Re<Ze.length;Re+=1){var ut=Ze[Re];ve.push({stack:Se,id:ut})}e.asyncAll(ve,function(At,Ut){var nr=At.stack,sr=At.id,Tr=$.entries[nr];Tr||(Tr=$.entries[nr]={glyphs:{},requests:{},ranges:{}});var Ur=Tr.glyphs[sr];if(Ur!==void 0){Ut(null,{stack:nr,id:sr,glyph:Ur});return}if(Ur=$._tinySDF(Tr,nr,sr),Ur){Tr.glyphs[sr]=Ur,Ut(null,{stack:nr,id:sr,glyph:Ur});return}var Hr=Math.floor(sr/256);if(Hr*256>65535){Ut(new Error("glyphs > 65535 not supported"));return}if(Tr.ranges[Hr]){Ut(null,{stack:nr,id:sr,glyph:Ur});return}var Fr=Tr.requests[Hr];Fr||(Fr=Tr.requests[Hr]=[],h.loadGlyphRange(nr,Hr,$.url,$.requestManager,function(Zr,fn){if(fn){for(var En in fn)$._doesCharSupportLocalGlyph(+En)||(Tr.glyphs[+En]=fn[+En]);Tr.ranges[Hr]=!0}for(var Nn=0,jn=Fr;Nn<jn.length;Nn+=1){var Qn=jn[Nn];Qn(Zr,fn)}delete Tr.requests[Hr]})),Fr.push(function(Zr,fn){Zr?Ut(Zr):fn&&Ut(null,{stack:nr,id:sr,glyph:fn[sr]||null})})},function(At,Ut){if(At)he(At);else if(Ut){for(var nr={},sr=0,Tr=Ut;sr<Tr.length;sr+=1){var Ur=Tr[sr],Hr=Ur.stack,Fr=Ur.id,Zr=Ur.glyph;(nr[Hr]||(nr[Hr]={}))[Fr]=Zr&&{id:Zr.id,bitmap:Zr.bitmap.clone(),metrics:Zr.metrics}}he(null,nr)}})},h.prototype._doesCharSupportLocalGlyph=function(Y){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](Y)||e.isChar["Hangul Syllables"](Y)||e.isChar.Hiragana(Y)||e.isChar.Katakana(Y))},h.prototype._tinySDF=function(Y,he,$){var ve=this.localIdeographFontFamily;if(!!ve&&!!this._doesCharSupportLocalGlyph($)){var Se=Y.tinySDF;if(!Se){var Re="400";/bold/i.test(he)?Re="900":/medium/i.test(he)?Re="500":/light/i.test(he)&&(Re="200"),Se=Y.tinySDF=new h.TinySDF(24,3,8,.25,ve,Re)}return{id:$,bitmap:new e.AlphaImage({width:30,height:30},Se.draw(String.fromCharCode($))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},h.loadGlyphRange=l,h.TinySDF=y;var o=function(){this.specification=e.styleSpec.light.position};o.prototype.possiblyEvaluate=function(Y,he){return e.sphericalToCartesian(Y.expression.evaluate(he))},o.prototype.interpolate=function(Y,he,$){return{x:e.number(Y.x,he.x,$),y:e.number(Y.y,he.y,$),z:e.number(Y.z,he.z,$)}};var S=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new o,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),R="-transition",z=function(fe){function Y(he){fe.call(this),this._transitionable=new e.Transitionable(S),this.setLight(he),this._transitioning=this._transitionable.untransitioned()}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getLight=function(){return this._transitionable.serialize()},Y.prototype.setLight=function($,ve){if(ve===void 0&&(ve={}),!this._validate(e.validateLight,$,ve))for(var Se in $){var Re=$[Se];e.endsWith(Se,R)?this._transitionable.setTransition(Se.slice(0,-R.length),Re):this._transitionable.setValue(Se,Re)}},Y.prototype.updateTransitions=function($){this._transitioning=this._transitionable.transitioned($,this._transitioning)},Y.prototype.hasTransition=function(){return this._transitioning.hasTransition()},Y.prototype.recalculate=function($){this.properties=this._transitioning.possiblyEvaluate($)},Y.prototype._validate=function($,ve,Se){return Se&&Se.validate===!1?!1:e.emitValidationErrors(this,$.call(e.validateStyle,e.extend({value:ve,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},Y}(e.Evented),O=function(Y,he){this.width=Y,this.height=he,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};O.prototype.getDash=function(Y,he){var $=Y.join(",")+String(he);return this.dashEntry[$]||(this.dashEntry[$]=this.addDash(Y,he)),this.dashEntry[$]},O.prototype.getDashRanges=function(Y,he,$){var ve=Y.length%2===1,Se=[],Re=ve?-Y[Y.length-1]*$:0,Ze=Y[0]*$,ut=!0;Se.push({left:Re,right:Ze,isDash:ut,zeroLength:Y[0]===0});for(var At=Y[0],Ut=1;Ut<Y.length;Ut++){ut=!ut;var nr=Y[Ut];Re=At*$,At+=nr,Ze=At*$,Se.push({left:Re,right:Ze,isDash:ut,zeroLength:nr===0})}return Se},O.prototype.addRoundDash=function(Y,he,$){for(var ve=he/2,Se=-$;Se<=$;Se++)for(var Re=this.nextRow+$+Se,Ze=this.width*Re,ut=0,At=Y[ut],Ut=0;Ut<this.width;Ut++){Ut/At.right>1&&(At=Y[++ut]);var nr=Math.abs(Ut-At.left),sr=Math.abs(Ut-At.right),Tr=Math.min(nr,sr),Ur=void 0,Hr=Se/$*(ve+1);if(At.isDash){var Fr=ve-Math.abs(Hr);Ur=Math.sqrt(Tr*Tr+Fr*Fr)}else Ur=ve-Math.sqrt(Tr*Tr+Hr*Hr);this.data[Ze+Ut]=Math.max(0,Math.min(255,Ur+128))}},O.prototype.addRegularDash=function(Y){for(var he=Y.length-1;he>=0;--he){var $=Y[he],ve=Y[he+1];$.zeroLength?Y.splice(he,1):ve&&ve.isDash===$.isDash&&(ve.left=$.left,Y.splice(he,1))}var Se=Y[0],Re=Y[Y.length-1];Se.isDash===Re.isDash&&(Se.left=Re.left-this.width,Re.right=Se.right+this.width);for(var Ze=this.width*this.nextRow,ut=0,At=Y[ut],Ut=0;Ut<this.width;Ut++){Ut/At.right>1&&(At=Y[++ut]);var nr=Math.abs(Ut-At.left),sr=Math.abs(Ut-At.right),Tr=Math.min(nr,sr),Ur=At.isDash?Tr:-Tr;this.data[Ze+Ut]=Math.max(0,Math.min(255,Ur+128))}},O.prototype.addDash=function(Y,he){var $=he?7:0,ve=2*$+1;if(this.nextRow+ve>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var Se=0,Re=0;Re<Y.length;Re++)Se+=Y[Re];if(Se!==0){var Ze=this.width/Se,ut=this.getDashRanges(Y,this.width,Ze);he?this.addRoundDash(ut,Ze,$):this.addRegularDash(ut)}var At={y:(this.nextRow+$+.5)/this.height,height:2*$/this.height,width:Se};return this.nextRow+=ve,this.dirty=!0,At},O.prototype.bind=function(Y){var he=Y.gl;this.texture?(he.bindTexture(he.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,he.texSubImage2D(he.TEXTURE_2D,0,0,0,this.width,this.height,he.ALPHA,he.UNSIGNED_BYTE,this.data))):(this.texture=he.createTexture(),he.bindTexture(he.TEXTURE_2D,this.texture),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_S,he.REPEAT),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_T,he.REPEAT),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MAG_FILTER,he.LINEAR),he.texImage2D(he.TEXTURE_2D,0,he.ALPHA,this.width,this.height,0,he.ALPHA,he.UNSIGNED_BYTE,this.data))};var I=function fe(Y,he){this.workerPool=Y,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var $=this.workerPool.acquire(this.id),ve=0;ve<$.length;ve++){var Se=$[ve],Re=new fe.Actor(Se,he,this.id);Re.name="Worker "+ve,this.actors.push(Re)}};I.prototype.broadcast=function(Y,he,$){$=$||function(){},e.asyncAll(this.actors,function(ve,Se){ve.send(Y,he,Se)},$)},I.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},I.prototype.remove=function(){this.actors.forEach(function(Y){Y.remove()}),this.actors=[],this.workerPool.release(this.id)},I.Actor=e.Actor;function F(fe,Y,he){var $=function(ve,Se){if(ve)return he(ve);if(Se){var Re=e.pick(e.extend(Se,fe),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);Se.vector_layers&&(Re.vectorLayers=Se.vector_layers,Re.vectorLayerIds=Re.vectorLayers.map(function(Ze){return Ze.id})),Re.tiles=Y.canonicalizeTileset(Re,fe.url),he(null,Re)}};return fe.url?e.getJSON(Y.transformRequest(Y.normalizeSourceURL(fe.url),e.ResourceType.Source),$):e.browser.frame(function(){return $(null,fe)})}var D=function(Y,he,$){this.bounds=e.LngLatBounds.convert(this.validateBounds(Y)),this.minzoom=he||0,this.maxzoom=$||24};D.prototype.validateBounds=function(Y){return!Array.isArray(Y)||Y.length!==4?[-180,-90,180,90]:[Math.max(-180,Y[0]),Math.max(-90,Y[1]),Math.min(180,Y[2]),Math.min(90,Y[3])]},D.prototype.contains=function(Y){var he=Math.pow(2,Y.z),$={minX:Math.floor(e.mercatorXfromLng(this.bounds.getWest())*he),minY:Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*he),maxX:Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*he),maxY:Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*he)},ve=Y.x>=$.minX&&Y.x<$.maxX&&Y.y>=$.minY&&Y.y<$.maxY;return ve};var B=function(fe){function Y(he,$,ve,Se){if(fe.call(this),this.id=he,this.dispatcher=ve,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick($,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},$),this._collectResourceTiming=$.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(Se)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.load=function(){var $=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=F(this._options,this.map._requestManager,function(ve,Se){$._tileJSONRequest=null,$._loaded=!0,ve?$.fire(new e.ErrorEvent(ve)):Se&&(e.extend($,Se),Se.bounds&&($.tileBounds=new D(Se.bounds,$.minzoom,$.maxzoom)),e.postTurnstileEvent(Se.tiles,$.map._requestManager._customAccessToken),e.postMapLoadEvent(Se.tiles,$.map._getMapId(),$.map._requestManager._skuToken,$.map._requestManager._customAccessToken),$.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),$.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},Y.prototype.loaded=function(){return this._loaded},Y.prototype.hasTile=function($){return!this.tileBounds||this.tileBounds.contains($.canonical)},Y.prototype.onAdd=function($){this.map=$,this.load()},Y.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},Y.prototype.serialize=function(){return e.extend({},this._options)},Y.prototype.loadTile=function($,ve){var Se=this.map._requestManager.normalizeTileURL($.tileID.canonical.url(this.tiles,this.scheme)),Re={request:this.map._requestManager.transformRequest(Se,e.ResourceType.Tile),uid:$.uid,tileID:$.tileID,zoom:$.tileID.overscaledZ,tileSize:this.tileSize*$.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};Re.request.collectResourceTiming=this._collectResourceTiming,!$.actor||$.state==="expired"?($.actor=this.dispatcher.getActor(),$.request=$.actor.send("loadTile",Re,Ze.bind(this))):$.state==="loading"?$.reloadCallback=ve:$.request=$.actor.send("reloadTile",Re,Ze.bind(this));function Ze(ut,At){if(delete $.request,$.aborted)return ve(null);if(ut&&ut.status!==404)return ve(ut);At&&At.resourceTiming&&($.resourceTiming=At.resourceTiming),this.map._refreshExpiredTiles&&At&&$.setExpiryData(At),$.loadVectorData(At,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),ve(null),$.reloadCallback&&(this.loadTile($,$.reloadCallback),$.reloadCallback=null)}},Y.prototype.abortTile=function($){$.request&&($.request.cancel(),delete $.request),$.actor&&$.actor.send("abortTile",{uid:$.uid,type:this.type,source:this.id},void 0)},Y.prototype.unloadTile=function($){$.unloadVectorData(),$.actor&&$.actor.send("removeTile",{uid:$.uid,type:this.type,source:this.id},void 0)},Y.prototype.hasTransition=function(){return!1},Y}(e.Evented),U=function(fe){function Y(he,$,ve,Se){fe.call(this),this.id=he,this.dispatcher=ve,this.setEventedParent(Se),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},$),e.extend(this,e.pick($,["url","scheme","tileSize"]))}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.load=function(){var $=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=F(this._options,this.map._requestManager,function(ve,Se){$._tileJSONRequest=null,$._loaded=!0,ve?$.fire(new e.ErrorEvent(ve)):Se&&(e.extend($,Se),Se.bounds&&($.tileBounds=new D(Se.bounds,$.minzoom,$.maxzoom)),e.postTurnstileEvent(Se.tiles),e.postMapLoadEvent(Se.tiles,$.map._getMapId(),$.map._requestManager._skuToken),$.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),$.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},Y.prototype.loaded=function(){return this._loaded},Y.prototype.onAdd=function($){this.map=$,this.load()},Y.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},Y.prototype.serialize=function(){return e.extend({},this._options)},Y.prototype.hasTile=function($){return!this.tileBounds||this.tileBounds.contains($.canonical)},Y.prototype.loadTile=function($,ve){var Se=this,Re=this.map._requestManager.normalizeTileURL($.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);$.request=e.getImage(this.map._requestManager.transformRequest(Re,e.ResourceType.Tile),function(Ze,ut){if(delete $.request,$.aborted)$.state="unloaded",ve(null);else if(Ze)$.state="errored",ve(Ze);else if(ut){Se.map._refreshExpiredTiles&&$.setExpiryData(ut),delete ut.cacheControl,delete ut.expires;var At=Se.map.painter.context,Ut=At.gl;$.texture=Se.map.painter.getTileTexture(ut.width),$.texture?$.texture.update(ut,{useMipmap:!0}):($.texture=new e.Texture(At,ut,Ut.RGBA,{useMipmap:!0}),$.texture.bind(Ut.LINEAR,Ut.CLAMP_TO_EDGE,Ut.LINEAR_MIPMAP_NEAREST),At.extTextureFilterAnisotropic&&Ut.texParameterf(Ut.TEXTURE_2D,At.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,At.extTextureFilterAnisotropicMax)),$.state="loaded",e.cacheEntryPossiblyAdded(Se.dispatcher),ve(null)}})},Y.prototype.abortTile=function($,ve){$.request&&($.request.cancel(),delete $.request),ve()},Y.prototype.unloadTile=function($,ve){$.texture&&this.map.painter.saveTileTexture($.texture),ve()},Y.prototype.hasTransition=function(){return!1},Y}(e.Evented),X=function(fe){function Y(he,$,ve,Se){fe.call(this,he,$,ve,Se),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},$),this.encoding=$.encoding||"mapbox"}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},Y.prototype.loadTile=function($,ve){var Se=this.map._requestManager.normalizeTileURL($.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);$.request=e.getImage(this.map._requestManager.transformRequest(Se,e.ResourceType.Tile),Re.bind(this)),$.neighboringTiles=this._getNeighboringTiles($.tileID);function Re(ut,At){if(delete $.request,$.aborted)$.state="unloaded",ve(null);else if(ut)$.state="errored",ve(ut);else if(At){this.map._refreshExpiredTiles&&$.setExpiryData(At),delete At.cacheControl,delete At.expires;var Ut=e.window.ImageBitmap&&At instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported(),nr=Ut?At:e.browser.getImageData(At,1),sr={uid:$.uid,coord:$.tileID,source:this.id,rawImageData:nr,encoding:this.encoding};(!$.actor||$.state==="expired")&&($.actor=this.dispatcher.getActor(),$.actor.send("loadDEMTile",sr,Ze.bind(this)))}}function Ze(ut,At){ut&&($.state="errored",ve(ut)),At&&($.dem=At,$.needsHillshadePrepare=!0,$.state="loaded",ve(null))}},Y.prototype._getNeighboringTiles=function($){var ve=$.canonical,Se=Math.pow(2,ve.z),Re=(ve.x-1+Se)%Se,Ze=ve.x===0?$.wrap-1:$.wrap,ut=(ve.x+1+Se)%Se,At=ve.x+1===Se?$.wrap+1:$.wrap,Ut={};return Ut[new e.OverscaledTileID($.overscaledZ,Ze,ve.z,Re,ve.y).key]={backfilled:!1},Ut[new e.OverscaledTileID($.overscaledZ,At,ve.z,ut,ve.y).key]={backfilled:!1},ve.y>0&&(Ut[new e.OverscaledTileID($.overscaledZ,Ze,ve.z,Re,ve.y-1).key]={backfilled:!1},Ut[new e.OverscaledTileID($.overscaledZ,$.wrap,ve.z,ve.x,ve.y-1).key]={backfilled:!1},Ut[new e.OverscaledTileID($.overscaledZ,At,ve.z,ut,ve.y-1).key]={backfilled:!1}),ve.y+1<Se&&(Ut[new e.OverscaledTileID($.overscaledZ,Ze,ve.z,Re,ve.y+1).key]={backfilled:!1},Ut[new e.OverscaledTileID($.overscaledZ,$.wrap,ve.z,ve.x,ve.y+1).key]={backfilled:!1},Ut[new e.OverscaledTileID($.overscaledZ,At,ve.z,ut,ve.y+1).key]={backfilled:!1}),Ut},Y.prototype.unloadTile=function($){$.demTexture&&this.map.painter.saveTileTexture($.demTexture),$.fbo&&($.fbo.destroy(),delete $.fbo),$.dem&&delete $.dem,delete $.neighboringTiles,$.state="unloaded",$.actor&&$.actor.send("removeDEMTile",{uid:$.uid,source:this.id})},Y}(U),oe=function(fe){function Y(he,$,ve,Se){fe.call(this),this.id=he,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=ve.getActor(),this.setEventedParent(Se),this._data=$.data,this._options=e.extend({},$),this._collectResourceTiming=$.collectResourceTiming,this._resourceTiming=[],$.maxzoom!==void 0&&(this.maxzoom=$.maxzoom),$.type&&(this.type=$.type),$.attribution&&(this.attribution=$.attribution),this.promoteId=$.promoteId;var Re=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:$.cluster||!1,geojsonVtOptions:{buffer:($.buffer!==void 0?$.buffer:128)*Re,tolerance:($.tolerance!==void 0?$.tolerance:.375)*Re,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:$.lineMetrics||!1,generateId:$.generateId||!1},superclusterOptions:{maxZoom:$.clusterMaxZoom!==void 0?Math.min($.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:($.clusterRadius||50)*Re,log:!1,generateId:$.generateId||!1},clusterProperties:$.clusterProperties},$.workerOptions)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.load=function(){var $=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(ve){if(ve){$.fire(new e.ErrorEvent(ve));return}var Se={dataType:"source",sourceDataType:"metadata"};$._collectResourceTiming&&$._resourceTiming&&$._resourceTiming.length>0&&(Se.resourceTiming=$._resourceTiming,$._resourceTiming=[]),$.fire(new e.Event("data",Se))})},Y.prototype.onAdd=function($){this.map=$,this.load()},Y.prototype.setData=function($){var ve=this;return this._data=$,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(Se){if(Se){ve.fire(new e.ErrorEvent(Se));return}var Re={dataType:"source",sourceDataType:"content"};ve._collectResourceTiming&&ve._resourceTiming&&ve._resourceTiming.length>0&&(Re.resourceTiming=ve._resourceTiming,ve._resourceTiming=[]),ve.fire(new e.Event("data",Re))}),this},Y.prototype.getClusterExpansionZoom=function($,ve){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:$,source:this.id},ve),this},Y.prototype.getClusterChildren=function($,ve){return this.actor.send("geojson.getClusterChildren",{clusterId:$,source:this.id},ve),this},Y.prototype.getClusterLeaves=function($,ve,Se,Re){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:$,limit:ve,offset:Se},Re),this},Y.prototype._updateWorkerData=function($){var ve=this;this._loaded=!1;var Se=e.extend({},this.workerOptions),Re=this._data;typeof Re=="string"?(Se.request=this.map._requestManager.transformRequest(e.browser.resolveURL(Re),e.ResourceType.Source),Se.request.collectResourceTiming=this._collectResourceTiming):Se.data=JSON.stringify(Re),this.actor.send(this.type+".loadData",Se,function(Ze,ut){ve._removed||ut&&ut.abandoned||(ve._loaded=!0,ut&&ut.resourceTiming&&ut.resourceTiming[ve.id]&&(ve._resourceTiming=ut.resourceTiming[ve.id].slice(0)),ve.actor.send(ve.type+".coalesce",{source:Se.source},null),$(Ze))})},Y.prototype.loaded=function(){return this._loaded},Y.prototype.loadTile=function($,ve){var Se=this,Re=$.actor?"reloadTile":"loadTile";$.actor=this.actor;var Ze={type:this.type,uid:$.uid,tileID:$.tileID,zoom:$.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};$.request=this.actor.send(Re,Ze,function(ut,At){return delete $.request,$.unloadVectorData(),$.aborted?ve(null):ut?ve(ut):($.loadVectorData(At,Se.map.painter,Re==="reloadTile"),ve(null))})},Y.prototype.abortTile=function($){$.request&&($.request.cancel(),delete $.request),$.aborted=!0},Y.prototype.unloadTile=function($){$.unloadVectorData(),this.actor.send("removeTile",{uid:$.uid,type:this.type,source:this.id})},Y.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},Y.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},Y.prototype.hasTransition=function(){return!1},Y}(e.Evented),se=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),q=function(fe){function Y(he,$,ve,Se){fe.call(this),this.id=he,this.dispatcher=ve,this.coordinates=$.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(Se),this.options=$}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.load=function($,ve){var Se=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(Re,Ze){Se._loaded=!0,Re?Se.fire(new e.ErrorEvent(Re)):Ze&&(Se.image=Ze,$&&(Se.coordinates=$),ve&&ve(),Se._finishLoading())})},Y.prototype.loaded=function(){return this._loaded},Y.prototype.updateImage=function($){var ve=this;return!this.image||!$.url?this:(this.options.url=$.url,this.load($.coordinates,function(){ve.texture=null}),this)},Y.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},Y.prototype.onAdd=function($){this.map=$,this.load()},Y.prototype.setCoordinates=function($){var ve=this;this.coordinates=$;var Se=$.map(e.MercatorCoordinate.fromLngLat);this.tileID=K(Se),this.minzoom=this.maxzoom=this.tileID.z;var Re=Se.map(function(Ze){return ve.tileID.getTilePoint(Ze)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(Re[0].x,Re[0].y,0,0),this._boundsArray.emplaceBack(Re[1].x,Re[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(Re[3].x,Re[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(Re[2].x,Re[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},Y.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||!this.image)){var $=this.map.painter.context,ve=$.gl;this.boundsBuffer||(this.boundsBuffer=$.createVertexBuffer(this._boundsArray,se.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture($,this.image,ve.RGBA),this.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE));for(var Se in this.tiles){var Re=this.tiles[Se];Re.state!=="loaded"&&(Re.state="loaded",Re.texture=this.texture)}}},Y.prototype.loadTile=function($,ve){this.tileID&&this.tileID.equals($.tileID.canonical)?(this.tiles[String($.tileID.wrap)]=$,$.buckets={},ve(null)):($.state="errored",ve(null))},Y.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},Y.prototype.hasTransition=function(){return!1},Y}(e.Evented);function K(fe){for(var Y=1/0,he=1/0,$=-1/0,ve=-1/0,Se=0,Re=fe;Se<Re.length;Se+=1){var Ze=Re[Se];Y=Math.min(Y,Ze.x),he=Math.min(he,Ze.y),$=Math.max($,Ze.x),ve=Math.max(ve,Ze.y)}var ut=$-Y,At=ve-he,Ut=Math.max(ut,At),nr=Math.max(0,Math.floor(-Math.log(Ut)/Math.LN2)),sr=Math.pow(2,nr);return new e.CanonicalTileID(nr,Math.floor((Y+$)/2*sr),Math.floor((he+ve)/2*sr))}var G=function(fe){function Y(he,$,ve,Se){fe.call(this,he,$,ve,Se),this.roundZoom=!0,this.type="video",this.options=$}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.load=function(){var $=this;this._loaded=!1;var ve=this.options;this.urls=[];for(var Se=0,Re=ve.urls;Se<Re.length;Se+=1){var Ze=Re[Se];this.urls.push(this.map._requestManager.transformRequest(Ze,e.ResourceType.Source).url)}e.getVideo(this.urls,function(ut,At){$._loaded=!0,ut?$.fire(new e.ErrorEvent(ut)):At&&($.video=At,$.video.loop=!0,$.video.addEventListener("playing",function(){$.map.triggerRepaint()}),$.map&&$.video.play(),$._finishLoading())})},Y.prototype.pause=function(){this.video&&this.video.pause()},Y.prototype.play=function(){this.video&&this.video.play()},Y.prototype.seek=function($){if(this.video){var ve=this.video.seekable;$<ve.start(0)||$>ve.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+ve.start(0)+" and "+ve.end(0)+"-second mark."))):this.video.currentTime=$}},Y.prototype.getVideo=function(){return this.video},Y.prototype.onAdd=function($){this.map||(this.map=$,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},Y.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var $=this.map.painter.context,ve=$.gl;this.boundsBuffer||(this.boundsBuffer=$.createVertexBuffer(this._boundsArray,se.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),ve.texSubImage2D(ve.TEXTURE_2D,0,0,0,ve.RGBA,ve.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture($,this.video,ve.RGBA),this.texture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE));for(var Se in this.tiles){var Re=this.tiles[Se];Re.state!=="loaded"&&(Re.state="loaded",Re.texture=this.texture)}}},Y.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},Y.prototype.hasTransition=function(){return this.video&&!this.video.paused},Y}(q),Q=function(fe){function Y(he,$,ve,Se){fe.call(this,he,$,ve,Se),$.coordinates?(!Array.isArray($.coordinates)||$.coordinates.length!==4||$.coordinates.some(function(Re){return!Array.isArray(Re)||Re.length!==2||Re.some(function(Ze){return typeof Ze!="number"})}))&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+he,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+he,null,'missing required property "coordinates"'))),$.animate&&typeof $.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+he,null,'optional "animate" property must be a boolean value'))),$.canvas?typeof $.canvas!="string"&&!($.canvas instanceof e.window.HTMLCanvasElement)&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+he,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+he,null,'missing required property "canvas"'))),this.options=$,this.animate=$.animate!==void 0?$.animate:!0}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.load=function(){if(this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()){this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero.")));return}this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading()},Y.prototype.getCanvas=function(){return this.canvas},Y.prototype.onAdd=function($){this.map=$,this.load(),this.canvas&&this.animate&&this.play()},Y.prototype.onRemove=function(){this.pause()},Y.prototype.prepare=function(){var $=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,$=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,$=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var ve=this.map.painter.context,Se=ve.gl;this.boundsBuffer||(this.boundsBuffer=ve.createVertexBuffer(this._boundsArray,se.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?($||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(ve,this.canvas,Se.RGBA,{premultiply:!0});for(var Re in this.tiles){var Ze=this.tiles[Re];Ze.state!=="loaded"&&(Ze.state="loaded",Ze.texture=this.texture)}}},Y.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},Y.prototype.hasTransition=function(){return this._playing},Y.prototype._hasInvalidDimensions=function(){for(var $=0,ve=[this.canvas.width,this.canvas.height];$<ve.length;$+=1){var Se=ve[$];if(isNaN(Se)||Se<=0)return!0}return!1},Y}(q),V={vector:B,raster:U,"raster-dem":X,geojson:oe,video:G,image:q,canvas:Q},H=function(fe,Y,he,$){var ve=new V[Y.type](fe,Y,he,$);if(ve.id!==fe)throw new Error("Expected Source id to be "+fe+" instead of "+ve.id);return e.bindAll(["load","abort","unload","serialize","prepare"],ve),ve},ee=function(fe){return V[fe]},J=function(fe,Y){V[fe]=Y};function W(fe,Y){var he=e.identity([]);return e.translate(he,he,[1,1,0]),e.scale(he,he,[fe.width*.5,fe.height*.5,1]),e.multiply(he,he,fe.calculatePosMatrix(Y.toUnwrapped()))}function re(fe,Y,he){if(fe)for(var $=0,ve=fe;$<ve.length;$+=1){var Se=ve[$],Re=Y[Se];if(Re&&Re.source===he&&Re.type==="fill-extrusion")return!0}else for(var Ze in Y){var ut=Y[Ze];if(ut.source===he&&ut.type==="fill-extrusion")return!0}return!1}function j(fe,Y,he,$,ve,Se){var Re=re(ve&&ve.layers,Y,fe.id),Ze=Se.maxPitchScaleFactor(),ut=fe.tilesIn($,Ze,Re);ut.sort(le);for(var At=[],Ut=0,nr=ut;Ut<nr.length;Ut+=1){var sr=nr[Ut];At.push({wrappedTileID:sr.tileID.wrapped().key,queryResults:sr.tile.queryRenderedFeatures(Y,he,fe._state,sr.queryGeometry,sr.cameraQueryGeometry,sr.scale,ve,Se,Ze,W(fe.transform,sr.tileID))})}var Tr=ge(At);for(var Ur in Tr)Tr[Ur].forEach(function(Hr){var Fr=Hr.feature,Zr=fe.getFeatureState(Fr.layer["source-layer"],Fr.id);Fr.source=Fr.layer.source,Fr.layer["source-layer"]&&(Fr.sourceLayer=Fr.layer["source-layer"]),Fr.state=Zr});return Tr}function Z(fe,Y,he,$,ve,Se,Re){for(var Ze={},ut=Se.queryRenderedSymbols($),At=[],Ut=0,nr=Object.keys(ut).map(Number);Ut<nr.length;Ut+=1){var sr=nr[Ut];At.push(Re[sr])}At.sort(le);for(var Tr=function(){var fn=Hr[Ur],En=fn.featureIndex.lookupSymbolFeatures(ut[fn.bucketInstanceId],Y,fn.bucketIndex,fn.sourceLayerIndex,ve.filter,ve.layers,ve.availableImages,fe);for(var Nn in En){var jn=Ze[Nn]=Ze[Nn]||[],Qn=En[Nn];Qn.sort(function(ma,Ta){var Pa=fn.featureSortOrder;if(Pa){var Za=Pa.indexOf(ma.featureIndex),ai=Pa.indexOf(Ta.featureIndex);return ai-Za}else return Ta.featureIndex-ma.featureIndex});for(var Kn=0,ha=Qn;Kn<ha.length;Kn+=1){var xa=ha[Kn];jn.push(xa)}}},Ur=0,Hr=At;Ur<Hr.length;Ur+=1)Tr();var Fr=function(fn){Ze[fn].forEach(function(En){var Nn=En.feature,jn=fe[fn],Qn=he[jn.source],Kn=Qn.getFeatureState(Nn.layer["source-layer"],Nn.id);Nn.source=Nn.layer.source,Nn.layer["source-layer"]&&(Nn.sourceLayer=Nn.layer["source-layer"]),Nn.state=Kn})};for(var Zr in Ze)Fr(Zr);return Ze}function ne(fe,Y){for(var he=fe.getRenderableIds().map(function(ut){return fe.getTileByID(ut)}),$=[],ve={},Se=0;Se<he.length;Se++){var Re=he[Se],Ze=Re.tileID.canonical.key;ve[Ze]||(ve[Ze]=!0,Re.querySourceFeatures($,Y))}return $}function le(fe,Y){var he=fe.tileID,$=Y.tileID;return he.overscaledZ-$.overscaledZ||he.canonical.y-$.canonical.y||he.wrap-$.wrap||he.canonical.x-$.canonical.x}function ge(fe){for(var Y={},he={},$=0,ve=fe;$<ve.length;$+=1){var Se=ve[$],Re=Se.queryResults,Ze=Se.wrappedTileID,ut=he[Ze]=he[Ze]||{};for(var At in Re)for(var Ut=Re[At],nr=ut[At]=ut[At]||{},sr=Y[At]=Y[At]||[],Tr=0,Ur=Ut;Tr<Ur.length;Tr+=1){var Hr=Ur[Tr];nr[Hr.featureIndex]||(nr[Hr.featureIndex]=!0,sr.push(Hr))}}return Y}var pe=function(Y,he){this.max=Y,this.onRemove=he,this.reset()};pe.prototype.reset=function(){for(var Y in this.data)for(var he=0,$=this.data[Y];he<$.length;he+=1){var ve=$[he];ve.timeout&&clearTimeout(ve.timeout),this.onRemove(ve.value)}return this.data={},this.order=[],this},pe.prototype.add=function(Y,he,$){var ve=this,Se=Y.wrapped().key;this.data[Se]===void 0&&(this.data[Se]=[]);var Re={value:he,timeout:void 0};if($!==void 0&&(Re.timeout=setTimeout(function(){ve.remove(Y,Re)},$)),this.data[Se].push(Re),this.order.push(Se),this.order.length>this.max){var Ze=this._getAndRemoveByKey(this.order[0]);Ze&&this.onRemove(Ze)}return this},pe.prototype.has=function(Y){return Y.wrapped().key in this.data},pe.prototype.getAndRemove=function(Y){return this.has(Y)?this._getAndRemoveByKey(Y.wrapped().key):null},pe.prototype._getAndRemoveByKey=function(Y){var he=this.data[Y].shift();return he.timeout&&clearTimeout(he.timeout),this.data[Y].length===0&&delete this.data[Y],this.order.splice(this.order.indexOf(Y),1),he.value},pe.prototype.getByKey=function(Y){var he=this.data[Y];return he?he[0].value:null},pe.prototype.get=function(Y){if(!this.has(Y))return null;var he=this.data[Y.wrapped().key][0];return he.value},pe.prototype.remove=function(Y,he){if(!this.has(Y))return this;var $=Y.wrapped().key,ve=he===void 0?0:this.data[$].indexOf(he),Se=this.data[$][ve];return this.data[$].splice(ve,1),Se.timeout&&clearTimeout(Se.timeout),this.data[$].length===0&&delete this.data[$],this.onRemove(Se.value),this.order.splice(this.order.indexOf($),1),this},pe.prototype.setMaxSize=function(Y){for(this.max=Y;this.order.length>this.max;){var he=this._getAndRemoveByKey(this.order[0]);he&&this.onRemove(he)}return this},pe.prototype.filter=function(Y){var he=[];for(var $ in this.data)for(var ve=0,Se=this.data[$];ve<Se.length;ve+=1){var Re=Se[ve];Y(Re.value)||he.push(Re)}for(var Ze=0,ut=he;Ze<ut.length;Ze+=1){var At=ut[Ze];this.remove(At.value.tileID,At)}};var xe=function(Y,he,$){this.context=Y;var ve=Y.gl;this.buffer=ve.createBuffer(),this.dynamicDraw=Boolean($),this.context.unbindVAO(),Y.bindElementBuffer.set(this.buffer),ve.bufferData(ve.ELEMENT_ARRAY_BUFFER,he.arrayBuffer,this.dynamicDraw?ve.DYNAMIC_DRAW:ve.STATIC_DRAW),this.dynamicDraw||delete he.arrayBuffer};xe.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},xe.prototype.updateData=function(Y){var he=this.context.gl;this.context.unbindVAO(),this.bind(),he.bufferSubData(he.ELEMENT_ARRAY_BUFFER,0,Y.arrayBuffer)},xe.prototype.destroy=function(){var Y=this.context.gl;this.buffer&&(Y.deleteBuffer(this.buffer),delete this.buffer)};var Ee={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Te=function(Y,he,$,ve){this.length=he.length,this.attributes=$,this.itemSize=he.bytesPerElement,this.dynamicDraw=ve,this.context=Y;var Se=Y.gl;this.buffer=Se.createBuffer(),Y.bindVertexBuffer.set(this.buffer),Se.bufferData(Se.ARRAY_BUFFER,he.arrayBuffer,this.dynamicDraw?Se.DYNAMIC_DRAW:Se.STATIC_DRAW),this.dynamicDraw||delete he.arrayBuffer};Te.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Te.prototype.updateData=function(Y){var he=this.context.gl;this.bind(),he.bufferSubData(he.ARRAY_BUFFER,0,Y.arrayBuffer)},Te.prototype.enableAttributes=function(Y,he){for(var $=0;$<this.attributes.length;$++){var ve=this.attributes[$],Se=he.attributes[ve.name];Se!==void 0&&Y.enableVertexAttribArray(Se)}},Te.prototype.setVertexAttribPointers=function(Y,he,$){for(var ve=0;ve<this.attributes.length;ve++){var Se=this.attributes[ve],Re=he.attributes[Se.name];Re!==void 0&&Y.vertexAttribPointer(Re,Se.components,Y[Ee[Se.type]],!1,this.itemSize,Se.offset+this.itemSize*($||0))}},Te.prototype.destroy=function(){var Y=this.context.gl;this.buffer&&(Y.deleteBuffer(this.buffer),delete this.buffer)};var de=function(Y){this.gl=Y.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};de.prototype.get=function(){return this.current},de.prototype.set=function(Y){},de.prototype.getDefault=function(){return this.default},de.prototype.setDefault=function(){this.set(this.default)};var be=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return e.Color.transparent},Y.prototype.set=function($){var ve=this.current;$.r===ve.r&&$.g===ve.g&&$.b===ve.b&&$.a===ve.a&&!this.dirty||(this.gl.clearColor($.r,$.g,$.b,$.a),this.current=$,this.dirty=!1)},Y}(de),Le=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return 1},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.clearDepth($),this.current=$,this.dirty=!1)},Y}(de),De=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return 0},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.clearStencil($),this.current=$,this.dirty=!1)},Y}(de),ye=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return[!0,!0,!0,!0]},Y.prototype.set=function($){var ve=this.current;$[0]===ve[0]&&$[1]===ve[1]&&$[2]===ve[2]&&$[3]===ve[3]&&!this.dirty||(this.gl.colorMask($[0],$[1],$[2],$[3]),this.current=$,this.dirty=!1)},Y}(de),ke=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return!0},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.depthMask($),this.current=$,this.dirty=!1)},Y}(de),Oe=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return 255},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.stencilMask($),this.current=$,this.dirty=!1)},Y}(de),Qe=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},Y.prototype.set=function($){var ve=this.current;$.func===ve.func&&$.ref===ve.ref&&$.mask===ve.mask&&!this.dirty||(this.gl.stencilFunc($.func,$.ref,$.mask),this.current=$,this.dirty=!1)},Y}(de),Ve=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){var $=this.gl;return[$.KEEP,$.KEEP,$.KEEP]},Y.prototype.set=function($){var ve=this.current;$[0]===ve[0]&&$[1]===ve[1]&&$[2]===ve[2]&&!this.dirty||(this.gl.stencilOp($[0],$[1],$[2]),this.current=$,this.dirty=!1)},Y}(de),Ue=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return!1},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;$?ve.enable(ve.STENCIL_TEST):ve.disable(ve.STENCIL_TEST),this.current=$,this.dirty=!1}},Y}(de),Ie=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return[0,1]},Y.prototype.set=function($){var ve=this.current;$[0]===ve[0]&&$[1]===ve[1]&&!this.dirty||(this.gl.depthRange($[0],$[1]),this.current=$,this.dirty=!1)},Y}(de),at=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return!1},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;$?ve.enable(ve.DEPTH_TEST):ve.disable(ve.DEPTH_TEST),this.current=$,this.dirty=!1}},Y}(de),pt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return this.gl.LESS},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.depthFunc($),this.current=$,this.dirty=!1)},Y}(de),Rt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return!1},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;$?ve.enable(ve.BLEND):ve.disable(ve.BLEND),this.current=$,this.dirty=!1}},Y}(de),Mt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){var $=this.gl;return[$.ONE,$.ZERO]},Y.prototype.set=function($){var ve=this.current;$[0]===ve[0]&&$[1]===ve[1]&&!this.dirty||(this.gl.blendFunc($[0],$[1]),this.current=$,this.dirty=!1)},Y}(de),It=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return e.Color.transparent},Y.prototype.set=function($){var ve=this.current;$.r===ve.r&&$.g===ve.g&&$.b===ve.b&&$.a===ve.a&&!this.dirty||(this.gl.blendColor($.r,$.g,$.b,$.a),this.current=$,this.dirty=!1)},Y}(de),Bt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return this.gl.FUNC_ADD},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.blendEquation($),this.current=$,this.dirty=!1)},Y}(de),St=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return!1},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;$?ve.enable(ve.CULL_FACE):ve.disable(ve.CULL_FACE),this.current=$,this.dirty=!1}},Y}(de),_t=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return this.gl.BACK},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.cullFace($),this.current=$,this.dirty=!1)},Y}(de),it=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return this.gl.CCW},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.frontFace($),this.current=$,this.dirty=!1)},Y}(de),ct=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return null},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.useProgram($),this.current=$,this.dirty=!1)},Y}(de),et=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return this.gl.TEXTURE0},Y.prototype.set=function($){$===this.current&&!this.dirty||(this.gl.activeTexture($),this.current=$,this.dirty=!1)},Y}(de),Pe=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){var $=this.gl;return[0,0,$.drawingBufferWidth,$.drawingBufferHeight]},Y.prototype.set=function($){var ve=this.current;$[0]===ve[0]&&$[1]===ve[1]&&$[2]===ve[2]&&$[3]===ve[3]&&!this.dirty||(this.gl.viewport($[0],$[1],$[2],$[3]),this.current=$,this.dirty=!1)},Y}(de),We=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return null},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;ve.bindFramebuffer(ve.FRAMEBUFFER,$),this.current=$,this.dirty=!1}},Y}(de),je=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return null},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;ve.bindRenderbuffer(ve.RENDERBUFFER,$),this.current=$,this.dirty=!1}},Y}(de),nt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return null},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;ve.bindTexture(ve.TEXTURE_2D,$),this.current=$,this.dirty=!1}},Y}(de),kt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return null},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;ve.bindBuffer(ve.ARRAY_BUFFER,$),this.current=$,this.dirty=!1}},Y}(de),wt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return null},Y.prototype.set=function($){var ve=this.gl;ve.bindBuffer(ve.ELEMENT_ARRAY_BUFFER,$),this.current=$,this.dirty=!1},Y}(de),Vt=function(fe){function Y(he){fe.call(this,he),this.vao=he.extVertexArrayObject}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return null},Y.prototype.set=function($){!this.vao||$===this.current&&!this.dirty||(this.vao.bindVertexArrayOES($),this.current=$,this.dirty=!1)},Y}(de),qt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return 4},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;ve.pixelStorei(ve.UNPACK_ALIGNMENT,$),this.current=$,this.dirty=!1}},Y}(de),zt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return!1},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;ve.pixelStorei(ve.UNPACK_PREMULTIPLY_ALPHA_WEBGL,$),this.current=$,this.dirty=!1}},Y}(de),Ht=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return!1},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){var ve=this.gl;ve.pixelStorei(ve.UNPACK_FLIP_Y_WEBGL,$),this.current=$,this.dirty=!1}},Y}(de),$t=function(fe){function Y(he,$){fe.call(this,he),this.context=he,this.parent=$}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getDefault=function(){return null},Y}(de),Qt=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.setDirty=function(){this.dirty=!0},Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var ve=this.gl;ve.framebufferTexture2D(ve.FRAMEBUFFER,ve.COLOR_ATTACHMENT0,ve.TEXTURE_2D,$,0),this.current=$,this.dirty=!1}},Y}($t),fr=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.set=function($){if(!($===this.current&&!this.dirty)){this.context.bindFramebuffer.set(this.parent);var ve=this.gl;ve.framebufferRenderbuffer(ve.FRAMEBUFFER,ve.DEPTH_ATTACHMENT,ve.RENDERBUFFER,$),this.current=$,this.dirty=!1}},Y}($t),jr=function(Y,he,$,ve){this.context=Y,this.width=he,this.height=$;var Se=Y.gl,Re=this.framebuffer=Se.createFramebuffer();this.colorAttachment=new Qt(Y,Re),ve&&(this.depthAttachment=new fr(Y,Re))};jr.prototype.destroy=function(){var Y=this.context.gl,he=this.colorAttachment.get();if(he&&Y.deleteTexture(he),this.depthAttachment){var $=this.depthAttachment.get();$&&Y.deleteRenderbuffer($)}Y.deleteFramebuffer(this.framebuffer)};var cn=519,Qr=function(Y,he,$){this.func=Y,this.mask=he,this.range=$};Qr.ReadOnly=!1,Qr.ReadWrite=!0,Qr.disabled=new Qr(cn,Qr.ReadOnly,[0,1]);var lt=519,Gt=7680,Kt=function(Y,he,$,ve,Se,Re){this.test=Y,this.ref=he,this.mask=$,this.fail=ve,this.depthFail=Se,this.pass=Re};Kt.disabled=new Kt({func:lt,mask:0},0,0,Gt,Gt,Gt);var Nt=0,gr=1,tt=771,we=function(Y,he,$){this.blendFunction=Y,this.blendColor=he,this.mask=$};we.Replace=[gr,Nt],we.disabled=new we(we.Replace,e.Color.transparent,[!1,!1,!1,!1]),we.unblended=new we(we.Replace,e.Color.transparent,[!0,!0,!0,!0]),we.alphaBlended=new we([gr,tt],e.Color.transparent,[!0,!0,!0,!0]);var Me=1029,Ne=2305,Xe=function(Y,he,$){this.enable=Y,this.mode=he,this.frontFace=$};Xe.disabled=new Xe(!1,Me,Ne),Xe.backCCW=new Xe(!0,Me,Ne);var Ke=function(Y){this.gl=Y,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new be(this),this.clearDepth=new Le(this),this.clearStencil=new De(this),this.colorMask=new ye(this),this.depthMask=new ke(this),this.stencilMask=new Oe(this),this.stencilFunc=new Qe(this),this.stencilOp=new Ve(this),this.stencilTest=new Ue(this),this.depthRange=new Ie(this),this.depthTest=new at(this),this.depthFunc=new pt(this),this.blend=new Rt(this),this.blendFunc=new Mt(this),this.blendColor=new It(this),this.blendEquation=new Bt(this),this.cullFace=new St(this),this.cullFaceSide=new _t(this),this.frontFace=new it(this),this.program=new ct(this),this.activeTexture=new et(this),this.viewport=new Pe(this),this.bindFramebuffer=new We(this),this.bindRenderbuffer=new je(this),this.bindTexture=new nt(this),this.bindVertexBuffer=new kt(this),this.bindElementBuffer=new wt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Vt(this),this.pixelStoreUnpack=new qt(this),this.pixelStoreUnpackPremultiplyAlpha=new zt(this),this.pixelStoreUnpackFlipY=new Ht(this),this.extTextureFilterAnisotropic=Y.getExtension("EXT_texture_filter_anisotropic")||Y.getExtension("MOZ_EXT_texture_filter_anisotropic")||Y.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=Y.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=Y.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(Y.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=Y.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=Y.getExtension("EXT_disjoint_timer_query")};Ke.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},Ke.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},Ke.prototype.createIndexBuffer=function(Y,he){return new xe(this,Y,he)},Ke.prototype.createVertexBuffer=function(Y,he,$){return new Te(this,Y,he,$)},Ke.prototype.createRenderbuffer=function(Y,he,$){var ve=this.gl,Se=ve.createRenderbuffer();return this.bindRenderbuffer.set(Se),ve.renderbufferStorage(ve.RENDERBUFFER,Y,he,$),this.bindRenderbuffer.set(null),Se},Ke.prototype.createFramebuffer=function(Y,he,$){return new jr(this,Y,he,$)},Ke.prototype.clear=function(Y){var he=Y.color,$=Y.depth,ve=this.gl,Se=0;he&&(Se|=ve.COLOR_BUFFER_BIT,this.clearColor.set(he),this.colorMask.set([!0,!0,!0,!0])),typeof $<"u"&&(Se|=ve.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set($),this.depthMask.set(!0)),ve.clear(Se)},Ke.prototype.setCullFace=function(Y){Y.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(Y.mode),this.frontFace.set(Y.frontFace))},Ke.prototype.setDepthMode=function(Y){Y.func===this.gl.ALWAYS&&!Y.mask?this.depthTest.set(!1):(this.depthTest.set(!0),this.depthFunc.set(Y.func),this.depthMask.set(Y.mask),this.depthRange.set(Y.range))},Ke.prototype.setStencilMode=function(Y){Y.test.func===this.gl.ALWAYS&&!Y.mask?this.stencilTest.set(!1):(this.stencilTest.set(!0),this.stencilMask.set(Y.mask),this.stencilOp.set([Y.fail,Y.depthFail,Y.pass]),this.stencilFunc.set({func:Y.test.func,ref:Y.ref,mask:Y.test.mask}))},Ke.prototype.setColorMode=function(Y){e.deepEqual(Y.blendFunction,we.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(Y.blendFunction),this.blendColor.set(Y.blendColor)),this.colorMask.set(Y.mask)},Ke.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var rt=function(fe){function Y(he,$,ve){var Se=this;fe.call(this),this.id=he,this.dispatcher=ve,this.on("data",function(Re){Re.dataType==="source"&&Re.sourceDataType==="metadata"&&(Se._sourceLoaded=!0),Se._sourceLoaded&&!Se._paused&&Re.dataType==="source"&&Re.sourceDataType==="content"&&(Se.reload(),Se.transform&&Se.update(Se.transform))}),this.on("error",function(){Se._sourceErrored=!0}),this._source=H(he,$,ve,this),this._tiles={},this._cache=new pe(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.onAdd=function($){this.map=$,this._maxTileCacheSize=$?$._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd($)},Y.prototype.onRemove=function($){this._source&&this._source.onRemove&&this._source.onRemove($)},Y.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var $ in this._tiles){var ve=this._tiles[$];if(ve.state!=="loaded"&&ve.state!=="errored")return!1}return!0},Y.prototype.getSource=function(){return this._source},Y.prototype.pause=function(){this._paused=!0},Y.prototype.resume=function(){if(!!this._paused){var $=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,$&&this.reload(),this.transform&&this.update(this.transform)}},Y.prototype._loadTile=function($,ve){return this._source.loadTile($,ve)},Y.prototype._unloadTile=function($){if(this._source.unloadTile)return this._source.unloadTile($,function(){})},Y.prototype._abortTile=function($){if(this._source.abortTile)return this._source.abortTile($,function(){})},Y.prototype.serialize=function(){return this._source.serialize()},Y.prototype.prepare=function($){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(var ve in this._tiles){var Se=this._tiles[ve];Se.upload($),Se.prepare(this.map.style.imageManager)}},Y.prototype.getIds=function(){return e.values(this._tiles).map(function($){return $.tileID}).sort(Je).map(function($){return $.key})},Y.prototype.getRenderableIds=function($){var ve=this,Se=[];for(var Re in this._tiles)this._isIdRenderable(Re,$)&&Se.push(this._tiles[Re]);return $?Se.sort(function(Ze,ut){var At=Ze.tileID,Ut=ut.tileID,nr=new e.Point(At.canonical.x,At.canonical.y)._rotate(ve.transform.angle),sr=new e.Point(Ut.canonical.x,Ut.canonical.y)._rotate(ve.transform.angle);return At.overscaledZ-Ut.overscaledZ||sr.y-nr.y||sr.x-nr.x}).map(function(Ze){return Ze.tileID.key}):Se.map(function(Ze){return Ze.tileID}).sort(Je).map(function(Ze){return Ze.key})},Y.prototype.hasRenderableParent=function($){var ve=this.findLoadedParent($,0);return ve?this._isIdRenderable(ve.tileID.key):!1},Y.prototype._isIdRenderable=function($,ve){return this._tiles[$]&&this._tiles[$].hasData()&&!this._coveredTiles[$]&&(ve||!this._tiles[$].holdingForFade())},Y.prototype.reload=function(){if(this._paused){this._shouldReloadOnResume=!0;return}this._cache.reset();for(var $ in this._tiles)this._tiles[$].state!=="errored"&&this._reloadTile($,"reloading")},Y.prototype._reloadTile=function($,ve){var Se=this._tiles[$];!Se||(Se.state!=="loading"&&(Se.state=ve),this._loadTile(Se,this._tileLoaded.bind(this,Se,$,ve)))},Y.prototype._tileLoaded=function($,ve,Se,Re){if(Re){$.state="errored",Re.status!==404?this._source.fire(new e.ErrorEvent(Re,{tile:$})):this.update(this.transform);return}$.timeAdded=e.browser.now(),Se==="expired"&&($.refreshedUponExpiration=!0),this._setTileReloadTimer(ve,$),this.getSource().type==="raster-dem"&&$.dem&&this._backfillDEM($),this._state.initializeTileState($,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:$,coord:$.tileID}))},Y.prototype._backfillDEM=function($){for(var ve=this.getRenderableIds(),Se=0;Se<ve.length;Se++){var Re=ve[Se];if($.neighboringTiles&&$.neighboringTiles[Re]){var Ze=this.getTileByID(Re);ut($,Ze),ut(Ze,$)}}function ut(At,Ut){At.needsHillshadePrepare=!0;var nr=Ut.tileID.canonical.x-At.tileID.canonical.x,sr=Ut.tileID.canonical.y-At.tileID.canonical.y,Tr=Math.pow(2,At.tileID.canonical.z),Ur=Ut.tileID.key;nr===0&&sr===0||Math.abs(sr)>1||(Math.abs(nr)>1&&(Math.abs(nr+Tr)===1?nr+=Tr:Math.abs(nr-Tr)===1&&(nr-=Tr)),!(!Ut.dem||!At.dem)&&(At.dem.backfillBorder(Ut.dem,nr,sr),At.neighboringTiles&&At.neighboringTiles[Ur]&&(At.neighboringTiles[Ur].backfilled=!0)))}},Y.prototype.getTile=function($){return this.getTileByID($.key)},Y.prototype.getTileByID=function($){return this._tiles[$]},Y.prototype._retainLoadedChildren=function($,ve,Se,Re){for(var Ze in this._tiles){var ut=this._tiles[Ze];if(!(Re[Ze]||!ut.hasData()||ut.tileID.overscaledZ<=ve||ut.tileID.overscaledZ>Se)){for(var At=ut.tileID;ut&&ut.tileID.overscaledZ>ve+1;){var Ut=ut.tileID.scaledTo(ut.tileID.overscaledZ-1);ut=this._tiles[Ut.key],ut&&ut.hasData()&&(At=Ut)}for(var nr=At;nr.overscaledZ>ve;)if(nr=nr.scaledTo(nr.overscaledZ-1),$[nr.key]){Re[At.key]=At;break}}}},Y.prototype.findLoadedParent=function($,ve){if($.key in this._loadedParentTiles){var Se=this._loadedParentTiles[$.key];return Se&&Se.tileID.overscaledZ>=ve?Se:null}for(var Re=$.overscaledZ-1;Re>=ve;Re--){var Ze=$.scaledTo(Re),ut=this._getLoadedTile(Ze);if(ut)return ut}},Y.prototype._getLoadedTile=function($){var ve=this._tiles[$.key];if(ve&&ve.hasData())return ve;var Se=this._cache.getByKey($.wrapped().key);return Se},Y.prototype.updateCacheSize=function($){var ve=Math.ceil($.width/this._source.tileSize)+1,Se=Math.ceil($.height/this._source.tileSize)+1,Re=ve*Se,Ze=5,ut=Math.floor(Re*Ze),At=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ut):ut;this._cache.setMaxSize(At)},Y.prototype.handleWrapJump=function($){var ve=this._prevLng===void 0?$:this._prevLng,Se=$-ve,Re=Se/360,Ze=Math.round(Re);if(this._prevLng=$,Ze){var ut={};for(var At in this._tiles){var Ut=this._tiles[At];Ut.tileID=Ut.tileID.unwrapTo(Ut.tileID.wrap+Ze),ut[Ut.tileID.key]=Ut}this._tiles=ut;for(var nr in this._timers)clearTimeout(this._timers[nr]),delete this._timers[nr];for(var sr in this._tiles){var Tr=this._tiles[sr];this._setTileReloadTimer(sr,Tr)}}},Y.prototype.update=function($){var ve=this;if(this.transform=$,!(!this._sourceLoaded||this._paused)){this.updateCacheSize($),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={};var Se;this.used?this._source.tileID?Se=$.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(ma){return new e.OverscaledTileID(ma.canonical.z,ma.wrap,ma.canonical.z,ma.canonical.x,ma.canonical.y)}):(Se=$.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(Se=Se.filter(function(ma){return ve._source.hasTile(ma)}))):Se=[];var Re=$.coveringZoomLevel(this._source),Ze=Math.max(Re-Y.maxOverzooming,this._source.minzoom),ut=Math.max(Re+Y.maxUnderzooming,this._source.minzoom),At=this._updateRetainedTiles(Se,Re);if(vt(this._source.type)){for(var Ut={},nr={},sr=Object.keys(At),Tr=0,Ur=sr;Tr<Ur.length;Tr+=1){var Hr=Ur[Tr],Fr=At[Hr],Zr=this._tiles[Hr];if(!(!Zr||Zr.fadeEndTime&&Zr.fadeEndTime<=e.browser.now())){var fn=this.findLoadedParent(Fr,Ze);fn&&(this._addTile(fn.tileID),Ut[fn.tileID.key]=fn.tileID),nr[Hr]=Fr}}this._retainLoadedChildren(nr,Re,ut,At);for(var En in Ut)At[En]||(this._coveredTiles[En]=!0,At[En]=Ut[En])}for(var Nn in At)this._tiles[Nn].clearFadeHold();for(var jn=e.keysDifference(this._tiles,At),Qn=0,Kn=jn;Qn<Kn.length;Qn+=1){var ha=Kn[Qn],xa=this._tiles[ha];xa.hasSymbolBuckets&&!xa.holdingForFade()?xa.setHoldDuration(this.map._fadeDuration):(!xa.hasSymbolBuckets||xa.symbolFadeFinished())&&this._removeTile(ha)}this._updateLoadedParentTileCache()}},Y.prototype.releaseSymbolFadeTiles=function(){for(var $ in this._tiles)this._tiles[$].holdingForFade()&&this._removeTile($)},Y.prototype._updateRetainedTiles=function($,ve){for(var Se={},Re={},Ze=Math.max(ve-Y.maxOverzooming,this._source.minzoom),ut=Math.max(ve+Y.maxUnderzooming,this._source.minzoom),At={},Ut=0,nr=$;Ut<nr.length;Ut+=1){var sr=nr[Ut],Tr=this._addTile(sr);Se[sr.key]=sr,!Tr.hasData()&&ve<this._source.maxzoom&&(At[sr.key]=sr)}this._retainLoadedChildren(At,ve,ut,Se);for(var Ur=0,Hr=$;Ur<Hr.length;Ur+=1){var Fr=Hr[Ur],Zr=this._tiles[Fr.key];if(!Zr.hasData()){if(ve+1>this._source.maxzoom){var fn=Fr.children(this._source.maxzoom)[0],En=this.getTile(fn);if(!!En&&En.hasData()){Se[fn.key]=fn;continue}}else{var Nn=Fr.children(this._source.maxzoom);if(Se[Nn[0].key]&&Se[Nn[1].key]&&Se[Nn[2].key]&&Se[Nn[3].key])continue}for(var jn=Zr.wasRequested(),Qn=Fr.overscaledZ-1;Qn>=Ze;--Qn){var Kn=Fr.scaledTo(Qn);if(Re[Kn.key]||(Re[Kn.key]=!0,Zr=this.getTile(Kn),!Zr&&jn&&(Zr=this._addTile(Kn)),Zr&&(Se[Kn.key]=Kn,jn=Zr.wasRequested(),Zr.hasData())))break}}}return Se},Y.prototype._updateLoadedParentTileCache=function(){this._loadedParentTiles={};for(var $ in this._tiles){for(var ve=[],Se=void 0,Re=this._tiles[$].tileID;Re.overscaledZ>0;){if(Re.key in this._loadedParentTiles){Se=this._loadedParentTiles[Re.key];break}ve.push(Re.key);var Ze=Re.scaledTo(Re.overscaledZ-1);if(Se=this._getLoadedTile(Ze),Se)break;Re=Ze}for(var ut=0,At=ve;ut<At.length;ut+=1){var Ut=At[ut];this._loadedParentTiles[Ut]=Se}}},Y.prototype._addTile=function($){var ve=this._tiles[$.key];if(ve)return ve;ve=this._cache.getAndRemove($),ve&&(this._setTileReloadTimer($.key,ve),ve.tileID=$,this._state.initializeTileState(ve,this.map?this.map.painter:null),this._cacheTimers[$.key]&&(clearTimeout(this._cacheTimers[$.key]),delete this._cacheTimers[$.key],this._setTileReloadTimer($.key,ve)));var Se=Boolean(ve);return Se||(ve=new e.Tile($,this._source.tileSize*$.overscaleFactor()),this._loadTile(ve,this._tileLoaded.bind(this,ve,$.key,ve.state))),ve?(ve.uses++,this._tiles[$.key]=ve,Se||this._source.fire(new e.Event("dataloading",{tile:ve,coord:ve.tileID,dataType:"source"})),ve):null},Y.prototype._setTileReloadTimer=function($,ve){var Se=this;$ in this._timers&&(clearTimeout(this._timers[$]),delete this._timers[$]);var Re=ve.getExpiryTimeout();Re&&(this._timers[$]=setTimeout(function(){Se._reloadTile($,"expired"),delete Se._timers[$]},Re))},Y.prototype._removeTile=function($){var ve=this._tiles[$];!ve||(ve.uses--,delete this._tiles[$],this._timers[$]&&(clearTimeout(this._timers[$]),delete this._timers[$]),!(ve.uses>0)&&(ve.hasData()&&ve.state!=="reloading"?this._cache.add(ve.tileID,ve,ve.getExpiryTimeout()):(ve.aborted=!0,this._abortTile(ve),this._unloadTile(ve))))},Y.prototype.clearTiles=function(){this._shouldReloadOnResume=!1,this._paused=!1;for(var $ in this._tiles)this._removeTile($);this._cache.reset()},Y.prototype.tilesIn=function($,ve,Se){var Re=this,Ze=[],ut=this.transform;if(!ut)return Ze;for(var At=Se?ut.getCameraQueryGeometry($):$,Ut=$.map(function(Qn){return ut.pointCoordinate(Qn)}),nr=At.map(function(Qn){return ut.pointCoordinate(Qn)}),sr=this.getIds(),Tr=1/0,Ur=1/0,Hr=-1/0,Fr=-1/0,Zr=0,fn=nr;Zr<fn.length;Zr+=1){var En=fn[Zr];Tr=Math.min(Tr,En.x),Ur=Math.min(Ur,En.y),Hr=Math.max(Hr,En.x),Fr=Math.max(Fr,En.y)}for(var Nn=function(Qn){var Kn=Re._tiles[sr[Qn]];if(!Kn.holdingForFade()){var ha=Kn.tileID,xa=Math.pow(2,ut.zoom-Kn.tileID.overscaledZ),ma=ve*Kn.queryPadding*e.EXTENT/Kn.tileSize/xa,Ta=[ha.getTilePoint(new e.MercatorCoordinate(Tr,Ur)),ha.getTilePoint(new e.MercatorCoordinate(Hr,Fr))];if(Ta[0].x-ma<e.EXTENT&&Ta[0].y-ma<e.EXTENT&&Ta[1].x+ma>=0&&Ta[1].y+ma>=0){var Pa=Ut.map(function(ai){return ha.getTilePoint(ai)}),Za=nr.map(function(ai){return ha.getTilePoint(ai)});Ze.push({tile:Kn,tileID:ha,queryGeometry:Pa,cameraQueryGeometry:Za,scale:xa})}}},jn=0;jn<sr.length;jn++)Nn(jn);return Ze},Y.prototype.getVisibleCoordinates=function($){for(var ve=this,Se=this.getRenderableIds($).map(function(At){return ve._tiles[At].tileID}),Re=0,Ze=Se;Re<Ze.length;Re+=1){var ut=Ze[Re];ut.posMatrix=this.transform.calculatePosMatrix(ut.toUnwrapped())}return Se},Y.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(vt(this._source.type))for(var $ in this._tiles){var ve=this._tiles[$];if(ve.fadeEndTime!==void 0&&ve.fadeEndTime>=e.browser.now())return!0}return!1},Y.prototype.setFeatureState=function($,ve,Se){$=$||"_geojsonTileLayer",this._state.updateState($,ve,Se)},Y.prototype.removeFeatureState=function($,ve,Se){$=$||"_geojsonTileLayer",this._state.removeFeatureState($,ve,Se)},Y.prototype.getFeatureState=function($,ve){return $=$||"_geojsonTileLayer",this._state.getState($,ve)},Y.prototype.setDependencies=function($,ve,Se){var Re=this._tiles[$];Re&&Re.setDependencies(ve,Se)},Y.prototype.reloadTilesForDependencies=function($,ve){for(var Se in this._tiles){var Re=this._tiles[Se];Re.hasDependency($,ve)&&this._reloadTile(Se,"reloading")}this._cache.filter(function(Ze){return!Ze.hasDependency($,ve)})},Y}(e.Evented);rt.maxOverzooming=10,rt.maxUnderzooming=3;function Je(fe,Y){var he=Math.abs(fe.wrap*2)-+(fe.wrap<0),$=Math.abs(Y.wrap*2)-+(Y.wrap<0);return fe.overscaledZ-Y.overscaledZ||$-he||Y.canonical.y-fe.canonical.y||Y.canonical.x-fe.canonical.x}function vt(fe){return fe==="raster"||fe==="image"||fe==="video"}function bt(){return new e.window.Worker(Pc.workerUrl)}var Et="mapboxgl_preloaded_worker_pool",Wt=function(){this.active={}};Wt.prototype.acquire=function(Y){if(!this.workers)for(this.workers=[];this.workers.length<Wt.workerCount;)this.workers.push(new bt);return this.active[Y]=!0,this.workers.slice()},Wt.prototype.release=function(Y){delete this.active[Y],this.numActive()===0&&(this.workers.forEach(function(he){he.terminate()}),this.workers=null)},Wt.prototype.isPreloaded=function(){return!!this.active[Et]},Wt.prototype.numActive=function(){return Object.keys(this.active).length};var Ot=Math.floor(e.browser.hardwareConcurrency/2);Wt.workerCount=Math.max(Math.min(Ot,6),1);var ir;function vr(){return ir||(ir=new Wt),ir}function _r(){var fe=vr();fe.acquire(Et)}function ln(){var fe=ir;fe&&(fe.isPreloaded()&&fe.numActive()===1?(fe.release(Et),ir=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))}function Cr(fe,Y){var he={};for(var $ in fe)$!=="ref"&&(he[$]=fe[$]);return e.refProperties.forEach(function(ve){ve in Y&&(he[ve]=Y[ve])}),he}function Gr(fe){fe=fe.slice();for(var Y=Object.create(null),he=0;he<fe.length;he++)Y[fe[he].id]=fe[he];for(var $=0;$<fe.length;$++)"ref"in fe[$]&&(fe[$]=Cr(fe[$],Y[fe[$].ref]));return fe}function sn(){var fe={},Y=e.styleSpec.$version;for(var he in e.styleSpec.$root){var $=e.styleSpec.$root[he];if($.required){var ve=null;he==="version"?ve=Y:$.type==="array"?ve=[]:ve={},ve!=null&&(fe[he]=ve)}}return fe}var yr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function mr(fe,Y,he){he.push({command:yr.addSource,args:[fe,Y[fe]]})}function Or(fe,Y,he){Y.push({command:yr.removeSource,args:[fe]}),he[fe]=!0}function zr(fe,Y,he,$){Or(fe,he,$),mr(fe,Y,he)}function Sr(fe,Y,he){var $;for($ in fe[he])if(!!fe[he].hasOwnProperty($)&&$!=="data"&&!e.deepEqual(fe[he][$],Y[he][$]))return!1;for($ in Y[he])if(!!Y[he].hasOwnProperty($)&&$!=="data"&&!e.deepEqual(fe[he][$],Y[he][$]))return!1;return!0}function ot(fe,Y,he,$){fe=fe||{},Y=Y||{};var ve;for(ve in fe)!fe.hasOwnProperty(ve)||Y.hasOwnProperty(ve)||Or(ve,he,$);for(ve in Y)!Y.hasOwnProperty(ve)||(fe.hasOwnProperty(ve)?e.deepEqual(fe[ve],Y[ve])||(fe[ve].type==="geojson"&&Y[ve].type==="geojson"&&Sr(fe,Y,ve)?he.push({command:yr.setGeoJSONSourceData,args:[ve,Y[ve].data]}):zr(ve,Y,he,$)):mr(ve,Y,he))}function Lt(fe,Y,he,$,ve,Se){fe=fe||{},Y=Y||{};var Re;for(Re in fe)!fe.hasOwnProperty(Re)||e.deepEqual(fe[Re],Y[Re])||he.push({command:Se,args:[$,Re,Y[Re],ve]});for(Re in Y)!Y.hasOwnProperty(Re)||fe.hasOwnProperty(Re)||e.deepEqual(fe[Re],Y[Re])||he.push({command:Se,args:[$,Re,Y[Re],ve]})}function Xt(fe){return fe.id}function tr(fe,Y){return fe[Y.id]=Y,fe}function Lr(fe,Y,he){fe=fe||[],Y=Y||[];var $=fe.map(Xt),ve=Y.map(Xt),Se=fe.reduce(tr,{}),Re=Y.reduce(tr,{}),Ze=$.slice(),ut=Object.create(null),At,Ut,nr,sr,Tr,Ur,Hr;for(At=0,Ut=0;At<$.length;At++)nr=$[At],Re.hasOwnProperty(nr)?Ut++:(he.push({command:yr.removeLayer,args:[nr]}),Ze.splice(Ze.indexOf(nr,Ut),1));for(At=0,Ut=0;At<ve.length;At++)nr=ve[ve.length-1-At],Ze[Ze.length-1-At]!==nr&&(Se.hasOwnProperty(nr)?(he.push({command:yr.removeLayer,args:[nr]}),Ze.splice(Ze.lastIndexOf(nr,Ze.length-Ut),1)):Ut++,Ur=Ze[Ze.length-At],he.push({command:yr.addLayer,args:[Re[nr],Ur]}),Ze.splice(Ze.length-At,0,nr),ut[nr]=!0);for(At=0;At<ve.length;At++)if(nr=ve[At],sr=Se[nr],Tr=Re[nr],!(ut[nr]||e.deepEqual(sr,Tr))){if(!e.deepEqual(sr.source,Tr.source)||!e.deepEqual(sr["source-layer"],Tr["source-layer"])||!e.deepEqual(sr.type,Tr.type)){he.push({command:yr.removeLayer,args:[nr]}),Ur=Ze[Ze.lastIndexOf(nr)+1],he.push({command:yr.addLayer,args:[Tr,Ur]});continue}Lt(sr.layout,Tr.layout,he,nr,null,yr.setLayoutProperty),Lt(sr.paint,Tr.paint,he,nr,null,yr.setPaintProperty),e.deepEqual(sr.filter,Tr.filter)||he.push({command:yr.setFilter,args:[nr,Tr.filter]}),(!e.deepEqual(sr.minzoom,Tr.minzoom)||!e.deepEqual(sr.maxzoom,Tr.maxzoom))&&he.push({command:yr.setLayerZoomRange,args:[nr,Tr.minzoom,Tr.maxzoom]});for(Hr in sr)!sr.hasOwnProperty(Hr)||Hr==="layout"||Hr==="paint"||Hr==="filter"||Hr==="metadata"||Hr==="minzoom"||Hr==="maxzoom"||(Hr.indexOf("paint.")===0?Lt(sr[Hr],Tr[Hr],he,nr,Hr.slice(6),yr.setPaintProperty):e.deepEqual(sr[Hr],Tr[Hr])||he.push({command:yr.setLayerProperty,args:[nr,Hr,Tr[Hr]]}));for(Hr in Tr)!Tr.hasOwnProperty(Hr)||sr.hasOwnProperty(Hr)||Hr==="layout"||Hr==="paint"||Hr==="filter"||Hr==="metadata"||Hr==="minzoom"||Hr==="maxzoom"||(Hr.indexOf("paint.")===0?Lt(sr[Hr],Tr[Hr],he,nr,Hr.slice(6),yr.setPaintProperty):e.deepEqual(sr[Hr],Tr[Hr])||he.push({command:yr.setLayerProperty,args:[nr,Hr,Tr[Hr]]}))}}function Nr(fe,Y){if(!fe)return[{command:yr.setStyle,args:[Y]}];var he=[];try{if(!e.deepEqual(fe.version,Y.version))return[{command:yr.setStyle,args:[Y]}];e.deepEqual(fe.center,Y.center)||he.push({command:yr.setCenter,args:[Y.center]}),e.deepEqual(fe.zoom,Y.zoom)||he.push({command:yr.setZoom,args:[Y.zoom]}),e.deepEqual(fe.bearing,Y.bearing)||he.push({command:yr.setBearing,args:[Y.bearing]}),e.deepEqual(fe.pitch,Y.pitch)||he.push({command:yr.setPitch,args:[Y.pitch]}),e.deepEqual(fe.sprite,Y.sprite)||he.push({command:yr.setSprite,args:[Y.sprite]}),e.deepEqual(fe.glyphs,Y.glyphs)||he.push({command:yr.setGlyphs,args:[Y.glyphs]}),e.deepEqual(fe.transition,Y.transition)||he.push({command:yr.setTransition,args:[Y.transition]}),e.deepEqual(fe.light,Y.light)||he.push({command:yr.setLight,args:[Y.light]});var $={},ve=[];ot(fe.sources,Y.sources,ve,$);var Se=[];fe.layers&&fe.layers.forEach(function(Re){$[Re.source]?he.push({command:yr.removeLayer,args:[Re.id]}):Se.push(Re)}),he=he.concat(ve),Lr(Se,Y.layers,he)}catch(Re){console.warn("Unable to compute style diff:",Re),he=[{command:yr.setStyle,args:[Y]}]}return he}var Rr=function(Y,he){this.reset(Y,he)};Rr.prototype.reset=function(Y,he){this.points=Y||[],this._distances=[0];for(var $=1;$<this.points.length;$++)this._distances[$]=this._distances[$-1]+this.points[$].dist(this.points[$-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(he||0,this.length*.5),this.paddedLength=this.length-this.padding*2},Rr.prototype.lerp=function(Y){if(this.points.length===1)return this.points[0];Y=e.clamp(Y,0,1);for(var he=1,$=this._distances[he],ve=Y*this.paddedLength+this.padding;$<ve&&he<this._distances.length;)$=this._distances[++he];var Se=he-1,Re=this._distances[Se],Ze=$-Re,ut=Ze>0?(ve-Re)/Ze:0;return this.points[Se].mult(1-ut).add(this.points[he].mult(ut))};var Ar=function(Y,he,$){var ve=this.boxCells=[],Se=this.circleCells=[];this.xCellCount=Math.ceil(Y/$),this.yCellCount=Math.ceil(he/$);for(var Re=0;Re<this.xCellCount*this.yCellCount;Re++)ve.push([]),Se.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=Y,this.height=he,this.xScale=this.xCellCount/Y,this.yScale=this.yCellCount/he,this.boxUid=0,this.circleUid=0};Ar.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Ar.prototype.insert=function(Y,he,$,ve,Se){this._forEachCell(he,$,ve,Se,this._insertBoxCell,this.boxUid++),this.boxKeys.push(Y),this.bboxes.push(he),this.bboxes.push($),this.bboxes.push(ve),this.bboxes.push(Se)},Ar.prototype.insertCircle=function(Y,he,$,ve){this._forEachCell(he-ve,$-ve,he+ve,$+ve,this._insertCircleCell,this.circleUid++),this.circleKeys.push(Y),this.circles.push(he),this.circles.push($),this.circles.push(ve)},Ar.prototype._insertBoxCell=function(Y,he,$,ve,Se,Re){this.boxCells[Se].push(Re)},Ar.prototype._insertCircleCell=function(Y,he,$,ve,Se,Re){this.circleCells[Se].push(Re)},Ar.prototype._query=function(Y,he,$,ve,Se,Re){if($<0||Y>this.width||ve<0||he>this.height)return Se?!1:[];var Ze=[];if(Y<=0&&he<=0&&this.width<=$&&this.height<=ve){if(Se)return!0;for(var ut=0;ut<this.boxKeys.length;ut++)Ze.push({key:this.boxKeys[ut],x1:this.bboxes[ut*4],y1:this.bboxes[ut*4+1],x2:this.bboxes[ut*4+2],y2:this.bboxes[ut*4+3]});for(var At=0;At<this.circleKeys.length;At++){var Ut=this.circles[At*3],nr=this.circles[At*3+1],sr=this.circles[At*3+2];Ze.push({key:this.circleKeys[At],x1:Ut-sr,y1:nr-sr,x2:Ut+sr,y2:nr+sr})}return Re?Ze.filter(Re):Ze}else{var Tr={hitTest:Se,seenUids:{box:{},circle:{}}};return this._forEachCell(Y,he,$,ve,this._queryCell,Ze,Tr,Re),Se?Ze.length>0:Ze}},Ar.prototype._queryCircle=function(Y,he,$,ve,Se){var Re=Y-$,Ze=Y+$,ut=he-$,At=he+$;if(Ze<0||Re>this.width||At<0||ut>this.height)return ve?!1:[];var Ut=[],nr={hitTest:ve,circle:{x:Y,y:he,radius:$},seenUids:{box:{},circle:{}}};return this._forEachCell(Re,ut,Ze,At,this._queryCellCircle,Ut,nr,Se),ve?Ut.length>0:Ut},Ar.prototype.query=function(Y,he,$,ve,Se){return this._query(Y,he,$,ve,!1,Se)},Ar.prototype.hitTest=function(Y,he,$,ve,Se){return this._query(Y,he,$,ve,!0,Se)},Ar.prototype.hitTestCircle=function(Y,he,$,ve){return this._queryCircle(Y,he,$,!0,ve)},Ar.prototype._queryCell=function(Y,he,$,ve,Se,Re,Ze,ut){var At=Ze.seenUids,Ut=this.boxCells[Se];if(Ut!==null)for(var nr=this.bboxes,sr=0,Tr=Ut;sr<Tr.length;sr+=1){var Ur=Tr[sr];if(!At.box[Ur]){At.box[Ur]=!0;var Hr=Ur*4;if(Y<=nr[Hr+2]&&he<=nr[Hr+3]&&$>=nr[Hr+0]&&ve>=nr[Hr+1]&&(!ut||ut(this.boxKeys[Ur]))){if(Ze.hitTest)return Re.push(!0),!0;Re.push({key:this.boxKeys[Ur],x1:nr[Hr],y1:nr[Hr+1],x2:nr[Hr+2],y2:nr[Hr+3]})}}}var Fr=this.circleCells[Se];if(Fr!==null)for(var Zr=this.circles,fn=0,En=Fr;fn<En.length;fn+=1){var Nn=En[fn];if(!At.circle[Nn]){At.circle[Nn]=!0;var jn=Nn*3;if(this._circleAndRectCollide(Zr[jn],Zr[jn+1],Zr[jn+2],Y,he,$,ve)&&(!ut||ut(this.circleKeys[Nn]))){if(Ze.hitTest)return Re.push(!0),!0;var Qn=Zr[jn],Kn=Zr[jn+1],ha=Zr[jn+2];Re.push({key:this.circleKeys[Nn],x1:Qn-ha,y1:Kn-ha,x2:Qn+ha,y2:Kn+ha})}}}},Ar.prototype._queryCellCircle=function(Y,he,$,ve,Se,Re,Ze,ut){var At=Ze.circle,Ut=Ze.seenUids,nr=this.boxCells[Se];if(nr!==null)for(var sr=this.bboxes,Tr=0,Ur=nr;Tr<Ur.length;Tr+=1){var Hr=Ur[Tr];if(!Ut.box[Hr]){Ut.box[Hr]=!0;var Fr=Hr*4;if(this._circleAndRectCollide(At.x,At.y,At.radius,sr[Fr+0],sr[Fr+1],sr[Fr+2],sr[Fr+3])&&(!ut||ut(this.boxKeys[Hr])))return Re.push(!0),!0}}var Zr=this.circleCells[Se];if(Zr!==null)for(var fn=this.circles,En=0,Nn=Zr;En<Nn.length;En+=1){var jn=Nn[En];if(!Ut.circle[jn]){Ut.circle[jn]=!0;var Qn=jn*3;if(this._circlesCollide(fn[Qn],fn[Qn+1],fn[Qn+2],At.x,At.y,At.radius)&&(!ut||ut(this.circleKeys[jn])))return Re.push(!0),!0}}},Ar.prototype._forEachCell=function(Y,he,$,ve,Se,Re,Ze,ut){for(var At=this._convertToXCellCoord(Y),Ut=this._convertToYCellCoord(he),nr=this._convertToXCellCoord($),sr=this._convertToYCellCoord(ve),Tr=At;Tr<=nr;Tr++)for(var Ur=Ut;Ur<=sr;Ur++){var Hr=this.xCellCount*Ur+Tr;if(Se.call(this,Y,he,$,ve,Hr,Re,Ze,ut))return}},Ar.prototype._convertToXCellCoord=function(Y){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(Y*this.xScale)))},Ar.prototype._convertToYCellCoord=function(Y){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(Y*this.yScale)))},Ar.prototype._circlesCollide=function(Y,he,$,ve,Se,Re){var Ze=ve-Y,ut=Se-he,At=$+Re;return At*At>Ze*Ze+ut*ut},Ar.prototype._circleAndRectCollide=function(Y,he,$,ve,Se,Re,Ze){var ut=(Re-ve)/2,At=Math.abs(Y-(ve+ut));if(At>ut+$)return!1;var Ut=(Ze-Se)/2,nr=Math.abs(he-(Se+Ut));if(nr>Ut+$)return!1;if(At<=ut||nr<=Ut)return!0;var sr=At-ut,Tr=nr-Ut;return sr*sr+Tr*Tr<=$*$};function Kr(fe,Y,he,$,ve){var Se=e.create();return Y?(e.scale(Se,Se,[1/ve,1/ve,1]),he||e.rotateZ(Se,Se,$.angle)):e.multiply(Se,$.labelPlaneMatrix,fe),Se}function Dn(fe,Y,he,$,ve){if(Y){var Se=e.clone(fe);return e.scale(Se,Se,[ve,ve,1]),he||e.rotateZ(Se,Se,-$.angle),Se}else return $.glCoordMatrix}function Sn(fe,Y){var he=[fe.x,fe.y,0,1];wr(he,he,Y);var $=he[3];return{point:new e.Point(he[0]/$,he[1]/$),signedDistanceFromCamera:$}}function Jn(fe,Y){return .5+.5*(fe/Y)}function Bn(fe,Y){var he=fe[0]/fe[3],$=fe[1]/fe[3],ve=he>=-Y[0]&&he<=Y[0]&&$>=-Y[1]&&$<=Y[1];return ve}function Xn(fe,Y,he,$,ve,Se,Re,Ze){var ut=$?fe.textSizeData:fe.iconSizeData,At=e.evaluateSizeForZoom(ut,he.transform.zoom),Ut=[256/he.width*2+1,256/he.height*2+1],nr=$?fe.text.dynamicLayoutVertexArray:fe.icon.dynamicLayoutVertexArray;nr.clear();for(var sr=fe.lineVertexArray,Tr=$?fe.text.placedSymbolArray:fe.icon.placedSymbolArray,Ur=he.transform.width/he.transform.height,Hr=!1,Fr=0;Fr<Tr.length;Fr++){var Zr=Tr.get(Fr);if(Zr.hidden||Zr.writingMode===e.WritingMode.vertical&&!Hr){Ka(Zr.numGlyphs,nr);continue}Hr=!1;var fn=[Zr.anchorX,Zr.anchorY,0,1];if(e.transformMat4(fn,fn,Y),!Bn(fn,Ut)){Ka(Zr.numGlyphs,nr);continue}var En=fn[3],Nn=Jn(he.transform.cameraToCenterDistance,En),jn=e.evaluateSizeForFeature(ut,At,Zr),Qn=Re?jn/Nn:jn*Nn,Kn=new e.Point(Zr.anchorX,Zr.anchorY),ha=Sn(Kn,ve).point,xa={},ma=Ya(Zr,Qn,!1,Ze,Y,ve,Se,fe.glyphOffsetArray,sr,nr,ha,Kn,xa,Ur);Hr=ma.useVertical,(ma.notEnoughRoom||Hr||ma.needsFlipping&&Ya(Zr,Qn,!0,Ze,Y,ve,Se,fe.glyphOffsetArray,sr,nr,ha,Kn,xa,Ur).notEnoughRoom)&&Ka(Zr.numGlyphs,nr)}$?fe.text.dynamicLayoutVertexBuffer.updateData(nr):fe.icon.dynamicLayoutVertexBuffer.updateData(nr)}function ea(fe,Y,he,$,ve,Se,Re,Ze,ut,At,Ut){var nr=Ze.glyphStartIndex+Ze.numGlyphs,sr=Ze.lineStartIndex,Tr=Ze.lineStartIndex+Ze.lineLength,Ur=Y.getoffsetX(Ze.glyphStartIndex),Hr=Y.getoffsetX(nr-1),Fr=pi(fe*Ur,he,$,ve,Se,Re,Ze.segment,sr,Tr,ut,At,Ut);if(!Fr)return null;var Zr=pi(fe*Hr,he,$,ve,Se,Re,Ze.segment,sr,Tr,ut,At,Ut);return Zr?{first:Fr,last:Zr}:null}function ka(fe,Y,he,$){if(fe===e.WritingMode.horizontal){var ve=Math.abs(he.y-Y.y),Se=Math.abs(he.x-Y.x)*$;if(ve>Se)return{useVertical:!0}}return(fe===e.WritingMode.vertical?Y.y<he.y:Y.x>he.x)?{needsFlipping:!0}:null}function Ya(fe,Y,he,$,ve,Se,Re,Ze,ut,At,Ut,nr,sr,Tr){var Ur=Y/24,Hr=fe.lineOffsetX*Ur,Fr=fe.lineOffsetY*Ur,Zr;if(fe.numGlyphs>1){var fn=fe.glyphStartIndex+fe.numGlyphs,En=fe.lineStartIndex,Nn=fe.lineStartIndex+fe.lineLength,jn=ea(Ur,Ze,Hr,Fr,he,Ut,nr,fe,ut,Se,sr);if(!jn)return{notEnoughRoom:!0};var Qn=Sn(jn.first.point,Re).point,Kn=Sn(jn.last.point,Re).point;if($&&!he){var ha=ka(fe.writingMode,Qn,Kn,Tr);if(ha)return ha}Zr=[jn.first];for(var xa=fe.glyphStartIndex+1;xa<fn-1;xa++)Zr.push(pi(Ur*Ze.getoffsetX(xa),Hr,Fr,he,Ut,nr,fe.segment,En,Nn,ut,Se,sr));Zr.push(jn.last)}else{if($&&!he){var ma=Sn(nr,ve).point,Ta=fe.lineStartIndex+fe.segment+1,Pa=new e.Point(ut.getx(Ta),ut.gety(Ta)),Za=Sn(Pa,ve),ai=Za.signedDistanceFromCamera>0?Za.point:fi(nr,Pa,ma,1,ve),Ni=ka(fe.writingMode,ma,ai,Tr);if(Ni)return Ni}var ui=pi(Ur*Ze.getoffsetX(fe.glyphStartIndex),Hr,Fr,he,Ut,nr,fe.segment,fe.lineStartIndex,fe.lineStartIndex+fe.lineLength,ut,Se,sr);if(!ui)return{notEnoughRoom:!0};Zr=[ui]}for(var wi=0,Va=Zr;wi<Va.length;wi+=1){var Ui=Va[wi];e.addDynamicAttributes(At,Ui.point,Ui.angle)}return{}}function fi(fe,Y,he,$,ve){var Se=Sn(fe.add(fe.sub(Y)._unit()),ve).point,Re=he.sub(Se);return he.add(Re._mult($/Re.mag()))}function pi(fe,Y,he,$,ve,Se,Re,Ze,ut,At,Ut,nr){var sr=$?fe-Y:fe+Y,Tr=sr>0?1:-1,Ur=0;$&&(Tr*=-1,Ur=Math.PI),Tr<0&&(Ur+=Math.PI);for(var Hr=Tr>0?Ze+Re:Ze+Re+1,Fr=ve,Zr=ve,fn=0,En=0,Nn=Math.abs(sr),jn=[];fn+En<=Nn;){if(Hr+=Tr,Hr<Ze||Hr>=ut)return null;if(Zr=Fr,jn.push(Fr),Fr=nr[Hr],Fr===void 0){var Qn=new e.Point(At.getx(Hr),At.gety(Hr)),Kn=Sn(Qn,Ut);if(Kn.signedDistanceFromCamera>0)Fr=nr[Hr]=Kn.point;else{var ha=Hr-Tr,xa=fn===0?Se:new e.Point(At.getx(ha),At.gety(ha));Fr=fi(xa,Qn,Zr,Nn-fn+1,Ut)}}fn+=En,En=Zr.dist(Fr)}var ma=(Nn-fn)/En,Ta=Fr.sub(Zr),Pa=Ta.mult(ma)._add(Zr);Pa._add(Ta._unit()._perp()._mult(he*Tr));var Za=Ur+Math.atan2(Fr.y-Zr.y,Fr.x-Zr.x);return jn.push(Pa),{point:Pa,angle:Za,path:jn}}var hi=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ka(fe,Y){for(var he=0;he<fe;he++){var $=Y.length;Y.resize($+4),Y.float32.set(hi,$*3)}}function wr(fe,Y,he){var $=Y[0],ve=Y[1];return fe[0]=he[0]*$+he[4]*ve+he[12],fe[1]=he[1]*$+he[5]*ve+he[13],fe[3]=he[3]*$+he[7]*ve+he[15],fe}var gn=100,hn=function(Y,he,$){he===void 0&&(he=new Ar(Y.width+2*gn,Y.height+2*gn,25)),$===void 0&&($=new Ar(Y.width+2*gn,Y.height+2*gn,25)),this.transform=Y,this.grid=he,this.ignoredGrid=$,this.pitchfactor=Math.cos(Y._pitch)*Y.cameraToCenterDistance,this.screenRightBoundary=Y.width+gn,this.screenBottomBoundary=Y.height+gn,this.gridRightBoundary=Y.width+2*gn,this.gridBottomBoundary=Y.height+2*gn};hn.prototype.placeCollisionBox=function(Y,he,$,ve,Se){var Re=this.projectAndGetPerspectiveRatio(ve,Y.anchorPointX,Y.anchorPointY),Ze=$*Re.perspectiveRatio,ut=Y.x1*Ze+Re.point.x,At=Y.y1*Ze+Re.point.y,Ut=Y.x2*Ze+Re.point.x,nr=Y.y2*Ze+Re.point.y;return!this.isInsideGrid(ut,At,Ut,nr)||!he&&this.grid.hitTest(ut,At,Ut,nr,Se)?{box:[],offscreen:!1}:{box:[ut,At,Ut,nr],offscreen:this.isOffscreen(ut,At,Ut,nr)}},hn.prototype.placeCollisionCircles=function(Y,he,$,ve,Se,Re,Ze,ut,At,Ut,nr,sr,Tr){var Ur=[],Hr=new e.Point(he.anchorX,he.anchorY),Fr=Sn(Hr,Re),Zr=Jn(this.transform.cameraToCenterDistance,Fr.signedDistanceFromCamera),fn=Ut?Se/Zr:Se*Zr,En=fn/e.ONE_EM,Nn=Sn(Hr,Ze).point,jn={},Qn=he.lineOffsetX*En,Kn=he.lineOffsetY*En,ha=ea(En,ve,Qn,Kn,!1,Nn,Hr,he,$,Ze,jn),xa=!1,ma=!1,Ta=!0;if(ha){for(var Pa=sr*.5*Zr+Tr,Za=new e.Point(-gn,-gn),ai=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),Ni=new Rr,ui=ha.first,wi=ha.last,Va=[],Ui=ui.path.length-1;Ui>=1;Ui--)Va.push(ui.path[Ui]);for(var Gi=1;Gi<wi.path.length;Gi++)Va.push(wi.path[Gi]);var Wi=Pa*2.5;if(ut){var Ci=Va.map(function(vu){return Sn(vu,ut)});Ci.some(function(vu){return vu.signedDistanceFromCamera<=0})?Va=[]:Va=Ci.map(function(vu){return vu.point})}var $i=[];if(Va.length>0){for(var oi=Va[0].clone(),Li=Va[0].clone(),Ao=1;Ao<Va.length;Ao++)oi.x=Math.min(oi.x,Va[Ao].x),oi.y=Math.min(oi.y,Va[Ao].y),Li.x=Math.max(Li.x,Va[Ao].x),Li.y=Math.max(Li.y,Va[Ao].y);oi.x>=Za.x&&Li.x<=ai.x&&oi.y>=Za.y&&Li.y<=ai.y?$i=[Va]:Li.x<Za.x||oi.x>ai.x||Li.y<Za.y||oi.y>ai.y?$i=[]:$i=e.clipLine([Va],Za.x,Za.y,ai.x,ai.y)}for(var Oo=0,Dl=$i;Oo<Dl.length;Oo+=1){var Rl=Dl[Oo];Ni.reset(Rl,Pa*.25);var uu=0;Ni.length<=.5*Pa?uu=1:uu=Math.ceil(Ni.paddedLength/Wi)+1;for(var fu=0;fu<uu;fu++){var Au=fu/Math.max(uu-1,1),cu=Ni.lerp(Au),Ns=cu.x+gn,Wu=cu.y+gn;Ur.push(Ns,Wu,Pa,0);var bs=Ns-Pa,bl=Wu-Pa,hu=Ns+Pa,jl=Wu+Pa;if(Ta=Ta&&this.isOffscreen(bs,bl,hu,jl),ma=ma||this.isInsideGrid(bs,bl,hu,jl),!Y&&this.grid.hitTestCircle(Ns,Wu,Pa,nr)&&(xa=!0,!At))return{circles:[],offscreen:!1,collisionDetected:xa}}}}return{circles:!At&&xa||!ma?[]:Ur,offscreen:Ta,collisionDetected:xa}},hn.prototype.queryRenderedSymbols=function(Y){if(Y.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var he=[],$=1/0,ve=1/0,Se=-1/0,Re=-1/0,Ze=0,ut=Y;Ze<ut.length;Ze+=1){var At=ut[Ze],Ut=new e.Point(At.x+gn,At.y+gn);$=Math.min($,Ut.x),ve=Math.min(ve,Ut.y),Se=Math.max(Se,Ut.x),Re=Math.max(Re,Ut.y),he.push(Ut)}for(var nr=this.grid.query($,ve,Se,Re).concat(this.ignoredGrid.query($,ve,Se,Re)),sr={},Tr={},Ur=0,Hr=nr;Ur<Hr.length;Ur+=1){var Fr=Hr[Ur],Zr=Fr.key;if(sr[Zr.bucketInstanceId]===void 0&&(sr[Zr.bucketInstanceId]={}),!sr[Zr.bucketInstanceId][Zr.featureIndex]){var fn=[new e.Point(Fr.x1,Fr.y1),new e.Point(Fr.x2,Fr.y1),new e.Point(Fr.x2,Fr.y2),new e.Point(Fr.x1,Fr.y2)];!e.polygonIntersectsPolygon(he,fn)||(sr[Zr.bucketInstanceId][Zr.featureIndex]=!0,Tr[Zr.bucketInstanceId]===void 0&&(Tr[Zr.bucketInstanceId]=[]),Tr[Zr.bucketInstanceId].push(Zr.featureIndex))}}return Tr},hn.prototype.insertCollisionBox=function(Y,he,$,ve,Se){var Re=he?this.ignoredGrid:this.grid,Ze={bucketInstanceId:$,featureIndex:ve,collisionGroupID:Se};Re.insert(Ze,Y[0],Y[1],Y[2],Y[3])},hn.prototype.insertCollisionCircles=function(Y,he,$,ve,Se){for(var Re=he?this.ignoredGrid:this.grid,Ze={bucketInstanceId:$,featureIndex:ve,collisionGroupID:Se},ut=0;ut<Y.length;ut+=4)Re.insertCircle(Ze,Y[ut],Y[ut+1],Y[ut+2])},hn.prototype.projectAndGetPerspectiveRatio=function(Y,he,$){var ve=[he,$,0,1];wr(ve,ve,Y);var Se=new e.Point((ve[0]/ve[3]+1)/2*this.transform.width+gn,(-ve[1]/ve[3]+1)/2*this.transform.height+gn);return{point:Se,perspectiveRatio:.5+.5*(this.transform.cameraToCenterDistance/ve[3])}},hn.prototype.isOffscreen=function(Y,he,$,ve){return $<gn||Y>=this.screenRightBoundary||ve<gn||he>this.screenBottomBoundary},hn.prototype.isInsideGrid=function(Y,he,$,ve){return $>=0&&Y<this.gridRightBoundary&&ve>=0&&he<this.gridBottomBoundary},hn.prototype.getViewportMatrix=function(){var Y=e.identity([]);return e.translate(Y,Y,[-gn,-gn,0]),Y};function Tn(fe,Y,he){return Y*(e.EXTENT/(fe.tileSize*Math.pow(2,he-fe.tileID.overscaledZ)))}var Vn=function(Y,he,$,ve){Y?this.opacity=Math.max(0,Math.min(1,Y.opacity+(Y.placed?he:-he))):this.opacity=ve&&$?1:0,this.placed=$};Vn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var oa=function(Y,he,$,ve,Se){this.text=new Vn(Y?Y.text:null,he,$,Se),this.icon=new Vn(Y?Y.icon:null,he,ve,Se)};oa.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var na=function(Y,he,$){this.text=Y,this.icon=he,this.skipFade=$},On=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},ta=function(Y,he,$,ve,Se){this.bucketInstanceId=Y,this.featureIndex=he,this.sourceLayerIndex=$,this.bucketIndex=ve,this.tileID=Se},Ua=function(Y){this.crossSourceCollisions=Y,this.maxGroupID=0,this.collisionGroups={}};Ua.prototype.get=function(Y){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[Y]){var he=++this.maxGroupID;this.collisionGroups[Y]={ID:he,predicate:function($){return $.collisionGroupID===he}}}return this.collisionGroups[Y]};function di(fe,Y,he,$,ve){var Se=e.getAnchorAlignment(fe),Re=Se.horizontalAlign,Ze=Se.verticalAlign,ut=-(Re-.5)*Y,At=-(Ze-.5)*he,Ut=e.evaluateVariableOffset(fe,$);return new e.Point(ut+Ut[0]*ve,At+Ut[1]*ve)}function Ft(fe,Y,he,$,ve,Se){var Re=fe.x1,Ze=fe.x2,ut=fe.y1,At=fe.y2,Ut=fe.anchorPointX,nr=fe.anchorPointY,sr=new e.Point(Y,he);return $&&sr._rotate(ve?Se:-Se),{x1:Re+sr.x,y1:ut+sr.y,x2:Ze+sr.x,y2:At+sr.y,anchorPointX:Ut,anchorPointY:nr}}var cr=function(Y,he,$,ve){this.transform=Y.clone(),this.collisionIndex=new hn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=he,this.retainedQueryData={},this.collisionGroups=new Ua($),this.collisionCircleArrays={},this.prevPlacement=ve,ve&&(ve.prevPlacement=void 0),this.placedOrientations={}};cr.prototype.getBucketParts=function(Y,he,$,ve){var Se=$.getBucket(he),Re=$.latestFeatureIndex;if(!(!Se||!Re||he.id!==Se.layerIds[0])){var Ze=$.collisionBoxArray,ut=Se.layers[0].layout,At=Math.pow(2,this.transform.zoom-$.tileID.overscaledZ),Ut=$.tileSize/e.EXTENT,nr=this.transform.calculatePosMatrix($.tileID.toUnwrapped()),sr=ut.get("text-pitch-alignment")==="map",Tr=ut.get("text-rotation-alignment")==="map",Ur=Tn($,1,this.transform.zoom),Hr=Kr(nr,sr,Tr,this.transform,Ur),Fr=null;if(sr){var Zr=Dn(nr,sr,Tr,this.transform,Ur);Fr=e.multiply([],this.transform.labelPlaneMatrix,Zr)}this.retainedQueryData[Se.bucketInstanceId]=new ta(Se.bucketInstanceId,Re,Se.sourceLayerIndex,Se.index,$.tileID);var fn={bucket:Se,layout:ut,posMatrix:nr,textLabelPlaneMatrix:Hr,labelToScreenMatrix:Fr,scale:At,textPixelRatio:Ut,holdingForFade:$.holdingForFade(),collisionBoxArray:Ze,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(Se.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(Se.sourceID)};if(ve)for(var En=0,Nn=Se.sortKeyRanges;En<Nn.length;En+=1){var jn=Nn[En],Qn=jn.sortKey,Kn=jn.symbolInstanceStart,ha=jn.symbolInstanceEnd;Y.push({sortKey:Qn,symbolInstanceStart:Kn,symbolInstanceEnd:ha,parameters:fn})}else Y.push({symbolInstanceStart:0,symbolInstanceEnd:Se.symbolInstances.length,parameters:fn})}},cr.prototype.attemptAnchorPlacement=function(Y,he,$,ve,Se,Re,Ze,ut,At,Ut,nr,sr,Tr,Ur,Hr){var Fr=[sr.textOffset0,sr.textOffset1],Zr=di(Y,$,ve,Fr,Se),fn=this.collisionIndex.placeCollisionBox(Ft(he,Zr.x,Zr.y,Re,Ze,this.transform.angle),nr,ut,At,Ut.predicate);if(Hr){var En=this.collisionIndex.placeCollisionBox(Ft(Hr,Zr.x,Zr.y,Re,Ze,this.transform.angle),nr,ut,At,Ut.predicate);if(En.box.length===0)return}if(fn.box.length>0){var Nn;return this.prevPlacement&&this.prevPlacement.variableOffsets[sr.crossTileID]&&this.prevPlacement.placements[sr.crossTileID]&&this.prevPlacement.placements[sr.crossTileID].text&&(Nn=this.prevPlacement.variableOffsets[sr.crossTileID].anchor),this.variableOffsets[sr.crossTileID]={textOffset:Fr,width:$,height:ve,anchor:Y,textBoxScale:Se,prevAnchor:Nn},this.markUsedJustification(Tr,Y,sr,Ur),Tr.allowVerticalPlacement&&(this.markUsedOrientation(Tr,Ur,sr),this.placedOrientations[sr.crossTileID]=Ur),{shift:Zr,placedGlyphBoxes:fn}}},cr.prototype.placeLayerBucketPart=function(Y,he,$){var ve=this,Se=Y.parameters,Re=Se.bucket,Ze=Se.layout,ut=Se.posMatrix,At=Se.textLabelPlaneMatrix,Ut=Se.labelToScreenMatrix,nr=Se.textPixelRatio,sr=Se.holdingForFade,Tr=Se.collisionBoxArray,Ur=Se.partiallyEvaluatedTextSize,Hr=Se.collisionGroup,Fr=Ze.get("text-optional"),Zr=Ze.get("icon-optional"),fn=Ze.get("text-allow-overlap"),En=Ze.get("icon-allow-overlap"),Nn=Ze.get("text-rotation-alignment")==="map",jn=Ze.get("text-pitch-alignment")==="map",Qn=Ze.get("icon-text-fit")!=="none",Kn=Ze.get("symbol-z-order")==="viewport-y",ha=fn&&(En||!Re.hasIconData()||Zr),xa=En&&(fn||!Re.hasTextData()||Fr);!Re.collisionArrays&&Tr&&Re.deserializeCollisionBoxes(Tr);var ma=function(ui,wi){if(!he[ui.crossTileID]){if(sr){ve.placements[ui.crossTileID]=new na(!1,!1,!1);return}var Va=!1,Ui=!1,Gi=!0,Wi=null,Ci={box:null,offscreen:null},$i={box:null,offscreen:null},oi=null,Li=null,Ao=null,Oo=0,Dl=0,Rl=0;wi.textFeatureIndex?Oo=wi.textFeatureIndex:ui.useRuntimeCollisionCircles&&(Oo=ui.featureIndex),wi.verticalTextFeatureIndex&&(Dl=wi.verticalTextFeatureIndex);var uu=wi.textBox;if(uu){var fu=function(Do){var tl=e.WritingMode.horizontal;if(Re.allowVerticalPlacement&&!Do&&ve.prevPlacement){var rl=ve.prevPlacement.placedOrientations[ui.crossTileID];rl&&(ve.placedOrientations[ui.crossTileID]=rl,tl=rl,ve.markUsedOrientation(Re,tl,ui))}return tl},Au=function(Do,tl){if(Re.allowVerticalPlacement&&ui.numVerticalGlyphVertices>0&&wi.verticalTextBox)for(var rl=0,Ff=Re.writingModes;rl<Ff.length;rl+=1){var lc=Ff[rl];if(lc===e.WritingMode.vertical?(Ci=tl(),$i=Ci):Ci=Do(),Ci&&Ci.box&&Ci.box.length)break}else Ci=Do()};if(Ze.get("text-variable-anchor")){var bs=Ze.get("text-variable-anchor");if(ve.prevPlacement&&ve.prevPlacement.variableOffsets[ui.crossTileID]){var bl=ve.prevPlacement.variableOffsets[ui.crossTileID];bs.indexOf(bl.anchor)>0&&(bs=bs.filter(function(Do){return Do!==bl.anchor}),bs.unshift(bl.anchor))}var hu=function(Do,tl,rl){for(var Ff=Do.x2-Do.x1,lc=Do.y2-Do.y1,th=ui.textBoxScale,rh=Qn&&!En?tl:null,Tf={box:[],offscreen:!1},nh=fn?bs.length*2:bs.length,Of=0;Of<nh;++Of){var ah=bs[Of%bs.length],ih=Of>=bs.length,uc=ve.attemptAnchorPlacement(ah,Do,Ff,lc,th,Nn,jn,nr,ut,Hr,ih,ui,Re,rl,rh);if(uc&&(Tf=uc.placedGlyphBoxes,Tf&&Tf.box&&Tf.box.length)){Va=!0,Wi=uc.shift;break}}return Tf},jl=function(){return hu(uu,wi.iconBox,e.WritingMode.horizontal)},vu=function(){var Do=wi.verticalTextBox,tl=Ci&&Ci.box&&Ci.box.length;return Re.allowVerticalPlacement&&!tl&&ui.numVerticalGlyphVertices>0&&Do?hu(Do,wi.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}};Au(jl,vu),Ci&&(Va=Ci.box,Gi=Ci.offscreen);var Df=fu(Ci&&Ci.box);if(!Va&&ve.prevPlacement){var $u=ve.prevPlacement.variableOffsets[ui.crossTileID];$u&&(ve.variableOffsets[ui.crossTileID]=$u,ve.markUsedJustification(Re,$u.anchor,ui,Df))}}else{var cu=function(Do,tl){var rl=ve.collisionIndex.placeCollisionBox(Do,fn,nr,ut,Hr.predicate);return rl&&rl.box&&rl.box.length&&(ve.markUsedOrientation(Re,tl,ui),ve.placedOrientations[ui.crossTileID]=tl),rl},Ns=function(){return cu(uu,e.WritingMode.horizontal)},Wu=function(){var Do=wi.verticalTextBox;return Re.allowVerticalPlacement&&ui.numVerticalGlyphVertices>0&&Do?cu(Do,e.WritingMode.vertical):{box:null,offscreen:null}};Au(Ns,Wu),fu(Ci&&Ci.box&&Ci.box.length)}}if(oi=Ci,Va=oi&&oi.box&&oi.box.length>0,Gi=oi&&oi.offscreen,ui.useRuntimeCollisionCircles){var us=Re.text.placedSymbolArray.get(ui.centerJustifiedTextSymbolIndex),_f=e.evaluateSizeForFeature(Re.textSizeData,Ur,us),ks=Ze.get("text-padding"),wf=ui.collisionCircleDiameter;Li=ve.collisionIndex.placeCollisionCircles(fn,us,Re.lineVertexArray,Re.glyphOffsetArray,_f,ut,At,Ut,$,jn,Hr.predicate,wf,ks),Va=fn||Li.circles.length>0&&!Li.collisionDetected,Gi=Gi&&Li.offscreen}if(wi.iconFeatureIndex&&(Rl=wi.iconFeatureIndex),wi.iconBox){var Rf=function(Do){var tl=Qn&&Wi?Ft(Do,Wi.x,Wi.y,Nn,jn,ve.transform.angle):Do;return ve.collisionIndex.placeCollisionBox(tl,En,nr,ut,Hr.predicate)};$i&&$i.box&&$i.box.length&&wi.verticalIconBox?(Ao=Rf(wi.verticalIconBox),Ui=Ao.box.length>0):(Ao=Rf(wi.iconBox),Ui=Ao.box.length>0),Gi=Gi&&Ao.offscreen}var If=Fr||ui.numHorizontalGlyphVertices===0&&ui.numVerticalGlyphVertices===0,Dc=Zr||ui.numIconVertices===0;if(!If&&!Dc?Ui=Va=Ui&&Va:Dc?If||(Ui=Ui&&Va):Va=Ui&&Va,Va&&oi&&oi.box&&($i&&$i.box&&Dl?ve.collisionIndex.insertCollisionBox(oi.box,Ze.get("text-ignore-placement"),Re.bucketInstanceId,Dl,Hr.ID):ve.collisionIndex.insertCollisionBox(oi.box,Ze.get("text-ignore-placement"),Re.bucketInstanceId,Oo,Hr.ID)),Ui&&Ao&&ve.collisionIndex.insertCollisionBox(Ao.box,Ze.get("icon-ignore-placement"),Re.bucketInstanceId,Rl,Hr.ID),Li&&(Va&&ve.collisionIndex.insertCollisionCircles(Li.circles,Ze.get("text-ignore-placement"),Re.bucketInstanceId,Oo,Hr.ID),$)){var zf=Re.bucketInstanceId,ff=ve.collisionCircleArrays[zf];ff===void 0&&(ff=ve.collisionCircleArrays[zf]=new On);for(var cf=0;cf<Li.circles.length;cf+=4)ff.circles.push(Li.circles[cf+0]),ff.circles.push(Li.circles[cf+1]),ff.circles.push(Li.circles[cf+2]),ff.circles.push(Li.collisionDetected?1:0)}ve.placements[ui.crossTileID]=new na(Va||ha,Ui||xa,Gi||Re.justReloaded),he[ui.crossTileID]=!0}};if(Kn)for(var Ta=Re.getSortedSymbolIndexes(this.transform.angle),Pa=Ta.length-1;Pa>=0;--Pa){var Za=Ta[Pa];ma(Re.symbolInstances.get(Za),Re.collisionArrays[Za])}else for(var ai=Y.symbolInstanceStart;ai<Y.symbolInstanceEnd;ai++)ma(Re.symbolInstances.get(ai),Re.collisionArrays[ai]);if($&&Re.bucketInstanceId in this.collisionCircleArrays){var Ni=this.collisionCircleArrays[Re.bucketInstanceId];e.invert(Ni.invProjMatrix,ut),Ni.viewportMatrix=this.collisionIndex.getViewportMatrix()}Re.justReloaded=!1},cr.prototype.markUsedJustification=function(Y,he,$,ve){var Se={left:$.leftJustifiedTextSymbolIndex,center:$.centerJustifiedTextSymbolIndex,right:$.rightJustifiedTextSymbolIndex},Re;ve===e.WritingMode.vertical?Re=$.verticalPlacedTextSymbolIndex:Re=Se[e.getAnchorJustification(he)];for(var Ze=[$.leftJustifiedTextSymbolIndex,$.centerJustifiedTextSymbolIndex,$.rightJustifiedTextSymbolIndex,$.verticalPlacedTextSymbolIndex],ut=0,At=Ze;ut<At.length;ut+=1){var Ut=At[ut];Ut>=0&&(Re>=0&&Ut!==Re?Y.text.placedSymbolArray.get(Ut).crossTileID=0:Y.text.placedSymbolArray.get(Ut).crossTileID=$.crossTileID)}},cr.prototype.markUsedOrientation=function(Y,he,$){for(var ve=he===e.WritingMode.horizontal||he===e.WritingMode.horizontalOnly?he:0,Se=he===e.WritingMode.vertical?he:0,Re=[$.leftJustifiedTextSymbolIndex,$.centerJustifiedTextSymbolIndex,$.rightJustifiedTextSymbolIndex],Ze=0,ut=Re;Ze<ut.length;Ze+=1){var At=ut[Ze];Y.text.placedSymbolArray.get(At).placedOrientation=ve}$.verticalPlacedTextSymbolIndex&&(Y.text.placedSymbolArray.get($.verticalPlacedTextSymbolIndex).placedOrientation=Se)},cr.prototype.commit=function(Y){this.commitTime=Y,this.zoomAtLastRecencyCheck=this.transform.zoom;var he=this.prevPlacement,$=!1;this.prevZoomAdjustment=he?he.zoomAdjustment(this.transform.zoom):0;var ve=he?he.symbolFadeChange(Y):1,Se=he?he.opacities:{},Re=he?he.variableOffsets:{},Ze=he?he.placedOrientations:{};for(var ut in this.placements){var At=this.placements[ut],Ut=Se[ut];Ut?(this.opacities[ut]=new oa(Ut,ve,At.text,At.icon),$=$||At.text!==Ut.text.placed||At.icon!==Ut.icon.placed):(this.opacities[ut]=new oa(null,ve,At.text,At.icon,At.skipFade),$=$||At.text||At.icon)}for(var nr in Se){var sr=Se[nr];if(!this.opacities[nr]){var Tr=new oa(sr,ve,!1,!1);Tr.isHidden()||(this.opacities[nr]=Tr,$=$||sr.text.placed||sr.icon.placed)}}for(var Ur in Re)!this.variableOffsets[Ur]&&this.opacities[Ur]&&!this.opacities[Ur].isHidden()&&(this.variableOffsets[Ur]=Re[Ur]);for(var Hr in Ze)!this.placedOrientations[Hr]&&this.opacities[Hr]&&!this.opacities[Hr].isHidden()&&(this.placedOrientations[Hr]=Ze[Hr]);$?this.lastPlacementChangeTime=Y:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=he?he.lastPlacementChangeTime:Y)},cr.prototype.updateLayerOpacities=function(Y,he){for(var $={},ve=0,Se=he;ve<Se.length;ve+=1){var Re=Se[ve],Ze=Re.getBucket(Y);Ze&&Re.latestFeatureIndex&&Y.id===Ze.layerIds[0]&&this.updateBucketOpacities(Ze,$,Re.collisionBoxArray)}},cr.prototype.updateBucketOpacities=function(Y,he,$){var ve=this;Y.hasTextData()&&Y.text.opacityVertexArray.clear(),Y.hasIconData()&&Y.icon.opacityVertexArray.clear(),Y.hasIconCollisionBoxData()&&Y.iconCollisionBox.collisionVertexArray.clear(),Y.hasTextCollisionBoxData()&&Y.textCollisionBox.collisionVertexArray.clear();var Se=Y.layers[0].layout,Re=new oa(null,0,!1,!1,!0),Ze=Se.get("text-allow-overlap"),ut=Se.get("icon-allow-overlap"),At=Se.get("text-variable-anchor"),Ut=Se.get("text-rotation-alignment")==="map",nr=Se.get("text-pitch-alignment")==="map",sr=Se.get("icon-text-fit")!=="none",Tr=new oa(null,0,Ze&&(ut||!Y.hasIconData()||Se.get("icon-optional")),ut&&(Ze||!Y.hasTextData()||Se.get("text-optional")),!0);!Y.collisionArrays&&$&&(Y.hasIconCollisionBoxData()||Y.hasTextCollisionBoxData())&&Y.deserializeCollisionBoxes($);for(var Ur=function(fn,En,Nn){for(var jn=0;jn<En/4;jn++)fn.opacityVertexArray.emplaceBack(Nn)},Hr=function(fn){var En=Y.symbolInstances.get(fn),Nn=En.numHorizontalGlyphVertices,jn=En.numVerticalGlyphVertices,Qn=En.crossTileID,Kn=he[Qn],ha=ve.opacities[Qn];Kn?ha=Re:ha||(ha=Tr,ve.opacities[Qn]=ha),he[Qn]=!0;var xa=Nn>0||jn>0,ma=En.numIconVertices>0,Ta=ve.placedOrientations[En.crossTileID],Pa=Ta===e.WritingMode.vertical,Za=Ta===e.WritingMode.horizontal||Ta===e.WritingMode.horizontalOnly;if(xa){var ai=Pr(ha.text),Ni=Pa?dn:ai;Ur(Y.text,Nn,Ni);var ui=Za?dn:ai;Ur(Y.text,jn,ui);var wi=ha.text.isHidden();[En.rightJustifiedTextSymbolIndex,En.centerJustifiedTextSymbolIndex,En.leftJustifiedTextSymbolIndex].forEach(function(Rl){Rl>=0&&(Y.text.placedSymbolArray.get(Rl).hidden=wi||Pa?1:0)}),En.verticalPlacedTextSymbolIndex>=0&&(Y.text.placedSymbolArray.get(En.verticalPlacedTextSymbolIndex).hidden=wi||Za?1:0);var Va=ve.variableOffsets[En.crossTileID];Va&&ve.markUsedJustification(Y,Va.anchor,En,Ta);var Ui=ve.placedOrientations[En.crossTileID];Ui&&(ve.markUsedJustification(Y,"left",En,Ui),ve.markUsedOrientation(Y,Ui,En))}if(ma){var Gi=Pr(ha.icon),Wi=!(sr&&En.verticalPlacedIconSymbolIndex&&Pa);if(En.placedIconSymbolIndex>=0){var Ci=Wi?Gi:dn;Ur(Y.icon,En.numIconVertices,Ci),Y.icon.placedSymbolArray.get(En.placedIconSymbolIndex).hidden=ha.icon.isHidden()}if(En.verticalPlacedIconSymbolIndex>=0){var $i=Wi?dn:Gi;Ur(Y.icon,En.numVerticalIconVertices,$i),Y.icon.placedSymbolArray.get(En.verticalPlacedIconSymbolIndex).hidden=ha.icon.isHidden()}}if(Y.hasIconCollisionBoxData()||Y.hasTextCollisionBoxData()){var oi=Y.collisionArrays[fn];if(oi){var Li=new e.Point(0,0);if(oi.textBox||oi.verticalTextBox){var Ao=!0;if(At){var Oo=ve.variableOffsets[Qn];Oo?(Li=di(Oo.anchor,Oo.width,Oo.height,Oo.textOffset,Oo.textBoxScale),Ut&&Li._rotate(nr?ve.transform.angle:-ve.transform.angle)):Ao=!1}oi.textBox&&nn(Y.textCollisionBox.collisionVertexArray,ha.text.placed,!Ao||Pa,Li.x,Li.y),oi.verticalTextBox&&nn(Y.textCollisionBox.collisionVertexArray,ha.text.placed,!Ao||Za,Li.x,Li.y)}var Dl=Boolean(!Za&&oi.verticalIconBox);oi.iconBox&&nn(Y.iconCollisionBox.collisionVertexArray,ha.icon.placed,Dl,sr?Li.x:0,sr?Li.y:0),oi.verticalIconBox&&nn(Y.iconCollisionBox.collisionVertexArray,ha.icon.placed,!Dl,sr?Li.x:0,sr?Li.y:0)}}},Fr=0;Fr<Y.symbolInstances.length;Fr++)Hr(Fr);if(Y.sortFeatures(this.transform.angle),this.retainedQueryData[Y.bucketInstanceId]&&(this.retainedQueryData[Y.bucketInstanceId].featureSortOrder=Y.featureSortOrder),Y.hasTextData()&&Y.text.opacityVertexBuffer&&Y.text.opacityVertexBuffer.updateData(Y.text.opacityVertexArray),Y.hasIconData()&&Y.icon.opacityVertexBuffer&&Y.icon.opacityVertexBuffer.updateData(Y.icon.opacityVertexArray),Y.hasIconCollisionBoxData()&&Y.iconCollisionBox.collisionVertexBuffer&&Y.iconCollisionBox.collisionVertexBuffer.updateData(Y.iconCollisionBox.collisionVertexArray),Y.hasTextCollisionBoxData()&&Y.textCollisionBox.collisionVertexBuffer&&Y.textCollisionBox.collisionVertexBuffer.updateData(Y.textCollisionBox.collisionVertexArray),Y.bucketInstanceId in this.collisionCircleArrays){var Zr=this.collisionCircleArrays[Y.bucketInstanceId];Y.placementInvProjMatrix=Zr.invProjMatrix,Y.placementViewportMatrix=Zr.viewportMatrix,Y.collisionCircleArray=Zr.circles,delete this.collisionCircleArrays[Y.bucketInstanceId]}},cr.prototype.symbolFadeChange=function(Y){return this.fadeDuration===0?1:(Y-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},cr.prototype.zoomAdjustment=function(Y){return Math.max(0,(this.transform.zoom-Y)/1.5)},cr.prototype.hasTransitions=function(Y){return this.stale||Y-this.lastPlacementChangeTime<this.fadeDuration},cr.prototype.stillRecent=function(Y,he){var $=this.zoomAtLastRecencyCheck===he?1-this.zoomAdjustment(he):1;return this.zoomAtLastRecencyCheck=he,this.commitTime+this.fadeDuration*$>Y},cr.prototype.setStale=function(){this.stale=!0};function nn(fe,Y,he,$,ve){fe.emplaceBack(Y?1:0,he?1:0,$||0,ve||0),fe.emplaceBack(Y?1:0,he?1:0,$||0,ve||0),fe.emplaceBack(Y?1:0,he?1:0,$||0,ve||0),fe.emplaceBack(Y?1:0,he?1:0,$||0,ve||0)}var vn=Math.pow(2,25),on=Math.pow(2,24),Cn=Math.pow(2,17),_n=Math.pow(2,16),un=Math.pow(2,9),dr=Math.pow(2,8),pr=Math.pow(2,1);function Pr(fe){if(fe.opacity===0&&!fe.placed)return 0;if(fe.opacity===1&&fe.placed)return 4294967295;var Y=fe.placed?1:0,he=Math.floor(fe.opacity*127);return he*vn+Y*on+he*Cn+Y*_n+he*un+Y*dr+he*pr+Y}var dn=0,Un=function(Y){this._sortAcrossTiles=Y.layout.get("symbol-z-order")!=="viewport-y"&&Y.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Un.prototype.continuePlacement=function(Y,he,$,ve,Se){for(var Re=this._bucketParts;this._currentTileIndex<Y.length;){var Ze=Y[this._currentTileIndex];if(he.getBucketParts(Re,ve,Ze,this._sortAcrossTiles),this._currentTileIndex++,Se())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,Re.sort(function(At,Ut){return At.sortKey-Ut.sortKey}));this._currentPartIndex<Re.length;){var ut=Re[this._currentPartIndex];if(he.placeLayerBucketPart(ut,this._seenCrossTileIDs,$),this._currentPartIndex++,Se())return!0}return!1};var ra=function(Y,he,$,ve,Se,Re,Ze){this.placement=new cr(Y,Se,Re,Ze),this._currentPlacementIndex=he.length-1,this._forceFullPlacement=$,this._showCollisionBoxes=ve,this._done=!1};ra.prototype.isDone=function(){return this._done},ra.prototype.continuePlacement=function(Y,he,$){for(var ve=this,Se=e.browser.now(),Re=function(){var nr=e.browser.now()-Se;return ve._forceFullPlacement?!1:nr>2};this._currentPlacementIndex>=0;){var Ze=Y[this._currentPlacementIndex],ut=he[Ze],At=this.placement.collisionIndex.transform.zoom;if(ut.type==="symbol"&&(!ut.minzoom||ut.minzoom<=At)&&(!ut.maxzoom||ut.maxzoom>At)){this._inProgressLayer||(this._inProgressLayer=new Un(ut));var Ut=this._inProgressLayer.continuePlacement($[ut.source],this.placement,this._showCollisionBoxes,ut,Re);if(Ut)return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ra.prototype.commit=function(Y){return this.placement.commit(Y),this.placement};var bn=512/e.EXTENT/2,Zn=function(Y,he,$){this.tileID=Y,this.indexedSymbolInstances={},this.bucketInstanceId=$;for(var ve=0;ve<he.length;ve++){var Se=he.get(ve),Re=Se.key;this.indexedSymbolInstances[Re]||(this.indexedSymbolInstances[Re]=[]),this.indexedSymbolInstances[Re].push({crossTileID:Se.crossTileID,coord:this.getScaledCoordinates(Se,Y)})}};Zn.prototype.getScaledCoordinates=function(Y,he){var $=he.canonical.z-this.tileID.canonical.z,ve=bn/Math.pow(2,$);return{x:Math.floor((he.canonical.x*e.EXTENT+Y.anchorX)*ve),y:Math.floor((he.canonical.y*e.EXTENT+Y.anchorY)*ve)}},Zn.prototype.findMatches=function(Y,he,$){for(var ve=this.tileID.canonical.z<he.canonical.z?1:Math.pow(2,this.tileID.canonical.z-he.canonical.z),Se=0;Se<Y.length;Se++){var Re=Y.get(Se);if(!Re.crossTileID){var Ze=this.indexedSymbolInstances[Re.key];if(!!Ze)for(var ut=this.getScaledCoordinates(Re,he),At=0,Ut=Ze;At<Ut.length;At+=1){var nr=Ut[At];if(Math.abs(nr.coord.x-ut.x)<=ve&&Math.abs(nr.coord.y-ut.y)<=ve&&!$[nr.crossTileID]){$[nr.crossTileID]=!0,Re.crossTileID=nr.crossTileID;break}}}}};var sa=function(){this.maxCrossTileID=0};sa.prototype.generate=function(){return++this.maxCrossTileID};var ga=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};ga.prototype.handleWrapJump=function(Y){var he=Math.round((Y-this.lng)/360);if(he!==0)for(var $ in this.indexes){var ve=this.indexes[$],Se={};for(var Re in ve){var Ze=ve[Re];Ze.tileID=Ze.tileID.unwrapTo(Ze.tileID.wrap+he),Se[Ze.tileID.key]=Ze}this.indexes[$]=Se}this.lng=Y},ga.prototype.addBucket=function(Y,he,$){if(this.indexes[Y.overscaledZ]&&this.indexes[Y.overscaledZ][Y.key]){if(this.indexes[Y.overscaledZ][Y.key].bucketInstanceId===he.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(Y.overscaledZ,this.indexes[Y.overscaledZ][Y.key])}for(var ve=0;ve<he.symbolInstances.length;ve++){var Se=he.symbolInstances.get(ve);Se.crossTileID=0}this.usedCrossTileIDs[Y.overscaledZ]||(this.usedCrossTileIDs[Y.overscaledZ]={});var Re=this.usedCrossTileIDs[Y.overscaledZ];for(var Ze in this.indexes){var ut=this.indexes[Ze];if(Number(Ze)>Y.overscaledZ)for(var At in ut){var Ut=ut[At];Ut.tileID.isChildOf(Y)&&Ut.findMatches(he.symbolInstances,Y,Re)}else{var nr=Y.scaledTo(Number(Ze)),sr=ut[nr.key];sr&&sr.findMatches(he.symbolInstances,Y,Re)}}for(var Tr=0;Tr<he.symbolInstances.length;Tr++){var Ur=he.symbolInstances.get(Tr);Ur.crossTileID||(Ur.crossTileID=$.generate(),Re[Ur.crossTileID]=!0)}return this.indexes[Y.overscaledZ]===void 0&&(this.indexes[Y.overscaledZ]={}),this.indexes[Y.overscaledZ][Y.key]=new Zn(Y,he.symbolInstances,he.bucketInstanceId),!0},ga.prototype.removeBucketCrossTileIDs=function(Y,he){for(var $ in he.indexedSymbolInstances)for(var ve=0,Se=he.indexedSymbolInstances[$];ve<Se.length;ve+=1){var Re=Se[ve];delete this.usedCrossTileIDs[Y][Re.crossTileID]}},ga.prototype.removeStaleBuckets=function(Y){var he=!1;for(var $ in this.indexes){var ve=this.indexes[$];for(var Se in ve)Y[ve[Se].bucketInstanceId]||(this.removeBucketCrossTileIDs($,ve[Se]),delete ve[Se],he=!0)}return he};var wa=function(){this.layerIndexes={},this.crossTileIDs=new sa,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};wa.prototype.addLayer=function(Y,he,$){var ve=this.layerIndexes[Y.id];ve===void 0&&(ve=this.layerIndexes[Y.id]=new ga);var Se=!1,Re={};ve.handleWrapJump($);for(var Ze=0,ut=he;Ze<ut.length;Ze+=1){var At=ut[Ze],Ut=At.getBucket(Y);!Ut||Y.id!==Ut.layerIds[0]||(Ut.bucketInstanceId||(Ut.bucketInstanceId=++this.maxBucketInstanceId),ve.addBucket(At.tileID,Ut,this.crossTileIDs)&&(Se=!0),Re[Ut.bucketInstanceId]=!0)}return ve.removeStaleBuckets(Re)&&(Se=!0),Se},wa.prototype.pruneUnusedLayers=function(Y){var he={};Y.forEach(function(ve){he[ve]=!0});for(var $ in this.layerIndexes)he[$]||delete this.layerIndexes[$]};var ua=function(fe,Y){return e.emitValidationErrors(fe,Y&&Y.filter(function(he){return he.identifier!=="source.canvas"}))},Aa=e.pick(yr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),_o=e.pick(yr,["setCenter","setZoom","setBearing","setPitch"]),So=sn(),Fo=function(fe){function Y(he,$){var ve=this;$===void 0&&($={}),fe.call(this),this.map=he,this.dispatcher=new I(vr(),this),this.imageManager=new _,this.imageManager.setEventedParent(this),this.glyphManager=new h(he._requestManager,$.localIdeographFontFamily),this.lineAtlas=new O(256,512),this.crossTileSymbolIndex=new wa,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var Se=this;this._rtlTextPluginCallback=Y.registerForPluginStateChange(function(Re){var Ze={pluginStatus:Re.pluginStatus,pluginURL:Re.pluginURL};Se.dispatcher.broadcast("syncRTLPluginState",Ze,function(ut,At){if(e.triggerPluginCompletionEvent(ut),At){var Ut=At.every(function(sr){return sr});if(Ut)for(var nr in Se.sourceCaches)Se.sourceCaches[nr].reload()}})}),this.on("data",function(Re){if(!(Re.dataType!=="source"||Re.sourceDataType!=="metadata")){var Ze=ve.sourceCaches[Re.sourceId];if(!!Ze){var ut=Ze.getSource();if(!(!ut||!ut.vectorLayerIds))for(var At in ve._layers){var Ut=ve._layers[At];Ut.source===ut.id&&ve._validateLayer(Ut)}}}})}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.loadURL=function($,ve){var Se=this;ve===void 0&&(ve={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var Re=typeof ve.validate=="boolean"?ve.validate:!e.isMapboxURL($);$=this.map._requestManager.normalizeStyleURL($,ve.accessToken);var Ze=this.map._requestManager.transformRequest($,e.ResourceType.Style);this._request=e.getJSON(Ze,function(ut,At){Se._request=null,ut?Se.fire(new e.ErrorEvent(ut)):At&&Se._load(At,Re)})},Y.prototype.loadJSON=function($,ve){var Se=this;ve===void 0&&(ve={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){Se._request=null,Se._load($,ve.validate!==!1)})},Y.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(So,!1)},Y.prototype._load=function($,ve){if(!(ve&&ua(this,e.validateStyle($)))){this._loaded=!0,this.stylesheet=$;for(var Se in $.sources)this.addSource(Se,$.sources[Se],{validate:!1});$.sprite?this._loadSprite($.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL($.glyphs);var Re=Gr(this.stylesheet.layers);this._order=Re.map(function(Ut){return Ut.id}),this._layers={},this._serializedLayers={};for(var Ze=0,ut=Re;Ze<ut.length;Ze+=1){var At=ut[Ze];At=e.createStyleLayer(At),At.setEventedParent(this,{layer:{id:At.id}}),this._layers[At.id]=At,this._serializedLayers[At.id]=At.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new z(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},Y.prototype._loadSprite=function($){var ve=this;this._spriteRequest=x($,this.map._requestManager,function(Se,Re){if(ve._spriteRequest=null,Se)ve.fire(new e.ErrorEvent(Se));else if(Re)for(var Ze in Re)ve.imageManager.addImage(Ze,Re[Ze]);ve.imageManager.setLoaded(!0),ve._availableImages=ve.imageManager.listImages(),ve.dispatcher.broadcast("setImages",ve._availableImages),ve.fire(new e.Event("data",{dataType:"style"}))})},Y.prototype._validateLayer=function($){var ve=this.sourceCaches[$.source];if(!!ve){var Se=$.sourceLayer;if(!!Se){var Re=ve.getSource();(Re.type==="geojson"||Re.vectorLayerIds&&Re.vectorLayerIds.indexOf(Se)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+Se+'" does not exist on source "'+Re.id+'" as specified by style layer "'+$.id+'"')))}}},Y.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var $ in this.sourceCaches)if(!this.sourceCaches[$].loaded())return!1;return!!this.imageManager.isLoaded()},Y.prototype._serializeLayers=function($){for(var ve=[],Se=0,Re=$;Se<Re.length;Se+=1){var Ze=Re[Se],ut=this._layers[Ze];ut.type!=="custom"&&ve.push(ut.serialize())}return ve},Y.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var $ in this.sourceCaches)if(this.sourceCaches[$].hasTransition())return!0;for(var ve in this._layers)if(this._layers[ve].hasTransition())return!0;return!1},Y.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},Y.prototype.update=function($){if(!!this._loaded){var ve=this._changed;if(this._changed){var Se=Object.keys(this._updatedLayers),Re=Object.keys(this._removedLayers);(Se.length||Re.length)&&this._updateWorkerLayers(Se,Re);for(var Ze in this._updatedSources){var ut=this._updatedSources[Ze];ut==="reload"?this._reloadSource(Ze):ut==="clear"&&this._clearSource(Ze)}this._updateTilesForChangedImages();for(var At in this._updatedPaintProps)this._layers[At].updateTransitions($);this.light.updateTransitions($),this._resetUpdates()}for(var Ut in this.sourceCaches)this.sourceCaches[Ut].used=!1;for(var nr=0,sr=this._order;nr<sr.length;nr+=1){var Tr=sr[nr],Ur=this._layers[Tr];Ur.recalculate($,this._availableImages),!Ur.isHidden($.zoom)&&Ur.source&&(this.sourceCaches[Ur.source].used=!0)}this.light.recalculate($),this.z=$.zoom,ve&&this.fire(new e.Event("data",{dataType:"style"}))}},Y.prototype._updateTilesForChangedImages=function(){var $=Object.keys(this._changedImages);if($.length){for(var ve in this.sourceCaches)this.sourceCaches[ve].reloadTilesForDependencies(["icons","patterns"],$);this._changedImages={}}},Y.prototype._updateWorkerLayers=function($,ve){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers($),removedIds:ve})},Y.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},Y.prototype.setState=function($){var ve=this;if(this._checkLoaded(),ua(this,e.validateStyle($)))return!1;$=e.clone$1($),$.layers=Gr($.layers);var Se=Nr(this.serialize(),$).filter(function(Ze){return!(Ze.command in _o)});if(Se.length===0)return!1;var Re=Se.filter(function(Ze){return!(Ze.command in Aa)});if(Re.length>0)throw new Error("Unimplemented: "+Re.map(function(Ze){return Ze.command}).join(", ")+".");return Se.forEach(function(Ze){Ze.command!=="setTransition"&&ve[Ze.command].apply(ve,Ze.args)}),this.stylesheet=$,!0},Y.prototype.addImage=function($,ve){if(this.getImage($))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage($,ve),this._availableImages=this.imageManager.listImages(),this._changedImages[$]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},Y.prototype.updateImage=function($,ve){this.imageManager.updateImage($,ve)},Y.prototype.getImage=function($){return this.imageManager.getImage($)},Y.prototype.removeImage=function($){if(!this.getImage($))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage($),this._availableImages=this.imageManager.listImages(),this._changedImages[$]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},Y.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},Y.prototype.addSource=function($,ve,Se){var Re=this;if(Se===void 0&&(Se={}),this._checkLoaded(),this.sourceCaches[$]!==void 0)throw new Error("There is already a source with this ID");if(!ve.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(ve).join(", ")+".");var Ze=["vector","raster","geojson","video","image"],ut=Ze.indexOf(ve.type)>=0;if(!(ut&&this._validate(e.validateStyle.source,"sources."+$,ve,null,Se))){this.map&&this.map._collectResourceTiming&&(ve.collectResourceTiming=!0);var At=this.sourceCaches[$]=new rt($,ve,this.dispatcher);At.style=this,At.setEventedParent(this,function(){return{isSourceLoaded:Re.loaded(),source:At.serialize(),sourceId:$}}),At.onAdd(this.map),this._changed=!0}},Y.prototype.removeSource=function($){if(this._checkLoaded(),this.sourceCaches[$]===void 0)throw new Error("There is no source with this ID");for(var ve in this._layers)if(this._layers[ve].source===$)return this.fire(new e.ErrorEvent(new Error('Source "'+$+'" cannot be removed while layer "'+ve+'" is using it.')));var Se=this.sourceCaches[$];delete this.sourceCaches[$],delete this._updatedSources[$],Se.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:$})),Se.setEventedParent(null),Se.clearTiles(),Se.onRemove&&Se.onRemove(this.map),this._changed=!0},Y.prototype.setGeoJSONSourceData=function($,ve){this._checkLoaded();var Se=this.sourceCaches[$].getSource();Se.setData(ve),this._changed=!0},Y.prototype.getSource=function($){return this.sourceCaches[$]&&this.sourceCaches[$].getSource()},Y.prototype.addLayer=function($,ve,Se){Se===void 0&&(Se={}),this._checkLoaded();var Re=$.id;if(this.getLayer(Re)){this.fire(new e.ErrorEvent(new Error('Layer with id "'+Re+'" already exists on this map')));return}var Ze;if($.type==="custom"){if(ua(this,e.validateCustomStyleLayer($)))return;Ze=e.createStyleLayer($)}else{if(typeof $.source=="object"&&(this.addSource(Re,$.source),$=e.clone$1($),$=e.extend($,{source:Re})),this._validate(e.validateStyle.layer,"layers."+Re,$,{arrayIndex:-1},Se))return;Ze=e.createStyleLayer($),this._validateLayer(Ze),Ze.setEventedParent(this,{layer:{id:Re}}),this._serializedLayers[Ze.id]=Ze.serialize()}var ut=ve?this._order.indexOf(ve):this._order.length;if(ve&&ut===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+ve+'" does not exist on this map.')));return}if(this._order.splice(ut,0,Re),this._layerOrderChanged=!0,this._layers[Re]=Ze,this._removedLayers[Re]&&Ze.source&&Ze.type!=="custom"){var At=this._removedLayers[Re];delete this._removedLayers[Re],At.type!==Ze.type?this._updatedSources[Ze.source]="clear":(this._updatedSources[Ze.source]="reload",this.sourceCaches[Ze.source].pause())}this._updateLayer(Ze),Ze.onAdd&&Ze.onAdd(this.map)},Y.prototype.moveLayer=function($,ve){this._checkLoaded(),this._changed=!0;var Se=this._layers[$];if(!Se){this.fire(new e.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style and cannot be moved.")));return}if($!==ve){var Re=this._order.indexOf($);this._order.splice(Re,1);var Ze=ve?this._order.indexOf(ve):this._order.length;if(ve&&Ze===-1){this.fire(new e.ErrorEvent(new Error('Layer with id "'+ve+'" does not exist on this map.')));return}this._order.splice(Ze,0,$),this._layerOrderChanged=!0}},Y.prototype.removeLayer=function($){this._checkLoaded();var ve=this._layers[$];if(!ve){this.fire(new e.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style and cannot be removed.")));return}ve.setEventedParent(null);var Se=this._order.indexOf($);this._order.splice(Se,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[$]=ve,delete this._layers[$],delete this._serializedLayers[$],delete this._updatedLayers[$],delete this._updatedPaintProps[$],ve.onRemove&&ve.onRemove(this.map)},Y.prototype.getLayer=function($){return this._layers[$]},Y.prototype.hasLayer=function($){return $ in this._layers},Y.prototype.setLayerZoomRange=function($,ve,Se){this._checkLoaded();var Re=this.getLayer($);if(!Re){this.fire(new e.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style and cannot have zoom extent.")));return}Re.minzoom===ve&&Re.maxzoom===Se||(ve!=null&&(Re.minzoom=ve),Se!=null&&(Re.maxzoom=Se),this._updateLayer(Re))},Y.prototype.setFilter=function($,ve,Se){Se===void 0&&(Se={}),this._checkLoaded();var Re=this.getLayer($);if(!Re){this.fire(new e.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style and cannot be filtered.")));return}if(!e.deepEqual(Re.filter,ve)){if(ve==null){Re.filter=void 0,this._updateLayer(Re);return}this._validate(e.validateStyle.filter,"layers."+Re.id+".filter",ve,null,Se)||(Re.filter=e.clone$1(ve),this._updateLayer(Re))}},Y.prototype.getFilter=function($){return e.clone$1(this.getLayer($).filter)},Y.prototype.setLayoutProperty=function($,ve,Se,Re){Re===void 0&&(Re={}),this._checkLoaded();var Ze=this.getLayer($);if(!Ze){this.fire(new e.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style and cannot be styled.")));return}e.deepEqual(Ze.getLayoutProperty(ve),Se)||(Ze.setLayoutProperty(ve,Se,Re),this._updateLayer(Ze))},Y.prototype.getLayoutProperty=function($,ve){var Se=this.getLayer($);if(!Se){this.fire(new e.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style.")));return}return Se.getLayoutProperty(ve)},Y.prototype.setPaintProperty=function($,ve,Se,Re){Re===void 0&&(Re={}),this._checkLoaded();var Ze=this.getLayer($);if(!Ze){this.fire(new e.ErrorEvent(new Error("The layer '"+$+"' does not exist in the map's style and cannot be styled.")));return}if(!e.deepEqual(Ze.getPaintProperty(ve),Se)){var ut=Ze.setPaintProperty(ve,Se,Re);ut&&this._updateLayer(Ze),this._changed=!0,this._updatedPaintProps[$]=!0}},Y.prototype.getPaintProperty=function($,ve){return this.getLayer($).getPaintProperty(ve)},Y.prototype.setFeatureState=function($,ve){this._checkLoaded();var Se=$.source,Re=$.sourceLayer,Ze=this.sourceCaches[Se];if(Ze===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Se+"' does not exist in the map's style.")));return}var ut=Ze.getSource().type;if(ut==="geojson"&&Re){this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));return}if(ut==="vector"&&!Re){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}$.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Ze.setFeatureState(Re,$.id,ve)},Y.prototype.removeFeatureState=function($,ve){this._checkLoaded();var Se=$.source,Re=this.sourceCaches[Se];if(Re===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+Se+"' does not exist in the map's style.")));return}var Ze=Re.getSource().type,ut=Ze==="vector"?$.sourceLayer:void 0;if(Ze==="vector"&&!ut){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}if(ve&&typeof $.id!="string"&&typeof $.id!="number"){this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property.")));return}Re.removeFeatureState(ut,$.id,ve)},Y.prototype.getFeatureState=function($){this._checkLoaded();var ve=$.source,Se=$.sourceLayer,Re=this.sourceCaches[ve];if(Re===void 0){this.fire(new e.ErrorEvent(new Error("The source '"+ve+"' does not exist in the map's style.")));return}var Ze=Re.getSource().type;if(Ze==="vector"&&!Se){this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));return}return $.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),Re.getFeatureState(Se,$.id)},Y.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},Y.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function($){return $.serialize()}),layers:this._serializeLayers(this._order)},function($){return $!==void 0})},Y.prototype._updateLayer=function($){this._updatedLayers[$.id]=!0,$.source&&!this._updatedSources[$.source]&&this.sourceCaches[$.source].getSource().type!=="raster"&&(this._updatedSources[$.source]="reload",this.sourceCaches[$.source].pause()),this._changed=!0},Y.prototype._flattenAndSortRenderedFeatures=function($){for(var ve=this,Se=function(Za){return ve._layers[Za].type==="fill-extrusion"},Re={},Ze=[],ut=this._order.length-1;ut>=0;ut--){var At=this._order[ut];if(Se(At)){Re[At]=ut;for(var Ut=0,nr=$;Ut<nr.length;Ut+=1){var sr=nr[Ut],Tr=sr[At];if(Tr)for(var Ur=0,Hr=Tr;Ur<Hr.length;Ur+=1){var Fr=Hr[Ur];Ze.push(Fr)}}}}Ze.sort(function(Za,ai){return ai.intersectionZ-Za.intersectionZ});for(var Zr=[],fn=this._order.length-1;fn>=0;fn--){var En=this._order[fn];if(Se(En))for(var Nn=Ze.length-1;Nn>=0;Nn--){var jn=Ze[Nn].feature;if(Re[jn.layer.id]<fn)break;Zr.push(jn),Ze.pop()}else for(var Qn=0,Kn=$;Qn<Kn.length;Qn+=1){var ha=Kn[Qn],xa=ha[En];if(xa)for(var ma=0,Ta=xa;ma<Ta.length;ma+=1){var Pa=Ta[ma];Zr.push(Pa.feature)}}}return Zr},Y.prototype.queryRenderedFeatures=function($,ve,Se){ve&&ve.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",ve.filter,null,ve);var Re={};if(ve&&ve.layers){if(!Array.isArray(ve.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var Ze=0,ut=ve.layers;Ze<ut.length;Ze+=1){var At=ut[Ze],Ut=this._layers[At];if(!Ut)return this.fire(new e.ErrorEvent(new Error("The layer '"+At+"' does not exist in the map's style and cannot be queried for features."))),[];Re[Ut.source]=!0}}var nr=[];ve.availableImages=this._availableImages;for(var sr in this.sourceCaches)ve.layers&&!Re[sr]||nr.push(j(this.sourceCaches[sr],this._layers,this._serializedLayers,$,ve,Se));return this.placement&&nr.push(Z(this._layers,this._serializedLayers,this.sourceCaches,$,ve,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(nr)},Y.prototype.querySourceFeatures=function($,ve){ve&&ve.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",ve.filter,null,ve);var Se=this.sourceCaches[$];return Se?ne(Se,ve):[]},Y.prototype.addSourceType=function($,ve,Se){if(Y.getSourceType($))return Se(new Error('A source type called "'+$+'" already exists.'));if(Y.setSourceType($,ve),!ve.workerSourceURL)return Se(null,null);this.dispatcher.broadcast("loadWorkerSource",{name:$,url:ve.workerSourceURL},Se)},Y.prototype.getLight=function(){return this.light.getLight()},Y.prototype.setLight=function($,ve){ve===void 0&&(ve={}),this._checkLoaded();var Se=this.light.getLight(),Re=!1;for(var Ze in $)if(!e.deepEqual($[Ze],Se[Ze])){Re=!0;break}if(!!Re){var ut={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight($,ve),this.light.updateTransitions(ut)}},Y.prototype._validate=function($,ve,Se,Re,Ze){return Ze===void 0&&(Ze={}),Ze&&Ze.validate===!1?!1:ua(this,$.call(e.validateStyle,e.extend({key:ve,style:this.serialize(),value:Se,styleSpec:e.styleSpec},Re)))},Y.prototype._remove=function(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(var $ in this._layers){var ve=this._layers[$];ve.setEventedParent(null)}for(var Se in this.sourceCaches)this.sourceCaches[Se].clearTiles(),this.sourceCaches[Se].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},Y.prototype._clearSource=function($){this.sourceCaches[$].clearTiles()},Y.prototype._reloadSource=function($){this.sourceCaches[$].resume(),this.sourceCaches[$].reload()},Y.prototype._updateSources=function($){for(var ve in this.sourceCaches)this.sourceCaches[ve].update($)},Y.prototype._generateCollisionBoxes=function(){for(var $ in this.sourceCaches)this._reloadSource($)},Y.prototype._updatePlacement=function($,ve,Se,Re,Ze){Ze===void 0&&(Ze=!1);for(var ut=!1,At=!1,Ut={},nr=0,sr=this._order;nr<sr.length;nr+=1){var Tr=sr[nr],Ur=this._layers[Tr];if(Ur.type==="symbol"){if(!Ut[Ur.source]){var Hr=this.sourceCaches[Ur.source];Ut[Ur.source]=Hr.getRenderableIds(!0).map(function(Qn){return Hr.getTileByID(Qn)}).sort(function(Qn,Kn){return Kn.tileID.overscaledZ-Qn.tileID.overscaledZ||(Qn.tileID.isLessThan(Kn.tileID)?-1:1)})}var Fr=this.crossTileSymbolIndex.addLayer(Ur,Ut[Ur.source],$.center.lng);ut=ut||Fr}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),Ze=Ze||this._layerOrderChanged||Se===0,(Ze||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),$.zoom))&&(this.pauseablePlacement=new ra($,this._order,Ze,ve,Se,Re,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Ut),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),At=!0),ut&&this.pauseablePlacement.placement.setStale()),At||ut)for(var Zr=0,fn=this._order;Zr<fn.length;Zr+=1){var En=fn[Zr],Nn=this._layers[En];Nn.type==="symbol"&&this.placement.updateLayerOpacities(Nn,Ut[Nn.source])}var jn=!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now());return jn},Y.prototype._releaseSymbolFadeTiles=function(){for(var $ in this.sourceCaches)this.sourceCaches[$].releaseSymbolFadeTiles()},Y.prototype.getImages=function($,ve,Se){this.imageManager.getImages(ve.icons,Se),this._updateTilesForChangedImages();var Re=this.sourceCaches[ve.source];Re&&Re.setDependencies(ve.tileID.key,ve.type,ve.icons)},Y.prototype.getGlyphs=function($,ve,Se){this.glyphManager.getGlyphs(ve.stacks,Se)},Y.prototype.getResource=function($,ve,Se){return e.makeRequest(ve,Se)},Y}(e.Evented);Fo.getSourceType=ee,Fo.setSourceType=J,Fo.registerForPluginStateChange=e.registerForPluginStateChange;var cs=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),Jl=`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,Tl=`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`,mi=`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,hs="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",Gs=`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,no="uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}",ko=`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Fl=`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`,Ho="void main() {gl_FragColor=vec4(1.0);}",ao="attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}",Ys=`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,io=`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`,Si=`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,Eo="uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}",oo="varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}",$o="attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}",Go="varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",Al="attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}",Yo="uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",Eu="attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}",Ws=`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Co=`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`,du=`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,_s=`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,ws=`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ol=`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`,Cu=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Lu=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`,Xs=`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Bl=`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`,Ts=`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ql=`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`,il=`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,$l="uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}",Pu=`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ql="uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}",Zu=`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Zs=`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,Nl=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ml=`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`,ol=`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Sl=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`,eu=`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,js=`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`,gu=`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,tu="uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}",Du=`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,yu=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`,Wo=`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,kl=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`,sl=`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,ru=`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`,as=Vi(Jl,Tl),Lo=Vi(mi,hs),Ul=Vi(Gs,no),Ps=Vi(ko,Fl),As=Vi(Ho,ao),ho=Vi(Ys,io),ll=Vi(Si,Eo),Ru=Vi(oo,$o),nu=Vi(Go,Al),Iu=Vi(Yo,Eu),Ms=Vi(Ws,Co),vs=Vi(du,_s),Xo=Vi(ws,Ol),El=Vi(Cu,Lu),ul=Vi(Xs,Bl),zu=Vi(Ts,Ql),is=Vi(il,$l),Fu=Vi(Pu,ql),au=Vi(Zu,Zs),fl=Vi(Nl,Ml),iu=Vi(ol,Sl),Cl=Vi(eu,js),Ll=Vi(gu,tu),Vl=Vi(Du,yu),Hl=Vi(Wo,kl),ju=Vi(sl,ru);function Vi(fe,Y){var he=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,$={};return fe=fe.replace(he,function(ve,Se,Re,Ze,ut){return $[ut]=!0,Se==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
varying `+Re+" "+Ze+" "+ut+`;
#else
uniform `+Re+" "+Ze+" u_"+ut+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ut+`
    `+Re+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`}),Y=Y.replace(he,function(ve,Se,Re,Ze,ut){var At=Ze==="float"?"vec2":"vec4",Ut=ut.match(/color/)?"color":At;return $[ut]?Se==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
uniform lowp float u_`+ut+`_t;
attribute `+Re+" "+At+" a_"+ut+`;
varying `+Re+" "+Ze+" "+ut+`;
#else
uniform `+Re+" "+Ze+" u_"+ut+`;
#endif
`:Ut==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+ut+" = a_"+ut+`;
#else
    `+Re+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+ut+" = unpack_mix_"+Ut+"(a_"+ut+", u_"+ut+`_t);
#else
    `+Re+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`:Se==="define"?`
#ifndef HAS_UNIFORM_u_`+ut+`
uniform lowp float u_`+ut+`_t;
attribute `+Re+" "+At+" a_"+ut+`;
#else
uniform `+Re+" "+Ze+" u_"+ut+`;
#endif
`:Ut==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+Re+" "+Ze+" "+ut+" = a_"+ut+`;
#else
    `+Re+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ut+`
    `+Re+" "+Ze+" "+ut+" = unpack_mix_"+Ut+"(a_"+ut+", u_"+ut+`_t);
#else
    `+Re+" "+Ze+" "+ut+" = u_"+ut+`;
#endif
`}),{fragmentSource:fe,vertexSource:Y}}var cl=Object.freeze({__proto__:null,prelude:as,background:Lo,backgroundPattern:Ul,circle:Ps,clippingMask:As,heatmap:ho,heatmapTexture:ll,collisionBox:Ru,collisionCircle:nu,debug:Iu,fill:Ms,fillOutline:vs,fillOutlinePattern:Xo,fillPattern:El,fillExtrusion:ul,fillExtrusionPattern:zu,hillshadePrepare:is,hillshade:Fu,line:au,lineGradient:fl,linePattern:iu,lineSDF:Cl,raster:Ll,symbolIcon:Vl,symbolSDF:Hl,symbolTextAndIcon:ju}),Ks=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};Ks.prototype.bind=function(Y,he,$,ve,Se,Re,Ze,ut){this.context=Y;for(var At=this.boundPaintVertexBuffers.length!==ve.length,Ut=0;!At&&Ut<ve.length;Ut++)this.boundPaintVertexBuffers[Ut]!==ve[Ut]&&(At=!0);var nr=!this.vao||this.boundProgram!==he||this.boundLayoutVertexBuffer!==$||At||this.boundIndexBuffer!==Se||this.boundVertexOffset!==Re||this.boundDynamicVertexBuffer!==Ze||this.boundDynamicVertexBuffer2!==ut;!Y.extVertexArrayObject||nr?this.freshBind(he,$,ve,Se,Re,Ze,ut):(Y.bindVertexArrayOES.set(this.vao),Ze&&Ze.bind(),Se&&Se.dynamicDraw&&Se.bind(),ut&&ut.bind())},Ks.prototype.freshBind=function(Y,he,$,ve,Se,Re,Ze){var ut,At=Y.numAttributes,Ut=this.context,nr=Ut.gl;if(Ut.extVertexArrayObject)this.vao&&this.destroy(),this.vao=Ut.extVertexArrayObject.createVertexArrayOES(),Ut.bindVertexArrayOES.set(this.vao),ut=0,this.boundProgram=Y,this.boundLayoutVertexBuffer=he,this.boundPaintVertexBuffers=$,this.boundIndexBuffer=ve,this.boundVertexOffset=Se,this.boundDynamicVertexBuffer=Re,this.boundDynamicVertexBuffer2=Ze;else{ut=Ut.currentNumAttributes||0;for(var sr=At;sr<ut;sr++)nr.disableVertexAttribArray(sr)}he.enableAttributes(nr,Y);for(var Tr=0,Ur=$;Tr<Ur.length;Tr+=1){var Hr=Ur[Tr];Hr.enableAttributes(nr,Y)}Re&&Re.enableAttributes(nr,Y),Ze&&Ze.enableAttributes(nr,Y),he.bind(),he.setVertexAttribPointers(nr,Y,Se);for(var Fr=0,Zr=$;Fr<Zr.length;Fr+=1){var fn=Zr[Fr];fn.bind(),fn.setVertexAttribPointers(nr,Y,Se)}Re&&(Re.bind(),Re.setVertexAttribPointers(nr,Y,Se)),ve&&ve.bind(),Ze&&(Ze.bind(),Ze.setVertexAttribPointers(nr,Y,Se)),Ut.currentNumAttributes=At},Ks.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var os=function(Y,he,$,ve,Se){var Re=Y.gl;this.program=Re.createProgram();var Ze=$?$.defines():[];Se&&Ze.push("#define OVERDRAW_INSPECTOR;");var ut=Ze.concat(as.fragmentSource,he.fragmentSource).join(`
`),At=Ze.concat(as.vertexSource,he.vertexSource).join(`
`),Ut=Re.createShader(Re.FRAGMENT_SHADER);if(Re.isContextLost()){this.failedToCreate=!0;return}Re.shaderSource(Ut,ut),Re.compileShader(Ut),Re.attachShader(this.program,Ut);var nr=Re.createShader(Re.VERTEX_SHADER);if(Re.isContextLost()){this.failedToCreate=!0;return}Re.shaderSource(nr,At),Re.compileShader(nr),Re.attachShader(this.program,nr);for(var sr=$?$.layoutAttributes:[],Tr=0;Tr<sr.length;Tr++)Re.bindAttribLocation(this.program,Tr,sr[Tr].name);Re.linkProgram(this.program),Re.deleteShader(nr),Re.deleteShader(Ut),this.numAttributes=Re.getProgramParameter(this.program,Re.ACTIVE_ATTRIBUTES),this.attributes={};for(var Ur={},Hr=0;Hr<this.numAttributes;Hr++){var Fr=Re.getActiveAttrib(this.program,Hr);Fr&&(this.attributes[Fr.name]=Re.getAttribLocation(this.program,Fr.name))}for(var Zr=Re.getProgramParameter(this.program,Re.ACTIVE_UNIFORMS),fn=0;fn<Zr;fn++){var En=Re.getActiveUniform(this.program,fn);En&&(Ur[En.name]=Re.getUniformLocation(this.program,En.name))}this.fixedUniforms=ve(Y,Ur),this.binderUniforms=$?$.getUniforms(Y,Ur):[]};os.prototype.draw=function(Y,he,$,ve,Se,Re,Ze,ut,At,Ut,nr,sr,Tr,Ur,Hr,Fr){var Zr,fn=Y.gl;if(!this.failedToCreate){Y.program.set(this.program),Y.setDepthMode($),Y.setStencilMode(ve),Y.setColorMode(Se),Y.setCullFace(Re);for(var En in this.fixedUniforms)this.fixedUniforms[En].set(Ze[En]);Ur&&Ur.setUniforms(Y,this.binderUniforms,sr,{zoom:Tr});for(var Nn=(Zr={},Zr[fn.LINES]=2,Zr[fn.TRIANGLES]=3,Zr[fn.LINE_STRIP]=1,Zr)[he],jn=0,Qn=nr.get();jn<Qn.length;jn+=1){var Kn=Qn[jn],ha=Kn.vaos||(Kn.vaos={}),xa=ha[ut]||(ha[ut]=new Ks);xa.bind(Y,this,At,Ur?Ur.getPaintVertexBuffers():[],Ut,Kn.vertexOffset,Hr,Fr),fn.drawElements(he,Kn.primitiveLength*Nn,fn.UNSIGNED_SHORT,Kn.primitiveOffset*Nn*2)}}};function ps(fe,Y,he){var $=1/Tn(he,1,Y.transform.tileZoom),ve=Math.pow(2,he.tileID.overscaledZ),Se=he.tileSize*Math.pow(2,Y.transform.tileZoom)/ve,Re=Se*(he.tileID.canonical.x+he.tileID.wrap*ve),Ze=Se*he.tileID.canonical.y;return{u_image:0,u_texsize:he.imageAtlasTexture.size,u_scale:[$,fe.fromScale,fe.toScale],u_fade:fe.t,u_pixel_coord_upper:[Re>>16,Ze>>16],u_pixel_coord_lower:[Re&65535,Ze&65535]}}function Gl(fe,Y,he,$){var ve=he.imageManager.getPattern(fe.from.toString()),Se=he.imageManager.getPattern(fe.to.toString()),Re=he.imageManager.getPixelSize(),Ze=Re.width,ut=Re.height,At=Math.pow(2,$.tileID.overscaledZ),Ut=$.tileSize*Math.pow(2,he.transform.tileZoom)/At,nr=Ut*($.tileID.canonical.x+$.tileID.wrap*At),sr=Ut*$.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ve.tl,u_pattern_br_a:ve.br,u_pattern_tl_b:Se.tl,u_pattern_br_b:Se.br,u_texsize:[Ze,ut],u_mix:Y.t,u_pattern_size_a:ve.displaySize,u_pattern_size_b:Se.displaySize,u_scale_a:Y.fromScale,u_scale_b:Y.toScale,u_tile_units_to_pixels:1/Tn($,1,he.transform.tileZoom),u_pixel_coord_upper:[nr>>16,sr>>16],u_pixel_coord_lower:[nr&65535,sr&65535]}}var co=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_lightpos:new e.Uniform3f(fe,Y.u_lightpos),u_lightintensity:new e.Uniform1f(fe,Y.u_lightintensity),u_lightcolor:new e.Uniform3f(fe,Y.u_lightcolor),u_vertical_gradient:new e.Uniform1f(fe,Y.u_vertical_gradient),u_opacity:new e.Uniform1f(fe,Y.u_opacity)}},ou=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_lightpos:new e.Uniform3f(fe,Y.u_lightpos),u_lightintensity:new e.Uniform1f(fe,Y.u_lightintensity),u_lightcolor:new e.Uniform3f(fe,Y.u_lightcolor),u_vertical_gradient:new e.Uniform1f(fe,Y.u_vertical_gradient),u_height_factor:new e.Uniform1f(fe,Y.u_height_factor),u_image:new e.Uniform1i(fe,Y.u_image),u_texsize:new e.Uniform2f(fe,Y.u_texsize),u_pixel_coord_upper:new e.Uniform2f(fe,Y.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,Y.u_pixel_coord_lower),u_scale:new e.Uniform3f(fe,Y.u_scale),u_fade:new e.Uniform1f(fe,Y.u_fade),u_opacity:new e.Uniform1f(fe,Y.u_opacity)}},qo=function(fe,Y,he,$){var ve=Y.style.light,Se=ve.properties.get("position"),Re=[Se.x,Se.y,Se.z],Ze=e.create$1();ve.properties.get("anchor")==="viewport"&&e.fromRotation(Ze,-Y.transform.angle),e.transformMat3(Re,Re,Ze);var ut=ve.properties.get("color");return{u_matrix:fe,u_lightpos:Re,u_lightintensity:ve.properties.get("intensity"),u_lightcolor:[ut.r,ut.g,ut.b],u_vertical_gradient:+he,u_opacity:$}},Ds=function(fe,Y,he,$,ve,Se,Re){return e.extend(qo(fe,Y,he,$),ps(Se,Y,Re),{u_height_factor:-Math.pow(2,ve.overscaledZ)/Re.tileSize/8})},Js=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix)}},Rs=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_image:new e.Uniform1i(fe,Y.u_image),u_texsize:new e.Uniform2f(fe,Y.u_texsize),u_pixel_coord_upper:new e.Uniform2f(fe,Y.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,Y.u_pixel_coord_lower),u_scale:new e.Uniform3f(fe,Y.u_scale),u_fade:new e.Uniform1f(fe,Y.u_fade)}},ds=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_world:new e.Uniform2f(fe,Y.u_world)}},Ji=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_world:new e.Uniform2f(fe,Y.u_world),u_image:new e.Uniform1i(fe,Y.u_image),u_texsize:new e.Uniform2f(fe,Y.u_texsize),u_pixel_coord_upper:new e.Uniform2f(fe,Y.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,Y.u_pixel_coord_lower),u_scale:new e.Uniform3f(fe,Y.u_scale),u_fade:new e.Uniform1f(fe,Y.u_fade)}},wo=function(fe){return{u_matrix:fe}},Zo=function(fe,Y,he,$){return e.extend(wo(fe),ps(he,Y,$))},Yl=function(fe,Y){return{u_matrix:fe,u_world:Y}},Wl=function(fe,Y,he,$,ve){return e.extend(Zo(fe,Y,he,$),{u_world:ve})},mu=function(fe,Y){return{u_camera_to_center_distance:new e.Uniform1f(fe,Y.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(fe,Y.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(fe,Y.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(fe,Y.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(fe,Y.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix)}},gt=function(fe,Y,he,$){var ve=fe.transform,Se,Re;if($.paint.get("circle-pitch-alignment")==="map"){var Ze=Tn(he,1,ve.zoom);Se=!0,Re=[Ze,Ze]}else Se=!1,Re=ve.pixelsToGLUnits;return{u_camera_to_center_distance:ve.cameraToCenterDistance,u_scale_with_map:+($.paint.get("circle-pitch-scale")==="map"),u_matrix:fe.translatePosMatrix(Y.posMatrix,he,$.paint.get("circle-translate"),$.paint.get("circle-translate-anchor")),u_pitch_with_map:+Se,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:Re}},Dt=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_camera_to_center_distance:new e.Uniform1f(fe,Y.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(fe,Y.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(fe,Y.u_extrude_scale),u_overscale_factor:new e.Uniform1f(fe,Y.u_overscale_factor)}},or=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_inv_matrix:new e.UniformMatrix4f(fe,Y.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(fe,Y.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(fe,Y.u_viewport_size)}},er=function(fe,Y,he){var $=Tn(he,1,Y.zoom),ve=Math.pow(2,Y.zoom-he.tileID.overscaledZ),Se=he.tileID.overscaleFactor();return{u_matrix:fe,u_camera_to_center_distance:Y.cameraToCenterDistance,u_pixels_to_tile_units:$,u_extrude_scale:[Y.pixelsToGLUnits[0]/($*ve),Y.pixelsToGLUnits[1]/($*ve)],u_overscale_factor:Se}},Er=function(fe,Y,he){return{u_matrix:fe,u_inv_matrix:Y,u_camera_to_center_distance:he.cameraToCenterDistance,u_viewport_size:[he.width,he.height]}},en=function(fe,Y){return{u_color:new e.UniformColor(fe,Y.u_color),u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_overlay:new e.Uniform1i(fe,Y.u_overlay),u_overlay_scale:new e.Uniform1f(fe,Y.u_overlay_scale)}},pn=function(fe,Y,he){return he===void 0&&(he=1),{u_matrix:fe,u_color:Y,u_overlay:0,u_overlay_scale:he}},An=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix)}},Ln=function(fe){return{u_matrix:fe}},Hn=function(fe,Y){return{u_extrude_scale:new e.Uniform1f(fe,Y.u_extrude_scale),u_intensity:new e.Uniform1f(fe,Y.u_intensity),u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix)}},yn=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_world:new e.Uniform2f(fe,Y.u_world),u_image:new e.Uniform1i(fe,Y.u_image),u_color_ramp:new e.Uniform1i(fe,Y.u_color_ramp),u_opacity:new e.Uniform1f(fe,Y.u_opacity)}},Fn=function(fe,Y,he,$){return{u_matrix:fe,u_extrude_scale:Tn(Y,1,he),u_intensity:$}},Pn=function(fe,Y,he,$){var ve=e.create();e.ortho(ve,0,fe.width,fe.height,0,0,1);var Se=fe.context.gl;return{u_matrix:ve,u_world:[Se.drawingBufferWidth,Se.drawingBufferHeight],u_image:he,u_color_ramp:$,u_opacity:Y.paint.get("heatmap-opacity")}},Gn=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_image:new e.Uniform1i(fe,Y.u_image),u_latrange:new e.Uniform2f(fe,Y.u_latrange),u_light:new e.Uniform2f(fe,Y.u_light),u_shadow:new e.UniformColor(fe,Y.u_shadow),u_highlight:new e.UniformColor(fe,Y.u_highlight),u_accent:new e.UniformColor(fe,Y.u_accent)}},$n=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_image:new e.Uniform1i(fe,Y.u_image),u_dimension:new e.Uniform2f(fe,Y.u_dimension),u_zoom:new e.Uniform1f(fe,Y.u_zoom),u_maxzoom:new e.Uniform1f(fe,Y.u_maxzoom),u_unpack:new e.Uniform4f(fe,Y.u_unpack)}},Ha=function(fe,Y,he){var $=he.paint.get("hillshade-shadow-color"),ve=he.paint.get("hillshade-highlight-color"),Se=he.paint.get("hillshade-accent-color"),Re=he.paint.get("hillshade-illumination-direction")*(Math.PI/180);he.paint.get("hillshade-illumination-anchor")==="viewport"&&(Re-=fe.transform.angle);var Ze=!fe.options.moving;return{u_matrix:fe.transform.calculatePosMatrix(Y.tileID.toUnwrapped(),Ze),u_image:0,u_latrange:Fa(fe,Y.tileID),u_light:[he.paint.get("hillshade-exaggeration"),Re],u_shadow:$,u_highlight:ve,u_accent:Se}},La=function(fe,Y,he){var $=Y.stride,ve=e.create();return e.ortho(ve,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(ve,ve,[0,-e.EXTENT,0]),{u_matrix:ve,u_image:1,u_dimension:[$,$],u_zoom:fe.overscaledZ,u_maxzoom:he,u_unpack:Y.getUnpackVector()}};function Fa(fe,Y){var he=Math.pow(2,Y.canonical.z),$=Y.canonical.y;return[new e.MercatorCoordinate(0,$/he).toLngLat().lat,new e.MercatorCoordinate(0,($+1)/he).toLngLat().lat]}var Na=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_ratio:new e.Uniform1f(fe,Y.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,Y.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(fe,Y.u_units_to_pixels)}},qn=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_ratio:new e.Uniform1f(fe,Y.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,Y.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(fe,Y.u_units_to_pixels),u_image:new e.Uniform1i(fe,Y.u_image)}},va=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_texsize:new e.Uniform2f(fe,Y.u_texsize),u_ratio:new e.Uniform1f(fe,Y.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,Y.u_device_pixel_ratio),u_image:new e.Uniform1i(fe,Y.u_image),u_units_to_pixels:new e.Uniform2f(fe,Y.u_units_to_pixels),u_scale:new e.Uniform3f(fe,Y.u_scale),u_fade:new e.Uniform1f(fe,Y.u_fade)}},ja=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_ratio:new e.Uniform1f(fe,Y.u_ratio),u_device_pixel_ratio:new e.Uniform1f(fe,Y.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(fe,Y.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(fe,Y.u_patternscale_a),u_patternscale_b:new e.Uniform2f(fe,Y.u_patternscale_b),u_sdfgamma:new e.Uniform1f(fe,Y.u_sdfgamma),u_image:new e.Uniform1i(fe,Y.u_image),u_tex_y_a:new e.Uniform1f(fe,Y.u_tex_y_a),u_tex_y_b:new e.Uniform1f(fe,Y.u_tex_y_b),u_mix:new e.Uniform1f(fe,Y.u_mix)}},qa=function(fe,Y,he){var $=fe.transform;return{u_matrix:li(fe,Y,he),u_ratio:1/Tn(Y,1,$.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/$.pixelsToGLUnits[0],1/$.pixelsToGLUnits[1]]}},Ti=function(fe,Y,he){return e.extend(qa(fe,Y,he),{u_image:0})},xi=function(fe,Y,he,$){var ve=fe.transform,Se=Di(Y,ve);return{u_matrix:li(fe,Y,he),u_texsize:Y.imageAtlasTexture.size,u_ratio:1/Tn(Y,1,ve.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[Se,$.fromScale,$.toScale],u_fade:$.t,u_units_to_pixels:[1/ve.pixelsToGLUnits[0],1/ve.pixelsToGLUnits[1]]}},bi=function(fe,Y,he,$,ve){var Se=fe.transform,Re=fe.lineAtlas,Ze=Di(Y,Se),ut=he.layout.get("line-cap")==="round",At=Re.getDash($.from,ut),Ut=Re.getDash($.to,ut),nr=At.width*ve.fromScale,sr=Ut.width*ve.toScale;return e.extend(qa(fe,Y,he),{u_patternscale_a:[Ze/nr,-At.height/2],u_patternscale_b:[Ze/sr,-Ut.height/2],u_sdfgamma:Re.width/(Math.min(nr,sr)*256*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:At.y,u_tex_y_b:Ut.y,u_mix:ve.t})};function Di(fe,Y){return 1/Tn(fe,1,Y.tileZoom)}function li(fe,Y,he){return fe.translatePosMatrix(Y.tileID.posMatrix,Y,he.paint.get("line-translate"),he.paint.get("line-translate-anchor"))}var To=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_tl_parent:new e.Uniform2f(fe,Y.u_tl_parent),u_scale_parent:new e.Uniform1f(fe,Y.u_scale_parent),u_buffer_scale:new e.Uniform1f(fe,Y.u_buffer_scale),u_fade_t:new e.Uniform1f(fe,Y.u_fade_t),u_opacity:new e.Uniform1f(fe,Y.u_opacity),u_image0:new e.Uniform1i(fe,Y.u_image0),u_image1:new e.Uniform1i(fe,Y.u_image1),u_brightness_low:new e.Uniform1f(fe,Y.u_brightness_low),u_brightness_high:new e.Uniform1f(fe,Y.u_brightness_high),u_saturation_factor:new e.Uniform1f(fe,Y.u_saturation_factor),u_contrast_factor:new e.Uniform1f(fe,Y.u_contrast_factor),u_spin_weights:new e.Uniform3f(fe,Y.u_spin_weights)}},so=function(fe,Y,he,$,ve){return{u_matrix:fe,u_tl_parent:Y,u_scale_parent:he,u_buffer_scale:1,u_fade_t:$.mix,u_opacity:$.opacity*ve.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ve.paint.get("raster-brightness-min"),u_brightness_high:ve.paint.get("raster-brightness-max"),u_saturation_factor:Ai(ve.paint.get("raster-saturation")),u_contrast_factor:pa(ve.paint.get("raster-contrast")),u_spin_weights:ti(ve.paint.get("raster-hue-rotate"))}};function ti(fe){fe*=Math.PI/180;var Y=Math.sin(fe),he=Math.cos(fe);return[(2*he+1)/3,(-Math.sqrt(3)*Y-he+1)/3,(Math.sqrt(3)*Y-he+1)/3]}function pa(fe){return fe>0?1/(1-fe):1+fe}function Ai(fe){return fe>0?1-1/(1.001-fe):-fe}var vo=function(fe,Y){return{u_is_size_zoom_constant:new e.Uniform1i(fe,Y.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(fe,Y.u_is_size_feature_constant),u_size_t:new e.Uniform1f(fe,Y.u_size_t),u_size:new e.Uniform1f(fe,Y.u_size),u_camera_to_center_distance:new e.Uniform1f(fe,Y.u_camera_to_center_distance),u_pitch:new e.Uniform1f(fe,Y.u_pitch),u_rotate_symbol:new e.Uniform1i(fe,Y.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(fe,Y.u_aspect_ratio),u_fade_change:new e.Uniform1f(fe,Y.u_fade_change),u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(fe,Y.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(fe,Y.u_coord_matrix),u_is_text:new e.Uniform1i(fe,Y.u_is_text),u_pitch_with_map:new e.Uniform1i(fe,Y.u_pitch_with_map),u_texsize:new e.Uniform2f(fe,Y.u_texsize),u_texture:new e.Uniform1i(fe,Y.u_texture)}},xo=function(fe,Y){return{u_is_size_zoom_constant:new e.Uniform1i(fe,Y.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(fe,Y.u_is_size_feature_constant),u_size_t:new e.Uniform1f(fe,Y.u_size_t),u_size:new e.Uniform1f(fe,Y.u_size),u_camera_to_center_distance:new e.Uniform1f(fe,Y.u_camera_to_center_distance),u_pitch:new e.Uniform1f(fe,Y.u_pitch),u_rotate_symbol:new e.Uniform1i(fe,Y.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(fe,Y.u_aspect_ratio),u_fade_change:new e.Uniform1f(fe,Y.u_fade_change),u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(fe,Y.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(fe,Y.u_coord_matrix),u_is_text:new e.Uniform1i(fe,Y.u_is_text),u_pitch_with_map:new e.Uniform1i(fe,Y.u_pitch_with_map),u_texsize:new e.Uniform2f(fe,Y.u_texsize),u_texture:new e.Uniform1i(fe,Y.u_texture),u_gamma_scale:new e.Uniform1f(fe,Y.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(fe,Y.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(fe,Y.u_is_halo)}},ss=function(fe,Y){return{u_is_size_zoom_constant:new e.Uniform1i(fe,Y.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(fe,Y.u_is_size_feature_constant),u_size_t:new e.Uniform1f(fe,Y.u_size_t),u_size:new e.Uniform1f(fe,Y.u_size),u_camera_to_center_distance:new e.Uniform1f(fe,Y.u_camera_to_center_distance),u_pitch:new e.Uniform1f(fe,Y.u_pitch),u_rotate_symbol:new e.Uniform1i(fe,Y.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(fe,Y.u_aspect_ratio),u_fade_change:new e.Uniform1f(fe,Y.u_fade_change),u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(fe,Y.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(fe,Y.u_coord_matrix),u_is_text:new e.Uniform1i(fe,Y.u_is_text),u_pitch_with_map:new e.Uniform1i(fe,Y.u_pitch_with_map),u_texsize:new e.Uniform2f(fe,Y.u_texsize),u_texsize_icon:new e.Uniform2f(fe,Y.u_texsize_icon),u_texture:new e.Uniform1i(fe,Y.u_texture),u_texture_icon:new e.Uniform1i(fe,Y.u_texture_icon),u_gamma_scale:new e.Uniform1f(fe,Y.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(fe,Y.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(fe,Y.u_is_halo)}},Ss=function(fe,Y,he,$,ve,Se,Re,Ze,ut,At){var Ut=ve.transform;return{u_is_size_zoom_constant:+(fe==="constant"||fe==="source"),u_is_size_feature_constant:+(fe==="constant"||fe==="camera"),u_size_t:Y?Y.uSizeT:0,u_size:Y?Y.uSize:0,u_camera_to_center_distance:Ut.cameraToCenterDistance,u_pitch:Ut.pitch/360*2*Math.PI,u_rotate_symbol:+he,u_aspect_ratio:Ut.width/Ut.height,u_fade_change:ve.options.fadeDuration?ve.symbolFadeChange:1,u_matrix:Se,u_label_plane_matrix:Re,u_coord_matrix:Ze,u_is_text:+ut,u_pitch_with_map:+$,u_texsize:At,u_texture:0}},ls=function(fe,Y,he,$,ve,Se,Re,Ze,ut,At,Ut){var nr=ve.transform;return e.extend(Ss(fe,Y,he,$,ve,Se,Re,Ze,ut,At),{u_gamma_scale:$?Math.cos(nr._pitch)*nr.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+Ut})},hl=function(fe,Y,he,$,ve,Se,Re,Ze,ut,At){return e.extend(ls(fe,Y,he,$,ve,Se,Re,Ze,!0,ut,!0),{u_texsize_icon:At,u_texture_icon:1})},gs=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_opacity:new e.Uniform1f(fe,Y.u_opacity),u_color:new e.UniformColor(fe,Y.u_color)}},ys=function(fe,Y){return{u_matrix:new e.UniformMatrix4f(fe,Y.u_matrix),u_opacity:new e.Uniform1f(fe,Y.u_opacity),u_image:new e.Uniform1i(fe,Y.u_image),u_pattern_tl_a:new e.Uniform2f(fe,Y.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(fe,Y.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(fe,Y.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(fe,Y.u_pattern_br_b),u_texsize:new e.Uniform2f(fe,Y.u_texsize),u_mix:new e.Uniform1f(fe,Y.u_mix),u_pattern_size_a:new e.Uniform2f(fe,Y.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(fe,Y.u_pattern_size_b),u_scale_a:new e.Uniform1f(fe,Y.u_scale_a),u_scale_b:new e.Uniform1f(fe,Y.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(fe,Y.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(fe,Y.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(fe,Y.u_tile_units_to_pixels)}},Is=function(fe,Y,he){return{u_matrix:fe,u_opacity:Y,u_color:he}},vl=function(fe,Y,he,$,ve,Se){return e.extend(Gl($,Se,he,ve),{u_matrix:fe,u_opacity:Y})},pl={fillExtrusion:co,fillExtrusionPattern:ou,fill:Js,fillPattern:Rs,fillOutline:ds,fillOutlinePattern:Ji,circle:mu,collisionBox:Dt,collisionCircle:or,debug:en,clippingMask:An,heatmap:Hn,heatmapTexture:yn,hillshade:Gn,hillshadePrepare:$n,line:Na,lineGradient:qn,linePattern:va,lineSDF:ja,raster:To,symbolIcon:vo,symbolSDF:xo,symbolTextAndIcon:ss,background:gs,backgroundPattern:ys},ms;function Ou(fe,Y,he,$,ve,Se,Re){for(var Ze=fe.context,ut=Ze.gl,At=fe.useProgram("collisionBox"),Ut=[],nr=0,sr=0,Tr=0;Tr<$.length;Tr++){var Ur=$[Tr],Hr=Y.getTile(Ur),Fr=Hr.getBucket(he);if(!!Fr){var Zr=Ur.posMatrix;(ve[0]!==0||ve[1]!==0)&&(Zr=fe.translatePosMatrix(Ur.posMatrix,Hr,ve,Se));var fn=Re?Fr.textCollisionBox:Fr.iconCollisionBox,En=Fr.collisionCircleArray;if(En.length>0){var Nn=e.create(),jn=Zr;e.mul(Nn,Fr.placementInvProjMatrix,fe.transform.glCoordMatrix),e.mul(Nn,Nn,Fr.placementViewportMatrix),Ut.push({circleArray:En,circleOffset:sr,transform:jn,invTransform:Nn}),nr+=En.length/4,sr=nr}!fn||At.draw(Ze,ut.LINES,Qr.disabled,Kt.disabled,fe.colorModeForRenderPass(),Xe.disabled,er(Zr,fe.transform,Hr),he.id,fn.layoutVertexBuffer,fn.indexBuffer,fn.segments,null,fe.transform.zoom,null,null,fn.collisionVertexBuffer)}}if(!(!Re||!Ut.length)){var Qn=fe.useProgram("collisionCircle"),Kn=new e.StructArrayLayout2f1f2i16;Kn.resize(nr*4),Kn._trim();for(var ha=0,xa=0,ma=Ut;xa<ma.length;xa+=1)for(var Ta=ma[xa],Pa=0;Pa<Ta.circleArray.length/4;Pa++){var Za=Pa*4,ai=Ta.circleArray[Za+0],Ni=Ta.circleArray[Za+1],ui=Ta.circleArray[Za+2],wi=Ta.circleArray[Za+3];Kn.emplace(ha++,ai,Ni,ui,wi,0),Kn.emplace(ha++,ai,Ni,ui,wi,1),Kn.emplace(ha++,ai,Ni,ui,wi,2),Kn.emplace(ha++,ai,Ni,ui,wi,3)}(!ms||ms.length<nr*2)&&(ms=dl(nr));for(var Va=Ze.createIndexBuffer(ms,!0),Ui=Ze.createVertexBuffer(Kn,e.collisionCircleLayout.members,!0),Gi=0,Wi=Ut;Gi<Wi.length;Gi+=1){var Ci=Wi[Gi],$i=Er(Ci.transform,Ci.invTransform,fe.transform);Qn.draw(Ze,ut.TRIANGLES,Qr.disabled,Kt.disabled,fe.colorModeForRenderPass(),Xe.disabled,$i,he.id,Ui,Va,e.SegmentVector.simpleSegment(0,Ci.circleOffset*2,Ci.circleArray.length,Ci.circleArray.length/2),null,fe.transform.zoom,null,null,null)}Ui.destroy(),Va.destroy()}}function dl(fe){var Y=fe*2,he=new e.StructArrayLayout3ui6;he.resize(Y),he._trim();for(var $=0;$<Y;$++){var ve=$*6;he.uint16[ve+0]=$*4+0,he.uint16[ve+1]=$*4+1,he.uint16[ve+2]=$*4+2,he.uint16[ve+3]=$*4+2,he.uint16[ve+4]=$*4+3,he.uint16[ve+5]=$*4+0}return he}var zs=e.identity(new Float32Array(16));function xu(fe,Y,he,$,ve){if(fe.renderPass==="translucent"){var Se=Kt.disabled,Re=fe.colorModeForRenderPass(),Ze=he.layout.get("text-variable-anchor");Ze&&Bu($,fe,he,Y,he.layout.get("text-rotation-alignment"),he.layout.get("text-pitch-alignment"),ve),he.paint.get("icon-opacity").constantOr(1)!==0&&Nu(fe,Y,he,$,!1,he.paint.get("icon-translate"),he.paint.get("icon-translate-anchor"),he.layout.get("icon-rotation-alignment"),he.layout.get("icon-pitch-alignment"),he.layout.get("icon-keep-upright"),Se,Re),he.paint.get("text-opacity").constantOr(1)!==0&&Nu(fe,Y,he,$,!0,he.paint.get("text-translate"),he.paint.get("text-translate-anchor"),he.layout.get("text-rotation-alignment"),he.layout.get("text-pitch-alignment"),he.layout.get("text-keep-upright"),Se,Re),Y.map.showCollisionBoxes&&(Ou(fe,Y,he,$,he.paint.get("text-translate"),he.paint.get("text-translate-anchor"),!0),Ou(fe,Y,he,$,he.paint.get("icon-translate"),he.paint.get("icon-translate-anchor"),!1))}}function nf(fe,Y,he,$,ve,Se){var Re=e.getAnchorAlignment(fe),Ze=Re.horizontalAlign,ut=Re.verticalAlign,At=-(Ze-.5)*Y,Ut=-(ut-.5)*he,nr=e.evaluateVariableOffset(fe,$);return new e.Point((At/ve+nr[0])*Se,(Ut/ve+nr[1])*Se)}function Bu(fe,Y,he,$,ve,Se,Re){for(var Ze=Y.transform,ut=ve==="map",At=Se==="map",Ut=0,nr=fe;Ut<nr.length;Ut+=1){var sr=nr[Ut],Tr=$.getTile(sr),Ur=Tr.getBucket(he);if(!(!Ur||!Ur.text||!Ur.text.segments.get().length)){var Hr=Ur.textSizeData,Fr=e.evaluateSizeForZoom(Hr,Ze.zoom),Zr=Tn(Tr,1,Y.transform.zoom),fn=Kr(sr.posMatrix,At,ut,Y.transform,Zr),En=he.layout.get("icon-text-fit")!=="none"&&Ur.hasIconData();if(Fr){var Nn=Math.pow(2,Ze.zoom-Tr.tileID.overscaledZ);xs(Ur,ut,At,Re,e.symbolSize,Ze,fn,sr.posMatrix,Nn,Fr,En)}}}}function xs(fe,Y,he,$,ve,Se,Re,Ze,ut,At,Ut){var nr=fe.text.placedSymbolArray,sr=fe.text.dynamicLayoutVertexArray,Tr=fe.icon.dynamicLayoutVertexArray,Ur={};sr.clear();for(var Hr=0;Hr<nr.length;Hr++){var Fr=nr.get(Hr),Zr=fe.allowVerticalPlacement&&!Fr.placedOrientation,fn=!Fr.hidden&&Fr.crossTileID&&!Zr?$[Fr.crossTileID]:null;if(!fn)Ka(Fr.numGlyphs,sr);else{var En=new e.Point(Fr.anchorX,Fr.anchorY),Nn=Sn(En,he?Ze:Re),jn=Jn(Se.cameraToCenterDistance,Nn.signedDistanceFromCamera),Qn=ve.evaluateSizeForFeature(fe.textSizeData,At,Fr)*jn/e.ONE_EM;he&&(Qn*=fe.tilePixelRatio/ut);for(var Kn=fn.width,ha=fn.height,xa=fn.anchor,ma=fn.textOffset,Ta=fn.textBoxScale,Pa=nf(xa,Kn,ha,ma,Ta,Qn),Za=he?Sn(En.add(Pa),Re).point:Nn.point.add(Y?Pa.rotate(-Se.angle):Pa),ai=fe.allowVerticalPlacement&&Fr.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Ni=0;Ni<Fr.numGlyphs;Ni++)e.addDynamicAttributes(sr,Za,ai);Ut&&Fr.associatedIconIndex>=0&&(Ur[Fr.associatedIconIndex]={shiftedAnchor:Za,angle:ai})}}if(Ut){Tr.clear();for(var ui=fe.icon.placedSymbolArray,wi=0;wi<ui.length;wi++){var Va=ui.get(wi);if(Va.hidden)Ka(Va.numGlyphs,Tr);else{var Ui=Ur[wi];if(!Ui)Ka(Va.numGlyphs,Tr);else for(var Gi=0;Gi<Va.numGlyphs;Gi++)e.addDynamicAttributes(Tr,Ui.shiftedAnchor,Ui.angle)}}fe.icon.dynamicLayoutVertexBuffer.updateData(Tr)}fe.text.dynamicLayoutVertexBuffer.updateData(sr)}function Ku(fe,Y,he){return he.iconsInText&&Y?"symbolTextAndIcon":fe?"symbolSDF":"symbolIcon"}function Nu(fe,Y,he,$,ve,Se,Re,Ze,ut,At,Ut,nr){for(var sr=fe.context,Tr=sr.gl,Ur=fe.transform,Hr=Ze==="map",Fr=ut==="map",Zr=Hr&&he.layout.get("symbol-placement")!=="point",fn=Hr&&!Fr&&!Zr,En=he.layout.get("symbol-sort-key").constantOr(1)!==void 0,Nn=fe.depthModeForSublayer(0,Qr.ReadOnly),jn=he.layout.get("text-variable-anchor"),Qn=[],Kn=0,ha=$;Kn<ha.length;Kn+=1){var xa=ha[Kn],ma=Y.getTile(xa),Ta=ma.getBucket(he);if(!!Ta){var Pa=ve?Ta.text:Ta.icon;if(!(!Pa||!Pa.segments.get().length)){var Za=Pa.programConfigurations.get(he.id),ai=ve||Ta.sdfIcons,Ni=ve?Ta.textSizeData:Ta.iconSizeData,ui=Fr||Ur.pitch!==0,wi=fe.useProgram(Ku(ai,ve,Ta),Za),Va=e.evaluateSizeForZoom(Ni,Ur.zoom),Ui=void 0,Gi=[0,0],Wi=void 0,Ci=void 0,$i=null,oi=void 0;if(ve){if(Wi=ma.glyphAtlasTexture,Ci=Tr.LINEAR,Ui=ma.glyphAtlasTexture.size,Ta.iconsInText){Gi=ma.imageAtlasTexture.size,$i=ma.imageAtlasTexture;var Li=Ni.kind==="composite"||Ni.kind==="camera";oi=ui||fe.options.rotating||fe.options.zooming||Li?Tr.LINEAR:Tr.NEAREST}}else{var Ao=he.layout.get("icon-size").constantOr(0)!==1||Ta.iconsNeedLinear;Wi=ma.imageAtlasTexture,Ci=ai||fe.options.rotating||fe.options.zooming||Ao||ui?Tr.LINEAR:Tr.NEAREST,Ui=ma.imageAtlasTexture.size}var Oo=Tn(ma,1,fe.transform.zoom),Dl=Kr(xa.posMatrix,Fr,Hr,fe.transform,Oo),Rl=Dn(xa.posMatrix,Fr,Hr,fe.transform,Oo),uu=jn&&Ta.hasTextData(),fu=he.layout.get("icon-text-fit")!=="none"&&uu&&Ta.hasIconData();Zr&&Xn(Ta,xa.posMatrix,fe,ve,Dl,Rl,Fr,At);var Au=fe.translatePosMatrix(xa.posMatrix,ma,Se,Re),cu=Zr||ve&&jn||fu?zs:Dl,Ns=fe.translatePosMatrix(Rl,ma,Se,Re,!0),Wu=ai&&he.paint.get(ve?"text-halo-width":"icon-halo-width").constantOr(1)!==0,bs=void 0;ai?Ta.iconsInText?bs=hl(Ni.kind,Va,fn,Fr,fe,Au,cu,Ns,Ui,Gi):bs=ls(Ni.kind,Va,fn,Fr,fe,Au,cu,Ns,ve,Ui,!0):bs=Ss(Ni.kind,Va,fn,Fr,fe,Au,cu,Ns,ve,Ui);var bl={program:wi,buffers:Pa,uniformValues:bs,atlasTexture:Wi,atlasTextureIcon:$i,atlasInterpolation:Ci,atlasInterpolationIcon:oi,isSDF:ai,hasHalo:Wu};if(En)for(var hu=Pa.segments.get(),jl=0,vu=hu;jl<vu.length;jl+=1){var Df=vu[jl];Qn.push({segments:new e.SegmentVector([Df]),sortKey:Df.sortKey,state:bl})}else Qn.push({segments:Pa.segments,sortKey:0,state:bl})}}}En&&Qn.sort(function(Rf,If){return Rf.sortKey-If.sortKey});for(var $u=0,us=Qn;$u<us.length;$u+=1){var _f=us[$u],ks=_f.state;if(sr.activeTexture.set(Tr.TEXTURE0),ks.atlasTexture.bind(ks.atlasInterpolation,Tr.CLAMP_TO_EDGE),ks.atlasTextureIcon&&(sr.activeTexture.set(Tr.TEXTURE1),ks.atlasTextureIcon&&ks.atlasTextureIcon.bind(ks.atlasInterpolationIcon,Tr.CLAMP_TO_EDGE)),ks.isSDF){var wf=ks.uniformValues;ks.hasHalo&&(wf.u_is_halo=1,Uu(ks.buffers,_f.segments,he,fe,ks.program,Nn,Ut,nr,wf)),wf.u_is_halo=0}Uu(ks.buffers,_f.segments,he,fe,ks.program,Nn,Ut,nr,ks.uniformValues)}}function Uu(fe,Y,he,$,ve,Se,Re,Ze,ut){var At=$.context,Ut=At.gl;ve.draw(At,Ut.TRIANGLES,Se,Re,Ze,Xe.disabled,ut,he.id,fe.layoutVertexBuffer,fe.indexBuffer,Y,he.paint,$.transform.zoom,fe.programConfigurations.get(he.id),fe.dynamicLayoutVertexBuffer,fe.opacityVertexBuffer)}function yl(fe,Y,he,$){if(fe.renderPass==="translucent"){var ve=he.paint.get("circle-opacity"),Se=he.paint.get("circle-stroke-width"),Re=he.paint.get("circle-stroke-opacity"),Ze=he.layout.get("circle-sort-key").constantOr(1)!==void 0;if(!(ve.constantOr(1)===0&&(Se.constantOr(1)===0||Re.constantOr(1)===0))){for(var ut=fe.context,At=ut.gl,Ut=fe.depthModeForSublayer(0,Qr.ReadOnly),nr=Kt.disabled,sr=fe.colorModeForRenderPass(),Tr=[],Ur=0;Ur<$.length;Ur++){var Hr=$[Ur],Fr=Y.getTile(Hr),Zr=Fr.getBucket(he);if(!!Zr){var fn=Zr.programConfigurations.get(he.id),En=fe.useProgram("circle",fn),Nn=Zr.layoutVertexBuffer,jn=Zr.indexBuffer,Qn=gt(fe,Hr,Fr,he),Kn={programConfiguration:fn,program:En,layoutVertexBuffer:Nn,indexBuffer:jn,uniformValues:Qn};if(Ze)for(var ha=Zr.segments.get(),xa=0,ma=ha;xa<ma.length;xa+=1){var Ta=ma[xa];Tr.push({segments:new e.SegmentVector([Ta]),sortKey:Ta.sortKey,state:Kn})}else Tr.push({segments:Zr.segments,sortKey:0,state:Kn})}}Ze&&Tr.sort(function(Ci,$i){return Ci.sortKey-$i.sortKey});for(var Pa=0,Za=Tr;Pa<Za.length;Pa+=1){var ai=Za[Pa],Ni=ai.state,ui=Ni.programConfiguration,wi=Ni.program,Va=Ni.layoutVertexBuffer,Ui=Ni.indexBuffer,Gi=Ni.uniformValues,Wi=ai.segments;wi.draw(ut,At.TRIANGLES,Ut,nr,sr,Xe.disabled,Gi,he.id,Va,Ui,Wi,he.paint,fe.transform.zoom,ui)}}}}function bu(fe,Y,he,$){if(he.paint.get("heatmap-opacity")!==0)if(fe.renderPass==="offscreen"){var ve=fe.context,Se=ve.gl,Re=Kt.disabled,Ze=new we([Se.ONE,Se.ONE],e.Color.transparent,[!0,!0,!0,!0]);af(ve,fe,he),ve.clear({color:e.Color.transparent});for(var ut=0;ut<$.length;ut++){var At=$[ut];if(!Y.hasRenderableParent(At)){var Ut=Y.getTile(At),nr=Ut.getBucket(he);if(!!nr){var sr=nr.programConfigurations.get(he.id),Tr=fe.useProgram("heatmap",sr),Ur=fe.transform,Hr=Ur.zoom;Tr.draw(ve,Se.TRIANGLES,Qr.disabled,Re,Ze,Xe.disabled,Fn(At.posMatrix,Ut,Hr,he.paint.get("heatmap-intensity")),he.id,nr.layoutVertexBuffer,nr.indexBuffer,nr.segments,he.paint,fe.transform.zoom,sr)}}}ve.viewport.set([0,0,fe.width,fe.height])}else fe.renderPass==="translucent"&&(fe.context.setColorMode(fe.colorModeForRenderPass()),Ju(fe,he))}function af(fe,Y,he){var $=fe.gl;fe.activeTexture.set($.TEXTURE1),fe.viewport.set([0,0,Y.width/4,Y.height/4]);var ve=he.heatmapFbo;if(ve)$.bindTexture($.TEXTURE_2D,ve.colorAttachment.get()),fe.bindFramebuffer.set(ve.framebuffer);else{var Se=$.createTexture();$.bindTexture($.TEXTURE_2D,Se),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,$.LINEAR),ve=he.heatmapFbo=fe.createFramebuffer(Y.width/4,Y.height/4,!1),su(fe,Y,Se,ve)}}function su(fe,Y,he,$){var ve=fe.gl,Se=fe.extRenderToTextureHalfFloat?fe.extTextureHalfFloat.HALF_FLOAT_OES:ve.UNSIGNED_BYTE;ve.texImage2D(ve.TEXTURE_2D,0,ve.RGBA,Y.width/4,Y.height/4,0,ve.RGBA,Se,null),$.colorAttachment.set(he)}function Ju(fe,Y){var he=fe.context,$=he.gl,ve=Y.heatmapFbo;if(!!ve){he.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,ve.colorAttachment.get()),he.activeTexture.set($.TEXTURE1);var Se=Y.colorRampTexture;Se||(Se=Y.colorRampTexture=new e.Texture(he,Y.colorRamp,$.RGBA)),Se.bind($.LINEAR,$.CLAMP_TO_EDGE),fe.useProgram("heatmapTexture").draw(he,$.TRIANGLES,Qr.disabled,Kt.disabled,fe.colorModeForRenderPass(),Xe.disabled,Pn(fe,Y,0,1),Y.id,fe.viewportBuffer,fe.quadTriangleIndexBuffer,fe.viewportSegments,Y.paint,fe.transform.zoom)}}function Qu(fe,Y,he,$){if(fe.renderPass==="translucent"){var ve=he.paint.get("line-opacity"),Se=he.paint.get("line-width");if(!(ve.constantOr(1)===0||Se.constantOr(1)===0)){var Re=fe.depthModeForSublayer(0,Qr.ReadOnly),Ze=fe.colorModeForRenderPass(),ut=he.paint.get("line-dasharray"),At=he.paint.get("line-pattern"),Ut=At.constantOr(1),nr=he.paint.get("line-gradient"),sr=he.getCrossfadeParameters(),Tr=Ut?"linePattern":ut?"lineSDF":nr?"lineGradient":"line",Ur=fe.context,Hr=Ur.gl,Fr=!0;if(nr){Ur.activeTexture.set(Hr.TEXTURE0);var Zr=he.gradientTexture;if(!he.gradient)return;Zr||(Zr=he.gradientTexture=new e.Texture(Ur,he.gradient,Hr.RGBA)),Zr.bind(Hr.LINEAR,Hr.CLAMP_TO_EDGE)}for(var fn=0,En=$;fn<En.length;fn+=1){var Nn=En[fn],jn=Y.getTile(Nn);if(!(Ut&&!jn.patternsLoaded())){var Qn=jn.getBucket(he);if(!!Qn){var Kn=Qn.programConfigurations.get(he.id),ha=fe.context.program.get(),xa=fe.useProgram(Tr,Kn),ma=Fr||xa.program!==ha,Ta=At.constantOr(null);if(Ta&&jn.imageAtlas){var Pa=jn.imageAtlas,Za=Pa.patternPositions[Ta.to.toString()],ai=Pa.patternPositions[Ta.from.toString()];Za&&ai&&Kn.setConstantPatternPositions(Za,ai)}var Ni=Ut?xi(fe,jn,he,sr):ut?bi(fe,jn,he,ut,sr):nr?Ti(fe,jn,he):qa(fe,jn,he);Ut?(Ur.activeTexture.set(Hr.TEXTURE0),jn.imageAtlasTexture.bind(Hr.LINEAR,Hr.CLAMP_TO_EDGE),Kn.updatePaintBuffers(sr)):ut&&(ma||fe.lineAtlas.dirty)&&(Ur.activeTexture.set(Hr.TEXTURE0),fe.lineAtlas.bind(Ur)),xa.draw(Ur,Hr.TRIANGLES,Re,fe.stencilModeForClipping(Nn),Ze,Xe.disabled,Ni,he.id,Qn.layoutVertexBuffer,Qn.indexBuffer,Qn.segments,he.paint,fe.transform.zoom,Kn),Fr=!1}}}}}}function es(fe,Y,he,$){var ve=he.paint.get("fill-color"),Se=he.paint.get("fill-opacity");if(Se.constantOr(1)!==0){var Re=fe.colorModeForRenderPass(),Ze=he.paint.get("fill-pattern"),ut=fe.opaquePassEnabledForLayer()&&!Ze.constantOr(1)&&ve.constantOr(e.Color.transparent).a===1&&Se.constantOr(0)===1?"opaque":"translucent";if(fe.renderPass===ut){var At=fe.depthModeForSublayer(1,fe.renderPass==="opaque"?Qr.ReadWrite:Qr.ReadOnly);ze(fe,Y,he,$,At,Re,!1)}if(fe.renderPass==="translucent"&&he.paint.get("fill-antialias")){var Ut=fe.depthModeForSublayer(he.getPaintProperty("fill-outline-color")?2:0,Qr.ReadOnly);ze(fe,Y,he,$,Ut,Re,!0)}}}function ze(fe,Y,he,$,ve,Se,Re){var Ze=fe.context.gl,ut=he.paint.get("fill-pattern"),At=ut&&ut.constantOr(1),Ut=he.getCrossfadeParameters(),nr,sr,Tr,Ur,Hr;Re?(sr=At&&!he.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",nr=Ze.LINES):(sr=At?"fillPattern":"fill",nr=Ze.TRIANGLES);for(var Fr=0,Zr=$;Fr<Zr.length;Fr+=1){var fn=Zr[Fr],En=Y.getTile(fn);if(!(At&&!En.patternsLoaded())){var Nn=En.getBucket(he);if(!!Nn){var jn=Nn.programConfigurations.get(he.id),Qn=fe.useProgram(sr,jn);At&&(fe.context.activeTexture.set(Ze.TEXTURE0),En.imageAtlasTexture.bind(Ze.LINEAR,Ze.CLAMP_TO_EDGE),jn.updatePaintBuffers(Ut));var Kn=ut.constantOr(null);if(Kn&&En.imageAtlas){var ha=En.imageAtlas,xa=ha.patternPositions[Kn.to.toString()],ma=ha.patternPositions[Kn.from.toString()];xa&&ma&&jn.setConstantPatternPositions(xa,ma)}var Ta=fe.translatePosMatrix(fn.posMatrix,En,he.paint.get("fill-translate"),he.paint.get("fill-translate-anchor"));if(!Re)Ur=Nn.indexBuffer,Hr=Nn.segments,Tr=At?Zo(Ta,fe,Ut,En):wo(Ta);else{Ur=Nn.indexBuffer2,Hr=Nn.segments2;var Pa=[Ze.drawingBufferWidth,Ze.drawingBufferHeight];Tr=sr==="fillOutlinePattern"&&At?Wl(Ta,fe,Ut,En,Pa):Yl(Ta,Pa)}Qn.draw(fe.context,nr,ve,fe.stencilModeForClipping(fn),Se,Xe.disabled,Tr,he.id,Nn.layoutVertexBuffer,Ur,Hr,he.paint,fe.transform.zoom,jn)}}}}function Ye(fe,Y,he,$){var ve=he.paint.get("fill-extrusion-opacity");if(ve!==0&&fe.renderPass==="translucent"){var Se=new Qr(fe.context.gl.LEQUAL,Qr.ReadWrite,fe.depthRangeFor3D);if(ve===1&&!he.paint.get("fill-extrusion-pattern").constantOr(1)){var Re=fe.colorModeForRenderPass();qe(fe,Y,he,$,Se,Kt.disabled,Re)}else qe(fe,Y,he,$,Se,Kt.disabled,we.disabled),qe(fe,Y,he,$,Se,fe.stencilModeFor3D(),fe.colorModeForRenderPass())}}function qe(fe,Y,he,$,ve,Se,Re){for(var Ze=fe.context,ut=Ze.gl,At=he.paint.get("fill-extrusion-pattern"),Ut=At.constantOr(1),nr=he.getCrossfadeParameters(),sr=he.paint.get("fill-extrusion-opacity"),Tr=0,Ur=$;Tr<Ur.length;Tr+=1){var Hr=Ur[Tr],Fr=Y.getTile(Hr),Zr=Fr.getBucket(he);if(!!Zr){var fn=Zr.programConfigurations.get(he.id),En=fe.useProgram(Ut?"fillExtrusionPattern":"fillExtrusion",fn);Ut&&(fe.context.activeTexture.set(ut.TEXTURE0),Fr.imageAtlasTexture.bind(ut.LINEAR,ut.CLAMP_TO_EDGE),fn.updatePaintBuffers(nr));var Nn=At.constantOr(null);if(Nn&&Fr.imageAtlas){var jn=Fr.imageAtlas,Qn=jn.patternPositions[Nn.to.toString()],Kn=jn.patternPositions[Nn.from.toString()];Qn&&Kn&&fn.setConstantPatternPositions(Qn,Kn)}var ha=fe.translatePosMatrix(Hr.posMatrix,Fr,he.paint.get("fill-extrusion-translate"),he.paint.get("fill-extrusion-translate-anchor")),xa=he.paint.get("fill-extrusion-vertical-gradient"),ma=Ut?Ds(ha,fe,xa,sr,Hr,nr,Fr):qo(ha,fe,xa,sr);En.draw(Ze,Ze.gl.TRIANGLES,ve,Se,Re,Xe.backCCW,ma,he.id,Zr.layoutVertexBuffer,Zr.indexBuffer,Zr.segments,he.paint,fe.transform.zoom,fn)}}}function st(fe,Y,he,$){if(!(fe.renderPass!=="offscreen"&&fe.renderPass!=="translucent")){for(var ve=fe.context,Se=Y.getSource().maxzoom,Re=fe.depthModeForSublayer(0,Qr.ReadOnly),Ze=fe.colorModeForRenderPass(),ut=fe.renderPass==="translucent"?fe.stencilConfigForOverlap($):[{},$],At=ut[0],Ut=ut[1],nr=0,sr=Ut;nr<sr.length;nr+=1){var Tr=sr[nr],Ur=Y.getTile(Tr);Ur.needsHillshadePrepare&&fe.renderPass==="offscreen"?yt(fe,Ur,he,Se,Re,Kt.disabled,Ze):fe.renderPass==="translucent"&&mt(fe,Ur,he,Re,At[Tr.overscaledZ],Ze)}ve.viewport.set([0,0,fe.width,fe.height])}}function mt(fe,Y,he,$,ve,Se){var Re=fe.context,Ze=Re.gl,ut=Y.fbo;if(!!ut){var At=fe.useProgram("hillshade");Re.activeTexture.set(Ze.TEXTURE0),Ze.bindTexture(Ze.TEXTURE_2D,ut.colorAttachment.get());var Ut=Ha(fe,Y,he);At.draw(Re,Ze.TRIANGLES,$,ve,Se,Xe.disabled,Ut,he.id,fe.rasterBoundsBuffer,fe.quadTriangleIndexBuffer,fe.rasterBoundsSegments)}}function yt(fe,Y,he,$,ve,Se,Re){var Ze=fe.context,ut=Ze.gl,At=Y.dem;if(At&&At.data){var Ut=At.dim,nr=At.stride,sr=At.getPixels();if(Ze.activeTexture.set(ut.TEXTURE1),Ze.pixelStoreUnpackPremultiplyAlpha.set(!1),Y.demTexture=Y.demTexture||fe.getTileTexture(nr),Y.demTexture){var Tr=Y.demTexture;Tr.update(sr,{premultiply:!1}),Tr.bind(ut.NEAREST,ut.CLAMP_TO_EDGE)}else Y.demTexture=new e.Texture(Ze,sr,ut.RGBA,{premultiply:!1}),Y.demTexture.bind(ut.NEAREST,ut.CLAMP_TO_EDGE);Ze.activeTexture.set(ut.TEXTURE0);var Ur=Y.fbo;if(!Ur){var Hr=new e.Texture(Ze,{width:Ut,height:Ut,data:null},ut.RGBA);Hr.bind(ut.LINEAR,ut.CLAMP_TO_EDGE),Ur=Y.fbo=Ze.createFramebuffer(Ut,Ut,!0),Ur.colorAttachment.set(Hr.texture)}Ze.bindFramebuffer.set(Ur.framebuffer),Ze.viewport.set([0,0,Ut,Ut]),fe.useProgram("hillshadePrepare").draw(Ze,ut.TRIANGLES,ve,Se,Re,Xe.disabled,La(Y.tileID,At,$),he.id,fe.rasterBoundsBuffer,fe.quadTriangleIndexBuffer,fe.rasterBoundsSegments),Y.needsHillshadePrepare=!1}}function Tt(fe,Y,he,$){if(fe.renderPass==="translucent"&&he.paint.get("raster-opacity")!==0&&!!$.length)for(var ve=fe.context,Se=ve.gl,Re=Y.getSource(),Ze=fe.useProgram("raster"),ut=fe.colorModeForRenderPass(),At=Re instanceof q?[{},$]:fe.stencilConfigForOverlap($),Ut=At[0],nr=At[1],sr=nr[nr.length-1].overscaledZ,Tr=!fe.options.moving,Ur=0,Hr=nr;Ur<Hr.length;Ur+=1){var Fr=Hr[Ur],Zr=fe.depthModeForSublayer(Fr.overscaledZ-sr,he.paint.get("raster-opacity")===1?Qr.ReadWrite:Qr.ReadOnly,Se.LESS),fn=Y.getTile(Fr),En=fe.transform.calculatePosMatrix(Fr.toUnwrapped(),Tr);fn.registerFadeDuration(he.paint.get("raster-fade-duration"));var Nn=Y.findLoadedParent(Fr,0),jn=ar(fn,Nn,Y,he,fe.transform),Qn=void 0,Kn=void 0,ha=he.paint.get("raster-resampling")==="nearest"?Se.NEAREST:Se.LINEAR;ve.activeTexture.set(Se.TEXTURE0),fn.texture.bind(ha,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),ve.activeTexture.set(Se.TEXTURE1),Nn?(Nn.texture.bind(ha,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST),Qn=Math.pow(2,Nn.tileID.overscaledZ-fn.tileID.overscaledZ),Kn=[fn.tileID.canonical.x*Qn%1,fn.tileID.canonical.y*Qn%1]):fn.texture.bind(ha,Se.CLAMP_TO_EDGE,Se.LINEAR_MIPMAP_NEAREST);var xa=so(En,Kn||[0,0],Qn||1,jn,he);Re instanceof q?Ze.draw(ve,Se.TRIANGLES,Zr,Kt.disabled,ut,Xe.disabled,xa,he.id,Re.boundsBuffer,fe.quadTriangleIndexBuffer,Re.boundsSegments):Ze.draw(ve,Se.TRIANGLES,Zr,Ut[Fr.overscaledZ],ut,Xe.disabled,xa,he.id,fe.rasterBoundsBuffer,fe.quadTriangleIndexBuffer,fe.rasterBoundsSegments)}}function ar(fe,Y,he,$,ve){var Se=$.paint.get("raster-fade-duration");if(Se>0){var Re=e.browser.now(),Ze=(Re-fe.timeAdded)/Se,ut=Y?(Re-Y.timeAdded)/Se:-1,At=he.getSource(),Ut=ve.coveringZoomLevel({tileSize:At.tileSize,roundZoom:At.roundZoom}),nr=!Y||Math.abs(Y.tileID.overscaledZ-Ut)>Math.abs(fe.tileID.overscaledZ-Ut),sr=nr&&fe.refreshedUponExpiration?1:e.clamp(nr?Ze:1-ut,0,1);return fe.refreshedUponExpiration&&Ze>=1&&(fe.refreshedUponExpiration=!1),Y?{opacity:1,mix:1-sr}:{opacity:sr,mix:0}}else return{opacity:1,mix:0}}function lr(fe,Y,he){var $=he.paint.get("background-color"),ve=he.paint.get("background-opacity");if(ve!==0){var Se=fe.context,Re=Se.gl,Ze=fe.transform,ut=Ze.tileSize,At=he.paint.get("background-pattern");if(!fe.isPatternMissing(At)){var Ut=!At&&$.a===1&&ve===1&&fe.opaquePassEnabledForLayer()?"opaque":"translucent";if(fe.renderPass===Ut){var nr=Kt.disabled,sr=fe.depthModeForSublayer(0,Ut==="opaque"?Qr.ReadWrite:Qr.ReadOnly),Tr=fe.colorModeForRenderPass(),Ur=fe.useProgram(At?"backgroundPattern":"background"),Hr=Ze.coveringTiles({tileSize:ut});At&&(Se.activeTexture.set(Re.TEXTURE0),fe.imageManager.bind(fe.context));for(var Fr=he.getCrossfadeParameters(),Zr=0,fn=Hr;Zr<fn.length;Zr+=1){var En=fn[Zr],Nn=fe.transform.calculatePosMatrix(En.toUnwrapped()),jn=At?vl(Nn,ve,fe,At,{tileID:En,tileSize:ut},Fr):Is(Nn,ve,$);Ur.draw(Se,Re.TRIANGLES,sr,nr,Tr,Xe.disabled,jn,he.id,fe.tileExtentBuffer,fe.quadTriangleIndexBuffer,fe.tileExtentSegments)}}}}}var rr=new e.Color(1,0,0,1),hr=new e.Color(0,1,0,1),kr=new e.Color(0,0,1,1),Yr=new e.Color(1,0,1,1),$r=new e.Color(0,1,1,1);function xn(fe){var Y=fe.transform.padding,he=3;Wn(fe,fe.transform.height-(Y.top||0),he,rr),Wn(fe,Y.bottom||0,he,hr),ba(fe,Y.left||0,he,kr),ba(fe,fe.transform.width-(Y.right||0),he,Yr);var $=fe.transform.centerPoint;Rn(fe,$.x,fe.transform.height-$.y,$r)}function Rn(fe,Y,he,$){var ve=20,Se=2;Wa(fe,Y-Se/2,he-ve/2,Se,ve,$),Wa(fe,Y-ve/2,he-Se/2,ve,Se,$)}function Wn(fe,Y,he,$){Wa(fe,0,Y+he/2,fe.transform.width,he,$)}function ba(fe,Y,he,$){Wa(fe,Y-he/2,0,he,fe.transform.height,$)}function Wa(fe,Y,he,$,ve,Se){var Re=fe.context,Ze=Re.gl;Ze.enable(Ze.SCISSOR_TEST),Ze.scissor(Y*e.browser.devicePixelRatio,he*e.browser.devicePixelRatio,$*e.browser.devicePixelRatio,ve*e.browser.devicePixelRatio),Re.clear({color:Se}),Ze.disable(Ze.SCISSOR_TEST)}function Ja(fe,Y,he){for(var $=0;$<he.length;$++)Qa(fe,Y,he[$])}function Qa(fe,Y,he){var $=fe.context,ve=$.gl,Se=he.posMatrix,Re=fe.useProgram("debug"),Ze=Qr.disabled,ut=Kt.disabled,At=fe.colorModeForRenderPass(),Ut="$debug";$.activeTexture.set(ve.TEXTURE0),fe.emptyTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),Re.draw($,ve.LINE_STRIP,Ze,ut,At,Xe.disabled,pn(Se,e.Color.red),Ut,fe.debugBuffer,fe.tileBorderIndexBuffer,fe.debugSegments);var nr=Y.getTileByID(he.key).latestRawTileData,sr=nr&&nr.byteLength||0,Tr=Math.floor(sr/1024),Ur=Y.getTile(he).tileSize,Hr=512/Math.min(Ur,512)*(he.overscaledZ/fe.transform.zoom)*.5,Fr=he.canonical.toString();he.overscaledZ!==he.canonical.z&&(Fr+=" => "+he.overscaledZ);var Zr=Fr+" "+Tr+"kb";ri(fe,Zr),Re.draw($,ve.TRIANGLES,Ze,ut,we.alphaBlended,Xe.disabled,pn(Se,e.Color.transparent,Hr),Ut,fe.debugBuffer,fe.quadTriangleIndexBuffer,fe.debugSegments)}function ri(fe,Y){fe.initDebugOverlayCanvas();var he=fe.debugOverlayCanvas,$=fe.context.gl,ve=fe.debugOverlayCanvas.getContext("2d");ve.clearRect(0,0,he.width,he.height),ve.shadowColor="white",ve.shadowBlur=2,ve.lineWidth=1.5,ve.strokeStyle="white",ve.textBaseline="top",ve.font="bold "+36+"px Open Sans, sans-serif",ve.fillText(Y,5,5),ve.strokeText(Y,5,5),fe.debugOverlayTexture.update(he),fe.debugOverlayTexture.bind($.LINEAR,$.CLAMP_TO_EDGE)}function yi(fe,Y,he){var $=fe.context,ve=he.implementation;if(fe.renderPass==="offscreen"){var Se=ve.prerender;Se&&(fe.setCustomLayerDefaults(),$.setColorMode(fe.colorModeForRenderPass()),Se.call(ve,$.gl,fe.transform.customLayerMatrix()),$.setDirty(),fe.setBaseState())}else if(fe.renderPass==="translucent"){fe.setCustomLayerDefaults(),$.setColorMode(fe.colorModeForRenderPass()),$.setStencilMode(Kt.disabled);var Re=ve.renderingMode==="3d"?new Qr(fe.context.gl.LEQUAL,Qr.ReadWrite,fe.depthRangeFor3D):fe.depthModeForSublayer(0,Qr.ReadOnly);$.setDepthMode(Re),ve.render($.gl,fe.transform.customLayerMatrix()),$.setDirty(),fe.setBaseState(),$.bindFramebuffer.set(null)}}var Xi={symbol:xu,circle:yl,heatmap:bu,line:Qu,fill:es,"fill-extrusion":Ye,hillshade:st,raster:Tt,background:lr,debug:Ja,custom:yi},Ga=function(Y,he){this.context=new Ke(Y),this.transform=he,this._tileTextures={},this.setup(),this.numSublayers=rt.maxUnderzooming+rt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new wa,this.gpuTimers={}};Ga.prototype.resize=function(Y,he){if(this.width=Y*e.browser.devicePixelRatio,this.height=he*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var $=0,ve=this.style._order;$<ve.length;$+=1){var Se=ve[$];this.style._layers[Se].resize()}},Ga.prototype.setup=function(){var Y=this.context,he=new e.StructArrayLayout2i4;he.emplaceBack(0,0),he.emplaceBack(e.EXTENT,0),he.emplaceBack(0,e.EXTENT),he.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=Y.createVertexBuffer(he,cs.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var $=new e.StructArrayLayout2i4;$.emplaceBack(0,0),$.emplaceBack(e.EXTENT,0),$.emplaceBack(0,e.EXTENT),$.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=Y.createVertexBuffer($,cs.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var ve=new e.StructArrayLayout4i8;ve.emplaceBack(0,0,0,0),ve.emplaceBack(e.EXTENT,0,e.EXTENT,0),ve.emplaceBack(0,e.EXTENT,0,e.EXTENT),ve.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=Y.createVertexBuffer(ve,se.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Se=new e.StructArrayLayout2i4;Se.emplaceBack(0,0),Se.emplaceBack(1,0),Se.emplaceBack(0,1),Se.emplaceBack(1,1),this.viewportBuffer=Y.createVertexBuffer(Se,cs.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var Re=new e.StructArrayLayout1ui2;Re.emplaceBack(0),Re.emplaceBack(1),Re.emplaceBack(3),Re.emplaceBack(2),Re.emplaceBack(0),this.tileBorderIndexBuffer=Y.createIndexBuffer(Re);var Ze=new e.StructArrayLayout3ui6;Ze.emplaceBack(0,1,2),Ze.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=Y.createIndexBuffer(Ze),this.emptyTexture=new e.Texture(Y,{width:1,height:1,data:new Uint8Array([0,0,0,0])},Y.gl.RGBA);var ut=this.context.gl;this.stencilClearMode=new Kt({func:ut.ALWAYS,mask:0},0,255,ut.ZERO,ut.ZERO,ut.ZERO)},Ga.prototype.clearStencil=function(){var Y=this.context,he=Y.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var $=e.create();e.ortho($,0,this.width,this.height,0,0,1),e.scale($,$,[he.drawingBufferWidth,he.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(Y,he.TRIANGLES,Qr.disabled,this.stencilClearMode,we.disabled,Xe.disabled,Ln($),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},Ga.prototype._renderTileClippingMasks=function(Y,he){if(!(this.currentStencilSource===Y.source||!Y.isTileClipped()||!he||!he.length)){this.currentStencilSource=Y.source;var $=this.context,ve=$.gl;this.nextStencilID+he.length>256&&this.clearStencil(),$.setColorMode(we.disabled),$.setDepthMode(Qr.disabled);var Se=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var Re=0,Ze=he;Re<Ze.length;Re+=1){var ut=Ze[Re],At=this._tileClippingMaskIDs[ut.key]=this.nextStencilID++;Se.draw($,ve.TRIANGLES,Qr.disabled,new Kt({func:ve.ALWAYS,mask:0},At,255,ve.KEEP,ve.KEEP,ve.REPLACE),we.disabled,Xe.disabled,Ln(ut.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},Ga.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var Y=this.nextStencilID++,he=this.context.gl;return new Kt({func:he.NOTEQUAL,mask:255},Y,255,he.KEEP,he.KEEP,he.REPLACE)},Ga.prototype.stencilModeForClipping=function(Y){var he=this.context.gl;return new Kt({func:he.EQUAL,mask:255},this._tileClippingMaskIDs[Y.key],0,he.KEEP,he.KEEP,he.REPLACE)},Ga.prototype.stencilConfigForOverlap=function(Y){var he,$=this.context.gl,ve=Y.sort(function(At,Ut){return Ut.overscaledZ-At.overscaledZ}),Se=ve[ve.length-1].overscaledZ,Re=ve[0].overscaledZ-Se+1;if(Re>1){this.currentStencilSource=void 0,this.nextStencilID+Re>256&&this.clearStencil();for(var Ze={},ut=0;ut<Re;ut++)Ze[ut+Se]=new Kt({func:$.GEQUAL,mask:255},ut+this.nextStencilID,255,$.KEEP,$.KEEP,$.REPLACE);return this.nextStencilID+=Re,[Ze,ve]}return[(he={},he[Se]=Kt.disabled,he),ve]},Ga.prototype.colorModeForRenderPass=function(){var Y=this.context.gl;if(this._showOverdrawInspector){var he=8,$=1/he;return new we([Y.CONSTANT_COLOR,Y.ONE],new e.Color($,$,$,0),[!0,!0,!0,!0])}else return this.renderPass==="opaque"?we.unblended:we.alphaBlended},Ga.prototype.depthModeForSublayer=function(Y,he,$){if(!this.opaquePassEnabledForLayer())return Qr.disabled;var ve=1-((1+this.currentLayer)*this.numSublayers+Y)*this.depthEpsilon;return new Qr($||this.context.gl.LEQUAL,he,[ve,ve])},Ga.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},Ga.prototype.render=function(Y,he){var $=this;this.style=Y,this.options=he,this.lineAtlas=Y.lineAtlas,this.imageManager=Y.imageManager,this.glyphManager=Y.glyphManager,this.symbolFadeChange=Y.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var ve=this.style._order,Se=this.style.sourceCaches;for(var Re in Se){var Ze=Se[Re];Ze.used&&Ze.prepare(this.context)}var ut={},At={},Ut={};for(var nr in Se){var sr=Se[nr];ut[nr]=sr.getVisibleCoordinates(),At[nr]=ut[nr].slice().reverse(),Ut[nr]=sr.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Tr=0;Tr<ve.length;Tr++){var Ur=ve[Tr];if(this.style._layers[Ur].is3D()){this.opaquePassCutoff=Tr;break}}this.renderPass="offscreen";for(var Hr=0,Fr=ve;Hr<Fr.length;Hr+=1){var Zr=Fr[Hr],fn=this.style._layers[Zr];if(!(!fn.hasOffscreenPass()||fn.isHidden(this.transform.zoom))){var En=At[fn.source];fn.type!=="custom"&&!En.length||this.renderLayer(this,Se[fn.source],fn,En)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:he.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=he.showOverdrawInspector,this.depthRangeFor3D=[0,1-(Y._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=ve.length-1;this.currentLayer>=0;this.currentLayer--){var Nn=this.style._layers[ve[this.currentLayer]],jn=Se[Nn.source],Qn=ut[Nn.source];this._renderTileClippingMasks(Nn,Qn),this.renderLayer(this,jn,Nn,Qn)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<ve.length;this.currentLayer++){var Kn=this.style._layers[ve[this.currentLayer]],ha=Se[Kn.source],xa=(Kn.type==="symbol"?Ut:At)[Kn.source];this._renderTileClippingMasks(Kn,ut[Kn.source]),this.renderLayer(this,ha,Kn,xa)}if(this.options.showTileBoundaries){var ma,Ta,Pa=e.values(this.style._layers);Pa.forEach(function(Za){Za.source&&!Za.isHidden($.transform.zoom)&&(Za.source!==(Ta&&Ta.id)&&(Ta=$.style.sourceCaches[Za.source]),(!ma||ma.getSource().maxzoom<Ta.getSource().maxzoom)&&(ma=Ta))}),ma&&Xi.debug(this,ma,ma.getVisibleCoordinates())}this.options.showPadding&&xn(this),this.context.setDefault()},Ga.prototype.renderLayer=function(Y,he,$,ve){$.isHidden(this.transform.zoom)||$.type!=="background"&&$.type!=="custom"&&!ve.length||(this.id=$.id,this.gpuTimingStart($),Xi[$.type](Y,he,$,ve,this.style.placement.variableOffsets),this.gpuTimingEnd())},Ga.prototype.gpuTimingStart=function(Y){if(!!this.options.gpuTiming){var he=this.context.extTimerQuery,$=this.gpuTimers[Y.id];$||($=this.gpuTimers[Y.id]={calls:0,cpuTime:0,query:he.createQueryEXT()}),$.calls++,he.beginQueryEXT(he.TIME_ELAPSED_EXT,$.query)}},Ga.prototype.gpuTimingEnd=function(){if(!!this.options.gpuTiming){var Y=this.context.extTimerQuery;Y.endQueryEXT(Y.TIME_ELAPSED_EXT)}},Ga.prototype.collectGpuTimers=function(){var Y=this.gpuTimers;return this.gpuTimers={},Y},Ga.prototype.queryGpuTimers=function(Y){var he={};for(var $ in Y){var ve=Y[$],Se=this.context.extTimerQuery,Re=Se.getQueryObjectEXT(ve.query,Se.QUERY_RESULT_EXT)/(1e3*1e3);Se.deleteQueryEXT(ve.query),he[$]=Re}return he},Ga.prototype.translatePosMatrix=function(Y,he,$,ve,Se){if(!$[0]&&!$[1])return Y;var Re=Se?ve==="map"?this.transform.angle:0:ve==="viewport"?-this.transform.angle:0;if(Re){var Ze=Math.sin(Re),ut=Math.cos(Re);$=[$[0]*ut-$[1]*Ze,$[0]*Ze+$[1]*ut]}var At=[Se?$[0]:Tn(he,$[0],this.transform.zoom),Se?$[1]:Tn(he,$[1],this.transform.zoom),0],Ut=new Float32Array(16);return e.translate(Ut,Y,At),Ut},Ga.prototype.saveTileTexture=function(Y){var he=this._tileTextures[Y.size[0]];he?he.push(Y):this._tileTextures[Y.size[0]]=[Y]},Ga.prototype.getTileTexture=function(Y){var he=this._tileTextures[Y];return he&&he.length>0?he.pop():null},Ga.prototype.isPatternMissing=function(Y){if(!Y)return!1;if(!Y.from||!Y.to)return!0;var he=this.imageManager.getPattern(Y.from.toString()),$=this.imageManager.getPattern(Y.to.toString());return!he||!$},Ga.prototype.useProgram=function(Y,he){this.cache=this.cache||{};var $=""+Y+(he?he.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[$]||(this.cache[$]=new os(this.context,cl[Y],he,pl[Y],this._showOverdrawInspector)),this.cache[$]},Ga.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},Ga.prototype.setBaseState=function(){var Y=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(Y.FUNC_ADD)},Ga.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var Y=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,Y.RGBA)}},Ga.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var qi=function(Y,he){this.points=Y,this.planes=he};qi.fromInvProjectionMatrix=function(Y,he,$){var ve=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]],Se=Math.pow(2,$),Re=ve.map(function(At){return e.transformMat4([],At,Y)}).map(function(At){return e.scale$1([],At,1/At[3]/he*Se)}),Ze=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]],ut=Ze.map(function(At){var Ut=e.sub([],Re[At[0]],Re[At[1]]),nr=e.sub([],Re[At[2]],Re[At[1]]),sr=e.normalize([],e.cross([],Ut,nr)),Tr=-e.dot(sr,Re[At[1]]);return sr.concat(Tr)});return new qi(Re,ut)};var Zi=function(Y,he){this.min=Y,this.max=he,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Zi.prototype.quadrant=function(Y){for(var he=[Y%2===0,Y<2],$=e.clone$2(this.min),ve=e.clone$2(this.max),Se=0;Se<he.length;Se++)$[Se]=he[Se]?this.min[Se]:this.center[Se],ve[Se]=he[Se]?this.center[Se]:this.max[Se];return ve[2]=this.max[2],new Zi($,ve)},Zi.prototype.distanceX=function(Y){var he=Math.max(Math.min(this.max[0],Y[0]),this.min[0]);return he-Y[0]},Zi.prototype.distanceY=function(Y){var he=Math.max(Math.min(this.max[1],Y[1]),this.min[1]);return he-Y[1]},Zi.prototype.intersects=function(Y){for(var he=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],$=!0,ve=0;ve<Y.planes.length;ve++){for(var Se=Y.planes[ve],Re=0,Ze=0;Ze<he.length;Ze++)Re+=e.dot$1(Se,he[Ze])>=0;if(Re===0)return 0;Re!==he.length&&($=!1)}if($)return 2;for(var ut=0;ut<3;ut++){for(var At=Number.MAX_VALUE,Ut=-Number.MAX_VALUE,nr=0;nr<Y.points.length;nr++){var sr=Y.points[nr][ut]-this.min[ut];At=Math.min(At,sr),Ut=Math.max(Ut,sr)}if(Ut<0||At>this.max[ut]-this.min[ut])return 0}return 1};var po=function(Y,he,$,ve){if(Y===void 0&&(Y=0),he===void 0&&(he=0),$===void 0&&($=0),ve===void 0&&(ve=0),isNaN(Y)||Y<0||isNaN(he)||he<0||isNaN($)||$<0||isNaN(ve)||ve<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=Y,this.bottom=he,this.left=$,this.right=ve};po.prototype.interpolate=function(Y,he,$){return he.top!=null&&Y.top!=null&&(this.top=e.number(Y.top,he.top,$)),he.bottom!=null&&Y.bottom!=null&&(this.bottom=e.number(Y.bottom,he.bottom,$)),he.left!=null&&Y.left!=null&&(this.left=e.number(Y.left,he.left,$)),he.right!=null&&Y.right!=null&&(this.right=e.number(Y.right,he.right,$)),this},po.prototype.getCenter=function(Y,he){var $=e.clamp((this.left+Y-this.right)/2,0,Y),ve=e.clamp((this.top+he-this.bottom)/2,0,he);return new e.Point($,ve)},po.prototype.equals=function(Y){return this.top===Y.top&&this.bottom===Y.bottom&&this.left===Y.left&&this.right===Y.right},po.prototype.clone=function(){return new po(this.top,this.bottom,this.left,this.right)},po.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var _i=function(Y,he,$,ve,Se){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=Se===void 0?!0:Se,this._minZoom=Y||0,this._maxZoom=he||22,this._minPitch=$??0,this._maxPitch=ve??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new po,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ri={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};_i.prototype.clone=function(){var Y=new _i(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return Y.tileSize=this.tileSize,Y.latRange=this.latRange,Y.width=this.width,Y.height=this.height,Y._center=this._center,Y.zoom=this.zoom,Y.angle=this.angle,Y._fov=this._fov,Y._pitch=this._pitch,Y._unmodified=this._unmodified,Y._edgeInsets=this._edgeInsets.clone(),Y._calcMatrices(),Y},Ri.minZoom.get=function(){return this._minZoom},Ri.minZoom.set=function(fe){this._minZoom!==fe&&(this._minZoom=fe,this.zoom=Math.max(this.zoom,fe))},Ri.maxZoom.get=function(){return this._maxZoom},Ri.maxZoom.set=function(fe){this._maxZoom!==fe&&(this._maxZoom=fe,this.zoom=Math.min(this.zoom,fe))},Ri.minPitch.get=function(){return this._minPitch},Ri.minPitch.set=function(fe){this._minPitch!==fe&&(this._minPitch=fe,this.pitch=Math.max(this.pitch,fe))},Ri.maxPitch.get=function(){return this._maxPitch},Ri.maxPitch.set=function(fe){this._maxPitch!==fe&&(this._maxPitch=fe,this.pitch=Math.min(this.pitch,fe))},Ri.renderWorldCopies.get=function(){return this._renderWorldCopies},Ri.renderWorldCopies.set=function(fe){fe===void 0?fe=!0:fe===null&&(fe=!1),this._renderWorldCopies=fe},Ri.worldSize.get=function(){return this.tileSize*this.scale},Ri.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ri.size.get=function(){return new e.Point(this.width,this.height)},Ri.bearing.get=function(){return-this.angle/Math.PI*180},Ri.bearing.set=function(fe){var Y=-e.wrap(fe,-180,180)*Math.PI/180;this.angle!==Y&&(this._unmodified=!1,this.angle=Y,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ri.pitch.get=function(){return this._pitch/Math.PI*180},Ri.pitch.set=function(fe){var Y=e.clamp(fe,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==Y&&(this._unmodified=!1,this._pitch=Y,this._calcMatrices())},Ri.fov.get=function(){return this._fov/Math.PI*180},Ri.fov.set=function(fe){fe=Math.max(.01,Math.min(60,fe)),this._fov!==fe&&(this._unmodified=!1,this._fov=fe/180*Math.PI,this._calcMatrices())},Ri.zoom.get=function(){return this._zoom},Ri.zoom.set=function(fe){var Y=Math.min(Math.max(fe,this.minZoom),this.maxZoom);this._zoom!==Y&&(this._unmodified=!1,this._zoom=Y,this.scale=this.zoomScale(Y),this.tileZoom=Math.floor(Y),this.zoomFraction=Y-this.tileZoom,this._constrain(),this._calcMatrices())},Ri.center.get=function(){return this._center},Ri.center.set=function(fe){fe.lat===this._center.lat&&fe.lng===this._center.lng||(this._unmodified=!1,this._center=fe,this._constrain(),this._calcMatrices())},Ri.padding.get=function(){return this._edgeInsets.toJSON()},Ri.padding.set=function(fe){this._edgeInsets.equals(fe)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,fe,1),this._calcMatrices())},Ri.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},_i.prototype.isPaddingEqual=function(Y){return this._edgeInsets.equals(Y)},_i.prototype.interpolatePadding=function(Y,he,$){this._unmodified=!1,this._edgeInsets.interpolate(Y,he,$),this._constrain(),this._calcMatrices()},_i.prototype.coveringZoomLevel=function(Y){var he=(Y.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/Y.tileSize));return Math.max(0,he)},_i.prototype.getVisibleUnwrappedCoordinates=function(Y){var he=[new e.UnwrappedTileID(0,Y)];if(this._renderWorldCopies)for(var $=this.pointCoordinate(new e.Point(0,0)),ve=this.pointCoordinate(new e.Point(this.width,0)),Se=this.pointCoordinate(new e.Point(this.width,this.height)),Re=this.pointCoordinate(new e.Point(0,this.height)),Ze=Math.floor(Math.min($.x,ve.x,Se.x,Re.x)),ut=Math.floor(Math.max($.x,ve.x,Se.x,Re.x)),At=1,Ut=Ze-At;Ut<=ut+At;Ut++)Ut!==0&&he.push(new e.UnwrappedTileID(Ut,Y));return he},_i.prototype.coveringTiles=function(Y){var he=this.coveringZoomLevel(Y),$=he;if(Y.minzoom!==void 0&&he<Y.minzoom)return[];Y.maxzoom!==void 0&&he>Y.maxzoom&&(he=Y.maxzoom);var ve=e.MercatorCoordinate.fromLngLat(this.center),Se=Math.pow(2,he),Re=[Se*ve.x,Se*ve.y,0],Ze=qi.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,he),ut=Y.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ut=he);var At=3,Ut=function(Pa){return{aabb:new Zi([Pa*Se,0,0],[(Pa+1)*Se,Se,0]),zoom:0,x:0,y:0,wrap:Pa,fullyVisible:!1}},nr=[],sr=[],Tr=he,Ur=Y.reparseOverscaled?$:he;if(this._renderWorldCopies)for(var Hr=1;Hr<=3;Hr++)nr.push(Ut(-Hr)),nr.push(Ut(Hr));for(nr.push(Ut(0));nr.length>0;){var Fr=nr.pop(),Zr=Fr.x,fn=Fr.y,En=Fr.fullyVisible;if(!En){var Nn=Fr.aabb.intersects(Ze);if(Nn===0)continue;En=Nn===2}var jn=Fr.aabb.distanceX(Re),Qn=Fr.aabb.distanceY(Re),Kn=Math.max(Math.abs(jn),Math.abs(Qn)),ha=At+(1<<Tr-Fr.zoom)-2;if(Fr.zoom===Tr||Kn>ha&&Fr.zoom>=ut){sr.push({tileID:new e.OverscaledTileID(Fr.zoom===Tr?Ur:Fr.zoom,Fr.wrap,Fr.zoom,Zr,fn),distanceSq:e.sqrLen([Re[0]-.5-Zr,Re[1]-.5-fn])});continue}for(var xa=0;xa<4;xa++){var ma=(Zr<<1)+xa%2,Ta=(fn<<1)+(xa>>1);nr.push({aabb:Fr.aabb.quadrant(xa),zoom:Fr.zoom+1,x:ma,y:Ta,wrap:Fr.wrap,fullyVisible:En})}}return sr.sort(function(Pa,Za){return Pa.distanceSq-Za.distanceSq}).map(function(Pa){return Pa.tileID})},_i.prototype.resize=function(Y,he){this.width=Y,this.height=he,this.pixelsToGLUnits=[2/Y,-2/he],this._constrain(),this._calcMatrices()},Ri.unmodified.get=function(){return this._unmodified},_i.prototype.zoomScale=function(Y){return Math.pow(2,Y)},_i.prototype.scaleZoom=function(Y){return Math.log(Y)/Math.LN2},_i.prototype.project=function(Y){var he=e.clamp(Y.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(Y.lng)*this.worldSize,e.mercatorYfromLat(he)*this.worldSize)},_i.prototype.unproject=function(Y){return new e.MercatorCoordinate(Y.x/this.worldSize,Y.y/this.worldSize).toLngLat()},Ri.point.get=function(){return this.project(this.center)},_i.prototype.setLocationAtPoint=function(Y,he){var $=this.pointCoordinate(he),ve=this.pointCoordinate(this.centerPoint),Se=this.locationCoordinate(Y),Re=new e.MercatorCoordinate(Se.x-($.x-ve.x),Se.y-($.y-ve.y));this.center=this.coordinateLocation(Re),this._renderWorldCopies&&(this.center=this.center.wrap())},_i.prototype.locationPoint=function(Y){return this.coordinatePoint(this.locationCoordinate(Y))},_i.prototype.pointLocation=function(Y){return this.coordinateLocation(this.pointCoordinate(Y))},_i.prototype.locationCoordinate=function(Y){return e.MercatorCoordinate.fromLngLat(Y)},_i.prototype.coordinateLocation=function(Y){return Y.toLngLat()},_i.prototype.pointCoordinate=function(Y){var he=0,$=[Y.x,Y.y,0,1],ve=[Y.x,Y.y,1,1];e.transformMat4($,$,this.pixelMatrixInverse),e.transformMat4(ve,ve,this.pixelMatrixInverse);var Se=$[3],Re=ve[3],Ze=$[0]/Se,ut=ve[0]/Re,At=$[1]/Se,Ut=ve[1]/Re,nr=$[2]/Se,sr=ve[2]/Re,Tr=nr===sr?0:(he-nr)/(sr-nr);return new e.MercatorCoordinate(e.number(Ze,ut,Tr)/this.worldSize,e.number(At,Ut,Tr)/this.worldSize)},_i.prototype.coordinatePoint=function(Y){var he=[Y.x*this.worldSize,Y.y*this.worldSize,0,1];return e.transformMat4(he,he,this.pixelMatrix),new e.Point(he[0]/he[3],he[1]/he[3])},_i.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},_i.prototype.getMaxBounds=function(){return!this.latRange||this.latRange.length!==2||!this.lngRange||this.lngRange.length!==2?null:new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]])},_i.prototype.setMaxBounds=function(Y){Y?(this.lngRange=[Y.getWest(),Y.getEast()],this.latRange=[Y.getSouth(),Y.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},_i.prototype.calculatePosMatrix=function(Y,he){he===void 0&&(he=!1);var $=Y.key,ve=he?this._alignedPosMatrixCache:this._posMatrixCache;if(ve[$])return ve[$];var Se=Y.canonical,Re=this.worldSize/this.zoomScale(Se.z),Ze=Se.x+Math.pow(2,Se.z)*Y.wrap,ut=e.identity(new Float64Array(16));return e.translate(ut,ut,[Ze*Re,Se.y*Re,0]),e.scale(ut,ut,[Re/e.EXTENT,Re/e.EXTENT,1]),e.multiply(ut,he?this.alignedProjMatrix:this.projMatrix,ut),ve[$]=new Float32Array(ut),ve[$]},_i.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},_i.prototype._constrain=function(){if(!(!this.center||!this.width||!this.height||this._constraining)){this._constraining=!0;var Y=-90,he=90,$=-180,ve=180,Se,Re,Ze,ut,At=this.size,Ut=this._unmodified;if(this.latRange){var nr=this.latRange;Y=e.mercatorYfromLat(nr[1])*this.worldSize,he=e.mercatorYfromLat(nr[0])*this.worldSize,Se=he-Y<At.y?At.y/(he-Y):0}if(this.lngRange){var sr=this.lngRange;$=e.mercatorXfromLng(sr[0])*this.worldSize,ve=e.mercatorXfromLng(sr[1])*this.worldSize,Re=ve-$<At.x?At.x/(ve-$):0}var Tr=this.point,Ur=Math.max(Re||0,Se||0);if(Ur){this.center=this.unproject(new e.Point(Re?(ve+$)/2:Tr.x,Se?(he+Y)/2:Tr.y)),this.zoom+=this.scaleZoom(Ur),this._unmodified=Ut,this._constraining=!1;return}if(this.latRange){var Hr=Tr.y,Fr=At.y/2;Hr-Fr<Y&&(ut=Y+Fr),Hr+Fr>he&&(ut=he-Fr)}if(this.lngRange){var Zr=Tr.x,fn=At.x/2;Zr-fn<$&&(Ze=$+fn),Zr+fn>ve&&(Ze=ve-fn)}(Ze!==void 0||ut!==void 0)&&(this.center=this.unproject(new e.Point(Ze!==void 0?Ze:Tr.x,ut!==void 0?ut:Tr.y))),this._unmodified=Ut,this._constraining=!1}},_i.prototype._calcMatrices=function(){if(!!this.height){var Y=this._fov/2,he=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(Y)*this.height;var $=Math.PI/2+this._pitch,ve=this._fov*(.5+he.y/this.height),Se=Math.sin(ve)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-$-ve,.01,Math.PI-.01)),Re=this.point,Ze=Re.x,ut=Re.y,At=Math.cos(Math.PI/2-this._pitch)*Se+this.cameraToCenterDistance,Ut=At*1.01,nr=this.height/50,sr=new Float64Array(16);e.perspective(sr,this._fov,this.width/this.height,nr,Ut),sr[8]=-he.x*2/this.width,sr[9]=he.y*2/this.height,e.scale(sr,sr,[1,-1,1]),e.translate(sr,sr,[0,0,-this.cameraToCenterDistance]),e.rotateX(sr,sr,this._pitch),e.rotateZ(sr,sr,this.angle),e.translate(sr,sr,[-Ze,-ut,0]),this.mercatorMatrix=e.scale([],sr,[this.worldSize,this.worldSize,this.worldSize]),e.scale(sr,sr,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=sr,this.invProjMatrix=e.invert([],this.projMatrix);var Tr=this.width%2/2,Ur=this.height%2/2,Hr=Math.cos(this.angle),Fr=Math.sin(this.angle),Zr=Ze-Math.round(Ze)+Hr*Tr+Fr*Ur,fn=ut-Math.round(ut)+Hr*Ur+Fr*Tr,En=new Float64Array(sr);if(e.translate(En,En,[Zr>.5?Zr-1:Zr,fn>.5?fn-1:fn,0]),this.alignedProjMatrix=En,sr=e.create(),e.scale(sr,sr,[this.width/2,-this.height/2,1]),e.translate(sr,sr,[1,-1,0]),this.labelPlaneMatrix=sr,sr=e.create(),e.scale(sr,sr,[1,-1,1]),e.translate(sr,sr,[-1,-1,0]),e.scale(sr,sr,[2/this.width,2/this.height,1]),this.glCoordMatrix=sr,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),sr=e.invert(new Float64Array(16),this.pixelMatrix),!sr)throw new Error("failed to invert matrix");this.pixelMatrixInverse=sr,this._posMatrixCache={},this._alignedPosMatrixCache={}}},_i.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var Y=this.pointCoordinate(new e.Point(0,0)),he=[Y.x*this.worldSize,Y.y*this.worldSize,0,1],$=e.transformMat4(he,he,this.pixelMatrix);return $[3]/this.cameraToCenterDistance},_i.prototype.getCameraPoint=function(){var Y=this._pitch,he=Math.tan(Y)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,he))},_i.prototype.getCameraQueryGeometry=function(Y){var he=this.getCameraPoint();if(Y.length===1)return[Y[0],he];for(var $=he.x,ve=he.y,Se=he.x,Re=he.y,Ze=0,ut=Y;Ze<ut.length;Ze+=1){var At=ut[Ze];$=Math.min($,At.x),ve=Math.min(ve,At.y),Se=Math.max(Se,At.x),Re=Math.max(Re,At.y)}return[new e.Point($,ve),new e.Point(Se,ve),new e.Point(Se,Re),new e.Point($,Re),new e.Point($,ve)]},Object.defineProperties(_i.prototype,Ri);function jo(fe,Y){var he=!1,$=null,ve=function(){$=null,he&&(fe(),$=setTimeout(ve,Y),he=!1)};return function(){return he=!0,$||ve(),$}}var go=function(Y){this._hashName=Y&&encodeURIComponent(Y),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=jo(this._updateHashUnthrottled.bind(this),30*1e3/100)};go.prototype.addTo=function(Y){return this._map=Y,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},go.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},go.prototype.getHashString=function(Y){var he=this._map.getCenter(),$=Math.round(this._map.getZoom()*100)/100,ve=Math.ceil(($*Math.LN2+Math.log(512/360/.5))/Math.LN10),Se=Math.pow(10,ve),Re=Math.round(he.lng*Se)/Se,Ze=Math.round(he.lat*Se)/Se,ut=this._map.getBearing(),At=this._map.getPitch(),Ut="";if(Y?Ut+="/"+Re+"/"+Ze+"/"+$:Ut+=$+"/"+Ze+"/"+Re,(ut||At)&&(Ut+="/"+Math.round(ut*10)/10),At&&(Ut+="/"+Math.round(At)),this._hashName){var nr=this._hashName,sr=!1,Tr=e.window.location.hash.slice(1).split("&").map(function(Ur){var Hr=Ur.split("=")[0];return Hr===nr?(sr=!0,Hr+"="+Ut):Ur}).filter(function(Ur){return Ur});return sr||Tr.push(nr+"="+Ut),"#"+Tr.join("&")}return"#"+Ut},go.prototype._getCurrentHash=function(){var Y=this,he=e.window.location.hash.replace("#","");if(this._hashName){var $;return he.split("&").map(function(ve){return ve.split("=")}).forEach(function(ve){ve[0]===Y._hashName&&($=ve)}),($&&$[1]||"").split("/")}return he.split("/")},go.prototype._onHashChange=function(){var Y=this._getCurrentHash();if(Y.length>=3&&!Y.some(function($){return isNaN($)})){var he=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(Y[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+Y[2],+Y[1]],zoom:+Y[0],bearing:he,pitch:+(Y[4]||0)}),!0}return!1},go.prototype._updateHashUnthrottled=function(){var Y=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",Y)}catch{}};var Po={linearity:.3,easing:e.bezier(0,0,.3,1)},Ko=e.extend({deceleration:2500,maxSpeed:1400},Po),Io=e.extend({deceleration:20,maxSpeed:1400},Po),Qs=e.extend({deceleration:1e3,maxSpeed:360},Po),ml=e.extend({deceleration:1e3,maxSpeed:90},Po),zo=function(Y){this._map=Y,this.clear()};zo.prototype.clear=function(){this._inertiaBuffer=[]},zo.prototype.record=function(Y){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:Y})},zo.prototype._drainInertiaBuffer=function(){for(var Y=this._inertiaBuffer,he=e.browser.now(),$=160;Y.length>0&&he-Y[0].time>$;)Y.shift()},zo.prototype._onMoveEnd=function(Y){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var he={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},$=0,ve=this._inertiaBuffer;$<ve.length;$+=1){var Se=ve[$],Re=Se.settings;he.zoom+=Re.zoomDelta||0,he.bearing+=Re.bearingDelta||0,he.pitch+=Re.pitchDelta||0,Re.panDelta&&he.pan._add(Re.panDelta),Re.around&&(he.around=Re.around),Re.pinchAround&&(he.pinchAround=Re.pinchAround)}var Ze=this._inertiaBuffer[this._inertiaBuffer.length-1],ut=Ze.time-this._inertiaBuffer[0].time,At={};if(he.pan.mag()){var Ut=$s(he.pan.mag(),ut,e.extend({},Ko,Y||{}));At.offset=he.pan.mult(Ut.amount/he.pan.mag()),At.center=this._map.transform.center,Ea(At,Ut)}if(he.zoom){var nr=$s(he.zoom,ut,Io);At.zoom=this._map.transform.zoom+nr.amount,Ea(At,nr)}if(he.bearing){var sr=$s(he.bearing,ut,Qs);At.bearing=this._map.transform.bearing+e.clamp(sr.amount,-179,179),Ea(At,sr)}if(he.pitch){var Tr=$s(he.pitch,ut,ml);At.pitch=this._map.transform.pitch+Tr.amount,Ea(At,Tr)}if(At.zoom||At.bearing){var Ur=he.pinchAround===void 0?he.around:he.pinchAround;At.around=Ur?this._map.unproject(Ur):this._map.getCenter()}return this.clear(),e.extend(At,{noMoveStart:!0})}};function Ea(fe,Y){(!fe.duration||fe.duration<Y.duration)&&(fe.duration=Y.duration,fe.easing=Y.easing)}function $s(fe,Y,he){var $=he.maxSpeed,ve=he.linearity,Se=he.deceleration,Re=e.clamp(fe*ve/(Y/1e3),-$,$),Ze=Math.abs(Re)/(Se*ve);return{easing:he.easing,duration:Ze*1e3,amount:Re*(Ze/2)}}var ue=function(fe){function Y($,ve,Se,Re){Re===void 0&&(Re={});var Ze=g.mousePos(ve.getCanvasContainer(),Se),ut=ve.unproject(Ze);fe.call(this,$,e.extend({point:Ze,lngLat:ut,originalEvent:Se},Re)),this._defaultPrevented=!1,this.target=ve}fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y;var he={defaultPrevented:{configurable:!0}};return Y.prototype.preventDefault=function(){this._defaultPrevented=!0},he.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(Y.prototype,he),Y}(e.Event),_e=function(fe){function Y($,ve,Se){var Re=$==="touchend"?Se.changedTouches:Se.touches,Ze=g.touchPos(ve.getCanvasContainer(),Re),ut=Ze.map(function(nr){return ve.unproject(nr)}),At=Ze.reduce(function(nr,sr,Tr,Ur){return nr.add(sr.div(Ur.length))},new e.Point(0,0)),Ut=ve.unproject(At);fe.call(this,$,{points:Ze,point:At,lngLats:ut,lngLat:Ut,originalEvent:Se}),this._defaultPrevented=!1}fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y;var he={defaultPrevented:{configurable:!0}};return Y.prototype.preventDefault=function(){this._defaultPrevented=!0},he.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(Y.prototype,he),Y}(e.Event),Ce=function(fe){function Y($,ve,Se){fe.call(this,$,{originalEvent:Se}),this._defaultPrevented=!1}fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y;var he={defaultPrevented:{configurable:!0}};return Y.prototype.preventDefault=function(){this._defaultPrevented=!0},he.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(Y.prototype,he),Y}(e.Event),Be=function(Y,he){this._map=Y,this._clickTolerance=he.clickTolerance};Be.prototype.reset=function(){delete this._mousedownPos},Be.prototype.wheel=function(Y){return this._firePreventable(new Ce(Y.type,this._map,Y))},Be.prototype.mousedown=function(Y,he){return this._mousedownPos=he,this._firePreventable(new ue(Y.type,this._map,Y))},Be.prototype.mouseup=function(Y){this._map.fire(new ue(Y.type,this._map,Y))},Be.prototype.click=function(Y,he){this._mousedownPos&&this._mousedownPos.dist(he)>=this._clickTolerance||this._map.fire(new ue(Y.type,this._map,Y))},Be.prototype.dblclick=function(Y){return this._firePreventable(new ue(Y.type,this._map,Y))},Be.prototype.mouseover=function(Y){this._map.fire(new ue(Y.type,this._map,Y))},Be.prototype.mouseout=function(Y){this._map.fire(new ue(Y.type,this._map,Y))},Be.prototype.touchstart=function(Y){return this._firePreventable(new _e(Y.type,this._map,Y))},Be.prototype.touchmove=function(Y){this._map.fire(new _e(Y.type,this._map,Y))},Be.prototype.touchend=function(Y){this._map.fire(new _e(Y.type,this._map,Y))},Be.prototype.touchcancel=function(Y){this._map.fire(new _e(Y.type,this._map,Y))},Be.prototype._firePreventable=function(Y){if(this._map.fire(Y),Y.defaultPrevented)return{}},Be.prototype.isEnabled=function(){return!0},Be.prototype.isActive=function(){return!1},Be.prototype.enable=function(){},Be.prototype.disable=function(){};var Ge=function(Y){this._map=Y};Ge.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Ge.prototype.mousemove=function(Y){this._map.fire(new ue(Y.type,this._map,Y))},Ge.prototype.mousedown=function(){this._delayContextMenu=!0},Ge.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ue("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Ge.prototype.contextmenu=function(Y){this._delayContextMenu?this._contextMenuEvent=Y:this._map.fire(new ue(Y.type,this._map,Y)),this._map.listens("contextmenu")&&Y.preventDefault()},Ge.prototype.isEnabled=function(){return!0},Ge.prototype.isActive=function(){return!1},Ge.prototype.enable=function(){},Ge.prototype.disable=function(){};var He=function(Y,he){this._map=Y,this._el=Y.getCanvasContainer(),this._container=Y.getContainer(),this._clickTolerance=he.clickTolerance||1};He.prototype.isEnabled=function(){return!!this._enabled},He.prototype.isActive=function(){return!!this._active},He.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},He.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},He.prototype.mousedown=function(Y,he){!this.isEnabled()||!(Y.shiftKey&&Y.button===0)||(g.disableDrag(),this._startPos=this._lastPos=he,this._active=!0)},He.prototype.mousemoveWindow=function(Y,he){if(!!this._active){var $=he;if(!(this._lastPos.equals($)||!this._box&&$.dist(this._startPos)<this._clickTolerance)){var ve=this._startPos;this._lastPos=$,this._box||(this._box=g.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",Y));var Se=Math.min(ve.x,$.x),Re=Math.max(ve.x,$.x),Ze=Math.min(ve.y,$.y),ut=Math.max(ve.y,$.y);g.setTransform(this._box,"translate("+Se+"px,"+Ze+"px)"),this._box.style.width=Re-Se+"px",this._box.style.height=ut-Ze+"px"}}},He.prototype.mouseupWindow=function(Y,he){var $=this;if(!!this._active&&Y.button===0){var ve=this._startPos,Se=he;if(this.reset(),g.suppressClick(),ve.x===Se.x&&ve.y===Se.y)this._fireEvent("boxzoomcancel",Y);else return this._map.fire(new e.Event("boxzoomend",{originalEvent:Y})),{cameraAnimation:function(Re){return Re.fitScreenCoordinates(ve,Se,$._map.getBearing(),{linear:!0})}}}},He.prototype.keydown=function(Y){!this._active||Y.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",Y))},He.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(g.remove(this._box),this._box=null),g.enableDrag(),delete this._startPos,delete this._lastPos},He.prototype._fireEvent=function(Y,he){return this._map.fire(new e.Event(Y,{originalEvent:he}))};function xt(fe,Y){for(var he={},$=0;$<fe.length;$++)he[fe[$].identifier]=Y[$];return he}function ht(fe){for(var Y=new e.Point(0,0),he=0,$=fe;he<$.length;he+=1){var ve=$[he];Y._add(ve)}return Y.div(fe.length)}var Ct=500,Zt=500,jt=30,br=function(Y){this.reset(),this.numTouches=Y.numTouches};br.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},br.prototype.touchstart=function(Y,he,$){(this.centroid||$.length>this.numTouches)&&(this.aborted=!0),!this.aborted&&(this.startTime===void 0&&(this.startTime=Y.timeStamp),$.length===this.numTouches&&(this.centroid=ht(he),this.touches=xt($,he)))},br.prototype.touchmove=function(Y,he,$){if(!(this.aborted||!this.centroid)){var ve=xt($,he);for(var Se in this.touches){var Re=this.touches[Se],Ze=ve[Se];(!Ze||Ze.dist(Re)>jt)&&(this.aborted=!0)}}},br.prototype.touchend=function(Y,he,$){if((!this.centroid||Y.timeStamp-this.startTime>Zt)&&(this.aborted=!0),$.length===0){var ve=!this.aborted&&this.centroid;if(this.reset(),ve)return ve}};var xr=function(Y){this.singleTap=new br(Y),this.numTaps=Y.numTaps,this.reset()};xr.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},xr.prototype.touchstart=function(Y,he,$){this.singleTap.touchstart(Y,he,$)},xr.prototype.touchmove=function(Y,he,$){this.singleTap.touchmove(Y,he,$)},xr.prototype.touchend=function(Y,he,$){var ve=this.singleTap.touchend(Y,he,$);if(ve){var Se=Y.timeStamp-this.lastTime<Ct,Re=!this.lastTap||this.lastTap.dist(ve)<jt;if((!Se||!Re)&&this.reset(),this.count++,this.lastTime=Y.timeStamp,this.lastTap=ve,this.count===this.numTaps)return this.reset(),ve}};var Wr=function(){this._zoomIn=new xr({numTouches:1,numTaps:2}),this._zoomOut=new xr({numTouches:2,numTaps:1}),this.reset()};Wr.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Wr.prototype.touchstart=function(Y,he,$){this._zoomIn.touchstart(Y,he,$),this._zoomOut.touchstart(Y,he,$)},Wr.prototype.touchmove=function(Y,he,$){this._zoomIn.touchmove(Y,he,$),this._zoomOut.touchmove(Y,he,$)},Wr.prototype.touchend=function(Y,he,$){var ve=this,Se=this._zoomIn.touchend(Y,he,$),Re=this._zoomOut.touchend(Y,he,$);if(Se)return this._active=!0,Y.preventDefault(),setTimeout(function(){return ve.reset()},0),{cameraAnimation:function(Ze){return Ze.easeTo({duration:300,zoom:Ze.getZoom()+1,around:Ze.unproject(Se)},{originalEvent:Y})}};if(Re)return this._active=!0,Y.preventDefault(),setTimeout(function(){return ve.reset()},0),{cameraAnimation:function(Ze){return Ze.easeTo({duration:300,zoom:Ze.getZoom()-1,around:Ze.unproject(Re)},{originalEvent:Y})}}},Wr.prototype.touchcancel=function(){this.reset()},Wr.prototype.enable=function(){this._enabled=!0},Wr.prototype.disable=function(){this._enabled=!1,this.reset()},Wr.prototype.isEnabled=function(){return this._enabled},Wr.prototype.isActive=function(){return this._active};var tn=0,Mr=2,Ir=function(Y){this.reset(),this._clickTolerance=Y.clickTolerance||1};Ir.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Ir.prototype._correctButton=function(Y,he){return!1},Ir.prototype._move=function(Y,he){return{}},Ir.prototype.mousedown=function(Y,he){if(!this._lastPoint){var $=g.mouseButton(Y);!this._correctButton(Y,$)||(this._lastPoint=he,this._eventButton=$)}},Ir.prototype.mousemoveWindow=function(Y,he){var $=this._lastPoint;if(!!$&&(Y.preventDefault(),!(!this._moved&&he.dist($)<this._clickTolerance)))return this._moved=!0,this._lastPoint=he,this._move($,he)},Ir.prototype.mouseupWindow=function(Y){var he=g.mouseButton(Y);he===this._eventButton&&(this._moved&&g.suppressClick(),this.reset())},Ir.prototype.enable=function(){this._enabled=!0},Ir.prototype.disable=function(){this._enabled=!1,this.reset()},Ir.prototype.isEnabled=function(){return this._enabled},Ir.prototype.isActive=function(){return this._active};var Xr=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.mousedown=function($,ve){fe.prototype.mousedown.call(this,$,ve),this._lastPoint&&(this._active=!0)},Y.prototype._correctButton=function($,ve){return ve===tn&&!$.ctrlKey},Y.prototype._move=function($,ve){return{around:ve,panDelta:ve.sub($)}},Y}(Ir),qr=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype._correctButton=function($,ve){return ve===tn&&$.ctrlKey||ve===Mr},Y.prototype._move=function($,ve){var Se=.8,Re=(ve.x-$.x)*Se;if(Re)return this._active=!0,{bearingDelta:Re}},Y.prototype.contextmenu=function($){$.preventDefault()},Y}(Ir),an=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype._correctButton=function($,ve){return ve===tn&&$.ctrlKey||ve===Mr},Y.prototype._move=function($,ve){var Se=-.5,Re=(ve.y-$.y)*Se;if(Re)return this._active=!0,{pitchDelta:Re}},Y.prototype.contextmenu=function($){$.preventDefault()},Y}(Ir),Br=function(Y){this._minTouches=1,this._clickTolerance=Y.clickTolerance||1,this.reset()};Br.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},Br.prototype.touchstart=function(Y,he,$){return this._calculateTransform(Y,he,$)},Br.prototype.touchmove=function(Y,he,$){if(!!this._active)return Y.preventDefault(),this._calculateTransform(Y,he,$)},Br.prototype.touchend=function(Y,he,$){this._calculateTransform(Y,he,$),this._active&&$.length<this._minTouches&&this.reset()},Br.prototype.touchcancel=function(){this.reset()},Br.prototype._calculateTransform=function(Y,he,$){$.length>0&&(this._active=!0);var ve=xt($,he),Se=new e.Point(0,0),Re=new e.Point(0,0),Ze=0;for(var ut in ve){var At=ve[ut],Ut=this._touches[ut];Ut&&(Se._add(At),Re._add(At.sub(Ut)),Ze++,ve[ut]=At)}if(this._touches=ve,!(Ze<this._minTouches||!Re.mag())){var nr=Re.div(Ze);if(this._sum._add(nr),!(this._sum.mag()<this._clickTolerance)){var sr=Se.div(Ze);return{around:sr,panDelta:nr}}}},Br.prototype.enable=function(){this._enabled=!0},Br.prototype.disable=function(){this._enabled=!1,this.reset()},Br.prototype.isEnabled=function(){return this._enabled},Br.prototype.isActive=function(){return this._active};var In=function(){this.reset()};In.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},In.prototype._start=function(Y){},In.prototype._move=function(Y,he,$){return{}},In.prototype.touchstart=function(Y,he,$){this._firstTwoTouches||$.length<2||(this._firstTwoTouches=[$[0].identifier,$[1].identifier],this._start([he[0],he[1]]))},In.prototype.touchmove=function(Y,he,$){if(!!this._firstTwoTouches){Y.preventDefault();var ve=this._firstTwoTouches,Se=ve[0],Re=ve[1],Ze=fa($,he,Se),ut=fa($,he,Re);if(!(!Ze||!ut)){var At=this._aroundCenter?null:Ze.add(ut).div(2);return this._move([Ze,ut],At,Y)}}},In.prototype.touchend=function(Y,he,$){if(!!this._firstTwoTouches){var ve=this._firstTwoTouches,Se=ve[0],Re=ve[1],Ze=fa($,he,Se),ut=fa($,he,Re);Ze&&ut||(this._active&&g.suppressClick(),this.reset())}},In.prototype.touchcancel=function(){this.reset()},In.prototype.enable=function(Y){this._enabled=!0,this._aroundCenter=!!Y&&Y.around==="center"},In.prototype.disable=function(){this._enabled=!1,this.reset()},In.prototype.isEnabled=function(){return this._enabled},In.prototype.isActive=function(){return this._active};function fa(fe,Y,he){for(var $=0;$<fe.length;$++)if(fe[$].identifier===he)return Y[$]}var ya=.1;function da(fe,Y){return Math.log(fe/Y)/Math.LN2}var Ca=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.reset=function(){fe.prototype.reset.call(this),delete this._distance,delete this._startDistance},Y.prototype._start=function($){this._startDistance=this._distance=$[0].dist($[1])},Y.prototype._move=function($,ve){var Se=this._distance;if(this._distance=$[0].dist($[1]),!(!this._active&&Math.abs(da(this._distance,this._startDistance))<ya))return this._active=!0,{zoomDelta:da(this._distance,Se),pinchAround:ve}},Y}(In),Ra=25;function ii(fe,Y){return fe.angleWith(Y)*180/Math.PI}var Oa=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.reset=function(){fe.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},Y.prototype._start=function($){this._startVector=this._vector=$[0].sub($[1]),this._minDiameter=$[0].dist($[1])},Y.prototype._move=function($,ve){var Se=this._vector;if(this._vector=$[0].sub($[1]),!(!this._active&&this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ii(this._vector,Se),pinchAround:ve}},Y.prototype._isBelowThreshold=function($){this._minDiameter=Math.min(this._minDiameter,$.mag());var ve=Math.PI*this._minDiameter,Se=Ra/ve*360,Re=ii($,this._startVector);return Math.abs(Re)<Se},Y}(In);function Xa(fe){return Math.abs(fe.y)>Math.abs(fe.x)}var Ii=100,ci=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.reset=function(){fe.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},Y.prototype._start=function($){this._lastPoints=$,Xa($[0].sub($[1]))&&(this._valid=!1)},Y.prototype._move=function($,ve,Se){var Re=$[0].sub(this._lastPoints[0]),Ze=$[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(Re,Ze,Se.timeStamp),!!this._valid){this._lastPoints=$,this._active=!0;var ut=(Re.y+Ze.y)/2,At=-.5;return{pitchDelta:ut*At}}},Y.prototype.gestureBeginsVertically=function($,ve,Se){if(this._valid!==void 0)return this._valid;var Re=2,Ze=$.mag()>=Re,ut=ve.mag()>=Re;if(!(!Ze&&!ut)){if(!Ze||!ut)return this._firstMove===void 0&&(this._firstMove=Se),Se-this._firstMove<Ii?void 0:!1;var At=$.y>0==ve.y>0;return Xa($)&&Xa(ve)&&At}},Y}(In),ki={panStep:100,bearingStep:15,pitchStep:10},aa=function(){var Y=ki;this._panStep=Y.panStep,this._bearingStep=Y.bearingStep,this._pitchStep=Y.pitchStep};aa.prototype.reset=function(){this._active=!1},aa.prototype.keydown=function(Y){var he=this;if(!(Y.altKey||Y.ctrlKey||Y.metaKey)){var $=0,ve=0,Se=0,Re=0,Ze=0;switch(Y.keyCode){case 61:case 107:case 171:case 187:$=1;break;case 189:case 109:case 173:$=-1;break;case 37:Y.shiftKey?ve=-1:(Y.preventDefault(),Re=-1);break;case 39:Y.shiftKey?ve=1:(Y.preventDefault(),Re=1);break;case 38:Y.shiftKey?Se=1:(Y.preventDefault(),Ze=-1);break;case 40:Y.shiftKey?Se=-1:(Y.preventDefault(),Ze=1);break;default:return}return{cameraAnimation:function(ut){var At=ut.getZoom();ut.easeTo({duration:300,easeId:"keyboardHandler",easing:$a,zoom:$?Math.round(At)+$*(Y.shiftKey?2:1):At,bearing:ut.getBearing()+ve*he._bearingStep,pitch:ut.getPitch()+Se*he._pitchStep,offset:[-Re*he._panStep,-Ze*he._panStep],center:ut.getCenter()},{originalEvent:Y})}}}},aa.prototype.enable=function(){this._enabled=!0},aa.prototype.disable=function(){this._enabled=!1,this.reset()},aa.prototype.isEnabled=function(){return this._enabled},aa.prototype.isActive=function(){return this._active};function $a(fe){return fe*(2-fe)}var si=4.000244140625,Mi=1/100,Qi=1/450,Hi=2,Bi=function(Y,he){this._map=Y,this._el=Y.getCanvasContainer(),this._handler=he,this._delta=0,this._defaultZoomRate=Mi,this._wheelZoomRate=Qi,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Bi.prototype.setZoomRate=function(Y){this._defaultZoomRate=Y},Bi.prototype.setWheelZoomRate=function(Y){this._wheelZoomRate=Y},Bi.prototype.isEnabled=function(){return!!this._enabled},Bi.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Bi.prototype.isZooming=function(){return!!this._zooming},Bi.prototype.enable=function(Y){this.isEnabled()||(this._enabled=!0,this._aroundCenter=Y&&Y.around==="center")},Bi.prototype.disable=function(){!this.isEnabled()||(this._enabled=!1)},Bi.prototype.wheel=function(Y){if(!!this.isEnabled()){var he=Y.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?Y.deltaY*40:Y.deltaY,$=e.browser.now(),ve=$-(this._lastWheelEventTime||0);this._lastWheelEventTime=$,he!==0&&he%si===0?this._type="wheel":he!==0&&Math.abs(he)<4?this._type="trackpad":ve>400?(this._type=null,this._lastValue=he,this._timeout=setTimeout(this._onTimeout,40,Y)):this._type||(this._type=Math.abs(ve*he)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,he+=this._lastValue)),Y.shiftKey&&he&&(he=he/4),this._type&&(this._lastWheelEvent=Y,this._delta-=he,this._active||this._start(Y)),Y.preventDefault()}},Bi.prototype._onTimeout=function(Y){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(Y)},Bi.prototype._start=function(Y){if(!!this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var he=g.mousePos(this._el,Y);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(he)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Bi.prototype.renderFrame=function(){return this._onScrollFrame()},Bi.prototype._onScrollFrame=function(){var Y=this;if(!!this._frameId&&(this._frameId=null,!!this.isActive())){var he=this._map.transform;if(this._delta!==0){var $=this._type==="wheel"&&Math.abs(this._delta)>si?this._wheelZoomRate:this._defaultZoomRate,ve=Hi/(1+Math.exp(-Math.abs(this._delta*$)));this._delta<0&&ve!==0&&(ve=1/ve);var Se=typeof this._targetZoom=="number"?he.zoomScale(this._targetZoom):he.scale;this._targetZoom=Math.min(he.maxZoom,Math.max(he.minZoom,he.scaleZoom(Se*ve))),this._type==="wheel"&&(this._startZoom=he.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var Re=typeof this._targetZoom=="number"?this._targetZoom:he.zoom,Ze=this._startZoom,ut=this._easing,At=!1,Ut;if(this._type==="wheel"&&Ze&&ut){var nr=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),sr=ut(nr);Ut=e.number(Ze,Re,sr),nr<1?this._frameId||(this._frameId=!0):At=!0}else Ut=Re,At=!0;return this._active=!0,At&&(this._active=!1,this._finishTimeout=setTimeout(function(){Y._zooming=!1,Y._handler._triggerRenderFrame(),delete Y._targetZoom,delete Y._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!At,zoomDelta:Ut-he.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Bi.prototype._smoothOutEasing=function(Y){var he=e.ease;if(this._prevEase){var $=this._prevEase,ve=(e.browser.now()-$.start)/$.duration,Se=$.easing(ve+.01)-$.easing(ve),Re=.27/Math.sqrt(Se*Se+1e-4)*.01,Ze=Math.sqrt(.27*.27-Re*Re);he=e.bezier(Re,Ze,.25,1)}return this._prevEase={start:e.browser.now(),duration:Y,easing:he},he},Bi.prototype.reset=function(){this._active=!1};var Ma=function(Y,he){this._clickZoom=Y,this._tapZoom=he};Ma.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Ma.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Ma.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Ma.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var Ia=function(){this.reset()};Ia.prototype.reset=function(){this._active=!1},Ia.prototype.dblclick=function(Y,he){return Y.preventDefault(),{cameraAnimation:function($){$.easeTo({duration:300,zoom:$.getZoom()+(Y.shiftKey?-1:1),around:$.unproject(he)},{originalEvent:Y})}}},Ia.prototype.enable=function(){this._enabled=!0},Ia.prototype.disable=function(){this._enabled=!1,this.reset()},Ia.prototype.isEnabled=function(){return this._enabled},Ia.prototype.isActive=function(){return this._active};var eo=function(){this._tap=new xr({numTouches:1,numTaps:1}),this.reset()};eo.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},eo.prototype.touchstart=function(Y,he,$){this._swipePoint||(this._tapTime&&Y.timeStamp-this._tapTime>Ct&&this.reset(),this._tapTime?$.length>0&&(this._swipePoint=he[0],this._swipeTouch=$[0].identifier):this._tap.touchstart(Y,he,$))},eo.prototype.touchmove=function(Y,he,$){if(!this._tapTime)this._tap.touchmove(Y,he,$);else if(this._swipePoint){if($[0].identifier!==this._swipeTouch)return;var ve=he[0],Se=ve.y-this._swipePoint.y;return this._swipePoint=ve,Y.preventDefault(),this._active=!0,{zoomDelta:Se/128}}},eo.prototype.touchend=function(Y,he,$){if(this._tapTime)this._swipePoint&&$.length===0&&this.reset();else{var ve=this._tap.touchend(Y,he,$);ve&&(this._tapTime=Y.timeStamp)}},eo.prototype.touchcancel=function(){this.reset()},eo.prototype.enable=function(){this._enabled=!0},eo.prototype.disable=function(){this._enabled=!1,this.reset()},eo.prototype.isEnabled=function(){return this._enabled},eo.prototype.isActive=function(){return this._active};var bo=function(Y,he,$){this._el=Y,this._mousePan=he,this._touchPan=$};bo.prototype.enable=function(Y){this._inertiaOptions=Y||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},bo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},bo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},bo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var yo=function(Y,he,$){this._pitchWithRotate=Y.pitchWithRotate,this._mouseRotate=he,this._mousePitch=$};yo.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},yo.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},yo.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},yo.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Yi=function(Y,he,$,ve){this._el=Y,this._touchZoom=he,this._touchRotate=$,this._tapDragZoom=ve,this._rotationDisabled=!1,this._enabled=!0};Yi.prototype.enable=function(Y){this._touchZoom.enable(Y),this._rotationDisabled||this._touchRotate.enable(Y),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Yi.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Yi.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Yi.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Yi.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Yi.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Fs=function(fe){return fe.zoom||fe.drag||fe.pitch||fe.rotate},Pl=function(fe){function Y(){fe.apply(this,arguments)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y}(e.Event);function Os(fe){return fe.panDelta&&fe.panDelta.mag()||fe.zoomDelta||fe.bearingDelta||fe.pitchDelta}var Ei=function(Y,he){this._map=Y,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new zo(Y),this._bearingSnap=he.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(he),e.bindAll(["handleEvent","handleWindowEvent"],this);var $=this._el;this._listeners=[[$,"touchstart",{passive:!1}],[$,"touchmove",{passive:!1}],[$,"touchend",void 0],[$,"touchcancel",void 0],[$,"mousedown",void 0],[$,"mousemove",void 0],[$,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[$,"mouseover",void 0],[$,"mouseout",void 0],[$,"dblclick",void 0],[$,"click",void 0],[$,"keydown",{capture:!1}],[$,"keyup",void 0],[$,"wheel",{passive:!1}],[$,"contextmenu",void 0],[e.window,"blur",void 0]];for(var ve=0,Se=this._listeners;ve<Se.length;ve+=1){var Re=Se[ve],Ze=Re[0],ut=Re[1],At=Re[2];g.addEventListener(Ze,ut,Ze===e.window.document?this.handleWindowEvent:this.handleEvent,At)}};Ei.prototype.destroy=function(){for(var Y=0,he=this._listeners;Y<he.length;Y+=1){var $=he[Y],ve=$[0],Se=$[1],Re=$[2];g.removeEventListener(ve,Se,ve===e.window.document?this.handleWindowEvent:this.handleEvent,Re)}},Ei.prototype._addDefaultHandlers=function(Y){var he=this._map,$=he.getCanvasContainer();this._add("mapEvent",new Be(he,Y));var ve=he.boxZoom=new He(he,Y);this._add("boxZoom",ve);var Se=new Wr,Re=new Ia;he.doubleClickZoom=new Ma(Re,Se),this._add("tapZoom",Se),this._add("clickZoom",Re);var Ze=new eo;this._add("tapDragZoom",Ze);var ut=he.touchPitch=new ci;this._add("touchPitch",ut);var At=new qr(Y),Ut=new an(Y);he.dragRotate=new yo(Y,At,Ut),this._add("mouseRotate",At,["mousePitch"]),this._add("mousePitch",Ut,["mouseRotate"]);var nr=new Xr(Y),sr=new Br(Y);he.dragPan=new bo($,nr,sr),this._add("mousePan",nr),this._add("touchPan",sr,["touchZoom","touchRotate"]);var Tr=new Oa,Ur=new Ca;he.touchZoomRotate=new Yi($,Ur,Tr,Ze),this._add("touchRotate",Tr,["touchPan","touchZoom"]),this._add("touchZoom",Ur,["touchPan","touchRotate"]);var Hr=he.scrollZoom=new Bi(he,this);this._add("scrollZoom",Hr,["mousePan"]);var Fr=he.keyboard=new aa;this._add("keyboard",Fr),this._add("blockableMapEvent",new Ge(he));for(var Zr=0,fn=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Zr<fn.length;Zr+=1){var En=fn[Zr];Y.interactive&&Y[En]&&he[En].enable(Y[En])}},Ei.prototype._add=function(Y,he,$){this._handlers.push({handlerName:Y,handler:he,allowed:$}),this._handlersById[Y]=he},Ei.prototype.stop=function(){if(!this._updatingCamera){for(var Y=0,he=this._handlers;Y<he.length;Y+=1){var $=he[Y],ve=$.handler;ve.reset()}this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Ei.prototype.isActive=function(){for(var Y=0,he=this._handlers;Y<he.length;Y+=1){var $=he[Y],ve=$.handler;if(ve.isActive())return!0}return!1},Ei.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Ei.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Ei.prototype.isMoving=function(){return Boolean(Fs(this._eventsInProgress))||this.isZooming()},Ei.prototype._blockedByActive=function(Y,he,$){for(var ve in Y)if(ve!==$&&(!he||he.indexOf(ve)<0))return!0;return!1},Ei.prototype.handleWindowEvent=function(Y){this.handleEvent(Y,Y.type+"Window")},Ei.prototype._getMapTouches=function(Y){for(var he=[],$=0,ve=Y;$<ve.length;$+=1){var Se=ve[$],Re=Se.target;this._el.contains(Re)&&he.push(Se)}return he},Ei.prototype.handleEvent=function(Y,he){if(Y.type==="blur"){this.stop();return}this._updatingCamera=!0;for(var $=Y.type==="renderFrame"?void 0:Y,ve={needsRenderFrame:!1},Se={},Re={},Ze=Y.touches?this._getMapTouches(Y.touches):void 0,ut=Ze?g.touchPos(this._el,Ze):g.mousePos(this._el,Y),At=0,Ut=this._handlers;At<Ut.length;At+=1){var nr=Ut[At],sr=nr.handlerName,Tr=nr.handler,Ur=nr.allowed;if(!!Tr.isEnabled()){var Hr=void 0;this._blockedByActive(Re,Ur,sr)?Tr.reset():Tr[he||Y.type]&&(Hr=Tr[he||Y.type](Y,ut,Ze),this.mergeHandlerResult(ve,Se,Hr,sr,$),Hr&&Hr.needsRenderFrame&&this._triggerRenderFrame()),(Hr||Tr.isActive())&&(Re[sr]=Tr)}}var Fr={};for(var Zr in this._previousActiveHandlers)Re[Zr]||(Fr[Zr]=$);this._previousActiveHandlers=Re,(Object.keys(Fr).length||Os(ve))&&(this._changes.push([ve,Se,Fr]),this._triggerRenderFrame()),(Object.keys(Re).length||Os(ve))&&this._map._stop(!0),this._updatingCamera=!1;var fn=ve.cameraAnimation;fn&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],fn(this._map))},Ei.prototype.mergeHandlerResult=function(Y,he,$,ve,Se){if(!!$){e.extend(Y,$);var Re={handlerName:ve,originalEvent:$.originalEvent||Se};$.zoomDelta!==void 0&&(he.zoom=Re),$.panDelta!==void 0&&(he.drag=Re),$.pitchDelta!==void 0&&(he.pitch=Re),$.bearingDelta!==void 0&&(he.rotate=Re)}},Ei.prototype._applyChanges=function(){for(var Y={},he={},$={},ve=0,Se=this._changes;ve<Se.length;ve+=1){var Re=Se[ve],Ze=Re[0],ut=Re[1],At=Re[2];Ze.panDelta&&(Y.panDelta=(Y.panDelta||new e.Point(0,0))._add(Ze.panDelta)),Ze.zoomDelta&&(Y.zoomDelta=(Y.zoomDelta||0)+Ze.zoomDelta),Ze.bearingDelta&&(Y.bearingDelta=(Y.bearingDelta||0)+Ze.bearingDelta),Ze.pitchDelta&&(Y.pitchDelta=(Y.pitchDelta||0)+Ze.pitchDelta),Ze.around!==void 0&&(Y.around=Ze.around),Ze.pinchAround!==void 0&&(Y.pinchAround=Ze.pinchAround),Ze.noInertia&&(Y.noInertia=Ze.noInertia),e.extend(he,ut),e.extend($,At)}this._updateMapTransform(Y,he,$),this._changes=[]},Ei.prototype._updateMapTransform=function(Y,he,$){var ve=this._map,Se=ve.transform;if(!Os(Y))return this._fireEvents(he,$);var Re=Y.panDelta,Ze=Y.zoomDelta,ut=Y.bearingDelta,At=Y.pitchDelta,Ut=Y.around,nr=Y.pinchAround;nr!==void 0&&(Ut=nr),ve._stop(!0),Ut=Ut||ve.transform.centerPoint;var sr=Se.pointLocation(Re?Ut.sub(Re):Ut);ut&&(Se.bearing+=ut),At&&(Se.pitch+=At),Ze&&(Se.zoom+=Ze),Se.setLocationAtPoint(sr,Ut),this._map._update(),Y.noInertia||this._inertia.record(Y),this._fireEvents(he,$)},Ei.prototype._fireEvents=function(Y,he){var $=this,ve=Fs(this._eventsInProgress),Se=Fs(Y),Re={};for(var Ze in Y){var ut=Y[Ze],At=ut.originalEvent;this._eventsInProgress[Ze]||(Re[Ze+"start"]=At),this._eventsInProgress[Ze]=Y[Ze]}!ve&&Se&&this._fireEvent("movestart",Se.originalEvent);for(var Ut in Re)this._fireEvent(Ut,Re[Ut]);Y.rotate&&(this._bearingChanged=!0),Se&&this._fireEvent("move",Se.originalEvent);for(var nr in Y){var sr=Y[nr],Tr=sr.originalEvent;this._fireEvent(nr,Tr)}var Ur={},Hr;for(var Fr in this._eventsInProgress){var Zr=this._eventsInProgress[Fr],fn=Zr.handlerName,En=Zr.originalEvent;this._handlersById[fn].isActive()||(delete this._eventsInProgress[Fr],Hr=he[fn]||En,Ur[Fr+"end"]=Hr)}for(var Nn in Ur)this._fireEvent(Nn,Ur[Nn]);var jn=Fs(this._eventsInProgress);if((ve||Se)&&!jn){this._updatingCamera=!0;var Qn=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Kn=function(ha){return ha!==0&&-$._bearingSnap<ha&&ha<$._bearingSnap};Qn?(Kn(Qn.bearing||this._map.getBearing())&&(Qn.bearing=0),this._map.easeTo(Qn,{originalEvent:Hr})):(this._map.fire(new e.Event("moveend",{originalEvent:Hr})),Kn(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Ei.prototype._fireEvent=function(Y,he){this._map.fire(new e.Event(Y,he?{originalEvent:he}:{}))},Ei.prototype._triggerRenderFrame=function(){var Y=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(he){delete Y._frameId,Y.handleEvent(new Pl("renderFrame",{timeStamp:he})),Y._applyChanges()}))};var qs=function(fe){function Y(he,$){fe.call(this),this._moving=!1,this._zooming=!1,this.transform=he,this._bearingSnap=$.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},Y.prototype.setCenter=function($,ve){return this.jumpTo({center:$},ve)},Y.prototype.panBy=function($,ve,Se){return $=e.Point.convert($).mult(-1),this.panTo(this.transform.center,e.extend({offset:$},ve),Se)},Y.prototype.panTo=function($,ve,Se){return this.easeTo(e.extend({center:$},ve),Se)},Y.prototype.getZoom=function(){return this.transform.zoom},Y.prototype.setZoom=function($,ve){return this.jumpTo({zoom:$},ve),this},Y.prototype.zoomTo=function($,ve,Se){return this.easeTo(e.extend({zoom:$},ve),Se)},Y.prototype.zoomIn=function($,ve){return this.zoomTo(this.getZoom()+1,$,ve),this},Y.prototype.zoomOut=function($,ve){return this.zoomTo(this.getZoom()-1,$,ve),this},Y.prototype.getBearing=function(){return this.transform.bearing},Y.prototype.setBearing=function($,ve){return this.jumpTo({bearing:$},ve),this},Y.prototype.getPadding=function(){return this.transform.padding},Y.prototype.setPadding=function($,ve){return this.jumpTo({padding:$},ve),this},Y.prototype.rotateTo=function($,ve,Se){return this.easeTo(e.extend({bearing:$},ve),Se)},Y.prototype.resetNorth=function($,ve){return this.rotateTo(0,e.extend({duration:1e3},$),ve),this},Y.prototype.resetNorthPitch=function($,ve){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},$),ve),this},Y.prototype.snapToNorth=function($,ve){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth($,ve):this},Y.prototype.getPitch=function(){return this.transform.pitch},Y.prototype.setPitch=function($,ve){return this.jumpTo({pitch:$},ve),this},Y.prototype.cameraForBounds=function($,ve){return $=e.LngLatBounds.convert($),this._cameraForBoxAndBearing($.getNorthWest(),$.getSouthEast(),0,ve)},Y.prototype._cameraForBoxAndBearing=function($,ve,Se,Re){var Ze={top:0,bottom:0,right:0,left:0};if(Re=e.extend({padding:Ze,offset:[0,0],maxZoom:this.transform.maxZoom},Re),typeof Re.padding=="number"){var ut=Re.padding;Re.padding={top:ut,bottom:ut,right:ut,left:ut}}Re.padding=e.extend(Ze,Re.padding);var At=this.transform,Ut=At.padding,nr=At.project(e.LngLat.convert($)),sr=At.project(e.LngLat.convert(ve)),Tr=nr.rotate(-Se*Math.PI/180),Ur=sr.rotate(-Se*Math.PI/180),Hr=new e.Point(Math.max(Tr.x,Ur.x),Math.max(Tr.y,Ur.y)),Fr=new e.Point(Math.min(Tr.x,Ur.x),Math.min(Tr.y,Ur.y)),Zr=Hr.sub(Fr),fn=(At.width-(Ut.left+Ut.right+Re.padding.left+Re.padding.right))/Zr.x,En=(At.height-(Ut.top+Ut.bottom+Re.padding.top+Re.padding.bottom))/Zr.y;if(En<0||fn<0){e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");return}var Nn=Math.min(At.scaleZoom(At.scale*Math.min(fn,En)),Re.maxZoom),jn=e.Point.convert(Re.offset),Qn=(Re.padding.left-Re.padding.right)/2,Kn=(Re.padding.top-Re.padding.bottom)/2,ha=new e.Point(jn.x+Qn,jn.y+Kn),xa=ha.mult(At.scale/At.zoomScale(Nn)),ma=At.unproject(nr.add(sr).div(2).sub(xa));return{center:ma,zoom:Nn,bearing:Se}},Y.prototype.fitBounds=function($,ve,Se){return this._fitInternal(this.cameraForBounds($,ve),ve,Se)},Y.prototype.fitScreenCoordinates=function($,ve,Se,Re,Ze){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert($)),this.transform.pointLocation(e.Point.convert(ve)),Se,Re),Re,Ze)},Y.prototype._fitInternal=function($,ve,Se){return $?(ve=e.extend($,ve),delete ve.padding,ve.linear?this.easeTo(ve,Se):this.flyTo(ve,Se)):this},Y.prototype.jumpTo=function($,ve){this.stop();var Se=this.transform,Re=!1,Ze=!1,ut=!1;return"zoom"in $&&Se.zoom!==+$.zoom&&(Re=!0,Se.zoom=+$.zoom),$.center!==void 0&&(Se.center=e.LngLat.convert($.center)),"bearing"in $&&Se.bearing!==+$.bearing&&(Ze=!0,Se.bearing=+$.bearing),"pitch"in $&&Se.pitch!==+$.pitch&&(ut=!0,Se.pitch=+$.pitch),$.padding!=null&&!Se.isPaddingEqual($.padding)&&(Se.padding=$.padding),this.fire(new e.Event("movestart",ve)).fire(new e.Event("move",ve)),Re&&this.fire(new e.Event("zoomstart",ve)).fire(new e.Event("zoom",ve)).fire(new e.Event("zoomend",ve)),Ze&&this.fire(new e.Event("rotatestart",ve)).fire(new e.Event("rotate",ve)).fire(new e.Event("rotateend",ve)),ut&&this.fire(new e.Event("pitchstart",ve)).fire(new e.Event("pitch",ve)).fire(new e.Event("pitchend",ve)),this.fire(new e.Event("moveend",ve))},Y.prototype.easeTo=function($,ve){var Se=this;this._stop(!1,$.easeId),$=e.extend({offset:[0,0],duration:500,easing:e.ease},$),($.animate===!1||!$.essential&&e.browser.prefersReducedMotion)&&($.duration=0);var Re=this.transform,Ze=this.getZoom(),ut=this.getBearing(),At=this.getPitch(),Ut=this.getPadding(),nr="zoom"in $?+$.zoom:Ze,sr="bearing"in $?this._normalizeBearing($.bearing,ut):ut,Tr="pitch"in $?+$.pitch:At,Ur="padding"in $?$.padding:Re.padding,Hr=e.Point.convert($.offset),Fr=Re.centerPoint.add(Hr),Zr=Re.pointLocation(Fr),fn=e.LngLat.convert($.center||Zr);this._normalizeCenter(fn);var En=Re.project(Zr),Nn=Re.project(fn).sub(En),jn=Re.zoomScale(nr-Ze),Qn,Kn;$.around&&(Qn=e.LngLat.convert($.around),Kn=Re.locationPoint(Qn));var ha={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||nr!==Ze,this._rotating=this._rotating||ut!==sr,this._pitching=this._pitching||Tr!==At,this._padding=!Re.isPaddingEqual(Ur),this._easeId=$.easeId,this._prepareEase(ve,$.noMoveStart,ha),clearTimeout(this._easeEndTimeoutID),this._ease(function(xa){if(Se._zooming&&(Re.zoom=e.number(Ze,nr,xa)),Se._rotating&&(Re.bearing=e.number(ut,sr,xa)),Se._pitching&&(Re.pitch=e.number(At,Tr,xa)),Se._padding&&(Re.interpolatePadding(Ut,Ur,xa),Fr=Re.centerPoint.add(Hr)),Qn)Re.setLocationAtPoint(Qn,Kn);else{var ma=Re.zoomScale(Re.zoom-Ze),Ta=nr>Ze?Math.min(2,jn):Math.max(.5,jn),Pa=Math.pow(Ta,1-xa),Za=Re.unproject(En.add(Nn.mult(xa*Pa)).mult(ma));Re.setLocationAtPoint(Re.renderWorldCopies?Za.wrap():Za,Fr)}Se._fireMoveEvents(ve)},function(xa){Se._afterEase(ve,xa)},$),this},Y.prototype._prepareEase=function($,ve,Se){Se===void 0&&(Se={}),this._moving=!0,!ve&&!Se.moving&&this.fire(new e.Event("movestart",$)),this._zooming&&!Se.zooming&&this.fire(new e.Event("zoomstart",$)),this._rotating&&!Se.rotating&&this.fire(new e.Event("rotatestart",$)),this._pitching&&!Se.pitching&&this.fire(new e.Event("pitchstart",$))},Y.prototype._fireMoveEvents=function($){this.fire(new e.Event("move",$)),this._zooming&&this.fire(new e.Event("zoom",$)),this._rotating&&this.fire(new e.Event("rotate",$)),this._pitching&&this.fire(new e.Event("pitch",$))},Y.prototype._afterEase=function($,ve){if(!(this._easeId&&ve&&this._easeId===ve)){delete this._easeId;var Se=this._zooming,Re=this._rotating,Ze=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,Se&&this.fire(new e.Event("zoomend",$)),Re&&this.fire(new e.Event("rotateend",$)),Ze&&this.fire(new e.Event("pitchend",$)),this.fire(new e.Event("moveend",$))}},Y.prototype.flyTo=function($,ve){var Se=this;if(!$.essential&&e.browser.prefersReducedMotion){var Re=e.pick($,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Re,ve)}this.stop(),$=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},$);var Ze=this.transform,ut=this.getZoom(),At=this.getBearing(),Ut=this.getPitch(),nr=this.getPadding(),sr="zoom"in $?e.clamp(+$.zoom,Ze.minZoom,Ze.maxZoom):ut,Tr="bearing"in $?this._normalizeBearing($.bearing,At):At,Ur="pitch"in $?+$.pitch:Ut,Hr="padding"in $?$.padding:Ze.padding,Fr=Ze.zoomScale(sr-ut),Zr=e.Point.convert($.offset),fn=Ze.centerPoint.add(Zr),En=Ze.pointLocation(fn),Nn=e.LngLat.convert($.center||En);this._normalizeCenter(Nn);var jn=Ze.project(En),Qn=Ze.project(Nn).sub(jn),Kn=$.curve,ha=Math.max(Ze.width,Ze.height),xa=ha/Fr,ma=Qn.mag();if("minZoom"in $){var Ta=e.clamp(Math.min($.minZoom,ut,sr),Ze.minZoom,Ze.maxZoom),Pa=ha/Ze.zoomScale(Ta-ut);Kn=Math.sqrt(Pa/ma*2)}var Za=Kn*Kn;function ai(oi){var Li=(xa*xa-ha*ha+(oi?-1:1)*Za*Za*ma*ma)/(2*(oi?xa:ha)*Za*ma);return Math.log(Math.sqrt(Li*Li+1)-Li)}function Ni(oi){return(Math.exp(oi)-Math.exp(-oi))/2}function ui(oi){return(Math.exp(oi)+Math.exp(-oi))/2}function wi(oi){return Ni(oi)/ui(oi)}var Va=ai(0),Ui=function(oi){return ui(Va)/ui(Va+Kn*oi)},Gi=function(oi){return ha*((ui(Va)*wi(Va+Kn*oi)-Ni(Va))/Za)/ma},Wi=(ai(1)-Va)/Kn;if(Math.abs(ma)<1e-6||!isFinite(Wi)){if(Math.abs(ha-xa)<1e-6)return this.easeTo($,ve);var Ci=xa<ha?-1:1;Wi=Math.abs(Math.log(xa/ha))/Kn,Gi=function(){return 0},Ui=function(oi){return Math.exp(Ci*Kn*oi)}}if("duration"in $)$.duration=+$.duration;else{var $i="screenSpeed"in $?+$.screenSpeed/Kn:+$.speed;$.duration=1e3*Wi/$i}return $.maxDuration&&$.duration>$.maxDuration&&($.duration=0),this._zooming=!0,this._rotating=At!==Tr,this._pitching=Ur!==Ut,this._padding=!Ze.isPaddingEqual(Hr),this._prepareEase(ve,!1),this._ease(function(oi){var Li=oi*Wi,Ao=1/Ui(Li);Ze.zoom=oi===1?sr:ut+Ze.scaleZoom(Ao),Se._rotating&&(Ze.bearing=e.number(At,Tr,oi)),Se._pitching&&(Ze.pitch=e.number(Ut,Ur,oi)),Se._padding&&(Ze.interpolatePadding(nr,Hr,oi),fn=Ze.centerPoint.add(Zr));var Oo=oi===1?Nn:Ze.unproject(jn.add(Qn.mult(Gi(Li))).mult(Ao));Ze.setLocationAtPoint(Ze.renderWorldCopies?Oo.wrap():Oo,fn),Se._fireMoveEvents(ve)},function(){return Se._afterEase(ve)},$),this},Y.prototype.isEasing=function(){return!!this._easeFrameId},Y.prototype.stop=function(){return this._stop()},Y.prototype._stop=function($,ve){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var Se=this._onEaseEnd;delete this._onEaseEnd,Se.call(this,ve)}if(!$){var Re=this.handlers;Re&&Re.stop()}return this},Y.prototype._ease=function($,ve,Se){Se.animate===!1||Se.duration===0?($(1),ve()):(this._easeStart=e.browser.now(),this._easeOptions=Se,this._onEaseFrame=$,this._onEaseEnd=ve,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},Y.prototype._renderFrameCallback=function(){var $=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing($)),$<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},Y.prototype._normalizeBearing=function($,ve){$=e.wrap($,-180,180);var Se=Math.abs($-ve);return Math.abs($-360-ve)<Se&&($-=360),Math.abs($+360-ve)<Se&&($+=360),$},Y.prototype._normalizeCenter=function($){var ve=this.transform;if(!(!ve.renderWorldCopies||ve.lngRange)){var Se=$.lng-ve.center.lng;$.lng+=Se>180?-360:Se<-180?360:0}},Y}(e.Evented),Jo=function(Y){Y===void 0&&(Y={}),this.options=Y,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Jo.prototype.getDefaultPosition=function(){return"bottom-right"},Jo.prototype.onAdd=function(Y){var he=this.options&&this.options.compact;return this._map=Y,this._container=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=g.create("div","mapboxgl-ctrl-attrib-inner",this._container),he&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),he===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Jo.prototype.onRemove=function(){g.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Jo.prototype._updateEditLink=function(){var Y=this._editLink;Y||(Y=this._editLink=this._container.querySelector(".mapbox-improve-map"));var he=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(Y){var $=he.reduce(function(ve,Se,Re){return Se.value&&(ve+=Se.key+"="+Se.value+(Re<he.length-1?"&":"")),ve},"?");Y.href=e.config.FEEDBACK_URL+"/"+$+(this._map._hash?this._map._hash.getHashString(!0):""),Y.rel="noopener nofollow"}},Jo.prototype._updateData=function(Y){Y&&(Y.sourceDataType==="metadata"||Y.dataType==="style")&&(this._updateAttributions(),this._updateEditLink())},Jo.prototype._updateAttributions=function(){if(!!this._map.style){var Y=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?Y=Y.concat(this.options.customAttribution.map(function(ut){return typeof ut!="string"?"":ut})):typeof this.options.customAttribution=="string"&&Y.push(this.options.customAttribution)),this._map.style.stylesheet){var he=this._map.style.stylesheet;this.styleOwner=he.owner,this.styleId=he.id}var $=this._map.style.sourceCaches;for(var ve in $){var Se=$[ve];if(Se.used){var Re=Se.getSource();Re.attribution&&Y.indexOf(Re.attribution)<0&&Y.push(Re.attribution)}}Y.sort(function(ut,At){return ut.length-At.length}),Y=Y.filter(function(ut,At){for(var Ut=At+1;Ut<Y.length;Ut++)if(Y[Ut].indexOf(ut)>=0)return!1;return!0});var Ze=Y.join(" | ");Ze!==this._attribHTML&&(this._attribHTML=Ze,Y.length?(this._innerContainer.innerHTML=Ze,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Jo.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var gi=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};gi.prototype.onAdd=function(Y){this._map=Y,this._container=g.create("div","mapboxgl-ctrl");var he=g.create("a","mapboxgl-ctrl-logo");return he.target="_blank",he.rel="noopener nofollow",he.href="https://www.mapbox.com/",he.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),he.setAttribute("rel","noopener nofollow"),this._container.appendChild(he),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},gi.prototype.onRemove=function(){g.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},gi.prototype.getDefaultPosition=function(){return"bottom-left"},gi.prototype._updateLogo=function(Y){(!Y||Y.sourceDataType==="metadata")&&(this._container.style.display=this._logoRequired()?"block":"none")},gi.prototype._logoRequired=function(){if(!!this._map.style){var Y=this._map.style.sourceCaches;for(var he in Y){var $=Y[he].getSource();if($.mapbox_logo)return!0}return!1}},gi.prototype._updateCompact=function(){var Y=this._container.children;if(Y.length){var he=Y[0];this._map.getCanvasContainer().offsetWidth<250?he.classList.add("mapboxgl-compact"):he.classList.remove("mapboxgl-compact")}};var lo=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};lo.prototype.add=function(Y){var he=++this._id,$=this._queue;return $.push({callback:Y,id:he,cancelled:!1}),he},lo.prototype.remove=function(Y){for(var he=this._currentlyRunning,$=he?this._queue.concat(he):this._queue,ve=0,Se=$;ve<Se.length;ve+=1){var Re=Se[ve];if(Re.id===Y){Re.cancelled=!0;return}}},lo.prototype.run=function(Y){Y===void 0&&(Y=0);var he=this._currentlyRunning=this._queue;this._queue=[];for(var $=0,ve=he;$<ve.length;$+=1){var Se=ve[$];if(!Se.cancelled&&(Se.callback(Y),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},lo.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var _u={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},xl=e.window.HTMLImageElement,lu=e.window.HTMLElement,Xl=e.window.ImageBitmap,of=-2,Cf=22,Bs=0,Vu=60,rc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:of,maxZoom:Cf,minPitch:Bs,maxPitch:Vu,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},nc=function(fe){function Y($){var ve=this;if($=e.extend({},rc,$),$.minZoom!=null&&$.maxZoom!=null&&$.minZoom>$.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if($.minPitch!=null&&$.maxPitch!=null&&$.minPitch>$.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if($.minPitch!=null&&$.minPitch<Bs)throw new Error("minPitch must be greater than or equal to "+Bs);if($.maxPitch!=null&&$.maxPitch>Vu)throw new Error("maxPitch must be less than or equal to "+Vu);var Se=new _i($.minZoom,$.maxZoom,$.minPitch,$.maxPitch,$.renderWorldCopies);if(fe.call(this,Se,$),this._interactive=$.interactive,this._maxTileCacheSize=$.maxTileCacheSize,this._failIfMajorPerformanceCaveat=$.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=$.preserveDrawingBuffer,this._antialias=$.antialias,this._trackResize=$.trackResize,this._bearingSnap=$.bearingSnap,this._refreshExpiredTiles=$.refreshExpiredTiles,this._fadeDuration=$.fadeDuration,this._crossSourceCollisions=$.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=$.collectResourceTiming,this._renderTaskQueue=new lo,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},_u,$.locale),this._requestManager=new e.RequestManager($.transformRequest,$.accessToken),typeof $.container=="string"){if(this._container=e.window.document.getElementById($.container),!this._container)throw new Error("Container '"+$.container+"' not found.")}else if($.container instanceof lu)this._container=$.container;else throw new Error("Invalid type: 'container' must be a String or HTMLElement.");if($.maxBounds&&this.setMaxBounds($.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return ve._update(!1)}),this.on("moveend",function(){return ve._update(!1)}),this.on("zoom",function(){return ve._update(!0)}),typeof e.window<"u"&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Ei(this,$);var Re=typeof $.hash=="string"&&$.hash||void 0;this._hash=$.hash&&new go(Re).addTo(this),(!this._hash||!this._hash._onHashChange())&&(this.jumpTo({center:$.center,zoom:$.zoom,bearing:$.bearing,pitch:$.pitch}),$.bounds&&(this.resize(),this.fitBounds($.bounds,e.extend({},$.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=$.localIdeographFontFamily,$.style&&this.setStyle($.style,{localIdeographFontFamily:$.localIdeographFontFamily}),$.attributionControl&&this.addControl(new Jo({customAttribution:$.customAttribution})),this.addControl(new gi,$.logoPosition),this.on("style.load",function(){ve.transform.unmodified&&ve.jumpTo(ve.style.stylesheet)}),this.on("data",function(Ze){ve._update(Ze.dataType==="style"),ve.fire(new e.Event(Ze.dataType+"data",Ze))}),this.on("dataloading",function(Ze){ve.fire(new e.Event(Ze.dataType+"dataloading",Ze))})}fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y;var he={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return Y.prototype._getMapId=function(){return this._mapId},Y.prototype.addControl=function(ve,Se){if(Se===void 0&&ve.getDefaultPosition&&(Se=ve.getDefaultPosition()),Se===void 0&&(Se="top-right"),!ve||!ve.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var Re=ve.onAdd(this);this._controls.push(ve);var Ze=this._controlPositions[Se];return Se.indexOf("bottom")!==-1?Ze.insertBefore(Re,Ze.firstChild):Ze.appendChild(Re),this},Y.prototype.removeControl=function(ve){if(!ve||!ve.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var Se=this._controls.indexOf(ve);return Se>-1&&this._controls.splice(Se,1),ve.onRemove(this),this},Y.prototype.resize=function(ve){var Se=this._containerDimensions(),Re=Se[0],Ze=Se[1];this._resizeCanvas(Re,Ze),this.transform.resize(Re,Ze),this.painter.resize(Re,Ze);var ut=!this._moving;return ut&&(this.stop(),this.fire(new e.Event("movestart",ve)).fire(new e.Event("move",ve))),this.fire(new e.Event("resize",ve)),ut&&this.fire(new e.Event("moveend",ve)),this},Y.prototype.getBounds=function(){return this.transform.getBounds()},Y.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},Y.prototype.setMaxBounds=function(ve){return this.transform.setMaxBounds(e.LngLatBounds.convert(ve)),this._update()},Y.prototype.setMinZoom=function(ve){if(ve=ve??of,ve>=of&&ve<=this.transform.maxZoom)return this.transform.minZoom=ve,this._update(),this.getZoom()<ve&&this.setZoom(ve),this;throw new Error("minZoom must be between "+of+" and the current maxZoom, inclusive")},Y.prototype.getMinZoom=function(){return this.transform.minZoom},Y.prototype.setMaxZoom=function(ve){if(ve=ve??Cf,ve>=this.transform.minZoom)return this.transform.maxZoom=ve,this._update(),this.getZoom()>ve&&this.setZoom(ve),this;throw new Error("maxZoom must be greater than the current minZoom")},Y.prototype.getMaxZoom=function(){return this.transform.maxZoom},Y.prototype.setMinPitch=function(ve){if(ve=ve??Bs,ve<Bs)throw new Error("minPitch must be greater than or equal to "+Bs);if(ve>=Bs&&ve<=this.transform.maxPitch)return this.transform.minPitch=ve,this._update(),this.getPitch()<ve&&this.setPitch(ve),this;throw new Error("minPitch must be between "+Bs+" and the current maxPitch, inclusive")},Y.prototype.getMinPitch=function(){return this.transform.minPitch},Y.prototype.setMaxPitch=function(ve){if(ve=ve??Vu,ve>Vu)throw new Error("maxPitch must be less than or equal to "+Vu);if(ve>=this.transform.minPitch)return this.transform.maxPitch=ve,this._update(),this.getPitch()>ve&&this.setPitch(ve),this;throw new Error("maxPitch must be greater than the current minPitch")},Y.prototype.getMaxPitch=function(){return this.transform.maxPitch},Y.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},Y.prototype.setRenderWorldCopies=function(ve){return this.transform.renderWorldCopies=ve,this._update()},Y.prototype.project=function(ve){return this.transform.locationPoint(e.LngLat.convert(ve))},Y.prototype.unproject=function(ve){return this.transform.pointLocation(e.Point.convert(ve))},Y.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},Y.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},Y.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},Y.prototype._createDelegatedListener=function(ve,Se,Re){var Ze=this,ut;if(ve==="mouseenter"||ve==="mouseover"){var At=!1,Ut=function(Fr){var Zr=Ze.getLayer(Se)?Ze.queryRenderedFeatures(Fr.point,{layers:[Se]}):[];Zr.length?At||(At=!0,Re.call(Ze,new ue(ve,Ze,Fr.originalEvent,{features:Zr}))):At=!1},nr=function(){At=!1};return{layer:Se,listener:Re,delegates:{mousemove:Ut,mouseout:nr}}}else if(ve==="mouseleave"||ve==="mouseout"){var sr=!1,Tr=function(Fr){var Zr=Ze.getLayer(Se)?Ze.queryRenderedFeatures(Fr.point,{layers:[Se]}):[];Zr.length?sr=!0:sr&&(sr=!1,Re.call(Ze,new ue(ve,Ze,Fr.originalEvent)))},Ur=function(Fr){sr&&(sr=!1,Re.call(Ze,new ue(ve,Ze,Fr.originalEvent)))};return{layer:Se,listener:Re,delegates:{mousemove:Tr,mouseout:Ur}}}else{var Hr=function(Fr){var Zr=Ze.getLayer(Se)?Ze.queryRenderedFeatures(Fr.point,{layers:[Se]}):[];Zr.length&&(Fr.features=Zr,Re.call(Ze,Fr),delete Fr.features)};return{layer:Se,listener:Re,delegates:(ut={},ut[ve]=Hr,ut)}}},Y.prototype.on=function(ve,Se,Re){if(Re===void 0)return fe.prototype.on.call(this,ve,Se);var Ze=this._createDelegatedListener(ve,Se,Re);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[ve]=this._delegatedListeners[ve]||[],this._delegatedListeners[ve].push(Ze);for(var ut in Ze.delegates)this.on(ut,Ze.delegates[ut]);return this},Y.prototype.once=function(ve,Se,Re){if(Re===void 0)return fe.prototype.once.call(this,ve,Se);var Ze=this._createDelegatedListener(ve,Se,Re);for(var ut in Ze.delegates)this.once(ut,Ze.delegates[ut]);return this},Y.prototype.off=function(ve,Se,Re){var Ze=this;if(Re===void 0)return fe.prototype.off.call(this,ve,Se);var ut=function(At){for(var Ut=At[ve],nr=0;nr<Ut.length;nr++){var sr=Ut[nr];if(sr.layer===Se&&sr.listener===Re){for(var Tr in sr.delegates)Ze.off(Tr,sr.delegates[Tr]);return Ut.splice(nr,1),Ze}}};return this._delegatedListeners&&this._delegatedListeners[ve]&&ut(this._delegatedListeners),this},Y.prototype.queryRenderedFeatures=function(ve,Se){if(!this.style)return[];Se===void 0&&ve!==void 0&&!(ve instanceof e.Point)&&!Array.isArray(ve)&&(Se=ve,ve=void 0),Se=Se||{},ve=ve||[[0,0],[this.transform.width,this.transform.height]];var Re;if(ve instanceof e.Point||typeof ve[0]=="number")Re=[e.Point.convert(ve)];else{var Ze=e.Point.convert(ve[0]),ut=e.Point.convert(ve[1]);Re=[Ze,new e.Point(ut.x,Ze.y),ut,new e.Point(Ze.x,ut.y),Ze]}return this.style.queryRenderedFeatures(Re,Se,this.transform)},Y.prototype.querySourceFeatures=function(ve,Se){return this.style.querySourceFeatures(ve,Se)},Y.prototype.setStyle=function(ve,Se){return Se=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},Se),Se.diff!==!1&&Se.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&ve?(this._diffStyle(ve,Se),this):(this._localIdeographFontFamily=Se.localIdeographFontFamily,this._updateStyle(ve,Se))},Y.prototype._getUIString=function(ve){var Se=this._locale[ve];if(Se==null)throw new Error("Missing UI string '"+ve+"'");return Se},Y.prototype._updateStyle=function(ve,Se){if(this.style&&(this.style.setEventedParent(null),this.style._remove()),ve)this.style=new Fo(this,Se||{});else return delete this.style,this;return this.style.setEventedParent(this,{style:this.style}),typeof ve=="string"?this.style.loadURL(ve):this.style.loadJSON(ve),this},Y.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Fo(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},Y.prototype._diffStyle=function(ve,Se){var Re=this;if(typeof ve=="string"){var Ze=this._requestManager.normalizeStyleURL(ve),ut=this._requestManager.transformRequest(Ze,e.ResourceType.Style);e.getJSON(ut,function(At,Ut){At?Re.fire(new e.ErrorEvent(At)):Ut&&Re._updateDiff(Ut,Se)})}else typeof ve=="object"&&this._updateDiff(ve,Se)},Y.prototype._updateDiff=function(ve,Se){try{this.style.setState(ve)&&this._update(!0)}catch(Re){e.warnOnce("Unable to perform style diff: "+(Re.message||Re.error||Re)+".  Rebuilding the style from scratch."),this._updateStyle(ve,Se)}},Y.prototype.getStyle=function(){if(this.style)return this.style.serialize()},Y.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},Y.prototype.addSource=function(ve,Se){return this._lazyInitEmptyStyle(),this.style.addSource(ve,Se),this._update(!0)},Y.prototype.isSourceLoaded=function(ve){var Se=this.style&&this.style.sourceCaches[ve];if(Se===void 0){this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+ve+"'")));return}return Se.loaded()},Y.prototype.areTilesLoaded=function(){var ve=this.style&&this.style.sourceCaches;for(var Se in ve){var Re=ve[Se],Ze=Re._tiles;for(var ut in Ze){var At=Ze[ut];if(!(At.state==="loaded"||At.state==="errored"))return!1}}return!0},Y.prototype.addSourceType=function(ve,Se,Re){return this._lazyInitEmptyStyle(),this.style.addSourceType(ve,Se,Re)},Y.prototype.removeSource=function(ve){return this.style.removeSource(ve),this._update(!0)},Y.prototype.getSource=function(ve){return this.style.getSource(ve)},Y.prototype.addImage=function(ve,Se,Re){Re===void 0&&(Re={});var Ze=Re.pixelRatio;Ze===void 0&&(Ze=1);var ut=Re.sdf;ut===void 0&&(ut=!1);var At=Re.stretchX,Ut=Re.stretchY,nr=Re.content;this._lazyInitEmptyStyle();var sr=0;if(Se instanceof xl||Xl&&Se instanceof Xl){var Tr=e.browser.getImageData(Se),Ur=Tr.width,Hr=Tr.height,Fr=Tr.data;this.style.addImage(ve,{data:new e.RGBAImage({width:Ur,height:Hr},Fr),pixelRatio:Ze,stretchX:At,stretchY:Ut,content:nr,sdf:ut,version:sr})}else{if(Se.width===void 0||Se.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Zr=Se.width,fn=Se.height,En=Se.data,Nn=Se;this.style.addImage(ve,{data:new e.RGBAImage({width:Zr,height:fn},new Uint8Array(En)),pixelRatio:Ze,stretchX:At,stretchY:Ut,content:nr,sdf:ut,version:sr,userImage:Nn}),Nn.onAdd&&Nn.onAdd(this,ve)}},Y.prototype.updateImage=function(ve,Se){var Re=this.style.getImage(ve);if(!Re)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var Ze=Se instanceof xl||Xl&&Se instanceof Xl?e.browser.getImageData(Se):Se,ut=Ze.width,At=Ze.height,Ut=Ze.data;if(ut===void 0||At===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(ut!==Re.data.width||At!==Re.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var nr=!(Se instanceof xl||Xl&&Se instanceof Xl);Re.data.replace(Ut,nr),this.style.updateImage(ve,Re)},Y.prototype.hasImage=function(ve){return ve?!!this.style.getImage(ve):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},Y.prototype.removeImage=function(ve){this.style.removeImage(ve)},Y.prototype.loadImage=function(ve,Se){e.getImage(this._requestManager.transformRequest(ve,e.ResourceType.Image),Se)},Y.prototype.listImages=function(){return this.style.listImages()},Y.prototype.addLayer=function(ve,Se){return this._lazyInitEmptyStyle(),this.style.addLayer(ve,Se),this._update(!0)},Y.prototype.moveLayer=function(ve,Se){return this.style.moveLayer(ve,Se),this._update(!0)},Y.prototype.removeLayer=function(ve){return this.style.removeLayer(ve),this._update(!0)},Y.prototype.getLayer=function(ve){return this.style.getLayer(ve)},Y.prototype.setLayerZoomRange=function(ve,Se,Re){return this.style.setLayerZoomRange(ve,Se,Re),this._update(!0)},Y.prototype.setFilter=function(ve,Se,Re){return Re===void 0&&(Re={}),this.style.setFilter(ve,Se,Re),this._update(!0)},Y.prototype.getFilter=function(ve){return this.style.getFilter(ve)},Y.prototype.setPaintProperty=function(ve,Se,Re,Ze){return Ze===void 0&&(Ze={}),this.style.setPaintProperty(ve,Se,Re,Ze),this._update(!0)},Y.prototype.getPaintProperty=function(ve,Se){return this.style.getPaintProperty(ve,Se)},Y.prototype.setLayoutProperty=function(ve,Se,Re,Ze){return Ze===void 0&&(Ze={}),this.style.setLayoutProperty(ve,Se,Re,Ze),this._update(!0)},Y.prototype.getLayoutProperty=function(ve,Se){return this.style.getLayoutProperty(ve,Se)},Y.prototype.setLight=function(ve,Se){return Se===void 0&&(Se={}),this._lazyInitEmptyStyle(),this.style.setLight(ve,Se),this._update(!0)},Y.prototype.getLight=function(){return this.style.getLight()},Y.prototype.setFeatureState=function(ve,Se){return this.style.setFeatureState(ve,Se),this._update()},Y.prototype.removeFeatureState=function(ve,Se){return this.style.removeFeatureState(ve,Se),this._update()},Y.prototype.getFeatureState=function(ve){return this.style.getFeatureState(ve)},Y.prototype.getContainer=function(){return this._container},Y.prototype.getCanvasContainer=function(){return this._canvasContainer},Y.prototype.getCanvas=function(){return this._canvas},Y.prototype._containerDimensions=function(){var ve=0,Se=0;return this._container&&(ve=this._container.clientWidth||400,Se=this._container.clientHeight||300),[ve,Se]},Y.prototype._detectMissingCSS=function(){var ve=e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color");ve!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},Y.prototype._setupContainer=function(){var ve=this._container;ve.classList.add("mapboxgl-map");var Se=this._missingCSSCanary=g.create("div","mapboxgl-canary",ve);Se.style.visibility="hidden",this._detectMissingCSS();var Re=this._canvasContainer=g.create("div","mapboxgl-canvas-container",ve);this._interactive&&Re.classList.add("mapboxgl-interactive"),this._canvas=g.create("canvas","mapboxgl-canvas",Re),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var Ze=this._containerDimensions();this._resizeCanvas(Ze[0],Ze[1]);var ut=this._controlContainer=g.create("div","mapboxgl-control-container",ve),At=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Ut){At[Ut]=g.create("div","mapboxgl-ctrl-"+Ut,ut)})},Y.prototype._resizeCanvas=function(ve,Se){var Re=e.browser.devicePixelRatio||1;this._canvas.width=Re*ve,this._canvas.height=Re*Se,this._canvas.style.width=ve+"px",this._canvas.style.height=Se+"px"},Y.prototype._setupPainter=function(){var ve=e.extend({},p.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),Se=this._canvas.getContext("webgl",ve)||this._canvas.getContext("experimental-webgl",ve);if(!Se){this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")));return}this.painter=new Ga(Se,this.transform),e.webpSupported.testSupport(Se)},Y.prototype._contextLost=function(ve){ve.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:ve}))},Y.prototype._contextRestored=function(ve){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:ve}))},Y.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},Y.prototype._update=function(ve){return this.style?(this._styleDirty=this._styleDirty||ve,this._sourcesDirty=!0,this.triggerRepaint(),this):this},Y.prototype._requestRenderFrame=function(ve){return this._update(),this._renderTaskQueue.add(ve)},Y.prototype._cancelRenderFrame=function(ve){this._renderTaskQueue.remove(ve)},Y.prototype._render=function(ve){var Se=this,Re,Ze=0,ut=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(Re=ut.createQueryEXT(),ut.beginQueryEXT(ut.TIME_ELAPSED_EXT,Re),Ze=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(ve),!this._removed){var At=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var Ut=this.transform.zoom,nr=e.browser.now();this.style.zoomHistory.update(Ut,nr);var sr=new e.EvaluationParameters(Ut,{now:nr,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Tr=sr.crossFadingFactor();(Tr!==1||Tr!==this._crossFadingFactor)&&(At=!0,this._crossFadingFactor=Tr),this.style.update(sr)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||At)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ur=e.browser.now()-Ze;ut.endQueryEXT(ut.TIME_ELAPSED_EXT,Re),setTimeout(function(){var Zr=ut.getQueryObjectEXT(Re,ut.QUERY_RESULT_EXT)/1e6;ut.deleteQueryEXT(Re),Se.fire(new e.Event("gpu-timing-frame",{cpuTime:Ur,gpuTime:Zr}))},50)}if(this.listens("gpu-timing-layer")){var Hr=this.painter.collectGpuTimers();setTimeout(function(){var Zr=Se.painter.queryGpuTimers(Hr);Se.fire(new e.Event("gpu-timing-layer",{layerTimes:Zr}))},50)}var Fr=this._sourcesDirty||this._styleDirty||this._placementDirty;return Fr||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},Y.prototype.remove=function(){this._hash&&this._hash.remove();for(var ve=0,Se=this._controls;ve<Se.length;ve+=1){var Re=Se[ve];Re.onRemove(this)}this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof e.window<"u"&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var Ze=this.painter.context.gl.getExtension("WEBGL_lose_context");Ze&&Ze.loseContext(),mf(this._canvasContainer),mf(this._controlContainer),mf(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},Y.prototype.triggerRepaint=function(){var ve=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(Se){ve._frame=null,ve._render(Se)}))},Y.prototype._onWindowOnline=function(){this._update()},Y.prototype._onWindowResize=function(ve){this._trackResize&&this.resize({originalEvent:ve})._update()},he.showTileBoundaries.get=function(){return!!this._showTileBoundaries},he.showTileBoundaries.set=function($){this._showTileBoundaries!==$&&(this._showTileBoundaries=$,this._update())},he.showPadding.get=function(){return!!this._showPadding},he.showPadding.set=function($){this._showPadding!==$&&(this._showPadding=$,this._update())},he.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},he.showCollisionBoxes.set=function($){this._showCollisionBoxes!==$&&(this._showCollisionBoxes=$,$?this.style._generateCollisionBoxes():this._update())},he.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},he.showOverdrawInspector.set=function($){this._showOverdrawInspector!==$&&(this._showOverdrawInspector=$,this._update())},he.repaint.get=function(){return!!this._repaint},he.repaint.set=function($){this._repaint!==$&&(this._repaint=$,this.triggerRepaint())},he.vertices.get=function(){return!!this._vertices},he.vertices.set=function($){this._vertices=$,this._update()},Y.prototype._setCacheLimits=function(ve,Se){e.setCacheLimits(ve,Se)},he.version.get=function(){return e.version},Object.defineProperties(Y.prototype,he),Y}(qs);function mf(fe){fe.parentNode&&fe.parentNode.removeChild(fe)}var Lf={showCompass:!0,showZoom:!0,visualizePitch:!1},wu=function(Y){var he=this;this.options=e.extend({},Lf,Y),this._container=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function($){return $.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function($){return he._map.zoomIn({},{originalEvent:$})}),g.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function($){return he._map.zoomOut({},{originalEvent:$})}),g.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function($){he.options.visualizePitch?he._map.resetNorthPitch({},{originalEvent:$}):he._map.resetNorth({},{originalEvent:$})}),this._compassIcon=g.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};wu.prototype._updateZoomButtons=function(){var Y=this._map.getZoom();this._zoomInButton.disabled=Y===this._map.getMaxZoom(),this._zoomOutButton.disabled=Y===this._map.getMinZoom()},wu.prototype._rotateCompassArrow=function(){var Y=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=Y},wu.prototype.onAdd=function(Y){return this._map=Y,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new el(this._map,this._compass,this.options.visualizePitch)),this._container},wu.prototype.onRemove=function(){g.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},wu.prototype._createButton=function(Y,he){var $=g.create("button",Y,this._container);return $.type="button",$.addEventListener("click",he),$},wu.prototype._setButtonTitle=function(Y,he){var $=this._map._getUIString("NavigationControl."+he);Y.title=$,Y.setAttribute("aria-label",$)};var el=function(Y,he,$){$===void 0&&($=!1),this._clickTolerance=10,this.element=he,this.mouseRotate=new qr({clickTolerance:Y.dragRotate._mouseRotate._clickTolerance}),this.map=Y,$&&(this.mousePitch=new an({clickTolerance:Y.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),g.addEventListener(he,"mousedown",this.mousedown),g.addEventListener(he,"touchstart",this.touchstart,{passive:!1}),g.addEventListener(he,"touchmove",this.touchmove),g.addEventListener(he,"touchend",this.touchend),g.addEventListener(he,"touchcancel",this.reset)};el.prototype.down=function(Y,he){this.mouseRotate.mousedown(Y,he),this.mousePitch&&this.mousePitch.mousedown(Y,he),g.disableDrag()},el.prototype.move=function(Y,he){var $=this.map,ve=this.mouseRotate.mousemoveWindow(Y,he);if(ve&&ve.bearingDelta&&$.setBearing($.getBearing()+ve.bearingDelta),this.mousePitch){var Se=this.mousePitch.mousemoveWindow(Y,he);Se&&Se.pitchDelta&&$.setPitch($.getPitch()+Se.pitchDelta)}},el.prototype.off=function(){var Y=this.element;g.removeEventListener(Y,"mousedown",this.mousedown),g.removeEventListener(Y,"touchstart",this.touchstart,{passive:!1}),g.removeEventListener(Y,"touchmove",this.touchmove),g.removeEventListener(Y,"touchend",this.touchend),g.removeEventListener(Y,"touchcancel",this.reset),this.offTemp()},el.prototype.offTemp=function(){g.enableDrag(),g.removeEventListener(e.window,"mousemove",this.mousemove),g.removeEventListener(e.window,"mouseup",this.mouseup)},el.prototype.mousedown=function(Y){this.down(e.extend({},Y,{ctrlKey:!0,preventDefault:function(){return Y.preventDefault()}}),g.mousePos(this.element,Y)),g.addEventListener(e.window,"mousemove",this.mousemove),g.addEventListener(e.window,"mouseup",this.mouseup)},el.prototype.mousemove=function(Y){this.move(Y,g.mousePos(this.element,Y))},el.prototype.mouseup=function(Y){this.mouseRotate.mouseupWindow(Y),this.mousePitch&&this.mousePitch.mouseupWindow(Y),this.offTemp()},el.prototype.touchstart=function(Y){Y.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=g.touchPos(this.element,Y.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return Y.preventDefault()}},this._startPos))},el.prototype.touchmove=function(Y){Y.targetTouches.length!==1?this.reset():(this._lastPos=g.touchPos(this.element,Y.targetTouches)[0],this.move({preventDefault:function(){return Y.preventDefault()}},this._lastPos))},el.prototype.touchend=function(Y){Y.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},el.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};function Tu(fe,Y,he){if(fe=new e.LngLat(fe.lng,fe.lat),Y){var $=new e.LngLat(fe.lng-360,fe.lat),ve=new e.LngLat(fe.lng+360,fe.lat),Se=he.locationPoint(fe).distSqr(Y);he.locationPoint($).distSqr(Y)<Se?fe=$:he.locationPoint(ve).distSqr(Y)<Se&&(fe=ve)}for(;Math.abs(fe.lng-he.center.lng)>180;){var Re=he.locationPoint(fe);if(Re.x>=0&&Re.y>=0&&Re.x<=he.width&&Re.y<=he.height)break;fe.lng>he.center.lng?fe.lng-=360:fe.lng+=360}return fe}var xf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Pf(fe,Y,he){var $=fe.classList;for(var ve in xf)$.remove("mapboxgl-"+he+"-anchor-"+ve);$.add("mapboxgl-"+he+"-anchor-"+Y)}var sf=function(fe){function Y(he,$){var ve=this;if(fe.call(this),(he instanceof e.window.HTMLElement||$)&&(he=e.extend({element:he},$)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=he&&he.anchor||"center",this._color=he&&he.color||"#3FB1CE",this._draggable=he&&he.draggable||!1,this._state="inactive",this._rotation=he&&he.rotation||0,this._rotationAlignment=he&&he.rotationAlignment||"auto",this._pitchAlignment=he&&he.pitchAlignment&&he.pitchAlignment!=="auto"?he.pitchAlignment:this._rotationAlignment,!he||!he.element){this._defaultMarker=!0,this._element=g.create("div"),this._element.setAttribute("aria-label","Map marker");var Se=g.createNS("http://www.w3.org/2000/svg","svg");Se.setAttributeNS(null,"display","block"),Se.setAttributeNS(null,"height","41px"),Se.setAttributeNS(null,"width","27px"),Se.setAttributeNS(null,"viewBox","0 0 27 41");var Re=g.createNS("http://www.w3.org/2000/svg","g");Re.setAttributeNS(null,"stroke","none"),Re.setAttributeNS(null,"stroke-width","1"),Re.setAttributeNS(null,"fill","none"),Re.setAttributeNS(null,"fill-rule","evenodd");var Ze=g.createNS("http://www.w3.org/2000/svg","g");Ze.setAttributeNS(null,"fill-rule","nonzero");var ut=g.createNS("http://www.w3.org/2000/svg","g");ut.setAttributeNS(null,"transform","translate(3.0, 29.0)"),ut.setAttributeNS(null,"fill","#000000");for(var At=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}],Ut=0,nr=At;Ut<nr.length;Ut+=1){var sr=nr[Ut],Tr=g.createNS("http://www.w3.org/2000/svg","ellipse");Tr.setAttributeNS(null,"opacity","0.04"),Tr.setAttributeNS(null,"cx","10.5"),Tr.setAttributeNS(null,"cy","5.80029008"),Tr.setAttributeNS(null,"rx",sr.rx),Tr.setAttributeNS(null,"ry",sr.ry),ut.appendChild(Tr)}var Ur=g.createNS("http://www.w3.org/2000/svg","g");Ur.setAttributeNS(null,"fill",this._color);var Hr=g.createNS("http://www.w3.org/2000/svg","path");Hr.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Ur.appendChild(Hr);var Fr=g.createNS("http://www.w3.org/2000/svg","g");Fr.setAttributeNS(null,"opacity","0.25"),Fr.setAttributeNS(null,"fill","#000000");var Zr=g.createNS("http://www.w3.org/2000/svg","path");Zr.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Fr.appendChild(Zr);var fn=g.createNS("http://www.w3.org/2000/svg","g");fn.setAttributeNS(null,"transform","translate(6.0, 7.0)"),fn.setAttributeNS(null,"fill","#FFFFFF");var En=g.createNS("http://www.w3.org/2000/svg","g");En.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Nn=g.createNS("http://www.w3.org/2000/svg","circle");Nn.setAttributeNS(null,"fill","#000000"),Nn.setAttributeNS(null,"opacity","0.25"),Nn.setAttributeNS(null,"cx","5.5"),Nn.setAttributeNS(null,"cy","5.5"),Nn.setAttributeNS(null,"r","5.4999962");var jn=g.createNS("http://www.w3.org/2000/svg","circle");jn.setAttributeNS(null,"fill","#FFFFFF"),jn.setAttributeNS(null,"cx","5.5"),jn.setAttributeNS(null,"cy","5.5"),jn.setAttributeNS(null,"r","5.4999962"),En.appendChild(Nn),En.appendChild(jn),Ze.appendChild(ut),Ze.appendChild(Ur),Ze.appendChild(Fr),Ze.appendChild(fn),Ze.appendChild(En),Se.appendChild(Ze),this._element.appendChild(Se),this._offset=e.Point.convert(he&&he.offset||[0,-14])}else this._element=he.element,this._offset=e.Point.convert(he&&he.offset||[0,0]);this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(Qn){Qn.preventDefault()}),this._element.addEventListener("mousedown",function(Qn){Qn.preventDefault()}),this._element.addEventListener("focus",function(){var Qn=ve._map.getContainer();Qn.scrollTop=0,Qn.scrollLeft=0}),Pf(this._element,this._anchor,"marker"),this._popup=null}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.addTo=function($){return this.remove(),this._map=$,$.getCanvasContainer().appendChild(this._element),$.on("move",this._update),$.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},Y.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),g.remove(this._element),this._popup&&this._popup.remove(),this},Y.prototype.getLngLat=function(){return this._lngLat},Y.prototype.setLngLat=function($){return this._lngLat=e.LngLat.convert($),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},Y.prototype.getElement=function(){return this._element},Y.prototype.setPopup=function($){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),$){if(!("offset"in $.options)){var ve=38.1,Se=13.5,Re=Math.sqrt(Math.pow(Se,2)/2);$.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-ve],"bottom-left":[Re,(ve-Se+Re)*-1],"bottom-right":[-Re,(ve-Se+Re)*-1],left:[Se,(ve-Se)*-1],right:[-Se,(ve-Se)*-1]}:this._offset}this._popup=$,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},Y.prototype._onKeyPress=function($){var ve=$.code,Se=$.charCode||$.keyCode;(ve==="Space"||ve==="Enter"||Se===32||Se===13)&&this.togglePopup()},Y.prototype._onMapClick=function($){var ve=$.originalEvent.target,Se=this._element;this._popup&&(ve===Se||Se.contains(ve))&&this.togglePopup()},Y.prototype.getPopup=function(){return this._popup},Y.prototype.togglePopup=function(){var $=this._popup;if($)$.isOpen()?$.remove():$.addTo(this._map);else return this;return this},Y.prototype._update=function($){if(!!this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Tu(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var ve="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?ve="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(ve="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var Se="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?Se="rotateX(0deg)":this._pitchAlignment==="map"&&(Se="rotateX("+this._map.getPitch()+"deg)"),(!$||$.type==="moveend")&&(this._pos=this._pos.round()),g.setTransform(this._element,xf[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+Se+" "+ve)}},Y.prototype.getOffset=function(){return this._offset},Y.prototype.setOffset=function($){return this._offset=e.Point.convert($),this._update(),this},Y.prototype._onMove=function($){this._pos=$.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},Y.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},Y.prototype._addDragHandler=function($){this._element.contains($.originalEvent.target)&&($.preventDefault(),this._positionDelta=$.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},Y.prototype.setDraggable=function($){return this._draggable=!!$,this._map&&($?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},Y.prototype.isDraggable=function(){return this._draggable},Y.prototype.setRotation=function($){return this._rotation=$||0,this._update(),this},Y.prototype.getRotation=function(){return this._rotation},Y.prototype.setRotationAlignment=function($){return this._rotationAlignment=$||"auto",this._update(),this},Y.prototype.getRotationAlignment=function(){return this._rotationAlignment},Y.prototype.setPitchAlignment=function($){return this._pitchAlignment=$&&$!=="auto"?$:this._rotationAlignment,this._update(),this},Y.prototype.getPitchAlignment=function(){return this._pitchAlignment},Y}(e.Evented),ac={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Hu;function bf(fe){Hu!==void 0?fe(Hu):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(Y){Hu=Y.state!=="denied",fe(Hu)}):(Hu=!!e.window.navigator.geolocation,fe(Hu))}var lf=0,Gu=!1,ic=function(fe){function Y(he){fe.call(this),this.options=e.extend({},ac,he),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.onAdd=function($){return this._map=$,this._container=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),bf(this._setupUI),this._container},Y.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),g.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,lf=0,Gu=!1},Y.prototype._isOutOfMapMaxBounds=function($){var ve=this._map.getMaxBounds(),Se=$.coords;return ve&&(Se.longitude<ve.getWest()||Se.longitude>ve.getEast()||Se.latitude<ve.getSouth()||Se.latitude>ve.getNorth())},Y.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break}},Y.prototype._onSuccess=function($){if(!!this._map){if(this._isOutOfMapMaxBounds($)){this._setErrorState(),this.fire(new e.Event("outofmaxbounds",$)),this._updateMarker(),this._finish();return}if(this.options.trackUserLocation)switch(this._lastKnownPosition=$,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker($),(!this.options.trackUserLocation||this._watchState==="ACTIVE_LOCK")&&this._updateCamera($),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",$)),this._finish()}},Y.prototype._updateCamera=function($){var ve=new e.LngLat($.coords.longitude,$.coords.latitude),Se=$.coords.accuracy,Re=this._map.getBearing(),Ze=e.extend({bearing:Re},this.options.fitBoundsOptions);this._map.fitBounds(ve.toBounds(Se),Ze,{geolocateSource:!0})},Y.prototype._updateMarker=function($){if($){var ve=new e.LngLat($.coords.longitude,$.coords.latitude);this._accuracyCircleMarker.setLngLat(ve).addTo(this._map),this._userLocationDotMarker.setLngLat(ve).addTo(this._map),this._accuracy=$.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},Y.prototype._updateCircleRadius=function(){var $=this._map._container.clientHeight/2,ve=this._map.unproject([0,$]),Se=this._map.unproject([1,$]),Re=ve.distanceTo(Se),Ze=Math.ceil(2*this._accuracy/Re);this._circleElement.style.width=Ze+"px",this._circleElement.style.height=Ze+"px"},Y.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},Y.prototype._onError=function($){if(!!this._map){if(this.options.trackUserLocation)if($.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var ve=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=ve,this._geolocateButton.setAttribute("aria-label",ve),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if($.code===3&&Gu)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",$)),this._finish()}},Y.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},Y.prototype._setupUI=function($){var ve=this;if(this._container.addEventListener("contextmenu",function(Ze){return Ze.preventDefault()}),this._geolocateButton=g.create("button","mapboxgl-ctrl-geolocate",this._container),g.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",$===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var Se=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=Se,this._geolocateButton.setAttribute("aria-label",Se)}else{var Re=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=Re,this._geolocateButton.setAttribute("aria-label",Re)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=g.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new sf(this._dotElement),this._circleElement=g.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new sf({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(Ze){var ut=Ze.originalEvent&&Ze.originalEvent.type==="resize";!Ze.geolocateSource&&ve._watchState==="ACTIVE_LOCK"&&!ut&&(ve._watchState="BACKGROUND",ve._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),ve._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),ve.fire(new e.Event("trackuserlocationend")))})},Y.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":lf--,Gu=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"));break}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error");break}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),lf++;var $;lf>1?($={maximumAge:6e5,timeout:0},Gu=!0):($=this.options.positionOptions,Gu=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,$)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},Y.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},Y}(e.Evented),Sc={maxWidth:100,unit:"metric"},Yu=function(Y){this.options=e.extend({},Sc,Y),e.bindAll(["_onMove","setUnit"],this)};Yu.prototype.getDefaultPosition=function(){return"bottom-left"},Yu.prototype._onMove=function(){oc(this._map,this._container,this.options)},Yu.prototype.onAdd=function(Y){return this._map=Y,this._container=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",Y.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Yu.prototype.onRemove=function(){g.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Yu.prototype.setUnit=function(Y){this.options.unit=Y,oc(this._map,this._container,this.options)};function oc(fe,Y,he){var $=he&&he.maxWidth||100,ve=fe._container.clientHeight/2,Se=fe.unproject([0,ve]),Re=fe.unproject([$,ve]),Ze=Se.distanceTo(Re);if(he&&he.unit==="imperial"){var ut=3.2808*Ze;if(ut>5280){var At=ut/5280;uf(Y,$,At,fe._getUIString("ScaleControl.Miles"))}else uf(Y,$,ut,fe._getUIString("ScaleControl.Feet"))}else if(he&&he.unit==="nautical"){var Ut=Ze/1852;uf(Y,$,Ut,fe._getUIString("ScaleControl.NauticalMiles"))}else Ze>=1e3?uf(Y,$,Ze/1e3,fe._getUIString("ScaleControl.Kilometers")):uf(Y,$,Ze,fe._getUIString("ScaleControl.Meters"))}function uf(fe,Y,he,$){var ve=Ec(he),Se=ve/he;fe.style.width=Y*Se+"px",fe.innerHTML=ve+"&nbsp;"+$}function kc(fe){var Y=Math.pow(10,Math.ceil(-Math.log(fe)/Math.LN10));return Math.round(fe*Y)/Y}function Ec(fe){var Y=Math.pow(10,(""+Math.floor(fe)).length-1),he=fe/Y;return he=he>=10?10:he>=5?5:he>=3?3:he>=2?2:he>=1?1:kc(he),Y*he}var Zl=function(Y){this._fullscreen=!1,Y&&Y.container&&(Y.container instanceof e.window.HTMLElement?this._container=Y.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};Zl.prototype.onAdd=function(Y){return this._map=Y,this._container||(this._container=this._map.getContainer()),this._controlContainer=g.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Zl.prototype.onRemove=function(){g.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Zl.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},Zl.prototype._setupUI=function(){var Y=this._fullscreenButton=g.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);g.create("span","mapboxgl-ctrl-icon",Y).setAttribute("aria-hidden",!0),Y.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Zl.prototype._updateTitle=function(){var Y=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Y),this._fullscreenButton.title=Y},Zl.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Zl.prototype._isFullscreen=function(){return this._fullscreen},Zl.prototype._changeIcon=function(){var Y=e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement;Y===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Zl.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Cc={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Lc=function(fe){function Y(he){fe.call(this),this.options=e.extend(Object.create(Cc),he),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return fe&&(Y.__proto__=fe),Y.prototype=Object.create(fe&&fe.prototype),Y.prototype.constructor=Y,Y.prototype.addTo=function($){return this._map&&this.remove(),this._map=$,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},Y.prototype.isOpen=function(){return!!this._map},Y.prototype.remove=function(){return this._content&&g.remove(this._content),this._container&&(g.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},Y.prototype.getLngLat=function(){return this._lngLat},Y.prototype.setLngLat=function($){return this._lngLat=e.LngLat.convert($),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},Y.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},Y.prototype.getElement=function(){return this._container},Y.prototype.setText=function($){return this.setDOMContent(e.window.document.createTextNode($))},Y.prototype.setHTML=function($){var ve=e.window.document.createDocumentFragment(),Se=e.window.document.createElement("body"),Re;for(Se.innerHTML=$;Re=Se.firstChild,!!Re;)ve.appendChild(Re);return this.setDOMContent(ve)},Y.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},Y.prototype.setMaxWidth=function($){return this.options.maxWidth=$,this._update(),this},Y.prototype.setDOMContent=function($){return this._createContent(),this._content.appendChild($),this._update(),this},Y.prototype.addClassName=function($){this._container&&this._container.classList.add($)},Y.prototype.removeClassName=function($){this._container&&this._container.classList.remove($)},Y.prototype.toggleClassName=function($){if(this._container)return this._container.classList.toggle($)},Y.prototype._createContent=function(){this._content&&g.remove(this._content),this._content=g.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=g.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},Y.prototype._onMouseUp=function($){this._update($.point)},Y.prototype._onMouseMove=function($){this._update($.point)},Y.prototype._onDrag=function($){this._update($.point)},Y.prototype._update=function($){var ve=this,Se=this._lngLat||this._trackPointer;if(!(!this._map||!Se||!this._content)&&(this._container||(this._container=g.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=g.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Tr){return ve._container.classList.add(Tr)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Tu(this._lngLat,this._pos,this._map.transform)),!(this._trackPointer&&!$))){var Re=this._pos=this._trackPointer&&$?$:this._map.project(this._lngLat),Ze=this.options.anchor,ut=sc(this.options.offset);if(!Ze){var At=this._container.offsetWidth,Ut=this._container.offsetHeight,nr;Re.y+ut.bottom.y<Ut?nr=["top"]:Re.y>this._map.transform.height-Ut?nr=["bottom"]:nr=[],Re.x<At/2?nr.push("left"):Re.x>this._map.transform.width-At/2&&nr.push("right"),nr.length===0?Ze="bottom":Ze=nr.join("-")}var sr=Re.add(ut[Ze]).round();g.setTransform(this._container,xf[Ze]+" translate("+sr.x+"px,"+sr.y+"px)"),Pf(this._container,Ze,"popup")}},Y.prototype._onClose=function(){this.remove()},Y}(e.Evented);function sc(fe){if(fe)if(typeof fe=="number"){var Y=Math.round(Math.sqrt(.5*Math.pow(fe,2)));return{center:new e.Point(0,0),top:new e.Point(0,fe),"top-left":new e.Point(Y,Y),"top-right":new e.Point(-Y,Y),bottom:new e.Point(0,-fe),"bottom-left":new e.Point(Y,-Y),"bottom-right":new e.Point(-Y,-Y),left:new e.Point(fe,0),right:new e.Point(-fe,0)}}else if(fe instanceof e.Point||Array.isArray(fe)){var he=e.Point.convert(fe);return{center:he,top:he,"top-left":he,"top-right":he,bottom:he,"bottom-left":he,"bottom-right":he,left:he,right:he}}else return{center:e.Point.convert(fe.center||[0,0]),top:e.Point.convert(fe.top||[0,0]),"top-left":e.Point.convert(fe["top-left"]||[0,0]),"top-right":e.Point.convert(fe["top-right"]||[0,0]),bottom:e.Point.convert(fe.bottom||[0,0]),"bottom-left":e.Point.convert(fe["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(fe["bottom-right"]||[0,0]),left:e.Point.convert(fe.left||[0,0]),right:e.Point.convert(fe.right||[0,0])};else return sc(new e.Point(0,0))}var Pc={version:e.version,supported:p,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:nc,NavigationControl:wu,GeolocateControl:ic,AttributionControl:Jo,ScaleControl:Yu,FullscreenControl:Zl,Popup:Lc,Marker:sf,Style:Fo,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:_r,clearPrewarmedResources:ln,get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(fe){e.config.ACCESS_TOKEN=fe},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(fe){e.config.API_URL=fe},get workerCount(){return Wt.workerCount},set workerCount(fe){Wt.workerCount=fe},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(fe){e.config.MAX_PARALLEL_IMAGE_REQUESTS=fe},clearStorage:function(Y){e.clearTileCache(Y)},workerUrl:""};return Pc}),P})},{}],240:[function(c,ae,ie){"use strict";ae.exports=Math.log2||function(b){return Math.log(b)*Math.LOG2E}},{}],241:[function(c,ae,ie){"use strict";ae.exports=k;var b=c("mouse-event");function k(P,E){E||(E=P,P=window);var e=0,p=0,g=0,a={shift:!1,alt:!1,control:!1,meta:!1},t=!1;function i(y){var T=!1;return"altKey"in y&&(T=T||y.altKey!==a.alt,a.alt=!!y.altKey),"shiftKey"in y&&(T=T||y.shiftKey!==a.shift,a.shift=!!y.shiftKey),"ctrlKey"in y&&(T=T||y.ctrlKey!==a.control,a.control=!!y.ctrlKey),"metaKey"in y&&(T=T||y.metaKey!==a.meta,a.meta=!!y.metaKey),T}function n(y,T){var w=b.x(T),A=b.y(T);"buttons"in T&&(y=T.buttons|0),(y!==e||w!==p||A!==g||i(T))&&(e=y|0,p=w||0,g=A||0,E&&E(e,p,g,a))}function r(y){n(0,y)}function d(){(e||p||g||a.shift||a.alt||a.meta||a.control)&&(p=g=0,e=0,a.shift=a.alt=a.control=a.meta=!1,E&&E(0,0,0,a))}function s(y){i(y)&&E&&E(e,p,g,a)}function m(y){b.buttons(y)===0?n(0,y):n(e,y)}function x(y){n(e|b.buttons(y),y)}function M(y){n(e&~b.buttons(y),y)}function v(){t||(t=!0,P.addEventListener("mousemove",m),P.addEventListener("mousedown",x),P.addEventListener("mouseup",M),P.addEventListener("mouseleave",r),P.addEventListener("mouseenter",r),P.addEventListener("mouseout",r),P.addEventListener("mouseover",r),P.addEventListener("blur",d),P.addEventListener("keyup",s),P.addEventListener("keydown",s),P.addEventListener("keypress",s),P!==window&&(window.addEventListener("blur",d),window.addEventListener("keyup",s),window.addEventListener("keydown",s),window.addEventListener("keypress",s)))}function _(){!t||(t=!1,P.removeEventListener("mousemove",m),P.removeEventListener("mousedown",x),P.removeEventListener("mouseup",M),P.removeEventListener("mouseleave",r),P.removeEventListener("mouseenter",r),P.removeEventListener("mouseout",r),P.removeEventListener("mouseover",r),P.removeEventListener("blur",d),P.removeEventListener("keyup",s),P.removeEventListener("keydown",s),P.removeEventListener("keypress",s),P!==window&&(window.removeEventListener("blur",d),window.removeEventListener("keyup",s),window.removeEventListener("keydown",s),window.removeEventListener("keypress",s)))}v();var l={element:P};return Object.defineProperties(l,{enabled:{get:function(){return t},set:function(y){y?v():_()},enumerable:!0},buttons:{get:function(){return e},enumerable:!0},x:{get:function(){return p},enumerable:!0},y:{get:function(){return g},enumerable:!0},mods:{get:function(){return a},enumerable:!0}}),l}},{"mouse-event":243}],242:[function(c,ae,ie){var b={left:0,top:0};ae.exports=k;function k(E,e,p){e=e||E.currentTarget||E.srcElement,Array.isArray(p)||(p=[0,0]);var g=E.clientX||0,a=E.clientY||0,t=P(e);return p[0]=g-t.left,p[1]=a-t.top,p}function P(E){return E===window||E===document||E===document.body?b:E.getBoundingClientRect()}},{}],243:[function(c,ae,ie){"use strict";function b(e){if(typeof e=="object"){if("buttons"in e)return e.buttons;if("which"in e){var p=e.which;if(p===2)return 4;if(p===3)return 2;if(p>0)return 1<<p-1}else if("button"in e){var p=e.button;if(p===1)return 4;if(p===2)return 2;if(p>=0)return 1<<p}}return 0}ie.buttons=b;function k(e){return e.target||e.srcElement||window}ie.element=k;function P(e){if(typeof e=="object"){if("offsetX"in e)return e.offsetX;var p=k(e),g=p.getBoundingClientRect();return e.clientX-g.left}return 0}ie.x=P;function E(e){if(typeof e=="object"){if("offsetY"in e)return e.offsetY;var p=k(e),g=p.getBoundingClientRect();return e.clientY-g.top}return 0}ie.y=E},{}],244:[function(c,ae,ie){"use strict";var b=c("to-px");ae.exports=k;function k(P,E,e){typeof P=="function"&&(e=!!E,E=P,P=window);var p=b("ex",P),g=function(a){e&&a.preventDefault();var t=a.deltaX||0,i=a.deltaY||0,n=a.deltaZ||0,r=a.deltaMode,d=1;switch(r){case 1:d=p;break;case 2:d=window.innerHeight;break}if(t*=d,i*=d,n*=d,t||i||n)return E(t,i,n,a)};return P.addEventListener("wheel",g),g}},{"to-px":314}],245:[function(c,ae,ie){(function(b,k){(function(){(function(E,e,p){e[E]=e[E]||p(),typeof ae<"u"&&ae.exports?ae.exports=e[E]:typeof Vr=="function"&&Vr.amd&&Vr(function(){return e[E]})})("Promise",typeof b<"u"?b:this,function(){"use strict";var E,e,p,g=Object.prototype.toString,a=typeof k<"u"?function(y){return k(y)}:setTimeout;try{Object.defineProperty({},"x",{}),E=function(y,T,w,A){return Object.defineProperty(y,T,{value:w,writable:!0,configurable:A!==!1})}}catch{E=function(T,w,A){return T[w]=A,T}}p=function(){var y,T,w;function A(f,u){this.fn=f,this.self=u,this.next=void 0}return{add:function(u,h){w=new A(u,h),T?T.next=w:y=w,T=w,w=void 0},drain:function(){var u=y;for(y=T=e=void 0;u;)u.fn.call(u.self),u=u.next}}}();function t(l,y){p.add(l,y),e||(e=a(p.drain))}function i(l){var y,T=typeof l;return l!=null&&(T=="object"||T=="function")&&(y=l.then),typeof y=="function"?y:!1}function n(){for(var l=0;l<this.chain.length;l++)r(this,this.state===1?this.chain[l].success:this.chain[l].failure,this.chain[l]);this.chain.length=0}function r(l,y,T){var w,A;try{y===!1?T.reject(l.msg):(y===!0?w=l.msg:w=y.call(void 0,l.msg),w===T.promise?T.reject(TypeError("Promise-chain cycle")):(A=i(w))?A.call(w,T.resolve,T.reject):T.resolve(w))}catch(f){T.reject(f)}}function d(l){var y,T=this;if(!T.triggered){T.triggered=!0,T.def&&(T=T.def);try{(y=i(l))?t(function(){var w=new x(T);try{y.call(l,function(){d.apply(w,arguments)},function(){s.apply(w,arguments)})}catch(A){s.call(w,A)}}):(T.msg=l,T.state=1,T.chain.length>0&&t(n,T))}catch(w){s.call(new x(T),w)}}}function s(l){var y=this;y.triggered||(y.triggered=!0,y.def&&(y=y.def),y.msg=l,y.state=2,y.chain.length>0&&t(n,y))}function m(l,y,T,w){for(var A=0;A<y.length;A++)(function(u){l.resolve(y[u]).then(function(o){T(u,o)},w)})(A)}function x(l){this.def=l,this.triggered=!1}function M(l){this.promise=l,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function v(l){if(typeof l!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var y=new M(this);this.then=function(w,A){var f={success:typeof w=="function"?w:!0,failure:typeof A=="function"?A:!1};return f.promise=new this.constructor(function(h,o){if(typeof h!="function"||typeof o!="function")throw TypeError("Not a function");f.resolve=h,f.reject=o}),y.chain.push(f),y.state!==0&&t(n,y),f.promise},this.catch=function(w){return this.then(void 0,w)};try{l.call(void 0,function(w){d.call(y,w)},function(w){s.call(y,w)})}catch(T){s.call(y,T)}}var _=E({},"constructor",v,!1);return v.prototype=_,E(_,"__NPO__",0,!1),E(v,"resolve",function(y){var T=this;return y&&typeof y=="object"&&y.__NPO__===1?y:new T(function(A,f){if(typeof A!="function"||typeof f!="function")throw TypeError("Not a function");A(y)})}),E(v,"reject",function(y){return new this(function(w,A){if(typeof w!="function"||typeof A!="function")throw TypeError("Not a function");A(y)})}),E(v,"all",function(y){var T=this;return g.call(y)!="[object Array]"?T.reject(TypeError("Not an array")):y.length===0?T.resolve([]):new T(function(A,f){if(typeof A!="function"||typeof f!="function")throw TypeError("Not a function");var u=y.length,h=Array(u),o=0;m(T,y,function(R,z){h[R]=z,++o===u&&A(h)},f)})}),E(v,"race",function(y){var T=this;return g.call(y)!="[object Array]"?T.reject(TypeError("Not an array")):new T(function(A,f){if(typeof A!="function"||typeof f!="function")throw TypeError("Not a function");m(T,y,function(h,o){A(o)},f)})}),v})}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},c("timers").setImmediate)},{timers:311}],246:[function(c,ae,ie){var b=Math.PI,k=a(120);ae.exports=P;function P(t){for(var i,n=[],r=0,d=0,s=0,m=0,x=null,M=null,v=0,_=0,l=0,y=t.length;l<y;l++){var T=t[l],w=T[0];switch(w){case"M":s=T[1],m=T[2];break;case"A":T=p(v,_,T[1],T[2],a(T[3]),T[4],T[5],T[6],T[7]),T.unshift("C"),T.length>7&&(n.push(T.splice(0,7)),T.unshift("C"));break;case"S":var A=v,f=_;(i=="C"||i=="S")&&(A+=A-r,f+=f-d),T=["C",A,f,T[1],T[2],T[3],T[4]];break;case"T":i=="Q"||i=="T"?(x=v*2-x,M=_*2-M):(x=v,M=_),T=e(v,_,x,M,T[1],T[2]);break;case"Q":x=T[1],M=T[2],T=e(v,_,T[1],T[2],T[3],T[4]);break;case"L":T=E(v,_,T[1],T[2]);break;case"H":T=E(v,_,T[1],_);break;case"V":T=E(v,_,v,T[1]);break;case"Z":T=E(v,_,s,m);break}i=w,v=T[T.length-2],_=T[T.length-1],T.length>4?(r=T[T.length-4],d=T[T.length-3]):(r=v,d=_),n.push(T)}return n}function E(t,i,n,r){return["C",t,i,n,r,n,r]}function e(t,i,n,r,d,s){return["C",t/3+2/3*n,i/3+2/3*r,d/3+2/3*n,s/3+2/3*r,d,s]}function p(t,i,n,r,d,s,m,x,M,v){if(v)o=v[0],S=v[1],u=v[2],h=v[3];else{var _=g(t,i,-d);t=_.x,i=_.y,_=g(x,M,-d),x=_.x,M=_.y;var l=(t-x)/2,y=(i-M)/2,T=l*l/(n*n)+y*y/(r*r);T>1&&(T=Math.sqrt(T),n=T*n,r=T*r);var w=n*n,A=r*r,f=(s==m?-1:1)*Math.sqrt(Math.abs((w*A-w*y*y-A*l*l)/(w*y*y+A*l*l)));f==1/0&&(f=1);var u=f*n*y/r+(t+x)/2,h=f*-r*l/n+(i+M)/2,o=Math.asin(((i-h)/r).toFixed(9)),S=Math.asin(((M-h)/r).toFixed(9));o=t<u?b-o:o,S=x<u?b-S:S,o<0&&(o=b*2+o),S<0&&(S=b*2+S),m&&o>S&&(o=o-b*2),!m&&S>o&&(S=S-b*2)}if(Math.abs(S-o)>k){var R=S,z=x,O=M;S=o+k*(m&&S>o?1:-1),x=u+n*Math.cos(S),M=h+r*Math.sin(S);var I=p(x,M,n,r,d,0,m,z,O,[S,R,u,h])}var F=Math.tan((S-o)/4),D=4/3*n*F,B=4/3*r*F,U=[2*t-(t+D*Math.sin(o)),2*i-(i-B*Math.cos(o)),x+D*Math.sin(S),M-B*Math.cos(S),x,M];if(v)return U;I&&(U=U.concat(I));for(var X=0;X<U.length;){var oe=g(U[X],U[X+1],d);U[X++]=oe.x,U[X++]=oe.y}return U}function g(t,i,n){return{x:t*Math.cos(n)-i*Math.sin(n),y:t*Math.sin(n)+i*Math.cos(n)}}function a(t){return t*(b/180)}},{}],247:[function(c,ae,ie){"use strict";var b=Object.getOwnPropertySymbols,k=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;function E(p){if(p==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(p)}function e(){try{if(!Object.assign)return!1;var p=new String("abc");if(p[5]="de",Object.getOwnPropertyNames(p)[0]==="5")return!1;for(var g={},a=0;a<10;a++)g["_"+String.fromCharCode(a)]=a;var t=Object.getOwnPropertyNames(g).map(function(n){return g[n]});if(t.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(n){i[n]=n}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}ae.exports=e()?Object.assign:function(p,g){for(var a,t=E(p),i,n=1;n<arguments.length;n++){a=Object(arguments[n]);for(var r in a)k.call(a,r)&&(t[r]=a[r]);if(b){i=b(a);for(var d=0;d<i.length;d++)P.call(a,i[d])&&(t[i[d]]=a[i[d]])}}return t}},{}],248:[function(c,ae,ie){"use strict";function b(E,e){if(typeof E!="string")return[E];var p=[E];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var g=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],a=e.escape||"___",t=!!e.flat;g.forEach(function(r){var d=new RegExp(["\\",r[0],"[^\\",r[0],"\\",r[1],"]*\\",r[1]].join("")),s=[];function m(x,M,v){var _=p.push(x.slice(r[0].length,-r[1].length))-1;return s.push(_),a+_+a}p.forEach(function(x,M){for(var v,_=0;x!=v;)if(v=x,x=x.replace(d,m),_++>1e4)throw Error("References have circular dependency. Please, check them.");p[M]=x}),s=s.reverse(),p=p.map(function(x){return s.forEach(function(M){x=x.replace(new RegExp("(\\"+a+M+"\\"+a+")","g"),r[0]+"$1"+r[1])}),x})});var i=new RegExp("\\"+a+"([0-9]+)\\"+a);function n(r,d,s){for(var m=[],x,M=0;x=i.exec(r);){if(M++>1e4)throw Error("Circular references in parenthesis");m.push(r.slice(0,x.index)),m.push(n(d[x[1]],d)),r=r.slice(x.index+x[0].length)}return m.push(r),m}return t?p:n(p[0],p)}function k(E,e){if(e&&e.flat){var p=e&&e.escape||"___",g=E[0],a;if(!g)return"";for(var t=new RegExp("\\"+p+"([0-9]+)\\"+p),i=0;g!=a;){if(i++>1e4)throw Error("Circular references in "+E);a=g,g=g.replace(t,n)}return g}return E.reduce(function r(d,s){return Array.isArray(s)&&(s=s.reduce(r,"")),d+s},"");function n(r,d){if(E[d]==null)throw Error("Reference "+d+"is undefined");return E[d]}}function P(E,e){return Array.isArray(E)?k(E,e):b(E,e)}P.parse=b,P.stringify=k,ae.exports=P},{}],249:[function(c,ae,ie){"use strict";var b=c("pick-by-alias");ae.exports=k;function k(P){var E;return arguments.length>1&&(P=arguments),typeof P=="string"?P=P.split(/\s/).map(parseFloat):typeof P=="number"&&(P=[P]),P.length&&typeof P[0]=="number"?P.length===1?E={width:P[0],height:P[0],x:0,y:0}:P.length===2?E={width:P[0],height:P[1],x:0,y:0}:E={x:P[0],y:P[1],width:P[2]-P[0]||0,height:P[3]-P[1]||0}:P&&(P=b(P,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),E={x:P.left||0,y:P.top||0},P.width==null?P.right?E.width=P.right-E.x:E.width=0:E.width=P.width,P.height==null?P.bottom?E.height=P.bottom-E.y:E.height=0:E.height=P.height),E}},{"pick-by-alias":253}],250:[function(c,ae,ie){ae.exports=P;var b={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},k=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function P(p){var g=[];return p.replace(k,function(a,t,i){var n=t.toLowerCase();for(i=e(i),n=="m"&&i.length>2&&(g.push([t].concat(i.splice(0,2))),n="l",t=t=="m"?"l":"L");;){if(i.length==b[n])return i.unshift(t),g.push(i);if(i.length<b[n])throw new Error("malformed path data");g.push([t].concat(i.splice(0,b[n])))}}),g}var E=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function e(p){var g=p.match(E);return g?g.map(Number):[]}},{}],251:[function(c,ae,ie){ae.exports=function(k,P){P||(P=[0,""]),k=String(k);var E=parseFloat(k,10);return P[0]=E,P[1]=k.match(/[\d.\-\+]*\s*(.*)/)[1]||"",P}},{}],252:[function(c,ae,ie){(function(b){(function(){(function(){var k,P,E,e,p,g;typeof performance<"u"&&performance!==null&&performance.now?ae.exports=function(){return performance.now()}:typeof b<"u"&&b!==null&&b.hrtime?(ae.exports=function(){return(k()-p)/1e6},P=b.hrtime,k=function(){var a;return a=P(),a[0]*1e9+a[1]},e=k(),g=b.uptime()*1e9,p=e-g):Date.now?(ae.exports=function(){return Date.now()-E},E=Date.now()):(ae.exports=function(){return new Date().getTime()-E},E=new Date().getTime())}).call(this)}).call(this)}).call(this,c("_process"))},{_process:277}],253:[function(c,ae,ie){"use strict";ae.exports=function(E,e,p){var g={},a,t;if(typeof e=="string"&&(e=k(e)),Array.isArray(e)){var i={};for(t=0;t<e.length;t++)i[e[t]]=!0;e=i}for(a in e)e[a]=k(e[a]);var n={};for(a in e){var r=e[a];if(Array.isArray(r))for(t=0;t<r.length;t++){var d=r[t];if(p&&(n[d]=!0),d in E){if(g[a]=E[d],p)for(var s=t;s<r.length;s++)n[r[s]]=!0;break}}else a in E&&(e[a]&&(g[a]=E[a]),p&&(n[a]=!0))}if(p)for(a in E)n[a]||(g[a]=E[a]);return g};var b={};function k(P){return b[P]?b[P]:(typeof P=="string"&&(P=b[P]=P.split(/\s*,\s*|\s+/)),P)}},{}],254:[function(c,ae,ie){var b=c("./lib/build-log"),k=c("./lib/epsilon"),P=c("./lib/intersecter"),E=c("./lib/segment-chainer"),e=c("./lib/segment-selector"),p=c("./lib/geojson"),g=!1,a=k(),t;t={buildLog:function(n){return n===!0?g=b():n===!1&&(g=!1),g===!1?!1:g.list},epsilon:function(n){return a.epsilon(n)},segments:function(n){var r=P(!0,a,g);return n.regions.forEach(r.addRegion),{segments:r.calculate(n.inverted),inverted:n.inverted}},combine:function(n,r){var d=P(!1,a,g);return{combined:d.calculate(n.segments,n.inverted,r.segments,r.inverted),inverted1:n.inverted,inverted2:r.inverted}},selectUnion:function(n){return{segments:e.union(n.combined,g),inverted:n.inverted1||n.inverted2}},selectIntersect:function(n){return{segments:e.intersect(n.combined,g),inverted:n.inverted1&&n.inverted2}},selectDifference:function(n){return{segments:e.difference(n.combined,g),inverted:n.inverted1&&!n.inverted2}},selectDifferenceRev:function(n){return{segments:e.differenceRev(n.combined,g),inverted:!n.inverted1&&n.inverted2}},selectXor:function(n){return{segments:e.xor(n.combined,g),inverted:n.inverted1!==n.inverted2}},polygon:function(n){return{regions:E(n.segments,a,g),inverted:n.inverted}},polygonFromGeoJSON:function(n){return p.toPolygon(t,n)},polygonToGeoJSON:function(n){return p.fromPolygon(t,a,n)},union:function(n,r){return i(n,r,t.selectUnion)},intersect:function(n,r){return i(n,r,t.selectIntersect)},difference:function(n,r){return i(n,r,t.selectDifference)},differenceRev:function(n,r){return i(n,r,t.selectDifferenceRev)},xor:function(n,r){return i(n,r,t.selectXor)}};function i(n,r,d){var s=t.segments(n),m=t.segments(r),x=t.combine(s,m),M=d(x);return t.polygon(M)}typeof window=="object"&&(window.PolyBool=t),ae.exports=t},{"./lib/build-log":255,"./lib/epsilon":256,"./lib/geojson":257,"./lib/intersecter":258,"./lib/segment-chainer":260,"./lib/segment-selector":261}],255:[function(c,ae,ie){function b(){var k,P=0,E=!1;function e(p,g){return k.list.push({type:p,data:g?JSON.parse(JSON.stringify(g)):void 0}),k}return k={list:[],segmentId:function(){return P++},checkIntersection:function(p,g){return e("check",{seg1:p,seg2:g})},segmentChop:function(p,g){return e("div_seg",{seg:p,pt:g}),e("chop",{seg:p,pt:g})},statusRemove:function(p){return e("pop_seg",{seg:p})},segmentUpdate:function(p){return e("seg_update",{seg:p})},segmentNew:function(p,g){return e("new_seg",{seg:p,primary:g})},segmentRemove:function(p){return e("rem_seg",{seg:p})},tempStatus:function(p,g,a){return e("temp_status",{seg:p,above:g,below:a})},rewind:function(p){return e("rewind",{seg:p})},status:function(p,g,a){return e("status",{seg:p,above:g,below:a})},vert:function(p){return p===E?k:(E=p,e("vert",{x:p}))},log:function(p){return typeof p!="string"&&(p=JSON.stringify(p,!1,"  ")),e("log",{txt:p})},reset:function(){return e("reset")},selected:function(p){return e("selected",{segs:p})},chainStart:function(p){return e("chain_start",{seg:p})},chainRemoveHead:function(p,g){return e("chain_rem_head",{index:p,pt:g})},chainRemoveTail:function(p,g){return e("chain_rem_tail",{index:p,pt:g})},chainNew:function(p,g){return e("chain_new",{pt1:p,pt2:g})},chainMatch:function(p){return e("chain_match",{index:p})},chainClose:function(p){return e("chain_close",{index:p})},chainAddHead:function(p,g){return e("chain_add_head",{index:p,pt:g})},chainAddTail:function(p,g){return e("chain_add_tail",{index:p,pt:g})},chainConnect:function(p,g){return e("chain_con",{index1:p,index2:g})},chainReverse:function(p){return e("chain_rev",{index:p})},chainJoin:function(p,g){return e("chain_join",{index1:p,index2:g})},done:function(){return e("done")}},k}ae.exports=b},{}],256:[function(c,ae,ie){function b(k){typeof k!="number"&&(k=1e-10);var P={epsilon:function(E){return typeof E=="number"&&(k=E),k},pointAboveOrOnLine:function(E,e,p){var g=e[0],a=e[1],t=p[0],i=p[1],n=E[0],r=E[1];return(t-g)*(r-a)-(i-a)*(n-g)>=-k},pointBetween:function(E,e,p){var g=E[1]-e[1],a=p[0]-e[0],t=E[0]-e[0],i=p[1]-e[1],n=t*a+g*i;if(n<k)return!1;var r=a*a+i*i;return!(n-r>-k)},pointsSameX:function(E,e){return Math.abs(E[0]-e[0])<k},pointsSameY:function(E,e){return Math.abs(E[1]-e[1])<k},pointsSame:function(E,e){return P.pointsSameX(E,e)&&P.pointsSameY(E,e)},pointsCompare:function(E,e){return P.pointsSameX(E,e)?P.pointsSameY(E,e)?0:E[1]<e[1]?-1:1:E[0]<e[0]?-1:1},pointsCollinear:function(E,e,p){var g=E[0]-e[0],a=E[1]-e[1],t=e[0]-p[0],i=e[1]-p[1];return Math.abs(g*i-t*a)<k},linesIntersect:function(E,e,p,g){var a=e[0]-E[0],t=e[1]-E[1],i=g[0]-p[0],n=g[1]-p[1],r=a*n-t*i;if(Math.abs(r)<k)return!1;var d=E[0]-p[0],s=E[1]-p[1],m=(i*s-n*d)/r,x=(a*s-t*d)/r,M={alongA:0,alongB:0,pt:[E[0]+m*a,E[1]+m*t]};return m<=-k?M.alongA=-2:m<k?M.alongA=-1:m-1<=-k?M.alongA=0:m-1<k?M.alongA=1:M.alongA=2,x<=-k?M.alongB=-2:x<k?M.alongB=-1:x-1<=-k?M.alongB=0:x-1<k?M.alongB=1:M.alongB=2,M},pointInsideRegion:function(E,e){for(var p=E[0],g=E[1],a=e[e.length-1][0],t=e[e.length-1][1],i=!1,n=0;n<e.length;n++){var r=e[n][0],d=e[n][1];d-g>k!=t-g>k&&(a-r)*(g-d)/(t-d)+r-p>k&&(i=!i),a=r,t=d}return i}};return P}ae.exports=b},{}],257:[function(c,ae,ie){var b={toPolygon:function(k,P){function E(g){if(g.length<=0)return k.segments({inverted:!1,regions:[]});function a(n){var r=n.slice(0,n.length-1);return k.segments({inverted:!1,regions:[r]})}for(var t=a(g[0]),i=1;i<g.length;i++)t=k.selectDifference(k.combine(t,a(g[i])));return t}if(P.type==="Polygon")return k.polygon(E(P.coordinates));if(P.type==="MultiPolygon"){for(var e=k.segments({inverted:!1,regions:[]}),p=0;p<P.coordinates.length;p++)e=k.selectUnion(k.combine(e,E(P.coordinates[p])));return k.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(k,P,E){E=k.polygon(k.segments(E));function e(m,x){return P.pointInsideRegion([(m[0][0]+m[1][0])*.5,(m[0][1]+m[1][1])*.5],x)}function p(m){return{region:m,children:[]}}var g=p(null);function a(m,x){for(var M=0;M<m.children.length;M++){var v=m.children[M];if(e(x,v.region)){a(v,x);return}}for(var _=p(x),M=0;M<m.children.length;M++){var v=m.children[M];e(v.region,x)&&(_.children.push(v),m.children.splice(M,1),M--)}m.children.push(_)}for(var t=0;t<E.regions.length;t++){var i=E.regions[t];i.length<3||a(g,i)}function n(m,x){for(var M=0,v=m[m.length-1][0],_=m[m.length-1][1],l=[],y=0;y<m.length;y++){var T=m[y][0],w=m[y][1];l.push([T,w]),M+=w*v-T*_,v=T,_=w}var A=M<0;return A!==x&&l.reverse(),l.push([l[0][0],l[0][1]]),l}var r=[];function d(m){var x=[n(m.region,!1)];r.push(x);for(var M=0;M<m.children.length;M++)x.push(s(m.children[M]))}function s(m){for(var x=0;x<m.children.length;x++)d(m.children[x]);return n(m.region,!0)}for(var t=0;t<g.children.length;t++)d(g.children[t]);return r.length<=0?{type:"Polygon",coordinates:[]}:r.length==1?{type:"Polygon",coordinates:r[0]}:{type:"MultiPolygon",coordinates:r}}};ae.exports=b},{}],258:[function(c,ae,ie){var b=c("./linked-list");function k(P,E,e){function p(M,v){return{id:e?e.segmentId():-1,start:M,end:v,myFill:{above:null,below:null},otherFill:null}}function g(M,v,_){return{id:e?e.segmentId():-1,start:M,end:v,myFill:{above:_.myFill.above,below:_.myFill.below},otherFill:null}}var a=b.create();function t(M,v,_,l,y,T){var w=E.pointsCompare(v,y);return w!==0?w:E.pointsSame(_,T)?0:M!==l?M?1:-1:E.pointAboveOrOnLine(_,l?y:T,l?T:y)?1:-1}function i(M,v){a.insertBefore(M,function(_){var l=t(M.isStart,M.pt,v,_.isStart,_.pt,_.other.pt);return l<0})}function n(M,v){var _=b.node({isStart:!0,pt:M.start,seg:M,primary:v,other:null,status:null});return i(_,M.end),_}function r(M,v,_){var l=b.node({isStart:!1,pt:v.end,seg:v,primary:_,other:M,status:null});M.other=l,i(l,M.pt)}function d(M,v){var _=n(M,v);return r(_,M,v),_}function s(M,v){e&&e.segmentChop(M.seg,v),M.other.remove(),M.seg.end=v,M.other.pt=v,i(M.other,M.pt)}function m(M,v){var _=g(v,M.seg.end,M.seg);return s(M,v),d(_,M.primary)}function x(M,v){var _=b.create();function l(F,D){var B=F.seg.start,U=F.seg.end,X=D.seg.start,oe=D.seg.end;return E.pointsCollinear(B,X,oe)?E.pointsCollinear(U,X,oe)||E.pointAboveOrOnLine(U,X,oe)?1:-1:E.pointAboveOrOnLine(B,X,oe)?1:-1}function y(F){return _.findTransition(function(D){var B=l(F,D.ev);return B>0})}function T(F,D){var B=F.seg,U=D.seg,X=B.start,oe=B.end,se=U.start,q=U.end;e&&e.checkIntersection(B,U);var K=E.linesIntersect(X,oe,se,q);if(K===!1){if(!E.pointsCollinear(X,oe,se)||E.pointsSame(X,q)||E.pointsSame(oe,se))return!1;var G=E.pointsSame(X,se),Q=E.pointsSame(oe,q);if(G&&Q)return D;var V=!G&&E.pointBetween(X,se,q),H=!Q&&E.pointBetween(oe,se,q);if(G)return H?m(D,oe):m(F,q),D;V&&(Q||(H?m(D,oe):m(F,q)),m(D,X))}else K.alongA===0&&(K.alongB===-1?m(F,se):K.alongB===0?m(F,K.pt):K.alongB===1&&m(F,q)),K.alongB===0&&(K.alongA===-1?m(D,X):K.alongA===0?m(D,K.pt):K.alongA===1&&m(D,oe));return!1}for(var w=[];!a.isEmpty();){var A=a.getHead();if(e&&e.vert(A.pt[0]),A.isStart){let F=function(){if(u){var D=T(A,u);if(D)return D}return h?T(A,h):!1};var I=F;e&&e.segmentNew(A.seg,A.primary);var f=y(A),u=f.before?f.before.ev:null,h=f.after?f.after.ev:null;e&&e.tempStatus(A.seg,u?u.seg:!1,h?h.seg:!1);var o=F();if(o){if(P){var S;A.seg.myFill.below===null?S=!0:S=A.seg.myFill.above!==A.seg.myFill.below,S&&(o.seg.myFill.above=!o.seg.myFill.above)}else o.seg.otherFill=A.seg.myFill;e&&e.segmentUpdate(o.seg),A.other.remove(),A.remove()}if(a.getHead()!==A){e&&e.rewind(A.seg);continue}if(P){var S;A.seg.myFill.below===null?S=!0:S=A.seg.myFill.above!==A.seg.myFill.below,h?A.seg.myFill.below=h.seg.myFill.above:A.seg.myFill.below=M,S?A.seg.myFill.above=!A.seg.myFill.below:A.seg.myFill.above=A.seg.myFill.below}else if(A.seg.otherFill===null){var R;h?A.primary===h.primary?R=h.seg.otherFill.above:R=h.seg.myFill.above:R=A.primary?v:M,A.seg.otherFill={above:R,below:R}}e&&e.status(A.seg,u?u.seg:!1,h?h.seg:!1),A.other.status=f.insert(b.node({ev:A}))}else{var z=A.status;if(z===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(_.exists(z.prev)&&_.exists(z.next)&&T(z.prev.ev,z.next.ev),e&&e.statusRemove(z.ev.seg),z.remove(),!A.primary){var O=A.seg.myFill;A.seg.myFill=A.seg.otherFill,A.seg.otherFill=O}w.push(A.seg)}a.getHead().remove()}return e&&e.done(),w}return P?{addRegion:function(M){for(var v,_=M[M.length-1],l=0;l<M.length;l++){v=_,_=M[l];var y=E.pointsCompare(v,_);y!==0&&d(p(y<0?v:_,y<0?_:v),!0)}},calculate:function(M){return x(M,!1)}}:{calculate:function(M,v,_,l){return M.forEach(function(y){d(g(y.start,y.end,y),!0)}),_.forEach(function(y){d(g(y.start,y.end,y),!1)}),x(v,l)}}}ae.exports=k},{"./linked-list":259}],259:[function(c,ae,ie){var b={create:function(){var k={root:{root:!0,next:null},exists:function(P){return!(P===null||P===k.root)},isEmpty:function(){return k.root.next===null},getHead:function(){return k.root.next},insertBefore:function(P,E){for(var e=k.root,p=k.root.next;p!==null;){if(E(p)){P.prev=p.prev,P.next=p,p.prev.next=P,p.prev=P;return}e=p,p=p.next}e.next=P,P.prev=e,P.next=null},findTransition:function(P){for(var E=k.root,e=k.root.next;e!==null&&!P(e);)E=e,e=e.next;return{before:E===k.root?null:E,after:e,insert:function(p){return p.prev=E,p.next=e,E.next=p,e!==null&&(e.prev=p),p}}}};return k},node:function(k){return k.prev=null,k.next=null,k.remove=function(){k.prev.next=k.next,k.next&&(k.next.prev=k.prev),k.prev=null,k.next=null},k}};ae.exports=b},{}],260:[function(c,ae,ie){function b(k,P,E){var e=[],p=[];return k.forEach(function(g){var a=g.start,t=g.end;if(P.pointsSame(a,t)){console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");return}E&&E.chainStart(g);var i={index:0,matches_head:!1,matches_pt1:!1},n={index:0,matches_head:!1,matches_pt1:!1},r=i;function d(O,I,F){return r.index=O,r.matches_head=I,r.matches_pt1=F,r===i?(r=n,!1):(r=null,!0)}for(var s=0;s<e.length;s++){var m=e[s],x=m[0],M=m[1],v=m[m.length-1],_=m[m.length-2];if(P.pointsSame(x,a)){if(d(s,!0,!0))break}else if(P.pointsSame(x,t)){if(d(s,!0,!1))break}else if(P.pointsSame(v,a)){if(d(s,!1,!0))break}else if(P.pointsSame(v,t)&&d(s,!1,!1))break}if(r===i){e.push([a,t]),E&&E.chainNew(a,t);return}if(r===n){E&&E.chainMatch(i.index);var l=i.index,y=i.matches_pt1?t:a,T=i.matches_head,m=e[l],w=T?m[0]:m[m.length-1],A=T?m[1]:m[m.length-2],f=T?m[m.length-1]:m[0],u=T?m[m.length-2]:m[1];if(P.pointsCollinear(A,w,y)&&(T?(E&&E.chainRemoveHead(i.index,y),m.shift()):(E&&E.chainRemoveTail(i.index,y),m.pop()),w=A),P.pointsSame(f,y)){e.splice(l,1),P.pointsCollinear(u,f,w)&&(T?(E&&E.chainRemoveTail(i.index,w),m.pop()):(E&&E.chainRemoveHead(i.index,w),m.shift())),E&&E.chainClose(i.index),p.push(m);return}T?(E&&E.chainAddHead(i.index,y),m.unshift(y)):(E&&E.chainAddTail(i.index,y),m.push(y));return}function h(O){E&&E.chainReverse(O),e[O].reverse()}function o(O,I){var F=e[O],D=e[I],B=F[F.length-1],U=F[F.length-2],X=D[0],oe=D[1];P.pointsCollinear(U,B,X)&&(E&&E.chainRemoveTail(O,B),F.pop(),B=U),P.pointsCollinear(B,X,oe)&&(E&&E.chainRemoveHead(I,X),D.shift()),E&&E.chainJoin(O,I),e[O]=F.concat(D),e.splice(I,1)}var S=i.index,R=n.index;E&&E.chainConnect(S,R);var z=e[S].length<e[R].length;i.matches_head?n.matches_head?z?(h(S),o(S,R)):(h(R),o(R,S)):o(R,S):n.matches_head?o(S,R):z?(h(S),o(R,S)):(h(R),o(S,R))}),p}ae.exports=b},{}],261:[function(c,ae,ie){function b(P,E,e){var p=[];return P.forEach(function(g){var a=(g.myFill.above?8:0)+(g.myFill.below?4:0)+(g.otherFill&&g.otherFill.above?2:0)+(g.otherFill&&g.otherFill.below?1:0);E[a]!==0&&p.push({id:e?e.segmentId():-1,start:g.start,end:g.end,myFill:{above:E[a]===1,below:E[a]===2},otherFill:null})}),e&&e.selected(p),p}var k={union:function(P,E){return b(P,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],E)},intersect:function(P,E){return b(P,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],E)},difference:function(P,E){return b(P,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],E)},differenceRev:function(P,E){return b(P,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],E)},xor:function(P,E){return b(P,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],E)}};ae.exports=k},{}],262:[function(c,ae,ie){"use strict";var b=c("stream").Transform,k=c("stream-parser");function P(){b.call(this,{readableObjectMode:!0})}P.prototype=Object.create(b.prototype),P.prototype.constructor=P,k(P.prototype),ie.ParserStream=P,ie.sliceEq=function(e,p,g){for(var a=p,t=0;t<g.length;)if(e[a++]!==g[t++])return!1;return!0},ie.str2arr=function(e,p){var g=[],a=0;if(p&&p==="hex")for(;a<e.length;)g.push(parseInt(e.slice(a,a+2),16)),a+=2;else for(;a<e.length;a++)g.push(e.charCodeAt(a)&255);return g},ie.readUInt16LE=function(e,p){return e[p]|e[p+1]<<8},ie.readUInt16BE=function(e,p){return e[p+1]|e[p]<<8},ie.readUInt32LE=function(e,p){return e[p]|e[p+1]<<8|e[p+2]<<16|e[p+3]*16777216},ie.readUInt32BE=function(e,p){return e[p+3]|e[p+2]<<8|e[p+1]<<16|e[p]*16777216};function E(e,p,g){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=e,p&&(this.code=p),g&&(this.statusCode=g)}E.prototype=Object.create(Error.prototype),E.prototype.constructor=E,ie.ProbeError=E},{stream:285,"stream-parser":301}],263:[function(c,ae,ie){"use strict";function b(E,e){var p=new Error(E);return p.code=e,p}function k(E){try{return decodeURIComponent(escape(E))}catch{return E}}function P(E,e,p){this.input=E.subarray(e,p),this.start=e;var g=String.fromCharCode.apply(null,this.input.subarray(0,4));if(g!=="II*\0"&&g!=="MM\0*")throw b("invalid TIFF signature","EBADDATA");this.big_endian=g[0]==="M"}P.prototype.each=function(E){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var p=this.ifds_to_read.shift();!p.offset||this.scan_ifd(p.id,p.offset,E)}},P.prototype.read_uint16=function(E){var e=this.input;if(E+2>e.length)throw b("unexpected EOF","EBADDATA");return this.big_endian?e[E]*256+e[E+1]:e[E]+e[E+1]*256},P.prototype.read_uint32=function(E){var e=this.input;if(E+4>e.length)throw b("unexpected EOF","EBADDATA");return this.big_endian?e[E]*16777216+e[E+1]*65536+e[E+2]*256+e[E+3]:e[E]+e[E+1]*256+e[E+2]*65536+e[E+3]*16777216},P.prototype.is_subifd_link=function(E,e){return E===0&&e===34665||E===0&&e===34853||E===34665&&e===40965},P.prototype.exif_format_length=function(E){switch(E){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},P.prototype.exif_format_read=function(E,e){var p;switch(E){case 1:case 2:return p=this.input[e],p;case 6:return p=this.input[e],p|(p&128)*33554430;case 3:return p=this.read_uint16(e),p;case 8:return p=this.read_uint16(e),p|(p&32768)*131070;case 4:return p=this.read_uint32(e),p;case 9:return p=this.read_uint32(e),p|0;case 5:case 10:case 11:case 12:return null;case 7:return null;default:return null}},P.prototype.scan_ifd=function(E,e,p){var g=this.read_uint16(e);e+=2;for(var a=0;a<g;a++){var t=this.read_uint16(e),i=this.read_uint16(e+2),n=this.read_uint32(e+4),r=this.exif_format_length(i),d=n*r,s=d<=4?e+8:this.read_uint32(e+8),m=!1;if(s+d>this.input.length)throw b("unexpected EOF","EBADDATA");for(var x=[],M=s,v=0;v<n;v++,M+=r){var _=this.exif_format_read(i,M);if(_===null){x=null;break}x.push(_)}Array.isArray(x)&&i===2&&(x=k(String.fromCharCode.apply(null,x)),x&&x[x.length-1]==="\0"&&(x=x.slice(0,-1))),this.is_subifd_link(E,t)&&Array.isArray(x)&&Number.isInteger(x[0])&&x[0]>0&&(this.ifds_to_read.push({id:t,offset:x[0]}),m=!0);var l={is_big_endian:this.big_endian,ifd:E,tag:t,format:i,count:n,entry_offset:e+this.start,data_length:d,data_offset:s+this.start,value:x,is_subifd_link:m};if(p(l)===!1){this.aborted=!0;return}e+=12}E===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},ae.exports.ExifParser=P,ae.exports.get_orientation=function(E){var e=0;try{return new P(E,0,E.length).each(function(p){if(p.ifd===0&&p.tag===274&&Array.isArray(p.value))return e=p.value[0],!1}),e}catch{return-1}}},{}],264:[function(c,ae,ie){"use strict";var b=c("./common").readUInt16BE,k=c("./common").readUInt32BE;function P(n,r){if(n.length<4+r)return null;var d=k(n,r);return n.length<d+r||d<8?null:{boxtype:String.fromCharCode.apply(null,n.slice(r+4,r+8)),data:n.slice(r+8,r+d),end:r+d}}ae.exports.unbox=P;function E(n,r){for(var d=0;;){var s=P(n,d);if(!s)break;switch(s.boxtype){case"ispe":r.sizes.push({width:k(s.data,4),height:k(s.data,8)});break;case"irot":r.transforms.push({type:"irot",value:s.data[0]&3});break;case"imir":r.transforms.push({type:"imir",value:s.data[0]&1});break}d=s.end}}function e(n,r,d){for(var s=0,m=0;m<d;m++)s=s*256+(n[r+m]||0);return s}function p(n,r){for(var d=n[4]>>4&15,s=n[4]&15,m=n[5]>>4&15,x=b(n,6),M=8,v=0;v<x;v++){var _=b(n,M);M+=2;var l=b(n,M);M+=2;var y=e(n,M,m);M+=m;var T=b(n,M);if(M+=2,l===0&&T===1){var w=e(n,M,d),A=e(n,M+d,s);r.item_loc[_]={length:A,offset:w+y}}M+=T*(d+s)}}function g(n,r){for(var d=b(n,4),s=6,m=0;m<d;m++){var x=P(n,s);if(!x)break;if(x.boxtype==="infe"){for(var M=b(x.data,4),v="",_=8;_<x.data.length&&x.data[_];_++)v+=String.fromCharCode(x.data[_]);r.item_inf[v]=M}s=x.end}}function a(n,r){for(var d=0;;){var s=P(n,d);if(!s)break;s.boxtype==="ipco"&&E(s.data,r),d=s.end}}function t(n,r){for(var d=4;;){var s=P(n,d);if(!s)break;s.boxtype==="iprp"&&a(s.data,r),s.boxtype==="iloc"&&p(s.data,r),s.boxtype==="iinf"&&g(s.data,r),d=s.end}}function i(n){var r=n.reduce(function(m,x){return m.width>x.width||m.width===x.width&&m.height>x.height?m:x}),d=n.reduce(function(m,x){return m.height>x.height||m.height===x.height&&m.width>x.width?m:x}),s;return r.width>d.height||r.width===d.height&&r.height>d.width?s=r:s=d,s}ae.exports.readSizeFromMeta=function(n){var r={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(t(n,r),!!r.sizes.length){var d=i(r.sizes),s=1;r.transforms.forEach(function(x){var M={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},v={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(x.type==="imir"&&(x.value===0?s=v[s]:(s=v[s],s=M[s],s=M[s])),x.type==="irot")for(var _=0;_<x.value;_++)s=M[s]});var m=null;return r.item_inf.Exif&&(m=r.item_loc[r.item_inf.Exif]),{width:d.width,height:d.height,orientation:r.transforms.length?s:null,variants:r.sizes,exif_location:m}}},ae.exports.getMimeType=function(n){var r=String.fromCharCode.apply(null,n.slice(0,4)),d={};d[r]=!0;for(var s=8;s<n.length;s+=4)d[String.fromCharCode.apply(null,n.slice(s,s+4))]=!0;if(!(!d.mif1&&!d.msf1&&!d.miaf))return r==="avif"||r==="avis"||r==="avio"?{type:"avif",mime:"image/avif"}:r==="heic"||r==="heix"?{type:"heic",mime:"image/heic"}:r==="hevc"||r==="hevx"?{type:"heic",mime:"image/heic-sequence"}:d.avif||d.avis?{type:"avif",mime:"image/avif"}:d.heic||d.heix||d.hevc||d.hevx||d.heis?d.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":262}],265:[function(c,ae,ie){"use strict";var b=c("../common").str2arr,k=c("../common").sliceEq,P=c("../common").readUInt32BE,E=c("../miaf_utils"),e=c("../exif_utils"),p=b("ftyp");ae.exports=function(g){if(!!k(g,4,p)){var a=E.unbox(g,0);if(!!a){var t=E.getMimeType(a.data);if(!!t){for(var i,n=a.end;;){var r=E.unbox(g,n);if(!r)break;if(n=r.end,r.boxtype==="mdat")return;if(r.boxtype==="meta"){i=r.data;break}}if(!!i){var d=E.readSizeFromMeta(i);if(!!d){var s={width:d.width,height:d.height,type:t.type,mime:t.mime,wUnits:"px",hUnits:"px"};if(d.variants.length>1&&(s.variants=d.variants),d.orientation&&(s.orientation=d.orientation),d.exif_location&&d.exif_location.offset+d.exif_location.length<=g.length){var m=P(g,d.exif_location.offset),x=g.slice(d.exif_location.offset+m+4,d.exif_location.offset+d.exif_location.length),M=e.get_orientation(x);M>0&&(s.orientation=M)}return s}}}}}}},{"../common":262,"../exif_utils":263,"../miaf_utils":264}],266:[function(c,ae,ie){"use strict";var b=c("../common").str2arr,k=c("../common").sliceEq,P=c("../common").readUInt16LE,E=b("BM");ae.exports=function(e){if(!(e.length<26)&&!!k(e,0,E))return{width:P(e,18),height:P(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":262}],267:[function(c,ae,ie){"use strict";var b=c("../common").str2arr,k=c("../common").sliceEq,P=c("../common").readUInt16LE,E=b("GIF87a"),e=b("GIF89a");ae.exports=function(p){if(!(p.length<10)&&!(!k(p,0,E)&&!k(p,0,e)))return{width:P(p,6),height:P(p,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":262}],268:[function(c,ae,ie){"use strict";var b=c("../common").readUInt16LE,k=0,P=1,E=16;ae.exports=function(e){var p=b(e,0),g=b(e,2),a=b(e,4);if(!(p!==k||g!==P||!a)){for(var t=[],i={width:0,height:0},n=0;n<a;n++){var r=e[6+E*n]||256,d=e[6+E*n+1]||256,s={width:r,height:d};t.push(s),(r>i.width||d>i.height)&&(i=s)}return{width:i.width,height:i.height,variants:t,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":262}],269:[function(c,ae,ie){"use strict";var b=c("../common").readUInt16BE,k=c("../common").str2arr,P=c("../common").sliceEq,E=c("../exif_utils"),e=k("Exif\0\0");ae.exports=function(p){if(!(p.length<2)&&!(p[0]!==255||p[1]!==216||p[2]!==255))for(var g=2;;){for(;;){if(p.length-g<2)return;if(p[g++]===255)break}for(var a=p[g++],t;a===255;)a=p[g++];if(208<=a&&a<=217||a===1)t=0;else if(192<=a&&a<=254){if(p.length-g<2)return;t=b(p,g)-2,g+=2}else return;if(a===217||a===218)return;var i;if(a===225&&t>=10&&P(p,g,e)&&(i=E.get_orientation(p.slice(g+6,g+t))),t>=5&&192<=a&&a<=207&&a!==196&&a!==200&&a!==204){if(p.length-g<t)return;var n={width:b(p,g+3),height:b(p,g+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return i>0&&(n.orientation=i),n}g+=t}}},{"../common":262,"../exif_utils":263}],270:[function(c,ae,ie){"use strict";var b=c("../common").str2arr,k=c("../common").sliceEq,P=c("../common").readUInt32BE,E=b(`\x89PNG\r

`),e=b("IHDR");ae.exports=function(p){if(!(p.length<24)&&!!k(p,0,E)&&!!k(p,12,e))return{width:P(p,16),height:P(p,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":262}],271:[function(c,ae,ie){"use strict";var b=c("../common").str2arr,k=c("../common").sliceEq,P=c("../common").readUInt32BE,E=b("8BPS\0");ae.exports=function(e){if(!(e.length<6+16)&&!!k(e,0,E))return{width:P(e,6+12),height:P(e,6+8),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":262}],272:[function(c,ae,ie){"use strict";function b(r){return r===32||r===9||r===13||r===10}function k(r){return typeof r=="number"&&isFinite(r)&&r>0}function P(r){var d=0,s=r.length;for(r[0]===239&&r[1]===187&&r[2]===191&&(d=3);d<s&&b(r[d]);)d++;return d===s?!1:r[d]===60}var E=/<[-_.:a-zA-Z0-9][^>]*>/,e=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,p=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,g=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,a=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,t=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function i(r){var d=r.match(p),s=r.match(g),m=r.match(a);return{width:d&&(d[1]||d[2]),height:s&&(s[1]||s[2]),viewbox:m&&(m[1]||m[2])}}function n(r){return t.test(r)?r.match(t)[0]:"px"}ae.exports=function(r){if(!!P(r)){for(var d="",s=0;s<r.length;s++)d+=String.fromCharCode(r[s]);var m=(d.match(E)||[""])[0];if(!!e.test(m)){var x=i(m),M=parseFloat(x.width),v=parseFloat(x.height);if(x.width&&x.height)return!k(M)||!k(v)?void 0:{width:M,height:v,type:"svg",mime:"image/svg+xml",wUnits:n(x.width),hUnits:n(x.height)};var _=(x.viewbox||"").split(" "),l={width:_[2],height:_[3]},y=parseFloat(l.width),T=parseFloat(l.height);if(!(!k(y)||!k(T))&&n(l.width)===n(l.height)){var w=y/T;return x.width?k(M)?{width:M,height:M/w,type:"svg",mime:"image/svg+xml",wUnits:n(x.width),hUnits:n(x.width)}:void 0:x.height?k(v)?{width:v*w,height:v,type:"svg",mime:"image/svg+xml",wUnits:n(x.height),hUnits:n(x.height)}:void 0:{width:y,height:T,type:"svg",mime:"image/svg+xml",wUnits:n(l.width),hUnits:n(l.height)}}}}}},{}],273:[function(c,ae,ie){"use strict";var b=c("../common").str2arr,k=c("../common").sliceEq,P=c("../common").readUInt16LE,E=c("../common").readUInt16BE,e=c("../common").readUInt32LE,p=c("../common").readUInt32BE,g=b("II*\0"),a=b("MM\0*");function t(r,d,s){return s?E(r,d):P(r,d)}function i(r,d,s){return s?p(r,d):e(r,d)}function n(r,d,s){var m=t(r,d+2,s),x=i(r,d+4,s);return x!==1||m!==3&&m!==4?null:m===3?t(r,d+8,s):i(r,d+8,s)}ae.exports=function(r){if(!(r.length<8)&&!(!k(r,0,g)&&!k(r,0,a))){var d=r[0]===77,s=i(r,4,d)-8;if(!(s<0)){var m=s+8;if(!(r.length-m<2)){var x=t(r,m+0,d)*12;if(!(x<=0)&&(m+=2,!(r.length-m<x))){var M,v,_,l;for(M=0;M<x;M+=12)l=t(r,m+M,d),l===256?v=n(r,m+M,d):l===257&&(_=n(r,m+M,d));if(v&&_)return{width:v,height:_,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}}}}}}},{"../common":262}],274:[function(c,ae,ie){"use strict";var b=c("../common").str2arr,k=c("../common").sliceEq,P=c("../common").readUInt16LE,E=c("../common").readUInt32LE,e=c("../exif_utils"),p=b("RIFF"),g=b("WEBP");function a(n,r){if(!(n[r+3]!==157||n[r+4]!==1||n[r+5]!==42))return{width:P(n,r+6)&16383,height:P(n,r+8)&16383,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function t(n,r){if(n[r]===47){var d=E(n,r+1);return{width:(d&16383)+1,height:(d>>14&16383)+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function i(n,r){return{width:(n[r+6]<<16|n[r+5]<<8|n[r+4])+1,height:(n[r+9]<<r|n[r+8]<<8|n[r+7])+1,type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}ae.exports=function(n){if(!(n.length<16)&&!(!k(n,0,p)&&!k(n,8,g))){var r=12,d=null,s=0,m=E(n,4)+8;if(!(m>n.length)){for(;r+8<m;){if(n[r]===0){r++;continue}var x=String.fromCharCode.apply(null,n.slice(r,r+4)),M=E(n,r+4);x==="VP8 "&&M>=10?d=d||a(n,r+8):x==="VP8L"&&M>=9?d=d||t(n,r+8):x==="VP8X"&&M>=10?d=d||i(n,r+8):x==="EXIF"&&(s=e.get_orientation(n.slice(r+8,r+8+M)),r=1/0),r+=8+M}if(!!d)return s>0&&(d.orientation=s),d}}}},{"../common":262,"../exif_utils":263}],275:[function(c,ae,ie){"use strict";ae.exports={avif:c("./parse_sync/avif"),bmp:c("./parse_sync/bmp"),gif:c("./parse_sync/gif"),ico:c("./parse_sync/ico"),jpeg:c("./parse_sync/jpeg"),png:c("./parse_sync/png"),psd:c("./parse_sync/psd"),svg:c("./parse_sync/svg"),tiff:c("./parse_sync/tiff"),webp:c("./parse_sync/webp")}},{"./parse_sync/avif":265,"./parse_sync/bmp":266,"./parse_sync/gif":267,"./parse_sync/ico":268,"./parse_sync/jpeg":269,"./parse_sync/png":270,"./parse_sync/psd":271,"./parse_sync/svg":272,"./parse_sync/tiff":273,"./parse_sync/webp":274}],276:[function(c,ae,ie){"use strict";var b=c("./lib/parsers_sync");function k(P){for(var E=Object.keys(b),e=0;e<E.length;e++){var p=b[E[e]](P);if(p)return p}return null}ae.exports=function(E){return k(E)},ae.exports.parsers=b},{"./lib/parsers_sync":275}],277:[function(c,ae,ie){var b=ae.exports={},k,P;function E(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?k=setTimeout:k=E}catch{k=E}try{typeof clearTimeout=="function"?P=clearTimeout:P=e}catch{P=e}})();function p(x){if(k===setTimeout)return setTimeout(x,0);if((k===E||!k)&&setTimeout)return k=setTimeout,setTimeout(x,0);try{return k(x,0)}catch{try{return k.call(null,x,0)}catch{return k.call(this,x,0)}}}function g(x){if(P===clearTimeout)return clearTimeout(x);if((P===e||!P)&&clearTimeout)return P=clearTimeout,clearTimeout(x);try{return P(x)}catch{try{return P.call(null,x)}catch{return P.call(this,x)}}}var a=[],t=!1,i,n=-1;function r(){!t||!i||(t=!1,i.length?a=i.concat(a):n=-1,a.length&&d())}function d(){if(!t){var x=p(r);t=!0;for(var M=a.length;M;){for(i=a,a=[];++n<M;)i&&i[n].run();n=-1,M=a.length}i=null,t=!1,g(x)}}b.nextTick=function(x){var M=new Array(arguments.length-1);if(arguments.length>1)for(var v=1;v<arguments.length;v++)M[v-1]=arguments[v];a.push(new s(x,M)),a.length===1&&!t&&p(d)};function s(x,M){this.fun=x,this.array=M}s.prototype.run=function(){this.fun.apply(null,this.array)},b.title="browser",b.browser=!0,b.env={},b.argv=[],b.version="",b.versions={};function m(){}b.on=m,b.addListener=m,b.once=m,b.off=m,b.removeListener=m,b.removeAllListeners=m,b.emit=m,b.prependListener=m,b.prependOnceListener=m,b.listeners=function(x){return[]},b.binding=function(x){throw new Error("process.binding is not supported")},b.cwd=function(){return"/"},b.chdir=function(x){throw new Error("process.chdir is not supported")},b.umask=function(){return 0}},{}],278:[function(c,ae,ie){(function(b){(function(){for(var k=c("performance-now"),P=typeof window>"u"?b:window,E=["moz","webkit"],e="AnimationFrame",p=P["request"+e],g=P["cancel"+e]||P["cancelRequest"+e],a=0;!p&&a<E.length;a++)p=P[E[a]+"Request"+e],g=P[E[a]+"Cancel"+e]||P[E[a]+"CancelRequest"+e];if(!p||!g){var t=0,i=0,n=[],r=1e3/60;p=function(d){if(n.length===0){var s=k(),m=Math.max(0,r-(s-t));t=m+s,setTimeout(function(){var x=n.slice(0);n.length=0;for(var M=0;M<x.length;M++)if(!x[M].cancelled)try{x[M].callback(t)}catch(v){setTimeout(function(){throw v},0)}},Math.round(m))}return n.push({handle:++i,callback:d,cancelled:!1}),i},g=function(d){for(var s=0;s<n.length;s++)n[s].handle===d&&(n[s].cancelled=!0)}}ae.exports=function(d){return p.call(P,d)},ae.exports.cancel=function(){g.apply(P,arguments)},ae.exports.polyfill=function(d){d||(d=P),d.requestAnimationFrame=p,d.cancelAnimationFrame=g}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],279:[function(c,ae,ie){"use strict";var b=c("array-bounds"),k=c("color-normalize"),P=c("update-diff"),E=c("pick-by-alias"),e=c("object-assign"),p=c("flatten-vertex-data"),g=c("to-float32"),a=g.float32,t=g.fract32;ae.exports=n;var i=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function n(r,d){if(typeof r=="function"?(d||(d={}),d.regl=r):d=r,d.length&&(d.positions=d),r=d.regl,!r.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var s=r._gl,m,x,M,v,_,l,y={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},T=[];return v=r.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),x=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),M=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),_=r.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),l=r.buffer({usage:"static",type:"float",data:i}),u(d),m=r({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:r.prop("range"),lineWidth:r.prop("lineWidth"),capSize:r.prop("capSize"),opacity:r.prop("opacity"),scale:r.prop("scale"),translate:r.prop("translate"),scaleFract:r.prop("scaleFract"),translateFract:r.prop("translateFract"),viewport:function(o,S){return[S.viewport.x,S.viewport.y,o.viewportWidth,o.viewportHeight]}},attributes:{color:{buffer:v,offset:function(o,S){return S.offset*4},divisor:1},position:{buffer:x,offset:function(o,S){return S.offset*8},divisor:1},positionFract:{buffer:M,offset:function(o,S){return S.offset*8},divisor:1},error:{buffer:_,offset:function(o,S){return S.offset*16},divisor:1},direction:{buffer:l,stride:24,offset:0},lineOffset:{buffer:l,stride:24,offset:8},capOffset:{buffer:l,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:r.prop("viewport")},viewport:r.prop("viewport"),stencil:!1,instances:r.prop("count"),count:i.length}),e(w,{update:u,draw:A,destroy:h,regl:r,gl:s,canvas:s.canvas,groups:T}),w;function w(o){o?u(o):o===null&&h(),A()}function A(o){if(typeof o=="number")return f(o);o&&!Array.isArray(o)&&(o=[o]),r._refresh(),T.forEach(function(S,R){if(!!S){if(o&&(o[R]?S.draw=!0:S.draw=!1),!S.draw){S.draw=!0;return}f(R)}})}function f(o){typeof o=="number"&&(o=T[o]),o!=null&&(!(o&&o.count&&o.color&&o.opacity&&o.positions&&o.positions.length>1)||(o.scaleRatio=[o.scale[0]*o.viewport.width,o.scale[1]*o.viewport.height],m(o),o.after&&o.after(o)))}function u(o){if(!!o){o.length!=null?typeof o[0]=="number"&&(o=[{positions:o}]):Array.isArray(o)||(o=[o]);var S=0,R=0;if(w.groups=T=o.map(function(U,X){var oe=T[X];if(U)typeof U=="function"?U={after:U}:typeof U[0]=="number"&&(U={positions:U});else return oe;return U=E(U,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),oe||(T[X]=oe={id:X,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},U=e({},y,U)),P(oe,U,[{lineWidth:function(se){return+se*.5},capSize:function(se){return+se*.5},opacity:parseFloat,errors:function(se){return se=p(se),R+=se.length,se},positions:function(se,q){return se=p(se,"float64"),q.count=Math.floor(se.length/2),q.bounds=b(se,2),q.offset=S,S+=q.count,se}},{color:function(se,q){var K=q.count;if(se||(se="transparent"),!Array.isArray(se)||typeof se[0]=="number"){var G=se;se=Array(K);for(var Q=0;Q<K;Q++)se[Q]=G}if(se.length<K)throw Error("Not enough colors");for(var V=new Uint8Array(K*4),H=0;H<K;H++){var ee=k(se[H],"uint8");V.set(ee,H*4)}return V},range:function(se,q,K){var G=q.bounds;return se||(se=G),q.scale=[1/(se[2]-se[0]),1/(se[3]-se[1])],q.translate=[-se[0],-se[1]],q.scaleFract=t(q.scale),q.translateFract=t(q.translate),se},viewport:function(se){var q;return Array.isArray(se)?q={x:se[0],y:se[1],width:se[2]-se[0],height:se[3]-se[1]}:se?(q={x:se.x||se.left||0,y:se.y||se.top||0},se.right?q.width=se.right-q.x:q.width=se.w||se.width||0,se.bottom?q.height=se.bottom-q.y:q.height=se.h||se.height||0):q={x:0,y:0,width:s.drawingBufferWidth,height:s.drawingBufferHeight},q}}]),oe}),S||R){var z=T.reduce(function(U,X,oe){return U+(X?X.count:0)},0),O=new Float64Array(z*2),I=new Uint8Array(z*4),F=new Float32Array(z*4);T.forEach(function(U,X){if(!!U){var oe=U.positions,se=U.count,q=U.offset,K=U.color,G=U.errors;!se||(I.set(K,q*4),F.set(G,q*4),O.set(oe,q*2))}});var D=a(O);x(D);var B=t(O,D);M(B),v(I),_(F)}}}function h(){x.destroy(),M.destroy(),v.destroy(),_.destroy(),l.destroy()}}},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":313,"update-diff":329}],280:[function(c,ae,ie){"use strict";var b=c("color-normalize"),k=c("array-bounds"),P=c("object-assign"),E=c("glslify"),e=c("pick-by-alias"),p=c("flatten-vertex-data"),g=c("earcut"),a=c("array-normalize"),t=c("to-float32"),i=t.float32,n=t.fract32,r=c("es6-weak-map"),d=c("parse-rect"),s=c("array-find-index");ae.exports=m;function m(x,M){if(!(this instanceof m))return new m(x,M);if(typeof x=="function"?(M||(M={}),M.regl=x):M=x,M.length&&(M.positions=M),x=M.regl,!x.hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=x._gl,this.regl=x,this.passes=[],this.shaders=m.shaders.has(x)?m.shaders.get(x):m.shaders.set(x,m.createShaders(x)).get(x),this.update(M)}m.dashMult=2,m.maxPatternLength=256,m.precisionThreshold=3e6,m.maxPoints=1e4,m.maxLines=2048,m.shaders=new r,m.createShaders=function(x){var M=x.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),v={primitive:"triangle strip",instances:x.prop("count"),count:4,offset:0,uniforms:{miterMode:function(T,w){return w.join==="round"?2:1},miterLimit:x.prop("miterLimit"),scale:x.prop("scale"),scaleFract:x.prop("scaleFract"),translateFract:x.prop("translateFract"),translate:x.prop("translate"),thickness:x.prop("thickness"),dashTexture:x.prop("dashTexture"),opacity:x.prop("opacity"),pixelRatio:x.context("pixelRatio"),id:x.prop("id"),dashLength:x.prop("dashLength"),viewport:function(T,w){return[w.viewport.x,w.viewport.y,T.viewportWidth,T.viewportHeight]},depth:x.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(T,w){return!w.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:x.prop("viewport")},viewport:x.prop("viewport")},_=x(P({vert:E([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:E([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:M,divisor:0,stride:8,offset:0},lineTop:{buffer:M,divisor:0,stride:8,offset:4},aCoord:{buffer:x.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:x.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:x.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:x.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:x.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},v)),l;try{l=x(P({cull:{enable:!0,face:"back"},vert:E([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:E([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:M,divisor:0,stride:8,offset:0},lineTop:{buffer:M,divisor:0,stride:8,offset:4},aColor:{buffer:x.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:x.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:x.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:x.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:x.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:x.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},v))}catch{l=_}var y=x({primitive:"triangle",elements:function(T,w){return w.triangles},offset:0,vert:E([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:E([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:x.prop("scale"),color:x.prop("fill"),scaleFract:x.prop("scaleFract"),translateFract:x.prop("translateFract"),translate:x.prop("translate"),opacity:x.prop("opacity"),pixelRatio:x.context("pixelRatio"),id:x.prop("id"),viewport:function(T,w){return[w.viewport.x,w.viewport.y,T.viewportWidth,T.viewportHeight]}},attributes:{position:{buffer:x.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:x.prop("positionFractBuffer"),stride:8,offset:8}},blend:v.blend,depth:{enable:!1},scissor:v.scissor,stencil:v.stencil,viewport:v.viewport});return{fill:y,rect:_,miter:l}},m.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},m.prototype.render=function(){for(var x,M=[],v=arguments.length;v--;)M[v]=arguments[v];M.length&&(x=this).update.apply(x,M),this.draw()},m.prototype.draw=function(){for(var x=this,M=[],v=arguments.length;v--;)M[v]=arguments[v];return(M.length?M:this.passes).forEach(function(_,l){var y;if(_&&Array.isArray(_))return(y=x).draw.apply(y,_);typeof _=="number"&&(_=x.passes[_]),_&&_.count>1&&_.opacity&&(x.regl._refresh(),_.fill&&_.triangles&&_.triangles.length>2&&x.shaders.fill(_),_.thickness&&(_.scale[0]*_.viewport.width>m.precisionThreshold||_.scale[1]*_.viewport.height>m.precisionThreshold||_.join==="rect"||!_.join&&(_.thickness<=2||_.count>=m.maxPoints)?x.shaders.rect(_):x.shaders.miter(_)))}),this},m.prototype.update=function(x){var M=this;if(!!x){x.length!=null?typeof x[0]=="number"&&(x=[{positions:x}]):Array.isArray(x)||(x=[x]);var v=this,_=v.regl,l=v.gl;if(x.forEach(function(f,u){var h=M.passes[u];if(f!==void 0){if(f===null){M.passes[u]=null;return}if(typeof f[0]=="number"&&(f={positions:f}),f=e(f,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),h||(M.passes[u]=h={id:u,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:_.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:_.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:_.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:_.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},f=P({},m.defaults,f)),f.thickness!=null&&(h.thickness=parseFloat(f.thickness)),f.opacity!=null&&(h.opacity=parseFloat(f.opacity)),f.miterLimit!=null&&(h.miterLimit=parseFloat(f.miterLimit)),f.overlay!=null&&(h.overlay=!!f.overlay,u<m.maxLines&&(h.depth=2*(m.maxLines-1-u%m.maxLines)/m.maxLines-1)),f.join!=null&&(h.join=f.join),f.hole!=null&&(h.hole=f.hole),f.fill!=null&&(h.fill=f.fill?b(f.fill,"uint8"):null),f.viewport!=null&&(h.viewport=d(f.viewport)),h.viewport||(h.viewport=d([l.drawingBufferWidth,l.drawingBufferHeight])),f.close!=null&&(h.close=f.close),f.positions===null&&(f.positions=[]),f.positions){var o,S;if(f.positions.x&&f.positions.y){var R=f.positions.x,z=f.positions.y;S=h.count=Math.max(R.length,z.length),o=new Float64Array(S*2);for(var O=0;O<S;O++)o[O*2]=R[O],o[O*2+1]=z[O]}else o=p(f.positions,"float64"),S=h.count=Math.floor(o.length/2);var I=h.bounds=k(o,2);if(h.fill){for(var F=[],D={},B=0,U=0,X=0,oe=h.count;U<oe;U++){var se=o[U*2],q=o[U*2+1];isNaN(se)||isNaN(q)||se==null||q==null?(se=o[B*2],q=o[B*2+1],D[U]=B):B=U,F[X++]=se,F[X++]=q}if(f.splitNull){h.count-1 in D||(D[h.count]=h.count-1);var K=Object.keys(D).map(Number).sort(function(it,ct){return it-ct}),G=[],Q=0,V=h.hole!=null?h.hole[0]:null;if(V!=null){var H=s(K,function(it){return it>=V});K=K.slice(0,H),K.push(V)}for(var ee=function(it){var ct=F.slice(Q*2,K[it]*2).concat(V?F.slice(V*2):[]),et=(h.hole||[]).map(function(We){return We-V+(K[it]-Q)}),Pe=g(ct,et);Pe=Pe.map(function(We){return We+Q+(We+Q<K[it]?0:V-K[it])}),G.push.apply(G,Pe),Q=K[it]+1},J=0;J<K.length;J++)ee(J);for(var W=0,re=G.length;W<re;W++)D[G[W]]!=null&&(G[W]=D[G[W]]);h.triangles=G}else{for(var j=g(F,h.hole||[]),Z=0,ne=j.length;Z<ne;Z++)D[j[Z]]!=null&&(j[Z]=D[j[Z]]);h.triangles=j}}var le=new Float64Array(o);a(le,2,I);var ge=new Float64Array(S*2+6);h.close?o[0]===o[S*2-2]&&o[1]===o[S*2-1]?(ge[0]=le[S*2-4],ge[1]=le[S*2-3]):(ge[0]=le[S*2-2],ge[1]=le[S*2-1]):(ge[0]=le[0],ge[1]=le[1]),ge.set(le,2),h.close?o[0]===o[S*2-2]&&o[1]===o[S*2-1]?(ge[S*2+2]=le[2],ge[S*2+3]=le[3],h.count-=1):(ge[S*2+2]=le[0],ge[S*2+3]=le[1],ge[S*2+4]=le[2],ge[S*2+5]=le[3]):(ge[S*2+2]=le[S*2-2],ge[S*2+3]=le[S*2-1],ge[S*2+4]=le[S*2-2],ge[S*2+5]=le[S*2-1]);var pe=i(ge);h.positionBuffer(pe);var xe=n(ge,pe);h.positionFractBuffer(xe)}if(f.range?h.range=f.range:h.range||(h.range=h.bounds),(f.range||f.positions)&&h.count){var Ee=h.bounds,Te=Ee[2]-Ee[0],de=Ee[3]-Ee[1],be=h.range[2]-h.range[0],Le=h.range[3]-h.range[1];h.scale=[Te/be,de/Le],h.translate=[-h.range[0]/be+Ee[0]/be||0,-h.range[1]/Le+Ee[1]/Le||0],h.scaleFract=n(h.scale),h.translateFract=n(h.translate)}if(f.dashes){var De=0,ye;if(!f.dashes||f.dashes.length<2)De=1,ye=new Uint8Array([255,255,255,255,255,255,255,255]);else{De=0;for(var ke=0;ke<f.dashes.length;++ke)De+=f.dashes[ke];ye=new Uint8Array(De*m.dashMult);for(var Oe=0,Qe=255,Ve=0;Ve<2;Ve++)for(var Ue=0;Ue<f.dashes.length;++Ue){for(var Ie=0,at=f.dashes[Ue]*m.dashMult*.5;Ie<at;++Ie)ye[Oe++]=Qe;Qe^=255}}h.dashLength=De,h.dashTexture({channels:1,data:ye,width:ye.length,height:1,mag:"linear",min:"linear"},0,0)}if(f.color){var pt=h.count,Rt=f.color;Rt||(Rt="transparent");var Mt=new Uint8Array(pt*4+4);if(!Array.isArray(Rt)||typeof Rt[0]=="number")for(var It=b(Rt,"uint8"),Bt=0;Bt<pt+1;Bt++)Mt.set(It,Bt*4);else{for(var St=0;St<pt;St++){var _t=b(Rt[St],"uint8");Mt.set(_t,St*4)}Mt.set(b(Rt[0],"uint8"),pt*4)}h.colorBuffer({usage:"dynamic",type:"uint8",data:Mt})}}}),x.length<this.passes.length){for(var y=x.length;y<this.passes.length;y++){var T=this.passes[y];!T||(T.colorBuffer.destroy(),T.positionBuffer.destroy(),T.dashTexture.destroy())}this.passes.length=x.length}for(var w=[],A=0;A<this.passes.length;A++)this.passes[A]!==null&&w.push(this.passes[A]);return this.passes=w,this}},m.prototype.destroy=function(){return this.passes.forEach(function(x){x.colorBuffer.destroy(),x.positionBuffer.destroy(),x.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":313}],281:[function(c,ae,ie){"use strict";function b(h,o){return E(h)||p(h,o)||g(h,o)||i()}function k(h){return P(h)||e(h)||g(h)||t()}function P(h){if(Array.isArray(h))return a(h)}function E(h){if(Array.isArray(h))return h}function e(h){if(typeof Symbol<"u"&&h[Symbol.iterator]!=null||h["@@iterator"]!=null)return Array.from(h)}function p(h,o){var S=h==null?null:typeof Symbol<"u"&&h[Symbol.iterator]||h["@@iterator"];if(S!=null){var R=[],z=!0,O=!1,I,F;try{for(S=S.call(h);!(z=(I=S.next()).done)&&(R.push(I.value),!(o&&R.length===o));z=!0);}catch(D){O=!0,F=D}finally{try{!z&&S.return!=null&&S.return()}finally{if(O)throw F}}return R}}function g(h,o){if(!!h){if(typeof h=="string")return a(h,o);var S=Object.prototype.toString.call(h).slice(8,-1);if(S==="Object"&&h.constructor&&(S=h.constructor.name),S==="Map"||S==="Set")return Array.from(h);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return a(h,o)}}function a(h,o){(o==null||o>h.length)&&(o=h.length);for(var S=0,R=new Array(o);S<o;S++)R[S]=h[S];return R}function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var n=c("color-normalize"),r=c("array-bounds"),d=c("color-id"),s=c("@plotly/point-cluster"),m=c("object-assign"),x=c("glslify"),M=c("pick-by-alias"),v=c("update-diff"),_=c("flatten-vertex-data"),l=c("is-iexplorer"),y=c("to-float32"),T=c("parse-rect"),w=A;function A(h,o){var S=this;if(!(this instanceof A))return new A(h,o);typeof h=="function"?(o||(o={}),o.regl=h):(o=h,h=null),o&&o.length&&(o.positions=o),h=o.regl;var R=h._gl,z,O=[],I={},F=[],D=[null],B=[null],U=255,X=100;this.tooManyColors=l,z=h.texture({data:new Uint8Array(U*4),width:U,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),m(this,{regl:h,gl:R,groups:F,markerCache:B,markerTextures:D,palette:O,paletteIds:I,paletteTexture:z,maxColors:U,maxSize:X,canvas:R.canvas}),this.update(o);var oe={uniforms:{constPointSize:!!o.constPointSize,opacity:h.prop("opacity"),paletteSize:function(G,Q){return[S.tooManyColors?0:U,z.height]},pixelRatio:h.context("pixelRatio"),scale:h.prop("scale"),scaleFract:h.prop("scaleFract"),translate:h.prop("translate"),translateFract:h.prop("translateFract"),markerTexture:h.prop("markerTexture"),paletteTexture:z},attributes:{x:function(G,Q){return Q.xAttr||{buffer:Q.positionBuffer,stride:8,offset:0}},y:function(G,Q){return Q.yAttr||{buffer:Q.positionBuffer,stride:8,offset:4}},xFract:function(G,Q){return Q.xAttr?{constant:[0,0]}:{buffer:Q.positionFractBuffer,stride:8,offset:0}},yFract:function(G,Q){return Q.yAttr?{constant:[0,0]}:{buffer:Q.positionFractBuffer,stride:8,offset:4}},size:function(G,Q){return Q.size.length?{buffer:Q.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(Q.size*255/S.maxSize)]}},borderSize:function(G,Q){return Q.borderSize.length?{buffer:Q.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(Q.borderSize*255/S.maxSize)]}},colorId:function(G,Q){return Q.color.length?{buffer:Q.colorBuffer,stride:S.tooManyColors?8:4,offset:0}:{constant:S.tooManyColors?O.slice(Q.color*4,Q.color*4+4):[Q.color]}},borderColorId:function(G,Q){return Q.borderColor.length?{buffer:Q.colorBuffer,stride:S.tooManyColors?8:4,offset:S.tooManyColors?4:2}:{constant:S.tooManyColors?O.slice(Q.borderColor*4,Q.borderColor*4+4):[Q.borderColor]}},isActive:function(G,Q){return Q.activation===!0?{constant:[1]}:Q.activation?Q.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:h.prop("viewport")},viewport:h.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:h.prop("elements"),count:h.prop("count"),offset:h.prop("offset"),primitive:"points"},se=m({},oe);se.frag=x([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),se.vert=x([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=h(se);var q=m({},oe);q.frag=x([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),q.vert=x([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),l&&(q.frag=q.frag.replace("smoothstep","smoothStep"),se.frag=se.frag.replace("smoothstep","smoothStep")),this.drawCircle=h(q)}A.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},A.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},A.prototype.draw=function(){for(var h=this,o=arguments.length,S=new Array(o),R=0;R<o;R++)S[R]=arguments[R];var z=this.groups;if(S.length===1&&Array.isArray(S[0])&&(S[0][0]===null||Array.isArray(S[0][0]))&&(S=S[0]),this.regl._refresh(),S.length)for(var O=0;O<S.length;O++)this.drawItem(O,S[O]);else z.forEach(function(I,F){h.drawItem(F)});return this},A.prototype.drawItem=function(h,o){var S=this.groups,R=S[h];if(typeof o=="number"&&(h=o,R=S[o],o=null),!!(R&&R.count&&R.opacity)){R.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,R,o));for(var z=[],O=1;O<R.activation.length;O++)!R.activation[O]||R.activation[O]!==!0&&!R.activation[O].data.length||z.push.apply(z,k(this.getMarkerDrawOptions(O,R,o)));z.length&&this.drawMarker(z)}},A.prototype.getMarkerDrawOptions=function(h,o,S){var R=o.range,z=o.tree,O=o.viewport,I=o.activation,F=o.selectionBuffer,D=o.count,B=this.regl;if(!z)return S?[m({},o,{markerTexture:this.markerTextures[h],activation:I[h],count:S.length,elements:S,offset:0})]:[m({},o,{markerTexture:this.markerTextures[h],activation:I[h],offset:0})];var U=[],X=z.range(R,{lod:!0,px:[(R[2]-R[0])/O.width,(R[3]-R[1])/O.height]});if(S){for(var oe=I[h],se=oe.data,q=new Uint8Array(D),K=0;K<S.length;K++){var G=S[K];q[G]=se?se[G]:1}F.subdata(q)}for(var Q=X.length;Q--;){var V=b(X[Q],2),H=V[0],ee=V[1];U.push(m({},o,{markerTexture:this.markerTextures[h],activation:S?F:I[h],offset:H,count:ee-H}))}return U},A.prototype.update=function(){for(var h=this,o=arguments.length,S=new Array(o),R=0;R<o;R++)S[R]=arguments[R];if(!!S.length){S.length===1&&Array.isArray(S[0])&&(S=S[0]);var z=this.groups,O=this.gl,I=this.regl,F=this.maxSize,D=this.maxColors,B=this.palette;this.groups=z=S.map(function(U,X){var oe=z[X];if(U===void 0)return oe;U===null?U={positions:null}:typeof U=="function"?U={ondraw:U}:typeof U[0]=="number"&&(U={positions:U}),U=M(U,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"}),U.positions===null&&(U.positions=[]),U.tooManyColors!=null&&(h.tooManyColors=U.tooManyColors),oe||(z[X]=oe={id:X,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:I.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:I.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:I.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:I.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:I.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},U=m({},A.defaults,U)),U.positions&&!("marker"in U)&&(U.marker=oe.marker,delete oe.marker),U.marker&&!("positions"in U)&&(U.positions=oe.positions,delete oe.positions);var se=0,q=0;if(v(oe,U,[{snap:!0,size:function(de,be){return de==null&&(de=A.defaults.size),se+=de&&de.length?1:0,de},borderSize:function(de,be){return de==null&&(de=A.defaults.borderSize),se+=de&&de.length?1:0,de},opacity:parseFloat,color:function(de,be){return de==null&&(de=A.defaults.color),de=h.updateColor(de),q++,de},borderColor:function(de,be){return de==null&&(de=A.defaults.borderColor),de=h.updateColor(de),q++,de},bounds:function(de,be,Le){return"range"in Le||(Le.range=null),de},positions:function(de,be,Le){var De=be.snap,ye=be.positionBuffer,ke=be.positionFractBuffer,Oe=be.selectionBuffer;if(de.x||de.y)return de.x.length?be.xAttr={buffer:I.buffer(de.x),offset:0,stride:4,count:de.x.length}:be.xAttr={buffer:de.x.buffer,offset:de.x.offset*4||0,stride:(de.x.stride||1)*4,count:de.x.count},de.y.length?be.yAttr={buffer:I.buffer(de.y),offset:0,stride:4,count:de.y.length}:be.yAttr={buffer:de.y.buffer,offset:de.y.offset*4||0,stride:(de.y.stride||1)*4,count:de.y.count},be.count=Math.max(be.xAttr.count,be.yAttr.count),de;de=_(de,"float64");var Qe=be.count=Math.floor(de.length/2),Ve=be.bounds=Qe?r(de,2):null;if(!Le.range&&!be.range&&(delete be.range,Le.range=Ve),!Le.marker&&!be.marker&&(delete be.marker,Le.marker=null),De&&(De===!0||Qe>De)?be.tree=s(de,{bounds:Ve}):De&&De.length&&(be.tree=De),be.tree){var Ue={primitive:"points",usage:"static",data:be.tree,type:"uint32"};be.elements?be.elements(Ue):be.elements=I.elements(Ue)}var Ie=y.float32(de);ye({data:Ie,usage:"dynamic"});var at=y.fract32(de,Ie);return ke({data:at,usage:"dynamic"}),Oe({data:new Uint8Array(Qe),type:"uint8",usage:"stream"}),de}},{marker:function(de,be,Le){var De=be.activation;if(De.forEach(function(at){return at&&at.destroy&&at.destroy()}),De.length=0,!de||typeof de[0]=="number"){var ye=h.addMarker(de);De[ye]=!0}else{for(var ke=[],Oe=0,Qe=Math.min(de.length,be.count);Oe<Qe;Oe++){var Ve=h.addMarker(de[Oe]);ke[Ve]||(ke[Ve]=new Uint8Array(be.count)),ke[Ve][Oe]=1}for(var Ue=0;Ue<ke.length;Ue++)if(!!ke[Ue]){var Ie={data:ke[Ue],type:"uint8",usage:"static"};De[Ue]?De[Ue](Ie):De[Ue]=I.buffer(Ie),De[Ue].data=ke[Ue]}}return de},range:function(de,be,Le){var De=be.bounds;if(!!De)return de||(de=De),be.scale=[1/(de[2]-de[0]),1/(de[3]-de[1])],be.translate=[-de[0],-de[1]],be.scaleFract=y.fract(be.scale),be.translateFract=y.fract(be.translate),de},viewport:function(de){var be=T(de||[O.drawingBufferWidth,O.drawingBufferHeight]);return be}}]),se){var K=oe,G=K.count,Q=K.size,V=K.borderSize,H=K.sizeBuffer,ee=new Uint8Array(G*2);if(Q.length||V.length)for(var J=0;J<G;J++)ee[J*2]=Math.round((Q[J]==null?Q:Q[J])*255/F),ee[J*2+1]=Math.round((V[J]==null?V:V[J])*255/F);H({data:ee,usage:"dynamic"})}if(q){var W=oe,re=W.count,j=W.color,Z=W.borderColor,ne=W.colorBuffer,le;if(h.tooManyColors){if(j.length||Z.length){le=new Uint8Array(re*8);for(var ge=0;ge<re;ge++){var pe=j[ge];le[ge*8]=B[pe*4],le[ge*8+1]=B[pe*4+1],le[ge*8+2]=B[pe*4+2],le[ge*8+3]=B[pe*4+3];var xe=Z[ge];le[ge*8+4]=B[xe*4],le[ge*8+5]=B[xe*4+1],le[ge*8+6]=B[xe*4+2],le[ge*8+7]=B[xe*4+3]}}}else if(j.length||Z.length){le=new Uint8Array(re*4+2);for(var Ee=0;Ee<re;Ee++)j[Ee]!=null&&(le[Ee*4]=j[Ee]%D,le[Ee*4+1]=Math.floor(j[Ee]/D)),Z[Ee]!=null&&(le[Ee*4+2]=Z[Ee]%D,le[Ee*4+3]=Math.floor(Z[Ee]/D))}ne({data:le||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return oe})}},A.prototype.addMarker=function(h){var o=this.markerTextures,S=this.regl,R=this.markerCache,z=h==null?0:R.indexOf(h);if(z>=0)return z;var O;if(h instanceof Uint8Array||h instanceof Uint8ClampedArray)O=h;else{O=new Uint8Array(h.length);for(var I=0,F=h.length;I<F;I++)O[I]=h[I]*255}var D=Math.floor(Math.sqrt(O.length));return z=o.length,R.push(h),o.push(S.texture({channels:1,data:O,radius:D,mag:"linear",min:"linear"})),z},A.prototype.updateColor=function(h){var o=this.paletteIds,S=this.palette,R=this.maxColors;Array.isArray(h)||(h=[h]);var z=[];if(typeof h[0]=="number"){var O=[];if(Array.isArray(h))for(var I=0;I<h.length;I+=4)O.push(h.slice(I,I+4));else for(var F=0;F<h.length;F+=4)O.push(h.subarray(F,F+4));h=O}for(var D=0;D<h.length;D++){var B=h[D];B=n(B,"uint8");var U=d(B,!1);if(o[U]==null){var X=S.length;o[U]=Math.floor(X/4),S[X]=B[0],S[X+1]=B[1],S[X+2]=B[2],S[X+3]=B[3]}z[D]=o[U]}return!this.tooManyColors&&S.length>R*4&&(this.tooManyColors=!0),this.updatePalette(S),z.length===1?z[0]:z},A.prototype.updatePalette=function(h){if(!this.tooManyColors){var o=this.maxColors,S=this.paletteTexture,R=Math.ceil(h.length*.25/o);if(R>1){h=h.slice();for(var z=h.length*.25%o;z<R*o;z++)h.push(0,0,0,0)}S.height<R&&S.resize(o,R),S.subimage({width:Math.min(h.length*.25,o),height:R,data:h},0,0)}},A.prototype.destroy=function(){return this.groups.forEach(function(h){h.sizeBuffer.destroy(),h.positionBuffer.destroy(),h.positionFractBuffer.destroy(),h.colorBuffer.destroy(),h.activation.forEach(function(o){return o&&o.destroy&&o.destroy()}),h.selectionBuffer.destroy(),h.elements&&h.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(h){return h&&h.destroy&&h.destroy()}),this};var f=c("object-assign"),u=function(o,S){var R=new w(o,S),z=R.render.bind(R);return f(z,{render:z,update:R.update.bind(R),draw:R.draw.bind(R),destroy:R.destroy.bind(R),regl:R.regl,gl:R.gl,canvas:R.gl.canvas,groups:R.groups,markers:R.markerCache,palette:R.palette}),z};ae.exports=u},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":313,"update-diff":329}],282:[function(c,ae,ie){"use strict";var b=c("regl-scatter2d"),k=c("pick-by-alias"),P=c("array-bounds"),E=c("raf"),e=c("array-range"),p=c("parse-rect"),g=c("flatten-vertex-data");ae.exports=a;function a(r,d){if(!(this instanceof a))return new a(r,d);this.traces=[],this.passes={},this.regl=r,this.scatter=b(r),this.canvas=this.scatter.canvas}a.prototype.render=function(){for(var r=this,d,s=[],m=arguments.length;m--;)s[m]=arguments[m];return s.length&&(d=this).update.apply(d,s),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=E(function(){r.draw(),r.dirty=!0,r.planned=null})):(this.draw(),this.dirty=!0,E(function(){r.dirty=!1})),this)},a.prototype.update=function(){for(var r,d=[],s=arguments.length;s--;)d[s]=arguments[s];if(!!d.length){for(var m=0;m<d.length;m++)this.updateItem(m,d[m]);this.traces=this.traces.filter(Boolean);for(var x=[],M=0,v=0;v<this.traces.length;v++){for(var _=this.traces[v],l=this.traces[v].passes,y=0;y<l.length;y++)x.push(this.passes[l[y]]);_.passOffset=M,M+=_.passes.length}return(r=this.scatter).update.apply(r,x),this}},a.prototype.updateItem=function(r,d){var s=this,m=s.regl;if(d===null)return this.traces[r]=null,this;if(!d)return this;var x=k(d,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),M=this.traces[r]||(this.traces[r]={id:r,buffer:m.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:p([m._gl.drawingBufferWidth,m._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(x.color!=null&&(M.color=x.color),x.size!=null&&(M.size=x.size),x.marker!=null&&(M.marker=x.marker),x.borderColor!=null&&(M.borderColor=x.borderColor),x.borderSize!=null&&(M.borderSize=x.borderSize),x.opacity!=null&&(M.opacity=x.opacity),x.viewport&&(M.viewport=p(x.viewport)),x.diagonal!=null&&(M.diagonal=x.diagonal),x.upper!=null&&(M.upper=x.upper),x.lower!=null&&(M.lower=x.lower),x.data){M.buffer(g(x.data)),M.columns=x.data.length,M.count=x.data[0].length,M.bounds=[];for(var v=0;v<M.columns;v++)M.bounds[v]=P(x.data[v],1)}var _;x.range&&(M.range=x.range,_=M.range&&typeof M.range[0]!="number"),x.domain&&(M.domain=x.domain);var l=!1;x.padding!=null&&(Array.isArray(x.padding)&&x.padding.length===M.columns&&typeof x.padding[x.padding.length-1]=="number"?(M.padding=x.padding.map(n),l=!0):M.padding=n(x.padding));var y=M.columns,T=M.count,w=M.viewport.width,A=M.viewport.height,f=M.viewport.x,u=M.viewport.y,h=w/y,o=A/y;M.passes=[];for(var S=0;S<y;S++)for(var R=0;R<y;R++)if(!(!M.diagonal&&R===S)&&!(!M.upper&&S>R)&&!(!M.lower&&S<R)){var z=t(M.id,S,R),O=this.passes[z]||(this.passes[z]={});if(x.data&&(x.transpose?O.positions={x:{buffer:M.buffer,offset:R,count:T,stride:y},y:{buffer:M.buffer,offset:S,count:T,stride:y}}:O.positions={x:{buffer:M.buffer,offset:R*T,count:T},y:{buffer:M.buffer,offset:S*T,count:T}},O.bounds=i(M.bounds,S,R)),x.domain||x.viewport||x.data){var I=l?i(M.padding,S,R):M.padding;if(M.domain){var F=i(M.domain,S,R),D=F[0],B=F[1],U=F[2],X=F[3];O.viewport=[f+D*w+I[0],u+B*A+I[1],f+U*w-I[2],u+X*A-I[3]]}else O.viewport=[f+R*h+h*I[0],u+S*o+o*I[1],f+(R+1)*h-h*I[2],u+(S+1)*o-o*I[3]]}x.color&&(O.color=M.color),x.size&&(O.size=M.size),x.marker&&(O.marker=M.marker),x.borderSize&&(O.borderSize=M.borderSize),x.borderColor&&(O.borderColor=M.borderColor),x.opacity&&(O.opacity=M.opacity),x.range&&(O.range=_?i(M.range,S,R):M.range||O.bounds),M.passes.push(z)}return this},a.prototype.draw=function(){for(var r,d=[],s=arguments.length;s--;)d[s]=arguments[s];if(!d.length)this.scatter.draw();else{for(var m=[],x=0;x<d.length;x++)if(typeof d[x]=="number"){var M=this.traces[d[x]],v=M.passes,_=M.passOffset;m.push.apply(m,e(_,_+v.length))}else if(d[x].length){var l=d[x],y=this.traces[x],T=y.passes,w=y.passOffset;T=T.map(function(A,f){m[w+f]=l})}(r=this.scatter).draw.apply(r,m)}return this},a.prototype.destroy=function(){return this.traces.forEach(function(r){r.buffer&&r.buffer.destroy&&r.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this};function t(r,d,s){var m=r.id!=null?r.id:r,x=d,M=s,v=m<<16|(x&255)<<8|M&255;return v}function i(r,d,s){var m,x,M,v,_,l,y,T,w=r[d],A=r[s];return w.length>2?(m=w[0],M=w[2],x=w[1],v=w[3]):w.length?(m=x=w[0],M=v=w[1]):(m=w.x,x=w.y,M=w.x+w.width,v=w.y+w.height),A.length>2?(_=A[0],y=A[2],l=A[1],T=A[3]):A.length?(_=l=A[0],y=T=A[1]):(_=A.x,l=A.y,y=A.x+A.width,T=A.y+A.height),[_,x,y,v]}function n(r){if(typeof r=="number")return[r,r,r,r];if(r.length===2)return[r[0],r[1],r[0],r[1]];var d=p(r);return[d.x,d.y,d.x+d.width,d.y+d.height]}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:278,"regl-scatter2d":281}],283:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?ae.exports=k():typeof Vr=="function"&&Vr.amd?Vr(k):b.createREGL=k()})(this,function(){function b(lt,Gt){this.id=ge++,this.type=lt,this.data=Gt}function k(lt){if(lt.length===0)return[];var Gt=lt.charAt(0),Kt=lt.charAt(lt.length-1);if(1<lt.length&&Gt===Kt&&(Gt==='"'||Gt==="'"))return['"'+lt.substr(1,lt.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Gt=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(lt))return k(lt.substr(0,Gt.index)).concat(k(Gt[1])).concat(k(lt.substr(Gt.index+Gt[0].length)));if(Gt=lt.split("."),Gt.length===1)return['"'+lt.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(lt=[],Kt=0;Kt<Gt.length;++Kt)lt=lt.concat(k(Gt[Kt]));return lt}function P(lt){return"["+k(lt).join("][")+"]"}function E(lt,Gt){if(typeof lt=="function")return new b(0,lt);if(typeof lt=="number"||typeof lt=="boolean")return new b(5,lt);if(Array.isArray(lt))return new b(6,lt.map(function(Kt,Nt){return E(Kt,Gt+"["+Nt+"]")}));if(lt instanceof b)return lt}function e(){var lt={"":0},Gt=[""];return{id:function(Kt){var Nt=lt[Kt];return Nt||(Nt=lt[Kt]=Gt.length,Gt.push(Kt),Nt)},str:function(Kt){return Gt[Kt]}}}function p(lt,Gt,Kt){function Nt(){var we=window.innerWidth,Me=window.innerHeight;lt!==document.body&&(Me=gr.getBoundingClientRect(),we=Me.right-Me.left,Me=Me.bottom-Me.top),gr.width=Kt*we,gr.height=Kt*Me}var gr=document.createElement("canvas");le(gr.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),lt.appendChild(gr),lt===document.body&&(gr.style.position="absolute",le(lt.style,{margin:0,padding:0}));var tt;return lt!==document.body&&typeof ResizeObserver=="function"?(tt=new ResizeObserver(function(){setTimeout(Nt)}),tt.observe(lt)):window.addEventListener("resize",Nt,!1),Nt(),{canvas:gr,onDestroy:function(){tt?tt.disconnect():window.removeEventListener("resize",Nt),lt.removeChild(gr)}}}function g(lt,Gt){function Kt(Nt){try{return lt.getContext(Nt,Gt)}catch{return null}}return Kt("webgl")||Kt("experimental-webgl")||Kt("webgl-experimental")}function a(lt){return typeof lt=="string"?lt.split():lt}function t(lt){return typeof lt=="string"?document.querySelector(lt):lt}function i(lt){var Gt=lt||{},Kt,Nt,gr,tt;lt={};var we=[],Me=[],Ne=typeof window>"u"?1:window.devicePixelRatio,Xe=!1,Ke={},rt=function(vt){},Je=function(){};if(typeof Gt=="string"?Kt=document.querySelector(Gt):typeof Gt=="object"&&(typeof Gt.nodeName=="string"&&typeof Gt.appendChild=="function"&&typeof Gt.getBoundingClientRect=="function"?Kt=Gt:typeof Gt.drawArrays=="function"||typeof Gt.drawElements=="function"?(tt=Gt,gr=tt.canvas):("gl"in Gt?tt=Gt.gl:"canvas"in Gt?gr=t(Gt.canvas):"container"in Gt&&(Nt=t(Gt.container)),"attributes"in Gt&&(lt=Gt.attributes),"extensions"in Gt&&(we=a(Gt.extensions)),"optionalExtensions"in Gt&&(Me=a(Gt.optionalExtensions)),"onDone"in Gt&&(rt=Gt.onDone),"profile"in Gt&&(Xe=!!Gt.profile),"pixelRatio"in Gt&&(Ne=+Gt.pixelRatio),"cachedCode"in Gt&&(Ke=Gt.cachedCode))),Kt&&(Kt.nodeName.toLowerCase()==="canvas"?gr=Kt:Nt=Kt),!tt){if(!gr){if(Kt=p(Nt||document.body,rt,Ne),!Kt)return null;gr=Kt.canvas,Je=Kt.onDestroy}lt.premultipliedAlpha===void 0&&(lt.premultipliedAlpha=!0),tt=g(gr,lt)}return tt?{gl:tt,canvas:gr,container:Nt,extensions:we,optionalExtensions:Me,pixelRatio:Ne,profile:Xe,cachedCode:Ke,onDone:rt,onDestroy:Je}:(Je(),rt("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function n(lt,Gt){function Kt(we){we=we.toLowerCase();var Me;try{Me=Nt[we]=lt.getExtension(we)}catch{}return!!Me}for(var Nt={},gr=0;gr<Gt.extensions.length;++gr){var tt=Gt.extensions[gr];if(!Kt(tt))return Gt.onDestroy(),Gt.onDone('"'+tt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Gt.optionalExtensions.forEach(Kt),{extensions:Nt,restore:function(){Object.keys(Nt).forEach(function(we){if(Nt[we]&&!Kt(we))throw Error("(regl): error restoring extension "+we)})}}}function r(lt,Gt){for(var Kt=Array(lt),Nt=0;Nt<lt;++Nt)Kt[Nt]=Gt(Nt);return Kt}function d(lt){var Gt,Kt;return Gt=(65535<lt)<<4,lt>>>=Gt,Kt=(255<lt)<<3,lt>>>=Kt,Gt|=Kt,Kt=(15<lt)<<2,lt>>>=Kt,Gt|=Kt,Kt=(3<lt)<<1,Gt|Kt|lt>>>Kt>>1}function s(){function lt(Nt){e:{for(var gr=16;268435456>=gr;gr*=16)if(Nt<=gr){Nt=gr;break e}Nt=0}return gr=Kt[d(Nt)>>2],0<gr.length?gr.pop():new ArrayBuffer(Nt)}function Gt(Nt){Kt[d(Nt.byteLength)>>2].push(Nt)}var Kt=r(8,function(){return[]});return{alloc:lt,free:Gt,allocType:function(Nt,gr){var tt=null;switch(Nt){case 5120:tt=new Int8Array(lt(gr),0,gr);break;case 5121:tt=new Uint8Array(lt(gr),0,gr);break;case 5122:tt=new Int16Array(lt(2*gr),0,gr);break;case 5123:tt=new Uint16Array(lt(2*gr),0,gr);break;case 5124:tt=new Int32Array(lt(4*gr),0,gr);break;case 5125:tt=new Uint32Array(lt(4*gr),0,gr);break;case 5126:tt=new Float32Array(lt(4*gr),0,gr);break;default:return null}return tt.length!==gr?tt.subarray(0,gr):tt},freeType:function(Nt){Gt(Nt.buffer)}}}function m(lt){return!!lt&&typeof lt=="object"&&Array.isArray(lt.shape)&&Array.isArray(lt.stride)&&typeof lt.offset=="number"&&lt.shape.length===lt.stride.length&&(Array.isArray(lt.data)||be(lt.data))}function x(lt,Gt,Kt,Nt,gr,tt){for(var we=0;we<Gt;++we)for(var Me=lt[we],Ne=0;Ne<Kt;++Ne)for(var Xe=Me[Ne],Ke=0;Ke<Nt;++Ke)gr[tt++]=Xe[Ke]}function M(lt,Gt,Kt,Nt,gr){for(var tt=1,we=Kt+1;we<Gt.length;++we)tt*=Gt[we];var Me=Gt[Kt];if(Gt.length-Kt===4){var Ne=Gt[Kt+1],Xe=Gt[Kt+2];for(Gt=Gt[Kt+3],we=0;we<Me;++we)x(lt[we],Ne,Xe,Gt,Nt,gr),gr+=tt}else for(we=0;we<Me;++we)M(lt[we],Gt,Kt+1,Nt,gr),gr+=tt}function v(lt){return ye[Object.prototype.toString.call(lt)]|0}function _(lt,Gt){for(var Kt=0;Kt<Gt.length;++Kt)lt[Kt]=Gt[Kt]}function l(lt,Gt,Kt,Nt,gr,tt,we){for(var Me=0,Ne=0;Ne<Kt;++Ne)for(var Xe=0;Xe<Nt;++Xe)lt[Me++]=Gt[gr*Ne+tt*Xe+we]}function y(lt,Gt,Kt,Nt){function gr(rt){this.id=Ne++,this.buffer=lt.createBuffer(),this.type=rt,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Kt.profile&&(this.stats={size:0})}function tt(rt,Je,vt){rt.byteLength=Je.byteLength,lt.bufferData(rt.type,Je,vt)}function we(rt,Je,vt,bt,Et,Wt){if(rt.usage=vt,Array.isArray(Je)){if(rt.dtype=bt||5126,0<Je.length)if(Array.isArray(Je[0])){Et=Ve(Je);for(var Ot=bt=1;Ot<Et.length;++Ot)bt*=Et[Ot];rt.dimension=bt,Je=Qe(Je,Et,rt.dtype),tt(rt,Je,vt),Wt?rt.persistentData=Je:Te.freeType(Je)}else typeof Je[0]=="number"?(rt.dimension=Et,Et=Te.allocType(rt.dtype,Je.length),_(Et,Je),tt(rt,Et,vt),Wt?rt.persistentData=Et:Te.freeType(Et)):be(Je[0])&&(rt.dimension=Je[0].length,rt.dtype=bt||v(Je[0])||5126,Je=Qe(Je,[Je.length,Je[0].length],rt.dtype),tt(rt,Je,vt),Wt?rt.persistentData=Je:Te.freeType(Je))}else if(be(Je))rt.dtype=bt||v(Je),rt.dimension=Et,tt(rt,Je,vt),Wt&&(rt.persistentData=new Uint8Array(new Uint8Array(Je.buffer)));else if(m(Je)){Et=Je.shape;var ir=Je.stride,Ot=Je.offset,vr=0,_r=0,ln=0,Cr=0;Et.length===1?(vr=Et[0],_r=1,ln=ir[0],Cr=0):Et.length===2&&(vr=Et[0],_r=Et[1],ln=ir[0],Cr=ir[1]),rt.dtype=bt||v(Je.data)||5126,rt.dimension=_r,Et=Te.allocType(rt.dtype,vr*_r),l(Et,Je.data,vr,_r,ln,Cr,Ot),tt(rt,Et,vt),Wt?rt.persistentData=Et:Te.freeType(Et)}else Je instanceof ArrayBuffer&&(rt.dtype=5121,rt.dimension=Et,tt(rt,Je,vt),Wt&&(rt.persistentData=new Uint8Array(new Uint8Array(Je))))}function Me(rt){Gt.bufferCount--,Nt(rt),lt.deleteBuffer(rt.buffer),rt.buffer=null,delete Xe[rt.id]}var Ne=0,Xe={};gr.prototype.bind=function(){lt.bindBuffer(this.type,this.buffer)},gr.prototype.destroy=function(){Me(this)};var Ke=[];return Kt.profile&&(Gt.getTotalBufferSize=function(){var rt=0;return Object.keys(Xe).forEach(function(Je){rt+=Xe[Je].stats.size}),rt}),{create:function(rt,Je,vt,bt){function Et(Ot){var ir=35044,vr=null,_r=0,ln=0,Cr=1;return Array.isArray(Ot)||be(Ot)||m(Ot)||Ot instanceof ArrayBuffer?vr=Ot:typeof Ot=="number"?_r=Ot|0:Ot&&("data"in Ot&&(vr=Ot.data),"usage"in Ot&&(ir=Oe[Ot.usage]),"type"in Ot&&(ln=ke[Ot.type]),"dimension"in Ot&&(Cr=Ot.dimension|0),"length"in Ot&&(_r=Ot.length|0)),Wt.bind(),vr?we(Wt,vr,ir,ln,Cr,bt):(_r&&lt.bufferData(Wt.type,_r,ir),Wt.dtype=ln||5121,Wt.usage=ir,Wt.dimension=Cr,Wt.byteLength=_r),Kt.profile&&(Wt.stats.size=Wt.byteLength*Ue[Wt.dtype]),Et}Gt.bufferCount++;var Wt=new gr(Je);return Xe[Wt.id]=Wt,vt||Et(rt),Et._reglType="buffer",Et._buffer=Wt,Et.subdata=function(Ot,ir){var vr=(ir||0)|0,_r;if(Wt.bind(),be(Ot)||Ot instanceof ArrayBuffer)lt.bufferSubData(Wt.type,vr,Ot);else if(Array.isArray(Ot)){if(0<Ot.length)if(typeof Ot[0]=="number"){var ln=Te.allocType(Wt.dtype,Ot.length);_(ln,Ot),lt.bufferSubData(Wt.type,vr,ln),Te.freeType(ln)}else(Array.isArray(Ot[0])||be(Ot[0]))&&(_r=Ve(Ot),ln=Qe(Ot,_r,Wt.dtype),lt.bufferSubData(Wt.type,vr,ln),Te.freeType(ln))}else if(m(Ot)){_r=Ot.shape;var Cr=Ot.stride,Gr=ln=0,sn=0,yr=0;_r.length===1?(ln=_r[0],Gr=1,sn=Cr[0],yr=0):_r.length===2&&(ln=_r[0],Gr=_r[1],sn=Cr[0],yr=Cr[1]),_r=Array.isArray(Ot.data)?Wt.dtype:v(Ot.data),_r=Te.allocType(_r,ln*Gr),l(_r,Ot.data,ln,Gr,sn,yr,Ot.offset),lt.bufferSubData(Wt.type,vr,_r),Te.freeType(_r)}return Et},Kt.profile&&(Et.stats=Wt.stats),Et.destroy=function(){Me(Wt)},Et},createStream:function(rt,Je){var vt=Ke.pop();return vt||(vt=new gr(rt)),vt.bind(),we(vt,Je,35040,0,1,!1),vt},destroyStream:function(rt){Ke.push(rt)},clear:function(){Le(Xe).forEach(Me),Ke.forEach(Me)},getBuffer:function(rt){return rt&&rt._buffer instanceof gr?rt._buffer:null},restore:function(){Le(Xe).forEach(function(rt){rt.buffer=lt.createBuffer(),lt.bindBuffer(rt.type,rt.buffer),lt.bufferData(rt.type,rt.persistentData||rt.byteLength,rt.usage)})},_initBuffer:we}}function T(lt,Gt,Kt,Nt){function gr(rt){this.id=Ne++,Me[this.id]=this,this.buffer=rt,this.primType=4,this.type=this.vertCount=0}function tt(rt,Je,vt,bt,Et,Wt,Ot){rt.buffer.bind();var ir;if(Je?((ir=Ot)||be(Je)&&(!m(Je)||be(Je.data))||(ir=Gt.oes_element_index_uint?5125:5123),Kt._initBuffer(rt.buffer,Je,vt,ir,3)):(lt.bufferData(34963,Wt,vt),rt.buffer.dtype=ir||5121,rt.buffer.usage=vt,rt.buffer.dimension=3,rt.buffer.byteLength=Wt),ir=Ot,!Ot){switch(rt.buffer.dtype){case 5121:case 5120:ir=5121;break;case 5123:case 5122:ir=5123;break;case 5125:case 5124:ir=5125}rt.buffer.dtype=ir}rt.type=ir,Je=Et,0>Je&&(Je=rt.buffer.byteLength,ir===5123?Je>>=1:ir===5125&&(Je>>=2)),rt.vertCount=Je,Je=bt,0>bt&&(Je=4,bt=rt.buffer.dimension,bt===1&&(Je=0),bt===2&&(Je=1),bt===3&&(Je=4)),rt.primType=Je}function we(rt){Nt.elementsCount--,delete Me[rt.id],rt.buffer.destroy(),rt.buffer=null}var Me={},Ne=0,Xe={uint8:5121,uint16:5123};Gt.oes_element_index_uint&&(Xe.uint32=5125),gr.prototype.bind=function(){this.buffer.bind()};var Ke=[];return{create:function(rt,Je){function vt(Wt){if(Wt)if(typeof Wt=="number")bt(Wt),Et.primType=4,Et.vertCount=Wt|0,Et.type=5121;else{var Ot=null,ir=35044,vr=-1,_r=-1,ln=0,Cr=0;Array.isArray(Wt)||be(Wt)||m(Wt)?Ot=Wt:("data"in Wt&&(Ot=Wt.data),"usage"in Wt&&(ir=Oe[Wt.usage]),"primitive"in Wt&&(vr=Ie[Wt.primitive]),"count"in Wt&&(_r=Wt.count|0),"type"in Wt&&(Cr=Xe[Wt.type]),"length"in Wt?ln=Wt.length|0:(ln=_r,Cr===5123||Cr===5122?ln*=2:(Cr===5125||Cr===5124)&&(ln*=4))),tt(Et,Ot,ir,vr,_r,ln,Cr)}else bt(),Et.primType=4,Et.vertCount=0,Et.type=5121;return vt}var bt=Kt.create(null,34963,!0),Et=new gr(bt._buffer);return Nt.elementsCount++,vt(rt),vt._reglType="elements",vt._elements=Et,vt.subdata=function(Wt,Ot){return bt.subdata(Wt,Ot),vt},vt.destroy=function(){we(Et)},vt},createStream:function(rt){var Je=Ke.pop();return Je||(Je=new gr(Kt.create(null,34963,!0,!1)._buffer)),tt(Je,rt,35040,-1,-1,0,0),Je},destroyStream:function(rt){Ke.push(rt)},getElements:function(rt){return typeof rt=="function"&&rt._elements instanceof gr?rt._elements:null},clear:function(){Le(Me).forEach(we)}}}function w(lt){for(var Gt=Te.allocType(5123,lt.length),Kt=0;Kt<lt.length;++Kt)if(isNaN(lt[Kt]))Gt[Kt]=65535;else if(lt[Kt]===1/0)Gt[Kt]=31744;else if(lt[Kt]===-1/0)Gt[Kt]=64512;else{at[0]=lt[Kt];var tt=pt[0],Nt=tt>>>31<<15,gr=(tt<<1>>>24)-127,tt=tt>>13&1023;Gt[Kt]=-24>gr?Nt:-14>gr?Nt+(tt+1024>>-14-gr):15<gr?Nt+31744:Nt+(gr+15<<10)+tt}return Gt}function A(lt){return Array.isArray(lt)||be(lt)}function f(lt){return"[object "+lt+"]"}function u(lt){return Array.isArray(lt)&&(lt.length===0||typeof lt[0]=="number")}function h(lt){return!!(Array.isArray(lt)&&lt.length!==0&&A(lt[0]))}function o(lt){return Object.prototype.toString.call(lt)}function S(lt){if(!lt)return!1;var Gt=o(lt);return 0<=Pe.indexOf(Gt)?!0:u(lt)||h(lt)||m(lt)}function R(lt,Gt){lt.type===36193?(lt.data=w(Gt),Te.freeType(Gt)):lt.data=Gt}function z(lt,Gt,Kt,Nt,gr,tt){if(lt=typeof je[lt]<"u"?je[lt]:It[lt]*We[Gt],tt&&(lt*=6),gr){for(Nt=0;1<=Kt;)Nt+=lt*Kt*Kt,Kt/=2;return Nt}return lt*Kt*Nt}function O(lt,Gt,Kt,Nt,gr,tt,we){function Me(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function Ne(wr,gn){wr.internalformat=gn.internalformat,wr.format=gn.format,wr.type=gn.type,wr.compressed=gn.compressed,wr.premultiplyAlpha=gn.premultiplyAlpha,wr.flipY=gn.flipY,wr.unpackAlignment=gn.unpackAlignment,wr.colorSpace=gn.colorSpace,wr.width=gn.width,wr.height=gn.height,wr.channels=gn.channels}function Xe(wr,gn){if(typeof gn=="object"&&gn){"premultiplyAlpha"in gn&&(wr.premultiplyAlpha=gn.premultiplyAlpha),"flipY"in gn&&(wr.flipY=gn.flipY),"alignment"in gn&&(wr.unpackAlignment=gn.alignment),"colorSpace"in gn&&(wr.colorSpace=tr[gn.colorSpace]),"type"in gn&&(wr.type=Lr[gn.type]);var hn=wr.width,Tn=wr.height,Vn=wr.channels,oa=!1;"shape"in gn?(hn=gn.shape[0],Tn=gn.shape[1],gn.shape.length===3&&(Vn=gn.shape[2],oa=!0)):("radius"in gn&&(hn=Tn=gn.radius),"width"in gn&&(hn=gn.width),"height"in gn&&(Tn=gn.height),"channels"in gn&&(Vn=gn.channels,oa=!0)),wr.width=hn|0,wr.height=Tn|0,wr.channels=Vn|0,hn=!1,"format"in gn&&(hn=gn.format,Tn=wr.internalformat=Nr[hn],wr.format=ea[Tn],hn in Lr&&!("type"in gn)&&(wr.type=Lr[hn]),hn in Rr&&(wr.compressed=!0),hn=!0),!oa&&hn?wr.channels=It[wr.format]:oa&&!hn&&wr.channels!==Mt[wr.format]&&(wr.format=wr.internalformat=Mt[wr.channels])}}function Ke(wr){lt.pixelStorei(37440,wr.flipY),lt.pixelStorei(37441,wr.premultiplyAlpha),lt.pixelStorei(37443,wr.colorSpace),lt.pixelStorei(3317,wr.unpackAlignment)}function rt(){Me.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Je(wr,gn){var hn=null;if(S(gn)?hn=gn:gn&&(Xe(wr,gn),"x"in gn&&(wr.xOffset=gn.x|0),"y"in gn&&(wr.yOffset=gn.y|0),S(gn.data)&&(hn=gn.data)),gn.copy){var Tn=gr.viewportWidth,Vn=gr.viewportHeight;wr.width=wr.width||Tn-wr.xOffset,wr.height=wr.height||Vn-wr.yOffset,wr.needsCopy=!0}else if(!hn)wr.width=wr.width||1,wr.height=wr.height||1,wr.channels=wr.channels||4;else if(be(hn))wr.channels=wr.channels||4,wr.data=hn,"type"in gn||wr.type!==5121||(wr.type=ye[Object.prototype.toString.call(hn)]|0);else if(u(hn)){switch(wr.channels=wr.channels||4,Tn=hn,Vn=Tn.length,wr.type){case 5121:case 5123:case 5125:case 5126:Vn=Te.allocType(wr.type,Vn),Vn.set(Tn),wr.data=Vn;break;case 36193:wr.data=w(Tn)}wr.alignment=1,wr.needsFree=!0}else if(m(hn)){Tn=hn.data,Array.isArray(Tn)||wr.type!==5121||(wr.type=ye[Object.prototype.toString.call(Tn)]|0);var Vn=hn.shape,oa=hn.stride,na,On,ta,Ua;Vn.length===3?(ta=Vn[2],Ua=oa[2]):Ua=ta=1,na=Vn[0],On=Vn[1],Vn=oa[0],oa=oa[1],wr.alignment=1,wr.width=na,wr.height=On,wr.channels=ta,wr.format=wr.internalformat=Mt[ta],wr.needsFree=!0,na=Ua,hn=hn.offset,ta=wr.width,Ua=wr.height,On=wr.channels;for(var di=Te.allocType(wr.type===36193?5126:wr.type,ta*Ua*On),Ft=0,cr=0;cr<Ua;++cr)for(var nn=0;nn<ta;++nn)for(var vn=0;vn<On;++vn)di[Ft++]=Tn[Vn*nn+oa*cr+na*vn+hn];R(wr,di)}else if(o(hn)===Bt||o(hn)===St||o(hn)===_t)o(hn)===Bt||o(hn)===St?wr.element=hn:wr.element=hn.canvas,wr.width=wr.element.width,wr.height=wr.element.height,wr.channels=4;else if(o(hn)===it)wr.element=hn,wr.width=hn.width,wr.height=hn.height,wr.channels=4;else if(o(hn)===ct)wr.element=hn,wr.width=hn.naturalWidth,wr.height=hn.naturalHeight,wr.channels=4;else if(o(hn)===et)wr.element=hn,wr.width=hn.videoWidth,wr.height=hn.videoHeight,wr.channels=4;else if(h(hn)){for(Tn=wr.width||hn[0].length,Vn=wr.height||hn.length,oa=wr.channels,oa=A(hn[0][0])?oa||hn[0][0].length:oa||1,na=De.shape(hn),ta=1,Ua=0;Ua<na.length;++Ua)ta*=na[Ua];ta=Te.allocType(wr.type===36193?5126:wr.type,ta),De.flatten(hn,na,"",ta),R(wr,ta),wr.alignment=1,wr.width=Tn,wr.height=Vn,wr.channels=oa,wr.format=wr.internalformat=Mt[oa],wr.needsFree=!0}}function vt(wr,gn,hn,Tn,Vn){var oa=wr.element,na=wr.data,On=wr.internalformat,ta=wr.format,Ua=wr.type,di=wr.width,Ft=wr.height;Ke(wr),oa?lt.texSubImage2D(gn,Vn,hn,Tn,ta,Ua,oa):wr.compressed?lt.compressedTexSubImage2D(gn,Vn,hn,Tn,On,di,Ft,na):wr.needsCopy?(Nt(),lt.copyTexSubImage2D(gn,Vn,hn,Tn,wr.xOffset,wr.yOffset,di,Ft)):lt.texSubImage2D(gn,Vn,hn,Tn,di,Ft,ta,Ua,na)}function bt(){return ka.pop()||new rt}function Et(wr){wr.needsFree&&Te.freeType(wr.data),rt.call(wr),ka.push(wr)}function Wt(){Me.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function Ot(wr,gn,hn){var Tn=wr.images[0]=bt();wr.mipmask=1,Tn.width=wr.width=gn,Tn.height=wr.height=hn,Tn.channels=wr.channels=4}function ir(wr,gn){var hn=null;if(S(gn))hn=wr.images[0]=bt(),Ne(hn,wr),Je(hn,gn),wr.mipmask=1;else if(Xe(wr,gn),Array.isArray(gn.mipmap))for(var Tn=gn.mipmap,Vn=0;Vn<Tn.length;++Vn)hn=wr.images[Vn]=bt(),Ne(hn,wr),hn.width>>=Vn,hn.height>>=Vn,Je(hn,Tn[Vn]),wr.mipmask|=1<<Vn;else hn=wr.images[0]=bt(),Ne(hn,wr),Je(hn,gn),wr.mipmask=1;Ne(wr,wr.images[0])}function vr(wr,gn){for(var hn=wr.images,Tn=0;Tn<hn.length&&hn[Tn];++Tn){var Vn=hn[Tn],oa=gn,na=Tn,On=Vn.element,ta=Vn.data,Ua=Vn.internalformat,di=Vn.format,Ft=Vn.type,cr=Vn.width,nn=Vn.height;Ke(Vn),On?lt.texImage2D(oa,na,di,di,Ft,On):Vn.compressed?lt.compressedTexImage2D(oa,na,Ua,cr,nn,0,ta):Vn.needsCopy?(Nt(),lt.copyTexImage2D(oa,na,di,Vn.xOffset,Vn.yOffset,cr,nn,0)):lt.texImage2D(oa,na,di,cr,nn,0,di,Ft,ta||null)}}function _r(){var wr=Ya.pop()||new Wt;Me.call(wr);for(var gn=wr.mipmask=0;16>gn;++gn)wr.images[gn]=null;return wr}function ln(wr){for(var gn=wr.images,hn=0;hn<gn.length;++hn)gn[hn]&&Et(gn[hn]),gn[hn]=null;Ya.push(wr)}function Cr(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function Gr(wr,gn){"min"in gn&&(wr.minFilter=Xt[gn.min],0<=Rt.indexOf(wr.minFilter)&&!("faces"in gn)&&(wr.genMipmaps=!0)),"mag"in gn&&(wr.magFilter=Lt[gn.mag]);var hn=wr.wrapS,Tn=wr.wrapT;if("wrap"in gn){var Vn=gn.wrap;typeof Vn=="string"?hn=Tn=ot[Vn]:Array.isArray(Vn)&&(hn=ot[Vn[0]],Tn=ot[Vn[1]])}else"wrapS"in gn&&(hn=ot[gn.wrapS]),"wrapT"in gn&&(Tn=ot[gn.wrapT]);if(wr.wrapS=hn,wr.wrapT=Tn,"anisotropic"in gn&&(wr.anisotropic=gn.anisotropic),"mipmap"in gn){switch(hn=!1,typeof gn.mipmap){case"string":wr.mipmapHint=Sr[gn.mipmap],hn=wr.genMipmaps=!0;break;case"boolean":hn=wr.genMipmaps=gn.mipmap;break;case"object":wr.genMipmaps=!1,hn=!0}!hn||"min"in gn||(wr.minFilter=9984)}}function sn(wr,gn){lt.texParameteri(gn,10241,wr.minFilter),lt.texParameteri(gn,10240,wr.magFilter),lt.texParameteri(gn,10242,wr.wrapS),lt.texParameteri(gn,10243,wr.wrapT),Gt.ext_texture_filter_anisotropic&&lt.texParameteri(gn,34046,wr.anisotropic),wr.genMipmaps&&(lt.hint(33170,wr.mipmapHint),lt.generateMipmap(gn))}function yr(wr){Me.call(this),this.mipmask=0,this.internalformat=6408,this.id=fi++,this.refCount=1,this.target=wr,this.texture=lt.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Cr,we.profile&&(this.stats={size:0})}function mr(wr){lt.activeTexture(33984),lt.bindTexture(wr.target,wr.texture)}function Or(){var wr=Ka[0];wr?lt.bindTexture(wr.target,wr.texture):lt.bindTexture(3553,null)}function zr(wr){var gn=wr.texture,hn=wr.unit,Tn=wr.target;0<=hn&&(lt.activeTexture(33984+hn),lt.bindTexture(Tn,null),Ka[hn]=null),lt.deleteTexture(gn),wr.texture=null,wr.params=null,wr.pixels=null,wr.refCount=0,delete pi[wr.id],tt.textureCount--}var Sr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},ot={repeat:10497,clamp:33071,mirror:33648},Lt={nearest:9728,linear:9729},Xt=le({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Lt),tr={none:0,browser:37444},Lr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Nr={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},Rr={};Gt.ext_srgb&&(Nr.srgb=35904,Nr.srgba=35906),Gt.oes_texture_float&&(Lr.float32=Lr.float=5126),Gt.oes_texture_half_float&&(Lr.float16=Lr["half float"]=36193),Gt.webgl_depth_texture&&(le(Nr,{depth:6402,"depth stencil":34041}),le(Lr,{uint16:5123,uint32:5125,"depth stencil":34042})),Gt.webgl_compressed_texture_s3tc&&le(Rr,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),Gt.webgl_compressed_texture_atc&&le(Rr,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),Gt.webgl_compressed_texture_pvrtc&&le(Rr,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),Gt.webgl_compressed_texture_etc1&&(Rr["rgb etc1"]=36196);var Ar=Array.prototype.slice.call(lt.getParameter(34467));Object.keys(Rr).forEach(function(wr){var gn=Rr[wr];0<=Ar.indexOf(gn)&&(Nr[wr]=gn)});var Kr=Object.keys(Nr);Kt.textureFormats=Kr;var Dn=[];Object.keys(Nr).forEach(function(wr){Dn[Nr[wr]]=wr});var Sn=[];Object.keys(Lr).forEach(function(wr){Sn[Lr[wr]]=wr});var Jn=[];Object.keys(Lt).forEach(function(wr){Jn[Lt[wr]]=wr});var Bn=[];Object.keys(Xt).forEach(function(wr){Bn[Xt[wr]]=wr});var Xn=[];Object.keys(ot).forEach(function(wr){Xn[ot[wr]]=wr});var ea=Kr.reduce(function(wr,gn){var hn=Nr[gn];return hn===6409||hn===6406||hn===6409||hn===6410||hn===6402||hn===34041||Gt.ext_srgb&&(hn===35904||hn===35906)?wr[hn]=hn:hn===32855||0<=gn.indexOf("rgba")?wr[hn]=6408:wr[hn]=6407,wr},{}),ka=[],Ya=[],fi=0,pi={},hi=Kt.maxTextureUnits,Ka=Array(hi).map(function(){return null});return le(yr.prototype,{bind:function(){this.bindCount+=1;var wr=this.unit;if(0>wr){for(var gn=0;gn<hi;++gn){var hn=Ka[gn];if(hn){if(0<hn.bindCount)continue;hn.unit=-1}Ka[gn]=this,wr=gn;break}we.profile&&tt.maxTextureUnits<wr+1&&(tt.maxTextureUnits=wr+1),this.unit=wr,lt.activeTexture(33984+wr),lt.bindTexture(this.target,this.texture)}return wr},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&zr(this)}}),we.profile&&(tt.getTotalTextureSize=function(){var wr=0;return Object.keys(pi).forEach(function(gn){wr+=pi[gn].stats.size}),wr}),{create2D:function(wr,gn){function hn(Vn,oa){var na=Tn.texInfo;Cr.call(na);var On=_r();return typeof Vn=="number"?typeof oa=="number"?Ot(On,Vn|0,oa|0):Ot(On,Vn|0,Vn|0):Vn?(Gr(na,Vn),ir(On,Vn)):Ot(On,1,1),na.genMipmaps&&(On.mipmask=(On.width<<1)-1),Tn.mipmask=On.mipmask,Ne(Tn,On),Tn.internalformat=On.internalformat,hn.width=On.width,hn.height=On.height,mr(Tn),vr(On,3553),sn(na,3553),Or(),ln(On),we.profile&&(Tn.stats.size=z(Tn.internalformat,Tn.type,On.width,On.height,na.genMipmaps,!1)),hn.format=Dn[Tn.internalformat],hn.type=Sn[Tn.type],hn.mag=Jn[na.magFilter],hn.min=Bn[na.minFilter],hn.wrapS=Xn[na.wrapS],hn.wrapT=Xn[na.wrapT],hn}var Tn=new yr(3553);return pi[Tn.id]=Tn,tt.textureCount++,hn(wr,gn),hn.subimage=function(Vn,oa,na,On){oa|=0,na|=0,On|=0;var ta=bt();return Ne(ta,Tn),ta.width=0,ta.height=0,Je(ta,Vn),ta.width=ta.width||(Tn.width>>On)-oa,ta.height=ta.height||(Tn.height>>On)-na,mr(Tn),vt(ta,3553,oa,na,On),Or(),Et(ta),hn},hn.resize=function(Vn,oa){var na=Vn|0,On=oa|0||na;if(na===Tn.width&&On===Tn.height)return hn;hn.width=Tn.width=na,hn.height=Tn.height=On,mr(Tn);for(var ta=0;Tn.mipmask>>ta;++ta){var Ua=na>>ta,di=On>>ta;if(!Ua||!di)break;lt.texImage2D(3553,ta,Tn.format,Ua,di,0,Tn.format,Tn.type,null)}return Or(),we.profile&&(Tn.stats.size=z(Tn.internalformat,Tn.type,na,On,!1,!1)),hn},hn._reglType="texture2d",hn._texture=Tn,we.profile&&(hn.stats=Tn.stats),hn.destroy=function(){Tn.decRef()},hn},createCube:function(wr,gn,hn,Tn,Vn,oa){function na(Ua,di,Ft,cr,nn,vn){var on,Cn=On.texInfo;for(Cr.call(Cn),on=0;6>on;++on)ta[on]=_r();if(typeof Ua=="number"||!Ua)for(Ua=Ua|0||1,on=0;6>on;++on)Ot(ta[on],Ua,Ua);else if(typeof Ua=="object")if(di)ir(ta[0],Ua),ir(ta[1],di),ir(ta[2],Ft),ir(ta[3],cr),ir(ta[4],nn),ir(ta[5],vn);else if(Gr(Cn,Ua),Xe(On,Ua),"faces"in Ua)for(Ua=Ua.faces,on=0;6>on;++on)Ne(ta[on],On),ir(ta[on],Ua[on]);else for(on=0;6>on;++on)ir(ta[on],Ua);for(Ne(On,ta[0]),On.mipmask=Cn.genMipmaps?(ta[0].width<<1)-1:ta[0].mipmask,On.internalformat=ta[0].internalformat,na.width=ta[0].width,na.height=ta[0].height,mr(On),on=0;6>on;++on)vr(ta[on],34069+on);for(sn(Cn,34067),Or(),we.profile&&(On.stats.size=z(On.internalformat,On.type,na.width,na.height,Cn.genMipmaps,!0)),na.format=Dn[On.internalformat],na.type=Sn[On.type],na.mag=Jn[Cn.magFilter],na.min=Bn[Cn.minFilter],na.wrapS=Xn[Cn.wrapS],na.wrapT=Xn[Cn.wrapT],on=0;6>on;++on)ln(ta[on]);return na}var On=new yr(34067);pi[On.id]=On,tt.cubeCount++;var ta=Array(6);return na(wr,gn,hn,Tn,Vn,oa),na.subimage=function(Ua,di,Ft,cr,nn){Ft|=0,cr|=0,nn|=0;var vn=bt();return Ne(vn,On),vn.width=0,vn.height=0,Je(vn,di),vn.width=vn.width||(On.width>>nn)-Ft,vn.height=vn.height||(On.height>>nn)-cr,mr(On),vt(vn,34069+Ua,Ft,cr,nn),Or(),Et(vn),na},na.resize=function(Ua){if(Ua|=0,Ua!==On.width){na.width=On.width=Ua,na.height=On.height=Ua,mr(On);for(var di=0;6>di;++di)for(var Ft=0;On.mipmask>>Ft;++Ft)lt.texImage2D(34069+di,Ft,On.format,Ua>>Ft,Ua>>Ft,0,On.format,On.type,null);return Or(),we.profile&&(On.stats.size=z(On.internalformat,On.type,na.width,na.height,!1,!0)),na}},na._reglType="textureCube",na._texture=On,we.profile&&(na.stats=On.stats),na.destroy=function(){On.decRef()},na},clear:function(){for(var wr=0;wr<hi;++wr)lt.activeTexture(33984+wr),lt.bindTexture(3553,null),Ka[wr]=null;Le(pi).forEach(zr),tt.cubeCount=0,tt.textureCount=0},getTexture:function(wr){return null},restore:function(){for(var wr=0;wr<hi;++wr){var gn=Ka[wr];gn&&(gn.bindCount=0,gn.unit=-1,Ka[wr]=null)}Le(pi).forEach(function(hn){hn.texture=lt.createTexture(),lt.bindTexture(hn.target,hn.texture);for(var Tn=0;32>Tn;++Tn)if((hn.mipmask&1<<Tn)!==0)if(hn.target===3553)lt.texImage2D(3553,Tn,hn.internalformat,hn.width>>Tn,hn.height>>Tn,0,hn.internalformat,hn.type,null);else for(var Vn=0;6>Vn;++Vn)lt.texImage2D(34069+Vn,Tn,hn.internalformat,hn.width>>Tn,hn.height>>Tn,0,hn.internalformat,hn.type,null);sn(hn.texInfo,hn.target)})},refresh:function(){for(var wr=0;wr<hi;++wr){var gn=Ka[wr];gn&&(gn.bindCount=0,gn.unit=-1,Ka[wr]=null),lt.activeTexture(33984+wr),lt.bindTexture(3553,null),lt.bindTexture(34067,null)}}}}function I(lt,Gt,Kt,Nt,gr,tt){function we(yr,mr,Or){this.target=yr,this.texture=mr,this.renderbuffer=Or;var zr=yr=0;mr?(yr=mr.width,zr=mr.height):Or&&(yr=Or.width,zr=Or.height),this.width=yr,this.height=zr}function Me(yr){yr&&(yr.texture&&yr.texture._texture.decRef(),yr.renderbuffer&&yr.renderbuffer._renderbuffer.decRef())}function Ne(yr,mr,Or){yr&&(yr.texture?yr.texture._texture.refCount+=1:yr.renderbuffer._renderbuffer.refCount+=1)}function Xe(yr,mr){mr&&(mr.texture?lt.framebufferTexture2D(36160,yr,mr.target,mr.texture._texture.texture,0):lt.framebufferRenderbuffer(36160,yr,36161,mr.renderbuffer._renderbuffer.renderbuffer))}function Ke(yr){var mr=3553,Or=null,zr=null,Sr=yr;return typeof yr=="object"&&(Sr=yr.data,"target"in yr&&(mr=yr.target|0)),yr=Sr._reglType,yr==="texture2d"||yr==="textureCube"?Or=Sr:yr==="renderbuffer"&&(zr=Sr,mr=36161),new we(mr,Or,zr)}function rt(yr,mr,Or,zr,Sr){return Or?(yr=Nt.create2D({width:yr,height:mr,format:zr,type:Sr}),yr._texture.refCount=0,new we(3553,yr,null)):(yr=gr.create({width:yr,height:mr,format:zr}),yr._renderbuffer.refCount=0,new we(36161,null,yr))}function Je(yr){return yr&&(yr.texture||yr.renderbuffer)}function vt(yr,mr,Or){yr&&(yr.texture?yr.texture.resize(mr,Or):yr.renderbuffer&&yr.renderbuffer.resize(mr,Or),yr.width=mr,yr.height=Or)}function bt(){this.id=Gr++,sn[this.id]=this,this.framebuffer=lt.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function Et(yr){yr.colorAttachments.forEach(Me),Me(yr.depthAttachment),Me(yr.stencilAttachment),Me(yr.depthStencilAttachment)}function Wt(yr){lt.deleteFramebuffer(yr.framebuffer),yr.framebuffer=null,tt.framebufferCount--,delete sn[yr.id]}function Ot(yr){var mr;lt.bindFramebuffer(36160,yr.framebuffer);var Or=yr.colorAttachments;for(mr=0;mr<Or.length;++mr)Xe(36064+mr,Or[mr]);for(mr=Or.length;mr<Kt.maxColorAttachments;++mr)lt.framebufferTexture2D(36160,36064+mr,3553,null,0);lt.framebufferTexture2D(36160,33306,3553,null,0),lt.framebufferTexture2D(36160,36096,3553,null,0),lt.framebufferTexture2D(36160,36128,3553,null,0),Xe(36096,yr.depthAttachment),Xe(36128,yr.stencilAttachment),Xe(33306,yr.depthStencilAttachment),lt.checkFramebufferStatus(36160),lt.isContextLost(),lt.bindFramebuffer(36160,vr.next?vr.next.framebuffer:null),vr.cur=vr.next,lt.getError()}function ir(yr,mr){function Or(Sr,ot){var Lt,Xt=0,tr=0,Lr=!0,Nr=!0;Lt=null;var Rr=!0,Ar="rgba",Kr="uint8",Dn=1,Sn=null,Jn=null,Bn=null,Xn=!1;typeof Sr=="number"?(Xt=Sr|0,tr=ot|0||Xt):Sr?("shape"in Sr?(tr=Sr.shape,Xt=tr[0],tr=tr[1]):("radius"in Sr&&(Xt=tr=Sr.radius),"width"in Sr&&(Xt=Sr.width),"height"in Sr&&(tr=Sr.height)),("color"in Sr||"colors"in Sr)&&(Lt=Sr.color||Sr.colors,Array.isArray(Lt)),Lt||("colorCount"in Sr&&(Dn=Sr.colorCount|0),"colorTexture"in Sr&&(Rr=!!Sr.colorTexture,Ar="rgba4"),"colorType"in Sr&&(Kr=Sr.colorType,!Rr)&&(Kr==="half float"||Kr==="float16"?Ar="rgba16f":(Kr==="float"||Kr==="float32")&&(Ar="rgba32f")),"colorFormat"in Sr&&(Ar=Sr.colorFormat,0<=_r.indexOf(Ar)?Rr=!0:0<=ln.indexOf(Ar)&&(Rr=!1))),("depthTexture"in Sr||"depthStencilTexture"in Sr)&&(Xn=!(!Sr.depthTexture&&!Sr.depthStencilTexture)),"depth"in Sr&&(typeof Sr.depth=="boolean"?Lr=Sr.depth:(Sn=Sr.depth,Nr=!1)),"stencil"in Sr&&(typeof Sr.stencil=="boolean"?Nr=Sr.stencil:(Jn=Sr.stencil,Lr=!1)),"depthStencil"in Sr&&(typeof Sr.depthStencil=="boolean"?Lr=Nr=Sr.depthStencil:(Bn=Sr.depthStencil,Nr=Lr=!1))):Xt=tr=1;var ea=null,ka=null,Ya=null,fi=null;if(Array.isArray(Lt))ea=Lt.map(Ke);else if(Lt)ea=[Ke(Lt)];else for(ea=Array(Dn),Lt=0;Lt<Dn;++Lt)ea[Lt]=rt(Xt,tr,Rr,Ar,Kr);for(Xt=Xt||ea[0].width,tr=tr||ea[0].height,Sn?ka=Ke(Sn):Lr&&!Nr&&(ka=rt(Xt,tr,Xn,"depth","uint32")),Jn?Ya=Ke(Jn):Nr&&!Lr&&(Ya=rt(Xt,tr,!1,"stencil","uint8")),Bn?fi=Ke(Bn):!Sn&&!Jn&&Nr&&Lr&&(fi=rt(Xt,tr,Xn,"depth stencil","depth stencil")),Lr=null,Lt=0;Lt<ea.length;++Lt)Ne(ea[Lt],Xt,tr),ea[Lt]&&ea[Lt].texture&&(Nr=wt[ea[Lt].texture._texture.format]*Vt[ea[Lt].texture._texture.type],Lr===null&&(Lr=Nr));return Ne(ka,Xt,tr),Ne(Ya,Xt,tr),Ne(fi,Xt,tr),Et(zr),zr.width=Xt,zr.height=tr,zr.colorAttachments=ea,zr.depthAttachment=ka,zr.stencilAttachment=Ya,zr.depthStencilAttachment=fi,Or.color=ea.map(Je),Or.depth=Je(ka),Or.stencil=Je(Ya),Or.depthStencil=Je(fi),Or.width=zr.width,Or.height=zr.height,Ot(zr),Or}var zr=new bt;return tt.framebufferCount++,Or(yr,mr),le(Or,{resize:function(Sr,ot){var Lt=Math.max(Sr|0,1),Xt=Math.max(ot|0||Lt,1);if(Lt===zr.width&&Xt===zr.height)return Or;for(var tr=zr.colorAttachments,Lr=0;Lr<tr.length;++Lr)vt(tr[Lr],Lt,Xt);return vt(zr.depthAttachment,Lt,Xt),vt(zr.stencilAttachment,Lt,Xt),vt(zr.depthStencilAttachment,Lt,Xt),zr.width=Or.width=Lt,zr.height=Or.height=Xt,Ot(zr),Or},_reglType:"framebuffer",_framebuffer:zr,destroy:function(){Wt(zr),Et(zr)},use:function(Sr){vr.setFBO({framebuffer:Or},Sr)}})}var vr={cur:null,next:null,dirty:!1,setFBO:null},_r=["rgba"],ln=["rgba4","rgb565","rgb5 a1"];Gt.ext_srgb&&ln.push("srgba"),Gt.ext_color_buffer_half_float&&ln.push("rgba16f","rgb16f"),Gt.webgl_color_buffer_float&&ln.push("rgba32f");var Cr=["uint8"];Gt.oes_texture_half_float&&Cr.push("half float","float16"),Gt.oes_texture_float&&Cr.push("float","float32");var Gr=0,sn={};return le(vr,{getFramebuffer:function(yr){return typeof yr=="function"&&yr._reglType==="framebuffer"&&(yr=yr._framebuffer,yr instanceof bt)?yr:null},create:ir,createCube:function(yr){function mr(zr){var Sr,ot={color:null},Lt=0,Xt=null;Sr="rgba";var tr="uint8",Lr=1;if(typeof zr=="number"?Lt=zr|0:zr?("shape"in zr?Lt=zr.shape[0]:("radius"in zr&&(Lt=zr.radius|0),"width"in zr?Lt=zr.width|0:"height"in zr&&(Lt=zr.height|0)),("color"in zr||"colors"in zr)&&(Xt=zr.color||zr.colors,Array.isArray(Xt)),Xt||("colorCount"in zr&&(Lr=zr.colorCount|0),"colorType"in zr&&(tr=zr.colorType),"colorFormat"in zr&&(Sr=zr.colorFormat)),"depth"in zr&&(ot.depth=zr.depth),"stencil"in zr&&(ot.stencil=zr.stencil),"depthStencil"in zr&&(ot.depthStencil=zr.depthStencil)):Lt=1,Xt)if(Array.isArray(Xt))for(zr=[],Sr=0;Sr<Xt.length;++Sr)zr[Sr]=Xt[Sr];else zr=[Xt];else for(zr=Array(Lr),Xt={radius:Lt,format:Sr,type:tr},Sr=0;Sr<Lr;++Sr)zr[Sr]=Nt.createCube(Xt);for(ot.color=Array(zr.length),Sr=0;Sr<zr.length;++Sr)Lr=zr[Sr],Lt=Lt||Lr.width,ot.color[Sr]={target:34069,data:zr[Sr]};for(Sr=0;6>Sr;++Sr){for(Lr=0;Lr<zr.length;++Lr)ot.color[Lr].target=34069+Sr;0<Sr&&(ot.depth=Or[0].depth,ot.stencil=Or[0].stencil,ot.depthStencil=Or[0].depthStencil),Or[Sr]?Or[Sr](ot):Or[Sr]=ir(ot)}return le(mr,{width:Lt,height:Lt,color:zr})}var Or=Array(6);return mr(yr),le(mr,{faces:Or,resize:function(zr){var Sr=zr|0;if(Sr===mr.width)return mr;var ot=mr.color;for(zr=0;zr<ot.length;++zr)ot[zr].resize(Sr);for(zr=0;6>zr;++zr)Or[zr].resize(Sr);return mr.width=mr.height=Sr,mr},_reglType:"framebufferCube",destroy:function(){Or.forEach(function(zr){zr.destroy()})}})},clear:function(){Le(sn).forEach(Wt)},restore:function(){vr.cur=null,vr.next=null,vr.dirty=!0,Le(sn).forEach(function(yr){yr.framebuffer=lt.createFramebuffer(),Ot(yr)})}})}function F(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function D(lt,Gt,Kt,Nt,gr,tt,we){function Me(Ot){if(Ot!==Wt.currentVAO){var ir=Gt.oes_vertex_array_object;Ot?ir.bindVertexArrayOES(Ot.vao):ir.bindVertexArrayOES(null),Wt.currentVAO=Ot}}function Ne(Ot){if(Ot!==Wt.currentVAO){if(Ot)Ot.bindAttrs();else{for(var ir=Gt.angle_instanced_arrays,vr=0;vr<vt.length;++vr){var _r=vt[vr];_r.buffer?(lt.enableVertexAttribArray(vr),_r.buffer.bind(),lt.vertexAttribPointer(vr,_r.size,_r.type,_r.normalized,_r.stride,_r.offfset),ir&&_r.divisor&&ir.vertexAttribDivisorANGLE(vr,_r.divisor)):(lt.disableVertexAttribArray(vr),lt.vertexAttrib4f(vr,_r.x,_r.y,_r.z,_r.w))}we.elements?lt.bindBuffer(34963,we.elements.buffer.buffer):lt.bindBuffer(34963,null)}Wt.currentVAO=Ot}}function Xe(){Le(Et).forEach(function(Ot){Ot.destroy()})}function Ke(){this.id=++bt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var Ot=Gt.oes_vertex_array_object;this.vao=Ot?Ot.createVertexArrayOES():null,Et[this.id]=this,this.buffers=[]}function rt(){Gt.oes_vertex_array_object&&Le(Et).forEach(function(Ot){Ot.refresh()})}var Je=Kt.maxAttributes,vt=Array(Je);for(Kt=0;Kt<Je;++Kt)vt[Kt]=new F;var bt=0,Et={},Wt={Record:F,scope:{},state:vt,currentVAO:null,targetVAO:null,restore:Gt.oes_vertex_array_object?rt:function(){},createVAO:function(Ot){function ir(_r){var ln;Array.isArray(_r)?(ln=_r,vr.elements&&vr.ownsElements&&vr.elements.destroy(),vr.elements=null,vr.ownsElements=!1,vr.offset=0,vr.count=0,vr.instances=-1,vr.primitive=4):(_r.elements?(ln=_r.elements,vr.ownsElements?(typeof ln=="function"&&ln._reglType==="elements"?vr.elements.destroy():vr.elements(ln),vr.ownsElements=!1):tt.getElements(_r.elements)?(vr.elements=_r.elements,vr.ownsElements=!1):(vr.elements=tt.create(_r.elements),vr.ownsElements=!0)):(vr.elements=null,vr.ownsElements=!1),ln=_r.attributes,vr.offset=0,vr.count=-1,vr.instances=-1,vr.primitive=4,vr.elements&&(vr.count=vr.elements._elements.vertCount,vr.primitive=vr.elements._elements.primType),"offset"in _r&&(vr.offset=_r.offset|0),"count"in _r&&(vr.count=_r.count|0),"instances"in _r&&(vr.instances=_r.instances|0),"primitive"in _r&&(vr.primitive=Ie[_r.primitive])),_r={};var Cr=vr.attributes;Cr.length=ln.length;for(var Gr=0;Gr<ln.length;++Gr){var sn=ln[Gr],yr=Cr[Gr]=new F,mr=sn.data||sn;if(Array.isArray(mr)||be(mr)||m(mr)){var Or;vr.buffers[Gr]&&(Or=vr.buffers[Gr],be(mr)&&Or._buffer.byteLength>=mr.byteLength?Or.subdata(mr):(Or.destroy(),vr.buffers[Gr]=null)),vr.buffers[Gr]||(Or=vr.buffers[Gr]=gr.create(sn,34962,!1,!0)),yr.buffer=gr.getBuffer(Or),yr.size=yr.buffer.dimension|0,yr.normalized=!1,yr.type=yr.buffer.dtype,yr.offset=0,yr.stride=0,yr.divisor=0,yr.state=1,_r[Gr]=1}else gr.getBuffer(sn)?(yr.buffer=gr.getBuffer(sn),yr.size=yr.buffer.dimension|0,yr.normalized=!1,yr.type=yr.buffer.dtype,yr.offset=0,yr.stride=0,yr.divisor=0,yr.state=1):gr.getBuffer(sn.buffer)?(yr.buffer=gr.getBuffer(sn.buffer),yr.size=(+sn.size||yr.buffer.dimension)|0,yr.normalized=!!sn.normalized||!1,yr.type="type"in sn?ke[sn.type]:yr.buffer.dtype,yr.offset=(sn.offset||0)|0,yr.stride=(sn.stride||0)|0,yr.divisor=(sn.divisor||0)|0,yr.state=1):"x"in sn&&(yr.x=+sn.x||0,yr.y=+sn.y||0,yr.z=+sn.z||0,yr.w=+sn.w||0,yr.state=2)}for(Or=0;Or<vr.buffers.length;++Or)!_r[Or]&&vr.buffers[Or]&&(vr.buffers[Or].destroy(),vr.buffers[Or]=null);return vr.refresh(),ir}var vr=new Ke;return Nt.vaoCount+=1,ir.destroy=function(){for(var _r=0;_r<vr.buffers.length;++_r)vr.buffers[_r]&&vr.buffers[_r].destroy();vr.buffers.length=0,vr.ownsElements&&(vr.elements.destroy(),vr.elements=null,vr.ownsElements=!1),vr.destroy()},ir._vao=vr,ir._reglType="vao",ir(Ot)},getVAO:function(Ot){return typeof Ot=="function"&&Ot._vao?Ot._vao:null},destroyBuffer:function(Ot){for(var ir=0;ir<vt.length;++ir){var vr=vt[ir];vr.buffer===Ot&&(lt.disableVertexAttribArray(ir),vr.buffer=null)}},setVAO:Gt.oes_vertex_array_object?Me:Ne,clear:Gt.oes_vertex_array_object?Xe:function(){}};return Ke.prototype.bindAttrs=function(){for(var Ot=Gt.angle_instanced_arrays,ir=this.attributes,vr=0;vr<ir.length;++vr){var _r=ir[vr];_r.buffer?(lt.enableVertexAttribArray(vr),lt.bindBuffer(34962,_r.buffer.buffer),lt.vertexAttribPointer(vr,_r.size,_r.type,_r.normalized,_r.stride,_r.offset),Ot&&_r.divisor&&Ot.vertexAttribDivisorANGLE(vr,_r.divisor)):(lt.disableVertexAttribArray(vr),lt.vertexAttrib4f(vr,_r.x,_r.y,_r.z,_r.w))}for(Ot=ir.length;Ot<Je;++Ot)lt.disableVertexAttribArray(Ot);(Ot=tt.getElements(this.elements))?lt.bindBuffer(34963,Ot.buffer.buffer):lt.bindBuffer(34963,null)},Ke.prototype.refresh=function(){var Ot=Gt.oes_vertex_array_object;Ot&&(Ot.bindVertexArrayOES(this.vao),this.bindAttrs(),Wt.currentVAO=null,Ot.bindVertexArrayOES(null))},Ke.prototype.destroy=function(){if(this.vao){var Ot=Gt.oes_vertex_array_object;this===Wt.currentVAO&&(Wt.currentVAO=null,Ot.bindVertexArrayOES(null)),Ot.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Et[this.id]&&(delete Et[this.id],--Nt.vaoCount)},Wt}function B(lt,Gt,Kt,Nt){function gr(bt,Et,Wt,Ot){this.name=bt,this.id=Et,this.location=Wt,this.info=Ot}function tt(bt,Et){for(var Wt=0;Wt<bt.length;++Wt)if(bt[Wt].id===Et.id){bt[Wt].location=Et.location;return}bt.push(Et)}function we(bt,Et,Wt){Wt=bt===35632?Xe:Ke;var Ot=Wt[Et];if(!Ot){var ir=Gt.str(Et),Ot=lt.createShader(bt);lt.shaderSource(Ot,ir),lt.compileShader(Ot),Wt[Et]=Ot}return Ot}function Me(bt,Et){this.id=vt++,this.fragId=bt,this.vertId=Et,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,Nt.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function Ne(bt,Et,Wt){var Ot;Ot=we(35632,bt.fragId);var ir=we(35633,bt.vertId);if(Et=bt.program=lt.createProgram(),lt.attachShader(Et,Ot),lt.attachShader(Et,ir),Wt)for(Ot=0;Ot<Wt.length;++Ot)ir=Wt[Ot],lt.bindAttribLocation(Et,ir[0],ir[1]);lt.linkProgram(Et),ir=lt.getProgramParameter(Et,35718),Nt.profile&&(bt.stats.uniformsCount=ir);var vr=bt.uniforms;for(Ot=0;Ot<ir;++Ot)if(Wt=lt.getActiveUniform(Et,Ot))if(1<Wt.size)for(var _r=0;_r<Wt.size;++_r){var ln=Wt.name.replace("[0]","["+_r+"]");tt(vr,new gr(ln,Gt.id(ln),lt.getUniformLocation(Et,ln),Wt))}else tt(vr,new gr(Wt.name,Gt.id(Wt.name),lt.getUniformLocation(Et,Wt.name),Wt));for(ir=lt.getProgramParameter(Et,35721),Nt.profile&&(bt.stats.attributesCount=ir),bt=bt.attributes,Ot=0;Ot<ir;++Ot)(Wt=lt.getActiveAttrib(Et,Ot))&&tt(bt,new gr(Wt.name,Gt.id(Wt.name),lt.getAttribLocation(Et,Wt.name),Wt))}var Xe={},Ke={},rt={},Je=[],vt=0;return Nt.profile&&(Kt.getMaxUniformsCount=function(){var bt=0;return Je.forEach(function(Et){Et.stats.uniformsCount>bt&&(bt=Et.stats.uniformsCount)}),bt},Kt.getMaxAttributesCount=function(){var bt=0;return Je.forEach(function(Et){Et.stats.attributesCount>bt&&(bt=Et.stats.attributesCount)}),bt}),{clear:function(){var bt=lt.deleteShader.bind(lt);Le(Xe).forEach(bt),Xe={},Le(Ke).forEach(bt),Ke={},Je.forEach(function(Et){lt.deleteProgram(Et.program)}),Je.length=0,rt={},Kt.shaderCount=0},program:function(bt,Et,Wt,Ot){var ir=rt[Et];ir||(ir=rt[Et]={});var vr=ir[bt];if(vr&&(vr.refCount++,!Ot))return vr;var _r=new Me(Et,bt);return Kt.shaderCount++,Ne(_r,Wt,Ot),vr||(ir[bt]=_r),Je.push(_r),le(_r,{destroy:function(){if(_r.refCount--,0>=_r.refCount){lt.deleteProgram(_r.program);var ln=Je.indexOf(_r);Je.splice(ln,1),Kt.shaderCount--}0>=ir[_r.vertId].refCount&&(lt.deleteShader(Ke[_r.vertId]),delete Ke[_r.vertId],delete rt[_r.fragId][_r.vertId]),Object.keys(rt[_r.fragId]).length||(lt.deleteShader(Xe[_r.fragId]),delete Xe[_r.fragId],delete rt[_r.fragId])}})},restore:function(){Xe={},Ke={};for(var bt=0;bt<Je.length;++bt)Ne(Je[bt],null,Je[bt].attributes.map(function(Et){return[Et.location,Et.name]}))},shader:we,frag:-1,vert:-1}}function U(lt,Gt,Kt,Nt,gr,tt,we){function Me(Xe){var Ke;Ke=Gt.next===null?5121:Gt.next.colorAttachments[0].texture._texture.type;var rt=0,Je=0,vt=Nt.framebufferWidth,bt=Nt.framebufferHeight,Et=null;return be(Xe)?Et=Xe:Xe&&(rt=Xe.x|0,Je=Xe.y|0,vt=(Xe.width||Nt.framebufferWidth-rt)|0,bt=(Xe.height||Nt.framebufferHeight-Je)|0,Et=Xe.data||null),Kt(),Xe=vt*bt*4,Et||(Ke===5121?Et=new Uint8Array(Xe):Ke===5126&&(Et=Et||new Float32Array(Xe))),lt.pixelStorei(3333,4),lt.readPixels(rt,Je,vt,bt,6408,Ke,Et),Et}function Ne(Xe){var Ke;return Gt.setFBO({framebuffer:Xe.framebuffer},function(){Ke=Me(Xe)}),Ke}return function(Xe){return Xe&&"framebuffer"in Xe?Ne(Xe):Me(Xe)}}function X(lt){for(var Gt=Array(lt.length>>2),Nt=0;Nt<Gt.length;Nt++)Gt[Nt]=0;for(Nt=0;Nt<8*lt.length;Nt+=8)Gt[Nt>>5]|=(lt.charCodeAt(Nt/8)&255)<<24-Nt%32;var Kt=8*lt.length;lt=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225];var Nt=Array(64),gr,tt,we,Me,Ne,Xe,Ke,rt,Je,vt,bt;for(Gt[Kt>>5]|=128<<24-Kt%32,Gt[(Kt+64>>9<<4)+15]=Kt,rt=0;rt<Gt.length;rt+=16){for(Kt=lt[0],gr=lt[1],tt=lt[2],we=lt[3],Me=lt[4],Ne=lt[5],Xe=lt[6],Ke=lt[7],Je=0;64>Je;Je++){if(16>Je)Nt[Je]=Gt[Je+rt];else{vt=Je,bt=Nt[Je-2],bt=q(bt,17)^q(bt,19)^bt>>>10,bt=K(bt,Nt[Je-7]);var Et;Et=Nt[Je-15],Et=q(Et,7)^q(Et,18)^Et>>>3,Nt[vt]=K(K(bt,Et),Nt[Je-16])}vt=Me,vt=q(vt,6)^q(vt,11)^q(vt,25),vt=K(K(K(K(Ke,vt),Me&Ne^~Me&Xe),qt[Je]),Nt[Je]),Ke=Kt,Ke=q(Ke,2)^q(Ke,13)^q(Ke,22),bt=K(Ke,Kt&gr^Kt&tt^gr&tt),Ke=Xe,Xe=Ne,Ne=Me,Me=K(we,vt),we=tt,tt=gr,gr=Kt,Kt=K(vt,bt)}lt[0]=K(Kt,lt[0]),lt[1]=K(gr,lt[1]),lt[2]=K(tt,lt[2]),lt[3]=K(we,lt[3]),lt[4]=K(Me,lt[4]),lt[5]=K(Ne,lt[5]),lt[6]=K(Xe,lt[6]),lt[7]=K(Ke,lt[7])}for(Gt="",Nt=0;Nt<32*lt.length;Nt+=8)Gt+=String.fromCharCode(lt[Nt>>5]>>>24-Nt%32&255);return Gt}function oe(lt){for(var Gt="",Kt,Nt=0;Nt<lt.length;Nt++)Kt=lt.charCodeAt(Nt),Gt+="0123456789abcdef".charAt(Kt>>>4&15)+"0123456789abcdef".charAt(Kt&15);return Gt}function se(lt){for(var Gt="",Kt=-1,Nt,gr;++Kt<lt.length;)Nt=lt.charCodeAt(Kt),gr=Kt+1<lt.length?lt.charCodeAt(Kt+1):0,55296<=Nt&&56319>=Nt&&56320<=gr&&57343>=gr&&(Nt=65536+((Nt&1023)<<10)+(gr&1023),Kt++),127>=Nt?Gt+=String.fromCharCode(Nt):2047>=Nt?Gt+=String.fromCharCode(192|Nt>>>6&31,128|Nt&63):65535>=Nt?Gt+=String.fromCharCode(224|Nt>>>12&15,128|Nt>>>6&63,128|Nt&63):2097151>=Nt&&(Gt+=String.fromCharCode(240|Nt>>>18&7,128|Nt>>>12&63,128|Nt>>>6&63,128|Nt&63));return Gt}function q(lt,Gt){return lt>>>Gt|lt<<32-Gt}function K(lt,Gt){var Kt=(lt&65535)+(Gt&65535);return(lt>>16)+(Gt>>16)+(Kt>>16)<<16|Kt&65535}function G(lt){return Array.prototype.slice.call(lt)}function Q(lt){return G(lt).join("")}function V(lt){function Gt(){var Ke=[],rt=[];return le(function(){Ke.push.apply(Ke,G(arguments))},{def:function(){var Je="v"+gr++;return rt.push(Je),0<arguments.length&&(Ke.push(Je,"="),Ke.push.apply(Ke,G(arguments)),Ke.push(";")),Je},toString:function(){return Q([0<rt.length?"var "+rt.join(",")+";":"",Q(Ke)])}})}function Kt(){function Ke(Et,Wt){Je(Et,Wt,"=",rt.def(Et,Wt),";")}var rt=Gt(),Je=Gt(),vt=rt.toString,bt=Je.toString;return le(function(){rt.apply(rt,G(arguments))},{def:rt.def,entry:rt,exit:Je,save:Ke,set:function(Et,Wt,Ot){Ke(Et,Wt),rt(Et,Wt,"=",Ot,";")},toString:function(){return vt()+bt()}})}var Nt=lt&&lt.cache,gr=0,tt=[],we=[],Me=[],Ne=Gt(),Xe={};return{global:Ne,link:function(Ke,rt){var Je=rt&&rt.stable;if(!Je){for(var vt=0;vt<we.length;++vt)if(we[vt]===Ke&&!Me[vt])return tt[vt]}return vt="g"+gr++,tt.push(vt),we.push(Ke),Me.push(Je),vt},block:Gt,proc:function(Ke,rt){function Je(){var Wt="a"+vt.length;return vt.push(Wt),Wt}var vt=[];rt=rt||0;for(var bt=0;bt<rt;++bt)Je();var bt=Kt(),Et=bt.toString;return Xe[Ke]=le(bt,{arg:Je,toString:function(){return Q(["function(",vt.join(),"){",Et(),"}"])}})},scope:Kt,cond:function(){var Ke=Q(arguments),rt=Kt(),Je=Kt(),vt=rt.toString,bt=Je.toString;return le(rt,{then:function(){return rt.apply(rt,G(arguments)),this},else:function(){return Je.apply(Je,G(arguments)),this},toString:function(){var Et=bt();return Et&&(Et="else{"+Et+"}"),Q(["if(",Ke,"){",vt(),"}",Et])}})},compile:function(){var Ke=['"use strict";',Ne,"return {"];Object.keys(Xe).forEach(function(vt){Ke.push('"',vt,'":',Xe[vt].toString(),",")}),Ke.push("}");var rt=Q(Ke).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),Je;return Nt&&(Je=oe(X(se(rt))),Nt[Je])?Nt[Je].apply(null,we):(rt=Function.apply(null,tt.concat(rt)),Nt&&(Nt[Je]=rt),rt.apply(null,we))}}}function H(lt){return Array.isArray(lt)||be(lt)||m(lt)}function ee(lt){return lt.sort(function(Gt,Kt){return Gt==="viewport"?-1:Kt==="viewport"?1:Gt<Kt?-1:1})}function J(lt,Gt,Kt,Nt){this.thisDep=lt,this.contextDep=Gt,this.propDep=Kt,this.append=Nt}function W(lt){return lt&&!(lt.thisDep||lt.contextDep||lt.propDep)}function re(lt){return new J(!1,!1,!1,lt)}function j(lt,Gt){var Kt=lt.type;if(Kt===0)return Kt=lt.data.length,new J(!0,1<=Kt,2<=Kt,Gt);if(Kt===4)return Kt=lt.data,new J(Kt.thisDep,Kt.contextDep,Kt.propDep,Gt);if(Kt===5)return new J(!1,!1,!1,Gt);if(Kt===6){for(var Nt=Kt=!1,gr=!1,tt=0;tt<lt.data.length;++tt){var we=lt.data[tt];we.type===1?gr=!0:we.type===2?Nt=!0:we.type===3?Kt=!0:we.type===0?(Kt=!0,we=we.data,1<=we&&(Nt=!0),2<=we&&(gr=!0)):we.type===4&&(Kt=Kt||we.data.thisDep,Nt=Nt||we.data.contextDep,gr=gr||we.data.propDep)}return new J(Kt,Nt,gr,Gt)}return new J(Kt===3,Kt===2,Kt===1,Gt)}function Z(lt,Gt,Kt,Nt,gr,tt,we,Me,Ne,Xe,Ke,rt,Je,vt,bt,Et){function Wt(Ft){return Ft.replace(".","_")}function Ot(Ft,cr,nn){var vn=Wt(Ft);oa.push(Ft),Vn[vn]=Tn[vn]=!!nn,na[vn]=cr}function ir(Ft,cr,nn){var vn=Wt(Ft);oa.push(Ft),Array.isArray(nn)?(Tn[vn]=nn.slice(),Vn[vn]=nn.slice()):Tn[vn]=Vn[vn]=nn,On[vn]=cr}function vr(){var Ft=V({cache:bt}),cr=Ft.link,nn=Ft.global;Ft.id=di++,Ft.batchId="0";var vn=cr(ta),on=Ft.shared={props:"a0"};Object.keys(ta).forEach(function(pr){on[pr]=nn.def(vn,".",pr)});var Cn=Ft.next={},_n=Ft.current={};Object.keys(On).forEach(function(pr){Array.isArray(Tn[pr])&&(Cn[pr]=nn.def(on.next,".",pr),_n[pr]=nn.def(on.current,".",pr))});var un=Ft.constants={};Object.keys(Ua).forEach(function(pr){un[pr]=nn.def(JSON.stringify(Ua[pr]))}),Ft.invoke=function(pr,Pr){switch(Pr.type){case 0:var dn=["this",on.context,on.props,Ft.batchId];return pr.def(cr(Pr.data),".call(",dn.slice(0,Math.max(Pr.data.length+1,4)),")");case 1:return pr.def(on.props,Pr.data);case 2:return pr.def(on.context,Pr.data);case 3:return pr.def("this",Pr.data);case 4:return Pr.data.append(Ft,pr),Pr.data.ref;case 5:return Pr.data.toString();case 6:return Pr.data.map(function(Un){return Ft.invoke(pr,Un)})}},Ft.attribCache={};var dr={};return Ft.scopeAttrib=function(pr){if(pr=Gt.id(pr),pr in dr)return dr[pr];var Pr=Xe.scope[pr];return Pr||(Pr=Xe.scope[pr]=new hi),dr[pr]=cr(Pr)},Ft}function _r(Ft){var cr=Ft.static;Ft=Ft.dynamic;var nn;if("profile"in cr){var vn=!!cr.profile;nn=re(function(Cn,_n){return vn}),nn.enable=vn}else if("profile"in Ft){var on=Ft.profile;nn=j(on,function(Cn,_n){return Cn.invoke(_n,on)})}return nn}function ln(Ft,cr){var nn=Ft.static,vn=Ft.dynamic;if("framebuffer"in nn){var on=nn.framebuffer;return on?(on=Me.getFramebuffer(on),re(function(_n,un){var dr=_n.link(on),pr=_n.shared;return un.set(pr.framebuffer,".next",dr),pr=pr.context,un.set(pr,".framebufferWidth",dr+".width"),un.set(pr,".framebufferHeight",dr+".height"),dr})):re(function(_n,un){var dr=_n.shared;return un.set(dr.framebuffer,".next","null"),dr=dr.context,un.set(dr,".framebufferWidth",dr+".drawingBufferWidth"),un.set(dr,".framebufferHeight",dr+".drawingBufferHeight"),"null"})}if("framebuffer"in vn){var Cn=vn.framebuffer;return j(Cn,function(_n,un){var Pr=_n.invoke(un,Cn),dr=_n.shared,pr=dr.framebuffer,Pr=un.def(pr,".getFramebuffer(",Pr,")");return un.set(pr,".next",Pr),dr=dr.context,un.set(dr,".framebufferWidth",Pr+"?"+Pr+".width:"+dr+".drawingBufferWidth"),un.set(dr,".framebufferHeight",Pr+"?"+Pr+".height:"+dr+".drawingBufferHeight"),Pr})}return null}function Cr(Ft,cr,nn){function vn(un){if(un in on){var dr=on[un];un=!0;var pr=dr.x|0,Pr=dr.y|0,dn,Un;return"width"in dr?dn=dr.width|0:un=!1,"height"in dr?Un=dr.height|0:un=!1,new J(!un&&cr&&cr.thisDep,!un&&cr&&cr.contextDep,!un&&cr&&cr.propDep,function(bn,Zn){var sa=bn.shared.context,ga=dn;"width"in dr||(ga=Zn.def(sa,".","framebufferWidth","-",pr));var wa=Un;return"height"in dr||(wa=Zn.def(sa,".","framebufferHeight","-",Pr)),[pr,Pr,ga,wa]})}if(un in Cn){var ra=Cn[un];return un=j(ra,function(bn,Zn){var Aa=bn.invoke(Zn,ra),sa=bn.shared.context,ga=Zn.def(Aa,".x|0"),wa=Zn.def(Aa,".y|0"),ua=Zn.def('"width" in ',Aa,"?",Aa,".width|0:","(",sa,".","framebufferWidth","-",ga,")"),Aa=Zn.def('"height" in ',Aa,"?",Aa,".height|0:","(",sa,".","framebufferHeight","-",wa,")");return[ga,wa,ua,Aa]}),cr&&(un.thisDep=un.thisDep||cr.thisDep,un.contextDep=un.contextDep||cr.contextDep,un.propDep=un.propDep||cr.propDep),un}return cr?new J(cr.thisDep,cr.contextDep,cr.propDep,function(bn,Zn){var sa=bn.shared.context;return[0,0,Zn.def(sa,".","framebufferWidth"),Zn.def(sa,".","framebufferHeight")]}):null}var on=Ft.static,Cn=Ft.dynamic;if(Ft=vn("viewport")){var _n=Ft;Ft=new J(Ft.thisDep,Ft.contextDep,Ft.propDep,function(un,dr){var pr=_n.append(un,dr),Pr=un.shared.context;return dr.set(Pr,".viewportWidth",pr[2]),dr.set(Pr,".viewportHeight",pr[3]),pr})}return{viewport:Ft,scissor_box:vn("scissor.box")}}function Gr(Ft,cr){var nn=Ft.static;if(typeof nn.frag=="string"&&typeof nn.vert=="string"){if(0<Object.keys(cr.dynamic).length)return null;var nn=cr.static,vn=Object.keys(nn);if(0<vn.length&&typeof nn[vn[0]]=="number"){for(var on=[],Cn=0;Cn<vn.length;++Cn)on.push([nn[vn[Cn]]|0,vn[Cn]]);return on}}return null}function sn(Ft,cr,nn){function vn(pr){if(pr in on){var Pr=Gt.id(on[pr]);return pr=re(function(){return Pr}),pr.id=Pr,pr}if(pr in Cn){var dn=Cn[pr];return j(dn,function(Un,ra){var bn=Un.invoke(ra,dn);return ra.def(Un.shared.strings,".id(",bn,")")})}return null}var on=Ft.static,Cn=Ft.dynamic,_n=vn("frag"),un=vn("vert"),dr=null;return W(_n)&&W(un)?(dr=Ke.program(un.id,_n.id,null,nn),Ft=re(function(pr,Pr){return pr.link(dr)})):Ft=new J(_n&&_n.thisDep||un&&un.thisDep,_n&&_n.contextDep||un&&un.contextDep,_n&&_n.propDep||un&&un.propDep,function(pr,Pr){var dn=pr.shared.shader,Un;Un=_n?_n.append(pr,Pr):Pr.def(dn,".","frag");var ra;return ra=un?un.append(pr,Pr):Pr.def(dn,".","vert"),Pr.def(dn+".program("+ra+","+Un+")")}),{frag:_n,vert:un,progVar:Ft,program:dr}}function yr(Ft,cr){function nn(bn,Zn){if(bn in vn){var sa=vn[bn]|0;return Zn?Cn.offset=sa:Cn.instances=sa,re(function(wa,ua){return Zn&&(wa.OFFSET=sa),sa})}if(bn in on){var ga=on[bn];return j(ga,function(wa,ua){var Aa=wa.invoke(ua,ga);return Zn&&(wa.OFFSET=Aa),Aa})}if(Zn){if(dr)return re(function(wa,ua){return wa.OFFSET=0});if(_n)return new J(un.thisDep,un.contextDep,un.propDep,function(wa,ua){return ua.def(wa.shared.vao+".currentVAO?"+wa.shared.vao+".currentVAO.offset:0")})}else if(_n)return new J(un.thisDep,un.contextDep,un.propDep,function(wa,ua){return ua.def(wa.shared.vao+".currentVAO?"+wa.shared.vao+".currentVAO.instances:-1")});return null}var vn=Ft.static,on=Ft.dynamic,Cn={},_n=!1,un=function(){if("vao"in vn){var bn=vn.vao;return bn!==null&&Xe.getVAO(bn)===null&&(bn=Xe.createVAO(bn)),_n=!0,Cn.vao=bn,re(function(sa){var ga=Xe.getVAO(bn);return ga?sa.link(ga):"null"})}if("vao"in on){_n=!0;var Zn=on.vao;return j(Zn,function(sa,ga){var wa=sa.invoke(ga,Zn);return ga.def(sa.shared.vao+".getVAO("+wa+")")})}return null}(),dr=!1,pr=function(){if("elements"in vn){var bn=vn.elements;if(Cn.elements=bn,H(bn)){var Zn=Cn.elements=tt.create(bn,!0),bn=tt.getElements(Zn);dr=!0}else bn&&(bn=tt.getElements(bn),dr=!0);return Zn=re(function(ga,wa){if(bn){var ua=ga.link(bn);return ga.ELEMENTS=ua}return ga.ELEMENTS=null}),Zn.value=bn,Zn}if("elements"in on){dr=!0;var sa=on.elements;return j(sa,function(ga,wa){var ua=ga.shared,_o=ua.isBufferArgs,ua=ua.elements,So=ga.invoke(wa,sa),Aa=wa.def("null"),_o=wa.def(_o,"(",So,")"),So=ga.cond(_o).then(Aa,"=",ua,".createStream(",So,");").else(Aa,"=",ua,".getElements(",So,");");return wa.entry(So),wa.exit(ga.cond(_o).then(ua,".destroyStream(",Aa,");")),ga.ELEMENTS=Aa})}return _n?new J(un.thisDep,un.contextDep,un.propDep,function(ga,wa){return wa.def(ga.shared.vao+".currentVAO?"+ga.shared.elements+".getElements("+ga.shared.vao+".currentVAO.elements):null")}):null}(),Pr=nn("offset",!0),dn=function(){if("primitive"in vn){var bn=vn.primitive;return Cn.primitive=bn,re(function(sa,ga){return Ie[bn]})}if("primitive"in on){var Zn=on.primitive;return j(Zn,function(sa,ga){var wa=sa.constants.primTypes,ua=sa.invoke(ga,Zn);return ga.def(wa,"[",ua,"]")})}return dr?W(pr)?pr.value?re(function(sa,ga){return ga.def(sa.ELEMENTS,".primType")}):re(function(){return 4}):new J(pr.thisDep,pr.contextDep,pr.propDep,function(sa,ga){var wa=sa.ELEMENTS;return ga.def(wa,"?",wa,".primType:",4)}):_n?new J(un.thisDep,un.contextDep,un.propDep,function(sa,ga){return ga.def(sa.shared.vao+".currentVAO?"+sa.shared.vao+".currentVAO.primitive:4")}):null}(),Un=function(){if("count"in vn){var bn=vn.count|0;return Cn.count=bn,re(function(){return bn})}if("count"in on){var Zn=on.count;return j(Zn,function(sa,ga){return sa.invoke(ga,Zn)})}return dr?W(pr)?pr?Pr?new J(Pr.thisDep,Pr.contextDep,Pr.propDep,function(sa,ga){return ga.def(sa.ELEMENTS,".vertCount-",sa.OFFSET)}):re(function(sa,ga){return ga.def(sa.ELEMENTS,".vertCount")}):re(function(){return-1}):new J(pr.thisDep||Pr.thisDep,pr.contextDep||Pr.contextDep,pr.propDep||Pr.propDep,function(sa,ga){var wa=sa.ELEMENTS;return sa.OFFSET?ga.def(wa,"?",wa,".vertCount-",sa.OFFSET,":-1"):ga.def(wa,"?",wa,".vertCount:-1")}):_n?new J(un.thisDep,un.contextDep,un.propDep,function(sa,ga){return ga.def(sa.shared.vao,".currentVAO?",sa.shared.vao,".currentVAO.count:-1")}):null}(),ra=nn("instances",!1);return{elements:pr,primitive:dn,count:Un,instances:ra,offset:Pr,vao:un,vaoActive:_n,elementsActive:dr,static:Cn}}function mr(Ft,cr){var nn=Ft.static,vn=Ft.dynamic,on={};return oa.forEach(function(Cn){function _n(dr,pr){if(Cn in nn){var Pr=dr(nn[Cn]);on[un]=re(function(){return Pr})}else if(Cn in vn){var dn=vn[Cn];on[un]=j(dn,function(Un,ra){return pr(Un,ra,Un.invoke(ra,dn))})}}var un=Wt(Cn);switch(Cn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return _n(function(dr){return dr},function(dr,pr,Pr){return Pr});case"depth.func":return _n(function(dr){return Qt[dr]},function(dr,pr,Pr){return pr.def(dr.constants.compareFuncs,"[",Pr,"]")});case"depth.range":return _n(function(dr){return dr},function(dr,pr,Pr){return dr=pr.def("+",Pr,"[0]"),pr=pr.def("+",Pr,"[1]"),[dr,pr]});case"blend.func":return _n(function(dr){return[$t["srcRGB"in dr?dr.srcRGB:dr.src],$t["dstRGB"in dr?dr.dstRGB:dr.dst],$t["srcAlpha"in dr?dr.srcAlpha:dr.src],$t["dstAlpha"in dr?dr.dstAlpha:dr.dst]]},function(dr,pr,Pr){function dn(Zn,sa){return pr.def('"',Zn,sa,'" in ',Pr,"?",Pr,".",Zn,sa,":",Pr,".",Zn)}dr=dr.constants.blendFuncs;var Un=dn("src","RGB"),bn=dn("dst","RGB"),Un=pr.def(dr,"[",Un,"]"),ra=pr.def(dr,"[",dn("src","Alpha"),"]"),bn=pr.def(dr,"[",bn,"]");return dr=pr.def(dr,"[",dn("dst","Alpha"),"]"),[Un,bn,ra,dr]});case"blend.equation":return _n(function(dr){if(typeof dr=="string")return[Ka[dr],Ka[dr]];if(typeof dr=="object")return[Ka[dr.rgb],Ka[dr.alpha]]},function(dr,pr,Pr){var dn=dr.constants.blendEquations,Un=pr.def(),ra=pr.def();return dr=dr.cond("typeof ",Pr,'==="string"'),dr.then(Un,"=",ra,"=",dn,"[",Pr,"];"),dr.else(Un,"=",dn,"[",Pr,".rgb];",ra,"=",dn,"[",Pr,".alpha];"),pr(dr),[Un,ra]});case"blend.color":return _n(function(dr){return r(4,function(pr){return+dr[pr]})},function(dr,pr,Pr){return r(4,function(dn){return pr.def("+",Pr,"[",dn,"]")})});case"stencil.mask":return _n(function(dr){return dr|0},function(dr,pr,Pr){return pr.def(Pr,"|0")});case"stencil.func":return _n(function(dr){return[Qt[dr.cmp||"keep"],dr.ref||0,"mask"in dr?dr.mask:-1]},function(dr,pr,Pr){dr=pr.def('"cmp" in ',Pr,"?",dr.constants.compareFuncs,"[",Pr,".cmp]",":",7680);var dn=pr.def(Pr,".ref|0");return pr=pr.def('"mask" in ',Pr,"?",Pr,".mask|0:-1"),[dr,dn,pr]});case"stencil.opFront":case"stencil.opBack":return _n(function(dr){return[Cn==="stencil.opBack"?1029:1028,fr[dr.fail||"keep"],fr[dr.zfail||"keep"],fr[dr.zpass||"keep"]]},function(dr,pr,Pr){function dn(ra){return pr.def('"',ra,'" in ',Pr,"?",Un,"[",Pr,".",ra,"]:",7680)}var Un=dr.constants.stencilOps;return[Cn==="stencil.opBack"?1029:1028,dn("fail"),dn("zfail"),dn("zpass")]});case"polygonOffset.offset":return _n(function(dr){return[dr.factor|0,dr.units|0]},function(dr,pr,Pr){return dr=pr.def(Pr,".factor|0"),pr=pr.def(Pr,".units|0"),[dr,pr]});case"cull.face":return _n(function(dr){var pr=0;return dr==="front"?pr=1028:dr==="back"&&(pr=1029),pr},function(dr,pr,Pr){return pr.def(Pr,'==="front"?',1028,":",1029)});case"lineWidth":return _n(function(dr){return dr},function(dr,pr,Pr){return Pr});case"frontFace":return _n(function(dr){return jr[dr]},function(dr,pr,Pr){return pr.def(Pr+'==="cw"?2304:2305')});case"colorMask":return _n(function(dr){return dr.map(function(pr){return!!pr})},function(dr,pr,Pr){return r(4,function(dn){return"!!"+Pr+"["+dn+"]"})});case"sample.coverage":return _n(function(dr){return["value"in dr?dr.value:1,!!dr.invert]},function(dr,pr,Pr){return dr=pr.def('"value" in ',Pr,"?+",Pr,".value:1"),pr=pr.def("!!",Pr,".invert"),[dr,pr]})}}),on}function Or(Ft,cr){var nn=Ft.static,vn=Ft.dynamic,on={};return Object.keys(nn).forEach(function(Cn){var _n=nn[Cn],un;if(typeof _n=="number"||typeof _n=="boolean")un=re(function(){return _n});else if(typeof _n=="function"){var dr=_n._reglType;dr==="texture2d"||dr==="textureCube"?un=re(function(pr){return pr.link(_n)}):(dr==="framebuffer"||dr==="framebufferCube")&&(un=re(function(pr){return pr.link(_n.color[0])}))}else A(_n)&&(un=re(function(pr){return pr.global.def("[",r(_n.length,function(Pr){return _n[Pr]}),"]")}));un.value=_n,on[Cn]=un}),Object.keys(vn).forEach(function(Cn){var _n=vn[Cn];on[Cn]=j(_n,function(un,dr){return un.invoke(dr,_n)})}),on}function zr(Ft,cr){var nn=Ft.static,vn=Ft.dynamic,on={};return Object.keys(nn).forEach(function(Cn){var _n=nn[Cn],un=Gt.id(Cn),dr=new hi;if(H(_n))dr.state=1,dr.buffer=gr.getBuffer(gr.create(_n,34962,!1,!0)),dr.type=0;else{var pr=gr.getBuffer(_n);if(pr)dr.state=1,dr.buffer=pr,dr.type=0;else if("constant"in _n){var Pr=_n.constant;dr.buffer="null",dr.state=2,typeof Pr=="number"?dr.x=Pr:zt.forEach(function(sa,ga){ga<Pr.length&&(dr[sa]=Pr[ga])})}else{var pr=H(_n.buffer)?gr.getBuffer(gr.create(_n.buffer,34962,!1,!0)):gr.getBuffer(_n.buffer),dn=_n.offset|0,Un=_n.stride|0,ra=_n.size|0,bn=!!_n.normalized,Zn=0;"type"in _n&&(Zn=ke[_n.type]),_n=_n.divisor|0,dr.buffer=pr,dr.state=1,dr.size=ra,dr.normalized=bn,dr.type=Zn||pr.dtype,dr.offset=dn,dr.stride=Un,dr.divisor=_n}}on[Cn]=re(function(sa,ga){var wa=sa.attribCache;if(un in wa)return wa[un];var ua={isStream:!1};return Object.keys(dr).forEach(function(Aa){ua[Aa]=dr[Aa]}),dr.buffer&&(ua.buffer=sa.link(dr.buffer),ua.type=ua.type||ua.buffer+".dtype"),wa[un]=ua})}),Object.keys(vn).forEach(function(Cn){var _n=vn[Cn];on[Cn]=j(_n,function(un,dr){function pr(wa){dr(bn[wa],"=",Pr,".",wa,"|0;")}var Pr=un.invoke(dr,_n),ra=un.shared,dn=un.constants,Un=ra.isBufferArgs,ra=ra.buffer,bn={isStream:dr.def(!1)},Zn=new hi;Zn.state=1,Object.keys(Zn).forEach(function(wa){bn[wa]=dr.def(""+Zn[wa])});var sa=bn.buffer,ga=bn.type;return dr("if(",Un,"(",Pr,")){",bn.isStream,"=true;",sa,"=",ra,".createStream(",34962,",",Pr,");",ga,"=",sa,".dtype;","}else{",sa,"=",ra,".getBuffer(",Pr,");","if(",sa,"){",ga,"=",sa,".dtype;",'}else if("constant" in ',Pr,"){",bn.state,"=",2,";","if(typeof "+Pr+'.constant === "number"){',bn[zt[0]],"=",Pr,".constant;",zt.slice(1).map(function(wa){return bn[wa]}).join("="),"=0;","}else{",zt.map(function(wa,ua){return bn[wa]+"="+Pr+".constant.length>"+ua+"?"+Pr+".constant["+ua+"]:0;"}).join(""),"}}else{","if(",Un,"(",Pr,".buffer)){",sa,"=",ra,".createStream(",34962,",",Pr,".buffer);","}else{",sa,"=",ra,".getBuffer(",Pr,".buffer);","}",ga,'="type" in ',Pr,"?",dn.glTypes,"[",Pr,".type]:",sa,".dtype;",bn.normalized,"=!!",Pr,".normalized;"),pr("size"),pr("offset"),pr("stride"),pr("divisor"),dr("}}"),dr.exit("if(",bn.isStream,"){",ra,".destroyStream(",sa,");","}"),bn})}),on}function Sr(Ft){var cr=Ft.static,nn=Ft.dynamic,vn={};return Object.keys(cr).forEach(function(on){var Cn=cr[on];vn[on]=re(function(_n,un){return typeof Cn=="number"||typeof Cn=="boolean"?""+Cn:_n.link(Cn)})}),Object.keys(nn).forEach(function(on){var Cn=nn[on];vn[on]=j(Cn,function(_n,un){return _n.invoke(un,Cn)})}),vn}function ot(Ft,cr,nn,vn,on){function Cn(Zn){var sa=un[Zn];sa&&(pr[Zn]=sa)}var _n=Gr(Ft,cr),Un=ln(Ft,on),un=Cr(Ft,Un,on),dr=yr(Ft,on),pr=mr(Ft,on),Pr=sn(Ft,on,_n);Cn("viewport"),Cn(Wt("scissor.box"));var dn=0<Object.keys(pr).length,Un={framebuffer:Un,draw:dr,shader:Pr,state:pr,dirty:dn,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Un.profile=_r(Ft,on),Un.uniforms=Or(nn,on),Un.drawVAO=Un.scopeVAO=dr.vao,!Un.drawVAO&&Pr.program&&!_n&&Kt.angle_instanced_arrays&&dr.static.elements){var ra=!0;if(Ft=Pr.program.attributes.map(function(Zn){return Zn=cr.static[Zn],ra=ra&&!!Zn,Zn}),ra&&0<Ft.length){var bn=Xe.getVAO(Xe.createVAO({attributes:Ft,elements:dr.static.elements}));Un.drawVAO=new J(null,null,null,function(Zn,sa){return Zn.link(bn)}),Un.useVAO=!0}}return _n?Un.useVAO=!0:Un.attributes=zr(cr,on),Un.context=Sr(vn,on),Un}function Lt(Ft,cr,nn){var vn=Ft.shared.context,on=Ft.scope();Object.keys(nn).forEach(function(Cn){cr.save(vn,"."+Cn);var _n=nn[Cn].append(Ft,cr);Array.isArray(_n)?on(vn,".",Cn,"=[",_n.join(),"];"):on(vn,".",Cn,"=",_n,";")}),cr(on)}function Xt(Ft,cr,nn,vn){var un=Ft.shared,on=un.gl,Cn=un.framebuffer,_n;gn&&(_n=cr.def(un.extensions,".webgl_draw_buffers"));var dr=Ft.constants,un=dr.drawBuffer,dr=dr.backBuffer;Ft=nn?nn.append(Ft,cr):cr.def(Cn,".next"),vn||cr("if(",Ft,"!==",Cn,".cur){"),cr("if(",Ft,"){",on,".bindFramebuffer(",36160,",",Ft,".framebuffer);"),gn&&cr(_n,".drawBuffersWEBGL(",un,"[",Ft,".colorAttachments.length]);"),cr("}else{",on,".bindFramebuffer(",36160,",null);"),gn&&cr(_n,".drawBuffersWEBGL(",dr,");"),cr("}",Cn,".cur=",Ft,";"),vn||cr("}")}function tr(Ft,cr,nn){var vn=Ft.shared,on=vn.gl,Cn=Ft.current,_n=Ft.next,un=vn.current,dr=vn.next,pr=Ft.cond(un,".dirty");oa.forEach(function(Pr){if(Pr=Wt(Pr),!(Pr in nn.state)){var dn,Un;if(Pr in _n){dn=_n[Pr],Un=Cn[Pr];var ra=r(Tn[Pr].length,function(bn){return pr.def(dn,"[",bn,"]")});pr(Ft.cond(ra.map(function(bn,Zn){return bn+"!=="+Un+"["+Zn+"]"}).join("||")).then(on,".",On[Pr],"(",ra,");",ra.map(function(bn,Zn){return Un+"["+Zn+"]="+bn}).join(";"),";"))}else dn=pr.def(dr,".",Pr),ra=Ft.cond(dn,"!==",un,".",Pr),pr(ra),Pr in na?ra(Ft.cond(dn).then(on,".enable(",na[Pr],");").else(on,".disable(",na[Pr],");"),un,".",Pr,"=",dn,";"):ra(on,".",On[Pr],"(",dn,");",un,".",Pr,"=",dn,";")}}),Object.keys(nn.state).length===0&&pr(un,".dirty=false;"),cr(pr)}function Lr(Ft,cr,nn,vn){var on=Ft.shared,Cn=Ft.current,_n=on.current,un=on.gl,dr;ee(Object.keys(nn)).forEach(function(pr){var Pr=nn[pr];if(!vn||vn(Pr)){var dn=Pr.append(Ft,cr);if(na[pr]){var Un=na[pr];W(Pr)?(dr=Ft.link(dn,{stable:!0}),cr(Ft.cond(dr).then(un,".enable(",Un,");").else(un,".disable(",Un,");")),cr(_n,".",pr,"=",dr,";")):(cr(Ft.cond(dn).then(un,".enable(",Un,");").else(un,".disable(",Un,");")),cr(_n,".",pr,"=",dn,";"))}else if(A(dn)){var ra=Cn[pr];cr(un,".",On[pr],"(",dn,");",dn.map(function(bn,Zn){return ra+"["+Zn+"]="+bn}).join(";"),";")}else W(Pr)?(dr=Ft.link(dn,{stable:!0}),cr(un,".",On[pr],"(",dr,");",_n,".",pr,"=",dr,";")):cr(un,".",On[pr],"(",dn,");",_n,".",pr,"=",dn,";")}})}function Nr(Ft,cr){wr&&(Ft.instancing=cr.def(Ft.shared.extensions,".angle_instanced_arrays"))}function Rr(Ft,cr,nn,vn,on){function Cn(){return typeof performance>"u"?"Date.now()":"performance.now()"}function _n(Zn){ra=cr.def(),Zn(ra,"=",Cn(),";"),typeof on=="string"?Zn(Pr,".count+=",on,";"):Zn(Pr,".count++;"),vt&&(vn?(bn=cr.def(),Zn(bn,"=",Un,".getNumPendingQueries();")):Zn(Un,".beginQuery(",Pr,");"))}function un(Zn){Zn(Pr,".cpuTime+=",Cn(),"-",ra,";"),vt&&(vn?Zn(Un,".pushScopeStats(",bn,",",Un,".getNumPendingQueries(),",Pr,");"):Zn(Un,".endQuery();"))}function dr(Zn){var sa=cr.def(dn,".profile");cr(dn,".profile=",Zn,";"),cr.exit(dn,".profile=",sa,";")}var pr=Ft.shared,Pr=Ft.stats,dn=pr.current,Un=pr.timer;nn=nn.profile;var ra,bn;if(nn){if(W(nn)){nn.enable?(_n(cr),un(cr.exit),dr("true")):dr("false");return}nn=nn.append(Ft,cr),dr(nn)}else nn=cr.def(dn,".profile");pr=Ft.block(),_n(pr),cr("if(",nn,"){",pr,"}"),Ft=Ft.block(),un(Ft),cr.exit("if(",nn,"){",Ft,"}")}function Ar(Ft,cr,nn,vn,on){function Cn(dr){switch(dr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function _n(dr,pr,Pr){function dn(){cr("if(!",Zn,".buffer){",ra,".enableVertexAttribArray(",bn,");}");var ua=Pr.type,Aa;Aa=Pr.size?cr.def(Pr.size,"||",pr):pr,cr("if(",Zn,".type!==",ua,"||",Zn,".size!==",Aa,"||",wa.map(function(_o){return Zn+"."+_o+"!=="+Pr[_o]}).join("||"),"){",ra,".bindBuffer(",34962,",",sa,".buffer);",ra,".vertexAttribPointer(",[bn,Aa,ua,Pr.normalized,Pr.stride,Pr.offset],");",Zn,".type=",ua,";",Zn,".size=",Aa,";",wa.map(function(_o){return Zn+"."+_o+"="+Pr[_o]+";"}).join(""),"}"),wr&&(ua=Pr.divisor,cr("if(",Zn,".divisor!==",ua,"){",Ft.instancing,".vertexAttribDivisorANGLE(",[bn,ua],");",Zn,".divisor=",ua,";}"))}function Un(){cr("if(",Zn,".buffer){",ra,".disableVertexAttribArray(",bn,");",Zn,".buffer=null;","}if(",zt.map(function(ua,Aa){return Zn+"."+ua+"!=="+ga[Aa]}).join("||"),"){",ra,".vertexAttrib4f(",bn,",",ga,");",zt.map(function(ua,Aa){return Zn+"."+ua+"="+ga[Aa]+";"}).join(""),"}")}var ra=un.gl,bn=cr.def(dr,".location"),Zn=cr.def(un.attributes,"[",bn,"]");dr=Pr.state;var sa=Pr.buffer,ga=[Pr.x,Pr.y,Pr.z,Pr.w],wa=["buffer","normalized","offset","stride"];dr===1?dn():dr===2?Un():(cr("if(",dr,"===",1,"){"),dn(),cr("}else{"),Un(),cr("}"))}var un=Ft.shared;vn.forEach(function(dr){var pr=dr.name,Pr=nn.attributes[pr],dn;if(Pr){if(!on(Pr))return;dn=Pr.append(Ft,cr)}else{if(!on(cn))return;var Un=Ft.scopeAttrib(pr);dn={},Object.keys(new hi).forEach(function(ra){dn[ra]=cr.def(Un,".",ra)})}_n(Ft.link(dr),Cn(dr.info.type),dn)})}function Kr(Ft,cr,nn,vn,on,Cn){for(var _n=Ft.shared,un=_n.gl,dr,pr=0;pr<vn.length;++pr){var ra=vn[pr],Pr=ra.name,dn=ra.info.type,Un=nn.uniforms[Pr],ra=Ft.link(ra)+".location",bn;if(Un){if(!on(Un))continue;if(W(Un)){if(Pr=Un.value,dn===35678||dn===35680)dn=Ft.link(Pr._texture||Pr.color[0]._texture),cr(un,".uniform1i(",ra,",",dn+".bind());"),cr.exit(dn,".unbind();");else if(dn===35674||dn===35675||dn===35676)Pr=Ft.global.def("new Float32Array(["+Array.prototype.slice.call(Pr)+"])"),Un=2,dn===35675?Un=3:dn===35676&&(Un=4),cr(un,".uniformMatrix",Un,"fv(",ra,",false,",Pr,");");else{switch(dn){case 5126:dr="1f";break;case 35664:dr="2f";break;case 35665:dr="3f";break;case 35666:dr="4f";break;case 35670:dr="1i";break;case 5124:dr="1i";break;case 35671:dr="2i";break;case 35667:dr="2i";break;case 35672:dr="3i";break;case 35668:dr="3i";break;case 35673:dr="4i";break;case 35669:dr="4i"}cr(un,".uniform",dr,"(",ra,",",A(Pr)?Array.prototype.slice.call(Pr):Pr,");")}continue}else bn=Un.append(Ft,cr)}else{if(!on(cn))continue;bn=cr.def(_n.uniforms,"[",Gt.id(Pr),"]")}switch(dn===35678?cr("if(",bn,"&&",bn,'._reglType==="framebuffer"){',bn,"=",bn,".color[0];","}"):dn===35680&&cr("if(",bn,"&&",bn,'._reglType==="framebufferCube"){',bn,"=",bn,".color[0];","}"),Pr=1,dn){case 35678:case 35680:dn=cr.def(bn,"._texture"),cr(un,".uniform1i(",ra,",",dn,".bind());"),cr.exit(dn,".unbind();");continue;case 5124:case 35670:dr="1i";break;case 35667:case 35671:dr="2i",Pr=2;break;case 35668:case 35672:dr="3i",Pr=3;break;case 35669:case 35673:dr="4i",Pr=4;break;case 5126:dr="1f";break;case 35664:dr="2f",Pr=2;break;case 35665:dr="3f",Pr=3;break;case 35666:dr="4f",Pr=4;break;case 35674:dr="Matrix2fv";break;case 35675:dr="Matrix3fv";break;case 35676:dr="Matrix4fv"}if(dr.charAt(0)==="M"){cr(un,".uniform",dr,"(",ra,",");var ra=Math.pow(dn-35674+2,2),Zn=Ft.global.def("new Float32Array(",ra,")");Array.isArray(bn)?cr("false,(",r(ra,function(wa){return Zn+"["+wa+"]="+bn[wa]}),",",Zn,")"):cr("false,(Array.isArray(",bn,")||",bn," instanceof Float32Array)?",bn,":(",r(ra,function(wa){return Zn+"["+wa+"]="+bn+"["+wa+"]"}),",",Zn,")"),cr(");")}else{if(1<Pr){for(var dn=[],sa=[],Un=0;Un<Pr;++Un)Array.isArray(bn)?sa.push(bn[Un]):sa.push(cr.def(bn+"["+Un+"]")),Cn&&dn.push(cr.def());Cn&&cr("if(!",Ft.batchId,"||",dn.map(function(ga,wa){return ga+"!=="+sa[wa]}).join("||"),"){",dn.map(function(ga,wa){return ga+"="+sa[wa]+";"}).join("")),cr(un,".uniform",dr,"(",ra,",",sa.join(","),");")}else Cn&&(dn=cr.def(),cr("if(!",Ft.batchId,"||",dn,"!==",bn,"){",dn,"=",bn,";")),cr(un,".uniform",dr,"(",ra,",",bn,");");Cn&&cr("}")}}}function Dn(Ft,cr,nn,vn){function on(ua){var Aa=Pr[ua];return Aa?Aa.contextDep&&vn.contextDynamic||Aa.propDep?Aa.append(Ft,nn):Aa.append(Ft,cr):cr.def(pr,".",ua)}function Cn(){function ua(){nn(sa,".drawElementsInstancedANGLE(",[Un,bn,ga,ra+"<<(("+ga+"-5121)>>1)",Zn],");")}function Aa(){nn(sa,".drawArraysInstancedANGLE(",[Un,ra,bn,Zn],");")}dn&&dn!=="null"?wa?ua():(nn("if(",dn,"){"),ua(),nn("}else{"),Aa(),nn("}")):Aa()}function _n(){function ua(){nn(dr+".drawElements("+[Un,bn,ga,ra+"<<(("+ga+"-5121)>>1)"]+");")}function Aa(){nn(dr+".drawArrays("+[Un,ra,bn]+");")}dn&&dn!=="null"?wa?ua():(nn("if(",dn,"){"),ua(),nn("}else{"),Aa(),nn("}")):Aa()}var un=Ft.shared,dr=un.gl,pr=un.draw,Pr=vn.draw,dn=function(){var ua=Pr.elements,Aa=cr;return ua?((ua.contextDep&&vn.contextDynamic||ua.propDep)&&(Aa=nn),ua=ua.append(Ft,Aa),Pr.elementsActive&&Aa("if("+ua+")"+dr+".bindBuffer(34963,"+ua+".buffer.buffer);")):(ua=Aa.def(),Aa(ua,"=",pr,".","elements",";","if(",ua,"){",dr,".bindBuffer(",34963,",",ua,".buffer.buffer);}","else if(",un.vao,".currentVAO){",ua,"=",Ft.shared.elements+".getElements("+un.vao,".currentVAO.elements);",hn?"":"if("+ua+")"+dr+".bindBuffer(34963,"+ua+".buffer.buffer);","}")),ua}(),Un=on("primitive"),ra=on("offset"),bn=function(){var ua=Pr.count,Aa=cr;return ua?((ua.contextDep&&vn.contextDynamic||ua.propDep)&&(Aa=nn),ua=ua.append(Ft,Aa)):ua=Aa.def(pr,".","count"),ua}();if(typeof bn=="number"){if(bn===0)return}else nn("if(",bn,"){"),nn.exit("}");var Zn,sa;wr&&(Zn=on("instances"),sa=Ft.instancing);var ga=dn+".type",wa=Pr.elements&&W(Pr.elements)&&!Pr.vaoActive;wr&&(typeof Zn!="number"||0<=Zn)?typeof Zn=="string"?(nn("if(",Zn,">0){"),Cn(),nn("}else if(",Zn,"<0){"),_n(),nn("}")):Cn():_n()}function Sn(Ft,cr,nn,vn,on){return cr=vr(),on=cr.proc("body",on),wr&&(cr.instancing=on.def(cr.shared.extensions,".angle_instanced_arrays")),Ft(cr,on,nn,vn),cr.compile().body}function Jn(Ft,cr,nn,vn){Nr(Ft,cr),nn.useVAO?nn.drawVAO?cr(Ft.shared.vao,".setVAO(",nn.drawVAO.append(Ft,cr),");"):cr(Ft.shared.vao,".setVAO(",Ft.shared.vao,".targetVAO);"):(cr(Ft.shared.vao,".setVAO(null);"),Ar(Ft,cr,nn,vn.attributes,function(){return!0})),Kr(Ft,cr,nn,vn.uniforms,function(){return!0},!1),Dn(Ft,cr,cr,nn)}function Bn(Ft,cr){var nn=Ft.proc("draw",1);Nr(Ft,nn),Lt(Ft,nn,cr.context),Xt(Ft,nn,cr.framebuffer),tr(Ft,nn,cr),Lr(Ft,nn,cr.state),Rr(Ft,nn,cr,!1,!0);var vn=cr.shader.progVar.append(Ft,nn);if(nn(Ft.shared.gl,".useProgram(",vn,".program);"),cr.shader.program)Jn(Ft,nn,cr,cr.shader.program);else{nn(Ft.shared.vao,".setVAO(null);");var on=Ft.global.def("{}"),Cn=nn.def(vn,".id"),_n=nn.def(on,"[",Cn,"]");nn(Ft.cond(_n).then(_n,".call(this,a0);").else(_n,"=",on,"[",Cn,"]=",Ft.link(function(un){return Sn(Jn,Ft,cr,un,1)}),"(",vn,");",_n,".call(this,a0);"))}0<Object.keys(cr.state).length&&nn(Ft.shared.current,".dirty=true;"),Ft.shared.vao&&nn(Ft.shared.vao,".setVAO(null);")}function Xn(Ft,cr,nn,vn){function on(){return!0}Ft.batchId="a1",Nr(Ft,cr),Ar(Ft,cr,nn,vn.attributes,on),Kr(Ft,cr,nn,vn.uniforms,on,!1),Dn(Ft,cr,cr,nn)}function ea(Ft,cr,nn,vn){function on(dn){return dn.contextDep&&_n||dn.propDep}function Cn(dn){return!on(dn)}Nr(Ft,cr);var _n=nn.contextDep,un=cr.def(),dr=cr.def();Ft.shared.props=dr,Ft.batchId=un;var pr=Ft.scope(),Pr=Ft.scope();cr(pr.entry,"for(",un,"=0;",un,"<","a1",";++",un,"){",dr,"=","a0","[",un,"];",Pr,"}",pr.exit),nn.needsContext&&Lt(Ft,Pr,nn.context),nn.needsFramebuffer&&Xt(Ft,Pr,nn.framebuffer),Lr(Ft,Pr,nn.state,on),nn.profile&&on(nn.profile)&&Rr(Ft,Pr,nn,!1,!0),vn?(nn.useVAO?nn.drawVAO?on(nn.drawVAO)?Pr(Ft.shared.vao,".setVAO(",nn.drawVAO.append(Ft,Pr),");"):pr(Ft.shared.vao,".setVAO(",nn.drawVAO.append(Ft,pr),");"):pr(Ft.shared.vao,".setVAO(",Ft.shared.vao,".targetVAO);"):(pr(Ft.shared.vao,".setVAO(null);"),Ar(Ft,pr,nn,vn.attributes,Cn),Ar(Ft,Pr,nn,vn.attributes,on)),Kr(Ft,pr,nn,vn.uniforms,Cn,!1),Kr(Ft,Pr,nn,vn.uniforms,on,!0),Dn(Ft,pr,Pr,nn)):(cr=Ft.global.def("{}"),vn=nn.shader.progVar.append(Ft,Pr),dr=Pr.def(vn,".id"),pr=Pr.def(cr,"[",dr,"]"),Pr(Ft.shared.gl,".useProgram(",vn,".program);","if(!",pr,"){",pr,"=",cr,"[",dr,"]=",Ft.link(function(dn){return Sn(Xn,Ft,nn,dn,2)}),"(",vn,");}",pr,".call(this,a0[",un,"],",un,");"))}function ka(Ft,cr){function nn(pr){return pr.contextDep&&on||pr.propDep}var vn=Ft.proc("batch",2);Ft.batchId="0",Nr(Ft,vn);var on=!1,Cn=!0;Object.keys(cr.context).forEach(function(pr){on=on||cr.context[pr].propDep}),on||(Lt(Ft,vn,cr.context),Cn=!1);var _n=cr.framebuffer,un=!1;if(_n?(_n.propDep?on=un=!0:_n.contextDep&&on&&(un=!0),un||Xt(Ft,vn,_n)):Xt(Ft,vn,null),cr.state.viewport&&cr.state.viewport.propDep&&(on=!0),tr(Ft,vn,cr),Lr(Ft,vn,cr.state,function(pr){return!nn(pr)}),cr.profile&&nn(cr.profile)||Rr(Ft,vn,cr,!1,"a1"),cr.contextDep=on,cr.needsContext=Cn,cr.needsFramebuffer=un,Cn=cr.shader.progVar,Cn.contextDep&&on||Cn.propDep)ea(Ft,vn,cr,null);else if(Cn=Cn.append(Ft,vn),vn(Ft.shared.gl,".useProgram(",Cn,".program);"),cr.shader.program)ea(Ft,vn,cr,cr.shader.program);else{vn(Ft.shared.vao,".setVAO(null);");var _n=Ft.global.def("{}"),un=vn.def(Cn,".id"),dr=vn.def(_n,"[",un,"]");vn(Ft.cond(dr).then(dr,".call(this,a0,a1);").else(dr,"=",_n,"[",un,"]=",Ft.link(function(dn){return Sn(ea,Ft,cr,dn,2)}),"(",Cn,");",dr,".call(this,a0,a1);"))}0<Object.keys(cr.state).length&&vn(Ft.shared.current,".dirty=true;"),Ft.shared.vao&&vn(Ft.shared.vao,".setVAO(null);")}function Ya(Ft,cr){function nn(un){var dr=cr.shader[un];dr&&(dr=dr.append(Ft,vn),isNaN(dr)?vn.set(on.shader,"."+un,dr):vn.set(on.shader,"."+un,Ft.link(dr,{stable:!0})))}var vn=Ft.proc("scope",3);Ft.batchId="a2";var on=Ft.shared,Cn=on.current;if(Lt(Ft,vn,cr.context),cr.framebuffer&&cr.framebuffer.append(Ft,vn),ee(Object.keys(cr.state)).forEach(function(un){var dr=cr.state[un],pr=dr.append(Ft,vn);A(pr)?pr.forEach(function(Pr,dn){isNaN(Pr)?vn.set(Ft.next[un],"["+dn+"]",Pr):vn.set(Ft.next[un],"["+dn+"]",Ft.link(Pr,{stable:!0}))}):W(dr)?vn.set(on.next,"."+un,Ft.link(pr,{stable:!0})):vn.set(on.next,"."+un,pr)}),Rr(Ft,vn,cr,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(un){var dr=cr.draw[un];dr&&(dr=dr.append(Ft,vn),isNaN(dr)?vn.set(on.draw,"."+un,dr):vn.set(on.draw,"."+un,Ft.link(dr),{stable:!0}))}),Object.keys(cr.uniforms).forEach(function(un){var dr=cr.uniforms[un].append(Ft,vn);Array.isArray(dr)&&(dr="["+dr.map(function(pr){return isNaN(pr)?pr:Ft.link(pr,{stable:!0})})+"]"),vn.set(on.uniforms,"["+Ft.link(Gt.id(un),{stable:!0})+"]",dr)}),Object.keys(cr.attributes).forEach(function(un){var dr=cr.attributes[un].append(Ft,vn),pr=Ft.scopeAttrib(un);Object.keys(new hi).forEach(function(Pr){vn.set(pr,"."+Pr,dr[Pr])})}),cr.scopeVAO){var _n=cr.scopeVAO.append(Ft,vn);isNaN(_n)?vn.set(on.vao,".targetVAO",_n):vn.set(on.vao,".targetVAO",Ft.link(_n,{stable:!0}))}nn("vert"),nn("frag"),0<Object.keys(cr.state).length&&(vn(Cn,".dirty=true;"),vn.exit(Cn,".dirty=true;")),vn("a1(",Ft.shared.context,",a0,",Ft.batchId,");")}function fi(Ft){if(typeof Ft=="object"&&!A(Ft)){for(var cr=Object.keys(Ft),nn=0;nn<cr.length;++nn)if(pe.isDynamic(Ft[cr[nn]]))return!0;return!1}}function pi(Ft,cr,nn){function vn(dn,Un){_n.forEach(function(ra){var bn=on[ra];pe.isDynamic(bn)&&(bn=dn.invoke(Un,bn),Un(Pr,".",ra,"=",bn,";"))})}var on=cr.static[nn];if(on&&fi(on)){var Cn=Ft.global,_n=Object.keys(on),un=!1,dr=!1,pr=!1,Pr=Ft.global.def("{}");_n.forEach(function(dn){var Un=on[dn];if(pe.isDynamic(Un))typeof Un=="function"&&(Un=on[dn]=pe.unbox(Un)),dn=j(Un,null),un=un||dn.thisDep,pr=pr||dn.propDep,dr=dr||dn.contextDep;else{switch(Cn(Pr,".",dn,"="),typeof Un){case"number":Cn(Un);break;case"string":Cn('"',Un,'"');break;case"object":Array.isArray(Un)&&Cn("[",Un.join(),"]");break;default:Cn(Ft.link(Un))}Cn(";")}}),cr.dynamic[nn]=new pe.DynamicVariable(4,{thisDep:un,contextDep:dr,propDep:pr,ref:Pr,append:vn}),delete cr.static[nn]}}var hi=Xe.Record,Ka={add:32774,subtract:32778,"reverse subtract":32779};Kt.ext_blend_minmax&&(Ka.min=32775,Ka.max=32776);var wr=Kt.angle_instanced_arrays,gn=Kt.webgl_draw_buffers,hn=Kt.oes_vertex_array_object,Tn={dirty:!0,profile:Et.profile},Vn={},oa=[],na={},On={};Ot("dither",3024),Ot("blend.enable",3042),ir("blend.color","blendColor",[0,0,0,0]),ir("blend.equation","blendEquationSeparate",[32774,32774]),ir("blend.func","blendFuncSeparate",[1,0,1,0]),Ot("depth.enable",2929,!0),ir("depth.func","depthFunc",513),ir("depth.range","depthRange",[0,1]),ir("depth.mask","depthMask",!0),ir("colorMask","colorMask",[!0,!0,!0,!0]),Ot("cull.enable",2884),ir("cull.face","cullFace",1029),ir("frontFace","frontFace",2305),ir("lineWidth","lineWidth",1),Ot("polygonOffset.enable",32823),ir("polygonOffset.offset","polygonOffset",[0,0]),Ot("sample.alpha",32926),Ot("sample.enable",32928),ir("sample.coverage","sampleCoverage",[1,!1]),Ot("stencil.enable",2960),ir("stencil.mask","stencilMask",-1),ir("stencil.func","stencilFunc",[519,0,-1]),ir("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),ir("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),Ot("scissor.enable",3089),ir("scissor.box","scissor",[0,0,lt.drawingBufferWidth,lt.drawingBufferHeight]),ir("viewport","viewport",[0,0,lt.drawingBufferWidth,lt.drawingBufferHeight]);var ta={gl:lt,context:Je,strings:Gt,next:Vn,current:Tn,draw:rt,elements:tt,buffer:gr,shader:Ke,attributes:Xe.state,vao:Xe,uniforms:Ne,framebuffer:Me,extensions:Kt,timer:vt,isBufferArgs:H},Ua={primTypes:Ie,compareFuncs:Qt,blendFuncs:$t,blendEquations:Ka,stencilOps:fr,glTypes:ke,orientationType:jr};gn&&(Ua.backBuffer=[1029],Ua.drawBuffer=r(Nt.maxDrawbuffers,function(Ft){return Ft===0?[0]:r(Ft,function(cr){return 36064+cr})}));var di=0;return{next:Vn,current:Tn,procs:function(){var Ft=vr(),cr=Ft.proc("poll"),nn=Ft.proc("refresh"),vn=Ft.block();cr(vn),nn(vn);var dr=Ft.shared,on=dr.gl,Cn=dr.next,_n=dr.current;vn(_n,".dirty=false;"),Xt(Ft,cr),Xt(Ft,nn,null,!0);var un;wr&&(un=Ft.link(wr)),Kt.oes_vertex_array_object&&nn(Ft.link(Kt.oes_vertex_array_object),".bindVertexArrayOES(null);");var dr=nn.def(dr.attributes),pr=nn.def(0),Pr=Ft.cond(pr,".buffer");Pr.then(on,".enableVertexAttribArray(i);",on,".bindBuffer(",34962,",",pr,".buffer.buffer);",on,".vertexAttribPointer(i,",pr,".size,",pr,".type,",pr,".normalized,",pr,".stride,",pr,".offset);").else(on,".disableVertexAttribArray(i);",on,".vertexAttrib4f(i,",pr,".x,",pr,".y,",pr,".z,",pr,".w);",pr,".buffer=null;");var dn=Ft.link(Nt.maxAttributes,{stable:!0});return nn("for(var i=0;i<",dn,";++i){",pr,"=",dr,"[i];",Pr,"}"),wr&&nn("for(var i=0;i<",dn,";++i){",un,".vertexAttribDivisorANGLE(i,",dr,"[i].divisor);","}"),nn(Ft.shared.vao,".currentVAO=null;",Ft.shared.vao,".setVAO(",Ft.shared.vao,".targetVAO);"),Object.keys(na).forEach(function(Un){var ra=na[Un],bn=vn.def(Cn,".",Un),Zn=Ft.block();Zn("if(",bn,"){",on,".enable(",ra,")}else{",on,".disable(",ra,")}",_n,".",Un,"=",bn,";"),nn(Zn),cr("if(",bn,"!==",_n,".",Un,"){",Zn,"}")}),Object.keys(On).forEach(function(Un){var ra=On[Un],bn=Tn[Un],Zn,sa,ga=Ft.block();ga(on,".",ra,"("),A(bn)?(ra=bn.length,Zn=Ft.global.def(Cn,".",Un),sa=Ft.global.def(_n,".",Un),ga(r(ra,function(wa){return Zn+"["+wa+"]"}),");",r(ra,function(wa){return sa+"["+wa+"]="+Zn+"["+wa+"];"}).join("")),cr("if(",r(ra,function(wa){return Zn+"["+wa+"]!=="+sa+"["+wa+"]"}).join("||"),"){",ga,"}")):(Zn=vn.def(Cn,".",Un),sa=vn.def(_n,".",Un),ga(Zn,");",_n,".",Un,"=",Zn,";"),cr("if(",Zn,"!==",sa,"){",ga,"}")),nn(ga)}),Ft.compile()}(),compile:function(Ft,cr,nn,vn,on){var Cn=vr();Cn.stats=Cn.link(on),Object.keys(cr.static).forEach(function(un){pi(Cn,cr,un)}),Ht.forEach(function(un){pi(Cn,Ft,un)});var _n=ot(Ft,cr,nn,vn,Cn);return _n.shader.program&&(_n.shader.program.attributes.sort(function(un,dr){return un.name<dr.name?-1:1}),_n.shader.program.uniforms.sort(function(un,dr){return un.name<dr.name?-1:1})),Bn(Cn,_n),Ya(Cn,_n),ka(Cn,_n),le(Cn.compile(),{destroy:function(){_n.shader.program.destroy()}})}}}function ne(lt,Gt){for(var Kt=0;Kt<lt.length;++Kt)if(lt[Kt]===Gt)return Kt;return-1}var le=function(lt,Gt){for(var Kt=Object.keys(Gt),Nt=0;Nt<Kt.length;++Nt)lt[Kt[Nt]]=Gt[Kt[Nt]];return lt},ge=0,pe={DynamicVariable:b,define:function(lt,Gt){return new b(lt,P(Gt+""))},isDynamic:function(lt){return typeof lt=="function"&&!lt._reglType||lt instanceof b},unbox:E,accessor:P},xe={next:typeof requestAnimationFrame=="function"?function(lt){return requestAnimationFrame(lt)}:function(lt){return setTimeout(lt,16)},cancel:typeof cancelAnimationFrame=="function"?function(lt){return cancelAnimationFrame(lt)}:clearTimeout},Ee=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},Te=s();Te.zero=s();var de=function(lt,Gt){var Kt=1;Gt.ext_texture_filter_anisotropic&&(Kt=lt.getParameter(34047));var Nt=1,gr=1;Gt.webgl_draw_buffers&&(Nt=lt.getParameter(34852),gr=lt.getParameter(36063));var tt=!!Gt.oes_texture_float;if(tt){tt=lt.createTexture(),lt.bindTexture(3553,tt),lt.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var we=lt.createFramebuffer();if(lt.bindFramebuffer(36160,we),lt.framebufferTexture2D(36160,36064,3553,tt,0),lt.bindTexture(3553,null),lt.checkFramebufferStatus(36160)!==36053)tt=!1;else{lt.viewport(0,0,1,1),lt.clearColor(1,0,0,1),lt.clear(16384);var Me=Te.allocType(5126,4);lt.readPixels(0,0,1,1,6408,5126,Me),lt.getError()?tt=!1:(lt.deleteFramebuffer(we),lt.deleteTexture(tt),tt=Me[0]===1),Te.freeType(Me)}}return Me=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(Me=lt.createTexture(),we=Te.allocType(5121,36),lt.activeTexture(33984),lt.bindTexture(34067,Me),lt.texImage2D(34069,0,6408,3,3,0,6408,5121,we),Te.freeType(we),lt.bindTexture(34067,null),lt.deleteTexture(Me),Me=!lt.getError()),{colorBits:[lt.getParameter(3410),lt.getParameter(3411),lt.getParameter(3412),lt.getParameter(3413)],depthBits:lt.getParameter(3414),stencilBits:lt.getParameter(3415),subpixelBits:lt.getParameter(3408),extensions:Object.keys(Gt).filter(function(Ne){return!!Gt[Ne]}),maxAnisotropic:Kt,maxDrawbuffers:Nt,maxColorAttachments:gr,pointSizeDims:lt.getParameter(33901),lineWidthDims:lt.getParameter(33902),maxViewportDims:lt.getParameter(3386),maxCombinedTextureUnits:lt.getParameter(35661),maxCubeMapSize:lt.getParameter(34076),maxRenderbufferSize:lt.getParameter(34024),maxTextureUnits:lt.getParameter(34930),maxTextureSize:lt.getParameter(3379),maxAttributes:lt.getParameter(34921),maxVertexUniforms:lt.getParameter(36347),maxVertexTextureUnits:lt.getParameter(35660),maxVaryingVectors:lt.getParameter(36348),maxFragmentUniforms:lt.getParameter(36349),glsl:lt.getParameter(35724),renderer:lt.getParameter(7937),vendor:lt.getParameter(7936),version:lt.getParameter(7938),readFloat:tt,npotTextureCube:Me}},be=function(lt){return lt instanceof Uint8Array||lt instanceof Uint16Array||lt instanceof Uint32Array||lt instanceof Int8Array||lt instanceof Int16Array||lt instanceof Int32Array||lt instanceof Float32Array||lt instanceof Float64Array||lt instanceof Uint8ClampedArray},Le=function(lt){return Object.keys(lt).map(function(Gt){return lt[Gt]})},De={shape:function(lt){for(var Gt=[];lt.length;lt=lt[0])Gt.push(lt.length);return Gt},flatten:function(lt,Gt,Kt,Nt){var gr=1;if(Gt.length)for(var tt=0;tt<Gt.length;++tt)gr*=Gt[tt];else gr=0;switch(Kt=Nt||Te.allocType(Kt,gr),Gt.length){case 0:break;case 1:for(Nt=Gt[0],Gt=0;Gt<Nt;++Gt)Kt[Gt]=lt[Gt];break;case 2:for(Nt=Gt[0],Gt=Gt[1],tt=gr=0;tt<Nt;++tt)for(var we=lt[tt],Me=0;Me<Gt;++Me)Kt[gr++]=we[Me];break;case 3:x(lt,Gt[0],Gt[1],Gt[2],Kt,0);break;default:M(lt,Gt,0,Kt,0)}return Kt}},ye={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},ke={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},Oe={dynamic:35048,stream:35040,static:35044},Qe=De.flatten,Ve=De.shape,Ue=[];Ue[5120]=1,Ue[5122]=2,Ue[5124]=4,Ue[5121]=1,Ue[5123]=2,Ue[5125]=4,Ue[5126]=4;var Ie={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},at=new Float32Array(1),pt=new Uint32Array(at.buffer),Rt=[9984,9986,9985,9987],Mt=[0,6409,6410,6407,6408],It={};It[6409]=It[6406]=It[6402]=1,It[34041]=It[6410]=2,It[6407]=It[35904]=3,It[6408]=It[35906]=4;var Bt=f("HTMLCanvasElement"),St=f("OffscreenCanvas"),_t=f("CanvasRenderingContext2D"),it=f("ImageBitmap"),ct=f("HTMLImageElement"),et=f("HTMLVideoElement"),Pe=Object.keys(ye).concat([Bt,St,_t,it,ct,et]),We=[];We[5121]=1,We[5126]=4,We[36193]=2,We[5123]=2,We[5125]=4;var je=[];je[32854]=2,je[32855]=2,je[36194]=2,je[34041]=4,je[33776]=.5,je[33777]=.5,je[33778]=1,je[33779]=1,je[35986]=.5,je[35987]=1,je[34798]=1,je[35840]=.5,je[35841]=.25,je[35842]=.5,je[35843]=.25,je[36196]=.5;var nt=[];nt[32854]=2,nt[32855]=2,nt[36194]=2,nt[33189]=2,nt[36168]=1,nt[34041]=4,nt[35907]=4,nt[34836]=16,nt[34842]=8,nt[34843]=6;var kt=function(lt,Gt,Kt,Nt,gr){function tt(rt){this.id=Xe++,this.refCount=1,this.renderbuffer=rt,this.format=32854,this.height=this.width=0,gr.profile&&(this.stats={size:0})}function we(rt){var Je=rt.renderbuffer;lt.bindRenderbuffer(36161,null),lt.deleteRenderbuffer(Je),rt.renderbuffer=null,rt.refCount=0,delete Ke[rt.id],Nt.renderbufferCount--}var Me={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};Gt.ext_srgb&&(Me.srgba=35907),Gt.ext_color_buffer_half_float&&(Me.rgba16f=34842,Me.rgb16f=34843),Gt.webgl_color_buffer_float&&(Me.rgba32f=34836);var Ne=[];Object.keys(Me).forEach(function(rt){Ne[Me[rt]]=rt});var Xe=0,Ke={};return tt.prototype.decRef=function(){0>=--this.refCount&&we(this)},gr.profile&&(Nt.getTotalRenderbufferSize=function(){var rt=0;return Object.keys(Ke).forEach(function(Je){rt+=Ke[Je].stats.size}),rt}),{create:function(rt,Je){function vt(Et,Wt){var Ot=0,ir=0,vr=32854;if(typeof Et=="object"&&Et?("shape"in Et?(ir=Et.shape,Ot=ir[0]|0,ir=ir[1]|0):("radius"in Et&&(Ot=ir=Et.radius|0),"width"in Et&&(Ot=Et.width|0),"height"in Et&&(ir=Et.height|0)),"format"in Et&&(vr=Me[Et.format])):typeof Et=="number"?(Ot=Et|0,ir=typeof Wt=="number"?Wt|0:Ot):Et||(Ot=ir=1),Ot!==bt.width||ir!==bt.height||vr!==bt.format)return vt.width=bt.width=Ot,vt.height=bt.height=ir,bt.format=vr,lt.bindRenderbuffer(36161,bt.renderbuffer),lt.renderbufferStorage(36161,vr,Ot,ir),gr.profile&&(bt.stats.size=nt[bt.format]*bt.width*bt.height),vt.format=Ne[bt.format],vt}var bt=new tt(lt.createRenderbuffer());return Ke[bt.id]=bt,Nt.renderbufferCount++,vt(rt,Je),vt.resize=function(Et,Wt){var Ot=Et|0,ir=Wt|0||Ot;return Ot===bt.width&&ir===bt.height||(vt.width=bt.width=Ot,vt.height=bt.height=ir,lt.bindRenderbuffer(36161,bt.renderbuffer),lt.renderbufferStorage(36161,bt.format,Ot,ir),gr.profile&&(bt.stats.size=nt[bt.format]*bt.width*bt.height)),vt},vt._reglType="renderbuffer",vt._renderbuffer=bt,gr.profile&&(vt.stats=bt.stats),vt.destroy=function(){bt.decRef()},vt},clear:function(){Le(Ke).forEach(we)},restore:function(){Le(Ke).forEach(function(rt){rt.renderbuffer=lt.createRenderbuffer(),lt.bindRenderbuffer(36161,rt.renderbuffer),lt.renderbufferStorage(36161,rt.format,rt.width,rt.height)}),lt.bindRenderbuffer(36161,null)}}},wt=[];wt[6408]=4,wt[6407]=3;var Vt=[];Vt[5121]=1,Vt[5126]=4,Vt[36193]=2;var qt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],zt=["x","y","z","w"],Ht="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),$t={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Qt={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},fr={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},jr={cw:2304,ccw:2305},cn=new J(!1,!1,!1,function(){}),Qr=function(lt,Gt){function Kt(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function Nt(Ke,rt,Je){var vt=we.pop()||new Kt;vt.startQueryIndex=Ke,vt.endQueryIndex=rt,vt.sum=0,vt.stats=Je,Me.push(vt)}if(!Gt.ext_disjoint_timer_query)return null;var gr=[],tt=[],we=[],Me=[],Ne=[],Xe=[];return{beginQuery:function(Ke){var rt=gr.pop()||Gt.ext_disjoint_timer_query.createQueryEXT();Gt.ext_disjoint_timer_query.beginQueryEXT(35007,rt),tt.push(rt),Nt(tt.length-1,tt.length,Ke)},endQuery:function(){Gt.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:Nt,update:function(){var Ke,rt;if(Ke=tt.length,Ke!==0){Xe.length=Math.max(Xe.length,Ke+1),Ne.length=Math.max(Ne.length,Ke+1),Ne[0]=0;var Je=Xe[0]=0;for(rt=Ke=0;rt<tt.length;++rt){var vt=tt[rt];Gt.ext_disjoint_timer_query.getQueryObjectEXT(vt,34919)?(Je+=Gt.ext_disjoint_timer_query.getQueryObjectEXT(vt,34918),gr.push(vt)):tt[Ke++]=vt,Ne[rt+1]=Je,Xe[rt+1]=Ke}for(tt.length=Ke,rt=Ke=0;rt<Me.length;++rt){var Je=Me[rt],bt=Je.startQueryIndex,vt=Je.endQueryIndex;Je.sum+=Ne[vt]-Ne[bt],bt=Xe[bt],vt=Xe[vt],vt===bt?(Je.stats.gpuTime+=Je.sum/1e6,we.push(Je)):(Je.startQueryIndex=bt,Je.endQueryIndex=vt,Me[Ke++]=Je)}Me.length=Ke}},getNumPendingQueries:function(){return tt.length},clear:function(){gr.push.apply(gr,tt);for(var Ke=0;Ke<gr.length;Ke++)Gt.ext_disjoint_timer_query.deleteQueryEXT(gr[Ke]);tt.length=0,gr.length=0},restore:function(){tt.length=0,gr.length=0}}};return function(lt){function Gt(){if(Rr.length===0)vr&&vr.update(),Sn=null;else{Sn=xe.next(Gt),Ke();for(var Bn=Rr.length-1;0<=Bn;--Bn){var Xn=Rr[Bn];Xn&&Xn(Cr,null,0)}vt.flush(),vr&&vr.update()}}function Kt(){!Sn&&0<Rr.length&&(Sn=xe.next(Gt))}function Nt(){Sn&&(xe.cancel(Gt),Sn=null)}function gr(Bn){Bn.preventDefault(),Nt(),Ar.forEach(function(Xn){Xn()})}function tt(Bn){vt.getError(),Et.restore(),zr.restore(),yr.restore(),Sr.restore(),ot.restore(),Lt.restore(),Or.restore(),vr&&vr.restore(),Xt.procs.refresh(),Kt(),Kr.forEach(function(Xn){Xn()})}function we(Bn){function Xn(Tn,Vn){var oa={},na={};return Object.keys(Tn).forEach(function(On){var ta=Tn[On];if(pe.isDynamic(ta))na[On]=pe.unbox(ta,On);else{if(Vn&&Array.isArray(ta)){for(var Ua=0;Ua<ta.length;++Ua)if(pe.isDynamic(ta[Ua])){na[On]=pe.unbox(ta,On);return}}oa[On]=ta}}),{dynamic:na,static:oa}}function ea(Tn){for(;hn.length<Tn;)hn.push(null);return hn}var ka=Xn(Bn.context||{},!0),Ya=Xn(Bn.uniforms||{},!0),fi=Xn(Bn.attributes||{},!1);Bn=Xn(function(Tn){function Vn(na){if(na in oa){var On=oa[na];delete oa[na],Object.keys(On).forEach(function(ta){oa[na+"."+ta]=On[ta]})}}var oa=le({},Tn);return delete oa.uniforms,delete oa.attributes,delete oa.context,delete oa.vao,"stencil"in oa&&oa.stencil.op&&(oa.stencil.opBack=oa.stencil.opFront=oa.stencil.op,delete oa.stencil.op),Vn("blend"),Vn("depth"),Vn("cull"),Vn("stencil"),Vn("polygonOffset"),Vn("scissor"),Vn("sample"),"vao"in Tn&&(oa.vao=Tn.vao),oa}(Bn),!1);var pi={gpuTime:0,cpuTime:0,count:0},hi=Xt.compile(Bn,fi,Ya,ka,pi),Ka=hi.draw,wr=hi.batch,gn=hi.scope,hn=[];return le(function(Tn,Vn){var oa;if(typeof Tn=="function")return gn.call(this,null,Tn,0);if(typeof Vn=="function")if(typeof Tn=="number")for(oa=0;oa<Tn;++oa)gn.call(this,null,Vn,oa);else if(Array.isArray(Tn))for(oa=0;oa<Tn.length;++oa)gn.call(this,Tn[oa],Vn,oa);else return gn.call(this,Tn,Vn,0);else if(typeof Tn=="number"){if(0<Tn)return wr.call(this,ea(Tn|0),Tn|0)}else if(Array.isArray(Tn)){if(Tn.length)return wr.call(this,Tn,Tn.length)}else return Ka.call(this,Tn)},{stats:pi,destroy:function(){hi.destroy()}})}function Me(Bn,Xn){var ea=0;Xt.procs.poll();var ka=Xn.color;ka&&(vt.clearColor(+ka[0]||0,+ka[1]||0,+ka[2]||0,+ka[3]||0),ea|=16384),"depth"in Xn&&(vt.clearDepth(+Xn.depth),ea|=256),"stencil"in Xn&&(vt.clearStencil(Xn.stencil|0),ea|=1024),vt.clear(ea)}function Ne(Bn){return Rr.push(Bn),Kt(),{cancel:function(){function Xn(){var ka=ne(Rr,Xn);Rr[ka]=Rr[Rr.length-1],--Rr.length,0>=Rr.length&&Nt()}var ea=ne(Rr,Bn);Rr[ea]=Xn}}}function Xe(){var Bn=Lr.viewport,Xn=Lr.scissor_box;Bn[0]=Bn[1]=Xn[0]=Xn[1]=0,Cr.viewportWidth=Cr.framebufferWidth=Cr.drawingBufferWidth=Bn[2]=Xn[2]=vt.drawingBufferWidth,Cr.viewportHeight=Cr.framebufferHeight=Cr.drawingBufferHeight=Bn[3]=Xn[3]=vt.drawingBufferHeight}function Ke(){Cr.tick+=1,Cr.time=Je(),Xe(),Xt.procs.poll()}function rt(){Sr.refresh(),Xe(),Xt.procs.refresh(),vr&&vr.update()}function Je(){return(Ee()-_r)/1e3}if(lt=i(lt),!lt)return null;var vt=lt.gl,bt=vt.getContextAttributes();vt.isContextLost();var Et=n(vt,lt);if(!Et)return null;var tr=e(),Wt={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},Ot=lt.cachedCode||{},ir=Et.extensions,vr=Qr(vt,ir),_r=Ee(),Gr=vt.drawingBufferWidth,ln=vt.drawingBufferHeight,Cr={tick:0,time:0,viewportWidth:Gr,viewportHeight:ln,framebufferWidth:Gr,framebufferHeight:ln,drawingBufferWidth:Gr,drawingBufferHeight:ln,pixelRatio:lt.pixelRatio},Gr={elements:null,primitive:4,count:-1,offset:0,instances:-1},sn=de(vt,ir),yr=y(vt,Wt,lt,function(Bn){return Or.destroyBuffer(Bn)}),mr=T(vt,ir,yr,Wt),Or=D(vt,ir,sn,Wt,yr,mr,Gr),zr=B(vt,tr,Wt,lt),Sr=O(vt,ir,sn,function(){Xt.procs.poll()},Cr,Wt,lt),ot=kt(vt,ir,sn,Wt,lt),Lt=I(vt,ir,sn,Sr,ot,Wt),Xt=Z(vt,tr,ir,sn,yr,mr,Sr,Lt,{},Or,zr,Gr,Cr,vr,Ot,lt),tr=U(vt,Lt,Xt.procs.poll,Cr,bt,ir,sn),Lr=Xt.next,Nr=vt.canvas,Rr=[],Ar=[],Kr=[],Dn=[lt.onDestroy],Sn=null;Nr&&(Nr.addEventListener("webglcontextlost",gr,!1),Nr.addEventListener("webglcontextrestored",tt,!1));var Jn=Lt.setFBO=we({framebuffer:pe.define.call(null,1,"framebuffer")});return rt(),bt=le(we,{clear:function(Bn){if("framebuffer"in Bn)if(Bn.framebuffer&&Bn.framebuffer_reglType==="framebufferCube")for(var Xn=0;6>Xn;++Xn)Jn(le({framebuffer:Bn.framebuffer.faces[Xn]},Bn),Me);else Jn(Bn,Me);else Me(null,Bn)},prop:pe.define.bind(null,1),context:pe.define.bind(null,2),this:pe.define.bind(null,3),draw:we({}),buffer:function(Bn){return yr.create(Bn,34962,!1,!1)},elements:function(Bn){return mr.create(Bn,!1)},texture:Sr.create2D,cube:Sr.createCube,renderbuffer:ot.create,framebuffer:Lt.create,framebufferCube:Lt.createCube,vao:Or.createVAO,attributes:bt,frame:Ne,on:function(Bn,Xn){var ea;switch(Bn){case"frame":return Ne(Xn);case"lost":ea=Ar;break;case"restore":ea=Kr;break;case"destroy":ea=Dn}return ea.push(Xn),{cancel:function(){for(var ka=0;ka<ea.length;++ka)if(ea[ka]===Xn){ea[ka]=ea[ea.length-1],ea.pop();break}}}},limits:sn,hasExtension:function(Bn){return 0<=sn.extensions.indexOf(Bn.toLowerCase())},read:tr,destroy:function(){Rr.length=0,Nt(),Nr&&(Nr.removeEventListener("webglcontextlost",gr),Nr.removeEventListener("webglcontextrestored",tt)),zr.clear(),Lt.clear(),ot.clear(),Or.clear(),Sr.clear(),mr.clear(),yr.clear(),vr&&vr.clear(),Dn.forEach(function(Bn){Bn()})},_gl:vt,_refresh:rt,poll:function(){Ke(),vr&&vr.update()},now:Je,stats:Wt,getCachedCode:function(){return Ot},preloadCachedCode:function(Bn){Object.entries(Bn).forEach(function(Xn){Ot[Xn[0]]=Xn[1]})}}),lt.onDone(null,bt),bt}})},{}],284:[function(c,ae,ie){var b=c("buffer"),k=b.Buffer;function P(e,p){for(var g in e)p[g]=e[g]}k.from&&k.alloc&&k.allocUnsafe&&k.allocUnsafeSlow?ae.exports=b:(P(b,ie),ie.Buffer=E);function E(e,p,g){return k(e,p,g)}E.prototype=Object.create(k.prototype),P(k,E),E.from=function(e,p,g){if(typeof e=="number")throw new TypeError("Argument must not be a number");return k(e,p,g)},E.alloc=function(e,p,g){if(typeof e!="number")throw new TypeError("Argument must be a number");var a=k(e);return p!==void 0?typeof g=="string"?a.fill(p,g):a.fill(p):a.fill(0),a},E.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return k(e)},E.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return b.SlowBuffer(e)}},{buffer:85}],285:[function(c,ae,ie){ae.exports=P;var b=c("events").EventEmitter,k=c("inherits");k(P,b),P.Readable=c("readable-stream/lib/_stream_readable.js"),P.Writable=c("readable-stream/lib/_stream_writable.js"),P.Duplex=c("readable-stream/lib/_stream_duplex.js"),P.Transform=c("readable-stream/lib/_stream_transform.js"),P.PassThrough=c("readable-stream/lib/_stream_passthrough.js"),P.finished=c("readable-stream/lib/internal/streams/end-of-stream.js"),P.pipeline=c("readable-stream/lib/internal/streams/pipeline.js"),P.Stream=P;function P(){b.call(this)}P.prototype.pipe=function(E,e){var p=this;function g(s){E.writable&&E.write(s)===!1&&p.pause&&p.pause()}p.on("data",g);function a(){p.readable&&p.resume&&p.resume()}E.on("drain",a),!E._isStdio&&(!e||e.end!==!1)&&(p.on("end",i),p.on("close",n));var t=!1;function i(){t||(t=!0,E.end())}function n(){t||(t=!0,typeof E.destroy=="function"&&E.destroy())}function r(s){if(d(),b.listenerCount(this,"error")===0)throw s}p.on("error",r),E.on("error",r);function d(){p.removeListener("data",g),E.removeListener("drain",a),p.removeListener("end",i),p.removeListener("close",n),p.removeListener("error",r),E.removeListener("error",r),p.removeListener("end",d),p.removeListener("close",d),E.removeListener("close",d)}return p.on("end",d),p.on("close",d),E.on("close",d),E.emit("pipe",p),E}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":287,"readable-stream/lib/_stream_passthrough.js":288,"readable-stream/lib/_stream_readable.js":289,"readable-stream/lib/_stream_transform.js":290,"readable-stream/lib/_stream_writable.js":291,"readable-stream/lib/internal/streams/end-of-stream.js":295,"readable-stream/lib/internal/streams/pipeline.js":297}],286:[function(c,ae,ie){"use strict";function b(a,t){a.prototype=Object.create(t.prototype),a.prototype.constructor=a,a.__proto__=t}var k={};function P(a,t,i){i||(i=Error);function n(d,s,m){return typeof t=="string"?t:t(d,s,m)}var r=function(d){b(s,d);function s(m,x,M){return d.call(this,n(m,x,M))||this}return s}(i);r.prototype.name=i.name,r.prototype.code=a,k[a]=r}function E(a,t){if(Array.isArray(a)){var i=a.length;return a=a.map(function(n){return String(n)}),i>2?"one of ".concat(t," ").concat(a.slice(0,i-1).join(", "),", or ")+a[i-1]:i===2?"one of ".concat(t," ").concat(a[0]," or ").concat(a[1]):"of ".concat(t," ").concat(a[0])}else return"of ".concat(t," ").concat(String(a))}function e(a,t,i){return a.substr(!i||i<0?0:+i,t.length)===t}function p(a,t,i){return(i===void 0||i>a.length)&&(i=a.length),a.substring(i-t.length,i)===t}function g(a,t,i){return typeof i!="number"&&(i=0),i+t.length>a.length?!1:a.indexOf(t,i)!==-1}P("ERR_INVALID_OPT_VALUE",function(a,t){return'The value "'+t+'" is invalid for option "'+a+'"'},TypeError),P("ERR_INVALID_ARG_TYPE",function(a,t,i){var n;typeof t=="string"&&e(t,"not ")?(n="must not be",t=t.replace(/^not /,"")):n="must be";var r;if(p(a," argument"))r="The ".concat(a," ").concat(n," ").concat(E(t,"type"));else{var d=g(a,".")?"property":"argument";r='The "'.concat(a,'" ').concat(d," ").concat(n," ").concat(E(t,"type"))}return r+=". Received type ".concat(typeof i),r},TypeError),P("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),P("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),P("ERR_STREAM_PREMATURE_CLOSE","Premature close"),P("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),P("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),P("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),P("ERR_STREAM_WRITE_AFTER_END","write after end"),P("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),P("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),P("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),ae.exports.codes=k},{}],287:[function(c,ae,ie){(function(b){(function(){"use strict";var k=Object.keys||function(n){var r=[];for(var d in n)r.push(d);return r};ae.exports=a;var P=c("./_stream_readable"),E=c("./_stream_writable");c("inherits")(a,P);for(var e=k(E.prototype),p=0;p<e.length;p++){var g=e[p];a.prototype[g]||(a.prototype[g]=E.prototype[g])}function a(n){if(!(this instanceof a))return new a(n);P.call(this,n),E.call(this,n),this.allowHalfOpen=!0,n&&(n.readable===!1&&(this.readable=!1),n.writable===!1&&(this.writable=!1),n.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",t)))}Object.defineProperty(a.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(a.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(a.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function t(){this._writableState.ended||b.nextTick(i,this)}function i(n){n.end()}Object.defineProperty(a.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(r){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=r,this._writableState.destroyed=r)}})}).call(this)}).call(this,c("_process"))},{"./_stream_readable":289,"./_stream_writable":291,_process:277,inherits:231}],288:[function(c,ae,ie){"use strict";ae.exports=k;var b=c("./_stream_transform");c("inherits")(k,b);function k(P){if(!(this instanceof k))return new k(P);b.call(this,P)}k.prototype._transform=function(P,E,e){e(null,P)}},{"./_stream_transform":290,inherits:231}],289:[function(c,ae,ie){(function(b,k){(function(){"use strict";ae.exports=S;var P;S.ReadableState=o;var E=c("events").EventEmitter,e=function(Z,ne){return Z.listeners(ne).length},p=c("./internal/streams/stream"),g=c("buffer").Buffer,a=k.Uint8Array||function(){};function t(j){return g.from(j)}function i(j){return g.isBuffer(j)||j instanceof a}var n=c("util"),r;n&&n.debuglog?r=n.debuglog("stream"):r=function(){};var d=c("./internal/streams/buffer_list"),s=c("./internal/streams/destroy"),m=c("./internal/streams/state"),x=m.getHighWaterMark,M=c("../errors").codes,v=M.ERR_INVALID_ARG_TYPE,_=M.ERR_STREAM_PUSH_AFTER_EOF,l=M.ERR_METHOD_NOT_IMPLEMENTED,y=M.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,T,w,A;c("inherits")(S,p);var f=s.errorOrDestroy,u=["error","close","destroy","pause","resume"];function h(j,Z,ne){if(typeof j.prependListener=="function")return j.prependListener(Z,ne);!j._events||!j._events[Z]?j.on(Z,ne):Array.isArray(j._events[Z])?j._events[Z].unshift(ne):j._events[Z]=[ne,j._events[Z]]}function o(j,Z,ne){P=P||c("./_stream_duplex"),j=j||{},typeof ne!="boolean"&&(ne=Z instanceof P),this.objectMode=!!j.objectMode,ne&&(this.objectMode=this.objectMode||!!j.readableObjectMode),this.highWaterMark=x(this,j,"readableHighWaterMark",ne),this.buffer=new d,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=j.emitClose!==!1,this.autoDestroy=!!j.autoDestroy,this.destroyed=!1,this.defaultEncoding=j.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,j.encoding&&(T||(T=c("string_decoder/").StringDecoder),this.decoder=new T(j.encoding),this.encoding=j.encoding)}function S(j){if(P=P||c("./_stream_duplex"),!(this instanceof S))return new S(j);var Z=this instanceof P;this._readableState=new o(j,this,Z),this.readable=!0,j&&(typeof j.read=="function"&&(this._read=j.read),typeof j.destroy=="function"&&(this._destroy=j.destroy)),p.call(this)}Object.defineProperty(S.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(Z){!this._readableState||(this._readableState.destroyed=Z)}}),S.prototype.destroy=s.destroy,S.prototype._undestroy=s.undestroy,S.prototype._destroy=function(j,Z){Z(j)},S.prototype.push=function(j,Z){var ne=this._readableState,le;return ne.objectMode?le=!0:typeof j=="string"&&(Z=Z||ne.defaultEncoding,Z!==ne.encoding&&(j=g.from(j,Z),Z=""),le=!0),R(this,j,Z,!1,le)},S.prototype.unshift=function(j){return R(this,j,null,!0,!1)};function R(j,Z,ne,le,ge){r("readableAddChunk",Z);var pe=j._readableState;if(Z===null)pe.reading=!1,B(j,pe);else{var xe;if(ge||(xe=O(pe,Z)),xe)f(j,xe);else if(pe.objectMode||Z&&Z.length>0)if(typeof Z!="string"&&!pe.objectMode&&Object.getPrototypeOf(Z)!==g.prototype&&(Z=t(Z)),le)pe.endEmitted?f(j,new y):z(j,pe,Z,!0);else if(pe.ended)f(j,new _);else{if(pe.destroyed)return!1;pe.reading=!1,pe.decoder&&!ne?(Z=pe.decoder.write(Z),pe.objectMode||Z.length!==0?z(j,pe,Z,!1):oe(j,pe)):z(j,pe,Z,!1)}else le||(pe.reading=!1,oe(j,pe))}return!pe.ended&&(pe.length<pe.highWaterMark||pe.length===0)}function z(j,Z,ne,le){Z.flowing&&Z.length===0&&!Z.sync?(Z.awaitDrain=0,j.emit("data",ne)):(Z.length+=Z.objectMode?1:ne.length,le?Z.buffer.unshift(ne):Z.buffer.push(ne),Z.needReadable&&U(j)),oe(j,Z)}function O(j,Z){var ne;return!i(Z)&&typeof Z!="string"&&Z!==void 0&&!j.objectMode&&(ne=new v("chunk",["string","Buffer","Uint8Array"],Z)),ne}S.prototype.isPaused=function(){return this._readableState.flowing===!1},S.prototype.setEncoding=function(j){T||(T=c("string_decoder/").StringDecoder);var Z=new T(j);this._readableState.decoder=Z,this._readableState.encoding=this._readableState.decoder.encoding;for(var ne=this._readableState.buffer.head,le="";ne!==null;)le+=Z.write(ne.data),ne=ne.next;return this._readableState.buffer.clear(),le!==""&&this._readableState.buffer.push(le),this._readableState.length=le.length,this};var I=1073741824;function F(j){return j>=I?j=I:(j--,j|=j>>>1,j|=j>>>2,j|=j>>>4,j|=j>>>8,j|=j>>>16,j++),j}function D(j,Z){return j<=0||Z.length===0&&Z.ended?0:Z.objectMode?1:j!==j?Z.flowing&&Z.length?Z.buffer.head.data.length:Z.length:(j>Z.highWaterMark&&(Z.highWaterMark=F(j)),j<=Z.length?j:Z.ended?Z.length:(Z.needReadable=!0,0))}S.prototype.read=function(j){r("read",j),j=parseInt(j,10);var Z=this._readableState,ne=j;if(j!==0&&(Z.emittedReadable=!1),j===0&&Z.needReadable&&((Z.highWaterMark!==0?Z.length>=Z.highWaterMark:Z.length>0)||Z.ended))return r("read: emitReadable",Z.length,Z.ended),Z.length===0&&Z.ended?J(this):U(this),null;if(j=D(j,Z),j===0&&Z.ended)return Z.length===0&&J(this),null;var le=Z.needReadable;r("need readable",le),(Z.length===0||Z.length-j<Z.highWaterMark)&&(le=!0,r("length less than watermark",le)),Z.ended||Z.reading?(le=!1,r("reading or ended",le)):le&&(r("do read"),Z.reading=!0,Z.sync=!0,Z.length===0&&(Z.needReadable=!0),this._read(Z.highWaterMark),Z.sync=!1,Z.reading||(j=D(ne,Z)));var ge;return j>0?ge=ee(j,Z):ge=null,ge===null?(Z.needReadable=Z.length<=Z.highWaterMark,j=0):(Z.length-=j,Z.awaitDrain=0),Z.length===0&&(Z.ended||(Z.needReadable=!0),ne!==j&&Z.ended&&J(this)),ge!==null&&this.emit("data",ge),ge};function B(j,Z){if(r("onEofChunk"),!Z.ended){if(Z.decoder){var ne=Z.decoder.end();ne&&ne.length&&(Z.buffer.push(ne),Z.length+=Z.objectMode?1:ne.length)}Z.ended=!0,Z.sync?U(j):(Z.needReadable=!1,Z.emittedReadable||(Z.emittedReadable=!0,X(j)))}}function U(j){var Z=j._readableState;r("emitReadable",Z.needReadable,Z.emittedReadable),Z.needReadable=!1,Z.emittedReadable||(r("emitReadable",Z.flowing),Z.emittedReadable=!0,b.nextTick(X,j))}function X(j){var Z=j._readableState;r("emitReadable_",Z.destroyed,Z.length,Z.ended),!Z.destroyed&&(Z.length||Z.ended)&&(j.emit("readable"),Z.emittedReadable=!1),Z.needReadable=!Z.flowing&&!Z.ended&&Z.length<=Z.highWaterMark,H(j)}function oe(j,Z){Z.readingMore||(Z.readingMore=!0,b.nextTick(se,j,Z))}function se(j,Z){for(;!Z.reading&&!Z.ended&&(Z.length<Z.highWaterMark||Z.flowing&&Z.length===0);){var ne=Z.length;if(r("maybeReadMore read 0"),j.read(0),ne===Z.length)break}Z.readingMore=!1}S.prototype._read=function(j){f(this,new l("_read()"))},S.prototype.pipe=function(j,Z){var ne=this,le=this._readableState;switch(le.pipesCount){case 0:le.pipes=j;break;case 1:le.pipes=[le.pipes,j];break;default:le.pipes.push(j);break}le.pipesCount+=1,r("pipe count=%d opts=%j",le.pipesCount,Z);var ge=(!Z||Z.end!==!1)&&j!==b.stdout&&j!==b.stderr,pe=ge?Ee:Oe;le.endEmitted?b.nextTick(pe):ne.once("end",pe),j.on("unpipe",xe);function xe(Qe,Ve){r("onunpipe"),Qe===ne&&Ve&&Ve.hasUnpiped===!1&&(Ve.hasUnpiped=!0,be())}function Ee(){r("onend"),j.end()}var Te=q(ne);j.on("drain",Te);var de=!1;function be(){r("cleanup"),j.removeListener("close",ye),j.removeListener("finish",ke),j.removeListener("drain",Te),j.removeListener("error",De),j.removeListener("unpipe",xe),ne.removeListener("end",Ee),ne.removeListener("end",Oe),ne.removeListener("data",Le),de=!0,le.awaitDrain&&(!j._writableState||j._writableState.needDrain)&&Te()}ne.on("data",Le);function Le(Qe){r("ondata");var Ve=j.write(Qe);r("dest.write",Ve),Ve===!1&&((le.pipesCount===1&&le.pipes===j||le.pipesCount>1&&re(le.pipes,j)!==-1)&&!de&&(r("false write response, pause",le.awaitDrain),le.awaitDrain++),ne.pause())}function De(Qe){r("onerror",Qe),Oe(),j.removeListener("error",De),e(j,"error")===0&&f(j,Qe)}h(j,"error",De);function ye(){j.removeListener("finish",ke),Oe()}j.once("close",ye);function ke(){r("onfinish"),j.removeListener("close",ye),Oe()}j.once("finish",ke);function Oe(){r("unpipe"),ne.unpipe(j)}return j.emit("pipe",ne),le.flowing||(r("pipe resume"),ne.resume()),j};function q(j){return function(){var ne=j._readableState;r("pipeOnDrain",ne.awaitDrain),ne.awaitDrain&&ne.awaitDrain--,ne.awaitDrain===0&&e(j,"data")&&(ne.flowing=!0,H(j))}}S.prototype.unpipe=function(j){var Z=this._readableState,ne={hasUnpiped:!1};if(Z.pipesCount===0)return this;if(Z.pipesCount===1)return j&&j!==Z.pipes?this:(j||(j=Z.pipes),Z.pipes=null,Z.pipesCount=0,Z.flowing=!1,j&&j.emit("unpipe",this,ne),this);if(!j){var le=Z.pipes,ge=Z.pipesCount;Z.pipes=null,Z.pipesCount=0,Z.flowing=!1;for(var pe=0;pe<ge;pe++)le[pe].emit("unpipe",this,{hasUnpiped:!1});return this}var xe=re(Z.pipes,j);return xe===-1?this:(Z.pipes.splice(xe,1),Z.pipesCount-=1,Z.pipesCount===1&&(Z.pipes=Z.pipes[0]),j.emit("unpipe",this,ne),this)},S.prototype.on=function(j,Z){var ne=p.prototype.on.call(this,j,Z),le=this._readableState;return j==="data"?(le.readableListening=this.listenerCount("readable")>0,le.flowing!==!1&&this.resume()):j==="readable"&&!le.endEmitted&&!le.readableListening&&(le.readableListening=le.needReadable=!0,le.flowing=!1,le.emittedReadable=!1,r("on readable",le.length,le.reading),le.length?U(this):le.reading||b.nextTick(G,this)),ne},S.prototype.addListener=S.prototype.on,S.prototype.removeListener=function(j,Z){var ne=p.prototype.removeListener.call(this,j,Z);return j==="readable"&&b.nextTick(K,this),ne},S.prototype.removeAllListeners=function(j){var Z=p.prototype.removeAllListeners.apply(this,arguments);return(j==="readable"||j===void 0)&&b.nextTick(K,this),Z};function K(j){var Z=j._readableState;Z.readableListening=j.listenerCount("readable")>0,Z.resumeScheduled&&!Z.paused?Z.flowing=!0:j.listenerCount("data")>0&&j.resume()}function G(j){r("readable nexttick read 0"),j.read(0)}S.prototype.resume=function(){var j=this._readableState;return j.flowing||(r("resume"),j.flowing=!j.readableListening,Q(this,j)),j.paused=!1,this};function Q(j,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,b.nextTick(V,j,Z))}function V(j,Z){r("resume",Z.reading),Z.reading||j.read(0),Z.resumeScheduled=!1,j.emit("resume"),H(j),Z.flowing&&!Z.reading&&j.read(0)}S.prototype.pause=function(){return r("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(r("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function H(j){var Z=j._readableState;for(r("flow",Z.flowing);Z.flowing&&j.read()!==null;);}S.prototype.wrap=function(j){var Z=this,ne=this._readableState,le=!1;j.on("end",function(){if(r("wrapped end"),ne.decoder&&!ne.ended){var xe=ne.decoder.end();xe&&xe.length&&Z.push(xe)}Z.push(null)}),j.on("data",function(xe){if(r("wrapped data"),ne.decoder&&(xe=ne.decoder.write(xe)),!(ne.objectMode&&xe==null)&&!(!ne.objectMode&&(!xe||!xe.length))){var Ee=Z.push(xe);Ee||(le=!0,j.pause())}});for(var ge in j)this[ge]===void 0&&typeof j[ge]=="function"&&(this[ge]=function(Ee){return function(){return j[Ee].apply(j,arguments)}}(ge));for(var pe=0;pe<u.length;pe++)j.on(u[pe],this.emit.bind(this,u[pe]));return this._read=function(xe){r("wrapped _read",xe),le&&(le=!1,j.resume())},this},typeof Symbol=="function"&&(S.prototype[Symbol.asyncIterator]=function(){return w===void 0&&(w=c("./internal/streams/async_iterator")),w(this)}),Object.defineProperty(S.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(S.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(S.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(Z){this._readableState&&(this._readableState.flowing=Z)}}),S._fromList=ee,Object.defineProperty(S.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function ee(j,Z){if(Z.length===0)return null;var ne;return Z.objectMode?ne=Z.buffer.shift():!j||j>=Z.length?(Z.decoder?ne=Z.buffer.join(""):Z.buffer.length===1?ne=Z.buffer.first():ne=Z.buffer.concat(Z.length),Z.buffer.clear()):ne=Z.buffer.consume(j,Z.decoder),ne}function J(j){var Z=j._readableState;r("endReadable",Z.endEmitted),Z.endEmitted||(Z.ended=!0,b.nextTick(W,Z,j))}function W(j,Z){if(r("endReadableNT",j.endEmitted,j.length),!j.endEmitted&&j.length===0&&(j.endEmitted=!0,Z.readable=!1,Z.emit("end"),j.autoDestroy)){var ne=Z._writableState;(!ne||ne.autoDestroy&&ne.finished)&&Z.destroy()}}typeof Symbol=="function"&&(S.from=function(j,Z){return A===void 0&&(A=c("./internal/streams/from")),A(S,j,Z)});function re(j,Z){for(var ne=0,le=j.length;ne<le;ne++)if(j[ne]===Z)return ne;return-1}}).call(this)}).call(this,c("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":286,"./_stream_duplex":287,"./internal/streams/async_iterator":292,"./internal/streams/buffer_list":293,"./internal/streams/destroy":294,"./internal/streams/from":296,"./internal/streams/state":298,"./internal/streams/stream":299,_process:277,buffer:85,events:84,inherits:231,"string_decoder/":300,util:83}],290:[function(c,ae,ie){"use strict";ae.exports=a;var b=c("../errors").codes,k=b.ERR_METHOD_NOT_IMPLEMENTED,P=b.ERR_MULTIPLE_CALLBACK,E=b.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=b.ERR_TRANSFORM_WITH_LENGTH_0,p=c("./_stream_duplex");c("inherits")(a,p);function g(n,r){var d=this._transformState;d.transforming=!1;var s=d.writecb;if(s===null)return this.emit("error",new P);d.writechunk=null,d.writecb=null,r!=null&&this.push(r),s(n);var m=this._readableState;m.reading=!1,(m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}function a(n){if(!(this instanceof a))return new a(n);p.call(this,n),this._transformState={afterTransform:g.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,n&&(typeof n.transform=="function"&&(this._transform=n.transform),typeof n.flush=="function"&&(this._flush=n.flush)),this.on("prefinish",t)}function t(){var n=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(r,d){i(n,r,d)}):i(this,null,null)}a.prototype.push=function(n,r){return this._transformState.needTransform=!1,p.prototype.push.call(this,n,r)},a.prototype._transform=function(n,r,d){d(new k("_transform()"))},a.prototype._write=function(n,r,d){var s=this._transformState;if(s.writecb=d,s.writechunk=n,s.writeencoding=r,!s.transforming){var m=this._readableState;(s.needTransform||m.needReadable||m.length<m.highWaterMark)&&this._read(m.highWaterMark)}},a.prototype._read=function(n){var r=this._transformState;r.writechunk!==null&&!r.transforming?(r.transforming=!0,this._transform(r.writechunk,r.writeencoding,r.afterTransform)):r.needTransform=!0},a.prototype._destroy=function(n,r){p.prototype._destroy.call(this,n,function(d){r(d)})};function i(n,r,d){if(r)return n.emit("error",r);if(d!=null&&n.push(d),n._writableState.length)throw new e;if(n._transformState.transforming)throw new E;return n.push(null)}},{"../errors":286,"./_stream_duplex":287,inherits:231}],291:[function(c,ae,ie){(function(b,k){(function(){"use strict";ae.exports=o;function P(H,ee,J){this.chunk=H,this.encoding=ee,this.callback=J,this.next=null}function E(H){var ee=this;this.next=null,this.entry=null,this.finish=function(){V(ee,H)}}var e;o.WritableState=u;var p={deprecate:c("util-deprecate")},g=c("./internal/streams/stream"),a=c("buffer").Buffer,t=k.Uint8Array||function(){};function i(H){return a.from(H)}function n(H){return a.isBuffer(H)||H instanceof t}var r=c("./internal/streams/destroy"),d=c("./internal/streams/state"),s=d.getHighWaterMark,m=c("../errors").codes,x=m.ERR_INVALID_ARG_TYPE,M=m.ERR_METHOD_NOT_IMPLEMENTED,v=m.ERR_MULTIPLE_CALLBACK,_=m.ERR_STREAM_CANNOT_PIPE,l=m.ERR_STREAM_DESTROYED,y=m.ERR_STREAM_NULL_VALUES,T=m.ERR_STREAM_WRITE_AFTER_END,w=m.ERR_UNKNOWN_ENCODING,A=r.errorOrDestroy;c("inherits")(o,g);function f(){}function u(H,ee,J){e=e||c("./_stream_duplex"),H=H||{},typeof J!="boolean"&&(J=ee instanceof e),this.objectMode=!!H.objectMode,J&&(this.objectMode=this.objectMode||!!H.writableObjectMode),this.highWaterMark=s(this,H,"writableHighWaterMark",J),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var W=H.decodeStrings===!1;this.decodeStrings=!W,this.defaultEncoding=H.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(re){B(ee,re)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=H.emitClose!==!1,this.autoDestroy=!!H.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new E(this)}u.prototype.getBuffer=function(){for(var ee=this.bufferedRequest,J=[];ee;)J.push(ee),ee=ee.next;return J},function(){try{Object.defineProperty(u.prototype,"buffer",{get:p.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var h;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(h=Function.prototype[Symbol.hasInstance],Object.defineProperty(o,Symbol.hasInstance,{value:function(ee){return h.call(this,ee)?!0:this!==o?!1:ee&&ee._writableState instanceof u}})):h=function(ee){return ee instanceof this};function o(H){e=e||c("./_stream_duplex");var ee=this instanceof e;if(!ee&&!h.call(o,this))return new o(H);this._writableState=new u(H,this,ee),this.writable=!0,H&&(typeof H.write=="function"&&(this._write=H.write),typeof H.writev=="function"&&(this._writev=H.writev),typeof H.destroy=="function"&&(this._destroy=H.destroy),typeof H.final=="function"&&(this._final=H.final)),g.call(this)}o.prototype.pipe=function(){A(this,new _)};function S(H,ee){var J=new T;A(H,J),b.nextTick(ee,J)}function R(H,ee,J,W){var re;return J===null?re=new y:typeof J!="string"&&!ee.objectMode&&(re=new x("chunk",["string","Buffer"],J)),re?(A(H,re),b.nextTick(W,re),!1):!0}o.prototype.write=function(H,ee,J){var W=this._writableState,re=!1,j=!W.objectMode&&n(H);return j&&!a.isBuffer(H)&&(H=i(H)),typeof ee=="function"&&(J=ee,ee=null),j?ee="buffer":ee||(ee=W.defaultEncoding),typeof J!="function"&&(J=f),W.ending?S(this,J):(j||R(this,W,H,J))&&(W.pendingcb++,re=O(this,W,j,H,ee,J)),re},o.prototype.cork=function(){this._writableState.corked++},o.prototype.uncork=function(){var H=this._writableState;H.corked&&(H.corked--,!H.writing&&!H.corked&&!H.bufferProcessing&&H.bufferedRequest&&oe(this,H))},o.prototype.setDefaultEncoding=function(ee){if(typeof ee=="string"&&(ee=ee.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((ee+"").toLowerCase())>-1))throw new w(ee);return this._writableState.defaultEncoding=ee,this},Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function z(H,ee,J){return!H.objectMode&&H.decodeStrings!==!1&&typeof ee=="string"&&(ee=a.from(ee,J)),ee}Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function O(H,ee,J,W,re,j){if(!J){var Z=z(ee,W,re);W!==Z&&(J=!0,re="buffer",W=Z)}var ne=ee.objectMode?1:W.length;ee.length+=ne;var le=ee.length<ee.highWaterMark;if(le||(ee.needDrain=!0),ee.writing||ee.corked){var ge=ee.lastBufferedRequest;ee.lastBufferedRequest={chunk:W,encoding:re,isBuf:J,callback:j,next:null},ge?ge.next=ee.lastBufferedRequest:ee.bufferedRequest=ee.lastBufferedRequest,ee.bufferedRequestCount+=1}else I(H,ee,!1,ne,W,re,j);return le}function I(H,ee,J,W,re,j,Z){ee.writelen=W,ee.writecb=Z,ee.writing=!0,ee.sync=!0,ee.destroyed?ee.onwrite(new l("write")):J?H._writev(re,ee.onwrite):H._write(re,j,ee.onwrite),ee.sync=!1}function F(H,ee,J,W,re){--ee.pendingcb,J?(b.nextTick(re,W),b.nextTick(G,H,ee),H._writableState.errorEmitted=!0,A(H,W)):(re(W),H._writableState.errorEmitted=!0,A(H,W),G(H,ee))}function D(H){H.writing=!1,H.writecb=null,H.length-=H.writelen,H.writelen=0}function B(H,ee){var J=H._writableState,W=J.sync,re=J.writecb;if(typeof re!="function")throw new v;if(D(J),ee)F(H,J,W,ee,re);else{var j=se(J)||H.destroyed;!j&&!J.corked&&!J.bufferProcessing&&J.bufferedRequest&&oe(H,J),W?b.nextTick(U,H,J,j,re):U(H,J,j,re)}}function U(H,ee,J,W){J||X(H,ee),ee.pendingcb--,W(),G(H,ee)}function X(H,ee){ee.length===0&&ee.needDrain&&(ee.needDrain=!1,H.emit("drain"))}function oe(H,ee){ee.bufferProcessing=!0;var J=ee.bufferedRequest;if(H._writev&&J&&J.next){var W=ee.bufferedRequestCount,re=new Array(W),j=ee.corkedRequestsFree;j.entry=J;for(var Z=0,ne=!0;J;)re[Z]=J,J.isBuf||(ne=!1),J=J.next,Z+=1;re.allBuffers=ne,I(H,ee,!0,ee.length,re,"",j.finish),ee.pendingcb++,ee.lastBufferedRequest=null,j.next?(ee.corkedRequestsFree=j.next,j.next=null):ee.corkedRequestsFree=new E(ee),ee.bufferedRequestCount=0}else{for(;J;){var le=J.chunk,ge=J.encoding,pe=J.callback,xe=ee.objectMode?1:le.length;if(I(H,ee,!1,xe,le,ge,pe),J=J.next,ee.bufferedRequestCount--,ee.writing)break}J===null&&(ee.lastBufferedRequest=null)}ee.bufferedRequest=J,ee.bufferProcessing=!1}o.prototype._write=function(H,ee,J){J(new M("_write()"))},o.prototype._writev=null,o.prototype.end=function(H,ee,J){var W=this._writableState;return typeof H=="function"?(J=H,H=null,ee=null):typeof ee=="function"&&(J=ee,ee=null),H!=null&&this.write(H,ee),W.corked&&(W.corked=1,this.uncork()),W.ending||Q(this,W,J),this},Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function se(H){return H.ending&&H.length===0&&H.bufferedRequest===null&&!H.finished&&!H.writing}function q(H,ee){H._final(function(J){ee.pendingcb--,J&&A(H,J),ee.prefinished=!0,H.emit("prefinish"),G(H,ee)})}function K(H,ee){!ee.prefinished&&!ee.finalCalled&&(typeof H._final=="function"&&!ee.destroyed?(ee.pendingcb++,ee.finalCalled=!0,b.nextTick(q,H,ee)):(ee.prefinished=!0,H.emit("prefinish")))}function G(H,ee){var J=se(ee);if(J&&(K(H,ee),ee.pendingcb===0&&(ee.finished=!0,H.emit("finish"),ee.autoDestroy))){var W=H._readableState;(!W||W.autoDestroy&&W.endEmitted)&&H.destroy()}return J}function Q(H,ee,J){ee.ending=!0,G(H,ee),J&&(ee.finished?b.nextTick(J):H.once("finish",J)),ee.ended=!0,H.writable=!1}function V(H,ee,J){var W=H.entry;for(H.entry=null;W;){var re=W.callback;ee.pendingcb--,re(J),W=W.next}ee.corkedRequestsFree.next=H}Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(ee){!this._writableState||(this._writableState.destroyed=ee)}}),o.prototype.destroy=r.destroy,o.prototype._undestroy=r.undestroy,o.prototype._destroy=function(H,ee){ee(H)}}).call(this)}).call(this,c("_process"),typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":286,"./_stream_duplex":287,"./internal/streams/destroy":294,"./internal/streams/state":298,"./internal/streams/stream":299,_process:277,buffer:85,inherits:231,"util-deprecate":330}],292:[function(c,ae,ie){(function(b){(function(){"use strict";var k;function P(_,l,y){return l in _?Object.defineProperty(_,l,{value:y,enumerable:!0,configurable:!0,writable:!0}):_[l]=y,_}var E=c("./end-of-stream"),e=Symbol("lastResolve"),p=Symbol("lastReject"),g=Symbol("error"),a=Symbol("ended"),t=Symbol("lastPromise"),i=Symbol("handlePromise"),n=Symbol("stream");function r(_,l){return{value:_,done:l}}function d(_){var l=_[e];if(l!==null){var y=_[n].read();y!==null&&(_[t]=null,_[e]=null,_[p]=null,l(r(y,!1)))}}function s(_){b.nextTick(d,_)}function m(_,l){return function(y,T){_.then(function(){if(l[a]){y(r(void 0,!0));return}l[i](y,T)},T)}}var x=Object.getPrototypeOf(function(){}),M=Object.setPrototypeOf((k={get stream(){return this[n]},next:function(){var l=this,y=this[g];if(y!==null)return Promise.reject(y);if(this[a])return Promise.resolve(r(void 0,!0));if(this[n].destroyed)return new Promise(function(f,u){b.nextTick(function(){l[g]?u(l[g]):f(r(void 0,!0))})});var T=this[t],w;if(T)w=new Promise(m(T,this));else{var A=this[n].read();if(A!==null)return Promise.resolve(r(A,!1));w=new Promise(this[i])}return this[t]=w,w}},P(k,Symbol.asyncIterator,function(){return this}),P(k,"return",function(){var l=this;return new Promise(function(y,T){l[n].destroy(null,function(w){if(w){T(w);return}y(r(void 0,!0))})})}),k),x),v=function(l){var y,T=Object.create(M,(y={},P(y,n,{value:l,writable:!0}),P(y,e,{value:null,writable:!0}),P(y,p,{value:null,writable:!0}),P(y,g,{value:null,writable:!0}),P(y,a,{value:l._readableState.endEmitted,writable:!0}),P(y,i,{value:function(A,f){var u=T[n].read();u?(T[t]=null,T[e]=null,T[p]=null,A(r(u,!1))):(T[e]=A,T[p]=f)},writable:!0}),y));return T[t]=null,E(l,function(w){if(w&&w.code!=="ERR_STREAM_PREMATURE_CLOSE"){var A=T[p];A!==null&&(T[t]=null,T[e]=null,T[p]=null,A(w)),T[g]=w;return}var f=T[e];f!==null&&(T[t]=null,T[e]=null,T[p]=null,f(r(void 0,!0))),T[a]=!0}),l.on("readable",s.bind(null,T)),T};ae.exports=v}).call(this)}).call(this,c("_process"))},{"./end-of-stream":295,_process:277}],293:[function(c,ae,ie){"use strict";function b(d,s){var m=Object.keys(d);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(d);s&&(x=x.filter(function(M){return Object.getOwnPropertyDescriptor(d,M).enumerable})),m.push.apply(m,x)}return m}function k(d){for(var s=1;s<arguments.length;s++){var m=arguments[s]!=null?arguments[s]:{};s%2?b(Object(m),!0).forEach(function(x){P(d,x,m[x])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(m)):b(Object(m)).forEach(function(x){Object.defineProperty(d,x,Object.getOwnPropertyDescriptor(m,x))})}return d}function P(d,s,m){return s in d?Object.defineProperty(d,s,{value:m,enumerable:!0,configurable:!0,writable:!0}):d[s]=m,d}function E(d,s){if(!(d instanceof s))throw new TypeError("Cannot call a class as a function")}function e(d,s){for(var m=0;m<s.length;m++){var x=s[m];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(d,x.key,x)}}function p(d,s,m){return s&&e(d.prototype,s),m&&e(d,m),d}var g=c("buffer"),a=g.Buffer,t=c("util"),i=t.inspect,n=i&&i.custom||"inspect";function r(d,s,m){a.prototype.copy.call(d,s,m)}ae.exports=function(){function d(){E(this,d),this.head=null,this.tail=null,this.length=0}return p(d,[{key:"push",value:function(m){var x={data:m,next:null};this.length>0?this.tail.next=x:this.head=x,this.tail=x,++this.length}},{key:"unshift",value:function(m){var x={data:m,next:this.head};this.length===0&&(this.tail=x),this.head=x,++this.length}},{key:"shift",value:function(){if(this.length!==0){var m=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,m}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(m){if(this.length===0)return"";for(var x=this.head,M=""+x.data;x=x.next;)M+=m+x.data;return M}},{key:"concat",value:function(m){if(this.length===0)return a.alloc(0);for(var x=a.allocUnsafe(m>>>0),M=this.head,v=0;M;)r(M.data,x,v),v+=M.data.length,M=M.next;return x}},{key:"consume",value:function(m,x){var M;return m<this.head.data.length?(M=this.head.data.slice(0,m),this.head.data=this.head.data.slice(m)):m===this.head.data.length?M=this.shift():M=x?this._getString(m):this._getBuffer(m),M}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(m){var x=this.head,M=1,v=x.data;for(m-=v.length;x=x.next;){var _=x.data,l=m>_.length?_.length:m;if(l===_.length?v+=_:v+=_.slice(0,m),m-=l,m===0){l===_.length?(++M,x.next?this.head=x.next:this.head=this.tail=null):(this.head=x,x.data=_.slice(l));break}++M}return this.length-=M,v}},{key:"_getBuffer",value:function(m){var x=a.allocUnsafe(m),M=this.head,v=1;for(M.data.copy(x),m-=M.data.length;M=M.next;){var _=M.data,l=m>_.length?_.length:m;if(_.copy(x,x.length-m,0,l),m-=l,m===0){l===_.length?(++v,M.next?this.head=M.next:this.head=this.tail=null):(this.head=M,M.data=_.slice(l));break}++v}return this.length-=v,x}},{key:n,value:function(m,x){return i(this,k({},x,{depth:0,customInspect:!1}))}}]),d}()},{buffer:85,util:83}],294:[function(c,ae,ie){(function(b){(function(){"use strict";function k(a,t){var i=this,n=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return n||r?(t?t(a):a&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,b.nextTick(p,this,a)):b.nextTick(p,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,function(d){!t&&d?i._writableState?i._writableState.errorEmitted?b.nextTick(E,i):(i._writableState.errorEmitted=!0,b.nextTick(P,i,d)):b.nextTick(P,i,d):t?(b.nextTick(E,i),t(d)):b.nextTick(E,i)}),this)}function P(a,t){p(a,t),E(a)}function E(a){a._writableState&&!a._writableState.emitClose||a._readableState&&!a._readableState.emitClose||a.emit("close")}function e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function p(a,t){a.emit("error",t)}function g(a,t){var i=a._readableState,n=a._writableState;i&&i.autoDestroy||n&&n.autoDestroy?a.destroy(t):a.emit("error",t)}ae.exports={destroy:k,undestroy:e,errorOrDestroy:g}}).call(this)}).call(this,c("_process"))},{_process:277}],295:[function(c,ae,ie){"use strict";var b=c("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function k(p){var g=!1;return function(){if(!g){g=!0;for(var a=arguments.length,t=new Array(a),i=0;i<a;i++)t[i]=arguments[i];p.apply(this,t)}}}function P(){}function E(p){return p.setHeader&&typeof p.abort=="function"}function e(p,g,a){if(typeof g=="function")return e(p,null,g);g||(g={}),a=k(a||P);var t=g.readable||g.readable!==!1&&p.readable,i=g.writable||g.writable!==!1&&p.writable,n=function(){p.writable||d()},r=p._writableState&&p._writableState.finished,d=function(){i=!1,r=!0,t||a.call(p)},s=p._readableState&&p._readableState.endEmitted,m=function(){t=!1,s=!0,i||a.call(p)},x=function(l){a.call(p,l)},M=function(){var l;if(t&&!s)return(!p._readableState||!p._readableState.ended)&&(l=new b),a.call(p,l);if(i&&!r)return(!p._writableState||!p._writableState.ended)&&(l=new b),a.call(p,l)},v=function(){p.req.on("finish",d)};return E(p)?(p.on("complete",d),p.on("abort",M),p.req?v():p.on("request",v)):i&&!p._writableState&&(p.on("end",n),p.on("close",n)),p.on("end",m),p.on("finish",d),g.error!==!1&&p.on("error",x),p.on("close",M),function(){p.removeListener("complete",d),p.removeListener("abort",M),p.removeListener("request",v),p.req&&p.req.removeListener("finish",d),p.removeListener("end",n),p.removeListener("close",n),p.removeListener("finish",d),p.removeListener("end",m),p.removeListener("error",x),p.removeListener("close",M)}}ae.exports=e},{"../../../errors":286}],296:[function(c,ae,ie){ae.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],297:[function(c,ae,ie){"use strict";var b;function k(d){var s=!1;return function(){s||(s=!0,d.apply(void 0,arguments))}}var P=c("../../../errors").codes,E=P.ERR_MISSING_ARGS,e=P.ERR_STREAM_DESTROYED;function p(d){if(d)throw d}function g(d){return d.setHeader&&typeof d.abort=="function"}function a(d,s,m,x){x=k(x);var M=!1;d.on("close",function(){M=!0}),b===void 0&&(b=c("./end-of-stream")),b(d,{readable:s,writable:m},function(_){if(_)return x(_);M=!0,x()});var v=!1;return function(_){if(!M&&!v){if(v=!0,g(d))return d.abort();if(typeof d.destroy=="function")return d.destroy();x(_||new e("pipe"))}}}function t(d){d()}function i(d,s){return d.pipe(s)}function n(d){return!d.length||typeof d[d.length-1]!="function"?p:d.pop()}function r(){for(var d=arguments.length,s=new Array(d),m=0;m<d;m++)s[m]=arguments[m];var x=n(s);if(Array.isArray(s[0])&&(s=s[0]),s.length<2)throw new E("streams");var M,v=s.map(function(_,l){var y=l<s.length-1,T=l>0;return a(_,y,T,function(w){M||(M=w),w&&v.forEach(t),!y&&(v.forEach(t),x(M))})});return s.reduce(i)}ae.exports=r},{"../../../errors":286,"./end-of-stream":295}],298:[function(c,ae,ie){"use strict";var b=c("../../../errors").codes.ERR_INVALID_OPT_VALUE;function k(E,e,p){return E.highWaterMark!=null?E.highWaterMark:e?E[p]:null}function P(E,e,p,g){var a=k(e,g,p);if(a!=null){if(!(isFinite(a)&&Math.floor(a)===a)||a<0){var t=g?p:"highWaterMark";throw new b(t,a)}return Math.floor(a)}return E.objectMode?16:16*1024}ae.exports={getHighWaterMark:P}},{"../../../errors":286}],299:[function(c,ae,ie){ae.exports=c("events").EventEmitter},{events:84}],300:[function(c,ae,ie){"use strict";var b=c("safe-buffer").Buffer,k=b.isEncoding||function(v){switch(v=""+v,v&&v.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function P(v){if(!v)return"utf8";for(var _;;)switch(v){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return v;default:if(_)return;v=(""+v).toLowerCase(),_=!0}}function E(v){var _=P(v);if(typeof _!="string"&&(b.isEncoding===k||!k(v)))throw new Error("Unknown encoding: "+v);return _||v}ie.StringDecoder=e;function e(v){this.encoding=E(v);var _;switch(this.encoding){case"utf16le":this.text=r,this.end=d,_=4;break;case"utf8":this.fillLast=t,_=4;break;case"base64":this.text=s,this.end=m,_=3;break;default:this.write=x,this.end=M;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=b.allocUnsafe(_)}e.prototype.write=function(v){if(v.length===0)return"";var _,l;if(this.lastNeed){if(_=this.fillLast(v),_===void 0)return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<v.length?_?_+this.text(v,l):this.text(v,l):_||""},e.prototype.end=n,e.prototype.text=i,e.prototype.fillLast=function(v){if(this.lastNeed<=v.length)return v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);v.copy(this.lastChar,this.lastTotal-this.lastNeed,0,v.length),this.lastNeed-=v.length};function p(v){return v<=127?0:v>>5===6?2:v>>4===14?3:v>>3===30?4:v>>6===2?-1:-2}function g(v,_,l){var y=_.length-1;if(y<l)return 0;var T=p(_[y]);return T>=0?(T>0&&(v.lastNeed=T-1),T):--y<l||T===-2?0:(T=p(_[y]),T>=0?(T>0&&(v.lastNeed=T-2),T):--y<l||T===-2?0:(T=p(_[y]),T>=0?(T>0&&(T===2?T=0:v.lastNeed=T-3),T):0))}function a(v,_,l){if((_[0]&192)!==128)return v.lastNeed=0,"\uFFFD";if(v.lastNeed>1&&_.length>1){if((_[1]&192)!==128)return v.lastNeed=1,"\uFFFD";if(v.lastNeed>2&&_.length>2&&(_[2]&192)!==128)return v.lastNeed=2,"\uFFFD"}}function t(v){var _=this.lastTotal-this.lastNeed,l=a(this,v,_);if(l!==void 0)return l;if(this.lastNeed<=v.length)return v.copy(this.lastChar,_,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);v.copy(this.lastChar,_,0,v.length),this.lastNeed-=v.length}function i(v,_){var l=g(this,v,_);if(!this.lastNeed)return v.toString("utf8",_);this.lastTotal=l;var y=v.length-(l-this.lastNeed);return v.copy(this.lastChar,0,y),v.toString("utf8",_,y)}function n(v){var _=v&&v.length?this.write(v):"";return this.lastNeed?_+"\uFFFD":_}function r(v,_){if((v.length-_)%2===0){var l=v.toString("utf16le",_);if(l){var y=l.charCodeAt(l.length-1);if(y>=55296&&y<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=v[v.length-1],v.toString("utf16le",_,v.length-1)}function d(v){var _=v&&v.length?this.write(v):"";if(this.lastNeed){var l=this.lastTotal-this.lastNeed;return _+this.lastChar.toString("utf16le",0,l)}return _}function s(v,_){var l=(v.length-_)%3;return l===0?v.toString("base64",_):(this.lastNeed=3-l,this.lastTotal=3,l===1?this.lastChar[0]=v[v.length-1]:(this.lastChar[0]=v[v.length-2],this.lastChar[1]=v[v.length-1]),v.toString("base64",_,v.length-l))}function m(v){var _=v&&v.length?this.write(v):"";return this.lastNeed?_+this.lastChar.toString("base64",0,3-this.lastNeed):_}function x(v){return v.toString(this.encoding)}function M(v){return v&&v.length?this.write(v):""}},{"safe-buffer":284}],301:[function(c,ae,ie){(function(b,k){(function(){var P=c("assert"),E=c("debug")("stream-parser");ae.exports=t;var e=-1,p=0,g=1,a=2;function t(l){var y=l&&typeof l._transform=="function",T=l&&typeof l._write=="function";if(!y&&!T)throw new Error("must pass a Writable or Transform stream in");E("extending Parser into stream"),l._bytes=n,l._skipBytes=r,y&&(l._passthrough=d),y?l._transform=m:l._write=s}function i(l){E("initializing parser stream"),l._parserBytesLeft=0,l._parserBuffers=[],l._parserBuffered=0,l._parserState=e,l._parserCallback=null,typeof l.push=="function"&&(l._parserOutput=l.push.bind(l)),l._parserInit=!0}function n(l,y){P(!this._parserCallback,'there is already a "callback" set!'),P(isFinite(l)&&l>0,'can only buffer a finite number of bytes > 0, got "'+l+'"'),this._parserInit||i(this),E("buffering %o bytes",l),this._parserBytesLeft=l,this._parserCallback=y,this._parserState=p}function r(l,y){P(!this._parserCallback,'there is already a "callback" set!'),P(l>0,'can only skip > 0 bytes, got "'+l+'"'),this._parserInit||i(this),E("skipping %o bytes",l),this._parserBytesLeft=l,this._parserCallback=y,this._parserState=g}function d(l,y){P(!this._parserCallback,'There is already a "callback" set!'),P(l>0,'can only pass through > 0 bytes, got "'+l+'"'),this._parserInit||i(this),E("passing through %o bytes",l),this._parserBytesLeft=l,this._parserCallback=y,this._parserState=a}function s(l,y,T){this._parserInit||i(this),E("write(%o bytes)",l.length),typeof y=="function"&&(T=y),v(this,l,null,T)}function m(l,y,T){this._parserInit||i(this),E("transform(%o bytes)",l.length),typeof y!="function"&&(y=this._parserOutput),v(this,l,y,T)}function x(l,y,T,w){return l._parserBytesLeft<=0?w(new Error("got data but not currently parsing anything")):y.length<=l._parserBytesLeft?function(){return M(l,y,T,w)}:function(){var A=y.slice(0,l._parserBytesLeft);return M(l,A,T,function(f){if(f)return w(f);if(y.length>A.length)return function(){return x(l,y.slice(A.length),T,w)}})}}function M(l,y,T,w){if(l._parserBytesLeft-=y.length,E("%o bytes left for stream piece",l._parserBytesLeft),l._parserState===p?(l._parserBuffers.push(y),l._parserBuffered+=y.length):l._parserState===a&&T(y),l._parserBytesLeft===0){var A=l._parserCallback;if(A&&l._parserState===p&&l._parserBuffers.length>1&&(y=k.concat(l._parserBuffers,l._parserBuffered)),l._parserState!==p&&(y=null),l._parserCallback=null,l._parserBuffered=0,l._parserState=e,l._parserBuffers.splice(0),A){var f=[];y&&f.push(y),T&&f.push(T);var u=A.length>f.length;u&&f.push(_(w));var h=A.apply(l,f);if(!u||w===h)return w}}else return w}var v=_(x);function _(l){return function(){for(var y=l.apply(this,arguments);typeof y=="function";)y=y();return y}}}).call(this)}).call(this,c("_process"),c("buffer").Buffer)},{_process:277,assert:75,buffer:85,debug:302}],302:[function(c,ae,ie){(function(b){(function(){ie=ae.exports=c("./debug"),ie.log=E,ie.formatArgs=P,ie.save=e,ie.load=p,ie.useColors=k,ie.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:g(),ie.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function k(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}ie.formatters.j=function(a){try{return JSON.stringify(a)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}};function P(a){var t=this.useColors;if(a[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+a[0]+(t?"%c ":" ")+"+"+ie.humanize(this.diff),!!t){var i="color: "+this.color;a.splice(1,0,i,"color: inherit");var n=0,r=0;a[0].replace(/%[a-zA-Z%]/g,function(d){d!=="%%"&&(n++,d==="%c"&&(r=n))}),a.splice(r,0,i)}}function E(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function e(a){try{a==null?ie.storage.removeItem("debug"):ie.storage.debug=a}catch{}}function p(){var a;try{a=ie.storage.debug}catch{}return!a&&typeof b<"u"&&"env"in b&&(a=b.env.DEBUG),a}ie.enable(p());function g(){try{return window.localStorage}catch{}}}).call(this)}).call(this,c("_process"))},{"./debug":303,_process:277}],303:[function(c,ae,ie){ie=ae.exports=P.debug=P.default=P,ie.coerce=g,ie.disable=e,ie.enable=E,ie.enabled=p,ie.humanize=c("ms"),ie.names=[],ie.skips=[],ie.formatters={};var b;function k(a){var t=0,i;for(i in a)t=(t<<5)-t+a.charCodeAt(i),t|=0;return ie.colors[Math.abs(t)%ie.colors.length]}function P(a){function t(){if(!!t.enabled){var i=t,n=+new Date,r=n-(b||n);i.diff=r,i.prev=b,i.curr=n,b=n;for(var d=new Array(arguments.length),s=0;s<d.length;s++)d[s]=arguments[s];d[0]=ie.coerce(d[0]),typeof d[0]!="string"&&d.unshift("%O");var m=0;d[0]=d[0].replace(/%([a-zA-Z%])/g,function(M,v){if(M==="%%")return M;m++;var _=ie.formatters[v];if(typeof _=="function"){var l=d[m];M=_.call(i,l),d.splice(m,1),m--}return M}),ie.formatArgs.call(i,d);var x=t.log||ie.log||console.log.bind(console);x.apply(i,d)}}return t.namespace=a,t.enabled=ie.enabled(a),t.useColors=ie.useColors(),t.color=k(a),typeof ie.init=="function"&&ie.init(t),t}function E(a){ie.save(a),ie.names=[],ie.skips=[];for(var t=(typeof a=="string"?a:"").split(/[\s,]+/),i=t.length,n=0;n<i;n++)!t[n]||(a=t[n].replace(/\*/g,".*?"),a[0]==="-"?ie.skips.push(new RegExp("^"+a.substr(1)+"$")):ie.names.push(new RegExp("^"+a+"$")))}function e(){ie.enable("")}function p(a){var t,i;for(t=0,i=ie.skips.length;t<i;t++)if(ie.skips[t].test(a))return!1;for(t=0,i=ie.names.length;t<i;t++)if(ie.names[t].test(a))return!0;return!1}function g(a){return a instanceof Error?a.stack||a.message:a}},{ms:304}],304:[function(c,ae,ie){var b=1e3,k=b*60,P=k*60,E=P*24,e=E*365.25;ae.exports=function(i,n){n=n||{};var r=typeof i;if(r==="string"&&i.length>0)return p(i);if(r==="number"&&isNaN(i)===!1)return n.long?a(i):g(i);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(i))};function p(i){if(i=String(i),!(i.length>100)){var n=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(i);if(!!n){var r=parseFloat(n[1]),d=(n[2]||"ms").toLowerCase();switch(d){case"years":case"year":case"yrs":case"yr":case"y":return r*e;case"days":case"day":case"d":return r*E;case"hours":case"hour":case"hrs":case"hr":case"h":return r*P;case"minutes":case"minute":case"mins":case"min":case"m":return r*k;case"seconds":case"second":case"secs":case"sec":case"s":return r*b;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function g(i){return i>=E?Math.round(i/E)+"d":i>=P?Math.round(i/P)+"h":i>=k?Math.round(i/k)+"m":i>=b?Math.round(i/b)+"s":i+"ms"}function a(i){return t(i,E,"day")||t(i,P,"hour")||t(i,k,"minute")||t(i,b,"second")||i+" ms"}function t(i,n,r){if(!(i<n))return i<n*1.5?Math.floor(i/n)+" "+r:Math.ceil(i/n)+" "+r+"s"}},{}],305:[function(c,ae,ie){"use strict";var b=c("parenthesis");ae.exports=function(P,E,e){if(P==null)throw Error("First argument should be a string");if(E==null)throw Error("Separator should be a string or a RegExp");e?(typeof e=="string"||Array.isArray(e))&&(e={ignore:e}):e={},e.escape==null&&(e.escape=!0),e.ignore==null?e.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof e.ignore=="string"&&(e.ignore=[e.ignore]),e.ignore=e.ignore.map(function(d){return d.length===1&&(d=d+d),d}));var p=b.parse(P,{flat:!0,brackets:e.ignore}),g=p[0],a=g.split(E);if(e.escape){for(var t=[],i=0;i<a.length;i++){var n=a[i],r=a[i+1];n[n.length-1]==="\\"&&n[n.length-2]!=="\\"?(t.push(n+E+r),i++):t.push(n)}a=t}for(var i=0;i<a.length;i++)p[0]=a[i],a[i]=b.stringify(p,{flat:!0});return a}},{parenthesis:248}],306:[function(c,ae,ie){"use strict";ae.exports=b;function b(k){for(var P=k.length,E=new Array(P),e=new Array(P),p=new Array(P),g=new Array(P),a=new Array(P),t=new Array(P),i=0;i<P;++i)E[i]=-1,e[i]=0,p[i]=!1,g[i]=0,a[i]=-1,t[i]=[];var n=0,r=[],d=[];function s(v){var _=[v],l=[v];for(E[v]=e[v]=n,p[v]=!0,n+=1;l.length>0;){v=l[l.length-1];var y=k[v];if(g[v]<y.length){for(var T=g[v];T<y.length;++T){var w=y[T];if(E[w]<0){E[w]=e[w]=n,p[w]=!0,n+=1,_.push(w),l.push(w);break}else p[w]&&(e[v]=Math.min(e[v],e[w])|0);a[w]>=0&&t[v].push(a[w])}g[v]=T}else{if(e[v]===E[v]){for(var A=[],f=[],u=0,T=_.length-1;T>=0;--T){var h=_[T];if(p[h]=!1,A.push(h),f.push(t[h]),u+=t[h].length,a[h]=r.length,h===v){_.length=T;break}}r.push(A);for(var o=new Array(u),T=0;T<f.length;T++)for(var S=0;S<f[T].length;S++)o[--u]=f[T][S];d.push(o)}l.pop()}}}for(var i=0;i<P;++i)E[i]<0&&s(i);for(var m,i=0;i<d.length;i++){var x=d[i];if(x.length!==0){x.sort(function(_,l){return _-l}),m=[x[0]];for(var M=1;M<x.length;M++)x[M]!==x[M-1]&&m.push(x[M]);d[i]=m}}return{components:r,adjacencyList:d}}},{}],307:[function(c,ae,ie){"use strict";Object.defineProperty(ie,"__esModule",{value:!0});var b=function(){function a(t,i){var n=[],r=!0,d=!1,s=void 0;try{for(var m=t[Symbol.iterator](),x;!(r=(x=m.next()).done)&&(n.push(x.value),!(i&&n.length===i));r=!0);}catch(M){d=!0,s=M}finally{try{!r&&m.return&&m.return()}finally{if(d)throw s}}return n}return function(t,i){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return a(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),k=Math.PI*2,P=function(t,i,n,r,d,s,m){var x=t.x,M=t.y;x*=i,M*=n;var v=r*x-d*M,_=d*x+r*M;return{x:v+s,y:_+m}},E=function(t,i){var n=i===1.5707963267948966?.551915024494:i===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(i/4),r=Math.cos(t),d=Math.sin(t),s=Math.cos(t+i),m=Math.sin(t+i);return[{x:r-d*n,y:d+r*n},{x:s+m*n,y:m-s*n},{x:s,y:m}]},e=function(t,i,n,r){var d=t*r-i*n<0?-1:1,s=t*n+i*r;return s>1&&(s=1),s<-1&&(s=-1),d*Math.acos(s)},p=function(t,i,n,r,d,s,m,x,M,v,_,l){var y=Math.pow(d,2),T=Math.pow(s,2),w=Math.pow(_,2),A=Math.pow(l,2),f=y*T-y*A-T*w;f<0&&(f=0),f/=y*A+T*w,f=Math.sqrt(f)*(m===x?-1:1);var u=f*d/s*l,h=f*-s/d*_,o=v*u-M*h+(t+n)/2,S=M*u+v*h+(i+r)/2,R=(_-u)/d,z=(l-h)/s,O=(-_-u)/d,I=(-l-h)/s,F=e(1,0,R,z),D=e(R,z,O,I);return x===0&&D>0&&(D-=k),x===1&&D<0&&(D+=k),[o,S,F,D]},g=function(t){var i=t.px,n=t.py,r=t.cx,d=t.cy,s=t.rx,m=t.ry,x=t.xAxisRotation,M=x===void 0?0:x,v=t.largeArcFlag,_=v===void 0?0:v,l=t.sweepFlag,y=l===void 0?0:l,T=[];if(s===0||m===0)return[];var w=Math.sin(M*k/360),A=Math.cos(M*k/360),f=A*(i-r)/2+w*(n-d)/2,u=-w*(i-r)/2+A*(n-d)/2;if(f===0&&u===0)return[];s=Math.abs(s),m=Math.abs(m);var h=Math.pow(f,2)/Math.pow(s,2)+Math.pow(u,2)/Math.pow(m,2);h>1&&(s*=Math.sqrt(h),m*=Math.sqrt(h));var o=p(i,n,r,d,s,m,_,y,w,A,f,u),S=b(o,4),R=S[0],z=S[1],O=S[2],I=S[3],F=Math.abs(I)/(k/4);Math.abs(1-F)<1e-7&&(F=1);var D=Math.max(Math.ceil(F),1);I/=D;for(var B=0;B<D;B++)T.push(E(O,I)),O+=I;return T.map(function(U){var X=P(U[0],s,m,A,w,R,z),oe=X.x,se=X.y,q=P(U[1],s,m,A,w,R,z),K=q.x,G=q.y,Q=P(U[2],s,m,A,w,R,z),V=Q.x,H=Q.y;return{x1:oe,y1:se,x2:K,y2:G,x:V,y:H}})};ie.default=g,ae.exports=ie.default},{}],308:[function(c,ae,ie){"use strict";var b=c("parse-svg-path"),k=c("abs-svg-path"),P=c("normalize-svg-path"),E=c("is-svg-path"),e=c("assert");ae.exports=p;function p(g){if(Array.isArray(g)&&g.length===1&&typeof g[0]=="string"&&(g=g[0]),typeof g=="string"&&(e(E(g),"String is not an SVG path."),g=b(g)),e(Array.isArray(g),"Argument should be a string or an array of path segments."),g=k(g),g=P(g),!g.length)return[0,0,0,0];for(var a=[1/0,1/0,-1/0,-1/0],t=0,i=g.length;t<i;t++)for(var n=g[t].slice(1),r=0;r<n.length;r+=2)n[r+0]<a[0]&&(a[0]=n[r+0]),n[r+1]<a[1]&&(a[1]=n[r+1]),n[r+0]>a[2]&&(a[2]=n[r+0]),n[r+1]>a[3]&&(a[3]=n[r+1]);return a}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":309,"parse-svg-path":250}],309:[function(c,ae,ie){"use strict";ae.exports=k;var b=c("svg-arc-to-cubic-bezier");function k(e){for(var p,g=[],a=0,t=0,i=0,n=0,r=null,d=null,s=0,m=0,x=0,M=e.length;x<M;x++){var v=e[x],_=v[0];switch(_){case"M":i=v[1],n=v[2];break;case"A":var l=b({px:s,py:m,cx:v[6],cy:v[7],rx:v[1],ry:v[2],xAxisRotation:v[3],largeArcFlag:v[4],sweepFlag:v[5]});if(!l.length)continue;for(var y=0,T;y<l.length;y++)T=l[y],v=["C",T.x1,T.y1,T.x2,T.y2,T.x,T.y],y<l.length-1&&g.push(v);break;case"S":var w=s,A=m;(p=="C"||p=="S")&&(w+=w-a,A+=A-t),v=["C",w,A,v[1],v[2],v[3],v[4]];break;case"T":p=="Q"||p=="T"?(r=s*2-r,d=m*2-d):(r=s,d=m),v=E(s,m,r,d,v[1],v[2]);break;case"Q":r=v[1],d=v[2],v=E(s,m,v[1],v[2],v[3],v[4]);break;case"L":v=P(s,m,v[1],v[2]);break;case"H":v=P(s,m,v[1],m);break;case"V":v=P(s,m,s,v[1]);break;case"Z":v=P(s,m,i,n);break}p=_,s=v[v.length-2],m=v[v.length-1],v.length>4?(a=v[v.length-4],t=v[v.length-3]):(a=s,t=m),g.push(v)}return g}function P(e,p,g,a){return["C",e,p,g,a,g,a]}function E(e,p,g,a,t,i){return["C",e/3+2/3*g,p/3+2/3*a,t/3+2/3*g,i/3+2/3*a,t,i]}},{"svg-arc-to-cubic-bezier":307}],310:[function(c,ae,ie){"use strict";var b=c("svg-path-bounds"),k=c("parse-svg-path"),P=c("draw-svg-path"),E=c("is-svg-path"),e=c("bitmap-sdf"),p=document.createElement("canvas"),g=p.getContext("2d");ae.exports=a;function a(n,r){if(!E(n))throw Error("Argument should be valid svg path string");r||(r={});var d,s;r.shape?(d=r.shape[0],s=r.shape[1]):(d=p.width=r.w||r.width||200,s=p.height=r.h||r.height||200);var m=Math.min(d,s),x=r.stroke||0,M=r.viewbox||r.viewBox||b(n),v=[d/(M[2]-M[0]),s/(M[3]-M[1])],_=Math.min(v[0]||0,v[1]||0)/2;if(g.fillStyle="black",g.fillRect(0,0,d,s),g.fillStyle="white",x&&(typeof x!="number"&&(x=1),x>0?g.strokeStyle="white":g.strokeStyle="black",g.lineWidth=Math.abs(x)),g.translate(d*.5,s*.5),g.scale(_,_),i()){var l=new Path2D(n);g.fill(l),x&&g.stroke(l)}else{var y=k(n);P(g,y),g.fill(),x&&g.stroke()}g.setTransform(1,0,0,1,0,0);var T=e(g,{cutoff:r.cutoff!=null?r.cutoff:.5,radius:r.radius!=null?r.radius:m*.5});return T}var t;function i(){if(t!=null)return t;var n=document.createElement("canvas").getContext("2d");if(n.canvas.width=n.canvas.height=1,!window.Path2D)return t=!1;var r=new Path2D("M0,0h1v1h-1v-1Z");n.fillStyle="black",n.fill(r);var d=n.getImageData(0,0,1,1);return t=d&&d.data&&d.data[3]===255}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":308}],311:[function(c,ae,ie){(function(b,k){(function(){var P=c("process/browser.js").nextTick,E=Function.prototype.apply,e=Array.prototype.slice,p={},g=0;ie.setTimeout=function(){return new a(E.call(setTimeout,window,arguments),clearTimeout)},ie.setInterval=function(){return new a(E.call(setInterval,window,arguments),clearInterval)},ie.clearTimeout=ie.clearInterval=function(t){t.close()};function a(t,i){this._id=t,this._clearFn=i}a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(window,this._id)},ie.enroll=function(t,i){clearTimeout(t._idleTimeoutId),t._idleTimeout=i},ie.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},ie._unrefActive=ie.active=function(t){clearTimeout(t._idleTimeoutId);var i=t._idleTimeout;i>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},i))},ie.setImmediate=typeof b=="function"?b:function(t){var i=g++,n=arguments.length<2?!1:e.call(arguments,1);return p[i]=!0,P(function(){p[i]&&(n?t.apply(null,n):t.call(null),ie.clearImmediate(i))}),i},ie.clearImmediate=typeof k=="function"?k:function(t){delete p[t]}}).call(this)}).call(this,c("timers").setImmediate,c("timers").clearImmediate)},{"process/browser.js":277,timers:311}],312:[function(c,ae,ie){(function(b){var k=/^\s+/,P=/\s+$/,E=0,e=b.round,p=b.min,g=b.max,a=b.random;function t(W,re){if(W=W||"",re=re||{},W instanceof t)return W;if(!(this instanceof t))return new t(W,re);var j=i(W);this._originalInput=W,this._r=j.r,this._g=j.g,this._b=j.b,this._a=j.a,this._roundA=e(100*this._a)/100,this._format=re.format||j.format,this._gradientType=re.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=j.ok,this._tc_id=E++}t.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var W=this.toRgb();return(W.r*299+W.g*587+W.b*114)/1e3},getLuminance:function(){var W=this.toRgb(),re,j,Z,ne,le,ge;return re=W.r/255,j=W.g/255,Z=W.b/255,re<=.03928?ne=re/12.92:ne=b.pow((re+.055)/1.055,2.4),j<=.03928?le=j/12.92:le=b.pow((j+.055)/1.055,2.4),Z<=.03928?ge=Z/12.92:ge=b.pow((Z+.055)/1.055,2.4),.2126*ne+.7152*le+.0722*ge},setAlpha:function(W){return this._a=D(W),this._roundA=e(100*this._a)/100,this},toHsv:function(){var W=s(this._r,this._g,this._b);return{h:W.h*360,s:W.s,v:W.v,a:this._a}},toHsvString:function(){var W=s(this._r,this._g,this._b),re=e(W.h*360),j=e(W.s*100),Z=e(W.v*100);return this._a==1?"hsv("+re+", "+j+"%, "+Z+"%)":"hsva("+re+", "+j+"%, "+Z+"%, "+this._roundA+")"},toHsl:function(){var W=r(this._r,this._g,this._b);return{h:W.h*360,s:W.s,l:W.l,a:this._a}},toHslString:function(){var W=r(this._r,this._g,this._b),re=e(W.h*360),j=e(W.s*100),Z=e(W.l*100);return this._a==1?"hsl("+re+", "+j+"%, "+Z+"%)":"hsla("+re+", "+j+"%, "+Z+"%, "+this._roundA+")"},toHex:function(W){return x(this._r,this._g,this._b,W)},toHexString:function(W){return"#"+this.toHex(W)},toHex8:function(W){return M(this._r,this._g,this._b,this._a,W)},toHex8String:function(W){return"#"+this.toHex8(W)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(B(this._r,255)*100)+"%",g:e(B(this._g,255)*100)+"%",b:e(B(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(B(this._r,255)*100)+"%, "+e(B(this._g,255)*100)+"%, "+e(B(this._b,255)*100)+"%)":"rgba("+e(B(this._r,255)*100)+"%, "+e(B(this._g,255)*100)+"%, "+e(B(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:I[x(this._r,this._g,this._b,!0)]||!1},toFilter:function(W){var re="#"+v(this._r,this._g,this._b,this._a),j=re,Z=this._gradientType?"GradientType = 1, ":"";if(W){var ne=t(W);j="#"+v(ne._r,ne._g,ne._b,ne._a)}return"progid:DXImageTransform.Microsoft.gradient("+Z+"startColorstr="+re+",endColorstr="+j+")"},toString:function(W){var re=!!W;W=W||this._format;var j=!1,Z=this._a<1&&this._a>=0,ne=!re&&Z&&(W==="hex"||W==="hex6"||W==="hex3"||W==="hex4"||W==="hex8"||W==="name");return ne?W==="name"&&this._a===0?this.toName():this.toRgbString():(W==="rgb"&&(j=this.toRgbString()),W==="prgb"&&(j=this.toPercentageRgbString()),(W==="hex"||W==="hex6")&&(j=this.toHexString()),W==="hex3"&&(j=this.toHexString(!0)),W==="hex4"&&(j=this.toHex8String(!0)),W==="hex8"&&(j=this.toHex8String()),W==="name"&&(j=this.toName()),W==="hsl"&&(j=this.toHslString()),W==="hsv"&&(j=this.toHsvString()),j||this.toHexString())},clone:function(){return t(this.toString())},_applyModification:function(W,re){var j=W.apply(null,[this].concat([].slice.call(re)));return this._r=j._r,this._g=j._g,this._b=j._b,this.setAlpha(j._a),this},lighten:function(){return this._applyModification(T,arguments)},brighten:function(){return this._applyModification(w,arguments)},darken:function(){return this._applyModification(A,arguments)},desaturate:function(){return this._applyModification(_,arguments)},saturate:function(){return this._applyModification(l,arguments)},greyscale:function(){return this._applyModification(y,arguments)},spin:function(){return this._applyModification(f,arguments)},_applyCombination:function(W,re){return W.apply(null,[this].concat([].slice.call(re)))},analogous:function(){return this._applyCombination(R,arguments)},complement:function(){return this._applyCombination(u,arguments)},monochromatic:function(){return this._applyCombination(z,arguments)},splitcomplement:function(){return this._applyCombination(S,arguments)},triad:function(){return this._applyCombination(h,arguments)},tetrad:function(){return this._applyCombination(o,arguments)}},t.fromRatio=function(W,re){if(typeof W=="object"){var j={};for(var Z in W)W.hasOwnProperty(Z)&&(Z==="a"?j[Z]=W[Z]:j[Z]=K(W[Z]));W=j}return t(W,re)};function i(W){var re={r:0,g:0,b:0},j=1,Z=null,ne=null,le=null,ge=!1,pe=!1;return typeof W=="string"&&(W=ee(W)),typeof W=="object"&&(H(W.r)&&H(W.g)&&H(W.b)?(re=n(W.r,W.g,W.b),ge=!0,pe=String(W.r).substr(-1)==="%"?"prgb":"rgb"):H(W.h)&&H(W.s)&&H(W.v)?(Z=K(W.s),ne=K(W.v),re=m(W.h,Z,ne),ge=!0,pe="hsv"):H(W.h)&&H(W.s)&&H(W.l)&&(Z=K(W.s),le=K(W.l),re=d(W.h,Z,le),ge=!0,pe="hsl"),W.hasOwnProperty("a")&&(j=W.a)),j=D(j),{ok:ge,format:W.format||pe,r:p(255,g(re.r,0)),g:p(255,g(re.g,0)),b:p(255,g(re.b,0)),a:j}}function n(W,re,j){return{r:B(W,255)*255,g:B(re,255)*255,b:B(j,255)*255}}function r(W,re,j){W=B(W,255),re=B(re,255),j=B(j,255);var Z=g(W,re,j),ne=p(W,re,j),le,ge,pe=(Z+ne)/2;if(Z==ne)le=ge=0;else{var xe=Z-ne;switch(ge=pe>.5?xe/(2-Z-ne):xe/(Z+ne),Z){case W:le=(re-j)/xe+(re<j?6:0);break;case re:le=(j-W)/xe+2;break;case j:le=(W-re)/xe+4;break}le/=6}return{h:le,s:ge,l:pe}}function d(W,re,j){var Z,ne,le;W=B(W,360),re=B(re,100),j=B(j,100);function ge(Ee,Te,de){return de<0&&(de+=1),de>1&&(de-=1),de<1/6?Ee+(Te-Ee)*6*de:de<1/2?Te:de<2/3?Ee+(Te-Ee)*(2/3-de)*6:Ee}if(re===0)Z=ne=le=j;else{var pe=j<.5?j*(1+re):j+re-j*re,xe=2*j-pe;Z=ge(xe,pe,W+1/3),ne=ge(xe,pe,W),le=ge(xe,pe,W-1/3)}return{r:Z*255,g:ne*255,b:le*255}}function s(W,re,j){W=B(W,255),re=B(re,255),j=B(j,255);var Z=g(W,re,j),ne=p(W,re,j),le,ge,pe=Z,xe=Z-ne;if(ge=Z===0?0:xe/Z,Z==ne)le=0;else{switch(Z){case W:le=(re-j)/xe+(re<j?6:0);break;case re:le=(j-W)/xe+2;break;case j:le=(W-re)/xe+4;break}le/=6}return{h:le,s:ge,v:pe}}function m(W,re,j){W=B(W,360)*6,re=B(re,100),j=B(j,100);var Z=b.floor(W),ne=W-Z,le=j*(1-re),ge=j*(1-ne*re),pe=j*(1-(1-ne)*re),xe=Z%6,Ee=[j,ge,le,le,pe,j][xe],Te=[pe,j,j,ge,le,le][xe],de=[le,le,pe,j,j,ge][xe];return{r:Ee*255,g:Te*255,b:de*255}}function x(W,re,j,Z){var ne=[q(e(W).toString(16)),q(e(re).toString(16)),q(e(j).toString(16))];return Z&&ne[0].charAt(0)==ne[0].charAt(1)&&ne[1].charAt(0)==ne[1].charAt(1)&&ne[2].charAt(0)==ne[2].charAt(1)?ne[0].charAt(0)+ne[1].charAt(0)+ne[2].charAt(0):ne.join("")}function M(W,re,j,Z,ne){var le=[q(e(W).toString(16)),q(e(re).toString(16)),q(e(j).toString(16)),q(G(Z))];return ne&&le[0].charAt(0)==le[0].charAt(1)&&le[1].charAt(0)==le[1].charAt(1)&&le[2].charAt(0)==le[2].charAt(1)&&le[3].charAt(0)==le[3].charAt(1)?le[0].charAt(0)+le[1].charAt(0)+le[2].charAt(0)+le[3].charAt(0):le.join("")}function v(W,re,j,Z){var ne=[q(G(Z)),q(e(W).toString(16)),q(e(re).toString(16)),q(e(j).toString(16))];return ne.join("")}t.equals=function(W,re){return!W||!re?!1:t(W).toRgbString()==t(re).toRgbString()},t.random=function(){return t.fromRatio({r:a(),g:a(),b:a()})};function _(W,re){re=re===0?0:re||10;var j=t(W).toHsl();return j.s-=re/100,j.s=U(j.s),t(j)}function l(W,re){re=re===0?0:re||10;var j=t(W).toHsl();return j.s+=re/100,j.s=U(j.s),t(j)}function y(W){return t(W).desaturate(100)}function T(W,re){re=re===0?0:re||10;var j=t(W).toHsl();return j.l+=re/100,j.l=U(j.l),t(j)}function w(W,re){re=re===0?0:re||10;var j=t(W).toRgb();return j.r=g(0,p(255,j.r-e(255*-(re/100)))),j.g=g(0,p(255,j.g-e(255*-(re/100)))),j.b=g(0,p(255,j.b-e(255*-(re/100)))),t(j)}function A(W,re){re=re===0?0:re||10;var j=t(W).toHsl();return j.l-=re/100,j.l=U(j.l),t(j)}function f(W,re){var j=t(W).toHsl(),Z=(j.h+re)%360;return j.h=Z<0?360+Z:Z,t(j)}function u(W){var re=t(W).toHsl();return re.h=(re.h+180)%360,t(re)}function h(W){var re=t(W).toHsl(),j=re.h;return[t(W),t({h:(j+120)%360,s:re.s,l:re.l}),t({h:(j+240)%360,s:re.s,l:re.l})]}function o(W){var re=t(W).toHsl(),j=re.h;return[t(W),t({h:(j+90)%360,s:re.s,l:re.l}),t({h:(j+180)%360,s:re.s,l:re.l}),t({h:(j+270)%360,s:re.s,l:re.l})]}function S(W){var re=t(W).toHsl(),j=re.h;return[t(W),t({h:(j+72)%360,s:re.s,l:re.l}),t({h:(j+216)%360,s:re.s,l:re.l})]}function R(W,re,j){re=re||6,j=j||30;var Z=t(W).toHsl(),ne=360/j,le=[t(W)];for(Z.h=(Z.h-(ne*re>>1)+720)%360;--re;)Z.h=(Z.h+ne)%360,le.push(t(Z));return le}function z(W,re){re=re||6;for(var j=t(W).toHsv(),Z=j.h,ne=j.s,le=j.v,ge=[],pe=1/re;re--;)ge.push(t({h:Z,s:ne,v:le})),le=(le+pe)%1;return ge}t.mix=function(W,re,j){j=j===0?0:j||50;var Z=t(W).toRgb(),ne=t(re).toRgb(),le=j/100,ge={r:(ne.r-Z.r)*le+Z.r,g:(ne.g-Z.g)*le+Z.g,b:(ne.b-Z.b)*le+Z.b,a:(ne.a-Z.a)*le+Z.a};return t(ge)},t.readability=function(W,re){var j=t(W),Z=t(re);return(b.max(j.getLuminance(),Z.getLuminance())+.05)/(b.min(j.getLuminance(),Z.getLuminance())+.05)},t.isReadable=function(W,re,j){var Z=t.readability(W,re),ne,le;switch(le=!1,ne=J(j),ne.level+ne.size){case"AAsmall":case"AAAlarge":le=Z>=4.5;break;case"AAlarge":le=Z>=3;break;case"AAAsmall":le=Z>=7;break}return le},t.mostReadable=function(W,re,j){var Z=null,ne=0,le,ge,pe,xe;j=j||{},ge=j.includeFallbackColors,pe=j.level,xe=j.size;for(var Ee=0;Ee<re.length;Ee++)le=t.readability(W,re[Ee]),le>ne&&(ne=le,Z=t(re[Ee]));return t.isReadable(W,Z,{level:pe,size:xe})||!ge?Z:(j.includeFallbackColors=!1,t.mostReadable(W,["#fff","#000"],j))};var O=t.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},I=t.hexNames=F(O);function F(W){var re={};for(var j in W)W.hasOwnProperty(j)&&(re[W[j]]=j);return re}function D(W){return W=parseFloat(W),(isNaN(W)||W<0||W>1)&&(W=1),W}function B(W,re){oe(W)&&(W="100%");var j=se(W);return W=p(re,g(0,parseFloat(W))),j&&(W=parseInt(W*re,10)/100),b.abs(W-re)<1e-6?1:W%re/parseFloat(re)}function U(W){return p(1,g(0,W))}function X(W){return parseInt(W,16)}function oe(W){return typeof W=="string"&&W.indexOf(".")!=-1&&parseFloat(W)===1}function se(W){return typeof W=="string"&&W.indexOf("%")!=-1}function q(W){return W.length==1?"0"+W:""+W}function K(W){return W<=1&&(W=W*100+"%"),W}function G(W){return b.round(parseFloat(W)*255).toString(16)}function Q(W){return X(W)/255}var V=function(){var W="[-\\+]?\\d+%?",re="[-\\+]?\\d*\\.\\d+%?",j="(?:"+re+")|(?:"+W+")",Z="[\\s|\\(]+("+j+")[,|\\s]+("+j+")[,|\\s]+("+j+")\\s*\\)?",ne="[\\s|\\(]+("+j+")[,|\\s]+("+j+")[,|\\s]+("+j+")[,|\\s]+("+j+")\\s*\\)?";return{CSS_UNIT:new RegExp(j),rgb:new RegExp("rgb"+Z),rgba:new RegExp("rgba"+ne),hsl:new RegExp("hsl"+Z),hsla:new RegExp("hsla"+ne),hsv:new RegExp("hsv"+Z),hsva:new RegExp("hsva"+ne),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function H(W){return!!V.CSS_UNIT.exec(W)}function ee(W){W=W.replace(k,"").replace(P,"").toLowerCase();var re=!1;if(O[W])W=O[W],re=!0;else if(W=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var j;return(j=V.rgb.exec(W))?{r:j[1],g:j[2],b:j[3]}:(j=V.rgba.exec(W))?{r:j[1],g:j[2],b:j[3],a:j[4]}:(j=V.hsl.exec(W))?{h:j[1],s:j[2],l:j[3]}:(j=V.hsla.exec(W))?{h:j[1],s:j[2],l:j[3],a:j[4]}:(j=V.hsv.exec(W))?{h:j[1],s:j[2],v:j[3]}:(j=V.hsva.exec(W))?{h:j[1],s:j[2],v:j[3],a:j[4]}:(j=V.hex8.exec(W))?{r:X(j[1]),g:X(j[2]),b:X(j[3]),a:Q(j[4]),format:re?"name":"hex8"}:(j=V.hex6.exec(W))?{r:X(j[1]),g:X(j[2]),b:X(j[3]),format:re?"name":"hex"}:(j=V.hex4.exec(W))?{r:X(j[1]+""+j[1]),g:X(j[2]+""+j[2]),b:X(j[3]+""+j[3]),a:Q(j[4]+""+j[4]),format:re?"name":"hex8"}:(j=V.hex3.exec(W))?{r:X(j[1]+""+j[1]),g:X(j[2]+""+j[2]),b:X(j[3]+""+j[3]),format:re?"name":"hex"}:!1}function J(W){var re,j;return W=W||{level:"AA",size:"small"},re=(W.level||"AA").toUpperCase(),j=(W.size||"small").toLowerCase(),re!=="AA"&&re!=="AAA"&&(re="AA"),j!=="small"&&j!=="large"&&(j="small"),{level:re,size:j}}typeof ae<"u"&&ae.exports?ae.exports=t:typeof Vr=="function"&&Vr.amd?Vr(function(){return t}):window.tinycolor=t})(Math)},{}],313:[function(c,ae,ie){"use strict";ae.exports=P,ae.exports.float32=ae.exports.float=P,ae.exports.fract32=ae.exports.fract=k;var b=new Float32Array(1);function k(E,e){if(E.length){if(E instanceof Float32Array)return new Float32Array(E.length);e instanceof Float32Array||(e=P(E));for(var p=0,g=e.length;p<g;p++)e[p]=E[p]-e[p];return e}return P(E-P(E))}function P(E){return E.length?E instanceof Float32Array?E:new Float32Array(E):(b[0]=E,b[0])}},{}],314:[function(c,ae,ie){"use strict";var b=c("parse-unit");ae.exports=e;var k=96;function P(p,g){var a=b(getComputedStyle(p).getPropertyValue(g));return a[0]*e(a[1],p)}function E(p,g){var a=document.createElement("div");a.style["font-size"]="128"+p,g.appendChild(a);var t=P(a,"font-size")/128;return g.removeChild(a),t}function e(p,g){switch(g=g||document.body,p=(p||"px").trim().toLowerCase(),(g===window||g===document)&&(g=document.body),p){case"%":return g.clientHeight/100;case"ch":case"ex":return E(p,g);case"em":return P(g,"font-size");case"rem":return P(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return k;case"cm":return k/2.54;case"mm":return k/25.4;case"pt":return k/72;case"pc":return k/6}return 1}},{"parse-unit":251}],315:[function(c,ae,ie){(function(b,k){typeof ie=="object"&&typeof ae<"u"?k(ie):typeof Vr=="function"&&Vr.amd?Vr(["exports"],k):(b=b||self,k(b.topojson=b.topojson||{}))})(this,function(b){"use strict";function k(l){return l}function P(l){if(l==null)return k;var y,T,w=l.scale[0],A=l.scale[1],f=l.translate[0],u=l.translate[1];return function(h,o){o||(y=T=0);var S=2,R=h.length,z=new Array(R);for(z[0]=(y+=h[0])*w+f,z[1]=(T+=h[1])*A+u;S<R;)z[S]=h[S],++S;return z}}function E(l){var y=P(l.transform),T,w=1/0,A=w,f=-w,u=-w;function h(S){S=y(S),S[0]<w&&(w=S[0]),S[0]>f&&(f=S[0]),S[1]<A&&(A=S[1]),S[1]>u&&(u=S[1])}function o(S){switch(S.type){case"GeometryCollection":S.geometries.forEach(o);break;case"Point":h(S.coordinates);break;case"MultiPoint":S.coordinates.forEach(h);break}}l.arcs.forEach(function(S){for(var R=-1,z=S.length,O;++R<z;)O=y(S[R],R),O[0]<w&&(w=O[0]),O[0]>f&&(f=O[0]),O[1]<A&&(A=O[1]),O[1]>u&&(u=O[1])});for(T in l.objects)o(l.objects[T]);return[w,A,f,u]}function e(l,y){for(var T,w=l.length,A=w-y;A<--w;)T=l[A],l[A++]=l[w],l[w]=T}function p(l,y){return typeof y=="string"&&(y=l.objects[y]),y.type==="GeometryCollection"?{type:"FeatureCollection",features:y.geometries.map(function(T){return g(l,T)})}:g(l,y)}function g(l,y){var T=y.id,w=y.bbox,A=y.properties==null?{}:y.properties,f=a(l,y);return T==null&&w==null?{type:"Feature",properties:A,geometry:f}:w==null?{type:"Feature",id:T,properties:A,geometry:f}:{type:"Feature",id:T,bbox:w,properties:A,geometry:f}}function a(l,y){var T=P(l.transform),w=l.arcs;function A(R,z){z.length&&z.pop();for(var O=w[R<0?~R:R],I=0,F=O.length;I<F;++I)z.push(T(O[I],I));R<0&&e(z,F)}function f(R){return T(R)}function u(R){for(var z=[],O=0,I=R.length;O<I;++O)A(R[O],z);return z.length<2&&z.push(z[0]),z}function h(R){for(var z=u(R);z.length<4;)z.push(z[0]);return z}function o(R){return R.map(h)}function S(R){var z=R.type,O;switch(z){case"GeometryCollection":return{type:z,geometries:R.geometries.map(S)};case"Point":O=f(R.coordinates);break;case"MultiPoint":O=R.coordinates.map(f);break;case"LineString":O=u(R.arcs);break;case"MultiLineString":O=R.arcs.map(u);break;case"Polygon":O=o(R.arcs);break;case"MultiPolygon":O=R.arcs.map(o);break;default:return null}return{type:z,coordinates:O}}return S(y)}function t(l,y){var T={},w={},A={},f=[],u=-1;y.forEach(function(S,R){var z=l.arcs[S<0?~S:S],O;z.length<3&&!z[1][0]&&!z[1][1]&&(O=y[++u],y[u]=S,y[R]=O)}),y.forEach(function(S){var R=h(S),z=R[0],O=R[1],I,F;if(I=A[z])if(delete A[I.end],I.push(S),I.end=O,F=w[O]){delete w[F.start];var D=F===I?I:I.concat(F);w[D.start=I.start]=A[D.end=F.end]=D}else w[I.start]=A[I.end]=I;else if(I=w[O])if(delete w[I.start],I.unshift(S),I.start=z,F=A[z]){delete A[F.end];var B=F===I?I:F.concat(I);w[B.start=F.start]=A[B.end=I.end]=B}else w[I.start]=A[I.end]=I;else I=[S],w[I.start=z]=A[I.end=O]=I});function h(S){var R=l.arcs[S<0?~S:S],z=R[0],O;return l.transform?(O=[0,0],R.forEach(function(I){O[0]+=I[0],O[1]+=I[1]})):O=R[R.length-1],S<0?[O,z]:[z,O]}function o(S,R){for(var z in S){var O=S[z];delete R[O.start],delete O.start,delete O.end,O.forEach(function(I){T[I<0?~I:I]=1}),f.push(O)}}return o(A,w),o(w,A),y.forEach(function(S){T[S<0?~S:S]||f.push([S])}),f}function i(l){return a(l,n.apply(this,arguments))}function n(l,y,T){var w,A,f;if(arguments.length>1)w=r(l,y,T);else for(A=0,w=new Array(f=l.arcs.length);A<f;++A)w[A]=A;return{type:"MultiLineString",arcs:t(l,w)}}function r(l,y,T){var w=[],A=[],f;function u(z){var O=z<0?~z:z;(A[O]||(A[O]=[])).push({i:z,g:f})}function h(z){z.forEach(u)}function o(z){z.forEach(h)}function S(z){z.forEach(o)}function R(z){switch(f=z,z.type){case"GeometryCollection":z.geometries.forEach(R);break;case"LineString":h(z.arcs);break;case"MultiLineString":case"Polygon":o(z.arcs);break;case"MultiPolygon":S(z.arcs);break}}return R(y),A.forEach(T==null?function(z){w.push(z[0].i)}:function(z){T(z[0].g,z[z.length-1].g)&&w.push(z[0].i)}),w}function d(l){for(var y=-1,T=l.length,w,A=l[T-1],f=0;++y<T;)w=A,A=l[y],f+=w[0]*A[1]-w[1]*A[0];return Math.abs(f)}function s(l){return a(l,m.apply(this,arguments))}function m(l,y){var T={},w=[],A=[];y.forEach(f);function f(o){switch(o.type){case"GeometryCollection":o.geometries.forEach(f);break;case"Polygon":u(o.arcs);break;case"MultiPolygon":o.arcs.forEach(u);break}}function u(o){o.forEach(function(S){S.forEach(function(R){(T[R=R<0?~R:R]||(T[R]=[])).push(o)})}),w.push(o)}function h(o){return d(a(l,{type:"Polygon",arcs:[o]}).coordinates[0])}return w.forEach(function(o){if(!o._){var S=[],R=[o];for(o._=1,A.push(S);o=R.pop();)S.push(o),o.forEach(function(z){z.forEach(function(O){T[O<0?~O:O].forEach(function(I){I._||(I._=1,R.push(I))})})})}}),w.forEach(function(o){delete o._}),{type:"MultiPolygon",arcs:A.map(function(o){var S=[],R;if(o.forEach(function(D){D.forEach(function(B){B.forEach(function(U){T[U<0?~U:U].length<2&&S.push(U)})})}),S=t(l,S),(R=S.length)>1)for(var z=1,O=h(S[0]),I,F;z<R;++z)(I=h(S[z]))>O&&(F=S[0],S[0]=S[z],S[z]=F,O=I);return S}).filter(function(o){return o.length>0})}}function x(l,y){for(var T=0,w=l.length;T<w;){var A=T+w>>>1;l[A]<y?T=A+1:w=A}return T}function M(l){var y={},T=l.map(function(){return[]});function w(D,B){D.forEach(function(U){U<0&&(U=~U);var X=y[U];X?X.push(B):y[U]=[B]})}function A(D,B){D.forEach(function(U){w(U,B)})}function f(D,B){D.type==="GeometryCollection"?D.geometries.forEach(function(U){f(U,B)}):D.type in u&&u[D.type](D.arcs,B)}var u={LineString:w,MultiLineString:A,Polygon:A,MultiPolygon:function(D,B){D.forEach(function(U){A(U,B)})}};l.forEach(f);for(var h in y)for(var o=y[h],S=o.length,R=0;R<S;++R)for(var z=R+1;z<S;++z){var O=o[R],I=o[z],F;(F=T[O])[h=x(F,I)]!==I&&F.splice(h,0,I),(F=T[I])[h=x(F,O)]!==O&&F.splice(h,0,O)}return T}function v(l){if(l==null)return k;var y,T,w=l.scale[0],A=l.scale[1],f=l.translate[0],u=l.translate[1];return function(h,o){o||(y=T=0);var S=2,R=h.length,z=new Array(R),O=Math.round((h[0]-f)/w),I=Math.round((h[1]-u)/A);for(z[0]=O-y,y=O,z[1]=I-T,T=I;S<R;)z[S]=h[S],++S;return z}}function _(l,y){if(l.transform)throw new Error("already quantized");if(!y||!y.scale){if(!((u=Math.floor(y))>=2))throw new Error("n must be \u22652");o=l.bbox||E(l);var T=o[0],w=o[1],A=o[2],f=o[3],u;y={scale:[A-T?(A-T)/(u-1):1,f-w?(f-w)/(u-1):1],translate:[T,w]}}else o=l.bbox;var h=v(y),o,S,R=l.objects,z={};function O(D){return h(D)}function I(D){var B;switch(D.type){case"GeometryCollection":B={type:"GeometryCollection",geometries:D.geometries.map(I)};break;case"Point":B={type:"Point",coordinates:O(D.coordinates)};break;case"MultiPoint":B={type:"MultiPoint",coordinates:D.coordinates.map(O)};break;default:return D}return D.id!=null&&(B.id=D.id),D.bbox!=null&&(B.bbox=D.bbox),D.properties!=null&&(B.properties=D.properties),B}function F(D){var B=0,U=1,X=D.length,oe,se=new Array(X);for(se[0]=h(D[0],0);++B<X;)((oe=h(D[B],B))[0]||oe[1])&&(se[U++]=oe);return U===1&&(se[U++]=[0,0]),se.length=U,se}for(S in R)z[S]=I(R[S]);return{type:"Topology",bbox:o,transform:y,objects:z,arcs:l.arcs.map(F)}}b.bbox=E,b.feature=p,b.merge=s,b.mergeArcs=m,b.mesh=i,b.meshArcs=n,b.neighbors=M,b.quantize=_,b.transform=P,b.untransform=v,Object.defineProperty(b,"__esModule",{value:!0})})},{}],316:[function(c,ae,ie){"use strict";var b=c("../prototype/is");ae.exports=function(k){if(typeof k!="function"||!hasOwnProperty.call(k,"length"))return!1;try{if(typeof k.length!="number"||typeof k.call!="function"||typeof k.apply!="function")return!1}catch{return!1}return!b(k)}},{"../prototype/is":323}],317:[function(c,ae,ie){"use strict";var b=c("../value/is"),k=c("../object/is"),P=c("../string/coerce"),E=c("./to-short-string"),e=function(p,g){return p.replace("%v",E(g))};ae.exports=function(p,g,a){if(!k(a))throw new TypeError(e(g,p));if(!b(p)){if("default"in a)return a.default;if(a.isOptional)return null}var t=P(a.errorMessage);throw b(t)||(t=g),new TypeError(e(t,p))}},{"../object/is":320,"../string/coerce":324,"../value/is":326,"./to-short-string":319}],318:[function(c,ae,ie){"use strict";ae.exports=function(b){try{return b.toString()}catch{try{return String(b)}catch{return null}}}},{}],319:[function(c,ae,ie){"use strict";var b=c("./safe-to-string"),k=/[\n\r\u2028\u2029]/g;ae.exports=function(P){var E=b(P);return E===null?"<Non-coercible to string value>":(E.length>100&&(E=E.slice(0,99)+"\u2026"),E=E.replace(k,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}),E)}},{"./safe-to-string":318}],320:[function(c,ae,ie){"use strict";var b=c("../value/is"),k={object:!0,function:!0,undefined:!0};ae.exports=function(P){return b(P)?hasOwnProperty.call(k,typeof P):!1}},{"../value/is":326}],321:[function(c,ae,ie){"use strict";var b=c("../lib/resolve-exception"),k=c("./is");ae.exports=function(P){return k(P)?P:b(P,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":317,"./is":322}],322:[function(c,ae,ie){"use strict";var b=c("../function/is"),k=/^\s*class[\s{/}]/,P=Function.prototype.toString;ae.exports=function(E){return!(!b(E)||k.test(P.call(E)))}},{"../function/is":316}],323:[function(c,ae,ie){"use strict";var b=c("../object/is");ae.exports=function(k){if(!b(k))return!1;try{return k.constructor?k.constructor.prototype===k:!1}catch{return!1}}},{"../object/is":320}],324:[function(c,ae,ie){"use strict";var b=c("../value/is"),k=c("../object/is"),P=Object.prototype.toString;ae.exports=function(E){if(!b(E))return null;if(k(E)){var e=E.toString;if(typeof e!="function"||e===P)return null}try{return""+E}catch{return null}}},{"../object/is":320,"../value/is":326}],325:[function(c,ae,ie){"use strict";var b=c("../lib/resolve-exception"),k=c("./is");ae.exports=function(P){return k(P)?P:b(P,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":317,"./is":326}],326:[function(c,ae,ie){"use strict";var b=void 0;ae.exports=function(k){return k!==b&&k!==null}},{}],327:[function(c,ae,ie){(function(b){(function(){"use strict";var k=c("bit-twiddle"),P=c("dup"),E=c("buffer").Buffer;b.__TYPEDARRAY_POOL||(b.__TYPEDARRAY_POOL={UINT8:P([32,0]),UINT16:P([32,0]),UINT32:P([32,0]),BIGUINT64:P([32,0]),INT8:P([32,0]),INT16:P([32,0]),INT32:P([32,0]),BIGINT64:P([32,0]),FLOAT:P([32,0]),DOUBLE:P([32,0]),DATA:P([32,0]),UINT8C:P([32,0]),BUFFER:P([32,0])});var e=typeof Uint8ClampedArray<"u",p=typeof BigUint64Array<"u",g=typeof BigInt64Array<"u",a=b.__TYPEDARRAY_POOL;a.UINT8C||(a.UINT8C=P([32,0])),a.BIGUINT64||(a.BIGUINT64=P([32,0])),a.BIGINT64||(a.BIGINT64=P([32,0])),a.BUFFER||(a.BUFFER=P([32,0]));var t=a.DATA,i=a.BUFFER;ie.free=function(o){if(E.isBuffer(o))i[k.log2(o.length)].push(o);else{if(Object.prototype.toString.call(o)!=="[object ArrayBuffer]"&&(o=o.buffer),!o)return;var S=o.length||o.byteLength,R=k.log2(S)|0;t[R].push(o)}};function n(h){if(!!h){var o=h.length||h.byteLength,S=k.log2(o);t[S].push(h)}}function r(h){n(h.buffer)}ie.freeUint8=ie.freeUint16=ie.freeUint32=ie.freeBigUint64=ie.freeInt8=ie.freeInt16=ie.freeInt32=ie.freeBigInt64=ie.freeFloat32=ie.freeFloat=ie.freeFloat64=ie.freeDouble=ie.freeUint8Clamped=ie.freeDataView=r,ie.freeArrayBuffer=n,ie.freeBuffer=function(o){i[k.log2(o.length)].push(o)},ie.malloc=function(o,S){if(S===void 0||S==="arraybuffer")return d(o);switch(S){case"uint8":return s(o);case"uint16":return m(o);case"uint32":return x(o);case"int8":return M(o);case"int16":return v(o);case"int32":return _(o);case"float":case"float32":return l(o);case"double":case"float64":return y(o);case"uint8_clamped":return T(o);case"bigint64":return A(o);case"biguint64":return w(o);case"buffer":return u(o);case"data":case"dataview":return f(o);default:return null}return null};function d(o){var o=k.nextPow2(o),S=k.log2(o),R=t[S];return R.length>0?R.pop():new ArrayBuffer(o)}ie.mallocArrayBuffer=d;function s(h){return new Uint8Array(d(h),0,h)}ie.mallocUint8=s;function m(h){return new Uint16Array(d(2*h),0,h)}ie.mallocUint16=m;function x(h){return new Uint32Array(d(4*h),0,h)}ie.mallocUint32=x;function M(h){return new Int8Array(d(h),0,h)}ie.mallocInt8=M;function v(h){return new Int16Array(d(2*h),0,h)}ie.mallocInt16=v;function _(h){return new Int32Array(d(4*h),0,h)}ie.mallocInt32=_;function l(h){return new Float32Array(d(4*h),0,h)}ie.mallocFloat32=ie.mallocFloat=l;function y(h){return new Float64Array(d(8*h),0,h)}ie.mallocFloat64=ie.mallocDouble=y;function T(h){return e?new Uint8ClampedArray(d(h),0,h):s(h)}ie.mallocUint8Clamped=T;function w(h){return p?new BigUint64Array(d(8*h),0,h):null}ie.mallocBigUint64=w;function A(h){return g?new BigInt64Array(d(8*h),0,h):null}ie.mallocBigInt64=A;function f(h){return new DataView(d(h),0,h)}ie.mallocDataView=f;function u(h){h=k.nextPow2(h);var o=k.log2(h),S=i[o];return S.length>0?S.pop():new E(h)}ie.mallocBuffer=u,ie.clearCache=function(){for(var o=0;o<32;++o)a.UINT8[o].length=0,a.UINT16[o].length=0,a.UINT32[o].length=0,a.INT8[o].length=0,a.INT16[o].length=0,a.INT32[o].length=0,a.FLOAT[o].length=0,a.DOUBLE[o].length=0,a.BIGUINT64[o].length=0,a.BIGINT64[o].length=0,a.UINT8C[o].length=0,t[o].length=0,i[o].length=0}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],328:[function(c,ae,ie){var b=/[\'\"]/;ae.exports=function(P){return P?(b.test(P.charAt(0))&&(P=P.substr(1)),b.test(P.charAt(P.length-1))&&(P=P.substr(0,P.length-1)),P):""}},{}],329:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E){Array.isArray(E)||(E=[].slice.call(arguments,2));for(var e=0,p=E.length;e<p;e++){var g=E[e];for(var a in g)if(!(P[a]!==void 0&&!Array.isArray(P[a])&&k[a]===P[a])&&a in P){var t;if(g[a]===!0)t=P[a];else{if(g[a]===!1)continue;if(typeof g[a]=="function"&&(t=g[a](P[a],k,P),t===void 0))continue}k[a]=t}}return k}},{}],330:[function(c,ae,ie){(function(b){(function(){ae.exports=k;function k(E,e){if(P("noDeprecation"))return E;var p=!1;function g(){if(!p){if(P("throwDeprecation"))throw new Error(e);P("traceDeprecation")?console.trace(e):console.warn(e),p=!0}return E.apply(this,arguments)}return g}function P(E){try{if(!b.localStorage)return!1}catch{return!1}var e=b.localStorage[E];return e==null?!1:String(e).toLowerCase()==="true"}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],331:[function(c,ae,ie){var b=c("get-canvas-context");ae.exports=function(P){return b("webgl",P)}},{"get-canvas-context":194}],332:[function(c,ae,ie){var b=c("../main"),k=c("object-assign"),P=b.instance();function E(d){this.local=this.regionalOptions[d||""]||this.regionalOptions[""]}E.prototype=new b.baseCalendar,k(E.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(d,s){if(typeof d=="string"){var m=d.match(p);return m?m[0]:""}var x=this._validateYear(d),M=d.month(),v=""+this.toChineseMonth(x,M);return s&&v.length<2&&(v="0"+v),this.isIntercalaryMonth(x,M)&&(v+="i"),v},monthNames:function(d){if(typeof d=="string"){var s=d.match(g);return s?s[0]:""}var m=this._validateYear(d),x=d.month(),M=this.toChineseMonth(m,x),v=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][M-1];return this.isIntercalaryMonth(m,x)&&(v="\u95F0"+v),v},monthNamesShort:function(d){if(typeof d=="string"){var s=d.match(a);return s?s[0]:""}var m=this._validateYear(d),x=d.month(),M=this.toChineseMonth(m,x),v=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][M-1];return this.isIntercalaryMonth(m,x)&&(v="\u95F0"+v),v},parseMonth:function(d,s){d=this._validateYear(d);var m=parseInt(s),x;if(isNaN(m))s[0]==="\u95F0"&&(x=!0,s=s.substring(1)),s[s.length-1]==="\u6708"&&(s=s.substring(0,s.length-1)),m=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(s);else{var M=s[s.length-1];x=M==="i"||M==="I"}var v=this.toMonthIndex(d,m,x);return v},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(d,s){if(d.year&&(d=d.year()),typeof d!="number"||d<1888||d>2111)throw s.replace(/\{0\}/,this.local.name);return d},toMonthIndex:function(d,s,m){var x=this.intercalaryMonth(d),M=m&&s!==x;if(M||s<1||s>12)throw b.local.invalidMonth.replace(/\{0\}/,this.local.name);var v;return x?!m&&s<=x?v=s-1:v=s:v=s-1,v},toChineseMonth:function(d,s){d.year&&(d=d.year(),s=d.month());var m=this.intercalaryMonth(d),x=m?12:11;if(s<0||s>x)throw b.local.invalidMonth.replace(/\{0\}/,this.local.name);var M;return m?s<m?M=s+1:M=s:M=s+1,M},intercalaryMonth:function(d){d=this._validateYear(d);var s=t[d-t[0]],m=s>>13;return m},isIntercalaryMonth:function(d,s){d.year&&(d=d.year(),s=d.month());var m=this.intercalaryMonth(d);return!!m&&m===s},leapYear:function(d){return this.intercalaryMonth(d)!==0},weekOfYear:function(d,s,m){var x=this._validateYear(d,b.local.invalidyear),M=i[x-i[0]],v=M>>9&4095,_=M>>5&15,l=M&31,y;y=P.newDate(v,_,l),y.add(4-(y.dayOfWeek()||7),"d");var T=this.toJD(d,s,m)-y.toJD();return 1+Math.floor(T/7)},monthsInYear:function(d){return this.leapYear(d)?13:12},daysInMonth:function(d,s){d.year&&(s=d.month(),d=d.year()),d=this._validateYear(d);var m=t[d-t[0]],x=m>>13,M=x?12:11;if(s>M)throw b.local.invalidMonth.replace(/\{0\}/,this.local.name);var v=m&1<<12-s?30:29;return v},weekDay:function(d,s,m){return(this.dayOfWeek(d,s,m)||7)<6},toJD:function(d,s,m){var x=this._validate(d,v,m,b.local.invalidDate);d=this._validateYear(x.year()),s=x.month(),m=x.day();var M=this.isIntercalaryMonth(d,s),v=this.toChineseMonth(d,s),_=r(d,v,m,M);return P.toJD(_.year,_.month,_.day)},fromJD:function(d){var s=P.fromJD(d),m=n(s.year(),s.month(),s.day()),x=this.toMonthIndex(m.year,m.month,m.isIntercalary);return this.newDate(m.year,x,m.day)},fromString:function(d){var s=d.match(e),m=this._validateYear(+s[1]),x=+s[2],M=!!s[3],v=this.toMonthIndex(m,x,M),_=+s[4];return this.newDate(m,v,_)},add:function(d,s,m){var x=d.year(),M=d.month(),v=this.isIntercalaryMonth(x,M),_=this.toChineseMonth(x,M),l=Object.getPrototypeOf(E.prototype).add.call(this,d,s,m);if(m==="y"){var y=l.year(),T=l.month(),w=this.isIntercalaryMonth(y,_),A=v&&w?this.toMonthIndex(y,_,!0):this.toMonthIndex(y,_,!1);A!==T&&l.month(A)}return l}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,p=/^\d?\d[iI]?/m,g=/^??[]?/m,a=/^??[]?/m;b.calendars.chinese=E;var t=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],i=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function n(d,s,m,x){var M,v;if(typeof d=="object")M=d,v=s||{};else{var _=typeof d=="number"&&d>=1888&&d<=2111;if(!_)throw new Error("Solar year outside range 1888-2111");var l=typeof s=="number"&&s>=1&&s<=12;if(!l)throw new Error("Solar month outside range 1 - 12");var y=typeof m=="number"&&m>=1&&m<=31;if(!y)throw new Error("Solar day outside range 1 - 31");M={year:d,month:s,day:m},v=x||{}}var T=i[M.year-i[0]],w=M.year<<9|M.month<<5|M.day;v.year=w>=T?M.year:M.year-1,T=i[v.year-i[0]];var A=T>>9&4095,f=T>>5&15,u=T&31,h,o=new Date(A,f-1,u),S=new Date(M.year,M.month-1,M.day);h=Math.round((S-o)/(24*3600*1e3));var R=t[v.year-t[0]],z;for(z=0;z<13;z++){var O=R&1<<12-z?30:29;if(h<O)break;h-=O}var I=R>>13;return!I||z<I?(v.isIntercalary=!1,v.month=1+z):z===I?(v.isIntercalary=!0,v.month=z):(v.isIntercalary=!1,v.month=z),v.day=1+h,v}function r(d,s,m,x,M){var v,_;if(typeof d=="object")_=d,v=s||{};else{var l=typeof d=="number"&&d>=1888&&d<=2111;if(!l)throw new Error("Lunar year outside range 1888-2111");var y=typeof s=="number"&&s>=1&&s<=12;if(!y)throw new Error("Lunar month outside range 1 - 12");var T=typeof m=="number"&&m>=1&&m<=30;if(!T)throw new Error("Lunar day outside range 1 - 30");var w;typeof x=="object"?(w=!1,v=x):(w=!!x,v=M||{}),_={year:d,month:s,day:m,isIntercalary:w}}var A;A=_.day-1;var f=t[_.year-t[0]],u=f>>13,h;u&&(_.month>u||_.isIntercalary)?h=_.month:h=_.month-1;for(var o=0;o<h;o++){var S=f&1<<12-o?30:29;A+=S}var R=i[_.year-i[0]],z=R>>9&4095,O=R>>5&15,I=R&31,F=new Date(z,O-1,I+A);return v.year=F.getFullYear(),v.month=1+F.getMonth(),v.day=F.getDate(),v}},{"../main":346,"object-assign":247}],333:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(E){this.local=this.regionalOptions[E||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(p){var e=this._validate(p,this.minMonth,this.minDay,b.local.invalidYear),p=e.year()+(e.year()<0?1:0);return p%4===3||p%4===-1},monthsInYear:function(E){return this._validate(E,this.minMonth,this.minDay,b.local.invalidYear||b.regionalOptions[""].invalidYear),13},weekOfYear:function(E,e,p){var g=this.newDate(E,e,p);return g.add(-g.dayOfWeek(),"d"),Math.floor((g.dayOfYear()-1)/7)+1},daysInMonth:function(E,e){var p=this._validate(E,e,this.minDay,b.local.invalidMonth);return this.daysPerMonth[p.month()-1]+(p.month()===13&&this.leapYear(p.year())?1:0)},weekDay:function(E,e,p){return(this.dayOfWeek(E,e,p)||7)<6},toJD:function(E,e,p){var g=this._validate(E,e,p,b.local.invalidDate);return E=g.year(),E<0&&E++,g.day()+(g.month()-1)*30+(E-1)*365+Math.floor(E/4)+this.jdEpoch-1},fromJD:function(E){var e=Math.floor(E)+.5-this.jdEpoch,p=Math.floor((e-Math.floor((e+366)/1461))/365)+1;p<=0&&p--,e=Math.floor(E)+.5-this.newDate(p,1,1).toJD();var g=Math.floor(e/30)+1,a=e-(g-1)*30+1;return this.newDate(p,g,a)}}),b.calendars.coptic=P},{"../main":346,"object-assign":247}],334:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,b.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,b.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,b.local.invalidYear),400},weekOfYear:function(e,p,g){var a=this.newDate(e,p,g);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/8)+1},daysInMonth:function(e,p){var g=this._validate(e,p,this.minDay,b.local.invalidMonth);return this.daysPerMonth[g.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,p,g){var a=this._validate(e,p,g,b.local.invalidDate);return(a.day()+1)%8},weekDay:function(e,p,g){var a=this.dayOfWeek(e,p,g);return a>=2&&a<=6},extraInfo:function(e,p,g){var a=this._validate(e,p,g,b.local.invalidDate);return{century:E[Math.floor((a.year()-1)/100)+1]||""}},toJD:function(e,p,g){var a=this._validate(e,p,g,b.local.invalidDate);return e=a.year()+(a.year()<0?1:0),p=a.month(),g=a.day(),g+(p>1?16:0)+(p>2?(p-2)*32:0)+(e-1)*400+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var p=Math.floor(e/400)+1;e-=(p-1)*400,e+=e>15?16:0;var g=Math.floor(e/32)+1,a=e-(g-1)*32+1;return this.newDate(p<=0?p-1:p,g,a)}});var E={20:"Fruitbat",21:"Anchovy"};b.calendars.discworld=P},{"../main":346,"object-assign":247}],335:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(E){this.local=this.regionalOptions[E||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(p){var e=this._validate(p,this.minMonth,this.minDay,b.local.invalidYear),p=e.year()+(e.year()<0?1:0);return p%4===3||p%4===-1},monthsInYear:function(E){return this._validate(E,this.minMonth,this.minDay,b.local.invalidYear||b.regionalOptions[""].invalidYear),13},weekOfYear:function(E,e,p){var g=this.newDate(E,e,p);return g.add(-g.dayOfWeek(),"d"),Math.floor((g.dayOfYear()-1)/7)+1},daysInMonth:function(E,e){var p=this._validate(E,e,this.minDay,b.local.invalidMonth);return this.daysPerMonth[p.month()-1]+(p.month()===13&&this.leapYear(p.year())?1:0)},weekDay:function(E,e,p){return(this.dayOfWeek(E,e,p)||7)<6},toJD:function(E,e,p){var g=this._validate(E,e,p,b.local.invalidDate);return E=g.year(),E<0&&E++,g.day()+(g.month()-1)*30+(E-1)*365+Math.floor(E/4)+this.jdEpoch-1},fromJD:function(E){var e=Math.floor(E)+.5-this.jdEpoch,p=Math.floor((e-Math.floor((e+366)/1461))/365)+1;p<=0&&p--,e=Math.floor(E)+.5-this.newDate(p,1,1).toJD();var g=Math.floor(e/30)+1,a=e-(g-1)*30+1;return this.newDate(p,g,a)}}),b.calendars.ethiopian=P},{"../main":346,"object-assign":247}],336:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var p=this._validate(e,this.minMonth,this.minDay,b.local.invalidYear);return this._leapYear(p.year())},_leapYear:function(e){return e=e<0?e+1:e,E(e*7+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,b.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,p,g){var a=this.newDate(e,p,g);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){var p=this._validate(e,this.minMonth,this.minDay,b.local.invalidYear);return e=p.year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,p){return e.year&&(p=e.month(),e=e.year()),this._validate(e,p,this.minDay,b.local.invalidMonth),p===12&&this.leapYear(e)||p===8&&E(this.daysInYear(e),10)===5?30:p===9&&E(this.daysInYear(e),10)===3?29:this.daysPerMonth[p-1]},weekDay:function(e,p,g){return this.dayOfWeek(e,p,g)!==6},extraInfo:function(e,p,g){var a=this._validate(e,p,g,b.local.invalidDate);return{yearType:(this.leapYear(a)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(a)%10-3]}},toJD:function(e,p,g){var a=this._validate(e,p,g,b.local.invalidDate);e=a.year(),p=a.month(),g=a.day();var t=e<=0?e+1:e,i=this.jdEpoch+this._delay1(t)+this._delay2(t)+g+1;if(p<7){for(var n=7;n<=this.monthsInYear(e);n++)i+=this.daysInMonth(e,n);for(var n=1;n<p;n++)i+=this.daysInMonth(e,n)}else for(var n=7;n<p;n++)i+=this.daysInMonth(e,n);return i},_delay1:function(e){var p=Math.floor((235*e-234)/19),g=12084+13753*p,a=p*29+Math.floor(g/25920);return E(3*(a+1),7)<3&&a++,a},_delay2:function(e){var p=this._delay1(e-1),g=this._delay1(e),a=this._delay1(e+1);return a-g===356?2:g-p===382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var p=Math.floor((e-this.jdEpoch)*98496/35975351)-1;e>=this.toJD(p===-1?1:p+1,7,1);)p++;for(var g=e<this.toJD(p,1,1)?7:1;e>this.toJD(p,g,this.daysInMonth(p,g));)g++;var a=e-this.toJD(p,g,1)+1;return this.newDate(p,g,a)}});function E(e,p){return e-p*Math.floor(e/p)}b.calendars.hebrew=P},{"../main":346,"object-assign":247}],337:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(E){this.local=this.regionalOptions[E||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(E){var e=this._validate(E,this.minMonth,this.minDay,b.local.invalidYear);return(e.year()*11+14)%30<11},weekOfYear:function(E,e,p){var g=this.newDate(E,e,p);return g.add(-g.dayOfWeek(),"d"),Math.floor((g.dayOfYear()-1)/7)+1},daysInYear:function(E){return this.leapYear(E)?355:354},daysInMonth:function(E,e){var p=this._validate(E,e,this.minDay,b.local.invalidMonth);return this.daysPerMonth[p.month()-1]+(p.month()===12&&this.leapYear(p.year())?1:0)},weekDay:function(E,e,p){return this.dayOfWeek(E,e,p)!==5},toJD:function(E,e,p){var g=this._validate(E,e,p,b.local.invalidDate);return E=g.year(),e=g.month(),p=g.day(),E=E<=0?E+1:E,p+Math.ceil(29.5*(e-1))+(E-1)*354+Math.floor((3+11*E)/30)+this.jdEpoch-1},fromJD:function(E){E=Math.floor(E)+.5;var e=Math.floor((30*(E-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var p=Math.min(12,Math.ceil((E-29-this.toJD(e,1,1))/29.5)+1),g=E-this.toJD(e,p,1)+1;return this.newDate(e,p,g)}}),b.calendars.islamic=P},{"../main":346,"object-assign":247}],338:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(E){this.local=this.regionalOptions[E||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(p){var e=this._validate(p,this.minMonth,this.minDay,b.local.invalidYear),p=e.year()<0?e.year()+1:e.year();return p%4===0},weekOfYear:function(E,e,p){var g=this.newDate(E,e,p);return g.add(4-(g.dayOfWeek()||7),"d"),Math.floor((g.dayOfYear()-1)/7)+1},daysInMonth:function(E,e){var p=this._validate(E,e,this.minDay,b.local.invalidMonth);return this.daysPerMonth[p.month()-1]+(p.month()===2&&this.leapYear(p.year())?1:0)},weekDay:function(E,e,p){return(this.dayOfWeek(E,e,p)||7)<6},toJD:function(E,e,p){var g=this._validate(E,e,p,b.local.invalidDate);return E=g.year(),e=g.month(),p=g.day(),E<0&&E++,e<=2&&(E--,e+=12),Math.floor(365.25*(E+4716))+Math.floor(30.6001*(e+1))+p-1524.5},fromJD:function(E){var e=Math.floor(E+.5),p=e+1524,g=Math.floor((p-122.1)/365.25),a=Math.floor(365.25*g),t=Math.floor((p-a)/30.6001),i=t-Math.floor(t<14?1:13),n=g-Math.floor(i>2?4716:4715),r=p-a-Math.floor(30.6001*t);return n<=0&&n--,this.newDate(n,i,r)}}),b.calendars.julian=P},{"../main":346,"object-assign":247}],339:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(p){this.local=this.regionalOptions[p||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(p){return this._validate(p,this.minMonth,this.minDay,b.local.invalidYear),!1},formatYear:function(p){var g=this._validate(p,this.minMonth,this.minDay,b.local.invalidYear);p=g.year();var a=Math.floor(p/400);p=p%400,p+=p<0?400:0;var t=Math.floor(p/20);return a+"."+t+"."+p%20},forYear:function(p){if(p=p.split("."),p.length<3)throw"Invalid Mayan year";for(var g=0,a=0;a<p.length;a++){var t=parseInt(p[a],10);if(Math.abs(t)>19||a>0&&t<0)throw"Invalid Mayan year";g=g*20+t}return g},monthsInYear:function(p){return this._validate(p,this.minMonth,this.minDay,b.local.invalidYear),18},weekOfYear:function(p,g,a){return this._validate(p,g,a,b.local.invalidDate),0},daysInYear:function(p){return this._validate(p,this.minMonth,this.minDay,b.local.invalidYear),360},daysInMonth:function(p,g){return this._validate(p,g,this.minDay,b.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(p,g,a){var t=this._validate(p,g,a,b.local.invalidDate);return t.day()},weekDay:function(p,g,a){return this._validate(p,g,a,b.local.invalidDate),!0},extraInfo:function(p,g,a){var t=this._validate(p,g,a,b.local.invalidDate),i=t.toJD(),n=this._toHaab(i),r=this._toTzolkin(i);return{haabMonthName:this.local.haabMonths[n[0]-1],haabMonth:n[0],haabDay:n[1],tzolkinDayName:this.local.tzolkinMonths[r[0]-1],tzolkinDay:r[0],tzolkinTrecena:r[1]}},_toHaab:function(p){p-=this.jdEpoch;var g=E(p+8+(18-1)*20,365);return[Math.floor(g/20)+1,E(g,20)]},_toTzolkin:function(p){return p-=this.jdEpoch,[e(p+20,20),e(p+4,13)]},toJD:function(p,g,a){var t=this._validate(p,g,a,b.local.invalidDate);return t.day()+t.month()*20+t.year()*360+this.jdEpoch},fromJD:function(p){p=Math.floor(p)+.5-this.jdEpoch;var g=Math.floor(p/360);p=p%360,p+=p<0?360:0;var a=Math.floor(p/20),t=p%20;return this.newDate(g,a,t)}});function E(p,g){return p-g*Math.floor(p/g)}function e(p,g){return E(p-1,g)+1}b.calendars.mayan=P},{"../main":346,"object-assign":247}],340:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar;var E=b.instance("gregorian");k(P.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var p=this._validate(e,this.minMonth,this.minDay,b.local.invalidYear||b.regionalOptions[""].invalidYear);return E.leapYear(p.year()+(p.year()<1?1:0)+1469)},weekOfYear:function(e,p,g){var a=this.newDate(e,p,g);return a.add(1-(a.dayOfWeek()||7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,p){var g=this._validate(e,p,this.minDay,b.local.invalidMonth);return this.daysPerMonth[g.month()-1]+(g.month()===12&&this.leapYear(g.year())?1:0)},weekDay:function(e,p,g){return(this.dayOfWeek(e,p,g)||7)<6},toJD:function(t,p,g){var a=this._validate(t,p,g,b.local.invalidMonth),t=a.year();t<0&&t++;for(var i=a.day(),n=1;n<a.month();n++)i+=this.daysPerMonth[n-1];return i+E.toJD(t+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var p=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(p+1,1,1);)p++;for(var g=e-Math.floor(this.toJD(p,1,1)+.5)+1,a=1;g>this.daysInMonth(p,a);)g-=this.daysInMonth(p,a),a++;return this.newDate(p,a,g)}}),b.calendars.nanakshahi=P},{"../main":346,"object-assign":247}],341:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(E){this.local=this.regionalOptions[E||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(E){return this.daysInYear(E)!==this.daysPerYear},weekOfYear:function(E,e,p){var g=this.newDate(E,e,p);return g.add(-g.dayOfWeek(),"d"),Math.floor((g.dayOfYear()-1)/7)+1},daysInYear:function(E){var e=this._validate(E,this.minMonth,this.minDay,b.local.invalidYear);if(E=e.year(),typeof this.NEPALI_CALENDAR_DATA[E]>"u")return this.daysPerYear;for(var p=0,g=this.minMonth;g<=12;g++)p+=this.NEPALI_CALENDAR_DATA[E][g];return p},daysInMonth:function(E,e){return E.year&&(e=E.month(),E=E.year()),this._validate(E,e,this.minDay,b.local.invalidMonth),typeof this.NEPALI_CALENDAR_DATA[E]>"u"?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[E][e]},weekDay:function(E,e,p){return this.dayOfWeek(E,e,p)!==6},toJD:function(E,e,p){var g=this._validate(E,e,p,b.local.invalidDate);E=g.year(),e=g.month(),p=g.day();var a=b.instance(),t=0,i=e,n=E;this._createMissingCalendarData(E);var r=E-(i>9||i===9&&p>=this.NEPALI_CALENDAR_DATA[n][0]?56:57);for(e!==9&&(t=p,i--);i!==9;)i<=0&&(i=12,n--),t+=this.NEPALI_CALENDAR_DATA[n][i],i--;return e===9?(t+=p-this.NEPALI_CALENDAR_DATA[n][0],t<0&&(t+=a.daysInYear(r))):t+=this.NEPALI_CALENDAR_DATA[n][9]-this.NEPALI_CALENDAR_DATA[n][0],a.newDate(r,1,1).add(t,"d").toJD()},fromJD:function(E){var e=b.instance(),p=e.fromJD(E),g=p.year(),a=p.dayOfYear(),t=g+56;this._createMissingCalendarData(t);for(var i=9,n=this.NEPALI_CALENDAR_DATA[t][0],r=this.NEPALI_CALENDAR_DATA[t][i]-n+1;a>r;)i++,i>12&&(i=1,t++),r+=this.NEPALI_CALENDAR_DATA[t][i];var d=this.NEPALI_CALENDAR_DATA[t][i]-(r-a);return this.newDate(t,i,d)},_createMissingCalendarData:function(E){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var p=E-1;p<E+2;p++)typeof this.NEPALI_CALENDAR_DATA[p]>"u"&&(this.NEPALI_CALENDAR_DATA[p]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),b.calendars.nepali=P},{"../main":346,"object-assign":247}],342:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var p=this._validate(e,this.minMonth,this.minDay,b.local.invalidYear);return((p.year()-(p.year()>0?474:473))%2820+474+38)*682%2816<682},weekOfYear:function(e,p,g){var a=this.newDate(e,p,g);return a.add(-((a.dayOfWeek()+1)%7),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInMonth:function(e,p){var g=this._validate(e,p,this.minDay,b.local.invalidMonth);return this.daysPerMonth[g.month()-1]+(g.month()===12&&this.leapYear(g.year())?1:0)},weekDay:function(e,p,g){return this.dayOfWeek(e,p,g)!==5},toJD:function(e,p,g){var a=this._validate(e,p,g,b.local.invalidDate);e=a.year(),p=a.month(),g=a.day();var t=e-(e>=0?474:473),i=474+E(t,2820);return g+(p<=7?(p-1)*31:(p-1)*30+6)+Math.floor((i*682-110)/2816)+(i-1)*365+Math.floor(t/2820)*1029983+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e)+.5;var p=e-this.toJD(475,1,1),g=Math.floor(p/1029983),a=E(p,1029983),t=2820;if(a!==1029982){var i=Math.floor(a/366),n=E(a,366);t=Math.floor((2134*i+2816*n+2815)/1028522)+i+1}var r=t+2820*g+474;r=r<=0?r-1:r;var d=e-this.toJD(r,1,1)+1,s=d<=186?Math.ceil(d/31):Math.ceil((d-6)/30),m=e-this.toJD(r,s,1)+1;return this.newDate(r,s,m)}});function E(e,p){return e-p*Math.floor(e/p)}b.calendars.persian=P,b.calendars.jalali=P},{"../main":346,"object-assign":247}],343:[function(c,ae,ie){var b=c("../main"),k=c("object-assign"),P=b.instance();function E(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}E.prototype=new b.baseCalendar,k(E.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(g){var p=this._validate(g,this.minMonth,this.minDay,b.local.invalidYear),g=this._t2gYear(p.year());return P.leapYear(g)},weekOfYear:function(t,p,g){var a=this._validate(t,this.minMonth,this.minDay,b.local.invalidYear),t=this._t2gYear(a.year());return P.weekOfYear(t,a.month(),a.day())},daysInMonth:function(e,p){var g=this._validate(e,p,this.minDay,b.local.invalidMonth);return this.daysPerMonth[g.month()-1]+(g.month()===2&&this.leapYear(g.year())?1:0)},weekDay:function(e,p,g){return(this.dayOfWeek(e,p,g)||7)<6},toJD:function(t,p,g){var a=this._validate(t,p,g,b.local.invalidDate),t=this._t2gYear(a.year());return P.toJD(t,a.month(),a.day())},fromJD:function(e){var p=P.fromJD(e),g=this._g2tYear(p.year());return this.newDate(g,p.month(),p.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),b.calendars.taiwan=E},{"../main":346,"object-assign":247}],344:[function(c,ae,ie){var b=c("../main"),k=c("object-assign"),P=b.instance();function E(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}E.prototype=new b.baseCalendar,k(E.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(g){var p=this._validate(g,this.minMonth,this.minDay,b.local.invalidYear),g=this._t2gYear(p.year());return P.leapYear(g)},weekOfYear:function(t,p,g){var a=this._validate(t,this.minMonth,this.minDay,b.local.invalidYear),t=this._t2gYear(a.year());return P.weekOfYear(t,a.month(),a.day())},daysInMonth:function(e,p){var g=this._validate(e,p,this.minDay,b.local.invalidMonth);return this.daysPerMonth[g.month()-1]+(g.month()===2&&this.leapYear(g.year())?1:0)},weekDay:function(e,p,g){return(this.dayOfWeek(e,p,g)||7)<6},toJD:function(t,p,g){var a=this._validate(t,p,g,b.local.invalidDate),t=this._t2gYear(a.year());return P.toJD(t,a.month(),a.day())},fromJD:function(e){var p=P.fromJD(e),g=this._g2tYear(p.year());return this.newDate(g,p.month(),p.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),b.calendars.thai=E},{"../main":346,"object-assign":247}],345:[function(c,ae,ie){var b=c("../main"),k=c("object-assign");function P(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}P.prototype=new b.baseCalendar,k(P.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var p=this._validate(e,this.minMonth,this.minDay,b.local.invalidYear);return this.daysInYear(p.year())===355},weekOfYear:function(e,p,g){var a=this.newDate(e,p,g);return a.add(-a.dayOfWeek(),"d"),Math.floor((a.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var p=0,g=1;g<=12;g++)p+=this.daysInMonth(e,g);return p},daysInMonth:function(e,p){for(var g=this._validate(e,p,this.minDay,b.local.invalidMonth),a=g.toJD()-24e5+.5,t=0,i=0;i<E.length;i++){if(E[i]>a)return E[t]-E[t-1];t++}return 30},weekDay:function(e,p,g){return this.dayOfWeek(e,p,g)!==5},toJD:function(e,p,g){var a=this._validate(e,p,g,b.local.invalidDate),t=12*(a.year()-1)+a.month()-15292,i=a.day()+E[t-1]-1;return i+24e5-.5},fromJD:function(e){for(var p=e-24e5+.5,g=0,a=0;a<E.length&&!(E[a]>p);a++)g++;var t=g+15292,i=Math.floor((t-1)/12),n=i+1,r=t-12*i,d=p-E[g-1]+1;return this.newDate(n,r,d)},isValid:function(e,p,g){var a=b.baseCalendar.prototype.isValid.apply(this,arguments);return a&&(e=e.year!=null?e.year:e,a=e>=1276&&e<=1500),a},_validate:function(e,p,g,a){var t=b.baseCalendar.prototype._validate.apply(this,arguments);if(t.year<1276||t.year>1500)throw a.replace(/\{0\}/,this.local.name);return t}}),b.calendars.ummalqura=P;var E=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":346,"object-assign":247}],346:[function(c,ae,ie){var b=c("object-assign");function k(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}b(k.prototype,{instance:function(a,t){a=(a||"gregorian").toLowerCase(),t=t||"";var i=this._localCals[a+"-"+t];if(!i&&this.calendars[a]&&(i=new this.calendars[a](t),this._localCals[a+"-"+t]=i),!i)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,a);return i},newDate:function(a,t,i,n,r){return n=(a!=null&&a.year?a.calendar():typeof n=="string"?this.instance(n,r):n)||this.instance(),n.newDate(a,t,i)},substituteDigits:function(a){return function(t){return(t+"").replace(/[0-9]/g,function(i){return a[i]})}},substituteChineseDigits:function(a,t){return function(i){for(var n="",r=0;i>0;){var d=i%10;n=(d===0?"":a[d]+t[r])+n,r++,i=Math.floor(i/10)}return n.indexOf(a[1]+t[1])===0&&(n=n.substr(1)),n||a[0]}}});function P(a,t,i,n){if(this._calendar=a,this._year=t,this._month=i,this._day=n,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(g.local.invalidDate||g.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function E(a,t){return a=""+a,"000000".substring(0,t-a.length)+a}b(P.prototype,{newDate:function(a,t,i){return this._calendar.newDate(a??this,t,i)},year:function(a){return arguments.length===0?this._year:this.set(a,"y")},month:function(a){return arguments.length===0?this._month:this.set(a,"m")},day:function(a){return arguments.length===0?this._day:this.set(a,"d")},date:function(a,t,i){if(!this._calendar.isValid(a,t,i))throw(g.local.invalidDate||g.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=a,this._month=t,this._day=i,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(a,t){return this._calendar.add(this,a,t)},set:function(a,t){return this._calendar.set(this,a,t)},compareTo:function(a){if(this._calendar.name!==a._calendar.name)throw(g.local.differentCalendars||g.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,a._calendar.local.name);var t=this._year!==a._year?this._year-a._year:this._month!==a._month?this.monthOfYear()-a.monthOfYear():this._day-a._day;return t===0?0:t<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(a){return this._calendar.fromJD(a)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(a){return this._calendar.fromJSDate(a)},toString:function(){return(this.year()<0?"-":"")+E(Math.abs(this.year()),4)+"-"+E(this.month(),2)+"-"+E(this.day(),2)}});function e(){this.shortYearCutoff="+10"}b(e.prototype,{_validateLevel:0,newDate:function(a,t,i){return a==null?this.today():(a.year&&(this._validate(a,t,i,g.local.invalidDate||g.regionalOptions[""].invalidDate),i=a.day(),t=a.month(),a=a.year()),new P(this,a,t,i))},today:function(){return this.fromJSDate(new Date)},epoch:function(a){var t=this._validate(a,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear);return t.year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(a){var t=this._validate(a,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear);return(t.year()<0?"-":"")+E(Math.abs(t.year()),4)},monthsInYear:function(a){return this._validate(a,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),12},monthOfYear:function(a,t){var i=this._validate(a,t,this.minDay,g.local.invalidMonth||g.regionalOptions[""].invalidMonth);return(i.month()+this.monthsInYear(i)-this.firstMonth)%this.monthsInYear(i)+this.minMonth},fromMonthOfYear:function(a,t){var i=(t+this.firstMonth-2*this.minMonth)%this.monthsInYear(a)+this.minMonth;return this._validate(a,i,this.minDay,g.local.invalidMonth||g.regionalOptions[""].invalidMonth),i},daysInYear:function(a){var t=this._validate(a,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear);return this.leapYear(t)?366:365},dayOfYear:function(a,t,i){var n=this._validate(a,t,i,g.local.invalidDate||g.regionalOptions[""].invalidDate);return n.toJD()-this.newDate(n.year(),this.fromMonthOfYear(n.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(a,t,i){var n=this._validate(a,t,i,g.local.invalidDate||g.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(n))+2)%this.daysInWeek()},extraInfo:function(a,t,i){return this._validate(a,t,i,g.local.invalidDate||g.regionalOptions[""].invalidDate),{}},add:function(a,t,i){return this._validate(a,this.minMonth,this.minDay,g.local.invalidDate||g.regionalOptions[""].invalidDate),this._correctAdd(a,this._add(a,t,i),t,i)},_add:function(a,t,i){if(this._validateLevel++,i==="d"||i==="w"){var n=a.toJD()+t*(i==="w"?this.daysInWeek():1),r=a.calendar().fromJD(n);return this._validateLevel--,[r.year(),r.month(),r.day()]}try{var d=a.year()+(i==="y"?t:0),s=a.monthOfYear()+(i==="m"?t:0),r=a.day(),m=function(v){for(;s<v.minMonth;)d--,s+=v.monthsInYear(d);for(var _=v.monthsInYear(d);s>_-1+v.minMonth;)d++,s-=_,_=v.monthsInYear(d)};i==="y"?(a.month()!==this.fromMonthOfYear(d,s)&&(s=this.newDate(d,a.month(),this.minDay).monthOfYear()),s=Math.min(s,this.monthsInYear(d)),r=Math.min(r,this.daysInMonth(d,this.fromMonthOfYear(d,s)))):i==="m"&&(m(this),r=Math.min(r,this.daysInMonth(d,this.fromMonthOfYear(d,s))));var x=[d,this.fromMonthOfYear(d,s),r];return this._validateLevel--,x}catch(M){throw this._validateLevel--,M}},_correctAdd:function(a,t,i,n){if(!this.hasYearZero&&(n==="y"||n==="m")&&(t[0]===0||a.year()>0!=t[0]>0)){var r={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[n],d=i<0?-1:1;t=this._add(a,i*r[0]+d*r[1],r[2])}return a.date(t[0],t[1],t[2])},set:function(a,t,i){this._validate(a,this.minMonth,this.minDay,g.local.invalidDate||g.regionalOptions[""].invalidDate);var n=i==="y"?t:a.year(),r=i==="m"?t:a.month(),d=i==="d"?t:a.day();return(i==="y"||i==="m")&&(d=Math.min(d,this.daysInMonth(n,r))),a.date(n,r,d)},isValid:function(a,t,i){this._validateLevel++;var n=this.hasYearZero||a!==0;if(n){var r=this.newDate(a,t,this.minDay);n=t>=this.minMonth&&t-this.minMonth<this.monthsInYear(r)&&i>=this.minDay&&i-this.minDay<this.daysInMonth(r)}return this._validateLevel--,n},toJSDate:function(a,t,i){var n=this._validate(a,t,i,g.local.invalidDate||g.regionalOptions[""].invalidDate);return g.instance().fromJD(this.toJD(n)).toJSDate()},fromJSDate:function(a){return this.fromJD(g.instance().fromJSDate(a).toJD())},_validate:function(a,t,i,n){if(a.year){if(this._validateLevel===0&&this.name!==a.calendar().name)throw(g.local.differentCalendars||g.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,a.calendar().local.name);return a}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(a,t,i))throw n.replace(/\{0\}/,this.local.name);var r=this.newDate(a,t,i);return this._validateLevel--,r}catch(d){throw this._validateLevel--,d}}});function p(a){this.local=this.regionalOptions[a]||this.regionalOptions[""]}p.prototype=new e,b(p.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(i){var t=this._validate(i,this.minMonth,this.minDay,g.local.invalidYear||g.regionalOptions[""].invalidYear),i=t.year()+(t.year()<0?1:0);return i%4===0&&(i%100!==0||i%400===0)},weekOfYear:function(a,t,i){var n=this.newDate(a,t,i);return n.add(4-(n.dayOfWeek()||7),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(a,t){var i=this._validate(a,t,this.minDay,g.local.invalidMonth||g.regionalOptions[""].invalidMonth);return this.daysPerMonth[i.month()-1]+(i.month()===2&&this.leapYear(i.year())?1:0)},weekDay:function(a,t,i){return(this.dayOfWeek(a,t,i)||7)<6},toJD:function(a,t,i){var n=this._validate(a,t,i,g.local.invalidDate||g.regionalOptions[""].invalidDate);a=n.year(),t=n.month(),i=n.day(),a<0&&a++,t<3&&(t+=12,a--);var r=Math.floor(a/100),d=2-r+Math.floor(r/4);return Math.floor(365.25*(a+4716))+Math.floor(30.6001*(t+1))+i+d-1524.5},fromJD:function(a){var t=Math.floor(a+.5),i=Math.floor((t-186721625e-2)/36524.25);i=t+1+i-Math.floor(i/4);var n=i+1524,r=Math.floor((n-122.1)/365.25),d=Math.floor(365.25*r),s=Math.floor((n-d)/30.6001),m=n-d-Math.floor(s*30.6001),x=s-(s>13.5?13:1),M=r-(x>2.5?4716:4715);return M<=0&&M--,this.newDate(M,x,m)},toJSDate:function(a,t,i){var n=this._validate(a,t,i,g.local.invalidDate||g.regionalOptions[""].invalidDate),r=new Date(n.year(),n.month()-1,n.day());return r.setHours(0),r.setMinutes(0),r.setSeconds(0),r.setMilliseconds(0),r.setHours(r.getHours()>12?r.getHours()+2:0),r},fromJSDate:function(a){return this.newDate(a.getFullYear(),a.getMonth()+1,a.getDate())}});var g=ae.exports=new k;g.cdate=P,g.baseCalendar=e,g.calendars.gregorian=p},{"object-assign":247}],347:[function(c,ae,ie){var b=c("object-assign"),k=c("./main");b(k.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),k.local=k.regionalOptions[""],b(k.cdate.prototype,{formatDate:function(P,E){return typeof P!="string"&&(E=P,P=""),this._calendar.formatDate(P||"",this,E)}}),b(k.baseCalendar.prototype,{UNIX_EPOCH:k.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:24*60*60,TICKS_EPOCH:k.instance().jdEpoch,TICKS_PER_DAY:24*60*60*1e7,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(P,E,e){if(typeof P!="string"&&(e=E,E=P,P=""),!E)return"";if(E.calendar()!==this)throw k.local.invalidFormat||k.regionalOptions[""].invalidFormat;P=P||this.local.dateFormat,e=e||{};for(var p=e.dayNamesShort||this.local.dayNamesShort,g=e.dayNames||this.local.dayNames,a=e.monthNumbers||this.local.monthNumbers,t=e.monthNamesShort||this.local.monthNamesShort,i=e.monthNames||this.local.monthNames,n=e.calculateWeek||this.local.calculateWeek,r=function(w,A){for(var f=1;T+f<P.length&&P.charAt(T+f)===w;)f++;return T+=f-1,Math.floor(f/(A||1))>1},d=function(w,A,f,u){var h=""+A;if(r(w,u))for(;h.length<f;)h="0"+h;return h},s=function(w,A,f,u){return r(w)?u[A]:f[A]},m=this,x=function(w){return typeof a=="function"?a.call(m,w,r("m")):_(d("m",w.month(),2))},M=function(w,A){return A?typeof i=="function"?i.call(m,w):i[w.month()-m.minMonth]:typeof t=="function"?t.call(m,w):t[w.month()-m.minMonth]},v=this.local.digits,_=function(w){return e.localNumbers&&v?v(w):w},l="",y=!1,T=0;T<P.length;T++)if(y)P.charAt(T)==="'"&&!r("'")?y=!1:l+=P.charAt(T);else switch(P.charAt(T)){case"d":l+=_(d("d",E.day(),2));break;case"D":l+=s("D",E.dayOfWeek(),p,g);break;case"o":l+=d("o",E.dayOfYear(),3);break;case"w":l+=d("w",E.weekOfYear(),2);break;case"m":l+=x(E);break;case"M":l+=M(E,r("M"));break;case"y":l+=r("y",2)?E.year():(E.year()%100<10?"0":"")+E.year()%100;break;case"Y":r("Y",2),l+=E.formatYear();break;case"J":l+=E.toJD();break;case"@":l+=(E.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":l+=(E.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":r("'")?l+="'":y=!0;break;default:l+=P.charAt(T)}return l},parseDate:function(P,E,e){if(E==null)throw k.local.invalidArguments||k.regionalOptions[""].invalidArguments;if(E=typeof E=="object"?E.toString():E+"",E==="")return null;P=P||this.local.dateFormat,e=e||{};var p=e.shortYearCutoff||this.shortYearCutoff;p=typeof p!="string"?p:this.today().year()%100+parseInt(p,10);for(var g=e.dayNamesShort||this.local.dayNamesShort,a=e.dayNames||this.local.dayNames,t=e.parseMonth||this.local.parseMonth,i=e.monthNumbers||this.local.monthNumbers,n=e.monthNamesShort||this.local.monthNamesShort,r=e.monthNames||this.local.monthNames,d=-1,s=-1,m=-1,x=-1,M=-1,v=!1,_=!1,l=function(z,O){for(var I=1;o+I<P.length&&P.charAt(o+I)===z;)I++;return o+=I-1,Math.floor(I/(O||1))>1},y=function(z,O){var I=l(z,O),F=[2,3,I?4:2,I?4:2,10,11,20]["oyYJ@!".indexOf(z)+1],D=new RegExp("^-?\\d{1,"+F+"}"),B=E.substring(h).match(D);if(!B)throw(k.local.missingNumberAt||k.regionalOptions[""].missingNumberAt).replace(/\{0\}/,h);return h+=B[0].length,parseInt(B[0],10)},T=this,w=function(){if(typeof i=="function"){l("m");var z=i.call(T,E.substring(h));return h+=z.length,z}return y("m")},A=function(z,O,I,F){for(var D=l(z,F)?I:O,B=0;B<D.length;B++)if(E.substr(h,D[B].length).toLowerCase()===D[B].toLowerCase())return h+=D[B].length,B+T.minMonth;throw(k.local.unknownNameAt||k.regionalOptions[""].unknownNameAt).replace(/\{0\}/,h)},f=function(){if(typeof r=="function"){var z=l("M")?r.call(T,E.substring(h)):n.call(T,E.substring(h));return h+=z.length,z}return A("M",n,r)},u=function(){if(E.charAt(h)!==P.charAt(o))throw(k.local.unexpectedLiteralAt||k.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,h);h++},h=0,o=0;o<P.length;o++)if(_)P.charAt(o)==="'"&&!l("'")?_=!1:u();else switch(P.charAt(o)){case"d":x=y("d");break;case"D":A("D",g,a);break;case"o":M=y("o");break;case"w":y("w");break;case"m":m=w();break;case"M":m=f();break;case"y":var S=o;v=!l("y",2),o=S,s=y("y",2);break;case"Y":s=y("Y",2);break;case"J":d=y("J")+.5,E.charAt(h)==="."&&(h++,y("J"));break;case"@":d=y("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":d=y("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":h=E.length;break;case"'":l("'")?u():_=!0;break;default:u()}if(h<E.length)throw k.local.unexpectedText||k.regionalOptions[""].unexpectedText;if(s===-1?s=this.today().year():s<100&&v&&(s+=p===-1?1900:this.today().year()-this.today().year()%100-(s<=p?0:100)),typeof m=="string"&&(m=t.call(this,s,m)),M>-1){m=1,x=M;for(var R=this.daysInMonth(s,m);x>R;R=this.daysInMonth(s,m))m++,x-=R}return d>-1?this.fromJD(d):this.newDate(s,m,x)},determineDate:function(P,E,e,p,g){e&&typeof e!="object"&&(g=p,p=e,e=null),typeof p!="string"&&(g=p,p="");var a=this,t=function(i){try{return a.parseDate(p,i,g)}catch{}i=i.toLowerCase();for(var n=(i.match(/^c/)&&e?e.newDate():null)||a.today(),r=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,d=r.exec(i);d;)n.add(parseInt(d[1],10),d[2]||"d"),d=r.exec(i);return n};return E=E?E.newDate():null,P=P==null?E:typeof P=="string"?t(P):typeof P=="number"?isNaN(P)||P===1/0||P===-1/0?E:a.today().add(P,"d"):a.newDate(P),P}})},{"./main":346,"object-assign":247}],348:[function(c,ae,ie){"use strict";ae.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],349:[function(c,ae,ie){"use strict";var b=c("./arrow_paths"),k=c("../../plots/font_attributes"),P=c("../../plots/cartesian/constants"),E=c("../../plot_api/plot_template").templatedArray,e=c("../../constants/axis_placeable_objects");function p(a){return["In order for absolute positioning of the arrow to work, *a"+a+"ref* must be exactly the same as *"+a+"ref*, otherwise *a"+a+"ref* will revert to *pixel* (explained next).","For relative positioning, *a"+a+"ref* can be set to *pixel*,","in which case the *a"+a+"* value is specified in pixels","relative to *"+a+"*.","Absolute positioning is useful","for trendline annotations which should continue to indicate","the correct trend when zoomed. Relative positioning is useful","for specifying the text offset for an annotated point."].join(" ")}function g(a,t,i){return["Sets the",a,"component of the arrow tail about the arrow head.","If `a"+a+"ref` is `pixel`, a positive (negative)","component corresponds to an arrow pointing","from",i,"to",t,"("+t,"to",i+").","If `a"+a+"ref` is not `pixel` and is exactly the same as `"+a+"ref`,","this is an absolute value on that axis,","like `"+a+"`, specified in the same coordinates as `"+a+"ref`."].join(" ")}ae.exports=E("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:k({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:b.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:b.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",P.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",P.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",P.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",P.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:k({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":472,"../../plot_api/plot_template":543,"../../plots/cartesian/constants":561,"../../plots/font_attributes":585,"./arrow_paths":348}],350:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("./draw").draw;ae.exports=function(g){var a=g._fullLayout,t=b.filterVisible(a.annotations);if(t.length&&g._fullData.length)return b.syncOrAsync([P,E],g)};function E(p){var g=p._fullLayout;b.filterVisible(g.annotations).forEach(function(a){var t=k.getFromId(p,a.xref),i=k.getFromId(p,a.yref),n=k.getRefType(a.xref),r=k.getRefType(a.yref);a._extremes={},n==="range"&&e(a,t),r==="range"&&e(a,i)})}function e(p,g){var a=g._id,t=a.charAt(0),i=p[t],n=p["a"+t],r=p[t+"ref"],d=p["a"+t+"ref"],s=p["_"+t+"padplus"],m=p["_"+t+"padminus"],x={x:1,y:-1}[t]*p[t+"shift"],M=3*p.arrowsize*p.arrowwidth||0,v=M+x,_=M-x,l=3*p.startarrowsize*p.arrowwidth||0,y=l+x,T=l-x,w;if(d===r){var A=k.findExtremes(g,[g.r2c(i)],{ppadplus:v,ppadminus:_}),f=k.findExtremes(g,[g.r2c(n)],{ppadplus:Math.max(s,y),ppadminus:Math.max(m,T)});w={min:[A.min[0],f.min[0]],max:[A.max[0],f.max[0]]}}else y=n?y+n:y,T=n?T-n:T,w=k.findExtremes(g,[g.r2c(i)],{ppadplus:Math.max(s,v,y),ppadminus:Math.max(m,_,T)});p._extremes[a]=w}},{"../../lib":503,"../../plots/cartesian/axes":554,"./draw":355}],351:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../registry"),P=c("../../plot_api/plot_template").arrayEditor;ae.exports={hasClickToShow:E,onClick:e};function E(a,t){var i=p(a,t);return i.on.length>0||i.explicitOff.length>0}function e(a,t){var i=p(a,t),n=i.on,r=i.off.concat(i.explicitOff),d={},s=a._fullLayout.annotations,m,x;if(!!(n.length||r.length)){for(m=0;m<n.length;m++)x=P(a.layout,"annotations",s[n[m]]),x.modifyItem("visible",!0),b.extendFlat(d,x.getUpdateObj());for(m=0;m<r.length;m++)x=P(a.layout,"annotations",s[r[m]]),x.modifyItem("visible",!1),b.extendFlat(d,x.getUpdateObj());return k.call("update",a,{},d)}}function p(a,t){var i=a._fullLayout.annotations,n=[],r=[],d=[],s=(t||[]).length,m,x,M,v,_,l,y,T;for(m=0;m<i.length;m++)if(M=i[m],v=M.clicktoshow,v){for(x=0;x<s;x++)if(_=t[x],l=_.xaxis,y=_.yaxis,l._id===M.xref&&y._id===M.yref&&l.d2r(_.x)===g(M._xclick,l)&&y.d2r(_.y)===g(M._yclick,y)){M.visible?v==="onout"?T=r:T=d:T=n,T.push(m);break}x===s&&M.visible&&v==="onout"&&r.push(m)}return{on:n,off:r,explicitOff:d}}function g(a,t){return t.type==="log"?t.l2r(a):t.d2r(a)}},{"../../lib":503,"../../plot_api/plot_template":543,"../../registry":638}],352:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../color");ae.exports=function(E,e,p,g){g("opacity");var a=g("bgcolor"),t=g("bordercolor"),i=k.opacity(t);g("borderpad");var n=g("borderwidth"),r=g("showarrow");g("text",r?" ":p._dfltTitle.annotation),g("textangle"),b.coerceFont(g,"font",p.font),g("width"),g("align");var d=g("height");if(d&&g("valign"),r){var s=g("arrowside"),m,x;s.indexOf("end")!==-1&&(m=g("arrowhead"),x=g("arrowsize")),s.indexOf("start")!==-1&&(g("startarrowhead",m),g("startarrowsize",x)),g("arrowcolor",i?e.bordercolor:k.defaultLine),g("arrowwidth",(i&&n||1)*2),g("standoff"),g("startstandoff")}var M=g("hovertext"),v=p.hoverlabel||{};if(M){var _=g("hoverlabel.bgcolor",v.bgcolor||(k.opacity(a)?k.rgb(a):k.defaultLine)),l=g("hoverlabel.bordercolor",v.bordercolor||k.contrast(_));b.coerceFont(g,"hoverlabel.font",{family:v.font.family,size:v.font.size,color:v.font.color||l})}g("captureevents",!!M)}},{"../../lib":503,"../color":366}],353:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib/to_log_range");ae.exports=function(E,e,p,g){e=e||{};var a=p==="log"&&e.type==="linear",t=p==="linear"&&e.type==="log";if(!(a||t))return;var i=E._fullLayout.annotations,n=e._id.charAt(0),r,d;function s(x){var M=r[x],v=null;a?v=k(M,e.range):v=Math.pow(10,M),b(v)||(v=null),g(d+x,v)}for(var m=0;m<i.length;m++)r=i[m],d="annotations["+m+"].",r[n+"ref"]===e._id&&s(n),r["a"+n+"ref"]===e._id&&s("a"+n)}},{"../../lib/to_log_range":531,"fast-isnumeric":190}],354:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("../../plots/array_container_defaults"),E=c("./common_defaults"),e=c("./attributes");ae.exports=function(a,t){P(a,t,{name:"annotations",handleItemDefaults:p})};function p(g,a,t){function i(u,h){return b.coerce(g,a,e,u,h)}var n=i("visible"),r=i("clicktoshow");if(!!(n||r)){E(g,a,t,i);for(var d=a.showarrow,s=["x","y"],m=[-10,-30],x={_fullLayout:t},M=0;M<2;M++){var v=s[M],_=k.coerceRef(g,a,x,v,"","paper");if(_!=="paper"){var l=k.getFromId(x,_);l._annIndices.push(a._index)}if(k.coercePosition(a,x,i,_,v,.5),d){var y="a"+v,T=k.coerceRef(g,a,x,y,"pixel",["pixel","paper"]);T!=="pixel"&&T!==_&&(T=a[y]="pixel");var w=T==="pixel"?m[M]:.4;k.coercePosition(a,x,i,T,y,w)}i(v+"anchor"),i(v+"shift")}if(b.noneOrAll(g,a,["x","y"]),d&&b.noneOrAll(g,a,["ax","ay"]),r){var A=i("xclick"),f=i("yclick");a._xclick=A===void 0?a.x:k.cleanPosition(A,x,a.xref),a._yclick=f===void 0?a.y:k.cleanPosition(f,x,a.yref)}}}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"./attributes":349,"./common_defaults":352}],355:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../registry"),P=c("../../plots/plots"),E=c("../../lib"),e=E.strTranslate,p=c("../../plots/cartesian/axes"),g=c("../color"),a=c("../drawing"),t=c("../fx"),i=c("../../lib/svg_text_utils"),n=c("../../lib/setcursor"),r=c("../dragelement"),d=c("../../plot_api/plot_template").arrayEditor,s=c("./draw_arrow_head");ae.exports={draw:m,drawOne:x,drawRaw:v};function m(_){var l=_._fullLayout;l._infolayer.selectAll(".annotation").remove();for(var y=0;y<l.annotations.length;y++)l.annotations[y].visible&&x(_,y);return P.previousPromises(_)}function x(_,l){var y=_._fullLayout,T=y.annotations[l]||{},w=p.getFromId(_,T.xref),A=p.getFromId(_,T.yref);w&&w.setScale(),A&&A.setScale(),v(_,T,l,!1,w,A)}function M(_,l,y,T,w){var A=w[y],f=w[y+"ref"],u=y.indexOf("y")!==-1,h=p.getRefType(f)==="domain",o=u?T.h:T.w;return _?h?A+(u?-l:l)/_._length:_.p2r(_.r2p(A)+l):A+(u?-l:l)/o}function v(_,l,y,T,w,A){var f=_._fullLayout,u=_._fullLayout._size,h=_._context.edits,o,S;T?(o="annotation-"+T,S=T+".annotations"):(o="annotation",S="annotations");var R=d(_.layout,S,l),z=R.modifyBase,O=R.modifyItem,I=R.getUpdateObj;f._infolayer.selectAll("."+o+'[data-index="'+y+'"]').remove();var F="clip"+f._uid+"_ann"+y;if(!l._input||l.visible===!1){b.selectAll("#"+F).remove();return}var D={x:{},y:{}},B=+l.textangle||0,U=f._infolayer.append("g").classed(o,!0).attr("data-index",String(y)).style("opacity",l.opacity),X=U.append("g").classed("annotation-text-g",!0),oe=h[l.showarrow?"annotationTail":"annotationPosition"],se=l.captureevents||h.annotationText||oe;function q(le){var ge={index:y,annotation:l._input,fullAnnotation:l,event:le};return T&&(ge.subplotId=T),ge}var K=X.append("g").style("pointer-events",se?"all":null).call(n,"pointer").on("click",function(){_._dragging=!1,_.emit("plotly_clickannotation",q(b.event))});l.hovertext&&K.on("mouseover",function(){var le=l.hoverlabel,ge=le.font,pe=this.getBoundingClientRect(),xe=_.getBoundingClientRect();t.loneHover({x0:pe.left-xe.left,x1:pe.right-xe.left,y:(pe.top+pe.bottom)/2-xe.top,text:l.hovertext,color:le.bgcolor,borderColor:le.bordercolor,fontFamily:ge.family,fontSize:ge.size,fontColor:ge.color},{container:f._hoverlayer.node(),outerContainer:f._paper.node(),gd:_})}).on("mouseout",function(){t.loneUnhover(f._hoverlayer.node())});var G=l.borderwidth,Q=l.borderpad,V=G+Q,H=K.append("rect").attr("class","bg").style("stroke-width",G+"px").call(g.stroke,l.bordercolor).call(g.fill,l.bgcolor),ee=l.width||l.height,J=f._topclips.selectAll("#"+F).data(ee?[0]:[]);J.enter().append("clipPath").classed("annclip",!0).attr("id",F).append("rect"),J.exit().remove();var W=l.font,re=f._meta?E.templateString(l.text,f._meta):l.text,j=K.append("text").classed("annotation-text",!0).text(re);function Z(le){return le.call(a.font,W).attr({"text-anchor":{left:"start",right:"end"}[l.align]||"middle"}),i.convertToTspans(le,_,ne),le}function ne(){var le=j.selectAll("a");if(le.size()===1&&le.text()===j.text()){var ge=K.insert("a",":first-child").attr({"xlink:xlink:href":le.attr("xlink:href"),"xlink:xlink:show":le.attr("xlink:show")}).style({cursor:"pointer"});ge.node().appendChild(H.node())}var pe=K.select(".annotation-text-math-group"),xe=!pe.empty(),Ee=a.bBox((xe?pe:j).node()),Te=Ee.width,de=Ee.height,be=l.width||Te,Le=l.height||de,De=Math.round(be+2*V),ye=Math.round(Le+2*V);function ke(Gt,Kt){return Kt==="auto"&&(Gt<1/3?Kt="left":Gt>2/3?Kt="right":Kt="center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[Kt]}for(var Oe=!1,Qe=["x","y"],Ve=0;Ve<Qe.length;Ve++){var Ue=Qe[Ve],Ie=l[Ue+"ref"]||Ue,at=l["a"+Ue+"ref"],pt={x:w,y:A}[Ue],Rt=(B+(Ue==="x"?0:-90))*Math.PI/180,Mt=De*Math.cos(Rt),It=ye*Math.sin(Rt),Bt=Math.abs(Mt)+Math.abs(It),St=l[Ue+"anchor"],_t=l[Ue+"shift"]*(Ue==="x"?1:-1),it=D[Ue],ct,et,Pe,We,je,nt=p.getRefType(Ie);if(pt&&nt!=="domain"){var kt=pt.r2fraction(l[Ue]);(kt<0||kt>1)&&(at===Ie?(kt=pt.r2fraction(l["a"+Ue]),(kt<0||kt>1)&&(Oe=!0)):Oe=!0),ct=pt._offset+pt.r2p(l[Ue]),We=.5}else{var wt=nt==="domain";Ue==="x"?(Pe=l[Ue],ct=wt?pt._offset+pt._length*Pe:ct=u.l+u.w*Pe):(Pe=1-l[Ue],ct=wt?pt._offset+pt._length*Pe:ct=u.t+u.h*Pe),We=l.showarrow?.5:Pe}if(l.showarrow){it.head=ct;var Vt=l["a"+Ue];if(je=Mt*ke(.5,l.xanchor)-It*ke(.5,l.yanchor),at===Ie){var qt=p.getRefType(at);qt==="domain"?(Ue==="y"&&(Vt=1-Vt),it.tail=pt._offset+pt._length*Vt):qt==="paper"?Ue==="y"?(Vt=1-Vt,it.tail=u.t+u.h*Vt):it.tail=u.l+u.w*Vt:it.tail=pt._offset+pt.r2p(Vt),et=je}else it.tail=ct+Vt,et=je+Vt;it.text=it.tail+je;var zt=f[Ue==="x"?"width":"height"];if(Ie==="paper"&&(it.head=E.constrain(it.head,1,zt-1)),at==="pixel"){var Ht=-Math.max(it.tail-3,it.text),$t=Math.min(it.tail+3,it.text)-zt;Ht>0?(it.tail+=Ht,it.text+=Ht):$t>0&&(it.tail-=$t,it.text-=$t)}it.tail+=_t,it.head+=_t}else je=Bt*ke(We,St),et=je,it.text=ct+je;it.text+=_t,je+=_t,et+=_t,l["_"+Ue+"padplus"]=Bt/2+et,l["_"+Ue+"padminus"]=Bt/2-et,l["_"+Ue+"size"]=Bt,l["_"+Ue+"shift"]=je}if(Oe){K.remove();return}var Qt=0,fr=0;if(l.align!=="left"&&(Qt=(be-Te)*(l.align==="center"?.5:1)),l.valign!=="top"&&(fr=(Le-de)*(l.valign==="middle"?.5:1)),xe)pe.select("svg").attr({x:V+Qt-1,y:V+fr}).call(a.setClipUrl,ee?F:null,_);else{var jr=V+fr-Ee.top,cn=V+Qt-Ee.left;j.call(i.positionText,cn,jr).call(a.setClipUrl,ee?F:null,_)}J.select("rect").call(a.setRect,V,V,be,Le),H.call(a.setRect,G/2,G/2,De-G,ye-G),K.call(a.setTranslate,Math.round(D.x.text-De/2),Math.round(D.y.text-ye/2)),X.attr({transform:"rotate("+B+","+D.x.text+","+D.y.text+")"});var Qr=function(Gt,Kt){U.selectAll(".annotation-arrow-g").remove();var Nt=D.x.head,gr=D.y.head,tt=D.x.tail+Gt,we=D.y.tail+Kt,Me=D.x.text+Gt,Ne=D.y.text+Kt,Xe=E.rotationXYMatrix(B,Me,Ne),Ke=E.apply2DTransform(Xe),rt=E.apply2DTransform2(Xe),Je=+H.attr("width"),vt=+H.attr("height"),bt=Me-.5*Je,Et=bt+Je,Wt=Ne-.5*vt,Ot=Wt+vt,ir=[[bt,Wt,bt,Ot],[bt,Ot,Et,Ot],[Et,Ot,Et,Wt],[Et,Wt,bt,Wt]].map(rt);if(!ir.reduce(function(ot,Lt){return ot^!!E.segmentsIntersect(Nt,gr,Nt+1e6,gr+1e6,Lt[0],Lt[1],Lt[2],Lt[3])},!1)){ir.forEach(function(ot){var Lt=E.segmentsIntersect(tt,we,Nt,gr,ot[0],ot[1],ot[2],ot[3]);Lt&&(tt=Lt.x,we=Lt.y)});var vr=l.arrowwidth,_r=l.arrowcolor,ln=l.arrowside,Cr=U.append("g").style({opacity:g.opacity(_r)}).classed("annotation-arrow-g",!0),Gr=Cr.append("path").attr("d","M"+tt+","+we+"L"+Nt+","+gr).style("stroke-width",vr+"px").call(g.stroke,g.rgb(_r));if(s(Gr,ln,l),h.annotationPosition&&Gr.node().parentNode&&!T){var sn=Nt,yr=gr;if(l.standoff){var mr=Math.sqrt(Math.pow(Nt-tt,2)+Math.pow(gr-we,2));sn+=l.standoff*(tt-Nt)/mr,yr+=l.standoff*(we-gr)/mr}var Or=Cr.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(tt-sn)+","+(we-yr),transform:e(sn,yr)}).style("stroke-width",vr+6+"px").call(g.stroke,"rgba(0,0,0,0)").call(g.fill,"rgba(0,0,0,0)"),zr,Sr;r.init({element:Or.node(),gd:_,prepFn:function(){var ot=a.getTranslate(K);zr=ot.x,Sr=ot.y,w&&w.autorange&&z(w._name+".autorange",!0),A&&A.autorange&&z(A._name+".autorange",!0)},moveFn:function(ot,Lt){var Xt=Ke(zr,Sr),tr=Xt[0]+ot,Lr=Xt[1]+Lt;K.call(a.setTranslate,tr,Lr),O("x",M(w,ot,"x",u,l)),O("y",M(A,Lt,"y",u,l)),l.axref===l.xref&&O("ax",M(w,ot,"ax",u,l)),l.ayref===l.yref&&O("ay",M(A,Lt,"ay",u,l)),Cr.attr("transform",e(ot,Lt)),X.attr({transform:"rotate("+B+","+tr+","+Lr+")"})},doneFn:function(){k.call("_guiRelayout",_,I());var ot=document.querySelector(".js-notes-box-panel");ot&&ot.redraw(ot.selectedObj)}})}}};if(l.showarrow&&Qr(0,0),oe){var lt;r.init({element:K.node(),gd:_,prepFn:function(){lt=X.attr("transform")},moveFn:function(Gt,Kt){var Nt="pointer";if(l.showarrow)l.axref===l.xref?O("ax",M(w,Gt,"ax",u,l)):O("ax",l.ax+Gt),l.ayref===l.yref?O("ay",M(A,Kt,"ay",u.w,l)):O("ay",l.ay+Kt),Qr(Gt,Kt);else{if(T)return;var gr,tt;if(w)gr=M(w,Gt,"x",u,l);else{var we=l._xsize/u.w,Me=l.x+(l._xshift-l.xshift)/u.w-we/2;gr=r.align(Me+Gt/u.w,we,0,1,l.xanchor)}if(A)tt=M(A,Kt,"y",u,l);else{var Ne=l._ysize/u.h,Xe=l.y-(l._yshift+l.yshift)/u.h-Ne/2;tt=r.align(Xe-Kt/u.h,Ne,0,1,l.yanchor)}O("x",gr),O("y",tt),(!w||!A)&&(Nt=r.getCursor(w?.5:gr,A?.5:tt,l.xanchor,l.yanchor))}X.attr({transform:e(Gt,Kt)+lt}),n(K,Nt)},clickFn:function(Gt,Kt){l.captureevents&&_.emit("plotly_clickannotation",q(Kt))},doneFn:function(){n(K),k.call("_guiRelayout",_,I());var Gt=document.querySelector(".js-notes-box-panel");Gt&&Gt.redraw(Gt.selectedObj)}})}}h.annotationText?j.call(i.makeEditable,{delegate:K,gd:_}).call(Z).on("edit",function(le){l.text=le,this.call(Z),O("text",le),w&&w.autorange&&z(w._name+".autorange",!0),A&&A.autorange&&z(A._name+".autorange",!0),k.call("_guiRelayout",_,I())}):j.call(Z)}},{"../../lib":503,"../../lib/setcursor":524,"../../lib/svg_text_utils":529,"../../plot_api/plot_template":543,"../../plots/cartesian/axes":554,"../../plots/plots":619,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"../fx":406,"./draw_arrow_head":356,"@plotly/d3":58}],356:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../color"),P=c("./arrow_paths"),E=c("../../lib"),e=E.strScale,p=E.strRotate,g=E.strTranslate;ae.exports=function(t,i,n){var r=t.node(),d=P[n.arrowhead||0],s=P[n.startarrowhead||0],m=(n.arrowwidth||1)*(n.arrowsize||1),x=(n.arrowwidth||1)*(n.startarrowsize||1),M=i.indexOf("start")>=0,v=i.indexOf("end")>=0,_=d.backoff*m+n.standoff,l=s.backoff*x+n.startstandoff,y,T,w,A;if(r.nodeName==="line"){y={x:+t.attr("x1"),y:+t.attr("y1")},T={x:+t.attr("x2"),y:+t.attr("y2")};var f=y.x-T.x,u=y.y-T.y;if(w=Math.atan2(u,f),A=w+Math.PI,_&&l&&_+l>Math.sqrt(f*f+u*u)){X();return}if(_){if(_*_>f*f+u*u){X();return}var h=_*Math.cos(w),o=_*Math.sin(w);T.x+=h,T.y+=o,t.attr({x2:T.x,y2:T.y})}if(l){if(l*l>f*f+u*u){X();return}var S=l*Math.cos(w),R=l*Math.sin(w);y.x-=S,y.y-=R,t.attr({x1:y.x,y1:y.y})}}else if(r.nodeName==="path"){var z=r.getTotalLength(),O="";if(z<_+l){X();return}var I=r.getPointAtLength(0),F=r.getPointAtLength(.1);w=Math.atan2(I.y-F.y,I.x-F.x),y=r.getPointAtLength(Math.min(l,z)),O="0px,"+l+"px,";var D=r.getPointAtLength(z),B=r.getPointAtLength(z-.1);A=Math.atan2(D.y-B.y,D.x-B.x),T=r.getPointAtLength(Math.max(0,z-_));var U=O?l+_:_;O+=z-U+"px,"+z+"px",t.style("stroke-dasharray",O)}function X(){t.style("stroke-dasharray","0px,100px")}function oe(se,q,K,G){!se.path||(se.noRotate&&(K=0),b.select(r.parentNode).append("path").attr({class:t.attr("class"),d:se.path,transform:g(q.x,q.y)+p(K*180/Math.PI)+e(G)}).style({fill:k.rgb(n.arrowcolor),"stroke-width":0}))}M&&oe(s,y,w,x),v&&oe(d,T,A,m)}},{"../../lib":503,"../color":366,"./arrow_paths":348,"@plotly/d3":58}],357:[function(c,ae,ie){"use strict";var b=c("./draw"),k=c("./click");ae.exports={moduleType:"component",name:"annotations",layoutAttributes:c("./attributes"),supplyLayoutDefaults:c("./defaults"),includeBasePlot:c("../../plots/cartesian/include_components")("annotations"),calcAutorange:c("./calc_autorange"),draw:b.draw,drawOne:b.drawOne,drawRaw:b.drawRaw,hasClickToShow:k.hasClickToShow,onClick:k.onClick,convertCoords:c("./convert_coords")}},{"../../plots/cartesian/include_components":567,"./attributes":349,"./calc_autorange":350,"./click":351,"./convert_coords":353,"./defaults":354,"./draw":355}],358:[function(c,ae,ie){"use strict";var b=c("../annotations/attributes"),k=c("../../plot_api/edit_types").overrideAll,P=c("../../plot_api/plot_template").templatedArray;ae.exports=k(P("annotation",{visible:b.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:b.xanchor,xshift:b.xshift,yanchor:b.yanchor,yshift:b.yshift,text:b.text,textangle:b.textangle,font:b.font,width:b.width,height:b.height,opacity:b.opacity,align:b.align,valign:b.valign,bgcolor:b.bgcolor,bordercolor:b.bordercolor,borderpad:b.borderpad,borderwidth:b.borderwidth,showarrow:b.showarrow,arrowcolor:b.arrowcolor,arrowhead:b.arrowhead,startarrowhead:b.startarrowhead,arrowside:b.arrowside,arrowsize:b.arrowsize,startarrowsize:b.startarrowsize,arrowwidth:b.arrowwidth,standoff:b.standoff,startstandoff:b.startstandoff,hovertext:b.hovertext,hoverlabel:b.hoverlabel,captureevents:b.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../annotations/attributes":349}],359:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes");ae.exports=function(e){for(var p=e.fullSceneLayout,g=p.annotations,a=0;a<g.length;a++)P(g[a],e);e.fullLayout._infolayer.selectAll(".annotation-"+e.id).remove()};function P(E,e){var p=e.fullSceneLayout,g=p.domain,a=e.fullLayout._size,t={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};E._xa={},b.extendFlat(E._xa,t),k.setConvert(E._xa),E._xa._offset=a.l+g.x[0]*a.w,E._xa.l2p=function(){return .5*(1+E._pdata[0]/E._pdata[3])*a.w*(g.x[1]-g.x[0])},E._ya={},b.extendFlat(E._ya,t),k.setConvert(E._ya),E._ya._offset=a.t+(1-g.y[1])*a.h,E._ya.l2p=function(){return .5*(1-E._pdata[1]/E._pdata[3])*a.h*(g.y[1]-g.y[0])}}},{"../../lib":503,"../../plots/cartesian/axes":554}],360:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("../../plots/array_container_defaults"),E=c("../annotations/common_defaults"),e=c("./attributes");ae.exports=function(a,t,i){P(a,t,{name:"annotations",handleItemDefaults:p,fullLayout:i.fullLayout})};function p(g,a,t,i){function n(s,m){return b.coerce(g,a,e,s,m)}function r(s){var m=s+"axis",x={_fullLayout:{}};return x._fullLayout[m]=t[m],k.coercePosition(a,x,n,s,s,.5)}var d=n("visible");!d||(E(g,a,i.fullLayout,n),r("x"),r("y"),r("z"),b.noneOrAll(g,a,["x","y","z"]),a.xref="x",a.yref="y",a.zref="z",n("xanchor"),n("yanchor"),n("xshift"),n("yshift"),a.showarrow&&(a.axref="pixel",a.ayref="pixel",n("ax",-10),n("ay",-30),b.noneOrAll(g,a,["ax","ay"])))}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"../annotations/common_defaults":352,"./attributes":358}],361:[function(c,ae,ie){"use strict";var b=c("../annotations/draw").drawRaw,k=c("../../plots/gl3d/project"),P=["x","y","z"];ae.exports=function(e){for(var p=e.fullSceneLayout,g=e.dataScale,a=p.annotations,t=0;t<a.length;t++){for(var i=a[t],n=!1,r=0;r<3;r++){var d=P[r],s=i[d],m=p[d+"axis"],x=m.r2fraction(s);if(x<0||x>1){n=!0;break}}n?e.fullLayout._infolayer.select(".annotation-"+e.id+'[data-index="'+t+'"]').remove():(i._pdata=k(e.glplot.cameraParams,[p.xaxis.r2l(i.x)*g[0],p.yaxis.r2l(i.y)*g[1],p.zaxis.r2l(i.z)*g[2]]),b(e.graphDiv,i,t,e.id,i._xa,i._ya))}}},{"../../plots/gl3d/project":607,"../annotations/draw":355}],362:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib");ae.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:c("./attributes")}}},layoutAttributes:c("./attributes"),handleDefaults:c("./defaults"),includeBasePlot:P,convert:c("./convert"),draw:c("./draw")};function P(E,e){var p=b.subplotsRegistry.gl3d;if(!!p)for(var g=p.attrRegex,a=Object.keys(E),t=0;t<a.length;t++){var i=a[t];g.test(i)&&(E[i].annotations||[]).length&&(k.pushUnique(e._basePlotModules,p),k.pushUnique(e._subplots.gl3d,i))}}},{"../../lib":503,"../../registry":638,"./attributes":358,"./convert":359,"./defaults":360,"./draw":361}],363:[function(c,ae,ie){"use strict";ae.exports=c("world-calendars/dist/main"),c("world-calendars/dist/plus"),c("world-calendars/dist/calendars/chinese"),c("world-calendars/dist/calendars/coptic"),c("world-calendars/dist/calendars/discworld"),c("world-calendars/dist/calendars/ethiopian"),c("world-calendars/dist/calendars/hebrew"),c("world-calendars/dist/calendars/islamic"),c("world-calendars/dist/calendars/julian"),c("world-calendars/dist/calendars/mayan"),c("world-calendars/dist/calendars/nanakshahi"),c("world-calendars/dist/calendars/nepali"),c("world-calendars/dist/calendars/persian"),c("world-calendars/dist/calendars/taiwan"),c("world-calendars/dist/calendars/thai"),c("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":332,"world-calendars/dist/calendars/coptic":333,"world-calendars/dist/calendars/discworld":334,"world-calendars/dist/calendars/ethiopian":335,"world-calendars/dist/calendars/hebrew":336,"world-calendars/dist/calendars/islamic":337,"world-calendars/dist/calendars/julian":338,"world-calendars/dist/calendars/mayan":339,"world-calendars/dist/calendars/nanakshahi":340,"world-calendars/dist/calendars/nepali":341,"world-calendars/dist/calendars/persian":342,"world-calendars/dist/calendars/taiwan":343,"world-calendars/dist/calendars/thai":344,"world-calendars/dist/calendars/ummalqura":345,"world-calendars/dist/main":346,"world-calendars/dist/plus":347}],364:[function(c,ae,ie){"use strict";var b=c("./calendars"),k=c("../../lib"),P=c("../../constants/numerical"),E=P.EPOCHJD,e=P.ONEDAY,p={valType:"enumerated",values:k.sortObjectKeys(b.calendars),editType:"calc",dflt:"gregorian"},g=function(w,A,f,u){var h={};return h[f]=p,k.coerce(w,A,h,f,u)},a=function(w,A,f,u){for(var h=0;h<f.length;h++)g(w,A,f[h]+"calendar",u.calendar)},t={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},i={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},n={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},r="##",d={d:{"0":"dd","-":"d"},e:{"0":"d","-":"d"},a:{"0":"D","-":"D"},A:{"0":"DD","-":"DD"},j:{"0":"oo","-":"o"},W:{"0":"ww","-":"w"},m:{"0":"mm","-":"m"},b:{"0":"M","-":"M"},B:{"0":"MM","-":"MM"},y:{"0":"yy","-":"yy"},Y:{"0":"yyyy","-":"yyyy"},U:r,w:r,c:{"0":"D M d %X yyyy","-":"D M d %X yyyy"},x:{"0":"mm/dd/yyyy","-":"mm/dd/yyyy"}};function s(w,A,f){for(var u=Math.floor((A+.05)/e)+E,h=x(f).fromJD(u),o=0,S,R,z,O,I;(o=w.indexOf("%",o))!==-1;)S=w.charAt(o+1),S==="0"||S==="-"||S==="_"?(z=3,R=w.charAt(o+2),S==="_"&&(S="-")):(R=S,S="0",z=2),O=d[R],O?(O===r?I=r:I=h.formatDate(O[S]),w=w.substr(0,o)+I+w.substr(o+z),o+=I.length):o+=z;return w}var m={};function x(w){var A=m[w];return A||(A=m[w]=b.instance(w),A)}function M(w){return k.extendFlat({},p,{description:w})}function v(w){return"Sets the calendar system to use with `"+w+"` date data."}var _={xcalendar:M(v("x"))},l=k.extendFlat({},_,{ycalendar:M(v("y"))}),y=k.extendFlat({},l,{zcalendar:M(v("z"))}),T=M(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));ae.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:l,bar:l,box:l,heatmap:l,contour:l,histogram:l,histogram2d:l,histogram2dcontour:l,scatter3d:y,surface:y,mesh3d:y,scattergl:l,ohlc:_,candlestick:_},layout:{calendar:M(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:T},yaxis:{calendar:T},scene:{xaxis:{calendar:T},yaxis:{calendar:T},zaxis:{calendar:T}},polar:{radialaxis:{calendar:T}}},transforms:{filter:{valuecalendar:M(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:M(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:p,handleDefaults:g,handleTraceDefaults:a,CANONICAL_SUNDAY:i,CANONICAL_TICK:t,DFLTRANGE:n,getCal:x,worldCalFmt:s}},{"../../constants/numerical":479,"../../lib":503,"./calendars":363}],365:[function(c,ae,ie){"use strict";ie.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],ie.defaultLine="#444",ie.lightLine="#eee",ie.background="#fff",ie.borderLine="#BEC8D9",ie.lightFraction=100*(14-4)/(15-4)},{}],366:[function(c,ae,ie){"use strict";var b=c("tinycolor2"),k=c("fast-isnumeric"),P=c("../../lib/array").isTypedArray,E=ae.exports={},e=c("./attributes");E.defaults=e.defaults;var p=E.defaultLine=e.defaultLine;E.lightLine=e.lightLine;var g=E.background=e.background;E.tinyRGB=function(t){var i=t.toRgb();return"rgb("+Math.round(i.r)+", "+Math.round(i.g)+", "+Math.round(i.b)+")"},E.rgb=function(t){return E.tinyRGB(b(t))},E.opacity=function(t){return t?b(t).getAlpha():0},E.addOpacity=function(t,i){var n=b(t).toRgb();return"rgba("+Math.round(n.r)+", "+Math.round(n.g)+", "+Math.round(n.b)+", "+i+")"},E.combine=function(t,i){var n=b(t).toRgb();if(n.a===1)return b(t).toRgbString();var r=b(i||g).toRgb(),d=r.a===1?r:{r:255*(1-r.a)+r.r*r.a,g:255*(1-r.a)+r.g*r.a,b:255*(1-r.a)+r.b*r.a},s={r:d.r*(1-n.a)+n.r*n.a,g:d.g*(1-n.a)+n.g*n.a,b:d.b*(1-n.a)+n.b*n.a};return b(s).toRgbString()},E.contrast=function(t,i,n){var r=b(t);r.getAlpha()!==1&&(r=b(E.combine(t,g)));var d=r.isDark()?i?r.lighten(i):g:n?r.darken(n):p;return d.toString()},E.stroke=function(t,i){var n=b(i);t.style({stroke:E.tinyRGB(n),"stroke-opacity":n.getAlpha()})},E.fill=function(t,i){var n=b(i);t.style({fill:E.tinyRGB(n),"fill-opacity":n.getAlpha()})},E.clean=function(t){if(!(!t||typeof t!="object")){var i=Object.keys(t),n,r,d,s;for(n=0;n<i.length;n++)if(d=i[n],s=t[d],d.substr(d.length-5)==="color")if(Array.isArray(s))for(r=0;r<s.length;r++)s[r]=a(s[r]);else t[d]=a(s);else if(d.substr(d.length-10)==="colorscale"&&Array.isArray(s))for(r=0;r<s.length;r++)Array.isArray(s[r])&&(s[r][1]=a(s[r][1]));else if(Array.isArray(s)){var m=s[0];if(!Array.isArray(m)&&m&&typeof m=="object")for(r=0;r<s.length;r++)E.clean(s[r])}else s&&typeof s=="object"&&!P(s)&&E.clean(s)}};function a(t){if(k(t)||typeof t!="string")return t;var i=t.trim();if(i.substr(0,3)!=="rgb")return t;var n=i.match(/^rgba?\s*\(([^()]*)\)$/);if(!n)return t;var r=n[1].trim().split(/\s*[\s,]\s*/),d=i.charAt(3)==="a"&&r.length===4;if(!d&&r.length!==3)return t;for(var s=0;s<r.length;s++){if(!r[s].length||(r[s]=Number(r[s]),!(r[s]>=0)))return t;if(s===3)r[s]>1&&(r[s]=1);else if(r[s]>=1)return t}var m=Math.round(r[0]*255)+", "+Math.round(r[1]*255)+", "+Math.round(r[2]*255);return d?"rgba("+m+", "+r[3]+")":"rgb("+m+")"}},{"../../lib/array":485,"./attributes":365,"fast-isnumeric":190,tinycolor2:312}],367:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/layout_attributes"),k=c("../../plots/font_attributes"),P=c("../../lib/extend").extendFlat,E=c("../../plot_api/edit_types").overrideAll;ae.exports=E({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:b.linecolor,outlinewidth:b.linewidth,bordercolor:b.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:b.tickmode,nticks:b.nticks,tick0:b.tick0,dtick:b.dtick,tickvals:b.tickvals,ticktext:b.ticktext,ticks:P({},b.ticks,{dflt:""}),ticklabeloverflow:P({},b.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:b.ticklen,tickwidth:b.tickwidth,tickcolor:b.tickcolor,ticklabelstep:b.ticklabelstep,showticklabels:b.showticklabels,tickfont:k({}),tickangle:b.tickangle,tickformat:b.tickformat,tickformatstops:b.tickformatstops,tickprefix:b.tickprefix,showtickprefix:b.showtickprefix,ticksuffix:b.ticksuffix,showticksuffix:b.showticksuffix,separatethousands:b.separatethousands,exponentformat:b.exponentformat,minexponent:b.minexponent,showexponent:b.showexponent,title:{text:{valType:"string"},font:k({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:k({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/cartesian/layout_attributes":569,"../../plots/font_attributes":585}],368:[function(c,ae,ie){"use strict";ae.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],369:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plot_api/plot_template"),P=c("../../plots/cartesian/tick_value_defaults"),E=c("../../plots/cartesian/tick_mark_defaults"),e=c("../../plots/cartesian/tick_label_defaults"),p=c("../../plots/cartesian/prefix_suffix_defaults"),g=c("./attributes");ae.exports=function(t,i,n){var r=k.newContainer(i,"colorbar"),d=t.colorbar||{};function s(h,o){return b.coerce(d,r,g,h,o)}var m=n.margin||{t:0,b:0,l:0,r:0},x=n.width-m.l-m.r,M=n.height-m.t-m.b,v=s("orientation"),_=v==="v",l=s("thicknessmode");s("thickness",l==="fraction"?30/(_?x:M):30);var y=s("lenmode");s("len",y==="fraction"?1:_?M:x),s("x",_?1.02:.5),s("xanchor",_?"left":"center"),s("xpad"),s("y",_?.5:1.02),s("yanchor",_?"middle":"bottom"),s("ypad"),b.noneOrAll(d,r,["x","y"]),s("outlinecolor"),s("outlinewidth"),s("bordercolor"),s("borderwidth"),s("bgcolor");var T=b.coerce(d,r,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:_?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");s("ticklabeloverflow",T.indexOf("inside")!==-1?"hide past domain":"hide past div"),P(d,r,s,"linear");var w=n.font,A={outerTicks:!1,font:w};T.indexOf("inside")!==-1&&(A.bgColor="black"),p(d,r,s,"linear",A),e(d,r,s,"linear",A),E(d,r,s,"linear",A),s("title.text",n._dfltTitle.colorbar);var f=r.tickfont,u=b.extendFlat({},f,{color:w.color,size:b.bigFont(f.size)});b.coerceFont(s,"title.font",u),s("title.side",_?"top":"right")}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/cartesian/prefix_suffix_defaults":573,"../../plots/cartesian/tick_label_defaults":578,"../../plots/cartesian/tick_mark_defaults":579,"../../plots/cartesian/tick_value_defaults":580,"./attributes":367}],370:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("tinycolor2"),P=c("../../plots/plots"),E=c("../../registry"),e=c("../../plots/cartesian/axes"),p=c("../dragelement"),g=c("../../lib"),a=g.strTranslate,t=c("../../lib/extend").extendFlat,i=c("../../lib/setcursor"),n=c("../drawing"),r=c("../color"),d=c("../titles"),s=c("../../lib/svg_text_utils"),m=c("../colorscale/helpers").flipScale,x=c("../../plots/cartesian/axis_defaults"),M=c("../../plots/cartesian/position_defaults"),v=c("../../plots/cartesian/layout_attributes"),_=c("../../constants/alignment"),l=_.LINE_SPACING,y=_.FROM_TL,T=_.FROM_BR,w=c("./constants").cn;function A(R){var z=R._fullLayout,O=z._infolayer.selectAll("g."+w.colorbar).data(f(R),function(I){return I._id});O.enter().append("g").attr("class",function(I){return I._id}).classed(w.colorbar,!0),O.each(function(I){var F=b.select(this);g.ensureSingle(F,"rect",w.cbbg),g.ensureSingle(F,"g",w.cbfills),g.ensureSingle(F,"g",w.cblines),g.ensureSingle(F,"g",w.cbaxis,function(B){B.classed(w.crisp,!0)}),g.ensureSingle(F,"g",w.cbtitleunshift,function(B){B.append("g").classed(w.cbtitle,!0)}),g.ensureSingle(F,"rect",w.cboutline);var D=u(F,I,R);D&&D.then&&(R._promises||[]).push(D),R._context.edits.colorbarPosition&&h(F,I,R)}),O.exit().each(function(I){P.autoMargin(R,I._id)}).remove(),O.order()}function f(R){var z=R._fullLayout,O=R.calcdata,I=[],F,D,B,U;function X(W){return t(W,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function oe(){typeof U.calc=="function"?U.calc(R,B,F):(F._fillgradient=D.reversescale?m(D.colorscale):D.colorscale,F._zrange=[D[U.min],D[U.max]])}for(var se=0;se<O.length;se++){var q=O[se];B=q[0].trace;var K=B._module.colorbar;if(B.visible===!0&&K)for(var G=Array.isArray(K),Q=G?K:[K],V=0;V<Q.length;V++){U=Q[V];var H=U.container;D=H?B[H]:B,D&&D.showscale&&(F=X(D.colorbar),F._id="cb"+B.uid+(G&&H?"-"+H:""),F._traceIndex=B.index,F._propPrefix=(H?H+".":"")+"colorbar.",F._meta=B._meta,oe(),I.push(F))}}for(var ee in z._colorAxes)if(D=z[ee],D.showscale){var J=z._colorAxes[ee];F=X(D.colorbar),F._id="cb"+ee,F._propPrefix=ee+".colorbar.",F._meta=z._meta,U={min:"cmin",max:"cmax"},J[0]!=="heatmap"&&(B=J[1],U.calc=B._module.colorbar.calc),oe(),I.push(F)}return I}function u(R,z,O){var I=z.orientation==="v",F=z.len,D=z.lenmode,B=z.thickness,U=z.thicknessmode,X=z.outlinewidth,oe=z.borderwidth,se=z.bgcolor,q=z.xanchor,K=z.yanchor,G=z.xpad,Q=z.ypad,V=z.x,H=I?z.y:1-z.y,ee=O._fullLayout,J=ee._size,W=z._fillcolor,re=z._line,j=z.title,Z=j.side,ne=z._zrange||b.extent((typeof W=="function"?W:re.color).domain()),le=typeof re.color=="function"?re.color:function(){return re.color},ge=typeof W=="function"?W:function(){return W},pe=z._levels,xe=o(O,z,ne),Ee=xe.fill,Te=xe.line,de=Math.round(B*(U==="fraction"?I?J.w:J.h:1)),be=de/(I?J.w:J.h),Le=Math.round(F*(D==="fraction"?I?J.h:J.w:1)),De=Le/(I?J.h:J.w),ye=Math.round(I?V*J.w+G:H*J.h+Q),ke={center:.5,right:1}[q]||0,Oe={top:1,middle:.5}[K]||0,Qe=I?V-ke*be:H-Oe*be,Ve=I?H-Oe*De:V-ke*De,Ue=Math.round(I?J.h*(1-Ve):J.w*Ve);z._lenFrac=De,z._thickFrac=be,z._uFrac=Qe,z._vFrac=Ve;var Ie=z._axis=S(O,z,ne);Ie.position=be+(I?V+G/J.w:H+Q/J.h);var at=["top","bottom"].indexOf(Z)!==-1;if(I&&at&&(Ie.title.side=Z,Ie.titlex=V+G/J.w,Ie.titley=Ve+(j.side==="top"?De-Q/J.h:Q/J.h)),!I&&!at&&(Ie.title.side=Z,Ie.titley=H+Q/J.h,Ie.titlex=Ve+G/J.w),re.color&&z.tickmode==="auto"){Ie.tickmode="linear",Ie.tick0=pe.start;var pt=pe.size,Rt=g.constrain(Le/50,4,15)+1,Mt=(ne[1]-ne[0])/((z.nticks||Rt)*pt);if(Mt>1){var It=Math.pow(10,Math.floor(Math.log(Mt)/Math.LN10));pt*=It*g.roundUp(Mt/It,[2,5,10]),(Math.abs(pe.start)/pe.size+1e-6)%1<2e-6&&(Ie.tick0=0)}Ie.dtick=pt}Ie.domain=I?[Ve+Q/J.h,Ve+De-Q/J.h]:[Ve+G/J.w,Ve+De-G/J.w],Ie.setScale(),R.attr("transform",a(Math.round(J.l),Math.round(J.t)));var Bt=R.select("."+w.cbtitleunshift).attr("transform",a(-Math.round(J.l),-Math.round(J.t))),St=Ie.ticklabelposition,_t=Ie.title.font.size,it=R.select("."+w.cbaxis),ct,et=0,Pe=0;function We(Vt,qt){var zt={propContainer:Ie,propName:z._propPrefix+"title",traceIndex:z._traceIndex,_meta:z._meta,placeholder:ee._dfltTitle.colorbar,containerGroup:R.select("."+w.cbtitle)},Ht=Vt.charAt(0)==="h"?Vt.substr(1):"h"+Vt;R.selectAll("."+Ht+",."+Ht+"-math-group").remove(),d.draw(O,Vt,t(zt,qt||{}))}function je(){if(I&&at||!I&&!at){var Vt,qt;Z==="top"&&(Vt=G+J.l+J.w*V,qt=Q+J.t+J.h*(1-Ve-De)+3+_t*.75),Z==="bottom"&&(Vt=G+J.l+J.w*V,qt=Q+J.t+J.h*(1-Ve)-3-_t*.25),Z==="right"&&(qt=Q+J.t+J.h*H+3+_t*.75,Vt=G+J.l+J.w*Ve),We(Ie._id+"title",{attributes:{x:Vt,y:qt,"text-anchor":I?"start":"middle"}})}}function nt(){if(I&&!at||!I&&at){var Vt=Ie.position||0,qt=Ie._offset+Ie._length/2,zt,Ht;if(Z==="right")Ht=qt,zt=J.l+J.w*Vt+10+_t*(Ie.showticklabels?1:.5);else if(zt=qt,Z==="bottom"&&(Ht=J.t+J.h*Vt+10+(St.indexOf("inside")===-1?Ie.tickfont.size:0)+(Ie.ticks!=="intside"&&z.ticklen||0)),Z==="top"){var $t=j.text.split("<br>").length;Ht=J.t+J.h*Vt+10-de-l*_t*$t}We((I?"h":"v")+Ie._id+"title",{avoid:{selection:b.select(O).selectAll("g."+Ie._id+"tick"),side:Z,offsetTop:I?0:J.t,offsetLeft:I?J.l:0,maxShift:I?ee.width:ee.height},attributes:{x:zt,y:Ht,"text-anchor":"middle"},transform:{rotate:I?-90:0,offset:0}})}}function kt(){if(!I&&!at||I&&at){var Vt=R.select("."+w.cbtitle),qt=Vt.select("text"),zt=[-X/2,X/2],Ht=Vt.select(".h"+Ie._id+"title-math-group").node(),$t=15.6;qt.node()&&($t=parseInt(qt.node().style.fontSize,10)*l);var Qt;if(Ht?(Qt=n.bBox(Ht),Pe=Qt.width,et=Qt.height,et>$t&&(zt[1]-=(et-$t)/2)):qt.node()&&!qt.classed(w.jsPlaceholder)&&(Qt=n.bBox(qt.node()),Pe=Qt.width,et=Qt.height),I){if(et){if(et+=5,Z==="top")Ie.domain[1]-=et/J.h,zt[1]*=-1;else{Ie.domain[0]+=et/J.h;var fr=s.lineCount(qt);zt[1]+=(1-fr)*$t}Vt.attr("transform",a(zt[0],zt[1])),Ie.setScale()}}else Pe&&(Z==="right"&&(Ie.domain[0]+=(Pe+_t/2)/J.w),Vt.attr("transform",a(zt[0],zt[1])),Ie.setScale())}R.selectAll("."+w.cbfills+",."+w.cblines).attr("transform",I?a(0,Math.round(J.h*(1-Ie.domain[1]))):a(Math.round(J.w*Ie.domain[0]),0)),it.attr("transform",I?a(0,Math.round(-J.t)):a(Math.round(-J.l),0));var jr=R.select("."+w.cbfills).selectAll("rect."+w.cbfill).attr("style","").data(Ee);jr.enter().append("rect").classed(w.cbfill,!0).style("stroke","none"),jr.exit().remove();var cn=ne.map(Ie.c2p).map(Math.round).sort(function(Nt,gr){return Nt-gr});jr.each(function(Nt,gr){var tt=[gr===0?ne[0]:(Ee[gr]+Ee[gr-1])/2,gr===Ee.length-1?ne[1]:(Ee[gr]+Ee[gr+1])/2].map(Ie.c2p).map(Math.round);I&&(tt[1]=g.constrain(tt[1]+(tt[1]>tt[0])?1:-1,cn[0],cn[1]));var we=b.select(this).attr(I?"x":"y",ye).attr(I?"y":"x",b.min(tt)).attr(I?"width":"height",Math.max(de,2)).attr(I?"height":"width",Math.max(b.max(tt)-b.min(tt),2));if(z._fillgradient)n.gradient(we,O,z._id,I?"vertical":"horizontalreversed",z._fillgradient,"fill");else{var Me=ge(Nt).replace("e-","");we.attr("fill",k(Me).toHexString())}});var Qr=R.select("."+w.cblines).selectAll("path."+w.cbline).data(re.color&&re.width?Te:[]);Qr.enter().append("path").classed(w.cbline,!0),Qr.exit().remove(),Qr.each(function(Nt){var gr=ye,tt=Math.round(Ie.c2p(Nt))+re.width/2%1;b.select(this).attr("d","M"+(I?gr+","+tt:tt+","+gr)+(I?"h":"v")+de).call(n.lineGroupStyle,re.width,le(Nt),re.dash)}),it.selectAll("g."+Ie._id+"tick,path").remove();var lt=ye+de+(X||0)/2-(z.ticks==="outside"?1:0),Gt=e.calcTicks(Ie),Kt=e.getTickSigns(Ie)[2];return e.drawTicks(O,Ie,{vals:Ie.ticks==="inside"?e.clipEnds(Ie,Gt):Gt,layer:it,path:e.makeTickPath(Ie,lt,Kt),transFn:e.makeTransTickFn(Ie)}),e.drawLabels(O,Ie,{vals:Gt,layer:it,transFn:e.makeTransTickLabelFn(Ie),labelFns:e.makeLabelFns(Ie,lt)})}function wt(){var Vt,qt=de+X/2;St.indexOf("inside")===-1&&(Vt=n.bBox(it.node()),qt+=I?Vt.width:Vt.height),ct=Bt.select("text");var zt=0,Ht=I&&Z==="top",$t=!I&&Z==="right",Qt=0;if(ct.node()&&!ct.classed(w.jsPlaceholder)){var fr,jr=Bt.select(".h"+Ie._id+"title-math-group").node();jr&&(I&&at||!I&&!at)?(Vt=n.bBox(jr),zt=Vt.width,fr=Vt.height):(Vt=n.bBox(Bt.node()),zt=Vt.right-J.l-(I?ye:Ue),fr=Vt.bottom-J.t-(I?Ue:ye),!I&&Z==="top"&&(qt+=Vt.height,Qt=Vt.height)),$t&&(ct.attr("transform",a(zt/2+_t/2,0)),zt*=2),qt=Math.max(qt,I?zt:fr)}var cn=(I?G:Q)*2+qt+oe+X/2,Qr=0;!I&&j.text&&K==="bottom"&&H<=0&&(Qr=cn/2,cn+=Qr,Qt+=Qr),ee._hColorbarMoveTitle=Qr,ee._hColorbarMoveCBTitle=Qt;var lt=oe+X;R.select("."+w.cbbg).attr("x",(I?ye:Ue)-lt/2-(I?G:0)).attr("y",(I?Ue:ye)-(I?Le:Q+Qt-Qr)).attr(I?"width":"height",Math.max(cn-Qr,2)).attr(I?"height":"width",Math.max(Le+lt,2)).call(r.fill,se).call(r.stroke,z.bordercolor).style("stroke-width",oe);var Gt=$t?Math.max(zt-10,0):0;if(R.selectAll("."+w.cboutline).attr("x",(I?ye:Ue+G)+Gt).attr("y",(I?Ue+Q-Le:ye)+(Ht?et:0)).attr(I?"width":"height",Math.max(de,2)).attr(I?"height":"width",Math.max(Le-(I?2*Q+et:2*G+Gt),2)).call(r.stroke,z.outlinecolor).style({fill:"none","stroke-width":X}),R.attr("transform",a(J.l-(I?ke*cn:0),J.t-(I?0:(1-Oe)*cn-Qt))),!I&&(oe||k(se).getAlpha()&&!k.equals(ee.paper_bgcolor,se))){var Kt=it.selectAll("text"),Nt=Kt[0].length,gr=R.select("."+w.cbbg).node(),tt=n.bBox(gr),we=n.getTranslate(R),Me=2;Kt.each(function(bt,Et){var Wt=0,Ot=Nt-1;if(Et===Wt||Et===Ot){var ir=n.bBox(this),vr=n.getTranslate(this),_r;if(Et===Ot){var ln=ir.right+vr.x,Cr=tt.right+we.x+Ue-oe-Me+V;_r=Cr-ln,_r>0&&(_r=0)}else if(Et===Wt){var Gr=ir.left+vr.x,sn=tt.left+we.x+Ue+oe+Me;_r=sn-Gr,_r<0&&(_r=0)}_r&&(Nt<3?this.setAttribute("transform","translate("+_r+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var Ne={},Xe=y[q],Ke=T[q],rt=y[K],Je=T[K],vt=cn-de;I?(D==="pixels"?(Ne.y=H,Ne.t=Le*rt,Ne.b=Le*Je):(Ne.t=Ne.b=0,Ne.yt=H+F*rt,Ne.yb=H-F*Je),U==="pixels"?(Ne.x=V,Ne.l=cn*Xe,Ne.r=cn*Ke):(Ne.l=vt*Xe,Ne.r=vt*Ke,Ne.xl=V-B*Xe,Ne.xr=V+B*Ke)):(D==="pixels"?(Ne.x=V,Ne.l=Le*Xe,Ne.r=Le*Ke):(Ne.l=Ne.r=0,Ne.xl=V+F*Xe,Ne.xr=V-F*Ke),U==="pixels"?(Ne.y=1-H,Ne.t=cn*rt,Ne.b=cn*Je):(Ne.t=vt*rt,Ne.b=vt*Je,Ne.yt=H-B*rt,Ne.yb=H+B*Je)),P.autoMargin(O,z._id,Ne)}return g.syncOrAsync([P.previousPromises,je,kt,nt,P.previousPromises,wt],O)}function h(R,z,O){var I=z.orientation==="v",F=O._fullLayout,D=F._size,B,U,X;p.init({element:R.node(),gd:O,prepFn:function(){B=R.attr("transform"),i(R)},moveFn:function(oe,se){R.attr("transform",B+a(oe,se)),U=p.align((I?z._uFrac:z._vFrac)+oe/D.w,I?z._thickFrac:z._lenFrac,0,1,z.xanchor),X=p.align((I?z._vFrac:1-z._uFrac)-se/D.h,I?z._lenFrac:z._thickFrac,0,1,z.yanchor);var q=p.getCursor(U,X,z.xanchor,z.yanchor);i(R,q)},doneFn:function(){if(i(R),U!==void 0&&X!==void 0){var oe={};oe[z._propPrefix+"x"]=U,oe[z._propPrefix+"y"]=X,z._traceIndex!==void 0?E.call("_guiRestyle",O,oe,z._traceIndex):E.call("_guiRelayout",O,oe)}}})}function o(R,z,O){var I=z._levels,F=[],D=[],B,U,X=I.end+I.size/100,oe=I.size,se=1.001*O[0]-.001*O[1],q=1.001*O[1]-.001*O[0];for(U=0;U<1e5&&(B=I.start+U*oe,!(oe>0?B>=X:B<=X));U++)B>se&&B<q&&F.push(B);if(z._fillgradient)D=[0];else if(typeof z._fillcolor=="function"){var K=z._filllevels;if(K)for(X=K.end+K.size/100,oe=K.size,U=0;U<1e5&&(B=K.start+U*oe,!(oe>0?B>=X:B<=X));U++)B>O[0]&&B<O[1]&&D.push(B);else D=F.map(function(G){return G-I.size/2}),D.push(D[D.length-1]+I.size)}else z._fillcolor&&typeof z._fillcolor=="string"&&(D=[0]);return I.size<0&&(F.reverse(),D.reverse()),{line:F,fill:D}}function S(R,z,O){var I=R._fullLayout,F=z.orientation==="v",D={type:"linear",range:O,tickmode:z.tickmode,nticks:z.nticks,tick0:z.tick0,dtick:z.dtick,tickvals:z.tickvals,ticktext:z.ticktext,ticks:z.ticks,ticklen:z.ticklen,tickwidth:z.tickwidth,tickcolor:z.tickcolor,showticklabels:z.showticklabels,ticklabelposition:z.ticklabelposition,ticklabeloverflow:z.ticklabeloverflow,ticklabelstep:z.ticklabelstep,tickfont:z.tickfont,tickangle:z.tickangle,tickformat:z.tickformat,exponentformat:z.exponentformat,minexponent:z.minexponent,separatethousands:z.separatethousands,showexponent:z.showexponent,showtickprefix:z.showtickprefix,tickprefix:z.tickprefix,showticksuffix:z.showticksuffix,ticksuffix:z.ticksuffix,title:z.title,showline:!0,anchor:"free",side:F?"right":"bottom",position:1},B=F?"y":"x",U={type:"linear",_id:B+z._id},X={letter:B,font:I.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:I.calendar};function oe(se,q){return g.coerce(D,U,v,se,q)}return x(D,U,oe,X,I),M(D,U,oe,X),U}ae.exports={draw:A}},{"../../constants/alignment":471,"../../lib":503,"../../lib/extend":493,"../../lib/setcursor":524,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_defaults":556,"../../plots/cartesian/layout_attributes":569,"../../plots/cartesian/position_defaults":572,"../../plots/plots":619,"../../registry":638,"../color":366,"../colorscale/helpers":377,"../dragelement":385,"../drawing":388,"../titles":464,"./constants":368,"@plotly/d3":58,tinycolor2:312}],371:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P){return b.isPlainObject(P.colorbar)}},{"../../lib":503}],372:[function(c,ae,ie){"use strict";ae.exports={moduleType:"component",name:"colorbar",attributes:c("./attributes"),supplyDefaults:c("./defaults"),draw:c("./draw").draw,hasColorbar:c("./has_colorbar")}},{"./attributes":367,"./defaults":369,"./draw":370,"./has_colorbar":371}],373:[function(c,ae,ie){"use strict";var b=c("../colorbar/attributes"),k=c("../../lib/regex").counter,P=c("../../lib/sort_object_keys"),E=c("./scales.js").scales,e=P(E);function p(g){return"`"+g+"`"}ae.exports=function(a,t){a=a||"",t=t||{};var i=t.cLetter||"c",n="onlyIfNumerical"in t?t.onlyIfNumerical:Boolean(a),r="noScale"in t?t.noScale:a==="marker.line",d="showScaleDflt"in t?t.showScaleDflt:i==="z",s=typeof t.colorscaleDflt=="string"?E[t.colorscaleDflt]:null,m=t.editTypeOverride||"",x=a?a+".":"",M,v;"colorAttr"in t?(M=t.colorAttr,v=t.colorAttr):(M={z:"z",c:"color"}[i],v="in "+p(x+M));var _=n?" Has an effect only if "+v+"is set to a numerical array.":"",l=i+"auto",y=i+"min",T=i+"max",w=i+"mid",A=p(x+l),f=p(x+y),u=p(x+T),h=f+" and "+u,o={};o[y]=o[T]=void 0;var S={};S[l]=!1;var R={};return M==="color"&&(R.color={valType:"color",arrayOk:!0,editType:m||"style"},t.anim&&(R.color.anim=!0)),R[l]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:o},R[y]={valType:"number",dflt:null,editType:m||"plot",impliedEdits:S},R[T]={valType:"number",dflt:null,editType:m||"plot",impliedEdits:S},R[w]={valType:"number",dflt:null,editType:"calc",impliedEdits:o},R.colorscale={valType:"colorscale",editType:"calc",dflt:s,impliedEdits:{autocolorscale:!1}},R.autocolorscale={valType:"boolean",dflt:t.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},R.reversescale={valType:"boolean",dflt:!1,editType:"plot"},r||(R.showscale={valType:"boolean",dflt:d,editType:"calc"},R.colorbar=b),t.noColorAxis||(R.coloraxis={valType:"subplotid",regex:k("coloraxis"),dflt:null,editType:"calc"}),R}},{"../../lib/regex":520,"../../lib/sort_object_keys":526,"../colorbar/attributes":367,"./scales.js":381}],374:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("./helpers").extractOpts;ae.exports=function(e,p,g){var a=e._fullLayout,t=g.vals,i=g.containerStr,n=i?k.nestedProperty(p,i).get():p,r=P(n),d=r.auto!==!1,s=r.min,m=r.max,x=r.mid,M=function(){return k.aggNums(Math.min,null,t)},v=function(){return k.aggNums(Math.max,null,t)};if(s===void 0?s=M():d&&(n._colorAx&&b(s)?s=Math.min(s,M()):s=M()),m===void 0?m=v():d&&(n._colorAx&&b(m)?m=Math.max(m,v()):m=v()),d&&x!==void 0&&(m-x>x-s?s=x-(m-x):m-x<x-s&&(m=x+(x-s))),s===m&&(s-=.5,m+=.5),r._sync("min",s),r._sync("max",m),r.autocolorscale){var _;s*m<0?_=a.colorscale.diverging:s>=0?_=a.colorscale.sequential:_=a.colorscale.sequentialminus,r._sync("colorscale",_)}}},{"../../lib":503,"./helpers":377,"fast-isnumeric":190}],375:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./helpers").hasColorscale,P=c("./helpers").extractOpts;ae.exports=function(e,p){function g(s,m){var x=s["_"+m];x!==void 0&&(s[m]=x)}function a(s,m){var x=m.container?b.nestedProperty(s,m.container).get():s;if(x)if(x.coloraxis)x._colorAx=p[x.coloraxis];else{var M=P(x),v=M.auto;(v||M.min===void 0)&&g(x,m.min),(v||M.max===void 0)&&g(x,m.max),M.autocolorscale&&g(x,"colorscale")}}for(var t=0;t<e.length;t++){var i=e[t],n=i._module.colorbar;if(n)if(Array.isArray(n))for(var r=0;r<n.length;r++)a(i,n[r]);else a(i,n);k(i,"marker.line")&&a(i,{container:"marker.line",min:"cmin",max:"cmax"})}for(var d in p._colorAxes)a(p[d],{min:"cmin",max:"cmax"})}},{"../../lib":503,"./helpers":377}],376:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../colorbar/has_colorbar"),E=c("../colorbar/defaults"),e=c("./scales").isValid,p=c("../../registry").traceIs;function g(a,t){var i=t.slice(0,t.length-1);return t?k.nestedProperty(a,i).get()||{}:a}ae.exports=function a(t,i,n,r,d){var s=d.prefix,m=d.cLetter,x="_module"in i,M=g(t,s),v=g(i,s),_=g(i._template||{},s)||{},l=function(){return delete t.coloraxis,delete i.coloraxis,a(t,i,n,r,d)};if(x){var y=n._colorAxes||{},T=r(s+"coloraxis");if(T){var w=p(i,"contour")&&k.nestedProperty(i,"contours.coloring").get()||"heatmap",A=y[T];A?(A[2].push(l),A[0]!==w&&(A[0]=!1,k.warn(["Ignoring coloraxis:",T,"setting","as it is linked to incompatible colorscales."].join(" ")))):y[T]=[w,i,[l]];return}}var f=M[m+"min"],u=M[m+"max"],h=b(f)&&b(u)&&f<u,o=r(s+m+"auto",!h);o?r(s+m+"mid"):(r(s+m+"min"),r(s+m+"max"));var S=M.colorscale,R=_.colorscale,z;if(S!==void 0&&(z=!e(S)),R!==void 0&&(z=!e(R)),r(s+"autocolorscale",z),r(s+"colorscale"),r(s+"reversescale"),s!=="marker.line."){var O;s&&x&&(O=P(M));var I=r(s+"showscale",O);I&&(s&&_&&(v._template=_),E(M,v,n))}}},{"../../lib":503,"../../registry":638,"../colorbar/defaults":369,"../colorbar/has_colorbar":371,"./scales":381,"fast-isnumeric":190}],377:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("tinycolor2"),P=c("fast-isnumeric"),E=c("../../lib"),e=c("../color"),p=c("./scales").isValid;function g(x,M,v){var _=M?E.nestedProperty(x,M).get()||{}:x,l=_[v||"color"],y=!1;if(E.isArrayOrTypedArray(l)){for(var T=0;T<l.length;T++)if(P(l[T])){y=!0;break}}return E.isPlainObject(_)&&(y||_.showscale===!0||P(_.cmin)&&P(_.cmax)||p(_.colorscale)||E.isPlainObject(_.colorbar))}var a=["showscale","autocolorscale","colorscale","reversescale","colorbar"],t=["min","max","mid","auto"];function i(x){var M=x._colorAx,v=M||x,_={},l,y,T;for(y=0;y<a.length;y++)T=a[y],_[T]=v[T];if(M)for(l="c",y=0;y<t.length;y++)T=t[y],_[T]=v["c"+T];else{var w;for(y=0;y<t.length;y++){if(T=t[y],w="c"+T,w in v){_[T]=v[w];continue}w="z"+T,w in v&&(_[T]=v[w])}l=w.charAt(0)}return _._sync=function(A,f){var u=t.indexOf(A)!==-1?l+A:A;v[u]=v["_"+u]=f},_}function n(x){for(var M=i(x),v=M.min,_=M.max,l=M.reversescale?r(M.colorscale):M.colorscale,y=l.length,T=new Array(y),w=new Array(y),A=0;A<y;A++){var f=l[A];T[A]=v+f[0]*(_-v),w[A]=f[1]}return{domain:T,range:w}}function r(x){for(var M=x.length,v=new Array(M),_=M-1,l=0;_>=0;_--,l++){var y=x[_];v[l]=[1-y[0],y[1]]}return v}function d(x,M){M=M||{};for(var v=x.domain,_=x.range,l=_.length,y=new Array(l),T=0;T<l;T++){var w=k(_[T]).toRgb();y[T]=[w.r,w.g,w.b,w.a]}var A=b.scale.linear().domain(v).range(y).clamp(!0),f=M.noNumericCheck,u=M.returnArray,h;return f&&u?h=A:f?h=function(o){return m(A(o))}:u?h=function(o){return P(o)?A(o):k(o).isValid()?o:e.defaultLine}:h=function(o){return P(o)?m(A(o)):k(o).isValid()?o:e.defaultLine},h.domain=A.domain,h.range=function(){return _},h}function s(x,M){return d(n(x),M)}function m(x){var M={r:x[0],g:x[1],b:x[2],a:x[3]};return k(M).toRgbString()}ae.exports={hasColorscale:g,extractOpts:i,extractScale:n,flipScale:r,makeColorScaleFunc:d,makeColorScaleFuncFromTrace:s}},{"../../lib":503,"../color":366,"./scales":381,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:312}],378:[function(c,ae,ie){"use strict";var b=c("./scales"),k=c("./helpers");ae.exports={moduleType:"component",name:"colorscale",attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyLayoutDefaults:c("./layout_defaults"),handleDefaults:c("./defaults"),crossTraceDefaults:c("./cross_trace_defaults"),calc:c("./calc"),scales:b.scales,defaultScale:b.defaultScale,getScale:b.get,isValidScale:b.isValid,hasColorscale:k.hasColorscale,extractOpts:k.extractOpts,extractScale:k.extractScale,flipScale:k.flipScale,makeColorScaleFunc:k.makeColorScaleFunc,makeColorScaleFuncFromTrace:k.makeColorScaleFuncFromTrace}},{"./attributes":373,"./calc":374,"./cross_trace_defaults":375,"./defaults":376,"./helpers":377,"./layout_attributes":379,"./layout_defaults":380,"./scales":381}],379:[function(c,ae,ie){"use strict";var b=c("../../lib/extend").extendFlat,k=c("./attributes"),P=c("./scales").scales,E="Note that `autocolorscale` must be true for this attribute to work.";ae.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:P.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:P.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:P.RdBu,editType:"calc"}},coloraxis:b({_isSubplotObj:!0,editType:"calc"},k("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":493,"./attributes":373,"./scales":381}],380:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plot_api/plot_template"),P=c("./layout_attributes"),E=c("./defaults");ae.exports=function(p,g){function a(x,M){return b.coerce(p,g,P,x,M)}a("colorscale.sequential"),a("colorscale.sequentialminus"),a("colorscale.diverging");var t=g._colorAxes,i,n;function r(x,M){return b.coerce(i,n,P.coloraxis,x,M)}for(var d in t){var s=t[d];if(s[0])i=p[d]||{},n=k.newContainer(g,d,"coloraxis"),n._name=d,E(i,n,g,r,{prefix:"",cLetter:"c"});else{for(var m=0;m<s[2].length;m++)s[2][m]();delete g._colorAxes[d]}}}},{"../../lib":503,"../../plot_api/plot_template":543,"./defaults":376,"./layout_attributes":379}],381:[function(c,ae,ie){"use strict";var b=c("tinycolor2"),k={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},P=k.RdBu;function E(g,a){if(a||(a=P),!g)return a;function t(){try{g=k[g]||JSON.parse(g)}catch{g=a}}return typeof g=="string"&&(t(),typeof g=="string"&&t()),e(g)?g:a}function e(g){var a=0;if(!Array.isArray(g)||g.length<2||!g[0]||!g[g.length-1]||+g[0][0]!=0||+g[g.length-1][0]!=1)return!1;for(var t=0;t<g.length;t++){var i=g[t];if(i.length!==2||+i[0]<a||!b(i[1]).isValid())return!1;a=+i[0]}return!0}function p(g){return k[g]!==void 0?!0:e(g)}ae.exports={scales:k,defaultScale:P,get:E,isValid:p}},{tinycolor2:312}],382:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e,p){var g=(k-E)/(e-E),a=g+P/(e-E),t=(g+a)/2;return p==="left"||p==="bottom"?g:p==="center"||p==="middle"?t:p==="right"||p==="top"?a:g<2/3-t?g:a>4/3-t?a:t}},{}],383:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];ae.exports=function(E,e,p,g){return p==="left"?E=0:p==="center"?E=1:p==="right"?E=2:E=b.constrain(Math.floor(E*3),0,2),g==="bottom"?e=0:g==="middle"?e=1:g==="top"?e=2:e=b.constrain(Math.floor(e*3),0,2),k[e][E]}},{"../../lib":503}],384:[function(c,ae,ie){"use strict";ie.selectMode=function(b){return b==="lasso"||b==="select"},ie.drawMode=function(b){return b==="drawclosedpath"||b==="drawopenpath"||b==="drawline"||b==="drawrect"||b==="drawcircle"},ie.openMode=function(b){return b==="drawline"||b==="drawopenpath"},ie.rectMode=function(b){return b==="select"||b==="drawline"||b==="drawrect"||b==="drawcircle"},ie.freeMode=function(b){return b==="lasso"||b==="drawclosedpath"||b==="drawopenpath"},ie.selectingOrDrawing=function(b){return ie.freeMode(b)||ie.rectMode(b)}},{}],385:[function(c,ae,ie){"use strict";var b=c("mouse-event-offset"),k=c("has-hover"),P=c("has-passive-events"),E=c("../../lib").removeElement,e=c("../../plots/cartesian/constants"),p=ae.exports={};p.align=c("./align"),p.getCursor=c("./cursor");var g=c("./unhover");p.unhover=g.wrapped,p.unhoverRaw=g.raw,p.init=function(n){var r=n.gd,d=1,s=r._context.doubleClickDelay,m=n.element,x,M,v,_,l,y,T,w;r._mouseDownTime||(r._mouseDownTime=0),m.style.pointerEvents="all",m.onmousedown=u,P?(m._ontouchstart&&m.removeEventListener("touchstart",m._ontouchstart),m._ontouchstart=u,m.addEventListener("touchstart",u,{passive:!1})):m.ontouchstart=u;function A(S,R,z){return Math.abs(S)<z&&(S=0),Math.abs(R)<z&&(R=0),[S,R]}var f=n.clampFn||A;function u(S){r._dragged=!1,r._dragging=!0;var R=t(S);x=R[0],M=R[1],T=S.target,y=S,w=S.buttons===2||S.ctrlKey,typeof S.clientX>"u"&&typeof S.clientY>"u"&&(S.clientX=x,S.clientY=M),v=new Date().getTime(),v-r._mouseDownTime<s?d+=1:(d=1,r._mouseDownTime=v),n.prepFn&&n.prepFn(S,x,M),k&&!w?(l=a(),l.style.cursor=window.getComputedStyle(m).cursor):k||(l=document,_=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(m).cursor),document.addEventListener("mouseup",o),document.addEventListener("touchend",o),n.dragmode!==!1&&(S.preventDefault(),document.addEventListener("mousemove",h),document.addEventListener("touchmove",h,{passive:!1}))}function h(S){S.preventDefault();var R=t(S),z=n.minDrag||e.MINDRAG,O=f(R[0]-x,R[1]-M,z),I=O[0],F=O[1];(I||F)&&(r._dragged=!0,p.unhover(r,S)),r._dragged&&n.moveFn&&!w&&(r._dragdata={element:m,dx:I,dy:F},n.moveFn(I,F))}function o(S){if(delete r._dragdata,n.dragmode!==!1&&(S.preventDefault(),document.removeEventListener("mousemove",h),document.removeEventListener("touchmove",h)),document.removeEventListener("mouseup",o),document.removeEventListener("touchend",o),k?E(l):_&&(l.documentElement.style.cursor=_,_=null),!r._dragging){r._dragged=!1;return}if(r._dragging=!1,new Date().getTime()-r._mouseDownTime>s&&(d=Math.max(d-1,1)),r._dragged)n.doneFn&&n.doneFn();else if(n.clickFn&&n.clickFn(d,y),!w){var R;try{R=new MouseEvent("click",S)}catch{var z=t(S);R=document.createEvent("MouseEvents"),R.initMouseEvent("click",S.bubbles,S.cancelable,S.view,S.detail,S.screenX,S.screenY,z[0],z[1],S.ctrlKey,S.altKey,S.shiftKey,S.metaKey,S.button,S.relatedTarget)}T.dispatchEvent(R)}r._dragging=!1,r._dragged=!1}};function a(){var i=document.createElement("div");i.className="dragcover";var n=i.style;return n.position="fixed",n.left=0,n.right=0,n.top=0,n.bottom=0,n.zIndex=999999999,n.background="none",document.body.appendChild(i),i}p.coverSlip=a;function t(i){return b(i.changedTouches?i.changedTouches[0]:i,document.body)}},{"../../lib":503,"../../plots/cartesian/constants":561,"./align":382,"./cursor":383,"./unhover":386,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],386:[function(c,ae,ie){"use strict";var b=c("../../lib/events"),k=c("../../lib/throttle"),P=c("../../lib/dom").getGraphDiv,E=c("../fx/constants"),e=ae.exports={};e.wrapped=function(p,g,a){p=P(p),p._fullLayout&&k.clear(p._fullLayout._uid+E.HOVERID),e.raw(p,g,a)},e.raw=function(g,a){var t=g._fullLayout,i=g._hoverdata;a||(a={}),!(a.target&&!g._dragged&&b.triggerHandler(g,"plotly_beforehover",a)===!1)&&(t._hoverlayer.selectAll("g").remove(),t._hoverlayer.selectAll("line").remove(),t._hoverlayer.selectAll("circle").remove(),g._hoverdata=void 0,a.target&&i&&g.emit("plotly_unhover",{event:a,points:i}))}},{"../../lib/dom":491,"../../lib/events":492,"../../lib/throttle":530,"../fx/constants":400}],387:[function(c,ae,ie){"use strict";ie.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},ie.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],388:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=k.numberFormat,E=c("fast-isnumeric"),e=c("tinycolor2"),p=c("../../registry"),g=c("../color"),a=c("../colorscale"),t=k.strTranslate,i=c("../../lib/svg_text_utils"),n=c("../../constants/xmlns_namespaces"),r=c("../../constants/alignment"),d=r.LINE_SPACING,s=c("../../constants/interactions").DESELECTDIM,m=c("../../traces/scatter/subtypes"),x=c("../../traces/scatter/make_bubble_size_func"),M=c("../../components/fx/helpers").appendArrayPointValue,v=ae.exports={};v.font=function(q,K,G,Q){k.isPlainObject(K)&&(Q=K.color,G=K.size,K=K.family),K&&q.style("font-family",K),G+1&&q.style("font-size",G+"px"),Q&&q.call(g.fill,Q)},v.setPosition=function(q,K,G){q.attr("x",K).attr("y",G)},v.setSize=function(q,K,G){q.attr("width",K).attr("height",G)},v.setRect=function(q,K,G,Q,V){q.call(v.setPosition,K,G).call(v.setSize,Q,V)},v.translatePoint=function(q,K,G,Q){var V=G.c2p(q.x),H=Q.c2p(q.y);if(E(V)&&E(H)&&K.node())K.node().nodeName==="text"?K.attr("x",V).attr("y",H):K.attr("transform",t(V,H));else return!1;return!0},v.translatePoints=function(q,K,G){q.each(function(Q){var V=b.select(this);v.translatePoint(Q,V,K,G)})},v.hideOutsideRangePoint=function(q,K,G,Q,V,H){K.attr("display",G.isPtWithinRange(q,V)&&Q.isPtWithinRange(q,H)?null:"none")},v.hideOutsideRangePoints=function(q,K){if(!!K._hasClipOnAxisFalse){var G=K.xaxis,Q=K.yaxis;q.each(function(V){var H=V[0].trace,ee=H.xcalendar,J=H.ycalendar,W=p.traceIs(H,"bar-like")?".bartext":".point,.textpoint";q.selectAll(W).each(function(re){v.hideOutsideRangePoint(re,b.select(this),G,Q,ee,J)})})}},v.crispRound=function(q,K,G){return!K||!E(K)?G||0:q._context.staticPlot?K:K<1?1:Math.round(K)},v.singleLineStyle=function(q,K,G,Q,V){K.style("fill","none");var H=(((q||[])[0]||{}).trace||{}).line||{},ee=G||H.width||0,J=V||H.dash||"";g.stroke(K,Q||H.color),v.dashLine(K,J,ee)},v.lineGroupStyle=function(q,K,G,Q){q.style("fill","none").each(function(V){var H=(((V||[])[0]||{}).trace||{}).line||{},ee=K||H.width||0,J=Q||H.dash||"";b.select(this).call(g.stroke,G||H.color).call(v.dashLine,J,ee)})},v.dashLine=function(q,K,G){G=+G||0,K=v.dashStyle(K,G),q.style({"stroke-dasharray":K,"stroke-width":G+"px"})},v.dashStyle=function(q,K){K=+K||1;var G=Math.max(K,3);return q==="solid"?q="":q==="dot"?q=G+"px,"+G+"px":q==="dash"?q=3*G+"px,"+3*G+"px":q==="longdash"?q=5*G+"px,"+5*G+"px":q==="dashdot"?q=3*G+"px,"+G+"px,"+G+"px,"+G+"px":q==="longdashdot"&&(q=5*G+"px,"+2*G+"px,"+G+"px,"+2*G+"px"),q};function _(q,K,G){var Q=K.fillpattern,V=Q&&v.getPatternAttr(Q.shape,0,"");if(V){var H=v.getPatternAttr(Q.bgcolor,0,null),ee=v.getPatternAttr(Q.fgcolor,0,null),J=Q.fgopacity,W=v.getPatternAttr(Q.size,0,8),re=v.getPatternAttr(Q.solidity,0,.3),j=K.uid;v.pattern(q,"point",G,j,V,W,re,void 0,Q.fillmode,H,ee,J)}else K.fillcolor&&q.call(g.fill,K.fillcolor)}v.singleFillStyle=function(q,K){var G=b.select(q.node()),Q=G.data(),V=((Q[0]||[])[0]||{}).trace||{};_(q,V,K)},v.fillGroupStyle=function(q,K){q.style("stroke-width",0).each(function(G){var Q=b.select(this);G[0].trace&&_(Q,G[0].trace,K)})};var l=c("./symbol_defs");v.symbolNames=[],v.symbolFuncs=[],v.symbolNeedLines={},v.symbolNoDot={},v.symbolNoFill={},v.symbolList=[],Object.keys(l).forEach(function(q){var K=l[q],G=K.n;v.symbolList.push(G,String(G),q,G+100,String(G+100),q+"-open"),v.symbolNames[G]=q,v.symbolFuncs[G]=K.f,K.needLine&&(v.symbolNeedLines[G]=!0),K.noDot?v.symbolNoDot[G]=!0:v.symbolList.push(G+200,String(G+200),q+"-dot",G+300,String(G+300),q+"-open-dot"),K.noFill&&(v.symbolNoFill[G]=!0)});var y=v.symbolNames.length,T="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";v.symbolNumber=function(q){if(E(q))q=+q;else if(typeof q=="string"){var K=0;q.indexOf("-open")>0&&(K=100,q=q.replace("-open","")),q.indexOf("-dot")>0&&(K+=200,q=q.replace("-dot","")),q=v.symbolNames.indexOf(q),q>=0&&(q+=K)}return q%100>=y||q>=400?0:Math.floor(Math.max(q,0))};function w(q,K){var G=q%100;return v.symbolFuncs[G](K)+(q>=200?T:"")}var A={x1:1,x2:0,y1:0,y2:0},f={x1:0,x2:0,y1:1,y2:0},u=P("~f"),h={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:A},horizontalreversed:{node:"linearGradient",attrs:A,reversed:!0},vertical:{node:"linearGradient",attrs:f},verticalreversed:{node:"linearGradient",attrs:f,reversed:!0}};v.gradient=function(q,K,G,Q,V,H){for(var ee=V.length,J=h[Q],W=new Array(ee),re=0;re<ee;re++)J.reversed?W[ee-1-re]=[u((1-V[re][0])*100),V[re][1]]:W[re]=[u(V[re][0]*100),V[re][1]];var j=K._fullLayout,Z="g"+j._uid+"-"+G,ne=j._defs.select(".gradients").selectAll("#"+Z).data([Q+W.join(";")],k.identity);ne.exit().remove(),ne.enter().append(J.node).each(function(){var le=b.select(this);J.attrs&&le.attr(J.attrs),le.attr("id",Z);var ge=le.selectAll("stop").data(W);ge.exit().remove(),ge.enter().append("stop"),ge.each(function(pe){var xe=e(pe[1]);b.select(this).attr({offset:pe[0]+"%","stop-color":g.tinyRGB(xe),"stop-opacity":xe.getAlpha()})})}),q.style(H,X(Z,K)).style(H+"-opacity",null),q.classed("gradient_filled",!0)},v.pattern=function(q,K,G,Q,V,H,ee,J,W,re,j,Z){var ne=K==="legend";J&&(W==="overlay"?(re=J,j=g.contrast(re)):(re=void 0,j=J));var le=G._fullLayout,ge="p"+le._uid+"-"+Q,pe,xe,Ee=function(Oe,Qe,Ve,Ue,Ie){return Ue+(Ie-Ue)*(Oe-Qe)/(Ve-Qe)},Te,de,be,Le,De={};switch(V){case"/":pe=H*Math.sqrt(2),xe=H*Math.sqrt(2),Te="M-"+pe/4+","+xe/4+"l"+pe/2+",-"+xe/2+"M0,"+xe+"L"+pe+",0M"+pe/4*3+","+xe/4*5+"l"+pe/2+",-"+xe/2,de=ee*H,Le="path",De={d:Te,opacity:Z,stroke:j,"stroke-width":de+"px"};break;case"\\":pe=H*Math.sqrt(2),xe=H*Math.sqrt(2),Te="M"+pe/4*3+",-"+xe/4+"l"+pe/2+","+xe/2+"M0,0L"+pe+","+xe+"M-"+pe/4+","+xe/4*3+"l"+pe/2+","+xe/2,de=ee*H,Le="path",De={d:Te,opacity:Z,stroke:j,"stroke-width":de+"px"};break;case"x":pe=H*Math.sqrt(2),xe=H*Math.sqrt(2),Te="M-"+pe/4+","+xe/4+"l"+pe/2+",-"+xe/2+"M0,"+xe+"L"+pe+",0M"+pe/4*3+","+xe/4*5+"l"+pe/2+",-"+xe/2+"M"+pe/4*3+",-"+xe/4+"l"+pe/2+","+xe/2+"M0,0L"+pe+","+xe+"M-"+pe/4+","+xe/4*3+"l"+pe/2+","+xe/2,de=H-H*Math.sqrt(1-ee),Le="path",De={d:Te,opacity:Z,stroke:j,"stroke-width":de+"px"};break;case"|":pe=H,xe=H,Le="path",Te="M"+pe/2+",0L"+pe/2+","+xe,de=ee*H,Le="path",De={d:Te,opacity:Z,stroke:j,"stroke-width":de+"px"};break;case"-":pe=H,xe=H,Le="path",Te="M0,"+xe/2+"L"+pe+","+xe/2,de=ee*H,Le="path",De={d:Te,opacity:Z,stroke:j,"stroke-width":de+"px"};break;case"+":pe=H,xe=H,Le="path",Te="M"+pe/2+",0L"+pe/2+","+xe+"M0,"+xe/2+"L"+pe+","+xe/2,de=H-H*Math.sqrt(1-ee),Le="path",De={d:Te,opacity:Z,stroke:j,"stroke-width":de+"px"};break;case".":pe=H,xe=H,ee<Math.PI/4?be=Math.sqrt(ee*H*H/Math.PI):be=Ee(ee,Math.PI/4,1,H/2,H/Math.sqrt(2)),Le="circle",De={cx:pe/2,cy:xe/2,r:be,opacity:Z,fill:j};break}var ye=[V||"noSh",re||"noBg",j||"noFg",H,ee].join(";"),ke=le._defs.select(".patterns").selectAll("#"+ge).data([ye],k.identity);ke.exit().remove(),ke.enter().append("pattern").each(function(){var Oe=b.select(this);if(Oe.attr({id:ge,width:pe+"px",height:xe+"px",patternUnits:"userSpaceOnUse",patternTransform:ne?"scale(0.8)":""}),re){var Qe=Oe.selectAll("rect").data([0]);Qe.exit().remove(),Qe.enter().append("rect").attr({width:pe+"px",height:xe+"px",fill:re})}var Ve=Oe.selectAll(Le).data([0]);Ve.exit().remove(),Ve.enter().append(Le).attr(De)}),q.style("fill",X(ge,G)).style("fill-opacity",null),q.classed("pattern_filled",!0)},v.initGradients=function(q){var K=q._fullLayout,G=k.ensureSingle(K._defs,"g","gradients");G.selectAll("linearGradient,radialGradient").remove(),b.select(q).selectAll(".gradient_filled").classed("gradient_filled",!1)},v.initPatterns=function(q){var K=q._fullLayout,G=k.ensureSingle(K._defs,"g","patterns");G.selectAll("pattern").remove(),b.select(q).selectAll(".pattern_filled").classed("pattern_filled",!1)},v.getPatternAttr=function(q,K,G){return q&&k.isArrayOrTypedArray(q)?K<q.length?q[K]:G:q},v.pointStyle=function(q,K,G){if(!!q.size()){var Q=v.makePointStyleFns(K);q.each(function(V){v.singlePointStyle(V,b.select(this),K,Q,G)})}},v.singlePointStyle=function(q,K,G,Q,V){var H=G.marker,ee=H.line;if(K.style("opacity",Q.selectedOpacityFn?Q.selectedOpacityFn(q):q.mo===void 0?H.opacity:q.mo),Q.ms2mrc){var J;q.ms==="various"||H.size==="various"?J=3:J=Q.ms2mrc(q.ms),q.mrc=J,Q.selectedSizeFn&&(J=q.mrc=Q.selectedSizeFn(q));var W=v.symbolNumber(q.mx||H.symbol)||0;q.om=W%200>=100,K.attr("d",w(W,J))}var re=!1,j,Z,ne;if(q.so)ne=ee.outlierwidth,Z=ee.outliercolor,j=H.outliercolor;else{var le=(ee||{}).width;ne=(q.mlw+1||le+1||(q.trace?(q.trace.marker.line||{}).width:0)+1)-1||0,"mlc"in q?Z=q.mlcc=Q.lineScale(q.mlc):k.isArrayOrTypedArray(ee.color)?Z=g.defaultLine:Z=ee.color,k.isArrayOrTypedArray(H.color)&&(j=g.defaultLine,re=!0),"mc"in q?j=q.mcc=Q.markerScale(q.mc):j=H.color||"rgba(0,0,0,0)",Q.selectedColorFn&&(j=Q.selectedColorFn(q))}if(q.om)K.call(g.stroke,j).style({"stroke-width":(ne||1)+"px",fill:"none"});else{K.style("stroke-width",(q.isBlank?0:ne)+"px");var ge=H.gradient,pe=q.mgt;pe?re=!0:pe=ge&&ge.type,k.isArrayOrTypedArray(pe)&&(pe=pe[0],h[pe]||(pe=0));var xe=H.pattern,Ee=xe&&v.getPatternAttr(xe.shape,q.i,"");if(pe&&pe!=="none"){var Te=q.mgc;Te?re=!0:Te=ge.color;var de=G.uid;re&&(de+="-"+q.i),v.gradient(K,V,de,pe,[[0,Te],[1,j]],"fill")}else if(Ee){var be=v.getPatternAttr(xe.bgcolor,q.i,null),Le=v.getPatternAttr(xe.fgcolor,q.i,null),De=xe.fgopacity,ye=v.getPatternAttr(xe.size,q.i,8),ke=v.getPatternAttr(xe.solidity,q.i,.3),Oe=q.mcc||k.isArrayOrTypedArray(xe.shape)||k.isArrayOrTypedArray(xe.bgcolor)||k.isArrayOrTypedArray(xe.size)||k.isArrayOrTypedArray(xe.solidity),Qe=G.uid;Oe&&(Qe+="-"+q.i),v.pattern(K,"point",V,Qe,Ee,ye,ke,q.mcc,xe.fillmode,be,Le,De)}else g.fill(K,j);ne&&g.stroke(K,Z)}},v.makePointStyleFns=function(q){var K={},G=q.marker;return K.markerScale=v.tryColorscale(G,""),K.lineScale=v.tryColorscale(G,"line"),p.traceIs(q,"symbols")&&(K.ms2mrc=m.isBubble(q)?x(q):function(){return(G.size||6)/2}),q.selectedpoints&&k.extendFlat(K,v.makeSelectedPointStyleFns(q)),K},v.makeSelectedPointStyleFns=function(q){var K={},G=q.selected||{},Q=q.unselected||{},V=q.marker||{},H=G.marker||{},ee=Q.marker||{},J=V.opacity,W=H.opacity,re=ee.opacity,j=W!==void 0,Z=re!==void 0;(k.isArrayOrTypedArray(J)||j||Z)&&(K.selectedOpacityFn=function(be){var Le=be.mo===void 0?V.opacity:be.mo;return be.selected?j?W:Le:Z?re:s*Le});var ne=V.color,le=H.color,ge=ee.color;(le||ge)&&(K.selectedColorFn=function(be){var Le=be.mcc||ne;return be.selected?le||Le:ge||Le});var pe=V.size,xe=H.size,Ee=ee.size,Te=xe!==void 0,de=Ee!==void 0;return p.traceIs(q,"symbols")&&(Te||de)&&(K.selectedSizeFn=function(be){var Le=be.mrc||pe/2;return be.selected?Te?xe/2:Le:de?Ee/2:Le}),K},v.makeSelectedTextStyleFns=function(q){var K={},G=q.selected||{},Q=q.unselected||{},V=q.textfont||{},H=G.textfont||{},ee=Q.textfont||{},J=V.color,W=H.color,re=ee.color;return K.selectedTextColorFn=function(j){var Z=j.tc||J;return j.selected?W||Z:re||(W?Z:g.addOpacity(Z,s))},K},v.selectedPointStyle=function(q,K){if(!(!q.size()||!K.selectedpoints)){var G=v.makeSelectedPointStyleFns(K),Q=K.marker||{},V=[];G.selectedOpacityFn&&V.push(function(H,ee){H.style("opacity",G.selectedOpacityFn(ee))}),G.selectedColorFn&&V.push(function(H,ee){g.fill(H,G.selectedColorFn(ee))}),G.selectedSizeFn&&V.push(function(H,ee){var J=ee.mx||Q.symbol||0,W=G.selectedSizeFn(ee);H.attr("d",w(v.symbolNumber(J),W)),ee.mrc2=W}),V.length&&q.each(function(H){for(var ee=b.select(this),J=0;J<V.length;J++)V[J](ee,H)})}},v.tryColorscale=function(q,K){var G=K?k.nestedProperty(q,K).get():q;if(G){var Q=G.color;if((G.colorscale||G._colorAx)&&k.isArrayOrTypedArray(Q))return a.makeColorScaleFuncFromTrace(G)}return k.identity};var o={start:1,end:-1,middle:0,bottom:1,top:-1};function S(q,K,G,Q,V){var H=b.select(q.node().parentNode),ee=K.indexOf("top")!==-1?"top":K.indexOf("bottom")!==-1?"bottom":"middle",J=K.indexOf("left")!==-1?"end":K.indexOf("right")!==-1?"start":"middle",W=Q?Q/.8+1:0,re=(i.lineCount(q)-1)*d+1,j=o[J]*W,Z=G*.75+o[ee]*W+(o[ee]-1)*re*G/2;q.attr("text-anchor",J),V||H.attr("transform",t(j,Z))}function R(q,K){var G=q.ts||K.textfont.size;return E(G)&&G>0?G:0}v.textPointStyle=function(q,K,G){if(!!q.size()){var Q;if(K.selectedpoints){var V=v.makeSelectedTextStyleFns(K);Q=V.selectedTextColorFn}var H=K.texttemplate,ee=G._fullLayout;q.each(function(J){var W=b.select(this),re=H?k.extractOption(J,K,"txt","texttemplate"):k.extractOption(J,K,"tx","text");if(!re&&re!==0){W.remove();return}if(H){var j=K._module.formatLabels,Z=j?j(J,K,ee):{},ne={};M(ne,K,J.i);var le=K._meta||{};re=k.texttemplateString(re,Z,ee._d3locale,ne,J,le)}var ge=J.tp||K.textposition,pe=R(J,K),xe=Q?Q(J):J.tc||K.textfont.color;W.call(v.font,J.tf||K.textfont.family,pe,xe).text(re).call(i.convertToTspans,G).call(S,ge,pe,J.mrc)})}},v.selectedTextStyle=function(q,K){if(!(!q.size()||!K.selectedpoints)){var G=v.makeSelectedTextStyleFns(K);q.each(function(Q){var V=b.select(this),H=G.selectedTextColorFn(Q),ee=Q.tp||K.textposition,J=R(Q,K);g.fill(V,H);var W=p.traceIs(K,"bar-like");S(V,ee,J,Q.mrc2||Q.mrc,W)})}};var z=.5;v.smoothopen=function(q,K){if(q.length<3)return"M"+q.join("L");var G="M"+q[0],Q=[],V;for(V=1;V<q.length-1;V++)Q.push(O(q[V-1],q[V],q[V+1],K));for(G+="Q"+Q[0][0]+" "+q[1],V=2;V<q.length-1;V++)G+="C"+Q[V-2][1]+" "+Q[V-1][0]+" "+q[V];return G+="Q"+Q[q.length-3][1]+" "+q[q.length-1],G},v.smoothclosed=function(q,K){if(q.length<3)return"M"+q.join("L")+"Z";var G="M"+q[0],Q=q.length-1,V=[O(q[Q],q[0],q[1],K)],H;for(H=1;H<Q;H++)V.push(O(q[H-1],q[H],q[H+1],K));for(V.push(O(q[Q-1],q[Q],q[0],K)),H=1;H<=Q;H++)G+="C"+V[H-1][1]+" "+V[H][0]+" "+q[H];return G+="C"+V[Q][1]+" "+V[0][0]+" "+q[0]+"Z",G};function O(q,K,G,Q){var V=q[0]-K[0],H=q[1]-K[1],ee=G[0]-K[0],J=G[1]-K[1],W=Math.pow(V*V+H*H,z/2),re=Math.pow(ee*ee+J*J,z/2),j=(re*re*V-W*W*ee)*Q,Z=(re*re*H-W*W*J)*Q,ne=3*re*(W+re),le=3*W*(W+re);return[[b.round(K[0]+(ne&&j/ne),2),b.round(K[1]+(ne&&Z/ne),2)],[b.round(K[0]-(le&&j/le),2),b.round(K[1]-(le&&Z/le),2)]]}var I={hv:function(q,K){return"H"+b.round(K[0],2)+"V"+b.round(K[1],2)},vh:function(q,K){return"V"+b.round(K[1],2)+"H"+b.round(K[0],2)},hvh:function(q,K){return"H"+b.round((q[0]+K[0])/2,2)+"V"+b.round(K[1],2)+"H"+b.round(K[0],2)},vhv:function(q,K){return"V"+b.round((q[1]+K[1])/2,2)+"H"+b.round(K[0],2)+"V"+b.round(K[1],2)}},F=function(q,K){return"L"+b.round(K[0],2)+","+b.round(K[1],2)};v.steps=function(q){var K=I[q]||F;return function(G){for(var Q="M"+b.round(G[0][0],2)+","+b.round(G[0][1],2),V=1;V<G.length;V++)Q+=K(G[V-1],G[V]);return Q}},v.makeTester=function(){var q=k.ensureSingleById(b.select("body"),"svg","js-plotly-tester",function(G){G.attr(n.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),K=k.ensureSingle(q,"path","js-reference-point",function(G){G.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});v.tester=q,v.testref=K},v.savedBBoxes={};var D=0,B=1e4;v.bBox=function(q,K,G){G||(G=U(q));var Q;if(G){if(Q=v.savedBBoxes[G],Q)return k.extendFlat({},Q)}else if(q.childNodes.length===1){var V=q.childNodes[0];if(G=U(V),G){var H=+V.getAttribute("x")||0,ee=+V.getAttribute("y")||0,J=V.getAttribute("transform");if(!J){var W=v.bBox(V,!1,G);return H&&(W.left+=H,W.right+=H),ee&&(W.top+=ee,W.bottom+=ee),W}if(G+="~"+H+"~"+ee+"~"+J,Q=v.savedBBoxes[G],Q)return k.extendFlat({},Q)}}var re,j;K?re=q:(j=v.tester.node(),re=q.cloneNode(!0),j.appendChild(re)),b.select(re).attr("transform",null).call(i.positionText,0,0);var Z=re.getBoundingClientRect(),ne=v.testref.node().getBoundingClientRect();K||j.removeChild(re);var le={height:Z.height,width:Z.width,left:Z.left-ne.left,top:Z.top-ne.top,right:Z.right-ne.left,bottom:Z.bottom-ne.top};return D>=B&&(v.savedBBoxes={},D=0),G&&(v.savedBBoxes[G]=le),D++,k.extendFlat({},le)};function U(q){var K=q.getAttribute("data-unformatted");if(K!==null)return K+q.getAttribute("data-math")+q.getAttribute("text-anchor")+q.getAttribute("style")}v.setClipUrl=function(q,K,G){q.attr("clip-path",X(K,G))};function X(q,K){if(!q)return null;var G=K._context,Q=G._exportedPlot?"":G._baseUrl||"";return Q?"url('"+Q+"#"+q+"')":"url(#"+q+")"}v.getTranslate=function(q){var K=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,G=q.attr?"attr":"getAttribute",Q=q[G]("transform")||"",V=Q.replace(K,function(H,ee,J){return[ee,J].join(" ")}).split(" ");return{x:+V[0]||0,y:+V[1]||0}},v.setTranslate=function(q,K,G){var Q=/(\btranslate\(.*?\);?)/,V=q.attr?"attr":"getAttribute",H=q.attr?"attr":"setAttribute",ee=q[V]("transform")||"";return K=K||0,G=G||0,ee=ee.replace(Q,"").trim(),ee+=t(K,G),ee=ee.trim(),q[H]("transform",ee),ee},v.getScale=function(q){var K=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,G=q.attr?"attr":"getAttribute",Q=q[G]("transform")||"",V=Q.replace(K,function(H,ee,J){return[ee,J].join(" ")}).split(" ");return{x:+V[0]||1,y:+V[1]||1}},v.setScale=function(q,K,G){var Q=/(\bscale\(.*?\);?)/,V=q.attr?"attr":"getAttribute",H=q.attr?"attr":"setAttribute",ee=q[V]("transform")||"";return K=K||1,G=G||1,ee=ee.replace(Q,"").trim(),ee+="scale("+K+","+G+")",ee=ee.trim(),q[H]("transform",ee),ee};var oe=/\s*sc.*/;v.setPointGroupScale=function(q,K,G){if(K=K||1,G=G||1,!!q){var Q=K===1&&G===1?"":"scale("+K+","+G+")";q.each(function(){var V=(this.getAttribute("transform")||"").replace(oe,"");V+=Q,V=V.trim(),this.setAttribute("transform",V)})}};var se=/translate\([^)]*\)\s*$/;v.setTextPointsScale=function(q,K,G){!q||q.each(function(){var Q,V=b.select(this),H=V.select("text");if(!!H.node()){var ee=parseFloat(H.attr("x")||0),J=parseFloat(H.attr("y")||0),W=(V.attr("transform")||"").match(se);K===1&&G===1?Q=[]:Q=[t(ee,J),"scale("+K+","+G+")",t(-ee,-J)],W&&Q.push(W),V.attr("transform",Q.join(""))}})}},{"../../components/fx/helpers":402,"../../constants/alignment":471,"../../constants/interactions":478,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../lib/svg_text_utils":529,"../../registry":638,"../../traces/scatter/make_bubble_size_func":944,"../../traces/scatter/subtypes":952,"../color":366,"../colorscale":378,"./symbol_defs":389,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:312}],389:[function(c,ae,ie){"use strict";var b=c("@plotly/d3");ae.exports={circle:{n:0,f:function(k){var P=b.round(k,2);return"M"+P+",0A"+P+","+P+" 0 1,1 0,-"+P+"A"+P+","+P+" 0 0,1 "+P+",0Z"}},square:{n:1,f:function(k){var P=b.round(k,2);return"M"+P+","+P+"H-"+P+"V-"+P+"H"+P+"Z"}},diamond:{n:2,f:function(k){var P=b.round(k*1.3,2);return"M"+P+",0L0,"+P+"L-"+P+",0L0,-"+P+"Z"}},cross:{n:3,f:function(k){var P=b.round(k*.4,2),E=b.round(k*1.2,2);return"M"+E+","+P+"H"+P+"V"+E+"H-"+P+"V"+P+"H-"+E+"V-"+P+"H-"+P+"V-"+E+"H"+P+"V-"+P+"H"+E+"Z"}},x:{n:4,f:function(k){var P=b.round(k*.8/Math.sqrt(2),2),E="l"+P+","+P,e="l"+P+",-"+P,p="l-"+P+",-"+P,g="l-"+P+","+P;return"M0,"+P+E+e+p+e+p+g+p+g+E+g+E+"Z"}},"triangle-up":{n:5,f:function(k){var P=b.round(k*2/Math.sqrt(3),2),E=b.round(k/2,2),e=b.round(k,2);return"M-"+P+","+E+"H"+P+"L0,-"+e+"Z"}},"triangle-down":{n:6,f:function(k){var P=b.round(k*2/Math.sqrt(3),2),E=b.round(k/2,2),e=b.round(k,2);return"M-"+P+",-"+E+"H"+P+"L0,"+e+"Z"}},"triangle-left":{n:7,f:function(k){var P=b.round(k*2/Math.sqrt(3),2),E=b.round(k/2,2),e=b.round(k,2);return"M"+E+",-"+P+"V"+P+"L-"+e+",0Z"}},"triangle-right":{n:8,f:function(k){var P=b.round(k*2/Math.sqrt(3),2),E=b.round(k/2,2),e=b.round(k,2);return"M-"+E+",-"+P+"V"+P+"L"+e+",0Z"}},"triangle-ne":{n:9,f:function(k){var P=b.round(k*.6,2),E=b.round(k*1.2,2);return"M-"+E+",-"+P+"H"+P+"V"+E+"Z"}},"triangle-se":{n:10,f:function(k){var P=b.round(k*.6,2),E=b.round(k*1.2,2);return"M"+P+",-"+E+"V"+P+"H-"+E+"Z"}},"triangle-sw":{n:11,f:function(k){var P=b.round(k*.6,2),E=b.round(k*1.2,2);return"M"+E+","+P+"H-"+P+"V-"+E+"Z"}},"triangle-nw":{n:12,f:function(k){var P=b.round(k*.6,2),E=b.round(k*1.2,2);return"M-"+P+","+E+"V-"+P+"H"+E+"Z"}},pentagon:{n:13,f:function(k){var P=b.round(k*.951,2),E=b.round(k*.588,2),e=b.round(-k,2),p=b.round(k*-.309,2),g=b.round(k*.809,2);return"M"+P+","+p+"L"+E+","+g+"H-"+E+"L-"+P+","+p+"L0,"+e+"Z"}},hexagon:{n:14,f:function(k){var P=b.round(k,2),E=b.round(k/2,2),e=b.round(k*Math.sqrt(3)/2,2);return"M"+e+",-"+E+"V"+E+"L0,"+P+"L-"+e+","+E+"V-"+E+"L0,-"+P+"Z"}},hexagon2:{n:15,f:function(k){var P=b.round(k,2),E=b.round(k/2,2),e=b.round(k*Math.sqrt(3)/2,2);return"M-"+E+","+e+"H"+E+"L"+P+",0L"+E+",-"+e+"H-"+E+"L-"+P+",0Z"}},octagon:{n:16,f:function(k){var P=b.round(k*.924,2),E=b.round(k*.383,2);return"M-"+E+",-"+P+"H"+E+"L"+P+",-"+E+"V"+E+"L"+E+","+P+"H-"+E+"L-"+P+","+E+"V-"+E+"Z"}},star:{n:17,f:function(k){var P=k*1.4,E=b.round(P*.225,2),e=b.round(P*.951,2),p=b.round(P*.363,2),g=b.round(P*.588,2),a=b.round(-P,2),t=b.round(P*-.309,2),i=b.round(P*.118,2),n=b.round(P*.809,2),r=b.round(P*.382,2);return"M"+E+","+t+"H"+e+"L"+p+","+i+"L"+g+","+n+"L0,"+r+"L-"+g+","+n+"L-"+p+","+i+"L-"+e+","+t+"H-"+E+"L0,"+a+"Z"}},hexagram:{n:18,f:function(k){var P=b.round(k*.66,2),E=b.round(k*.38,2),e=b.round(k*.76,2);return"M-"+e+",0l-"+E+",-"+P+"h"+e+"l"+E+",-"+P+"l"+E+","+P+"h"+e+"l-"+E+","+P+"l"+E+","+P+"h-"+e+"l-"+E+","+P+"l-"+E+",-"+P+"h-"+e+"Z"}},"star-triangle-up":{n:19,f:function(k){var P=b.round(k*Math.sqrt(3)*.8,2),E=b.round(k*.8,2),e=b.round(k*1.6,2),p=b.round(k*4,2),g="A "+p+","+p+" 0 0 1 ";return"M-"+P+","+E+g+P+","+E+g+"0,-"+e+g+"-"+P+","+E+"Z"}},"star-triangle-down":{n:20,f:function(k){var P=b.round(k*Math.sqrt(3)*.8,2),E=b.round(k*.8,2),e=b.round(k*1.6,2),p=b.round(k*4,2),g="A "+p+","+p+" 0 0 1 ";return"M"+P+",-"+E+g+"-"+P+",-"+E+g+"0,"+e+g+P+",-"+E+"Z"}},"star-square":{n:21,f:function(k){var P=b.round(k*1.1,2),E=b.round(k*2,2),e="A "+E+","+E+" 0 0 1 ";return"M-"+P+",-"+P+e+"-"+P+","+P+e+P+","+P+e+P+",-"+P+e+"-"+P+",-"+P+"Z"}},"star-diamond":{n:22,f:function(k){var P=b.round(k*1.4,2),E=b.round(k*1.9,2),e="A "+E+","+E+" 0 0 1 ";return"M-"+P+",0"+e+"0,"+P+e+P+",0"+e+"0,-"+P+e+"-"+P+",0Z"}},"diamond-tall":{n:23,f:function(k){var P=b.round(k*.7,2),E=b.round(k*1.4,2);return"M0,"+E+"L"+P+",0L0,-"+E+"L-"+P+",0Z"}},"diamond-wide":{n:24,f:function(k){var P=b.round(k*1.4,2),E=b.round(k*.7,2);return"M0,"+E+"L"+P+",0L0,-"+E+"L-"+P+",0Z"}},hourglass:{n:25,f:function(k){var P=b.round(k,2);return"M"+P+","+P+"H-"+P+"L"+P+",-"+P+"H-"+P+"Z"},noDot:!0},bowtie:{n:26,f:function(k){var P=b.round(k,2);return"M"+P+","+P+"V-"+P+"L-"+P+","+P+"V-"+P+"Z"},noDot:!0},"circle-cross":{n:27,f:function(k){var P=b.round(k,2);return"M0,"+P+"V-"+P+"M"+P+",0H-"+P+"M"+P+",0A"+P+","+P+" 0 1,1 0,-"+P+"A"+P+","+P+" 0 0,1 "+P+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(k){var P=b.round(k,2),E=b.round(k/Math.sqrt(2),2);return"M"+E+","+E+"L-"+E+",-"+E+"M"+E+",-"+E+"L-"+E+","+E+"M"+P+",0A"+P+","+P+" 0 1,1 0,-"+P+"A"+P+","+P+" 0 0,1 "+P+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(k){var P=b.round(k,2);return"M0,"+P+"V-"+P+"M"+P+",0H-"+P+"M"+P+","+P+"H-"+P+"V-"+P+"H"+P+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(k){var P=b.round(k,2);return"M"+P+","+P+"L-"+P+",-"+P+"M"+P+",-"+P+"L-"+P+","+P+"M"+P+","+P+"H-"+P+"V-"+P+"H"+P+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(k){var P=b.round(k*1.3,2);return"M"+P+",0L0,"+P+"L-"+P+",0L0,-"+P+"ZM0,-"+P+"V"+P+"M-"+P+",0H"+P},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(k){var P=b.round(k*1.3,2),E=b.round(k*.65,2);return"M"+P+",0L0,"+P+"L-"+P+",0L0,-"+P+"ZM-"+E+",-"+E+"L"+E+","+E+"M-"+E+","+E+"L"+E+",-"+E},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(k){var P=b.round(k*1.4,2);return"M0,"+P+"V-"+P+"M"+P+",0H-"+P},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(k){var P=b.round(k,2);return"M"+P+","+P+"L-"+P+",-"+P+"M"+P+",-"+P+"L-"+P+","+P},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(k){var P=b.round(k*1.2,2),E=b.round(k*.85,2);return"M0,"+P+"V-"+P+"M"+P+",0H-"+P+"M"+E+","+E+"L-"+E+",-"+E+"M"+E+",-"+E+"L-"+E+","+E},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(k){var P=b.round(k/2,2),E=b.round(k,2);return"M"+P+","+E+"V-"+E+"m-"+E+",0V"+E+"M"+E+","+P+"H-"+E+"m0,-"+E+"H"+E},needLine:!0,noFill:!0},"y-up":{n:37,f:function(k){var P=b.round(k*1.2,2),E=b.round(k*1.6,2),e=b.round(k*.8,2);return"M-"+P+","+e+"L0,0M"+P+","+e+"L0,0M0,-"+E+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(k){var P=b.round(k*1.2,2),E=b.round(k*1.6,2),e=b.round(k*.8,2);return"M-"+P+",-"+e+"L0,0M"+P+",-"+e+"L0,0M0,"+E+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(k){var P=b.round(k*1.2,2),E=b.round(k*1.6,2),e=b.round(k*.8,2);return"M"+e+","+P+"L0,0M"+e+",-"+P+"L0,0M-"+E+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(k){var P=b.round(k*1.2,2),E=b.round(k*1.6,2),e=b.round(k*.8,2);return"M-"+e+","+P+"L0,0M-"+e+",-"+P+"L0,0M"+E+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(k){var P=b.round(k*1.4,2);return"M"+P+",0H-"+P},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(k){var P=b.round(k*1.4,2);return"M0,"+P+"V-"+P},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(k){var P=b.round(k,2);return"M"+P+",-"+P+"L-"+P+","+P},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(k){var P=b.round(k,2);return"M"+P+","+P+"L-"+P+",-"+P},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(k){var P=b.round(k,2),E=b.round(k*2,2);return"M0,0L-"+P+","+E+"H"+P+"Z"},noDot:!0},"arrow-down":{n:46,f:function(k){var P=b.round(k,2),E=b.round(k*2,2);return"M0,0L-"+P+",-"+E+"H"+P+"Z"},noDot:!0},"arrow-left":{n:47,f:function(k){var P=b.round(k*2,2),E=b.round(k,2);return"M0,0L"+P+",-"+E+"V"+E+"Z"},noDot:!0},"arrow-right":{n:48,f:function(k){var P=b.round(k*2,2),E=b.round(k,2);return"M0,0L-"+P+",-"+E+"V"+E+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(k){var P=b.round(k,2),E=b.round(k*2,2);return"M-"+P+",0H"+P+"M0,0L-"+P+","+E+"H"+P+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(k){var P=b.round(k,2),E=b.round(k*2,2);return"M-"+P+",0H"+P+"M0,0L-"+P+",-"+E+"H"+P+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(k){var P=b.round(k*2,2),E=b.round(k,2);return"M0,-"+E+"V"+E+"M0,0L"+P+",-"+E+"V"+E+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(k){var P=b.round(k*2,2),E=b.round(k,2);return"M0,-"+E+"V"+E+"M0,0L-"+P+",-"+E+"V"+E+"Z"},needLine:!0,noDot:!0}}},{"@plotly/d3":58}],390:[function(c,ae,ie){"use strict";ae.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],391:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../registry"),P=c("../../plots/cartesian/axes"),E=c("../../lib"),e=c("./compute_error");ae.exports=function(a){for(var t=a.calcdata,i=0;i<t.length;i++){var n=t[i],r=n[0].trace;if(r.visible===!0&&k.traceIs(r,"errorBarsOK")){var d=P.getFromId(a,r.xaxis),s=P.getFromId(a,r.yaxis);p(n,r,d,"x"),p(n,r,s,"y")}}};function p(g,a,t,i){var n=a["error_"+i]||{},r=n.visible&&["linear","log"].indexOf(t.type)!==-1,d=[];if(!!r){for(var s=e(n),m=0;m<g.length;m++){var x=g[m],M=x.i;if(M===void 0)M=m;else if(M===null)continue;var v=x[i];if(!!b(t.c2l(v))){var _=s(v,M);if(b(_[0])&&b(_[1])){var l=x[i+"s"]=v-_[0],y=x[i+"h"]=v+_[1];d.push(l,y)}}}var T=t._id,w=a._extremes[T],A=P.findExtremes(t,d,E.extendFlat({tozero:w.opts.tozero},{padded:!0}));w.min=w.min.concat(A.min),w.max=w.max.concat(A.max)}}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"./compute_error":392,"fast-isnumeric":190}],392:[function(c,ae,ie){"use strict";ae.exports=function(P){var E=P.type,e=P.symmetric;if(E==="data"){var p=P.array||[];if(e)return function(n,r){var d=+p[r];return[d,d]};var g=P.arrayminus||[];return function(n,r){var d=+p[r],s=+g[r];return!isNaN(d)||!isNaN(s)?[s||0,d||0]:[NaN,NaN]}}else{var a=b(E,P.value),t=b(E,P.valueminus);return e||P.valueminus===void 0?function(n){var r=a(n);return[r,r]}:function(n){return[t(n),a(n)]}}};function b(k,P){if(k==="percent")return function(E){return Math.abs(E*P/100)};if(k==="constant")return function(){return Math.abs(P)};if(k==="sqrt")return function(E){return Math.sqrt(Math.abs(E))}}},{}],393:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../registry"),P=c("../../lib"),E=c("../../plot_api/plot_template"),e=c("./attributes");ae.exports=function(p,g,a,t){var i="error_"+t.axis,n=E.newContainer(g,i),r=p[i]||{};function d(l,y){return P.coerce(r,n,e,l,y)}var s=r.array!==void 0||r.value!==void 0||r.type==="sqrt",m=d("visible",s);if(m!==!1){var x=d("type","array"in r?"data":"percent"),M=!0;x!=="sqrt"&&(M=d("symmetric",!((x==="data"?"arrayminus":"valueminus")in r))),x==="data"?(d("array"),d("traceref"),M||(d("arrayminus"),d("tracerefminus"))):(x==="percent"||x==="constant")&&(d("value"),M||d("valueminus"));var v="copy_"+t.inherit+"style";if(t.inherit){var _=g["error_"+t.inherit];(_||{}).visible&&d(v,!(r.color||b(r.thickness)||b(r.width)))}(!t.inherit||!n[v])&&(d("color",a),d("thickness"),d("width",k.traceIs(g,"gl3d")?0:4))}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../registry":638,"./attributes":390,"fast-isnumeric":190}],394:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plot_api/edit_types").overrideAll,P=c("./attributes"),E={error_x:b.extendFlat({},P),error_y:b.extendFlat({},P)};delete E.error_x.copy_zstyle,delete E.error_y.copy_zstyle,delete E.error_y.copy_ystyle;var e={error_x:b.extendFlat({},P),error_y:b.extendFlat({},P),error_z:b.extendFlat({},P)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,ae.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:E,bar:E,histogram:E,scatter3d:k(e,"calc","nested"),scattergl:k(E,"calc","nested")}},supplyDefaults:c("./defaults"),calc:c("./calc"),makeComputeError:c("./compute_error"),plot:c("./plot"),style:c("./style"),hoverInfo:p};function p(g,a,t){(a.error_y||{}).visible&&(t.yerr=g.yh-g.y,a.error_y.symmetric||(t.yerrneg=g.y-g.ys)),(a.error_x||{}).visible&&(t.xerr=g.xh-g.x,a.error_x.symmetric||(t.xerrneg=g.x-g.xs))}},{"../../lib":503,"../../plot_api/edit_types":536,"./attributes":390,"./calc":391,"./compute_error":392,"./defaults":393,"./plot":395,"./style":396}],395:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=c("../drawing"),E=c("../../traces/scatter/subtypes");ae.exports=function(g,a,t,i){var n,r=t.xaxis,d=t.yaxis,s=i&&i.duration>0;a.each(function(m){var x=m[0].trace,M=x.error_x||{},v=x.error_y||{},_;x.ids&&(_=function(w){return w.id});var l=E.hasMarkers(x)&&x.marker.maxdisplayed>0;!v.visible&&!M.visible&&(m=[]);var y=b.select(this).selectAll("g.errorbar").data(m,_);if(y.exit().remove(),!!m.length){M.visible||y.selectAll("path.xerror").remove(),v.visible||y.selectAll("path.yerror").remove(),y.style("opacity",1);var T=y.enter().append("g").classed("errorbar",!0);s&&T.style("opacity",0).transition().duration(i.duration).style("opacity",1),P.setClipUrl(y,t.layerClipId,g),y.each(function(w){var A=b.select(this),f=e(w,r,d);if(!(l&&!w.vis)){var u,h=A.select("path.yerror");if(v.visible&&k(f.x)&&k(f.yh)&&k(f.ys)){var o=v.width;u="M"+(f.x-o)+","+f.yh+"h"+2*o+"m-"+o+",0V"+f.ys,f.noYS||(u+="m-"+o+",0h"+2*o),n=!h.size(),n?h=A.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0):s&&(h=h.transition().duration(i.duration).ease(i.easing)),h.attr("d",u)}else h.remove();var S=A.select("path.xerror");if(M.visible&&k(f.y)&&k(f.xh)&&k(f.xs)){var R=(M.copy_ystyle?v:M).width;u="M"+f.xh+","+(f.y-R)+"v"+2*R+"m0,-"+R+"H"+f.xs,f.noXS||(u+="m0,-"+R+"v"+2*R),n=!S.size(),n?S=A.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0):s&&(S=S.transition().duration(i.duration).ease(i.easing)),S.attr("d",u)}else S.remove()}})}})};function e(p,g,a){var t={x:g.c2p(p.x),y:a.c2p(p.y)};return p.yh!==void 0&&(t.yh=a.c2p(p.yh),t.ys=a.c2p(p.ys),k(t.ys)||(t.noYS=!0,t.ys=a.c2p(p.ys,!0))),p.xh!==void 0&&(t.xh=g.c2p(p.xh),t.xs=g.c2p(p.xs),k(t.xs)||(t.noXS=!0,t.xs=g.c2p(p.xs,!0))),t}},{"../../traces/scatter/subtypes":952,"../drawing":388,"@plotly/d3":58,"fast-isnumeric":190}],396:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../color");ae.exports=function(E){E.each(function(e){var p=e[0].trace,g=p.error_y||{},a=p.error_x||{},t=b.select(this);t.selectAll("path.yerror").style("stroke-width",g.thickness+"px").call(k.stroke,g.color),a.copy_ystyle&&(a=g),t.selectAll("path.xerror").style("stroke-width",a.thickness+"px").call(k.stroke,a.color)})}},{"../color":366,"@plotly/d3":58}],397:[function(c,ae,ie){"use strict";var b=c("../../plots/font_attributes"),k=c("./layout_attributes").hoverlabel,P=c("../../lib/extend").extendFlat;ae.exports={hoverlabel:{bgcolor:P({},k.bgcolor,{arrayOk:!0}),bordercolor:P({},k.bordercolor,{arrayOk:!0}),font:b({arrayOk:!0,editType:"none"}),align:P({},k.align,{arrayOk:!0}),namelength:P({},k.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":493,"../../plots/font_attributes":585,"./layout_attributes":407}],398:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../registry");ae.exports=function(e){var p=e.calcdata,g=e._fullLayout;function a(d){return function(s){return b.coerceHoverinfo({hoverinfo:s},{_module:d._module},g)}}for(var t=0;t<p.length;t++){var i=p[t],n=i[0].trace;if(!k.traceIs(n,"pie-like")){var r=k.traceIs(n,"2dMap")?P:b.fillArray;r(n.hoverinfo,i,"hi",a(n)),n.hovertemplate&&r(n.hovertemplate,i,"ht"),n.hoverlabel&&(r(n.hoverlabel.bgcolor,i,"hbg"),r(n.hoverlabel.bordercolor,i,"hbc"),r(n.hoverlabel.font.size,i,"hts"),r(n.hoverlabel.font.color,i,"htc"),r(n.hoverlabel.font.family,i,"htf"),r(n.hoverlabel.namelength,i,"hnl"),r(n.hoverlabel.align,i,"hta"))}}};function P(E,e,p,g){g=g||b.identity,Array.isArray(E)&&(e[0][p]=g(E))}},{"../../lib":503,"../../registry":638}],399:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("./hover").hover;ae.exports=function(E,e,p){var g=b.getComponentMethod("annotations","onClick")(E,E._hoverdata);p!==void 0&&k(E,e,p,!0);function a(){E.emit("plotly_click",{points:E._hoverdata,event:e})}E._hoverdata&&e&&e.target&&(g&&g.then?g.then(a):a(),e.stopImmediatePropagation&&e.stopImmediatePropagation())}},{"../../registry":638,"./hover":403}],400:[function(c,ae,ie){"use strict";ae.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],401:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("./hoverlabel_defaults");ae.exports=function(e,p,g,a){function t(n,r){return b.coerce(e,p,k,n,r)}var i=b.extendFlat({},a.hoverlabel);p.hovertemplate&&(i.namelength=-1),P(e,p,t,i)}},{"../../lib":503,"./attributes":397,"./hoverlabel_defaults":404}],402:[function(c,ae,ie){"use strict";var b=c("../../lib");ie.getSubplot=function(g){return g.subplot||g.xaxis+g.yaxis||g.geo},ie.isTraceInSubplots=function(g,a){if(g.type==="splom"){for(var t=g.xaxes||[],i=g.yaxes||[],n=0;n<t.length;n++)for(var r=0;r<i.length;r++)if(a.indexOf(t[n]+i[r])!==-1)return!0;return!1}return a.indexOf(ie.getSubplot(g))!==-1},ie.flat=function(g,a){for(var t=new Array(g.length),i=0;i<g.length;i++)t[i]=a;return t},ie.p2c=function(g,a){for(var t=new Array(g.length),i=0;i<g.length;i++)t[i]=g[i].p2c(a);return t},ie.getDistanceFunction=function(g,a,t,i){return g==="closest"?i||ie.quadrature(a,t):g.charAt(0)==="x"?a:t},ie.getClosest=function(g,a,t){if(t.index!==!1)t.index>=0&&t.index<g.length?t.distance=0:t.index=!1;else for(var i=0;i<g.length;i++){var n=a(g[i]);n<=t.distance&&(t.index=i,t.distance=n)}return t},ie.inbox=function(g,a,t){return g*a<0||g===0?t:1/0},ie.quadrature=function(g,a){return function(t){var i=g(t),n=a(t);return Math.sqrt(i*i+n*n)}},ie.makeEventData=function(g,a,t){var i="index"in g?g.index:g.pointNumber,n={data:a._input,fullData:a,curveNumber:a.index,pointNumber:i};if(a._indexToPoints){var r=a._indexToPoints[i];r.length===1?n.pointIndex=r[0]:n.pointIndices=r}else n.pointIndex=i;return a._module.eventData?n=a._module.eventData(n,g,a,t,i):("xVal"in g?n.x=g.xVal:"x"in g&&(n.x=g.x),"yVal"in g?n.y=g.yVal:"y"in g&&(n.y=g.y),g.xa&&(n.xaxis=g.xa),g.ya&&(n.yaxis=g.ya),g.zLabelVal!==void 0&&(n.z=g.zLabelVal)),ie.appendArrayPointValue(n,a,i),n},ie.appendArrayPointValue=function(g,a,t){var i=a._arrayAttrs;if(!!i)for(var n=0;n<i.length;n++){var r=i[n],d=P(r);if(g[d]===void 0){var s=b.nestedProperty(a,r).get(),m=E(s,t);m!==void 0&&(g[d]=m)}}},ie.appendArrayMultiPointValues=function(g,a,t){var i=a._arrayAttrs;if(!!i)for(var n=0;n<i.length;n++){var r=i[n],d=P(r);if(g[d]===void 0){for(var s=b.nestedProperty(a,r).get(),m=new Array(t.length),x=0;x<t.length;x++)m[x]=E(s,t[x]);g[d]=m}}};var k={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function P(g){return k[g]||g}function E(g,a){if(Array.isArray(a)){if(Array.isArray(g)&&Array.isArray(g[a[0]]))return g[a[0]][a[1]]}else return g[a]}var e={x:!0,y:!0},p={"x unified":!0,"y unified":!0};ie.isUnifiedHover=function(g){return typeof g!="string"?!1:!!p[g]},ie.isXYhover=function(g){return typeof g!="string"?!1:!!e[g]}},{"../../lib":503}],403:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=c("tinycolor2"),E=c("../../lib"),e=E.strTranslate,p=E.strRotate,g=c("../../lib/events"),a=c("../../lib/svg_text_utils"),t=c("../../lib/override_cursor"),i=c("../drawing"),n=c("../color"),r=c("../dragelement"),d=c("../../plots/cartesian/axes"),s=c("../../registry"),m=c("./helpers"),x=c("./constants"),M=c("../legend/defaults"),v=c("../legend/draw"),_=x.YANGLE,l=Math.PI*_/180,y=1/Math.sin(l),T=Math.cos(l),w=Math.sin(l),A=x.HOVERARROWSIZE,f=x.HOVERTEXTPAD,u={box:!0,ohlc:!0,violin:!0,candlestick:!0},h={scatter:!0,scattergl:!0,splom:!0};ie.hover=function(H,ee,J,W){H=E.getGraphDiv(H);var re=ee.target;E.throttle(H._fullLayout._uid+x.HOVERID,x.HOVERMINTIME,function(){o(H,ee,J,W,re)})},ie.loneHover=function(H,ee){var J=!0;Array.isArray(H)||(J=!1,H=[H]);var W=ee.gd,re=K(W),j=G(W),Z=H.map(function(de){var be=de._x0||de.x0||de.x||0,Le=de._x1||de.x1||de.x||0,De=de._y0||de.y0||de.y||0,ye=de._y1||de.y1||de.y||0,ke=de.eventData;if(ke){var Oe=Math.min(be,Le),Qe=Math.max(be,Le),Ve=Math.min(De,ye),Ue=Math.max(De,ye),Ie=de.trace;if(s.traceIs(Ie,"gl3d")){var at=W._fullLayout[Ie.scene]._scene.container,pt=at.offsetLeft,Rt=at.offsetTop;Oe+=pt,Qe+=pt,Ve+=Rt,Ue+=Rt}ke.bbox={x0:Oe+j,x1:Qe+j,y0:Ve+re,y1:Ue+re},ee.inOut_bbox&&ee.inOut_bbox.push(ke.bbox)}else ke=!1;return{color:de.color||n.defaultLine,x0:de.x0||de.x||0,x1:de.x1||de.x||0,y0:de.y0||de.y||0,y1:de.y1||de.y||0,xLabel:de.xLabel,yLabel:de.yLabel,zLabel:de.zLabel,text:de.text,name:de.name,idealAlign:de.idealAlign,borderColor:de.borderColor,fontFamily:de.fontFamily,fontSize:de.fontSize,fontColor:de.fontColor,nameLength:de.nameLength,textAlign:de.textAlign,trace:de.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:de.hovertemplate||!1,hovertemplateLabels:de.hovertemplateLabels||!1,eventData:ke}}),ne=!1,le=z(Z,{gd:W,hovermode:"closest",rotateLabels:ne,bgColor:ee.bgColor||n.background,container:b.select(ee.container),outerContainer:ee.outerContainer||ee.container}),ge=5,pe=0,xe=0;le.sort(function(de,be){return de.y0-be.y0}).each(function(de,be){var Le=de.y0-de.by/2;Le-ge<pe?de.offset=pe-Le+ge:de.offset=0,pe=Le+de.by+de.offset,be===ee.anchorIndex&&(xe=de.offset)}).each(function(de){de.offset-=xe});var Ee=W._fullLayout._invScaleX,Te=W._fullLayout._invScaleY;return F(le,ne,Ee,Te),J?le:le.node()};function o(V,H,ee,J,W){ee||(ee="xy");var re=Array.isArray(ee)?ee:[ee],j=V._fullLayout,Z=j._plots||[],ne=Z[ee],le=j._has("cartesian");if(ne){var ge=ne.overlays.map(function(tr){return tr.id});re=re.concat(ge)}for(var pe=re.length,xe=new Array(pe),Ee=new Array(pe),Te=!1,de=0;de<pe;de++){var be=re[de];if(Z[be])Te=!0,xe[de]=Z[be].xaxis,Ee[de]=Z[be].yaxis;else if(j[be]&&j[be]._subplot){var Le=j[be]._subplot;xe[de]=Le.xaxis,Ee[de]=Le.yaxis}else{E.warn("Unrecognized subplot: "+be);return}}var De=H.hovermode||j.hovermode;if(De&&!Te&&(De="closest"),["x","y","closest","x unified","y unified"].indexOf(De)===-1||!V.calcdata||V.querySelector(".zoombox")||V._dragging)return r.unhoverRaw(V,H);var ye=j.hoverdistance;ye===-1&&(ye=1/0);var ke=j.spikedistance;ke===-1&&(ke=1/0);var Oe=[],Qe=[],Ve,Ue,Ie,at,pt,Rt,Mt,It,Bt,St,_t,it,ct,et={hLinePoint:null,vLinePoint:null},Pe=!1;if(Array.isArray(H))for(De="array",Ie=0;Ie<H.length;Ie++)pt=V.calcdata[H[Ie].curveNumber||0],pt&&(Rt=pt[0].trace,pt[0].trace.hoverinfo!=="skip"&&(Qe.push(pt),Rt.orientation==="h"&&(Pe=!0)));else{for(at=0;at<V.calcdata.length;at++)pt=V.calcdata[at],Rt=pt[0].trace,Rt.hoverinfo!=="skip"&&m.isTraceInSubplots(Rt,re)&&(Qe.push(pt),Rt.orientation==="h"&&(Pe=!0));var We=!W,je,nt;if(We)"xpx"in H?je=H.xpx:je=xe[0]._length/2,"ypx"in H?nt=H.ypx:nt=Ee[0]._length/2;else{if(g.triggerHandler(V,"plotly_beforehover",H)===!1)return;var kt=W.getBoundingClientRect();je=H.clientX-kt.left,nt=H.clientY-kt.top,j._calcInverseTransform(V);var wt=E.apply3DTransform(j._invTransform)(je,nt);if(je=wt[0],nt=wt[1],je<0||je>xe[0]._length||nt<0||nt>Ee[0]._length)return r.unhoverRaw(V,H)}if(H.pointerX=je+xe[0]._offset,H.pointerY=nt+Ee[0]._offset,"xval"in H?Ve=m.flat(re,H.xval):Ve=m.p2c(xe,je),"yval"in H?Ue=m.flat(re,H.yval):Ue=m.p2c(Ee,nt),!k(Ve[0])||!k(Ue[0]))return E.warn("Fx.hover failed",H,V),r.unhoverRaw(V,H)}var Vt=1/0;function qt(tr,Lr){for(at=0;at<Qe.length;at++)if(pt=Qe[at],!(!pt||!pt[0]||!pt[0].trace)&&(Rt=pt[0].trace,!(Rt.visible!==!0||Rt._length===0)&&["carpet","contourcarpet"].indexOf(Rt._module.name)===-1)){if(Rt.type==="splom"?(It=0,Mt=re[It]):(Mt=m.getSubplot(Rt),It=re.indexOf(Mt)),Bt=De,m.isUnifiedHover(Bt)&&(Bt=Bt.charAt(0)),it={cd:pt,trace:Rt,xa:xe[It],ya:Ee[It],maxHoverDistance:ye,maxSpikeDistance:ke,index:!1,distance:Math.min(Vt,ye),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:n.defaultLine,name:Rt.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},j[Mt]&&(it.subplot=j[Mt]._subplot),j._splomScenes&&j._splomScenes[Rt.uid]&&(it.scene=j._splomScenes[Rt.uid]),ct=Oe.length,Bt==="array"){var Nr=H[at];"pointNumber"in Nr?(it.index=Nr.pointNumber,Bt="closest"):(Bt="","xval"in Nr&&(St=Nr.xval,Bt="x"),"yval"in Nr&&(_t=Nr.yval,Bt=Bt?"closest":"y"))}else tr!==void 0&&Lr!==void 0?(St=tr,_t=Lr):(St=Ve[It],_t=Ue[It]);if(ye!==0)if(Rt._module&&Rt._module.hoverPoints){var Rr=Rt._module.hoverPoints(it,St,_t,Bt,{finiteRange:!0,hoverLayer:j._hoverlayer});if(Rr)for(var Ar,Kr=0;Kr<Rr.length;Kr++)Ar=Rr[Kr],k(Ar.x0)&&k(Ar.y0)&&Oe.push(D(Ar,De))}else E.log("Unrecognized trace type in hover:",Rt);if(De==="closest"&&Oe.length>ct&&(Oe.splice(0,ct),Vt=Oe[0].distance),le&&ke!==0&&Oe.length===0){it.distance=ke,it.index=!1;var Dn=Rt._module.hoverPoints(it,St,_t,"closest",{hoverLayer:j._hoverlayer});if(Dn&&(Dn=Dn.filter(function(ka){return ka.spikeDistance<=ke})),Dn&&Dn.length){var Sn,Jn=Dn.filter(function(ka){return ka.xa.showspikes&&ka.xa.spikesnap!=="hovered data"});if(Jn.length){var Bn=Jn[0];k(Bn.x0)&&k(Bn.y0)&&(Sn=Ht(Bn),(!et.vLinePoint||et.vLinePoint.spikeDistance>Sn.spikeDistance)&&(et.vLinePoint=Sn))}var Xn=Dn.filter(function(ka){return ka.ya.showspikes&&ka.ya.spikesnap!=="hovered data"});if(Xn.length){var ea=Xn[0];k(ea.x0)&&k(ea.y0)&&(Sn=Ht(ea),(!et.hLinePoint||et.hLinePoint.spikeDistance>Sn.spikeDistance)&&(et.hLinePoint=Sn))}}}}}qt();function zt(tr,Lr,Nr){for(var Rr=null,Ar=1/0,Kr,Dn=0;Dn<tr.length;Dn++)Kr=tr[Dn].spikeDistance,Nr&&Dn===0&&(Kr=-1/0),Kr<=Ar&&Kr<=Lr&&(Rr=tr[Dn],Ar=Kr);return Rr}function Ht(tr){return tr?{xa:tr.xa,ya:tr.ya,x:tr.xSpike!==void 0?tr.xSpike:(tr.x0+tr.x1)/2,y:tr.ySpike!==void 0?tr.ySpike:(tr.y0+tr.y1)/2,distance:tr.distance,spikeDistance:tr.spikeDistance,curveNumber:tr.trace.index,color:tr.color,pointNumber:tr.index}:null}var $t={fullLayout:j,container:j._hoverlayer,event:H},Qt=V._spikepoints,fr={vLinePoint:et.vLinePoint,hLinePoint:et.hLinePoint};V._spikepoints=fr;var jr=function(){Oe.sort(function(tr,Lr){return tr.distance-Lr.distance}),Oe=se(Oe,De)};jr();var cn=De.charAt(0),Qr=(cn==="x"||cn==="y")&&Oe[0]&&h[Oe[0].trace.type];if(le&&ke!==0&&Oe.length!==0){var lt=Oe.filter(function(tr){return tr.ya.showspikes}),Gt=zt(lt,ke,Qr);et.hLinePoint=Ht(Gt);var Kt=Oe.filter(function(tr){return tr.xa.showspikes}),Nt=zt(Kt,ke,Qr);et.vLinePoint=Ht(Nt)}if(Oe.length===0){var gr=r.unhoverRaw(V,H);return le&&(et.hLinePoint!==null||et.vLinePoint!==null)&&X(Qt)&&B(V,et,$t),gr}if(le&&X(Qt)&&B(V,et,$t),m.isXYhover(Bt)&&Oe[0].length!==0&&Oe[0].trace.type!=="splom"){var tt=Oe[0];u[tt.trace.type]?Oe=Oe.filter(function(tr){return tr.trace.index===tt.trace.index}):Oe=[tt];var we=Oe.length,Me=q("x",tt,j),Ne=q("y",tt,j);qt(Me,Ne);var Xe=[],Ke={},rt=0,Je=function(tr){var Lr=u[tr.trace.type]?S(tr):tr.trace.index;if(!Ke[Lr])rt++,Ke[Lr]=rt,Xe.push(tr);else{var Nr=Ke[Lr]-1,Rr=Xe[Nr];Nr>0&&Math.abs(tr.distance)<Math.abs(Rr.distance)&&(Xe[Nr]=tr)}},vt;for(vt=0;vt<we;vt++)Je(Oe[vt]);for(vt=Oe.length-1;vt>we-1;vt--)Je(Oe[vt]);Oe=Xe,jr()}var bt=V._hoverdata,Et=[],Wt=K(V),Ot=G(V);for(Ie=0;Ie<Oe.length;Ie++){var ir=Oe[Ie],vr=m.makeEventData(ir,ir.trace,ir.cd);if(ir.hovertemplate!==!1){var _r=!1;ir.cd[ir.index]&&ir.cd[ir.index].ht&&(_r=ir.cd[ir.index].ht),ir.hovertemplate=_r||ir.trace.hovertemplate||!1}if(ir.xa&&ir.ya){var ln=ir.x0+ir.xa._offset,Cr=ir.x1+ir.xa._offset,Gr=ir.y0+ir.ya._offset,sn=ir.y1+ir.ya._offset,yr=Math.min(ln,Cr),mr=Math.max(ln,Cr),Or=Math.min(Gr,sn),zr=Math.max(Gr,sn);vr.bbox={x0:yr+Ot,x1:mr+Ot,y0:Or+Wt,y1:zr+Wt}}ir.eventData=[vr],Et.push(vr)}V._hoverdata=Et;var Sr=De==="y"&&(Qe.length>1||Oe.length>1)||De==="closest"&&Pe&&Oe.length>1,ot=n.combine(j.plot_bgcolor||n.background,j.paper_bgcolor),Lt=z(Oe,{gd:V,hovermode:De,rotateLabels:Sr,bgColor:ot,container:j._hoverlayer,outerContainer:j._paper.node(),commonLabelOpts:j.hoverlabel,hoverdistance:j.hoverdistance});if(m.isUnifiedHover(De)||(I(Lt,Sr?"xa":"ya",j),F(Lt,Sr,j._invScaleX,j._invScaleY)),W&&W.tagName){var Xt=s.getComponentMethod("annotations","hasClickToShow")(V,Et);t(b.select(W),Xt?"pointer":"")}!W||J||!U(V,H,bt)||(bt&&V.emit("plotly_unhover",{event:H,points:bt}),V.emit("plotly_hover",{event:H,points:V._hoverdata,xaxes:xe,yaxes:Ee,xvals:Ve,yvals:Ue}))}function S(V){return[V.trace.index,V.index,V.x0,V.y0,V.name,V.attr,V.xa?V.xa._id:"",V.ya?V.ya._id:""].join(",")}var R=/<extra>([\s\S]*)<\/extra>/;function z(V,H){var ee=H.gd,J=ee._fullLayout,W=H.hovermode,re=H.rotateLabels,j=H.bgColor,Z=H.container,ne=H.outerContainer,le=H.commonLabelOpts||{};if(V.length===0)return[[]];var ge=H.fontFamily||x.HOVERFONT,pe=H.fontSize||x.HOVERFONTSIZE,xe=V[0],Ee=xe.xa,Te=xe.ya,de=W.charAt(0),be=xe[de+"Label"],Le=Q(ee,ne),De=Le.top,ye=Le.width,ke=Le.height,Oe=be!==void 0&&xe.distance<=H.hoverdistance&&(W==="x"||W==="y");if(Oe){var Qe=!0,Ve,Ue;for(Ve=0;Ve<V.length;Ve++)if(Qe&&V[Ve].zLabel===void 0&&(Qe=!1),Ue=V[Ve].hoverinfo||V[Ve].trace.hoverinfo,Ue){var Ie=Array.isArray(Ue)?Ue:Ue.split("+");if(Ie.indexOf("all")===-1&&Ie.indexOf(W)===-1){Oe=!1;break}}Qe&&(Oe=!1)}var at=Z.selectAll("g.axistext").data(Oe?[0]:[]);if(at.enter().append("g").classed("axistext",!0),at.exit().remove(),at.each(function(){var Nt=b.select(this),gr=E.ensureSingle(Nt,"path","",function(sn){sn.style({"stroke-width":"1px"})}),tt=E.ensureSingle(Nt,"text","",function(sn){sn.attr("data-notex",1)}),we=le.bgcolor||n.defaultLine,Me=le.bordercolor||n.contrast(we),Ne=n.contrast(we),Xe={family:le.font.family||ge,size:le.font.size||pe,color:le.font.color||Ne};gr.style({fill:we,stroke:Me}),tt.text(be).call(i.font,Xe).call(a.positionText,0,0).call(a.convertToTspans,ee),Nt.attr("transform","");var Ke=Q(ee,tt.node()),rt,Je;if(W==="x"){var vt=Ee.side==="top"?"-":"";tt.attr("text-anchor","middle").call(a.positionText,0,Ee.side==="top"?De-Ke.bottom-A-f:De-Ke.top+A+f),rt=Ee._offset+(xe.x0+xe.x1)/2,Je=Te._offset+(Ee.side==="top"?0:Te._length);var bt=Ke.width/2+f;rt<bt?(rt=bt,gr.attr("d","M-"+(bt-A)+",0L-"+(bt-A*2)+","+vt+A+"H"+(f+Ke.width/2)+"v"+vt+(f*2+Ke.height)+"H-"+bt+"V"+vt+A+"Z")):rt>J.width-bt?(rt=J.width-bt,gr.attr("d","M"+(bt-A)+",0L"+bt+","+vt+A+"v"+vt+(f*2+Ke.height)+"H-"+bt+"V"+vt+A+"H"+(bt-A*2)+"Z")):gr.attr("d","M0,0L"+A+","+vt+A+"H"+(f+Ke.width/2)+"v"+vt+(f*2+Ke.height)+"H-"+(f+Ke.width/2)+"V"+vt+A+"H-"+A+"Z")}else{var Et,Wt,Ot;Te.side==="right"?(Et="start",Wt=1,Ot="",rt=Ee._offset+Ee._length):(Et="end",Wt=-1,Ot="-",rt=Ee._offset),Je=Te._offset+(xe.y0+xe.y1)/2,tt.attr("text-anchor",Et),gr.attr("d","M0,0L"+Ot+A+","+A+"V"+(f+Ke.height/2)+"h"+Ot+(f*2+Ke.width)+"V-"+(f+Ke.height/2)+"H"+Ot+A+"V-"+A+"Z");var ir=Ke.height/2,vr=De-Ke.top-ir,_r="clip"+J._uid+"commonlabel"+Te._id,ln;if(rt<Ke.width+2*f+A){ln="M-"+(A+f)+"-"+ir+"h-"+(Ke.width-f)+"V"+ir+"h"+(Ke.width-f)+"Z";var Cr=Ke.width-rt+f;a.positionText(tt,Cr,vr),Et==="end"&&tt.selectAll("tspan").each(function(){var sn=b.select(this),yr=i.tester.append("text").text(sn.text()).call(i.font,Xe),mr=Q(ee,yr.node());Math.round(mr.width)<Math.round(Ke.width)&&sn.attr("x",Cr-mr.width),yr.remove()})}else a.positionText(tt,Wt*(f+A),vr),ln=null;var Gr=J._topclips.selectAll("#"+_r).data(ln?[0]:[]);Gr.enter().append("clipPath").attr("id",_r).append("path"),Gr.exit().remove(),Gr.select("path").attr("d",ln),i.setClipUrl(tt,ln?_r:null,ee)}Nt.attr("transform",e(rt,Je))}),m.isUnifiedHover(W)){Z.selectAll("g.hovertext").remove();var pt=V.filter(function(Nt){return Nt.hoverinfo!=="none"});if(pt.length===0)return;var Rt=J.hoverlabel,Mt=Rt.font,It={showlegend:!0,legend:{title:{text:be,font:Mt},font:Mt,bgcolor:Rt.bgcolor,bordercolor:Rt.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:J.legend?J.legend.traceorder:void 0,orientation:"v"}},Bt={font:Mt};M(It,Bt,ee._fullData);var St=Bt.legend;St.entries=[];for(var _t=0;_t<pt.length;_t++){var it=pt[_t];if(it.hoverinfo!=="none"){var ct=O(it,!0,W,J,be),et=ct[0],Pe=ct[1];it.name=Pe,Pe!==""?it.text=Pe+" : "+et:it.text=et;var We=it.cd[it.index];We&&(We.mc&&(it.mc=We.mc),We.mcc&&(it.mc=We.mcc),We.mlc&&(it.mlc=We.mlc),We.mlcc&&(it.mlc=We.mlcc),We.mlw&&(it.mlw=We.mlw),We.mrc&&(it.mrc=We.mrc),We.dir&&(it.dir=We.dir)),it._distinct=!0,St.entries.push([it])}}St.entries.sort(function(Nt,gr){return Nt[0].trace.index-gr[0].trace.index}),St.layer=Z,St._inHover=!0,St._groupTitleFont=Rt.grouptitlefont,v(ee,St);var je=Z.select("g.legend"),nt=Q(ee,je.node()),kt=nt.width+2*f,wt=nt.height+2*f,Vt=pt[0],qt=(Vt.x0+Vt.x1)/2,zt=(Vt.y0+Vt.y1)/2,Ht=!(s.traceIs(Vt.trace,"bar-like")||s.traceIs(Vt.trace,"box-violin")),$t,Qt;de==="y"?Ht?(Qt=zt-f,$t=zt+f):(Qt=Math.min.apply(null,pt.map(function(Nt){return Math.min(Nt.y0,Nt.y1)})),$t=Math.max.apply(null,pt.map(function(Nt){return Math.max(Nt.y0,Nt.y1)}))):Qt=$t=E.mean(pt.map(function(Nt){return(Nt.y0+Nt.y1)/2}))-wt/2;var fr,jr;de==="x"?Ht?(fr=qt+f,jr=qt-f):(fr=Math.max.apply(null,pt.map(function(Nt){return Math.max(Nt.x0,Nt.x1)})),jr=Math.min.apply(null,pt.map(function(Nt){return Math.min(Nt.x0,Nt.x1)}))):fr=jr=E.mean(pt.map(function(Nt){return(Nt.x0+Nt.x1)/2}))-kt/2;var cn=Ee._offset,Qr=Te._offset;$t+=Qr,fr+=cn,jr+=cn-kt,Qt+=Qr-wt;var lt,Gt;return fr+kt<ye&&fr>=0?lt=fr:jr+kt<ye&&jr>=0?lt=jr:cn+kt<ye?lt=cn:fr-qt<qt-jr+kt?lt=ye-kt:lt=0,lt+=f,$t+wt<ke&&$t>=0?Gt=$t:Qt+wt<ke&&Qt>=0?Gt=Qt:Qr+wt<ke?Gt=Qr:$t-zt<zt-Qt+wt?Gt=ke-wt:Gt=0,Gt+=f,je.attr("transform",e(lt-1,Gt-1)),je}var Kt=Z.selectAll("g.hovertext").data(V,function(Nt){return S(Nt)});return Kt.enter().append("g").classed("hovertext",!0).each(function(){var Nt=b.select(this);Nt.append("rect").call(n.fill,n.addOpacity(j,.8)),Nt.append("text").classed("name",!0),Nt.append("path").style("stroke-width","1px"),Nt.append("text").classed("nums",!0).call(i.font,ge,pe)}),Kt.exit().remove(),Kt.each(function(Nt){var gr=b.select(this).attr("transform",""),tt=Nt.color;Array.isArray(tt)&&(tt=tt[Nt.eventData[0].pointNumber]);var we=Nt.bgcolor||tt,Me=n.combine(n.opacity(we)?we:n.defaultLine,j),Ne=n.combine(n.opacity(tt)?tt:n.defaultLine,j),Xe=Nt.borderColor||n.contrast(Me),Ke=O(Nt,Oe,W,J,be,gr),rt=Ke[0],Je=Ke[1],vt=gr.select("text.nums").call(i.font,Nt.fontFamily||ge,Nt.fontSize||pe,Nt.fontColor||Xe).text(rt).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,ee),bt=gr.select("text.name"),Et=0,Wt=0;if(Je&&Je!==rt){bt.call(i.font,Nt.fontFamily||ge,Nt.fontSize||pe,Ne).text(Je).attr("data-notex",1).call(a.positionText,0,0).call(a.convertToTspans,ee);var Ot=Q(ee,bt.node());Et=Ot.width+2*f,Wt=Ot.height+2*f}else bt.remove(),gr.select("rect").remove();gr.select("path").style({fill:Me,stroke:Xe});var ir=Nt.xa._offset+(Nt.x0+Nt.x1)/2,vr=Nt.ya._offset+(Nt.y0+Nt.y1)/2,_r=Math.abs(Nt.x1-Nt.x0),ln=Math.abs(Nt.y1-Nt.y0),Cr=Q(ee,vt.node()),Gr=Cr.width/J._invScaleX,sn=Cr.height/J._invScaleY;Nt.ty0=(De-Cr.top)/J._invScaleY,Nt.bx=Gr+2*f,Nt.by=Math.max(sn+2*f,Wt),Nt.anchor="start",Nt.txwidth=Gr,Nt.tx2width=Et,Nt.offset=0;var yr=(Gr+A+f+Et)*J._invScaleX,mr,Or;if(re)Nt.pos=ir,mr=vr+ln/2+yr<=ke,Or=vr-ln/2-yr>=0,(Nt.idealAlign==="top"||!mr)&&Or?(vr-=ln/2,Nt.anchor="end"):mr?(vr+=ln/2,Nt.anchor="start"):Nt.anchor="middle";else if(Nt.pos=vr,mr=ir+_r/2+yr<=ye,Or=ir-_r/2-yr>=0,(Nt.idealAlign==="left"||!mr)&&Or)ir-=_r/2,Nt.anchor="end";else if(mr)ir+=_r/2,Nt.anchor="start";else{Nt.anchor="middle";var zr=yr/2,Sr=ir+zr-ye,ot=ir-zr;Sr>0&&(ir-=Sr),ot<0&&(ir+=-ot)}vt.attr("text-anchor",Nt.anchor),Et&&bt.attr("text-anchor",Nt.anchor),gr.attr("transform",e(ir,vr)+(re?p(_):""))}),Kt}function O(V,H,ee,J,W,re){var j="",Z="";V.nameOverride!==void 0&&(V.name=V.nameOverride),V.name&&(V.trace._meta&&(V.name=E.templateString(V.name,V.trace._meta)),j=oe(V.name,V.nameLength));var ne=ee.charAt(0),le=ne==="x"?"y":"x";V.zLabel!==void 0?(V.xLabel!==void 0&&(Z+="x: "+V.xLabel+"<br>"),V.yLabel!==void 0&&(Z+="y: "+V.yLabel+"<br>"),V.trace.type!=="choropleth"&&V.trace.type!=="choroplethmapbox"&&(Z+=(Z?"z: ":"")+V.zLabel)):H&&V[ne+"Label"]===W?Z=V[le+"Label"]||"":V.xLabel===void 0?V.yLabel!==void 0&&V.trace.type!=="scattercarpet"&&(Z=V.yLabel):V.yLabel===void 0?Z=V.xLabel:Z="("+V.xLabel+", "+V.yLabel+")",(V.text||V.text===0)&&!Array.isArray(V.text)&&(Z+=(Z?"<br>":"")+V.text),V.extraText!==void 0&&(Z+=(Z?"<br>":"")+V.extraText),re&&Z===""&&!V.hovertemplate&&(j===""&&re.remove(),Z=j);var ge=V.hovertemplate||!1;if(ge){var pe=V.hovertemplateLabels||V;V[ne+"Label"]!==W&&(pe[ne+"other"]=pe[ne+"Val"],pe[ne+"otherLabel"]=pe[ne+"Label"]),Z=E.hovertemplateString(ge,pe,J._d3locale,V.eventData[0]||{},V.trace._meta),Z=Z.replace(R,function(xe,Ee){return j=oe(Ee,V.nameLength),""})}return[Z,j]}function I(V,H,ee){var J=0,W=1,re=V.size(),j=new Array(re),Z=0;V.each(function(Ve){var Ue=Ve[H],Ie=Ue._id.charAt(0)==="x",at=Ue.range;Z===0&&at&&at[0]>at[1]!==Ie&&(W=-1),j[Z++]=[{datum:Ve,traceIndex:Ve.trace.index,dp:0,pos:Ve.pos,posref:Ve.posref,size:Ve.by*(Ie?y:1)/2,pmin:0,pmax:Ie?ee.width:ee.height}]}),j.sort(function(Ve,Ue){return Ve[0].posref-Ue[0].posref||W*(Ue[0].traceIndex-Ve[0].traceIndex)});var ne,le,ge,pe,xe,Ee,Te;function de(Ve){var Ue=Ve[0],Ie=Ve[Ve.length-1];if(le=Ue.pmin-Ue.pos-Ue.dp+Ue.size,ge=Ie.pos+Ie.dp+Ie.size-Ue.pmax,le>.01){for(xe=Ve.length-1;xe>=0;xe--)Ve[xe].dp+=le;ne=!1}if(!(ge<.01)){if(le<-.01){for(xe=Ve.length-1;xe>=0;xe--)Ve[xe].dp-=ge;ne=!1}if(!!ne){var at=0;for(pe=0;pe<Ve.length;pe++)Ee=Ve[pe],Ee.pos+Ee.dp+Ee.size>Ue.pmax&&at++;for(pe=Ve.length-1;pe>=0&&!(at<=0);pe--)Ee=Ve[pe],Ee.pos>Ue.pmax-1&&(Ee.del=!0,at--);for(pe=0;pe<Ve.length&&!(at<=0);pe++)if(Ee=Ve[pe],Ee.pos<Ue.pmin+1)for(Ee.del=!0,at--,ge=Ee.size*2,xe=Ve.length-1;xe>=0;xe--)Ve[xe].dp-=ge;for(pe=Ve.length-1;pe>=0&&!(at<=0);pe--)Ee=Ve[pe],Ee.pos+Ee.dp+Ee.size>Ue.pmax&&(Ee.del=!0,at--)}}}for(;!ne&&J<=re;){for(J++,ne=!0,pe=0;pe<j.length-1;){var be=j[pe],Le=j[pe+1],De=be[be.length-1],ye=Le[0];if(le=De.pos+De.dp+De.size-ye.pos-ye.dp+ye.size,le>.01&&De.pmin===ye.pmin&&De.pmax===ye.pmax){for(xe=Le.length-1;xe>=0;xe--)Le[xe].dp+=le;for(be.push.apply(be,Le),j.splice(pe+1,1),Te=0,xe=be.length-1;xe>=0;xe--)Te+=be[xe].dp;for(ge=Te/be.length,xe=be.length-1;xe>=0;xe--)be[xe].dp-=ge;ne=!1}else pe++}j.forEach(de)}for(pe=j.length-1;pe>=0;pe--){var ke=j[pe];for(xe=ke.length-1;xe>=0;xe--){var Oe=ke[xe],Qe=Oe.datum;Qe.offset=Oe.dp,Qe.del=Oe.del}}}function F(V,H,ee,J){var W=function(j){return j*ee},re=function(j){return j*J};V.each(function(j){var Z=b.select(this);if(j.del)return Z.remove();var ne=Z.select("text.nums"),le=j.anchor,ge=le==="end"?-1:1,pe={start:1,end:-1,middle:0}[le],xe=pe*(A+f),Ee=xe+pe*(j.txwidth+f),Te=0,de=j.offset,be=le==="middle";be&&(xe-=j.tx2width/2,Ee+=j.txwidth/2+f),H&&(de*=-w,Te=j.offset*T),Z.select("path").attr("d",be?"M-"+W(j.bx/2+j.tx2width/2)+","+re(de-j.by/2)+"h"+W(j.bx)+"v"+re(j.by)+"h-"+W(j.bx)+"Z":"M0,0L"+W(ge*A+Te)+","+re(A+de)+"v"+re(j.by/2-A)+"h"+W(ge*j.bx)+"v-"+re(j.by)+"H"+W(ge*A+Te)+"V"+re(de-A)+"Z");var Le=Te+xe,De=de+j.ty0-j.by/2+f,ye=j.textAlign||"auto";ye!=="auto"&&(ye==="left"&&le!=="start"?(ne.attr("text-anchor","start"),Le=be?-j.bx/2-j.tx2width/2+f:-j.bx-f):ye==="right"&&le!=="end"&&(ne.attr("text-anchor","end"),Le=be?j.bx/2-j.tx2width/2-f:j.bx+f)),ne.call(a.positionText,W(Le),re(De)),j.tx2width&&(Z.select("text.name").call(a.positionText,W(Ee+pe*f+Te),re(de+j.ty0-j.by/2+f)),Z.select("rect").call(i.setRect,W(Ee+(pe-1)*j.tx2width/2+Te),re(de-j.by/2-1),W(j.tx2width),re(j.by+2)))})}function D(V,H){var ee=V.index,J=V.trace||{},W=V.cd[0],re=V.cd[ee]||{};function j(xe){return xe||k(xe)&&xe===0}var Z=Array.isArray(ee)?function(xe,Ee){var Te=E.castOption(W,ee,xe);return j(Te)?Te:E.extractOption({},J,"",Ee)}:function(xe,Ee){return E.extractOption(re,J,xe,Ee)};function ne(xe,Ee,Te){var de=Z(Ee,Te);j(de)&&(V[xe]=de)}if(ne("hoverinfo","hi","hoverinfo"),ne("bgcolor","hbg","hoverlabel.bgcolor"),ne("borderColor","hbc","hoverlabel.bordercolor"),ne("fontFamily","htf","hoverlabel.font.family"),ne("fontSize","hts","hoverlabel.font.size"),ne("fontColor","htc","hoverlabel.font.color"),ne("nameLength","hnl","hoverlabel.namelength"),ne("textAlign","hta","hoverlabel.align"),V.posref=H==="y"||H==="closest"&&J.orientation==="h"?V.xa._offset+(V.x0+V.x1)/2:V.ya._offset+(V.y0+V.y1)/2,V.x0=E.constrain(V.x0,0,V.xa._length),V.x1=E.constrain(V.x1,0,V.xa._length),V.y0=E.constrain(V.y0,0,V.ya._length),V.y1=E.constrain(V.y1,0,V.ya._length),V.xLabelVal!==void 0&&(V.xLabel="xLabel"in V?V.xLabel:d.hoverLabelText(V.xa,V.xLabelVal,J.xhoverformat),V.xVal=V.xa.c2d(V.xLabelVal)),V.yLabelVal!==void 0&&(V.yLabel="yLabel"in V?V.yLabel:d.hoverLabelText(V.ya,V.yLabelVal,J.yhoverformat),V.yVal=V.ya.c2d(V.yLabelVal)),V.zLabelVal!==void 0&&V.zLabel===void 0&&(V.zLabel=String(V.zLabelVal)),!isNaN(V.xerr)&&!(V.xa.type==="log"&&V.xerr<=0)){var le=d.tickText(V.xa,V.xa.c2l(V.xerr),"hover").text;V.xerrneg!==void 0?V.xLabel+=" +"+le+" / -"+d.tickText(V.xa,V.xa.c2l(V.xerrneg),"hover").text:V.xLabel+=" \xB1 "+le,H==="x"&&(V.distance+=1)}if(!isNaN(V.yerr)&&!(V.ya.type==="log"&&V.yerr<=0)){var ge=d.tickText(V.ya,V.ya.c2l(V.yerr),"hover").text;V.yerrneg!==void 0?V.yLabel+=" +"+ge+" / -"+d.tickText(V.ya,V.ya.c2l(V.yerrneg),"hover").text:V.yLabel+=" \xB1 "+ge,H==="y"&&(V.distance+=1)}var pe=V.hoverinfo||V.trace.hoverinfo;return pe&&pe!=="all"&&(pe=Array.isArray(pe)?pe:pe.split("+"),pe.indexOf("x")===-1&&(V.xLabel=void 0),pe.indexOf("y")===-1&&(V.yLabel=void 0),pe.indexOf("z")===-1&&(V.zLabel=void 0),pe.indexOf("text")===-1&&(V.text=void 0),pe.indexOf("name")===-1&&(V.name=void 0)),V}function B(V,H,ee){var J=ee.container,W=ee.fullLayout,re=W._size,j=ee.event,Z=!!H.hLinePoint,ne=!!H.vLinePoint,le,ge;if(J.selectAll(".spikeline").remove(),!!(ne||Z)){var pe=n.combine(W.plot_bgcolor,W.paper_bgcolor);if(Z){var xe=H.hLinePoint,Ee,Te;le=xe&&xe.xa,ge=xe&&xe.ya;var de=ge.spikesnap;de==="cursor"?(Ee=j.pointerX,Te=j.pointerY):(Ee=le._offset+xe.x,Te=ge._offset+xe.y);var be=P.readability(xe.color,pe)<1.5?n.contrast(pe):xe.color,Le=ge.spikemode,De=ge.spikethickness,ye=ge.spikecolor||be,ke=d.getPxPosition(V,ge),Oe,Qe;if(Le.indexOf("toaxis")!==-1||Le.indexOf("across")!==-1){if(Le.indexOf("toaxis")!==-1&&(Oe=ke,Qe=Ee),Le.indexOf("across")!==-1){var Ve=ge._counterDomainMin,Ue=ge._counterDomainMax;ge.anchor==="free"&&(Ve=Math.min(Ve,ge.position),Ue=Math.max(Ue,ge.position)),Oe=re.l+Ve*re.w,Qe=re.l+Ue*re.w}J.insert("line",":first-child").attr({x1:Oe,x2:Qe,y1:Te,y2:Te,"stroke-width":De,stroke:ye,"stroke-dasharray":i.dashStyle(ge.spikedash,De)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:Oe,x2:Qe,y1:Te,y2:Te,"stroke-width":De+2,stroke:pe}).classed("spikeline",!0).classed("crisp",!0)}Le.indexOf("marker")!==-1&&J.insert("circle",":first-child").attr({cx:ke+(ge.side!=="right"?De:-De),cy:Te,r:De,fill:ye}).classed("spikeline",!0)}if(ne){var Ie=H.vLinePoint,at,pt;le=Ie&&Ie.xa,ge=Ie&&Ie.ya;var Rt=le.spikesnap;Rt==="cursor"?(at=j.pointerX,pt=j.pointerY):(at=le._offset+Ie.x,pt=ge._offset+Ie.y);var Mt=P.readability(Ie.color,pe)<1.5?n.contrast(pe):Ie.color,It=le.spikemode,Bt=le.spikethickness,St=le.spikecolor||Mt,_t=d.getPxPosition(V,le),it,ct;if(It.indexOf("toaxis")!==-1||It.indexOf("across")!==-1){if(It.indexOf("toaxis")!==-1&&(it=_t,ct=pt),It.indexOf("across")!==-1){var et=le._counterDomainMin,Pe=le._counterDomainMax;le.anchor==="free"&&(et=Math.min(et,le.position),Pe=Math.max(Pe,le.position)),it=re.t+(1-Pe)*re.h,ct=re.t+(1-et)*re.h}J.insert("line",":first-child").attr({x1:at,x2:at,y1:it,y2:ct,"stroke-width":Bt,stroke:St,"stroke-dasharray":i.dashStyle(le.spikedash,Bt)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:at,x2:at,y1:it,y2:ct,"stroke-width":Bt+2,stroke:pe}).classed("spikeline",!0).classed("crisp",!0)}It.indexOf("marker")!==-1&&J.insert("circle",":first-child").attr({cx:at,cy:_t-(le.side!=="top"?Bt:-Bt),r:Bt,fill:St}).classed("spikeline",!0)}}}function U(V,H,ee){if(!ee||ee.length!==V._hoverdata.length)return!0;for(var J=ee.length-1;J>=0;J--){var W=ee[J],re=V._hoverdata[J];if(W.curveNumber!==re.curveNumber||String(W.pointNumber)!==String(re.pointNumber)||String(W.pointNumbers)!==String(re.pointNumbers))return!0}return!1}function X(V,H){return!H||H.vLinePoint!==V._spikepoints.vLinePoint||H.hLinePoint!==V._spikepoints.hLinePoint}function oe(V,H){return a.plainText(V||"",{len:H,allowedTags:["br","sub","sup","b","i","em"]})}function se(V,H){for(var ee=H.charAt(0),J=[],W=[],re=[],j=0;j<V.length;j++){var Z=V[j];s.traceIs(Z.trace,"bar-like")||s.traceIs(Z.trace,"box-violin")?re.push(Z):Z.trace[ee+"period"]?W.push(Z):J.push(Z)}return J.concat(W).concat(re)}function q(V,H,ee){var J=H[V+"a"],W=H[V+"Val"],re=H.cd[0];if(J.type==="category")W=J._categoriesMap[W];else if(J.type==="date"){var j=H.trace[V+"periodalignment"];if(j){var Z=H.cd[H.index],ne=Z[V+"Start"];ne===void 0&&(ne=Z[V]);var le=Z[V+"End"];le===void 0&&(le=Z[V]);var ge=le-ne;j==="end"?W+=ge:j==="middle"&&(W+=ge/2)}W=J.d2c(W)}return re&&re.t&&re.t.posLetter===J._id&&(ee.boxmode==="group"||ee.violinmode==="group")&&(W+=re.t.dPos),W}function K(V){return V.offsetTop+V.clientTop}function G(V){return V.offsetLeft+V.clientLeft}function Q(V,H){var ee=V._fullLayout,J=H.getBoundingClientRect(),W=J.x,re=J.y,j=W+J.width,Z=re+J.height,ne=E.apply3DTransform(ee._invTransform)(W,re),le=E.apply3DTransform(ee._invTransform)(j,Z),ge=ne[0],pe=ne[1],xe=le[0],Ee=le[1];return{x:ge,y:pe,width:xe-ge,height:Ee-pe,top:Math.min(pe,Ee),left:Math.min(ge,xe),right:Math.max(ge,xe),bottom:Math.max(pe,Ee)}}},{"../../lib":503,"../../lib/events":492,"../../lib/override_cursor":514,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"../legend/defaults":418,"../legend/draw":419,"./constants":400,"./helpers":402,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:312}],404:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../color"),P=c("./helpers").isUnifiedHover;ae.exports=function(e,p,g,a){a=a||{};var t=p.legend;function i(n){a.font[n]||(a.font[n]=t?p.legend.font[n]:p.font[n])}p&&P(p.hovermode)&&(a.font||(a.font={}),i("size"),i("family"),i("color"),t?(a.bgcolor||(a.bgcolor=k.combine(p.legend.bgcolor,p.paper_bgcolor)),a.bordercolor||(a.bordercolor=p.legend.bordercolor)):a.bgcolor||(a.bgcolor=p.paper_bgcolor)),g("hoverlabel.bgcolor",a.bgcolor),g("hoverlabel.bordercolor",a.bordercolor),g("hoverlabel.namelength",a.namelength),b.coerceFont(g,"hoverlabel.font",a.font),g("hoverlabel.align",a.align)}},{"../../lib":503,"../color":366,"./helpers":402}],405:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(E,e){function p(g,a){return e[g]!==void 0?e[g]:b.coerce(E,e,k,g,a)}return p("clickmode"),p("hovermode")}},{"../../lib":503,"./layout_attributes":407}],406:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../dragelement"),E=c("./helpers"),e=c("./layout_attributes"),p=c("./hover");ae.exports={moduleType:"component",name:"fx",constants:c("./constants"),schema:{layout:e},attributes:c("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:c("./layout_global_defaults"),supplyDefaults:c("./defaults"),supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc"),getDistanceFunction:E.getDistanceFunction,getClosest:E.getClosest,inbox:E.inbox,quadrature:E.quadrature,appendArrayPointValue:E.appendArrayPointValue,castHoverOption:a,castHoverinfo:t,hover:p.hover,unhover:P.unhover,loneHover:p.loneHover,loneUnhover:g,click:c("./click")};function g(i){var n=k.isD3Selection(i)?i:b.select(i);n.selectAll("g.hovertext").remove(),n.selectAll(".spikeline").remove()}function a(i,n,r){return k.castOption(i,n,"hoverlabel."+r)}function t(i,n,r){function d(s){return k.coerceHoverinfo({hoverinfo:s},{_module:i._module},n)}return k.castOption(i,r,"hoverinfo",d)}},{"../../lib":503,"../dragelement":385,"./attributes":397,"./calc":398,"./click":399,"./constants":400,"./defaults":401,"./helpers":402,"./hover":403,"./layout_attributes":407,"./layout_defaults":408,"./layout_global_defaults":409,"@plotly/d3":58}],407:[function(c,ae,ie){"use strict";var b=c("./constants"),k=c("../../plots/font_attributes"),P=k({editType:"none"});P.family.dflt=b.HOVERFONT,P.size.dflt=b.HOVERFONTSIZE,ae.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:P,grouptitlefont:k({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":585,"./constants":400}],408:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes"),P=c("./hovermode_defaults"),E=c("./hoverlabel_defaults");ae.exports=function(p,g){function a(s,m){return b.coerce(p,g,k,s,m)}var t=P(p,g);t&&(a("hoverdistance"),a("spikedistance"));var i=a("dragmode");i==="select"&&a("selectdirection");var n=g._has("mapbox"),r=g._has("geo"),d=g._basePlotModules.length;g.dragmode==="zoom"&&((n||r)&&d===1||n&&r&&d===2)&&(g.dragmode="pan"),E(p,g,a),b.coerceFont(a,"hoverlabel.grouptitlefont",g.hoverlabel.font)}},{"../../lib":503,"./hoverlabel_defaults":404,"./hovermode_defaults":405,"./layout_attributes":407}],409:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./hoverlabel_defaults"),P=c("./layout_attributes");ae.exports=function(e,p){function g(a,t){return b.coerce(e,p,P,a,t)}k(e,p,g)}},{"../../lib":503,"./hoverlabel_defaults":404,"./layout_attributes":407}],410:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../lib/regex").counter,P=c("../../plots/domain").attributes,E=c("../../plots/cartesian/constants").idRegex,e=c("../../plot_api/plot_template"),p={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[k("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[E.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[E.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:P({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function g(r,d,s){var m=d[s+"axes"],x=Object.keys((r._splomAxes||{})[s]||{});if(Array.isArray(m))return m;if(x.length)return x}function a(r,d){var s=r.grid||{},m=g(d,s,"x"),x=g(d,s,"y");if(!r.grid&&!m&&!x)return;var M=Array.isArray(s.subplots)&&Array.isArray(s.subplots[0]),v=Array.isArray(m),_=Array.isArray(x),l=v&&m!==s.xaxes&&_&&x!==s.yaxes,y,T;M?(y=s.subplots.length,T=s.subplots[0].length):(_&&(y=x.length),v&&(T=m.length));var w=e.newContainer(d,"grid");function A(F,D){return b.coerce(s,w,p,F,D)}var f=A("rows",y),u=A("columns",T);if(!(f*u>1)){delete d.grid;return}if(!M&&!v&&!_){var h=A("pattern")==="independent";h&&(M=!0)}w._hasSubplotGrid=M;var o=A("roworder"),S=o==="top to bottom",R=M?.2:.1,z=M?.3:.1,O,I;l&&d._splomGridDflt&&(O=d._splomGridDflt.xside,I=d._splomGridDflt.yside),w._domains={x:t("x",A,R,O,u),y:t("y",A,z,I,f,S)}}function t(r,d,s,m,x,M){var v=d(r+"gap",s),_=d("domain."+r);d(r+"side",m);for(var l=new Array(x),y=_[0],T=(_[1]-y)/(x-v),w=T*(1-v),A=0;A<x;A++){var f=y+T*A;l[M?x-1-A:A]=[f,f+w]}return l}function i(r,d){var s=d.grid;if(!(!s||!s._domains)){var m=r.grid||{},x=d._subplots,M=s._hasSubplotGrid,v=s.rows,_=s.columns,l=s.pattern==="independent",y,T,w,A,f,u,h,o=s._axisMap={};if(M){var S=m.subplots||[];u=s.subplots=new Array(v);var R=1;for(y=0;y<v;y++){var z=u[y]=new Array(_),O=S[y]||[];for(T=0;T<_;T++)if(l?(f=R===1?"xy":"x"+R+"y"+R,R++):f=O[T],z[T]="",x.cartesian.indexOf(f)!==-1){if(h=f.indexOf("y"),w=f.slice(0,h),A=f.slice(h),o[w]!==void 0&&o[w]!==T||o[A]!==void 0&&o[A]!==y)continue;z[T]=f,o[w]=T,o[A]=y}}}else{var I=g(d,m,"x"),F=g(d,m,"y");s.xaxes=n(I,x.xaxis,_,o,"x"),s.yaxes=n(F,x.yaxis,v,o,"y")}var D=s._anchors={},B=s.roworder==="top to bottom";for(var U in o){var X=U.charAt(0),oe=s[X+"side"],se,q,K;if(oe.length<8)D[U]="free";else if(X==="x"){if(oe.charAt(0)==="t"===B?(se=0,q=1,K=v):(se=v-1,q=-1,K=-1),M){var G=o[U];for(y=se;y!==K;y+=q)if(f=u[y][G],!!f&&(h=f.indexOf("y"),f.slice(0,h)===U)){D[U]=f.slice(h);break}}else for(y=se;y!==K;y+=q)if(A=s.yaxes[y],x.cartesian.indexOf(U+A)!==-1){D[U]=A;break}}else if(oe.charAt(0)==="l"?(se=0,q=1,K=_):(se=_-1,q=-1,K=-1),M){var Q=o[U];for(y=se;y!==K;y+=q)if(f=u[Q][y],!!f&&(h=f.indexOf("y"),f.slice(h)===U)){D[U]=f.slice(0,h);break}}else for(y=se;y!==K;y+=q)if(w=s.xaxes[y],x.cartesian.indexOf(w+U)!==-1){D[U]=w;break}}}}function n(r,d,s,m,x){var M=new Array(s),v;function _(l,y){d.indexOf(y)!==-1&&m[y]===void 0?(M[l]=y,m[y]=l):M[l]=""}if(Array.isArray(r))for(v=0;v<s;v++)_(v,r[v]);else for(_(0,x),v=1;v<s;v++)_(v,x+(v+1));return M}ae.exports={moduleType:"component",name:"grid",schema:{layout:{grid:p}},layoutAttributes:p,sizeDefaults:a,contentDefaults:i}},{"../../lib":503,"../../lib/regex":520,"../../plot_api/plot_template":543,"../../plots/cartesian/constants":561,"../../plots/domain":584}],411:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/constants"),k=c("../../plot_api/plot_template").templatedArray,P=c("../../constants/axis_placeable_objects");ae.exports=k("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",b.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",b.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":472,"../../plot_api/plot_template":543,"../../plots/cartesian/constants":561}],412:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib/to_log_range");ae.exports=function(E,e,p,g){e=e||{};var a=p==="log"&&e.type==="linear",t=p==="linear"&&e.type==="log";if(!!(a||t)){for(var i=E._fullLayout.images,n=e._id.charAt(0),r,d,s=0;s<i.length;s++)if(r=i[s],d="images["+s+"].",r[n+"ref"]===e._id){var m=r[n],x=r["size"+n],M=null,v=null;if(a){M=k(m,e.range);var _=x/Math.pow(10,M)/2;v=2*Math.log(_+Math.sqrt(1+_*_))/Math.LN10}else M=Math.pow(10,m),v=M*(Math.pow(10,x/2)-Math.pow(10,-x/2));b(M)?b(v)||(v=null):(M=null,v=null),g(d+n,M),g(d+"size"+n,v)}}}},{"../../lib/to_log_range":531,"fast-isnumeric":190}],413:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("../../plots/array_container_defaults"),E=c("./attributes"),e="images";ae.exports=function(a,t){var i={name:e,handleItemDefaults:p};P(a,t,i)};function p(g,a,t){function i(_,l){return b.coerce(g,a,E,_,l)}var n=i("source"),r=i("visible",!!n);if(!r)return a;i("layer"),i("xanchor"),i("yanchor"),i("sizex"),i("sizey"),i("sizing"),i("opacity");for(var d={_fullLayout:t},s=["x","y"],m=0;m<2;m++){var x=s[m],M=k.coerceRef(g,a,d,x,"paper",void 0);if(M!=="paper"){var v=k.getFromId(d,M);v._imgIndices.push(a._index)}k.coercePosition(a,d,i,M,x,0)}return a}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"./attributes":411}],414:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../drawing"),P=c("../../plots/cartesian/axes"),E=c("../../plots/cartesian/axis_ids"),e=c("../../constants/xmlns_namespaces");ae.exports=function(g){var a=g._fullLayout,t=[],i={},n=[],r,d;for(d=0;d<a.images.length;d++){var s=a.images[d];if(s.visible)if(s.layer==="below"&&s.xref!=="paper"&&s.yref!=="paper"){r=E.ref2id(s.xref)+E.ref2id(s.yref);var m=a._plots[r];if(!m){n.push(s);continue}m.mainplot&&(r=m.mainplot.id),i[r]||(i[r]=[]),i[r].push(s)}else s.layer==="above"?t.push(s):n.push(s)}var x={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-1/2},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-1/2},bottom:{sizing:"YMax",offset:-1}}};function M(A){var f=b.select(this);if(this._imgSrc!==A.source)if(f.attr("xmlns",e.svg),A.source&&A.source.slice(0,5)==="data:")f.attr("xlink:href",A.source),this._imgSrc=A.source;else{var u=new Promise(function(h){var o=new Image;this.img=o,o.setAttribute("crossOrigin","anonymous"),o.onerror=S,o.onload=function(){var R=document.createElement("canvas");R.width=this.width,R.height=this.height;var z=R.getContext("2d");z.drawImage(this,0,0);var O=R.toDataURL("image/png");f.attr("xlink:href",O),h()},f.on("error",S),o.src=A.source,this._imgSrc=A.source;function S(){f.remove(),h()}}.bind(this));g._promises.push(u)}}function v(A){var f=b.select(this),u=P.getFromId(g,A.xref),h=P.getFromId(g,A.yref),o=P.getRefType(A.xref)==="domain",S=P.getRefType(A.yref)==="domain",R=a._size,z,O;u!==void 0?z=typeof A.xref=="string"&&o?u._length*A.sizex:Math.abs(u.l2p(A.sizex)-u.l2p(0)):z=A.sizex*R.w,h!==void 0?O=typeof A.yref=="string"&&S?h._length*A.sizey:Math.abs(h.l2p(A.sizey)-h.l2p(0)):O=A.sizey*R.h;var I=z*x.x[A.xanchor].offset,F=O*x.y[A.yanchor].offset,D=x.x[A.xanchor].sizing+x.y[A.yanchor].sizing,B,U;switch(u!==void 0?B=typeof A.xref=="string"&&o?u._length*A.x+u._offset:u.r2p(A.x)+u._offset:B=A.x*R.w+R.l,B+=I,h!==void 0?U=typeof A.yref=="string"&&S?h._length*(1-A.y)+h._offset:h.r2p(A.y)+h._offset:U=R.h-A.y*R.h+R.t,U+=F,A.sizing){case"fill":D+=" slice";break;case"stretch":D="none";break}f.attr({x:B,y:U,width:z,height:O,preserveAspectRatio:D,opacity:A.opacity});var X=u&&P.getRefType(A.xref)!=="domain"?u._id:"",oe=h&&P.getRefType(A.yref)!=="domain"?h._id:"",se=X+oe;k.setClipUrl(f,se?"clip"+a._uid+se:null,g)}var _=a._imageLowerLayer.selectAll("image").data(n),l=a._imageUpperLayer.selectAll("image").data(t);_.enter().append("image"),l.enter().append("image"),_.exit().remove(),l.exit().remove(),_.each(function(A){M.bind(this)(A),v.bind(this)(A)}),l.each(function(A){M.bind(this)(A),v.bind(this)(A)});var y=Object.keys(a._plots);for(d=0;d<y.length;d++){r=y[d];var T=a._plots[r];if(!!T.imagelayer){var w=T.imagelayer.selectAll("image").data(i[r]||[]);w.enter().append("image"),w.exit().remove(),w.each(function(A){M.bind(this)(A),v.bind(this)(A)})}}}},{"../../constants/xmlns_namespaces":480,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_ids":558,"../drawing":388,"@plotly/d3":58}],415:[function(c,ae,ie){"use strict";ae.exports={moduleType:"component",name:"images",layoutAttributes:c("./attributes"),supplyLayoutDefaults:c("./defaults"),includeBasePlot:c("../../plots/cartesian/include_components")("images"),draw:c("./draw"),convertCoords:c("./convert_coords")}},{"../../plots/cartesian/include_components":567,"./attributes":411,"./convert_coords":412,"./defaults":413,"./draw":414}],416:[function(c,ae,ie){"use strict";var b=c("../../plots/font_attributes"),k=c("../color/attributes");ae.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:k.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:b({editType:"legend"}),grouptitlefont:b({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:b({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":585,"../color/attributes":365}],417:[function(c,ae,ie){"use strict";ae.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],418:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("../../plot_api/plot_template"),E=c("../../plots/attributes"),e=c("./attributes"),p=c("../../plots/layout_attributes"),g=c("./helpers");ae.exports=function(t,i,n){var r=t.legend||{},d=P.newContainer(i,"legend");function s(O,I){return k.coerce(r,d,e,O,I)}for(var m,x=function(O,I){var F=m._input,D=m;return k.coerce(F,D,E,O,I)},M=i.font||{},v=k.coerceFont(s,"grouptitlefont",k.extendFlat({},M,{size:Math.round(M.size*1.1)})),_=0,l=!1,y="normal",T=0;T<n.length;T++)m=n[T],m.visible&&((m.showlegend||m._dfltShowLegend&&!(m._module&&m._module.attributes&&m._module.attributes.showlegend&&m._module.attributes.showlegend.dflt===!1))&&(_++,m.showlegend&&(l=!0,(b.traceIs(m,"pie-like")||m._input.showlegend===!0)&&_++),k.coerceFont(x,"legendgrouptitle.font",v)),(b.traceIs(m,"bar")&&i.barmode==="stack"||["tonextx","tonexty"].indexOf(m.fill)!==-1)&&(y=g.isGrouped({traceorder:y})?"grouped+reversed":"reversed"),m.legendgroup!==void 0&&m.legendgroup!==""&&(y=g.isReversed({traceorder:y})?"reversed+grouped":"grouped"));var w=k.coerce(t,i,p,"showlegend",l&&_>1);if(w===!1&&(i.legend=void 0),!(w===!1&&!r.uirevision)&&(s("uirevision",i.uirevision),w!==!1)){s("bgcolor",i.paper_bgcolor),s("bordercolor"),s("borderwidth");var A=k.coerceFont(s,"font",i.font),f=s("orientation"),u=f==="h",h,o,S;u?(h=0,b.getComponentMethod("rangeslider","isVisible")(t.xaxis)?(o=1.1,S="bottom"):(o=-.1,S="top")):(h=1.02,o=1,S="auto"),s("traceorder",y),g.isGrouped(i.legend)&&s("tracegroupgap"),s("itemsizing"),s("itemwidth"),s("itemclick"),s("itemdoubleclick"),s("groupclick"),s("x",h),s("xanchor"),s("y",o),s("yanchor",S),s("valign"),k.noneOrAll(r,d,["x","y"]);var R=s("title.text");if(R){s("title.side",u?"left":"top");var z=k.extendFlat({},A,{size:k.bigFont(A.size)});k.coerceFont(s,"title.font",z)}}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/attributes":550,"../../plots/layout_attributes":610,"../../registry":638,"./attributes":416,"./helpers":422}],419:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../plots/plots"),E=c("../../registry"),e=c("../../lib/events"),p=c("../dragelement"),g=c("../drawing"),a=c("../color"),t=c("../../lib/svg_text_utils"),i=c("./handle_click"),n=c("./constants"),r=c("../../constants/alignment"),d=r.LINE_SPACING,s=r.FROM_TL,m=r.FROM_BR,x=c("./get_legend_data"),M=c("./style"),v=c("./helpers"),_=1;ae.exports=function(I,F){return F||(F=I._fullLayout.legend||{}),l(I,F)};function l(O,I){var F=O._fullLayout,D="legend"+F._uid,B,U=I._inHover;if(U?(B=I.layer,D+="-hover"):B=F._infolayer,!!B){O._legendMouseDownTime||(O._legendMouseDownTime=0);var X;if(U){if(!I.entries)return;X=x(I.entries,I)}else{if(!O.calcdata)return;X=F.showlegend&&x(O.calcdata,I)}var oe=F.hiddenlabels||[];if(!U&&(!F.showlegend||!X.length))return B.selectAll(".legend").remove(),F._topdefs.select("#"+D).remove(),P.autoMargin(O,"legend");var se=k.ensureSingle(B,"g","legend",function(W){U||W.attr("pointer-events","all")}),q=k.ensureSingleById(F._topdefs,"clipPath",D,function(W){W.append("rect")}),K=k.ensureSingle(se,"rect","bg",function(W){W.attr("shape-rendering","crispEdges")});K.call(a.stroke,I.bordercolor).call(a.fill,I.bgcolor).style("stroke-width",I.borderwidth+"px");var G=k.ensureSingle(se,"g","scrollbox"),Q=I.title;if(I._titleWidth=0,I._titleHeight=0,Q.text){var V=k.ensureSingle(G,"text","legendtitletext");V.attr("text-anchor","start").call(g.font,Q.font).text(Q.text),f(V,G,O,I,_)}else G.selectAll(".legendtitletext").remove();var H=k.ensureSingle(se,"rect","scrollbar",function(W){W.attr(n.scrollBarEnterAttrs).call(a.fill,n.scrollBarColor)}),ee=G.selectAll("g.groups").data(X);ee.enter().append("g").attr("class","groups"),ee.exit().remove();var J=ee.selectAll("g.traces").data(k.identity);J.enter().append("g").attr("class","traces"),J.exit().remove(),J.style("opacity",function(W){var re=W[0].trace;return E.traceIs(re,"pie-like")?oe.indexOf(W[0].label)!==-1?.5:1:re.visible==="legendonly"?.5:1}).each(function(){b.select(this).call(T,O,I)}).call(M,O,I).each(function(){U||b.select(this).call(A,O)}),k.syncOrAsync([P.previousPromises,function(){return o(O,ee,J,I)},function(){var W=F._size,re=I.borderwidth;if(!U){var j=S(O);if(j)return;var Z=W.l+W.w*I.x-s[R(I)]*I._width,ne=W.t+W.h*(1-I.y)-s[z(I)]*I._effHeight;if(F.margin.autoexpand){var le=Z,ge=ne;Z=k.constrain(Z,0,F.width-I._width),ne=k.constrain(ne,0,F.height-I._effHeight),Z!==le&&k.log("Constrain legend.x to make legend fit inside graph"),ne!==ge&&k.log("Constrain legend.y to make legend fit inside graph")}g.setTranslate(se,Z,ne)}if(H.on(".drag",null),se.on("wheel",null),U||I._height<=I._maxHeight||O._context.staticPlot){var pe=I._effHeight;U&&(pe=I._height),K.attr({width:I._width-re,height:pe-re,x:re/2,y:re/2}),g.setTranslate(G,0,0),q.select("rect").attr({width:I._width-2*re,height:pe-2*re,x:re,y:re}),g.setClipUrl(G,D,O),g.setRect(H,0,0,0,0),delete I._scrollY}else{var xe=Math.max(n.scrollBarMinHeight,I._effHeight*I._effHeight/I._height),Ee=I._effHeight-xe-2*n.scrollBarMargin,Te=I._height-I._effHeight,de=Ee/Te,be=Math.min(I._scrollY||0,Te);K.attr({width:I._width-2*re+n.scrollBarWidth+n.scrollBarMargin,height:I._effHeight-re,x:re/2,y:re/2}),q.select("rect").attr({width:I._width-2*re+n.scrollBarWidth+n.scrollBarMargin,height:I._effHeight-2*re,x:re,y:re+be}),g.setClipUrl(G,D,O),Ue(be,xe,de),se.on("wheel",function(){be=k.constrain(I._scrollY+b.event.deltaY/Ee*Te,0,Te),Ue(be,xe,de),be!==0&&be!==Te&&b.event.preventDefault()});var Le,De,ye,ke=function(Mt,It,Bt){var St=(Bt-It)/de+Mt;return k.constrain(St,0,Te)},Oe=function(Mt,It,Bt){var St=(It-Bt)/de+Mt;return k.constrain(St,0,Te)},Qe=b.behavior.drag().on("dragstart",function(){var Mt=b.event.sourceEvent;Mt.type==="touchstart"?Le=Mt.changedTouches[0].clientY:Le=Mt.clientY,ye=be}).on("drag",function(){var Mt=b.event.sourceEvent;Mt.buttons===2||Mt.ctrlKey||(Mt.type==="touchmove"?De=Mt.changedTouches[0].clientY:De=Mt.clientY,be=ke(ye,Le,De),Ue(be,xe,de))});H.call(Qe);var Ve=b.behavior.drag().on("dragstart",function(){var Mt=b.event.sourceEvent;Mt.type==="touchstart"&&(Le=Mt.changedTouches[0].clientY,ye=be)}).on("drag",function(){var Mt=b.event.sourceEvent;Mt.type==="touchmove"&&(De=Mt.changedTouches[0].clientY,be=Oe(ye,Le,De),Ue(be,xe,de))});G.call(Ve)}function Ue(Mt,It,Bt){I._scrollY=O._fullLayout.legend._scrollY=Mt,g.setTranslate(G,0,-Mt),g.setRect(H,I._width,n.scrollBarMargin+Mt*Bt,n.scrollBarWidth,It),q.select("rect").attr("y",re+Mt)}if(O._context.edits.legendPosition){var Ie,at,pt,Rt;se.classed("cursor-move",!0),p.init({element:se.node(),gd:O,prepFn:function(){var Mt=g.getTranslate(se);pt=Mt.x,Rt=Mt.y},moveFn:function(Mt,It){var Bt=pt+Mt,St=Rt+It;g.setTranslate(se,Bt,St),Ie=p.align(Bt,0,W.l,W.l+W.w,I.xanchor),at=p.align(St,0,W.t+W.h,W.t,I.yanchor)},doneFn:function(){Ie!==void 0&&at!==void 0&&E.call("_guiRelayout",O,{"legend.x":Ie,"legend.y":at})},clickFn:function(Mt,It){var Bt=B.selectAll("g.traces").filter(function(){var St=this.getBoundingClientRect();return It.clientX>=St.left&&It.clientX<=St.right&&It.clientY>=St.top&&It.clientY<=St.bottom});Bt.size()>0&&y(O,se,Bt,Mt,It)}})}}],O)}}function y(O,I,F,D,B){var U=F.data()[0][0].trace,X={event:B,node:F.node(),curveNumber:U.index,expandedIndex:U._expandedIndex,data:O.data,layout:O.layout,frames:O._transitionData._frames,config:O._context,fullData:O._fullData,fullLayout:O._fullLayout};U._group&&(X.group=U._group),E.traceIs(U,"pie-like")&&(X.label=F.datum()[0].label);var oe=e.triggerHandler(O,"plotly_legendclick",X);if(oe!==!1){if(D===1)I._clickTimeout=setTimeout(function(){!O._fullLayout||i(F,O,D)},O._context.doubleClickDelay);else if(D===2){I._clickTimeout&&clearTimeout(I._clickTimeout),O._legendMouseDownTime=0;var se=e.triggerHandler(O,"plotly_legenddoubleclick",X);se!==!1&&i(F,O,D)}}}function T(O,I,F){var D=O.data()[0][0],B=D.trace,U=E.traceIs(B,"pie-like"),X=!F._inHover&&I._context.edits.legendText&&!U,oe=F._maxNameLength,se,q;D.groupTitle?(se=D.groupTitle.text,q=D.groupTitle.font):(q=F.font,F.entries?se=D.text:(se=U?D.label:B.name,B._meta&&(se=k.templateString(se,B._meta))));var K=k.ensureSingle(O,"text","legendtext");K.attr("text-anchor","start").call(g.font,q).text(X?w(se,oe):se);var G=F.itemwidth+n.itemGap*2;t.positionText(K,G,0),X?K.call(t.makeEditable,{gd:I,text:se}).call(f,O,I,F).on("edit",function(Q){this.text(w(Q,oe)).call(f,O,I,F);var V=D.trace._fullInput||{},H={};if(E.hasTransform(V,"groupby")){var ee=E.getTransformIndices(V,"groupby"),J=ee[ee.length-1],W=k.keyedContainer(V,"transforms["+J+"].styles","target","value.name");W.set(D.trace._group,Q),H=W.constructUpdate()}else H.name=Q;return E.call("_guiRestyle",I,H,B.index)}):f(K,O,I,F)}function w(O,I){var F=Math.max(4,I);if(O&&O.trim().length>=F/2)return O;O=O||"";for(var D=F-O.length;D>0;D--)O+=" ";return O}function A(O,I){var F=I._context.doubleClickDelay,D,B=1,U=k.ensureSingle(O,"rect","legendtoggle",function(X){I._context.staticPlot||X.style("cursor","pointer").attr("pointer-events","all"),X.call(a.fill,"rgba(0,0,0,0)")});I._context.staticPlot||(U.on("mousedown",function(){D=new Date().getTime(),D-I._legendMouseDownTime<F?B+=1:(B=1,I._legendMouseDownTime=D)}),U.on("mouseup",function(){if(!(I._dragged||I._editing)){var X=I._fullLayout.legend;new Date().getTime()-I._legendMouseDownTime>F&&(B=Math.max(B-1,1)),y(I,X,O,B,b.event)}}))}function f(O,I,F,D,B){D._inHover&&O.attr("data-notex",!0),t.convertToTspans(O,F,function(){u(I,F,D,B)})}function u(O,I,F,D){var B=O.data()[0][0];if(!F._inHover&&B&&!B.trace.showlegend){O.remove();return}var U=O.select("g[class*=math-group]"),X=U.node();F||(F=I._fullLayout.legend);var oe=F.borderwidth,se;D===_?se=F.title.font:B.groupTitle?se=B.groupTitle.font:se=F.font;var q=se.size*d,K,G;if(X){var Q=g.bBox(X);K=Q.height,G=Q.width,D===_?g.setTranslate(U,oe,oe+K*.75):g.setTranslate(U,0,K*.25)}else{var V=O.select(D===_?".legendtitletext":".legendtext"),H=t.lineCount(V),ee=V.node();if(K=q*H,G=ee?g.bBox(ee).width:0,D===_)F.title.side==="left"&&(G+=n.itemGap*2),t.positionText(V,oe+n.titlePad,oe+q);else{var J=n.itemGap*2+F.itemwidth;B.groupTitle&&(J=n.itemGap,G-=F.itemwidth),t.positionText(V,J,-q*((H-1)/2-.3))}}D===_?(F._titleWidth=G,F._titleHeight=K):(B.lineHeight=q,B.height=Math.max(K,16)+3,B.width=G)}function h(O){var I=0,F=0,D=O.title.side;return D&&(D.indexOf("left")!==-1&&(I=O._titleWidth),D.indexOf("top")!==-1&&(F=O._titleHeight)),[I,F]}function o(O,I,F,D){var B=O._fullLayout;D||(D=B.legend);var U=B._size,X=v.isVertical(D),oe=v.isGrouped(D),se=D.borderwidth,q=2*se,K=n.itemGap,G=D.itemwidth+K*2,Q=2*(se+K),V=z(D),H=D.y<0||D.y===0&&V==="top",ee=D.y>1||D.y===1&&V==="bottom",J=D.tracegroupgap;D._maxHeight=Math.max(H||ee?B.height/2:U.h,30);var W=0;D._width=0,D._height=0;var re=h(D);if(X)F.each(function(Ie){var at=Ie[0].height;g.setTranslate(this,se+re[0],se+re[1]+D._height+at/2+K),D._height+=at,D._width=Math.max(D._width,Ie[0].width)}),W=G+D._width,D._width+=K+G+q,D._height+=Q,oe&&(I.each(function(Ie,at){g.setTranslate(this,0,at*D.tracegroupgap)}),D._height+=(D._lgroupsLength-1)*D.tracegroupgap);else{var j=R(D),Z=D.x<0||D.x===0&&j==="right",ne=D.x>1||D.x===1&&j==="left",le=ee||H,ge=B.width/2;D._maxWidth=Math.max(Z?le&&j==="left"?U.l+U.w:ge:ne?le&&j==="right"?U.r+U.w:ge:U.w,2*G);var pe=0,xe=0;F.each(function(Ie){var at=Ie[0].width+G;pe=Math.max(pe,at),xe+=at}),W=null;var Ee=0;if(oe){var Te=0,de=0,be=0;I.each(function(){var Ie=0,at=0;b.select(this).selectAll("g.traces").each(function(Rt){var Mt=Rt[0].width,It=Rt[0].height;g.setTranslate(this,re[0],re[1]+se+K+It/2+at),at+=It,Ie=Math.max(Ie,G+Mt)});var pt=Ie+K;de>0&&pt+se+de>D._maxWidth?(Ee=Math.max(Ee,de),de=0,be+=Te+J,Te=at):Te=Math.max(Te,at),g.setTranslate(this,de,be),de+=pt}),D._width=Math.max(Ee,de)+se,D._height=be+Te+Q}else{var Le=F.size(),De=xe+q+(Le-1)*K<D._maxWidth,ye=0,ke=0,Oe=0,Qe=0;F.each(function(Ie){var at=Ie[0].height,pt=G+Ie[0].width,Rt=(De?pt:pe)+K;Rt+se+ke-K>=D._maxWidth&&(Ee=Math.max(Ee,Qe),ke=0,Oe+=ye,D._height+=ye,ye=0),g.setTranslate(this,re[0]+se+ke,re[1]+se+Oe+at/2+K),Qe=ke+pt+K,ke+=Rt,ye=Math.max(ye,at)}),De?(D._width=ke+q,D._height=ye+Q):(D._width=Math.max(Ee,Qe)+q,D._height+=ye+Q)}}D._width=Math.ceil(Math.max(D._width+re[0],D._titleWidth+2*(se+n.titlePad))),D._height=Math.ceil(Math.max(D._height+re[1],D._titleHeight+2*(se+n.itemGap))),D._effHeight=Math.min(D._height,D._maxHeight);var Ve=O._context.edits,Ue=Ve.legendText||Ve.legendPosition;F.each(function(Ie){var at=b.select(this).select(".legendtoggle"),pt=Ie[0].height,Rt=Ue?G:W||G+Ie[0].width;X||(Rt+=K/2),g.setRect(at,0,-pt/2,Rt,pt)})}function S(O){var I=O._fullLayout,F=I.legend,D=R(F),B=z(F);return P.autoMargin(O,"legend",{x:F.x,y:F.y,l:F._width*s[D],r:F._width*m[D],b:F._effHeight*m[B],t:F._effHeight*s[B]})}function R(O){return k.isRightAnchor(O)?"right":k.isCenterAnchor(O)?"center":"left"}function z(O){return k.isBottomAnchor(O)?"bottom":k.isMiddleAnchor(O)?"middle":"top"}},{"../../constants/alignment":471,"../../lib":503,"../../lib/events":492,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"./constants":417,"./get_legend_data":420,"./handle_click":421,"./helpers":422,"./style":424,"@plotly/d3":58}],420:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("./helpers");ae.exports=function(E,e){var p=e._inHover,g=k.isGrouped(e),a=k.isReversed(e),t={},i=[],n=!1,r={},d=0,s=0,m,x;function M(F,D){if(F===""||!k.isGrouped(e)){var B="~~i"+d;i.push(B),t[B]=[D],d++}else i.indexOf(F)===-1?(i.push(F),n=!0,t[F]=[D]):t[F].push(D)}for(m=0;m<E.length;m++){var v=E[m],_=v[0],l=_.trace,y=l.legendgroup;if(!(!p&&(!l.visible||!l.showlegend)))if(b.traceIs(l,"pie-like"))for(r[y]||(r[y]={}),x=0;x<v.length;x++){var T=v[x].label;r[y][T]||(M(y,{label:T,color:v[x].color,i:v[x].i,trace:l,pts:v[x].pts}),r[y][T]=!0,s=Math.max(s,(T||"").length))}else M(y,_),s=Math.max(s,(l.name||"").length)}if(!i.length)return[];var w=!n||!g,A=[];for(m=0;m<i.length;m++){var f=t[i[m]];w?A.push(f[0]):A.push(f)}for(w&&(A=[A]),m=0;m<A.length;m++){var u=1/0;for(x=0;x<A[m].length;x++){var h=A[m][x].trace.legendrank;u>h&&(u=h)}A[m][0]._groupMinRank=u,A[m][0]._preGroupSort=m}var o=function(F,D){return F[0]._groupMinRank-D[0]._groupMinRank||F[0]._preGroupSort-D[0]._preGroupSort},S=function(F,D){return F.trace.legendrank-D.trace.legendrank||F._preSort-D._preSort};for(A.forEach(function(F,D){F[0]._preGroupSort=D}),A.sort(o),m=0;m<A.length;m++){A[m].forEach(function(F,D){F._preSort=D}),A[m].sort(S);var R=A[m][0].trace,z=null;for(x=0;x<A[m].length;x++){var O=A[m][x].trace.legendgrouptitle;if(O&&O.text){z=O,p&&(O.font=e._groupTitleFont);break}}if(a&&A[m].reverse(),z){var I=!1;for(x=0;x<A[m].length;x++)if(b.traceIs(A[m][x].trace,"pie-like")){I=!0;break}A[m].unshift({i:-1,groupTitle:z,noClick:I,trace:{showlegend:R.showlegend,legendgroup:R.legendgroup,visible:e.groupclick==="toggleitem"?!0:R.visible}})}for(x=0;x<A[m].length;x++)A[m][x]=[A[m][x]]}return e._lgroupsLength=A.length,e._maxNameLength=s,A}},{"../../registry":638,"./helpers":422}],421:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../registry"),P=!0;ae.exports=function(e,p,g){var a=p._fullLayout;if(p._dragged||p._editing)return;var t=a.legend.itemclick,i=a.legend.itemdoubleclick,n=a.legend.groupclick;g===1&&t==="toggle"&&i==="toggleothers"&&P&&p.data&&p._context.showTips&&b.notifier(b._(p,"Double-click on legend to isolate one trace"),"long"),P=!1;var r;if(g===1?r=t:g===2&&(r=i),!r)return;var d=n==="togglegroup",s=a.hiddenlabels?a.hiddenlabels.slice():[],m=e.data()[0][0];if(m.groupTitle&&m.noClick)return;var x=p._fullData,M=m.trace,v=M.legendgroup,_,l,y,T,w,A,f={},u=[],h=[],o=[];function S(Q,V,H){var ee=u.indexOf(Q),J=f[V];return J||(J=f[V]=[]),u.indexOf(Q)===-1&&(u.push(Q),ee=u.length-1),J[ee]=H,ee}function R(Q,V){if(!(m.groupTitle&&!d)){var H=Q._fullInput;if(k.hasTransform(H,"groupby")){var ee=h[H.index];if(!ee){var J=k.getTransformIndices(H,"groupby"),W=J[J.length-1];ee=b.keyedContainer(H,"transforms["+W+"].styles","target","value.visible"),h[H.index]=ee}var re=ee.get(Q._group);re===void 0&&(re=!0),re!==!1&&ee.set(Q._group,V),o[H.index]=S(H.index,"visible",H.visible!==!1)}else{var j=H.visible===!1?!1:V;S(H.index,"visible",j)}}}if(k.traceIs(M,"pie-like")){var z=m.label,O=s.indexOf(z);r==="toggle"?O===-1?s.push(z):s.splice(O,1):r==="toggleothers"&&(s=[],p.calcdata[0].forEach(function(Q){z!==Q.label&&s.push(Q.label)}),p._fullLayout.hiddenlabels&&p._fullLayout.hiddenlabels.length===s.length&&O===-1&&(s=[])),k.call("_guiRelayout",p,"hiddenlabels",s)}else{var I=v&&v.length,F=[],D;if(I)for(_=0;_<x.length;_++)D=x[_],!!D.visible&&D.legendgroup===v&&F.push(_);if(r==="toggle"){var B;switch(M.visible){case!0:B="legendonly";break;case!1:B=!1;break;case"legendonly":B=!0;break}if(I)if(d)for(_=0;_<x.length;_++)x[_].visible!==!1&&x[_].legendgroup===v&&R(x[_],B);else R(M,B);else R(M,B)}else if(r==="toggleothers"){var U,X,oe,se,q=!0;for(_=0;_<x.length;_++)if(U=x[_]===M,oe=x[_].showlegend!==!0,!(U||oe)&&(X=I&&x[_].legendgroup===v,!X&&x[_].visible===!0&&!k.traceIs(x[_],"notLegendIsolatable"))){q=!1;break}for(_=0;_<x.length;_++)if(x[_].visible!==!1&&!k.traceIs(x[_],"notLegendIsolatable"))switch(M.visible){case"legendonly":R(x[_],!0);break;case!0:se=q?!0:"legendonly",U=x[_]===M,oe=x[_].showlegend!==!0&&!x[_].legendgroup,X=U||I&&x[_].legendgroup===v,R(x[_],X||oe?!0:se);break}}for(_=0;_<h.length;_++)if(y=h[_],!!y){var K=y.constructUpdate(),G=Object.keys(K);for(l=0;l<G.length;l++)T=G[l],A=f[T]=f[T]||[],A[o[_]]=K[T]}for(w=Object.keys(f),_=0;_<w.length;_++)for(T=w[_],l=0;l<u.length;l++)f[T].hasOwnProperty(l)||(f[T][l]=void 0);k.call("_guiRestyle",p,f,u)}}},{"../../lib":503,"../../registry":638}],422:[function(c,ae,ie){"use strict";ie.isGrouped=function(k){return(k.traceorder||"").indexOf("grouped")!==-1},ie.isVertical=function(k){return k.orientation!=="h"},ie.isReversed=function(k){return(k.traceorder||"").indexOf("reversed")!==-1}},{}],423:[function(c,ae,ie){"use strict";ae.exports={moduleType:"component",name:"legend",layoutAttributes:c("./attributes"),supplyLayoutDefaults:c("./defaults"),draw:c("./draw"),style:c("./style")}},{"./attributes":416,"./defaults":418,"./draw":419,"./style":424}],424:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../registry"),P=c("../../lib"),E=P.strTranslate,e=c("../drawing"),p=c("../color"),g=c("../colorscale/helpers").extractOpts,a=c("../../traces/scatter/subtypes"),t=c("../../traces/pie/style_one"),i=c("../../traces/pie/helpers").castOption,n=c("./constants"),r=12,d=5,s=2,m=10,x=5;ae.exports=function(y,T,w){var A=T._fullLayout;w||(w=A.legend);var f=w.itemsizing==="constant",u=w.itemwidth,h=(u+n.itemGap*2)/2,o=E(h,0),S=function(G,Q,V,H){var ee;if(G+1)ee=G;else if(Q&&Q.width>0)ee=Q.width;else return 0;return f?H:Math.min(ee,V)};y.each(function(G){var Q=b.select(this),V=P.ensureSingle(Q,"g","layers");V.style("opacity",G[0].trace.opacity);var H=w.valign,ee=G[0].lineHeight,J=G[0].height;if(H==="middle"||!ee||!J)V.attr("transform",null);else{var W={top:1,bottom:-1}[H],re=W*(.5*(ee-J+3));V.attr("transform",E(0,re))}var j=V.selectAll("g.legendfill").data([G]);j.enter().append("g").classed("legendfill",!0);var Z=V.selectAll("g.legendlines").data([G]);Z.enter().append("g").classed("legendlines",!0);var ne=V.selectAll("g.legendsymbols").data([G]);ne.enter().append("g").classed("legendsymbols",!0),ne.selectAll("g.legendpoints").data([G]).enter().append("g").classed("legendpoints",!0)}).each(K).each(O).each(F).each(I).each(B).each(se).each(oe).each(R).each(z).each(U).each(X);function R(G){var Q=v(G),V=Q.showFill,H=Q.showLine,ee=Q.showGradientLine,J=Q.showGradientFill,W=Q.anyFill,re=Q.anyLine,j=G[0],Z=j.trace,ne,le,ge=g(Z),pe=ge.colorscale,xe=ge.reversescale,Ee=function(ke){if(ke.size())if(V)e.fillGroupStyle(ke,T);else{var Oe="legendfill-"+Z.uid;e.gradient(ke,T,Oe,M(xe),pe,"fill")}},Te=function(ke){if(ke.size()){var Oe="legendline-"+Z.uid;e.lineGroupStyle(ke),e.gradient(ke,T,Oe,M(xe),pe,"stroke")}},de=a.hasMarkers(Z)||!W?"M5,0":re?"M5,-2":"M5,-3",be=b.select(this),Le=be.select(".legendfill").selectAll("path").data(V||J?[G]:[]);if(Le.enter().append("path").classed("js-fill",!0),Le.exit().remove(),Le.attr("d",de+"h"+u+"v6h-"+u+"z").call(Ee),H||ee){var De=S(void 0,Z.line,m,d);le=P.minExtend(Z,{line:{width:De}}),ne=[P.minExtend(j,{trace:le})]}var ye=be.select(".legendlines").selectAll("path").data(H||ee?[ne]:[]);ye.enter().append("path").classed("js-line",!0),ye.exit().remove(),ye.attr("d",de+(ee?"l"+u+",0.0001":"h"+u)).call(H?e.lineGroupStyle:Te)}function z(G){var Q=v(G),V=Q.anyFill,H=Q.anyLine,ee=Q.showLine,J=Q.showMarker,W=G[0],re=W.trace,j=!J&&!H&&!V&&a.hasText(re),Z,ne;function le(Le,De,ye,ke){var Oe=P.nestedProperty(re,Le).get(),Qe=P.isArrayOrTypedArray(Oe)&&De?De(Oe):Oe;if(f&&Qe&&ke!==void 0&&(Qe=ke),ye){if(Qe<ye[0])return ye[0];if(Qe>ye[1])return ye[1]}return Qe}function ge(Le){return W._distinct&&W.index&&Le[W.index]?Le[W.index]:Le[0]}if(J||j||ee){var pe={},xe={};if(J){pe.mc=le("marker.color",ge),pe.mx=le("marker.symbol",ge),pe.mo=le("marker.opacity",P.mean,[.2,1]),pe.mlc=le("marker.line.color",ge),pe.mlw=le("marker.line.width",P.mean,[0,5],s),xe.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var Ee=le("marker.size",P.mean,[2,16],r);pe.ms=Ee,xe.marker.size=Ee}ee&&(xe.line={width:le("line.width",ge,[0,10],d)}),j&&(pe.tx="Aa",pe.tp=le("textposition",ge),pe.ts=10,pe.tc=le("textfont.color",ge),pe.tf=le("textfont.family",ge)),Z=[P.minExtend(W,pe)],ne=P.minExtend(re,xe),ne.selectedpoints=null,ne.texttemplate=null}var Te=b.select(this).select("g.legendpoints"),de=Te.selectAll("path.scatterpts").data(J?Z:[]);de.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",o),de.exit().remove(),de.call(e.pointStyle,ne,T),J&&(Z[0].mrc=3);var be=Te.selectAll("g.pointtext").data(j?Z:[]);be.enter().append("g").classed("pointtext",!0).append("text").attr("transform",o),be.exit().remove(),be.selectAll("text").call(e.textPointStyle,ne,T)}function O(G){var Q=G[0].trace,V=Q.type==="waterfall";if(G[0]._distinct&&V){var H=G[0].trace[G[0].dir].marker;return G[0].mc=H.color,G[0].mlw=H.line.width,G[0].mlc=H.line.color,D(G,this,"waterfall")}var ee=[];Q.visible&&V&&(ee=G[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var J=b.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(ee);J.enter().append("path").classed("legendwaterfall",!0).attr("transform",o).style("stroke-miterlimit",1),J.exit().remove(),J.each(function(W){var re=b.select(this),j=Q[W[0]].marker,Z=S(void 0,j.line,x,s);re.attr("d",W[1]).style("stroke-width",Z+"px").call(p.fill,j.color),Z&&re.call(p.stroke,j.line.color)})}function I(G){D(G,this)}function F(G){D(G,this,"funnel")}function D(G,Q,V){var H=G[0].trace,ee=H.marker||{},J=ee.line||{},W=V?H.visible&&H.type===V:k.traceIs(H,"bar"),re=b.select(Q).select("g.legendpoints").selectAll("path.legend"+V).data(W?[G]:[]);re.enter().append("path").classed("legend"+V,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",o),re.exit().remove(),re.each(function(j){var Z=b.select(this),ne=j[0],le=S(ne.mlw,ee.line,x,s);Z.style("stroke-width",le+"px");var ge=ne.mcc;if(!w._inHover&&"mc"in ne){var pe=g(ee),xe=pe.mid;xe===void 0&&(xe=(pe.max+pe.min)/2),ge=e.tryColorscale(ee,"")(xe)}var Ee=ge||ne.mc||ee.color,Te=ee.pattern,de=Te&&e.getPatternAttr(Te.shape,0,"");if(de){var be=e.getPatternAttr(Te.bgcolor,0,null),Le=e.getPatternAttr(Te.fgcolor,0,null),De=Te.fgopacity,ye=_(Te.size,8,10),ke=_(Te.solidity,.5,1),Oe="legend-"+H.uid;Z.call(e.pattern,"legend",T,Oe,de,ye,ke,ge,Te.fillmode,be,Le,De)}else Z.call(p.fill,Ee);le&&p.stroke(Z,ne.mlc||J.color)})}function B(G){var Q=G[0].trace,V=b.select(this).select("g.legendpoints").selectAll("path.legendbox").data(Q.visible&&k.traceIs(Q,"box-violin")?[G]:[]);V.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",o),V.exit().remove(),V.each(function(){var H=b.select(this);if((Q.boxpoints==="all"||Q.points==="all")&&p.opacity(Q.fillcolor)===0&&p.opacity((Q.line||{}).color)===0){var ee=P.minExtend(Q,{marker:{size:f?r:P.constrain(Q.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});V.call(e.pointStyle,ee,T)}else{var J=S(void 0,Q.line,x,s);H.style("stroke-width",J+"px").call(p.fill,Q.fillcolor),J&&p.stroke(H,Q.line.color)}})}function U(G){var Q=G[0].trace,V=b.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(Q.visible&&Q.type==="candlestick"?[G,G]:[]);V.enter().append("path").classed("legendcandle",!0).attr("d",function(H,ee){return ee?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",o).style("stroke-miterlimit",1),V.exit().remove(),V.each(function(H,ee){var J=b.select(this),W=Q[ee?"increasing":"decreasing"],re=S(void 0,W.line,x,s);J.style("stroke-width",re+"px").call(p.fill,W.fillcolor),re&&p.stroke(J,W.line.color)})}function X(G){var Q=G[0].trace,V=b.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(Q.visible&&Q.type==="ohlc"?[G,G]:[]);V.enter().append("path").classed("legendohlc",!0).attr("d",function(H,ee){return ee?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",o).style("stroke-miterlimit",1),V.exit().remove(),V.each(function(H,ee){var J=b.select(this),W=Q[ee?"increasing":"decreasing"],re=S(void 0,W.line,x,s);J.style("fill","none").call(e.dashLine,W.line.dash,re),re&&p.stroke(J,W.line.color)})}function oe(G){q(G,this,"pie")}function se(G){q(G,this,"funnelarea")}function q(G,Q,V){var H=G[0],ee=H.trace,J=V?ee.visible&&ee.type===V:k.traceIs(ee,V),W=b.select(Q).select("g.legendpoints").selectAll("path.legend"+V).data(J?[G]:[]);if(W.enter().append("path").classed("legend"+V,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",o),W.exit().remove(),W.size()){var re=(ee.marker||{}).line,j=S(i(re.width,H.pts),re,x,s),Z=P.minExtend(ee,{marker:{line:{width:j}}});Z.marker.line.color=re.color;var ne=P.minExtend(H,{trace:Z});t(W,ne,Z)}}function K(G){var Q=G[0].trace,V,H=[];if(Q.visible)switch(Q.type){case"histogram2d":case"heatmap":H=[["M-15,-2V4H15V-2Z"]],V=!0;break;case"choropleth":case"choroplethmapbox":H=[["M-6,-6V6H6V-6Z"]],V=!0;break;case"densitymapbox":H=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],V="radial";break;case"cone":H=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],V=!1;break;case"streamtube":H=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],V=!1;break;case"surface":H=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],V=!0;break;case"mesh3d":H=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],V=!1;break;case"volume":H=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],V=!0;break;case"isosurface":H=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],V=!1;break}var ee=b.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(H);ee.enter().append("path").classed("legend3dandfriends",!0).attr("transform",o).style("stroke-miterlimit",1),ee.exit().remove(),ee.each(function(J,W){var re=b.select(this),j=g(Q),Z=j.colorscale,ne=j.reversescale,le=function(Ee){if(Ee.size()){var Te="legendfill-"+Q.uid;e.gradient(Ee,T,Te,M(ne,V==="radial"),Z,"fill")}},ge;if(Z){if(!V){var xe=Z.length;ge=W===0?Z[ne?xe-1:0][1]:W===1?Z[ne?0:xe-1][1]:Z[Math.floor((xe-1)/2)][1]}}else{var pe=Q.vertexcolor||Q.facecolor||Q.color;ge=P.isArrayOrTypedArray(pe)?pe[W]||pe[0]:pe}re.attr("d",J[0]),ge?re.call(p.fill,ge):re.call(le)})}};function M(l,y){var T=y?"radial":"horizontal";return T+(l?"":"reversed")}function v(l){var y=l[0].trace,T=y.contours,w=a.hasLines(y),A=a.hasMarkers(y),f=y.visible&&y.fill&&y.fill!=="none",u=!1,h=!1;if(T){var o=T.coloring;o==="lines"?u=!0:w=o==="none"||o==="heatmap"||T.showlines,T.type==="constraint"?f=T._operation!=="=":(o==="fill"||o==="heatmap")&&(h=!0)}return{showMarker:A,showLine:w,showFill:f,showGradientLine:u,showGradientFill:h,anyLine:w||u,anyFill:f||h}}function _(l,y,T){return l&&P.isArrayOrTypedArray(l)?y:l>T?T:l}},{"../../lib":503,"../../registry":638,"../../traces/pie/helpers":906,"../../traces/pie/style_one":912,"../../traces/scatter/subtypes":952,"../color":366,"../colorscale/helpers":377,"../drawing":388,"./constants":417,"@plotly/d3":58}],425:[function(c,ae,ie){"use strict";var b=c("./constants");ae.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":427}],426:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../plots/plots"),P=c("../../plots/cartesian/axis_ids"),E=c("../../fonts/ploticon"),e=c("../shapes/draw").eraseActiveShape,p=c("../../lib"),g=p._,a=ae.exports={};a.toImage={name:"toImage",title:function(l){var y=l._context.toImageButtonOptions||{},T=y.format||"png";return T==="png"?g(l,"Download plot as a png"):g(l,"Download plot")},icon:E.camera,click:function(l){var y=l._context.toImageButtonOptions,T={format:y.format||"png"};p.notifier(g(l,"Taking snapshot - this may take a few seconds"),"long"),T.format!=="svg"&&p.isIE()&&(p.notifier(g(l,"IE only supports svg.  Changing format to svg."),"long"),T.format="svg"),["filename","width","height","scale"].forEach(function(w){w in y&&(T[w]=y[w])}),b.call("downloadImage",l,T).then(function(w){p.notifier(g(l,"Snapshot succeeded")+" - "+w,"long")}).catch(function(){p.notifier(g(l,"Sorry, there was a problem downloading your snapshot!"),"long")})}},a.sendDataToCloud={name:"sendDataToCloud",title:function(l){return g(l,"Edit in Chart Studio")},icon:E.disk,click:function(l){k.sendDataToCloud(l)}},a.editInChartStudio={name:"editInChartStudio",title:function(l){return g(l,"Edit in Chart Studio")},icon:E.pencil,click:function(l){k.sendDataToCloud(l)}},a.zoom2d={name:"zoom2d",_cat:"zoom",title:function(l){return g(l,"Zoom")},attr:"dragmode",val:"zoom",icon:E.zoombox,click:t},a.pan2d={name:"pan2d",_cat:"pan",title:function(l){return g(l,"Pan")},attr:"dragmode",val:"pan",icon:E.pan,click:t},a.select2d={name:"select2d",_cat:"select",title:function(l){return g(l,"Box Select")},attr:"dragmode",val:"select",icon:E.selectbox,click:t},a.lasso2d={name:"lasso2d",_cat:"lasso",title:function(l){return g(l,"Lasso Select")},attr:"dragmode",val:"lasso",icon:E.lasso,click:t},a.drawclosedpath={name:"drawclosedpath",title:function(l){return g(l,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:E.drawclosedpath,click:t},a.drawopenpath={name:"drawopenpath",title:function(l){return g(l,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:E.drawopenpath,click:t},a.drawline={name:"drawline",title:function(l){return g(l,"Draw line")},attr:"dragmode",val:"drawline",icon:E.drawline,click:t},a.drawrect={name:"drawrect",title:function(l){return g(l,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:E.drawrect,click:t},a.drawcircle={name:"drawcircle",title:function(l){return g(l,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:E.drawcircle,click:t},a.eraseshape={name:"eraseshape",title:function(l){return g(l,"Erase active shape")},icon:E.eraseshape,click:e},a.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(l){return g(l,"Zoom in")},attr:"zoom",val:"in",icon:E.zoom_plus,click:t},a.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(l){return g(l,"Zoom out")},attr:"zoom",val:"out",icon:E.zoom_minus,click:t},a.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(l){return g(l,"Autoscale")},attr:"zoom",val:"auto",icon:E.autoscale,click:t},a.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(l){return g(l,"Reset axes")},attr:"zoom",val:"reset",icon:E.home,click:t},a.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(l){return g(l,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:E.tooltip_basic,gravity:"ne",click:t},a.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(l){return g(l,"Compare data on hover")},attr:"hovermode",val:function(l){return l._fullLayout._isHoriz?"y":"x"},icon:E.tooltip_compare,gravity:"ne",click:t};function t(l,y){var T=y.currentTarget,w=T.getAttribute("data-attr"),A=T.getAttribute("data-val")||!0,f=l._fullLayout,u={},h=P.list(l,null,!0),o=f._cartesianSpikesEnabled,S,R;if(w==="zoom"){var z=A==="in"?.5:2,O=(1+z)/2,I=(1-z)/2,F;for(R=0;R<h.length;R++)if(S=h[R],!S.fixedrange)if(F=S._name,A==="auto")u[F+".autorange"]=!0;else if(A==="reset"){if(S._rangeInitial===void 0)u[F+".autorange"]=!0;else{var D=S._rangeInitial.slice();u[F+".range[0]"]=D[0],u[F+".range[1]"]=D[1]}S._showSpikeInitial!==void 0&&(u[F+".showspikes"]=S._showSpikeInitial,o==="on"&&!S._showSpikeInitial&&(o="off"))}else{var B=[S.r2l(S.range[0]),S.r2l(S.range[1])],U=[O*B[0]+I*B[1],O*B[1]+I*B[0]];u[F+".range[0]"]=S.l2r(U[0]),u[F+".range[1]"]=S.l2r(U[1])}}else w==="hovermode"&&(A==="x"||A==="y")&&(A=f._isHoriz?"y":"x",T.setAttribute("data-val",A)),u[w]=A;f._cartesianSpikesEnabled=o,b.call("_guiRelayout",l,u)}a.zoom3d={name:"zoom3d",_cat:"zoom",title:function(l){return g(l,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:E.zoombox,click:i},a.pan3d={name:"pan3d",_cat:"pan",title:function(l){return g(l,"Pan")},attr:"scene.dragmode",val:"pan",icon:E.pan,click:i},a.orbitRotation={name:"orbitRotation",title:function(l){return g(l,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:E["3d_rotate"],click:i},a.tableRotation={name:"tableRotation",title:function(l){return g(l,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:E["z-axis"],click:i};function i(l,y){for(var T=y.currentTarget,w=T.getAttribute("data-attr"),A=T.getAttribute("data-val")||!0,f=l._fullLayout._subplots.gl3d||[],u={},h=w.split("."),o=0;o<f.length;o++)u[f[o]+"."+h[1]]=A;var S=A==="pan"?A:"zoom";u.dragmode=S,b.call("_guiRelayout",l,u)}a.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(l){return g(l,"Reset camera to default")},attr:"resetDefault",icon:E.home,click:n},a.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(l){return g(l,"Reset camera to last save")},attr:"resetLastSave",icon:E.movie,click:n};function n(l,y){for(var T=y.currentTarget,w=T.getAttribute("data-attr"),A=w==="resetLastSave",f=w==="resetDefault",u=l._fullLayout,h=u._subplots.gl3d||[],o={},S=0;S<h.length;S++){var R=h[S],z=R+".camera",O=R+".aspectratio",I=R+".aspectmode",F=u[R]._scene,D;A?(o[z+".up"]=F.viewInitial.up,o[z+".eye"]=F.viewInitial.eye,o[z+".center"]=F.viewInitial.center,D=!0):f&&(o[z+".up"]=null,o[z+".eye"]=null,o[z+".center"]=null,D=!0),D&&(o[O+".x"]=F.viewInitial.aspectratio.x,o[O+".y"]=F.viewInitial.aspectratio.y,o[O+".z"]=F.viewInitial.aspectratio.z,o[I]=F.viewInitial.aspectmode)}b.call("_guiRelayout",l,o)}a.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(l){return g(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:E.tooltip_basic,gravity:"ne",click:d};function r(l,y){var T=y.currentTarget,w=T._previousVal,A=l._fullLayout,f=A._subplots.gl3d||[],u=["xaxis","yaxis","zaxis"],h={},o={};if(w)o=w,T._previousVal=null;else{for(var S=0;S<f.length;S++){var R=f[S],z=A[R],O=R+".hovermode";h[O]=z.hovermode,o[O]=!1;for(var I=0;I<3;I++){var F=u[I],D=R+"."+F+".showspikes";o[D]=!1,h[D]=z[F].showspikes}}T._previousVal=h}return o}function d(l,y){var T=r(l,y);b.call("_guiRelayout",l,T)}a.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(l){return g(l,"Zoom in")},attr:"zoom",val:"in",icon:E.zoom_plus,click:s},a.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(l){return g(l,"Zoom out")},attr:"zoom",val:"out",icon:E.zoom_minus,click:s},a.resetGeo={name:"resetGeo",_cat:"reset",title:function(l){return g(l,"Reset")},attr:"reset",val:null,icon:E.autoscale,click:s},a.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(l){return g(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:E.tooltip_basic,gravity:"ne",click:x};function s(l,y){for(var T=y.currentTarget,w=T.getAttribute("data-attr"),A=T.getAttribute("data-val")||!0,f=l._fullLayout,u=f._subplots.geo||[],h=0;h<u.length;h++){var o=u[h],S=f[o];if(w==="zoom"){var R=S.projection.scale,z=A==="in"?2*R:.5*R;b.call("_guiRelayout",l,o+".projection.scale",z)}}w==="reset"&&_(l,"geo")}a.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(l){return g(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:E.tooltip_basic,gravity:"ne",click:x},a.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(l){return g(l,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:E.tooltip_basic,gravity:"ne",click:x};function m(l){var y=l._fullLayout;return y.hovermode?!1:y._has("cartesian")?y._isHoriz?"y":"x":"closest"}function x(l){var y=m(l);b.call("_guiRelayout",l,"hovermode",y)}a.resetViewSankey={name:"resetSankeyGroup",title:function(l){return g(l,"Reset view")},icon:E.home,click:function(l){for(var y={"node.groups":[],"node.x":[],"node.y":[]},T=0;T<l._fullData.length;T++){var w=l._fullData[T]._viewInitial;y["node.groups"].push(w.node.groups.slice()),y["node.x"].push(w.node.x.slice()),y["node.y"].push(w.node.y.slice())}b.call("restyle",l,y)}},a.toggleHover={name:"toggleHover",title:function(l){return g(l,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:E.tooltip_basic,gravity:"ne",click:function(l,y){var T=r(l,y);T.hovermode=m(l),b.call("_guiRelayout",l,T)}},a.resetViews={name:"resetViews",title:function(l){return g(l,"Reset views")},icon:E.home,click:function(l,y){var T=y.currentTarget;T.setAttribute("data-attr","zoom"),T.setAttribute("data-val","reset"),t(l,y),T.setAttribute("data-attr","resetLastSave"),n(l,y),_(l,"geo"),_(l,"mapbox")}},a.toggleSpikelines={name:"toggleSpikelines",title:function(l){return g(l,"Toggle Spike Lines")},icon:E.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(l){var y=l._fullLayout,T=y._cartesianSpikesEnabled;y._cartesianSpikesEnabled=T==="on"?"off":"on",b.call("_guiRelayout",l,M(l))}};function M(l){for(var y=l._fullLayout,T=y._cartesianSpikesEnabled==="on",w=P.list(l,null,!0),A={},f=0;f<w.length;f++){var u=w[f];A[u._name+".showspikes"]=T?!0:u._showSpikeInitial}return A}a.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(l){return g(l,"Reset view")},attr:"reset",icon:E.home,click:function(l){_(l,"mapbox")}},a.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(l){return g(l,"Zoom in")},attr:"zoom",val:"in",icon:E.zoom_plus,click:v},a.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(l){return g(l,"Zoom out")},attr:"zoom",val:"out",icon:E.zoom_minus,click:v};function v(l,y){for(var T=y.currentTarget,w=T.getAttribute("data-val"),A=l._fullLayout,f=A._subplots.mapbox||[],u=1.05,h={},o=0;o<f.length;o++){var S=f[o],R=A[S].zoom,z=w==="in"?u*R:R/u;h[S+".zoom"]=z}b.call("_guiRelayout",l,h)}function _(l,y){for(var T=l._fullLayout,w=T._subplots[y]||[],A={},f=0;f<w.length;f++)for(var u=w[f],h=T[u]._subplot,o=h.viewInitial,S=Object.keys(o),R=0;R<S.length;R++){var z=S[R];A[u+"."+z]=o[z]}b.call("_guiRelayout",l,A)}},{"../../fonts/ploticon":482,"../../lib":503,"../../plots/cartesian/axis_ids":558,"../../plots/plots":619,"../../registry":638,"../shapes/draw":450}],427:[function(c,ae,ie){"use strict";var b=c("./buttons"),k=Object.keys(b),P=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],E=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(P),e=[],p=function(g){if(E.indexOf(g._cat||g.name)===-1){var a=g.name,t=(g._cat||g.name).toLowerCase();e.indexOf(a)===-1&&e.push(a),e.indexOf(t)===-1&&e.push(t)}};k.forEach(function(g){p(b[g])}),e.sort(),ae.exports={DRAW_MODES:P,backButtons:E,foreButtons:e}},{"./buttons":426}],428:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../color"),P=c("../../plot_api/plot_template"),E=c("./attributes");ae.exports=function(p,g){var a=p.modebar||{},t=P.newContainer(g,"modebar");function i(r,d){return b.coerce(a,t,E,r,d)}i("orientation"),i("bgcolor",k.addOpacity(g.paper_bgcolor,.5));var n=k.contrast(k.rgb(g.modebar.bgcolor));i("color",k.addOpacity(n,.3)),i("activecolor",k.addOpacity(n,.7)),i("uirevision",g.uirevision),i("add"),i("remove")}},{"../../lib":503,"../../plot_api/plot_template":543,"../color":366,"./attributes":425}],429:[function(c,ae,ie){"use strict";ae.exports={moduleType:"component",name:"modebar",layoutAttributes:c("./attributes"),supplyLayoutDefaults:c("./defaults"),manage:c("./manage")}},{"./attributes":425,"./defaults":428,"./manage":430}],430:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axis_ids"),k=c("../../traces/scatter/subtypes"),P=c("../../registry"),E=c("../fx/helpers").isUnifiedHover,e=c("./modebar"),p=c("./buttons"),g=c("./constants").DRAW_MODES;ae.exports=function(m){var x=m._fullLayout,M=m._context,v=x._modeBar;if(!M.displayModeBar&&!M.watermark){v&&(v.destroy(),delete x._modeBar);return}if(!Array.isArray(M.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(M.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var _=M.modeBarButtons,l;Array.isArray(_)&&_.length?l=d(_):!M.displayModeBar&&M.watermark?l=[]:l=a(m),v?v.update(m,l):x._modeBar=e(m,l)};function a(s){var m=s._fullLayout,x=s._fullData,M=s._context;function v(J,W){if(typeof W=="string"){if(W.toLowerCase()===J.toLowerCase())return!0}else{var re=W.name,j=W._cat||W.name;if(re===J||j===J.toLowerCase())return!0}return!1}var _=m.modebar.add;typeof _=="string"&&(_=[_]);var l=m.modebar.remove;typeof l=="string"&&(l=[l]);var y=M.modeBarButtonsToAdd.concat(_.filter(function(J){for(var W=0;W<M.modeBarButtonsToRemove.length;W++)if(v(J,M.modeBarButtonsToRemove[W]))return!1;return!0})),T=M.modeBarButtonsToRemove.concat(l.filter(function(J){for(var W=0;W<M.modeBarButtonsToAdd.length;W++)if(v(J,M.modeBarButtonsToAdd[W]))return!1;return!0})),w=m._has("cartesian"),A=m._has("gl3d"),f=m._has("geo"),u=m._has("pie"),h=m._has("funnelarea"),o=m._has("gl2d"),S=m._has("ternary"),R=m._has("mapbox"),z=m._has("polar"),O=m._has("smith"),I=m._has("sankey"),F=t(m),D=E(m.hovermode),B=[];function U(J){if(!!J.length){for(var W=[],re=0;re<J.length;re++){for(var j=J[re],Z=p[j],ne=Z.name.toLowerCase(),le=(Z._cat||Z.name).toLowerCase(),ge=!1,pe=0;pe<T.length;pe++){var xe=T[pe].toLowerCase();if(xe===ne||xe===le){ge=!0;break}}ge||W.push(p[j])}B.push(W)}}var X=["toImage"];M.showEditInChartStudio?X.push("editInChartStudio"):M.showSendToCloud&&X.push("sendDataToCloud"),U(X);var oe=[],se=[],q=[],K=[];(w||o||u||h||S)+f+A+R+z+O>1?(se=["toggleHover"],q=["resetViews"]):f?(oe=["zoomInGeo","zoomOutGeo"],se=["hoverClosestGeo"],q=["resetGeo"]):A?(se=["hoverClosest3d"],q=["resetCameraDefault3d","resetCameraLastSave3d"]):R?(oe=["zoomInMapbox","zoomOutMapbox"],se=["toggleHover"],q=["resetViewMapbox"]):o?se=["hoverClosestGl2d"]:u?se=["hoverClosestPie"]:I?(se=["hoverClosestCartesian","hoverCompareCartesian"],q=["resetViewSankey"]):se=["toggleHover"],w&&(se=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(n(x)||D)&&(se=[]),(w||o)&&!F&&(oe=["zoomIn2d","zoomOut2d","autoScale2d"],q[0]!=="resetViews"&&(q=["resetScale2d"])),A?K=["zoom3d","pan3d","orbitRotation","tableRotation"]:(w||o)&&!F||S?K=["zoom2d","pan2d"]:R||f?K=["pan2d"]:z&&(K=["zoom2d"]),i(x)&&K.push("select2d","lasso2d");var G=[],Q=function(J){G.indexOf(J)===-1&&se.indexOf(J)!==-1&&G.push(J)};if(Array.isArray(y)){for(var V=[],H=0;H<y.length;H++){var ee=y[H];typeof ee=="string"?(ee=ee.toLowerCase(),g.indexOf(ee)!==-1?(m._has("mapbox")||m._has("cartesian"))&&K.push(ee):ee==="togglespikelines"?Q("toggleSpikelines"):ee==="togglehover"?Q("toggleHover"):ee==="hovercompare"?Q("hoverCompareCartesian"):ee==="hoverclosest"?(Q("hoverClosestCartesian"),Q("hoverClosestGeo"),Q("hoverClosest3d"),Q("hoverClosestGl2d"),Q("hoverClosestPie")):ee==="v1hovermode"&&(Q("toggleHover"),Q("hoverClosestCartesian"),Q("hoverCompareCartesian"),Q("hoverClosestGeo"),Q("hoverClosest3d"),Q("hoverClosestGl2d"),Q("hoverClosestPie"))):V.push(ee)}y=V}return U(K),U(oe.concat(q)),U(G),r(B,y)}function t(s){for(var m=b.list({_fullLayout:s},null,!0),x=0;x<m.length;x++)if(!m[x].fixedrange)return!1;return!0}function i(s){for(var m=!1,x=0;x<s.length&&!m;x++){var M=s[x];!M._module||!M._module.selectPoints||(P.traceIs(M,"scatter-like")?(k.hasMarkers(M)||k.hasText(M))&&(m=!0):P.traceIs(M,"box-violin")?(M.boxpoints==="all"||M.points==="all")&&(m=!0):m=!0)}return m}function n(s){for(var m=0;m<s.length;m++)if(!P.traceIs(s[m],"noHover"))return!1;return!0}function r(s,m){if(m.length)if(Array.isArray(m[0]))for(var x=0;x<m.length;x++)s.push(m[x]);else s.push(m);return s}function d(s){for(var m=0;m<s.length;m++)for(var x=s[m],M=0;M<x.length;M++){var v=x[M];if(typeof v=="string")if(p[v]!==void 0)s[m][M]=p[v];else throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "))}return s}},{"../../plots/cartesian/axis_ids":558,"../../registry":638,"../../traces/scatter/subtypes":952,"../fx/helpers":402,"./buttons":426,"./constants":427,"./modebar":431}],431:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=c("../../lib"),E=c("../../fonts/ploticon"),e=c("../../version").version,p=new DOMParser;function g(n){this.container=n.container,this.element=document.createElement("div"),this.update(n.graphInfo,n.buttons),this.container.appendChild(this.element)}var a=g.prototype;a.update=function(n,r){this.graphInfo=n;var d=this.graphInfo._context,s=this.graphInfo._fullLayout,m="modebar-"+s._uid;this.element.setAttribute("id",m),this._uid=m,this.element.className="modebar",d.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),s.modebar.orientation==="v"&&(this.element.className+=" vertical",r=r.reverse());var x=s.modebar,M=d.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";P.deleteRelatedStyleRule(m),P.addRelatedStyleRule(m,M+"#"+m+" .modebar-group","background-color: "+x.bgcolor),P.addRelatedStyleRule(m,"#"+m+" .modebar-btn .icon path","fill: "+x.color),P.addRelatedStyleRule(m,"#"+m+" .modebar-btn:hover .icon path","fill: "+x.activecolor),P.addRelatedStyleRule(m,"#"+m+" .modebar-btn.active .icon path","fill: "+x.activecolor);var v=!this.hasButtons(r),_=this.hasLogo!==d.displaylogo,l=this.locale!==d.locale;if(this.locale=d.locale,(v||_||l)&&(this.removeAllButtons(),this.updateButtons(r),d.watermark||d.displaylogo)){var y=this.getLogo();d.watermark&&(y.className=y.className+" watermark"),s.modebar.orientation==="v"?this.element.insertBefore(y,this.element.childNodes[0]):this.element.appendChild(y),this.hasLogo=!0}this.updateActiveButton()},a.updateButtons=function(n){var r=this;this.buttons=n,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(d){var s=r.createGroup();d.forEach(function(m){var x=m.name;if(!x)throw new Error("must provide button 'name' in button config");if(r.buttonsNames.indexOf(x)!==-1)throw new Error("button name '"+x+"' is taken");r.buttonsNames.push(x);var M=r.createButton(m);r.buttonElements.push(M),s.appendChild(M)}),r.element.appendChild(s)})},a.createGroup=function(){var n=document.createElement("div");return n.className="modebar-group",n},a.createButton=function(n){var r=this,d=document.createElement("a");d.setAttribute("rel","tooltip"),d.className="modebar-btn";var s=n.title;s===void 0?s=n.name:typeof s=="function"&&(s=s(this.graphInfo)),(s||s===0)&&d.setAttribute("data-title",s),n.attr!==void 0&&d.setAttribute("data-attr",n.attr);var m=n.val;m!==void 0&&(typeof m=="function"&&(m=m(this.graphInfo)),d.setAttribute("data-val",m));var x=n.click;if(typeof x!="function")throw new Error("must provide button 'click' function in button config");d.addEventListener("click",function(v){n.click(r.graphInfo,v),r.updateActiveButton(v.currentTarget)}),d.setAttribute("data-toggle",n.toggle||!1),n.toggle&&b.select(d).classed("active",!0);var M=n.icon;return typeof M=="function"?d.appendChild(M()):d.appendChild(this.createIcon(M||E.question)),d.setAttribute("data-gravity",n.gravity||"n"),d},a.createIcon=function(n){var r=k(n.height)?Number(n.height):n.ascent-n.descent,d="http://www.w3.org/2000/svg",s;if(n.path){s=document.createElementNS(d,"svg"),s.setAttribute("viewBox",[0,0,n.width,r].join(" ")),s.setAttribute("class","icon");var m=document.createElementNS(d,"path");m.setAttribute("d",n.path),n.transform?m.setAttribute("transform",n.transform):n.ascent!==void 0&&m.setAttribute("transform","matrix(1 0 0 -1 0 "+n.ascent+")"),s.appendChild(m)}if(n.svg){var x=p.parseFromString(n.svg,"application/xml");s=x.childNodes[0]}return s.setAttribute("height","1em"),s.setAttribute("width","1em"),s},a.updateActiveButton=function(n){var r=this.graphInfo._fullLayout,d=n!==void 0?n.getAttribute("data-attr"):null;this.buttonElements.forEach(function(s){var m=s.getAttribute("data-val")||!0,x=s.getAttribute("data-attr"),M=s.getAttribute("data-toggle")==="true",v=b.select(s);if(M)x===d&&v.classed("active",!v.classed("active"));else{var _=x===null?x:P.nestedProperty(r,x).get();v.classed("active",_===m)}})},a.hasButtons=function(n){var r=this.buttons;if(!r||n.length!==r.length)return!1;for(var d=0;d<n.length;++d){if(n[d].length!==r[d].length)return!1;for(var s=0;s<n[d].length;s++)if(n[d][s].name!==r[d][s].name)return!1}return!0};function t(n){return n+" (v"+e+")"}a.getLogo=function(){var n=this.createGroup(),r=document.createElement("a");return r.href="https://plotly.com/",r.target="_blank",r.setAttribute("data-title",t(P._(this.graphInfo,"Produced with Plotly.js"))),r.className="modebar-btn plotlyjsicon modebar-btn--logo",r.appendChild(this.createIcon(E.newplotlylogo)),n.appendChild(r),n},a.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},a.destroy=function(){P.removeElement(this.container.querySelector(".modebar")),P.deleteRelatedStyleRule(this._uid)};function i(n,r){var d=n._fullLayout,s=new g({graphInfo:n,container:d._modebardiv.node(),buttons:r});return d._privateplot&&b.select(s.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),s}ae.exports=i},{"../../fonts/ploticon":482,"../../lib":503,"../../version":1123,"@plotly/d3":58,"fast-isnumeric":190}],432:[function(c,ae,ie){"use strict";var b=c("../../plots/font_attributes"),k=c("../color/attributes"),P=c("../../plot_api/plot_template").templatedArray,E=P("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});ae.exports={visible:{valType:"boolean",editType:"plot"},buttons:E,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:b({editType:"plot"}),bgcolor:{valType:"color",dflt:k.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:k.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":543,"../../plots/font_attributes":585,"../color/attributes":365}],433:[function(c,ae,ie){"use strict";ae.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],434:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../color"),P=c("../../plot_api/plot_template"),E=c("../../plots/array_container_defaults"),e=c("./attributes"),p=c("./constants");ae.exports=function(i,n,r,d,s){var m=i.rangeselector||{},x=P.newContainer(n,"rangeselector");function M(T,w){return b.coerce(m,x,e,T,w)}var v=E(m,x,{name:"buttons",handleItemDefaults:g,calendar:s}),_=M("visible",v.length>0);if(_){var l=a(n,r,d);M("x",l[0]),M("y",l[1]),b.noneOrAll(i,n,["x","y"]),M("xanchor"),M("yanchor"),b.coerceFont(M,"font",r.font);var y=M("bgcolor");M("activecolor",k.contrast(y,p.lightAmount,p.darkAmount)),M("bordercolor"),M("borderwidth")}};function g(t,i,n,r){var d=r.calendar;function s(M,v){return b.coerce(t,i,e.buttons,M,v)}var m=s("visible");if(m){var x=s("step");x!=="all"&&(d&&d!=="gregorian"&&(x==="month"||x==="year")?i.stepmode="backward":s("stepmode"),s("count")),s("label")}}function a(t,i,n){for(var r=n.filter(function(x){return i[x].anchor===t._id}),d=0,s=0;s<r.length;s++){var m=i[r[s]].domain;m&&(d=Math.max(m[1],d))}return[t.domain[0],d+p.yPad]}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/array_container_defaults":549,"../color":366,"./attributes":432,"./constants":433}],435:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../registry"),P=c("../../plots/plots"),E=c("../color"),e=c("../drawing"),p=c("../../lib"),g=p.strTranslate,a=c("../../lib/svg_text_utils"),t=c("../../plots/cartesian/axis_ids"),i=c("../../constants/alignment"),n=i.LINE_SPACING,r=i.FROM_TL,d=i.FROM_BR,s=c("./constants"),m=c("./get_update_object");ae.exports=function(f){var u=f._fullLayout,h=u._infolayer.selectAll(".rangeselector").data(x(f),M);h.enter().append("g").classed("rangeselector",!0),h.exit().remove(),h.style({cursor:"pointer","pointer-events":"all"}),h.each(function(o){var S=b.select(this),R=o,z=R.rangeselector,O=S.selectAll("g.button").data(p.filterVisible(z.buttons));O.enter().append("g").classed("button",!0),O.exit().remove(),O.each(function(I){var F=b.select(this),D=m(R,I);I._isActive=v(R,I,D),F.call(_,z,I),F.call(y,z,I,f),F.on("click",function(){f._dragged||k.call("_guiRelayout",f,D)}),F.on("mouseover",function(){I._isHovered=!0,F.call(_,z,I)}),F.on("mouseout",function(){I._isHovered=!1,F.call(_,z,I)})}),w(f,O,z,R._name,S)})};function x(A){for(var f=t.list(A,"x",!0),u=[],h=0;h<f.length;h++){var o=f[h];o.rangeselector&&o.rangeselector.visible&&u.push(o)}return u}function M(A){return A._id}function v(A,f,u){if(f.step==="all")return A.autorange===!0;var h=Object.keys(u);return A.range[0]===u[h[0]]&&A.range[1]===u[h[1]]}function _(A,f,u){var h=p.ensureSingle(A,"rect","selector-rect",function(o){o.attr("shape-rendering","crispEdges")});h.attr({rx:s.rx,ry:s.ry}),h.call(E.stroke,f.bordercolor).call(E.fill,l(f,u)).style("stroke-width",f.borderwidth+"px")}function l(A,f){return f._isActive||f._isHovered?A.activecolor:A.bgcolor}function y(A,f,u,h){function o(R){a.convertToTspans(R,h)}var S=p.ensureSingle(A,"text","selector-text",function(R){R.attr("text-anchor","middle")});S.call(e.font,f.font).text(T(u,h._fullLayout._meta)).call(o)}function T(A,f){return A.label?f?p.templateString(A.label,f):A.label:A.step==="all"?"all":A.count+A.step.charAt(0)}function w(A,f,u,h,o){var S=0,R=0,z=u.borderwidth;f.each(function(){var U=b.select(this),X=U.select(".selector-text"),oe=u.font.size*n,se=Math.max(oe*a.lineCount(X),16)+3;R=Math.max(R,se)}),f.each(function(){var U=b.select(this),X=U.select(".selector-rect"),oe=U.select(".selector-text"),se=oe.node()&&e.bBox(oe.node()).width,q=u.font.size*n,K=a.lineCount(oe),G=Math.max(se+10,s.minButtonWidth);U.attr("transform",g(z+S,z)),X.attr({x:0,y:0,width:G,height:R}),a.positionText(oe,G/2,R/2-(K-1)*q/2+3),S+=G+5});var O=A._fullLayout._size,I=O.l+O.w*u.x,F=O.t+O.h*(1-u.y),D="left";p.isRightAnchor(u)&&(I-=S,D="right"),p.isCenterAnchor(u)&&(I-=S/2,D="center");var B="top";p.isBottomAnchor(u)&&(F-=R,B="bottom"),p.isMiddleAnchor(u)&&(F-=R/2,B="middle"),S=Math.ceil(S),R=Math.ceil(R),I=Math.round(I),F=Math.round(F),P.autoMargin(A,h+"-range-selector",{x:u.x,y:u.y,l:S*r[D],r:S*d[D],b:R*d[B],t:R*r[B]}),o.attr("transform",g(I,F))}},{"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axis_ids":558,"../../plots/plots":619,"../../registry":638,"../color":366,"../drawing":388,"./constants":433,"./get_update_object":436,"@plotly/d3":58}],436:[function(c,ae,ie){"use strict";var b=c("d3-time"),k=c("../../lib").titleCase;ae.exports=function(e,p){var g=e._name,a={};if(p.step==="all")a[g+".autorange"]=!0;else{var t=P(e,p);a[g+".range[0]"]=t[0],a[g+".range[1]"]=t[1]}return a};function P(E,e){var p=E.range,g=new Date(E.r2l(p[1])),a=e.step,t=b["utc"+k(a)],i=e.count,n;switch(e.stepmode){case"backward":n=E.l2r(+t.offset(g,-i));break;case"todate":var r=t.offset(g,-i);n=E.l2r(+t.ceil(r));break}var d=p[1];return[n,d]}},{"../../lib":503,"d3-time":122}],437:[function(c,ae,ie){"use strict";ae.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:c("./attributes")}}},layoutAttributes:c("./attributes"),handleDefaults:c("./defaults"),draw:c("./draw")}},{"./attributes":432,"./defaults":434,"./draw":435}],438:[function(c,ae,ie){"use strict";var b=c("../color/attributes");ae.exports={bgcolor:{valType:"color",dflt:b.background,editType:"plot"},bordercolor:{valType:"color",dflt:b.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":365}],439:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axis_ids").list,k=c("../../plots/cartesian/autorange").getAutoRange,P=c("./constants");ae.exports=function(e){for(var p=b(e,"x",!0),g=0;g<p.length;g++){var a=p[g],t=a[P.name];t&&t.visible&&t.autorange&&(t._input.autorange=!0,t._input.range=t.range=k(e,a))}}},{"../../plots/cartesian/autorange":553,"../../plots/cartesian/axis_ids":558,"./constants":440}],440:[function(c,ae,ie){"use strict";ae.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],441:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plot_api/plot_template"),P=c("../../plots/cartesian/axis_ids"),E=c("./attributes"),e=c("./oppaxis_attributes");ae.exports=function(g,a,t){var i=g[t],n=a[t];if(!(i.rangeslider||a._requestRangeslider[n._id]))return;b.isPlainObject(i.rangeslider)||(i.rangeslider={});var r=i.rangeslider,d=k.newContainer(n,"rangeslider");function s(h,o){return b.coerce(r,d,E,h,o)}var m,x;function M(h,o){return b.coerce(m,x,e,h,o)}var v=s("visible");if(!!v){s("bgcolor",a.plot_bgcolor),s("bordercolor"),s("borderwidth"),s("thickness"),s("autorange",!n.isValidRange(r.range)),s("range");var _=a._subplots;if(_)for(var l=_.cartesian.filter(function(h){return h.substr(0,h.indexOf("y"))===P.name2id(t)}).map(function(h){return h.substr(h.indexOf("y"),h.length)}),y=b.simpleMap(l,P.id2name),T=0;T<y.length;T++){var w=y[T];m=r[w]||{},x=k.newContainer(d,w,"yaxis");var A=a[w],f;m.range&&A.isValidRange(m.range)&&(f="fixed");var u=M("rangemode",f);u!=="match"&&M("range",A.range.slice())}d._input=r}}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_ids":558,"./attributes":438,"./oppaxis_attributes":445}],442:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../registry"),P=c("../../plots/plots"),E=c("../../lib"),e=E.strTranslate,p=c("../drawing"),g=c("../color"),a=c("../titles"),t=c("../../plots/cartesian"),i=c("../../plots/cartesian/axis_ids"),n=c("../dragelement"),r=c("../../lib/setcursor"),d=c("./constants");ae.exports=function(A){for(var f=A._fullLayout,u=f._rangeSliderData,h=0;h<u.length;h++){var o=u[h][d.name];o._clipId=o._id+"-"+f._uid}function S(z){return z._name}var R=f._infolayer.selectAll("g."+d.containerClassName).data(u,S);R.exit().each(function(z){var O=z[d.name];f._topdefs.select("#"+O._clipId).remove()}).remove(),u.length!==0&&(R.enter().append("g").classed(d.containerClassName,!0).attr("pointer-events","all"),R.each(function(z){var O=b.select(this),I=z[d.name],F=f[i.id2name(z.anchor)],D=I[i.id2name(z.anchor)];if(I.range){var B=E.simpleMap(I.range,z.r2l),U=E.simpleMap(z.range,z.r2l),X;U[0]<U[1]?X=[Math.min(B[0],U[0]),Math.max(B[1],U[1])]:X=[Math.max(B[0],U[0]),Math.min(B[1],U[1])],I.range=I._input.range=E.simpleMap(X,z.l2r)}z.cleanRange("rangeslider.range");var oe=f._size,se=z.domain;I._width=oe.w*(se[1]-se[0]);var q=Math.round(oe.l+oe.w*se[0]),K=Math.round(oe.t+oe.h*(1-z._counterDomainMin)+(z.side==="bottom"?z._depth:0)+I._offsetShift+d.extraPad);O.attr("transform",e(q,K)),I._rl=E.simpleMap(I.range,z.r2l);var G=I._rl[0],Q=I._rl[1],V=Q-G;if(I.p2d=function(ge){return ge/I._width*V+G},I.d2p=function(ge){return(ge-G)/V*I._width},z.rangebreaks){var H=z.locateBreaks(G,Q);if(H.length){var ee,J,W=0;for(ee=0;ee<H.length;ee++)J=H[ee],W+=J.max-J.min;var re=I._width/(Q-G-W),j=[-re*G];for(ee=0;ee<H.length;ee++)J=H[ee],j.push(j[j.length-1]-re*(J.max-J.min));for(I.d2p=function(ge){for(var pe=j[0],xe=0;xe<H.length;xe++){var Ee=H[xe];if(ge>=Ee.max)pe=j[xe+1];else if(ge<Ee.min)break}return pe+re*ge},ee=0;ee<H.length;ee++)J=H[ee],J.pmin=I.d2p(J.min),J.pmax=I.d2p(J.max);I.p2d=function(ge){for(var pe=j[0],xe=0;xe<H.length;xe++){var Ee=H[xe];if(ge>=Ee.pmax)pe=j[xe+1];else if(ge<Ee.pmin)break}return(ge-pe)/re}}}if(D.rangemode!=="match"){var Z=F.r2l(D.range[0]),ne=F.r2l(D.range[1]),le=ne-Z;I.d2pOppAxis=function(ge){return(ge-Z)/le*I._height}}O.call(M,A,z,I).call(v,A,z,I).call(_,A,z,I).call(y,A,z,I,D).call(T,A,z,I).call(w,A,z,I),s(O,A,z,I),x(O,A,z,I,F,D),z.side==="bottom"&&a.draw(A,z._id+"title",{propContainer:z,propName:z._name+".title",placeholder:f._dfltTitle.x,attributes:{x:z._offset+z._length/2,y:K+I._height+I._offsetShift+10+1.5*z.title.font.size,"text-anchor":"middle"}})}))};function s(A,f,u,h){if(f._context.staticPlot)return;var o=A.select("rect."+d.slideBoxClassName).node(),S=A.select("rect."+d.grabAreaMinClassName).node(),R=A.select("rect."+d.grabAreaMaxClassName).node();function z(){var O=b.event,I=O.target,F=O.clientX||O.touches[0].clientX,D=F-A.node().getBoundingClientRect().left,B=h.d2p(u._rl[0]),U=h.d2p(u._rl[1]),X=n.coverSlip();this.addEventListener("touchmove",oe),this.addEventListener("touchend",se),X.addEventListener("mousemove",oe),X.addEventListener("mouseup",se);function oe(q){var K=q.clientX||q.touches[0].clientX,G=+K-F,Q,V,H;switch(I){case o:H="ew-resize",Q=B+G,V=U+G;break;case S:H="col-resize",Q=B+G,V=U;break;case R:H="col-resize",Q=B,V=U+G;break;default:H="ew-resize",Q=D,V=D+G;break}if(V<Q){var ee=V;V=Q,Q=ee}h._pixelMin=Q,h._pixelMax=V,r(b.select(X),H),m(A,f,u,h)}function se(){X.removeEventListener("mousemove",oe),X.removeEventListener("mouseup",se),this.removeEventListener("touchmove",oe),this.removeEventListener("touchend",se),E.removeElement(X)}}A.on("mousedown",z),A.on("touchstart",z)}function m(A,f,u,h){function o(z){return u.l2r(E.constrain(z,h._rl[0],h._rl[1]))}var S=o(h.p2d(h._pixelMin)),R=o(h.p2d(h._pixelMax));window.requestAnimationFrame(function(){k.call("_guiRelayout",f,u._name+".range",[S,R])})}function x(A,f,u,h,o,S){var R=d.handleWidth/2;function z(q){return E.constrain(q,0,h._width)}function O(q){return E.constrain(q,0,h._height)}function I(q){return E.constrain(q,-R,h._width+R)}var F=z(h.d2p(u._rl[0])),D=z(h.d2p(u._rl[1]));if(A.select("rect."+d.slideBoxClassName).attr("x",F).attr("width",D-F),A.select("rect."+d.maskMinClassName).attr("width",F),A.select("rect."+d.maskMaxClassName).attr("x",D).attr("width",h._width-D),S.rangemode!=="match"){var B=h._height-O(h.d2pOppAxis(o._rl[1])),U=h._height-O(h.d2pOppAxis(o._rl[0]));A.select("rect."+d.maskMinOppAxisClassName).attr("x",F).attr("height",B).attr("width",D-F),A.select("rect."+d.maskMaxOppAxisClassName).attr("x",F).attr("y",U).attr("height",h._height-U).attr("width",D-F),A.select("rect."+d.slideBoxClassName).attr("y",B).attr("height",U-B)}var X=.5,oe=Math.round(I(F-R))-X,se=Math.round(I(D-R))+X;A.select("g."+d.grabberMinClassName).attr("transform",e(oe,X)),A.select("g."+d.grabberMaxClassName).attr("transform",e(se,X))}function M(A,f,u,h){var o=E.ensureSingle(A,"rect",d.bgClassName,function(O){O.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),S=h.borderwidth%2===0?h.borderwidth:h.borderwidth-1,R=-h._offsetShift,z=p.crispRound(f,h.borderwidth);o.attr({width:h._width+S,height:h._height+S,transform:e(R,R),fill:h.bgcolor,stroke:h.bordercolor,"stroke-width":z})}function v(A,f,u,h){var o=f._fullLayout,S=E.ensureSingleById(o._topdefs,"clipPath",h._clipId,function(R){R.append("rect").attr({x:0,y:0})});S.select("rect").attr({width:h._width,height:h._height})}function _(A,f,u,h){var o=f.calcdata,S=A.selectAll("g."+d.rangePlotClassName).data(u._subplotsWith,E.identity);S.enter().append("g").attr("class",function(z){return d.rangePlotClassName+" "+z}).call(p.setClipUrl,h._clipId,f),S.order(),S.exit().remove();var R;S.each(function(z,O){var I=b.select(this),F=O===0,D=i.getFromId(f,z,"y"),B=D._name,U=h[B],X={data:[],layout:{xaxis:{type:u.type,domain:[0,1],range:h.range.slice(),calendar:u.calendar},width:h._width,height:h._height,margin:{t:0,b:0,l:0,r:0}},_context:f._context};u.rangebreaks&&(X.layout.xaxis.rangebreaks=u.rangebreaks),X.layout[B]={type:D.type,domain:[0,1],range:U.rangemode!=="match"?U.range.slice():D.range.slice(),calendar:D.calendar},D.rangebreaks&&(X.layout[B].rangebreaks=D.rangebreaks),P.supplyDefaults(X);var oe=X._fullLayout.xaxis,se=X._fullLayout[B];oe.clearCalc(),oe.setScale(),se.clearCalc(),se.setScale();var q={id:z,plotgroup:I,xaxis:oe,yaxis:se,isRangePlot:!0};F?R=q:(q.mainplot="xy",q.mainplotinfo=R),t.rangePlot(f,q,l(o,z))})}function l(A,f){for(var u=[],h=0;h<A.length;h++){var o=A[h],S=o[0].trace;S.xaxis+S.yaxis===f&&u.push(o)}return u}function y(A,f,u,h,o){var S=E.ensureSingle(A,"rect",d.maskMinClassName,function(I){I.attr({x:0,y:0,"shape-rendering":"crispEdges"})});S.attr("height",h._height).call(g.fill,d.maskColor);var R=E.ensureSingle(A,"rect",d.maskMaxClassName,function(I){I.attr({y:0,"shape-rendering":"crispEdges"})});if(R.attr("height",h._height).call(g.fill,d.maskColor),o.rangemode!=="match"){var z=E.ensureSingle(A,"rect",d.maskMinOppAxisClassName,function(I){I.attr({y:0,"shape-rendering":"crispEdges"})});z.attr("width",h._width).call(g.fill,d.maskOppAxisColor);var O=E.ensureSingle(A,"rect",d.maskMaxOppAxisClassName,function(I){I.attr({y:0,"shape-rendering":"crispEdges"})});O.attr("width",h._width).style("border-top",d.maskOppBorder).call(g.fill,d.maskOppAxisColor)}}function T(A,f,u,h){if(!f._context.staticPlot){var o=E.ensureSingle(A,"rect",d.slideBoxClassName,function(S){S.attr({y:0,cursor:d.slideBoxCursor,"shape-rendering":"crispEdges"})});o.attr({height:h._height,fill:d.slideBoxFill})}}function w(A,f,u,h){var o=E.ensureSingle(A,"g",d.grabberMinClassName),S=E.ensureSingle(A,"g",d.grabberMaxClassName),R={x:0,width:d.handleWidth,rx:d.handleRadius,fill:g.background,stroke:g.defaultLine,"stroke-width":d.handleStrokeWidth,"shape-rendering":"crispEdges"},z={y:Math.round(h._height/4),height:Math.round(h._height/2)},O=E.ensureSingle(o,"rect",d.handleMinClassName,function(U){U.attr(R)});O.attr(z);var I=E.ensureSingle(S,"rect",d.handleMaxClassName,function(U){U.attr(R)});I.attr(z);var F={width:d.grabAreaWidth,x:0,y:0,fill:d.grabAreaFill,cursor:f._context.staticPlot?void 0:d.grabAreaCursor},D=E.ensureSingle(o,"rect",d.grabAreaMinClassName,function(U){U.attr(F)});D.attr("height",h._height);var B=E.ensureSingle(S,"rect",d.grabAreaMaxClassName,function(U){U.attr(F)});B.attr("height",h._height)}},{"../../lib":503,"../../lib/setcursor":524,"../../plots/cartesian":568,"../../plots/cartesian/axis_ids":558,"../../plots/plots":619,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"../titles":464,"./constants":440,"@plotly/d3":58}],443:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axis_ids"),k=c("../../lib/svg_text_utils"),P=c("./constants"),E=c("../../constants/alignment").LINE_SPACING,e=P.name;function p(g){var a=g&&g[e];return a&&a.visible}ie.isVisible=p,ie.makeData=function(g){var a=b.list({_fullLayout:g},"x",!0),t=g.margin,i=[];if(!g._has("gl2d"))for(var n=0;n<a.length;n++){var r=a[n];if(p(r)){i.push(r);var d=r[e];d._id=e+r._id,d._height=(g.height-t.b-t.t)*d.thickness,d._offsetShift=Math.floor(d.borderwidth/2)}}g._rangeSliderData=i},ie.autoMarginOpts=function(g,a){var t=g._fullLayout,i=a[e],n=a._id.charAt(0),r=0,d=0;if(a.side==="bottom"&&(r=a._depth,a.title.text!==t._dfltTitle[n])){d=1.5*a.title.font.size+10+i._offsetShift;var s=(a.title.text.match(k.BR_TAG_ALL)||[]).length;d+=s*a.title.font.size*E}return{x:0,y:a._counterDomainMin,l:0,r:0,t:0,b:i._height+r+Math.max(t.margin.b,d),pad:P.extraPad+i._offsetShift*2}}},{"../../constants/alignment":471,"../../lib/svg_text_utils":529,"../../plots/cartesian/axis_ids":558,"./constants":440}],444:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("./oppaxis_attributes"),E=c("./helpers");ae.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:b.extendFlat({},k,{yaxis:P})}}},layoutAttributes:c("./attributes"),handleDefaults:c("./defaults"),calcAutorange:c("./calc_autorange"),draw:c("./draw"),isVisible:E.isVisible,makeData:E.makeData,autoMarginOpts:E.autoMarginOpts}},{"../../lib":503,"./attributes":438,"./calc_autorange":439,"./defaults":441,"./draw":442,"./helpers":443,"./oppaxis_attributes":445}],445:[function(c,ae,ie){"use strict";ae.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],446:[function(c,ae,ie){"use strict";var b=c("../annotations/attributes"),k=c("../../traces/scatter/attributes").line,P=c("../drawing/attributes").dash,E=c("../../lib/extend").extendFlat,e=c("../../plot_api/plot_template").templatedArray,p=c("../../constants/axis_placeable_objects");ae.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:E({},b.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:E({},b.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:E({},k.color,{editType:"arraydraw"}),width:E({},k.width,{editType:"calc+arraydraw"}),dash:E({},P,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":472,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../traces/scatter/attributes":927,"../annotations/attributes":349,"../drawing/attributes":387}],447:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("./constants"),E=c("./helpers");ae.exports=function(i){var n=i._fullLayout,r=b.filterVisible(n.shapes);if(!(!r.length||!i._fullData.length))for(var d=0;d<r.length;d++){var s=r[d];s._extremes={};var m,x,M=k.getRefType(s.xref),v=k.getRefType(s.yref);if(s.xref!=="paper"&&M!=="domain"){var _=s.xsizemode==="pixel"?s.xanchor:s.x0,l=s.xsizemode==="pixel"?s.xanchor:s.x1;m=k.getFromId(i,s.xref),x=a(m,_,l,s.path,P.paramIsX),x&&(s._extremes[m._id]=k.findExtremes(m,x,e(s)))}if(s.yref!=="paper"&&v!=="domain"){var y=s.ysizemode==="pixel"?s.yanchor:s.y0,T=s.ysizemode==="pixel"?s.yanchor:s.y1;m=k.getFromId(i,s.yref),x=a(m,y,T,s.path,P.paramIsY),x&&(s._extremes[m._id]=k.findExtremes(m,x,p(s)))}}};function e(t){return g(t.line.width,t.xsizemode,t.x0,t.x1,t.path,!1)}function p(t){return g(t.line.width,t.ysizemode,t.y0,t.y1,t.path,!0)}function g(t,i,n,r,d,s){var m=t/2,x=s;if(i==="pixel"){var M=d?E.extractPathCoords(d,s?P.paramIsY:P.paramIsX):[n,r],v=b.aggNums(Math.max,null,M),_=b.aggNums(Math.min,null,M),l=_<0?Math.abs(_)+m:m,y=v>0?v+m:m;return{ppad:m,ppadplus:x?l:y,ppadminus:x?y:l}}else return{ppad:m}}function a(t,i,n,r,d){var s=t.type==="category"||t.type==="multicategory"?t.r2c:t.d2c;if(i!==void 0)return[s(i),s(n)];if(!!r){var m=1/0,x=-1/0,M=r.match(P.segmentRE),v,_,l,y,T;for(t.type==="date"&&(s=E.decodeDate(s)),v=0;v<M.length;v++)_=M[v],l=d[_.charAt(0)].drawn,l!==void 0&&(y=M[v].substr(1).match(P.paramRE),!(!y||y.length<l)&&(T=s(y[l]),T<m&&(m=T),T>x&&(x=T)));if(x>=m)return[m,x]}}},{"../../lib":503,"../../plots/cartesian/axes":554,"./constants":448,"./helpers":457}],448:[function(c,ae,ie){"use strict";ae.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],449:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("../../plots/array_container_defaults"),E=c("./attributes"),e=c("./helpers");ae.exports=function(a,t){P(a,t,{name:"shapes",handleItemDefaults:p})};function p(g,a,t){function i(B,U){return b.coerce(g,a,E,B,U)}var n=i("visible");if(!!n){var r=i("path"),d=r?"path":"rect",s=i("type",d);a.type!=="path"&&delete a.path,i("editable"),i("layer"),i("opacity"),i("fillcolor"),i("fillrule");var m=i("line.width");m&&(i("line.color"),i("line.dash"));for(var x=i("xsizemode"),M=i("ysizemode"),v=["x","y"],_=0;_<2;_++){var l=v[_],y=l+"anchor",T=l==="x"?x:M,w={_fullLayout:t},A,f,u,h=k.coerceRef(g,a,w,l,void 0,"paper"),o=k.getRefType(h);if(o==="range"?(A=k.getFromId(w,h),A._shapeIndices.push(a._index),u=e.rangeToShapePosition(A),f=e.shapePositionToRange(A)):f=u=b.identity,s!=="path"){var S=.25,R=.75,z=l+"0",O=l+"1",I=g[z],F=g[O];g[z]=f(g[z],!0),g[O]=f(g[O],!0),T==="pixel"?(i(z,0),i(O,10)):(k.coercePosition(a,w,i,h,z,S),k.coercePosition(a,w,i,h,O,R)),a[z]=u(a[z]),a[O]=u(a[O]),g[z]=I,g[O]=F}if(T==="pixel"){var D=g[y];g[y]=f(g[y],!0),k.coercePosition(a,w,i,h,y,.25),a[y]=u(a[y]),g[y]=D}}s==="path"?i("path"):b.noneOrAll(g,a,["x0","x1","y0","y1"])}}},{"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"./attributes":446,"./helpers":457}],450:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("../../plots/cartesian/axes"),E=c("./draw_newshape/helpers").readPaths,e=c("./draw_newshape/display_outlines"),p=c("../../plots/cartesian/handle_outline").clearOutlineControllers,g=c("../color"),a=c("../drawing"),t=c("../../plot_api/plot_template").arrayEditor,i=c("../dragelement"),n=c("../../lib/setcursor"),r=c("./constants"),d=c("./helpers");ae.exports={draw:s,drawOne:M,eraseActiveShape:f};function s(u){var h=u._fullLayout;h._shapeUpperLayer.selectAll("path").remove(),h._shapeLowerLayer.selectAll("path").remove();for(var o in h._plots){var S=h._plots[o].shapelayer;S&&S.selectAll("path").remove()}for(var R=0;R<h.shapes.length;R++)h.shapes[R].visible&&M(u,R)}function m(u){return!!u._fullLayout._drawing}function x(u){return!u._context.edits.shapePosition}function M(u,h){u._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+h+'"]').remove();var o=d.makeOptionsAndPlotinfo(u,h),S=o.options,R=o.plotinfo;if(!S._input||S.visible===!1)return;if(S.layer!=="below")O(u._fullLayout._shapeUpperLayer);else if(S.xref==="paper"||S.yref==="paper")O(u._fullLayout._shapeLowerLayer);else if(R._hadPlotinfo){var z=R.mainplotinfo||R;O(z.shapelayer)}else O(u._fullLayout._shapeLowerLayer);function O(I){var F=l(u,S),D={"data-index":h,"fill-rule":S.fillrule,d:F},B=S.opacity,U=S.fillcolor,X=S.line.width?S.line.color:"rgba(0,0,0,0)",oe=S.line.width,se=S.line.dash;!oe&&S.editable===!0&&(oe=5,se="solid");var q=F[F.length-1]!=="Z",K=x(u)&&S.editable&&u._fullLayout._activeShapeIndex===h;K&&(U=q?"rgba(0,0,0,0)":u._fullLayout.activeshape.fillcolor,B=u._fullLayout.activeshape.opacity);var G=I.append("path").attr(D).style("opacity",B).call(g.stroke,X).call(g.fill,U).call(a.dashLine,se,oe);v(G,u,S);var Q;if((K||u._context.edits.shapePosition)&&(Q=t(u.layout,"shapes",S)),K){G.style({cursor:"move"});var V={element:G.node(),plotinfo:R,gd:u,editHelpers:Q,isActiveShape:!0},H=E(F,u);e(H,G,V)}else u._context.edits.shapePosition?_(u,G,S,h,I,Q):S.editable===!0&&G.style("pointer-events",q||g.opacity(U)*B<=.5?"stroke":"all");G.node().addEventListener("click",function(){return w(u,G)})}}function v(u,h,o){var S=(o.xref+o.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");a.setClipUrl(u,S?"clip"+h._fullLayout._uid+S:null,h)}function _(u,h,o,S,R,z){var O=10,I=10,F=o.xsizemode==="pixel",D=o.ysizemode==="pixel",B=o.type==="line",U=o.type==="path",X=z.modifyItem,oe,se,q,K,G,Q,V,H,ee,J,W,re,j,Z,ne,le=P.getFromId(u,o.xref),ge=P.getRefType(o.xref),pe=P.getFromId(u,o.yref),xe=P.getRefType(o.yref),Ee=d.getDataToPixel(u,le,!1,ge),Te=d.getDataToPixel(u,pe,!0,xe),de=d.getPixelToData(u,le,!1,ge),be=d.getPixelToData(u,pe,!0,xe),Le=ke(),De={element:Le.node(),gd:u,prepFn:Ve,doneFn:Ue,clickFn:Ie},ye;i.init(De),Le.node().onmousemove=Qe;function ke(){return B?Oe():h}function Oe(){var Bt=10,St=Math.max(o.line.width,Bt),_t=R.append("g").attr("data-index",S);_t.append("path").attr("d",h.attr("d")).style({cursor:"move","stroke-width":St,"stroke-opacity":"0"});var it={"fill-opacity":"0"},ct=Math.max(St/2,Bt);return _t.append("circle").attr({"data-line-point":"start-point",cx:F?Ee(o.xanchor)+o.x0:Ee(o.x0),cy:D?Te(o.yanchor)-o.y0:Te(o.y0),r:ct}).style(it).classed("cursor-grab",!0),_t.append("circle").attr({"data-line-point":"end-point",cx:F?Ee(o.xanchor)+o.x1:Ee(o.x1),cy:D?Te(o.yanchor)-o.y1:Te(o.y1),r:ct}).style(it).classed("cursor-grab",!0),_t}function Qe(Bt){if(m(u)){ye=null;return}if(B)Bt.target.tagName==="path"?ye="move":ye=Bt.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var St=De.element.getBoundingClientRect(),_t=St.right-St.left,it=St.bottom-St.top,ct=Bt.clientX-St.left,et=Bt.clientY-St.top,Pe=!U&&_t>O&&it>I&&!Bt.shiftKey?i.getCursor(ct/_t,1-et/it):"move";n(h,Pe),ye=Pe.split("-")[0]}}function Ve(Bt){m(u)||(F&&(G=Ee(o.xanchor)),D&&(Q=Te(o.yanchor)),o.type==="path"?ne=o.path:(oe=F?o.x0:Ee(o.x0),se=D?o.y0:Te(o.y0),q=F?o.x1:Ee(o.x1),K=D?o.y1:Te(o.y1)),oe<q?(ee=oe,j="x0",J=q,Z="x1"):(ee=q,j="x1",J=oe,Z="x0"),!D&&se<K||D&&se>K?(V=se,W="y0",H=K,re="y1"):(V=K,W="y1",H=se,re="y0"),Qe(Bt),Rt(R,o),It(h,o,u),De.moveFn=ye==="move"?at:pt,De.altKey=Bt.altKey)}function Ue(){m(u)||(n(h),Mt(R),v(h,u,o),b.call("_guiRelayout",u,z.getUpdateObj()))}function Ie(){m(u)||Mt(R)}function at(Bt,St){if(o.type==="path"){var _t=function(et){return et},it=_t,ct=_t;F?X("xanchor",o.xanchor=de(G+Bt)):(it=function(Pe){return de(Ee(Pe)+Bt)},le&&le.type==="date"&&(it=d.encodeDate(it))),D?X("yanchor",o.yanchor=be(Q+St)):(ct=function(Pe){return be(Te(Pe)+St)},pe&&pe.type==="date"&&(ct=d.encodeDate(ct))),X("path",o.path=T(ne,it,ct))}else F?X("xanchor",o.xanchor=de(G+Bt)):(X("x0",o.x0=de(oe+Bt)),X("x1",o.x1=de(q+Bt))),D?X("yanchor",o.yanchor=be(Q+St)):(X("y0",o.y0=be(se+St)),X("y1",o.y1=be(K+St)));h.attr("d",l(u,o)),Rt(R,o)}function pt(Bt,St){if(U){var _t=function(fr){return fr},it=_t,ct=_t;F?X("xanchor",o.xanchor=de(G+Bt)):(it=function(jr){return de(Ee(jr)+Bt)},le&&le.type==="date"&&(it=d.encodeDate(it))),D?X("yanchor",o.yanchor=be(Q+St)):(ct=function(jr){return be(Te(jr)+St)},pe&&pe.type==="date"&&(ct=d.encodeDate(ct))),X("path",o.path=T(ne,it,ct))}else if(B){if(ye==="resize-over-start-point"){var et=oe+Bt,Pe=D?se-St:se+St;X("x0",o.x0=F?et:de(et)),X("y0",o.y0=D?Pe:be(Pe))}else if(ye==="resize-over-end-point"){var We=q+Bt,je=D?K-St:K+St;X("x1",o.x1=F?We:de(We)),X("y1",o.y1=D?je:be(je))}}else{var nt=function(fr){return ye.indexOf(fr)!==-1},kt=nt("n"),wt=nt("s"),Vt=nt("w"),qt=nt("e"),zt=kt?V+St:V,Ht=wt?H+St:H,$t=Vt?ee+Bt:ee,Qt=qt?J+Bt:J;D&&(kt&&(zt=V-St),wt&&(Ht=H-St)),(!D&&Ht-zt>I||D&&zt-Ht>I)&&(X(W,o[W]=D?zt:be(zt)),X(re,o[re]=D?Ht:be(Ht))),Qt-$t>O&&(X(j,o[j]=F?$t:de($t)),X(Z,o[Z]=F?Qt:de(Qt)))}h.attr("d",l(u,o)),Rt(R,o)}function Rt(Bt,St){(F||D)&&_t();function _t(){var it=St.type!=="path",ct=Bt.selectAll(".visual-cue").data([0]),et=1;ct.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":et}).classed("visual-cue",!0);var Pe=Ee(F?St.xanchor:k.midRange(it?[St.x0,St.x1]:d.extractPathCoords(St.path,r.paramIsX))),We=Te(D?St.yanchor:k.midRange(it?[St.y0,St.y1]:d.extractPathCoords(St.path,r.paramIsY)));if(Pe=d.roundPositionForSharpStrokeRendering(Pe,et),We=d.roundPositionForSharpStrokeRendering(We,et),F&&D){var je="M"+(Pe-1-et)+","+(We-1-et)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";ct.attr("d",je)}else if(F){var nt="M"+(Pe-1-et)+","+(We-9-et)+"v18 h2 v-18 Z";ct.attr("d",nt)}else{var kt="M"+(Pe-9-et)+","+(We-1-et)+"h18 v2 h-18 Z";ct.attr("d",kt)}}}function Mt(Bt){Bt.selectAll(".visual-cue").remove()}function It(Bt,St,_t){var it=St.xref,ct=St.yref,et=P.getFromId(_t,it),Pe=P.getFromId(_t,ct),We="";it!=="paper"&&!et.autorange&&(We+=it),ct!=="paper"&&!Pe.autorange&&(We+=ct),a.setClipUrl(Bt,We?"clip"+_t._fullLayout._uid+We:null,_t)}}function l(u,h){var o=h.type,S=P.getRefType(h.xref),R=P.getRefType(h.yref),z=P.getFromId(u,h.xref),O=P.getFromId(u,h.yref),I=u._fullLayout._size,F,D,B,U,X,oe,se,q;if(z?S==="domain"?D=function(j){return z._offset+z._length*j}:(F=d.shapePositionToRange(z),D=function(j){return z._offset+z.r2p(F(j,!0))}):D=function(j){return I.l+I.w*j},O?R==="domain"?U=function(j){return O._offset+O._length*(1-j)}:(B=d.shapePositionToRange(O),U=function(j){return O._offset+O.r2p(B(j,!0))}):U=function(j){return I.t+I.h*(1-j)},o==="path")return z&&z.type==="date"&&(D=d.decodeDate(D)),O&&O.type==="date"&&(U=d.decodeDate(U)),y(h,D,U);if(h.xsizemode==="pixel"){var K=D(h.xanchor);X=K+h.x0,oe=K+h.x1}else X=D(h.x0),oe=D(h.x1);if(h.ysizemode==="pixel"){var G=U(h.yanchor);se=G-h.y0,q=G-h.y1}else se=U(h.y0),q=U(h.y1);if(o==="line")return"M"+X+","+se+"L"+oe+","+q;if(o==="rect")return"M"+X+","+se+"H"+oe+"V"+q+"H"+X+"Z";var Q=(X+oe)/2,V=(se+q)/2,H=Math.abs(Q-X),ee=Math.abs(V-se),J="A"+H+","+ee,W=Q+H+","+V,re=Q+","+(V-ee);return"M"+W+J+" 0 1,1 "+re+J+" 0 0,1 "+W+"Z"}function y(u,h,o){var S=u.path,R=u.xsizemode,z=u.ysizemode,O=u.xanchor,I=u.yanchor;return S.replace(r.segmentRE,function(F){var D=0,B=F.charAt(0),U=r.paramIsX[B],X=r.paramIsY[B],oe=r.numParams[B],se=F.substr(1).replace(r.paramRE,function(q){return U[D]?R==="pixel"?q=h(O)+Number(q):q=h(q):X[D]&&(z==="pixel"?q=o(I)-Number(q):q=o(q)),D++,D>oe&&(q="X"),q});return D>oe&&(se=se.replace(/[\s,]*X.*/,""),k.log("Ignoring extra params in segment "+F)),B+se})}function T(u,h,o){return u.replace(r.segmentRE,function(S){var R=0,z=S.charAt(0),O=r.paramIsX[z],I=r.paramIsY[z],F=r.numParams[z],D=S.substr(1).replace(r.paramRE,function(B){return R>=F||(O[R]?B=h(B):I[R]&&(B=o(B)),R++),B});return z+D})}function w(u,h){if(!!x(u)){var o=h.node(),S=+o.getAttribute("data-index");if(S>=0){if(S===u._fullLayout._activeShapeIndex){A(u);return}u._fullLayout._activeShapeIndex=S,u._fullLayout._deactivateShape=A,s(u)}}}function A(u){if(!!x(u)){var h=u._fullLayout._activeShapeIndex;h>=0&&(p(u),delete u._fullLayout._activeShapeIndex,s(u))}}function f(u){if(!!x(u)){p(u);var h=u._fullLayout._activeShapeIndex,o=(u.layout||{}).shapes||[];if(h<o.length){for(var S=[],R=0;R<o.length;R++)R!==h&&S.push(o[R]);delete u._fullLayout._activeShapeIndex,b.call("_guiRelayout",u,{shapes:S})}}}},{"../../lib":503,"../../lib/setcursor":524,"../../plot_api/plot_template":543,"../../plots/cartesian/axes":554,"../../plots/cartesian/handle_outline":565,"../../registry":638,"../color":366,"../dragelement":385,"../drawing":388,"./constants":448,"./draw_newshape/display_outlines":454,"./draw_newshape/helpers":455,"./helpers":457}],451:[function(c,ae,ie){"use strict";var b=c("../../drawing/attributes").dash,k=c("../../../lib/extend").extendFlat;ae.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:k({},b,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":493,"../../drawing/attributes":387}],452:[function(c,ae,ie){"use strict";var b=32;ae.exports={CIRCLE_SIDES:b,i000:0,i090:b/4,i180:b/2,i270:b/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],453:[function(c,ae,ie){"use strict";var b=c("../../color");ae.exports=function(P,E,e){e("newshape.drawdirection"),e("newshape.layer"),e("newshape.fillcolor"),e("newshape.fillrule"),e("newshape.opacity");var p=e("newshape.line.width");if(p){var g=(P||{}).plot_bgcolor||"#FFF";e("newshape.line.color",b.contrast(g)),e("newshape.line.dash")}e("activeshape.fillcolor"),e("activeshape.opacity")}},{"../../color":366}],454:[function(c,ae,ie){"use strict";var b=c("../../dragelement"),k=c("../../dragelement/helpers"),P=k.drawMode,E=c("../../../registry"),e=c("./constants"),p=e.i000,g=e.i090,a=e.i180,t=e.i270,i=c("../../../plots/cartesian/handle_outline"),n=i.clearOutlineControllers,r=c("./helpers"),d=r.pointsShapeRectangle,s=r.pointsShapeEllipse,m=r.writePaths,x=c("./newshapes");ae.exports=function v(_,l,y,T){T||(T=0);var w=y.gd;function A(){v(_,l,y,T++),s(_[0])&&f({redrawing:!0})}function f(J){y.isActiveShape=!1;var W=x(l,y);Object.keys(W).length&&E.call((J||{}).redrawing?"relayout":"_guiRelayout",w,W)}var u=y.isActiveShape,h=w._fullLayout,o=h._zoomlayer,S=y.dragmode,R=P(S);R?w._fullLayout._drawing=!0:w._fullLayout._activeShapeIndex>=0&&n(w),l.attr("d",m(_));var z,O,I,F,D;if(u&&!T){D=M([],_);var B=o.append("g").attr("class","outline-controllers");K(B),ee()}function U(J){I=+J.srcElement.getAttribute("data-i"),F=+J.srcElement.getAttribute("data-j"),z[I][F].moveFn=X}function X(J,W){if(!!_.length){var re=D[I][F][1],j=D[I][F][2],Z=_[I],ne=Z.length;if(d(Z)){for(var le=0;le<ne;le++)if(le!==F){var ge=Z[le];ge[1]===Z[F][1]&&(ge[1]=re+J),ge[2]===Z[F][2]&&(ge[2]=j+W)}if(Z[F][1]=re+J,Z[F][2]=j+W,!d(Z))for(var pe=0;pe<ne;pe++)for(var xe=0;xe<Z[pe].length;xe++)Z[pe][xe]=D[I][pe][xe]}else Z[F][1]=re+J,Z[F][2]=j+W;A()}}function oe(){f()}function se(){if(!!_.length&&!!_[I]&&!!_[I].length){for(var J=[],W=0;W<_[I].length;W++)W!==F&&J.push(_[I][W]);J.length>1&&!(J.length===2&&J[1][0]==="Z")&&(F===0&&(J[0][0]="M"),_[I]=J,A(),f())}}function q(J,W){if(J===2){I=+W.srcElement.getAttribute("data-i"),F=+W.srcElement.getAttribute("data-j");var re=_[I];!d(re)&&!s(re)&&se()}}function K(J){z=[];for(var W=0;W<_.length;W++){var re=_[W],j=d(re),Z=!j&&s(re);z[W]=[];for(var ne=0;ne<re.length;ne++)if(re[ne][0]!=="Z"&&!(Z&&ne!==p&&ne!==g&&ne!==a&&ne!==t)){var le=re[ne][1],ge=re[ne][2],pe=J.append("circle").classed("cursor-grab",!0).attr("data-i",W).attr("data-j",ne).attr("cx",le).attr("cy",ge).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});z[W][ne]={element:pe.node(),gd:w,prepFn:U,doneFn:oe,clickFn:q},b.init(z[W][ne])}}}function G(J,W){if(!!_.length)for(var re=0;re<_.length;re++)for(var j=0;j<_[re].length;j++)for(var Z=0;Z+2<_[re][j].length;Z+=2)_[re][j][Z+1]=D[re][j][Z+1]+J,_[re][j][Z+2]=D[re][j][Z+2]+W}function Q(J,W){G(J,W),A()}function V(J){I=+J.srcElement.getAttribute("data-i"),I||(I=0),O[I].moveFn=Q}function H(){f()}function ee(){if(O=[],!!_.length){var J=0;O[J]={element:l[0][0],gd:w,prepFn:V,doneFn:H},b.init(O[J])}}};function M(v,_){for(var l=0;l<_.length;l++){var y=_[l];v[l]=[];for(var T=0;T<y.length;T++){v[l][T]=[];for(var w=0;w<y[T].length;w++)v[l][T][w]=y[T][w]}}return v}},{"../../../plots/cartesian/handle_outline":565,"../../../registry":638,"../../dragelement":385,"../../dragelement/helpers":384,"./constants":452,"./helpers":455,"./newshapes":456}],455:[function(c,ae,ie){"use strict";var b=c("parse-svg-path"),k=c("./constants"),P=k.CIRCLE_SIDES,E=k.SQRT2,e=c("../../../plots/cartesian/helpers"),p=e.p2r,g=e.r2p,a=[0,3,4,5,6,1,2],t=[0,3,4,1,2];ie.writePaths=function(r){var d=r.length;if(!d)return"M0,0Z";for(var s="",m=0;m<d;m++)for(var x=r[m].length,M=0;M<x;M++){var v=r[m][M][0];if(v==="Z")s+="Z";else for(var _=r[m][M].length,l=0;l<_;l++){var y=l;v==="Q"||v==="S"?y=t[l]:v==="C"&&(y=a[l]),s+=r[m][M][y],l>0&&l<_-1&&(s+=",")}}return s},ie.readPaths=function(r,d,s,m){var x=b(r),M=[],v=-1,_=function(){v++,M[v]=[]},l,y=0,T=0,w,A,f=function(){w=y,A=T};f();for(var u=0;u<x.length;u++){var h=[],o,S,R,z,O=x[u][0],I=O;switch(O){case"M":_(),y=+x[u][1],T=+x[u][2],h.push([I,y,T]),f();break;case"Q":case"S":o=+x[u][1],R=+x[u][2],y=+x[u][3],T=+x[u][4],h.push([I,y,T,o,R]);break;case"C":o=+x[u][1],R=+x[u][2],S=+x[u][3],z=+x[u][4],y=+x[u][5],T=+x[u][6],h.push([I,y,T,o,R,S,z]);break;case"T":case"L":y=+x[u][1],T=+x[u][2],h.push([I,y,T]);break;case"H":I="L",y=+x[u][1],h.push([I,y,T]);break;case"V":I="L",T=+x[u][1],h.push([I,y,T]);break;case"A":I="L";var F=+x[u][1],D=+x[u][2];+x[u][4]||(F=-F,D=-D);var B=y-F,U=T;for(l=1;l<=P/2;l++){var X=2*Math.PI*l/P;h.push([I,B+F*Math.cos(X),U+D*Math.sin(X)])}break;case"Z":(y!==w||T!==A)&&(y=w,T=A,h.push([I,y,T]));break}for(var oe=(s||{}).domain,se=d._fullLayout._size,q=s&&s.xsizemode==="pixel",K=s&&s.ysizemode==="pixel",G=m===!1,Q=0;Q<h.length;Q++){for(l=0;l+2<7;l+=2){var V=h[Q][l+1],H=h[Q][l+2];V===void 0||H===void 0||(y=V,T=H,s&&(s.xaxis&&s.xaxis.p2r?(G&&(V-=s.xaxis._offset),q?V=g(s.xaxis,s.xanchor)+V:V=p(s.xaxis,V)):(G&&(V-=se.l),oe?V=oe.x[0]+V/se.w:V=V/se.w),s.yaxis&&s.yaxis.p2r?(G&&(H-=s.yaxis._offset),K?H=g(s.yaxis,s.yanchor)-H:H=p(s.yaxis,H)):(G&&(H-=se.t),oe?H=oe.y[1]-H/se.h:H=1-H/se.h)),h[Q][l+1]=V,h[Q][l+2]=H)}M[v].push(h[Q].slice())}}return M};function i(r,d){return Math.abs(r-d)<=1e-6}function n(r,d){var s=d[1]-r[1],m=d[2]-r[2];return Math.sqrt(s*s+m*m)}ie.pointsShapeRectangle=function(r){var d=r.length;if(d!==5)return!1;for(var s=1;s<3;s++){var m=r[0][s]-r[1][s],x=r[3][s]-r[2][s];if(!i(m,x))return!1;var M=r[0][s]-r[3][s],v=r[1][s]-r[2][s];if(!i(M,v))return!1}return!i(r[0][1],r[1][1])&&!i(r[0][1],r[3][1])?!1:!!(n(r[0],r[1])*n(r[0],r[3]))},ie.pointsShapeEllipse=function(r){var d=r.length;if(d!==P+1)return!1;d=P;for(var s=0;s<d;s++){var m=(d*2-s)%d,x=(d/2+m)%d,M=(d/2+s)%d;if(!i(n(r[s],r[M]),n(r[m],r[x])))return!1}return!0},ie.handleEllipse=function(r,d,s){if(!r)return[d,s];var m=ie.ellipseOver({x0:d[0],y0:d[1],x1:s[0],y1:s[1]}),x=(m.x1+m.x0)/2,M=(m.y1+m.y0)/2,v=(m.x1-m.x0)/2,_=(m.y1-m.y0)/2;v||(v=_=_/E),_||(_=v=v/E);for(var l=[],y=0;y<P;y++){var T=y*2*Math.PI/P;l.push([x+v*Math.cos(T),M+_*Math.sin(T)])}return l},ie.ellipseOver=function(r){var d=r.x0,s=r.y0,m=r.x1,x=r.y1,M=m-d,v=x-s;d-=M,s-=v;var _=(d+m)/2,l=(s+x)/2,y=E;return M*=y,v*=y,{x0:_-M,y0:l-v,x1:_+M,y1:l+v}}},{"../../../plots/cartesian/helpers":566,"./constants":452,"parse-svg-path":250}],456:[function(c,ae,ie){"use strict";var b=c("../../dragelement/helpers"),k=b.drawMode,P=b.openMode,E=c("./constants"),e=E.i000,p=E.i090,g=E.i180,a=E.i270,t=E.cos45,i=E.sin45,n=c("../../../plots/cartesian/helpers"),r=n.p2r,d=n.r2p,s=c("../../../plots/cartesian/handle_outline"),m=s.clearSelect,x=c("./helpers"),M=x.readPaths,v=x.writePaths,_=x.ellipseOver;ae.exports=function(T,w){if(!!T.length){var A=T[0][0];if(!!A){var f=A.getAttribute("d"),u=w.gd,h=u._fullLayout.newshape,o=w.plotinfo,S=o.xaxis,R=o.yaxis,z=!!o.domain||!o.xaxis,O=!!o.domain||!o.yaxis,I=w.isActiveShape,F=w.dragmode,D=(u.layout||{}).shapes||[];if(!k(F)&&I!==void 0){var B=u._fullLayout._activeShapeIndex;if(B<D.length)switch(u._fullLayout.shapes[B].type){case"rect":F="drawrect";break;case"circle":F="drawcircle";break;case"line":F="drawline";break;case"path":var U=D[B].path||"";U[U.length-1]==="Z"?F="drawclosedpath":F="drawopenpath";break}}var X=P(F),oe=M(f,u,o,I),se={editable:!0,xref:z?"paper":S._id,yref:O?"paper":R._id,layer:h.layer,opacity:h.opacity,line:{color:h.line.color,width:h.line.width,dash:h.line.dash}};X||(se.fillcolor=h.fillcolor,se.fillrule=h.fillrule);var q;if(oe.length===1&&(q=oe[0]),q&&F==="drawrect")se.type="rect",se.x0=q[0][1],se.y0=q[0][2],se.x1=q[2][1],se.y1=q[2][2];else if(q&&F==="drawline")se.type="line",se.x0=q[0][1],se.y0=q[0][2],se.x1=q[1][1],se.y1=q[1][2];else if(q&&F==="drawcircle"){se.type="circle";var K=q[e][1],G=q[p][1],Q=q[g][1],V=q[a][1],H=q[e][2],ee=q[p][2],J=q[g][2],W=q[a][2],re=o.xaxis&&(o.xaxis.type==="date"||o.xaxis.type==="log"),j=o.yaxis&&(o.yaxis.type==="date"||o.yaxis.type==="log");re&&(K=d(o.xaxis,K),G=d(o.xaxis,G),Q=d(o.xaxis,Q),V=d(o.xaxis,V)),j&&(H=d(o.yaxis,H),ee=d(o.yaxis,ee),J=d(o.yaxis,J),W=d(o.yaxis,W));var Z=(G+V)/2,ne=(H+J)/2,le=(V-G+Q-K)/2,ge=(W-ee+J-H)/2,pe=_({x0:Z,y0:ne,x1:Z+le*t,y1:ne+ge*i});re&&(pe.x0=r(o.xaxis,pe.x0),pe.x1=r(o.xaxis,pe.x1)),j&&(pe.y0=r(o.yaxis,pe.y0),pe.y1=r(o.yaxis,pe.y1)),se.x0=pe.x0,se.y0=pe.y0,se.x1=pe.x1,se.y1=pe.y1}else se.type="path",S&&R&&l(oe,S,R),se.path=v(oe),q=null;m(u);for(var xe=w.editHelpers,Ee=(xe||{}).modifyItem,Te=[],de=0;de<D.length;de++){var be=u._fullLayout.shapes[de];if(Te[de]=be._input,I!==void 0&&de===u._fullLayout._activeShapeIndex){var Le=se;switch(be.type){case"line":case"rect":case"circle":Ee("x0",Le.x0),Ee("x1",Le.x1),Ee("y0",Le.y0),Ee("y1",Le.y1);break;case"path":Ee("path",Le.path);break}}}return I===void 0?(Te.push(se),Te):xe?xe.getUpdateObj():{}}}};function l(y,T,w){var A=T.type==="date",f=w.type==="date";if(!A&&!f)return y;for(var u=0;u<y.length;u++)for(var h=0;h<y[u].length;h++)for(var o=0;o+2<y[u][h].length;o+=2)A&&(y[u][h][o+1]=y[u][h][o+1].replace(" ","_")),f&&(y[u][h][o+2]=y[u][h][o+2].replace(" ","_"));return y}},{"../../../plots/cartesian/handle_outline":565,"../../../plots/cartesian/helpers":566,"../../dragelement/helpers":384,"./constants":452,"./helpers":455}],457:[function(c,ae,ie){"use strict";var b=c("./constants"),k=c("../../lib");ie.rangeToShapePosition=function(P){return P.type==="log"?P.r2d:function(E){return E}},ie.shapePositionToRange=function(P){return P.type==="log"?P.d2r:function(E){return E}},ie.decodeDate=function(P){return function(E){return E.replace&&(E=E.replace("_"," ")),P(E)}},ie.encodeDate=function(P){return function(E){return P(E).replace(" ","_")}},ie.extractPathCoords=function(P,E){var e=[],p=P.match(b.segmentRE);return p.forEach(function(g){var a=E[g.charAt(0)].drawn;if(a!==void 0){var t=g.substr(1).match(b.paramRE);!t||t.length<a||e.push(k.cleanNumber(t[a]))}}),e},ie.getDataToPixel=function(P,E,e,p){var g=P._fullLayout._size,a;if(E)if(p==="domain")a=function(i){return E._length*(e?1-i:i)+E._offset};else{var t=ie.shapePositionToRange(E);a=function(i){return E._offset+E.r2p(t(i,!0))},E.type==="date"&&(a=ie.decodeDate(a))}else e?a=function(i){return g.t+g.h*(1-i)}:a=function(i){return g.l+g.w*i};return a},ie.getPixelToData=function(P,E,e,p){var g=P._fullLayout._size,a;if(E)if(p==="domain")a=function(i){var n=(i-E._offset)/E._length;return e?1-n:n};else{var t=ie.rangeToShapePosition(E);a=function(i){return t(E.p2r(i-E._offset))}}else e?a=function(i){return 1-(i-g.t)/g.h}:a=function(i){return(i-g.l)/g.w};return a},ie.roundPositionForSharpStrokeRendering=function(P,E){var e=Math.round(E%2)===1,p=Math.round(P);return e?p+.5:p},ie.makeOptionsAndPlotinfo=function(P,E){var e=P._fullLayout.shapes[E]||{},p=P._fullLayout._plots[e.xref+e.yref],g=!!p;return g?p._hadPlotinfo=!0:(p={},e.xref&&e.xref!=="paper"&&(p.xaxis=P._fullLayout[e.xref+"axis"]),e.yref&&e.yref!=="paper"&&(p.yaxis=P._fullLayout[e.yref+"axis"])),p.xsizemode=e.xsizemode,p.ysizemode=e.ysizemode,p.xanchor=e.xanchor,p.yanchor=e.yanchor,{options:e,plotinfo:p}}},{"../../lib":503,"./constants":448}],458:[function(c,ae,ie){"use strict";var b=c("./draw");ae.exports={moduleType:"component",name:"shapes",layoutAttributes:c("./attributes"),supplyLayoutDefaults:c("./defaults"),supplyDrawNewShapeDefaults:c("./draw_newshape/defaults"),includeBasePlot:c("../../plots/cartesian/include_components")("shapes"),calcAutorange:c("./calc_autorange"),draw:b.draw,drawOne:b.drawOne}},{"../../plots/cartesian/include_components":567,"./attributes":446,"./calc_autorange":447,"./defaults":449,"./draw":450,"./draw_newshape/defaults":453}],459:[function(c,ae,ie){"use strict";var b=c("../../plots/font_attributes"),k=c("../../plots/pad_attributes"),P=c("../../lib/extend").extendDeepAll,E=c("../../plot_api/edit_types").overrideAll,e=c("../../plots/animation_attributes"),p=c("../../plot_api/plot_template").templatedArray,g=c("./constants"),a=p("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});ae.exports=E(p("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:a,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:P(k({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:b({})},font:b({}),activebgcolor:{valType:"color",dflt:g.gripBgActiveColor},bgcolor:{valType:"color",dflt:g.railBgColor},bordercolor:{valType:"color",dflt:g.railBorderColor},borderwidth:{valType:"number",min:0,dflt:g.railBorderWidth},ticklen:{valType:"number",min:0,dflt:g.tickLength},tickcolor:{valType:"color",dflt:g.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:g.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/animation_attributes":548,"../../plots/font_attributes":585,"../../plots/pad_attributes":618,"./constants":460}],460:[function(c,ae,ie){"use strict";ae.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],461:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/array_container_defaults"),P=c("./attributes"),E=c("./constants"),e=E.name,p=P.steps;ae.exports=function(i,n){k(i,n,{name:e,handleItemDefaults:g})};function g(t,i,n){function r(l,y){return b.coerce(t,i,P,l,y)}for(var d=k(t,i,{name:"steps",handleItemDefaults:a}),s=0,m=0;m<d.length;m++)d[m].visible&&s++;var x;if(s<2?x=i.visible=!1:x=r("visible"),!!x){i._stepCount=s;var M=i._visibleSteps=b.filterVisible(d),v=r("active");(d[v]||{}).visible||(i.active=M[0]._index),r("x"),r("y"),b.noneOrAll(t,i,["x","y"]),r("xanchor"),r("yanchor"),r("len"),r("lenmode"),r("pad.t"),r("pad.r"),r("pad.b"),r("pad.l"),b.coerceFont(r,"font",n.font);var _=r("currentvalue.visible");_&&(r("currentvalue.xanchor"),r("currentvalue.prefix"),r("currentvalue.suffix"),r("currentvalue.offset"),b.coerceFont(r,"currentvalue.font",i.font)),r("transition.duration"),r("transition.easing"),r("bgcolor"),r("activebgcolor"),r("bordercolor"),r("borderwidth"),r("ticklen"),r("tickwidth"),r("tickcolor"),r("minorticklen")}}function a(t,i){function n(s,m){return b.coerce(t,i,p,s,m)}var r;if(t.method!=="skip"&&!Array.isArray(t.args)?r=i.visible=!1:r=n("visible"),r){n("method"),n("args");var d=n("label","step-"+i._index);n("value",d),n("execute")}}},{"../../lib":503,"../../plots/array_container_defaults":549,"./attributes":459,"./constants":460}],462:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../plots/plots"),P=c("../color"),E=c("../drawing"),e=c("../../lib"),p=e.strTranslate,g=c("../../lib/svg_text_utils"),a=c("../../plot_api/plot_template").arrayEditor,t=c("./constants"),i=c("../../constants/alignment"),n=i.LINE_SPACING,r=i.FROM_TL,d=i.FROM_BR;ae.exports=function(F){var D=F._fullLayout,B=m(D,F),U=D._infolayer.selectAll("g."+t.containerClassName).data(B.length>0?[0]:[]);U.enter().append("g").classed(t.containerClassName,!0).style("cursor","ew-resize");function X(K){K._commandObserver&&(K._commandObserver.remove(),delete K._commandObserver),k.autoMargin(F,s(K))}if(U.exit().each(function(){b.select(this).selectAll("g."+t.groupClassName).each(X)}).remove(),B.length!==0){var oe=U.selectAll("g."+t.groupClassName).data(B,x);oe.enter().append("g").classed(t.groupClassName,!0),oe.exit().each(X).remove();for(var se=0;se<B.length;se++){var q=B[se];M(F,q)}oe.each(function(K){var G=b.select(this);h(K),k.manageCommandObserver(F,K,K._visibleSteps,function(Q){var V=G.data()[0];V.active!==Q.index&&(V._dragging||A(F,G,V,Q.index,!1,!0))}),v(F,b.select(this),K)})}};function s(I){return t.autoMarginIdRoot+I._index}function m(I,F){for(var D=I[t.name],B=[],U=0;U<D.length;U++){var X=D[U];!X.visible||(X._gd=F,B.push(X))}return B}function x(I){return I._index}function M(I,F){var D=E.tester.selectAll("g."+t.labelGroupClass).data(F._visibleSteps);D.enter().append("g").classed(t.labelGroupClass,!0);var B=0,U=0;D.each(function(ee){var J=b.select(this),W=y(J,{step:ee},F),re=W.node();if(re){var j=E.bBox(re);U=Math.max(U,j.height),B=Math.max(B,j.width)}}),D.remove();var X=F._dims={};X.inputAreaWidth=Math.max(t.railWidth,t.gripHeight);var oe=I._fullLayout._size;X.lx=oe.l+oe.w*F.x,X.ly=oe.t+oe.h*(1-F.y),F.lenmode==="fraction"?X.outerLength=Math.round(oe.w*F.len):X.outerLength=F.len,X.inputAreaStart=0,X.inputAreaLength=Math.round(X.outerLength-F.pad.l-F.pad.r);var se=X.inputAreaLength-2*t.stepInset,q=se/(F._stepCount-1),K=B+t.labelPadding;if(X.labelStride=Math.max(1,Math.ceil(K/q)),X.labelHeight=U,X.currentValueMaxWidth=0,X.currentValueHeight=0,X.currentValueTotalHeight=0,X.currentValueMaxLines=1,F.currentvalue.visible){var G=E.tester.append("g");D.each(function(ee){var J=_(G,F,ee.label),W=J.node()&&E.bBox(J.node())||{width:0,height:0},re=g.lineCount(J);X.currentValueMaxWidth=Math.max(X.currentValueMaxWidth,Math.ceil(W.width)),X.currentValueHeight=Math.max(X.currentValueHeight,Math.ceil(W.height)),X.currentValueMaxLines=Math.max(X.currentValueMaxLines,re)}),X.currentValueTotalHeight=X.currentValueHeight+F.currentvalue.offset,G.remove()}X.height=X.currentValueTotalHeight+t.tickOffset+F.ticklen+t.labelOffset+X.labelHeight+F.pad.t+F.pad.b;var Q="left";e.isRightAnchor(F)&&(X.lx-=X.outerLength,Q="right"),e.isCenterAnchor(F)&&(X.lx-=X.outerLength/2,Q="center");var V="top";e.isBottomAnchor(F)&&(X.ly-=X.height,V="bottom"),e.isMiddleAnchor(F)&&(X.ly-=X.height/2,V="middle"),X.outerLength=Math.ceil(X.outerLength),X.height=Math.ceil(X.height),X.lx=Math.round(X.lx),X.ly=Math.round(X.ly);var H={y:F.y,b:X.height*d[V],t:X.height*r[V]};F.lenmode==="fraction"?(H.l=0,H.xl=F.x-F.len*r[Q],H.r=0,H.xr=F.x+F.len*d[Q]):(H.x=F.x,H.l=X.outerLength*r[Q],H.r=X.outerLength*d[Q]),k.autoMargin(I,s(F),H)}function v(I,F,D){(D.steps[D.active]||{}).visible||(D.active=D._visibleSteps[0]._index),F.call(_,D).call(O,D).call(T,D).call(u,D).call(z,I,D).call(l,I,D);var B=D._dims;E.setTranslate(F,B.lx+D.pad.l,B.ly+D.pad.t),F.call(o,D,!1),F.call(_,D)}function _(I,F,D){if(!!F.currentvalue.visible){var B=F._dims,U,X;switch(F.currentvalue.xanchor){case"right":U=B.inputAreaLength-t.currentValueInset-B.currentValueMaxWidth,X="left";break;case"center":U=B.inputAreaLength*.5,X="middle";break;default:U=t.currentValueInset,X="left"}var oe=e.ensureSingle(I,"text",t.labelClass,function(V){V.attr({"text-anchor":X,"data-notex":1})}),se=F.currentvalue.prefix?F.currentvalue.prefix:"";if(typeof D=="string")se+=D;else{var q=F.steps[F.active].label,K=F._gd._fullLayout._meta;K&&(q=e.templateString(q,K)),se+=q}F.currentvalue.suffix&&(se+=F.currentvalue.suffix),oe.call(E.font,F.currentvalue.font).text(se).call(g.convertToTspans,F._gd);var G=g.lineCount(oe),Q=(B.currentValueMaxLines+1-G)*F.currentvalue.font.size*n;return g.positionText(oe,U,Q),oe}}function l(I,F,D){var B=e.ensureSingle(I,"rect",t.gripRectClass,function(U){U.call(f,F,I,D).style("pointer-events","all")});B.attr({width:t.gripWidth,height:t.gripHeight,rx:t.gripRadius,ry:t.gripRadius}).call(P.stroke,D.bordercolor).call(P.fill,D.bgcolor).style("stroke-width",D.borderwidth+"px")}function y(I,F,D){var B=e.ensureSingle(I,"text",t.labelClass,function(oe){oe.attr({"text-anchor":"middle","data-notex":1})}),U=F.step.label,X=D._gd._fullLayout._meta;return X&&(U=e.templateString(U,X)),B.call(E.font,D.font).text(U).call(g.convertToTspans,D._gd),B}function T(I,F){var D=e.ensureSingle(I,"g",t.labelsClass),B=F._dims,U=D.selectAll("g."+t.labelGroupClass).data(B.labelSteps);U.enter().append("g").classed(t.labelGroupClass,!0),U.exit().remove(),U.each(function(X){var oe=b.select(this);oe.call(y,X,F),E.setTranslate(oe,S(F,X.fraction),t.tickOffset+F.ticklen+F.font.size*n+t.labelOffset+B.currentValueTotalHeight)})}function w(I,F,D,B,U){var X=Math.round(B*(D._stepCount-1)),oe=D._visibleSteps[X]._index;oe!==D.active&&A(I,F,D,oe,!0,U)}function A(I,F,D,B,U,X){var oe=D.active;D.active=B,a(I.layout,t.name,D).applyUpdate("active",B);var se=D.steps[D.active];F.call(o,D,X),F.call(_,D),I.emit("plotly_sliderchange",{slider:D,step:D.steps[D.active],interaction:U,previousActive:oe}),se&&se.method&&U&&(F._nextMethod?(F._nextMethod.step=se,F._nextMethod.doCallback=U,F._nextMethod.doTransition=X):(F._nextMethod={step:se,doCallback:U,doTransition:X},F._nextMethodRaf=window.requestAnimationFrame(function(){var q=F._nextMethod.step;!q.method||(q.execute&&k.executeAPICommand(I,q.method,q.args),F._nextMethod=null,F._nextMethodRaf=null)})))}function f(I,F,D){var B=D.node(),U=b.select(F);function X(){return D.data()[0]}function oe(){var se=X();F.emit("plotly_sliderstart",{slider:se});var q=D.select("."+t.gripRectClass);b.event.stopPropagation(),b.event.preventDefault(),q.call(P.fill,se.activebgcolor);var K=R(se,b.mouse(B)[0]);w(F,D,se,K,!0),se._dragging=!0;function G(){var V=X(),H=R(V,b.mouse(B)[0]);w(F,D,V,H,!1)}U.on("mousemove",G),U.on("touchmove",G);function Q(){var V=X();V._dragging=!1,q.call(P.fill,V.bgcolor),U.on("mouseup",null),U.on("mousemove",null),U.on("touchend",null),U.on("touchmove",null),F.emit("plotly_sliderend",{slider:V,step:V.steps[V.active]})}U.on("mouseup",Q),U.on("touchend",Q)}I.on("mousedown",oe),I.on("touchstart",oe)}function u(I,F){var D=I.selectAll("rect."+t.tickRectClass).data(F._visibleSteps),B=F._dims;D.enter().append("rect").classed(t.tickRectClass,!0),D.exit().remove(),D.attr({width:F.tickwidth+"px","shape-rendering":"crispEdges"}),D.each(function(U,X){var oe=X%B.labelStride===0,se=b.select(this);se.attr({height:oe?F.ticklen:F.minorticklen}).call(P.fill,F.tickcolor),E.setTranslate(se,S(F,X/(F._stepCount-1))-.5*F.tickwidth,(oe?t.tickOffset:t.minorTickOffset)+B.currentValueTotalHeight)})}function h(I){var F=I._dims;F.labelSteps=[];for(var D=I._stepCount,B=0;B<D;B+=F.labelStride)F.labelSteps.push({fraction:B/(D-1),step:I._visibleSteps[B]})}function o(I,F,D){for(var B=I.select("rect."+t.gripRectClass),U=0,X=0;X<F._stepCount;X++)if(F._visibleSteps[X]._index===F.active){U=X;break}var oe=S(F,U/(F._stepCount-1));if(!F._invokingCommand){var se=B;D&&F.transition.duration>0&&(se=se.transition().duration(F.transition.duration).ease(F.transition.easing)),se.attr("transform",p(oe-t.gripWidth*.5,F._dims.currentValueTotalHeight))}}function S(I,F){var D=I._dims;return D.inputAreaStart+t.stepInset+(D.inputAreaLength-2*t.stepInset)*Math.min(1,Math.max(0,F))}function R(I,F){var D=I._dims;return Math.min(1,Math.max(0,(F-t.stepInset-D.inputAreaStart)/(D.inputAreaLength-2*t.stepInset-2*D.inputAreaStart)))}function z(I,F,D){var B=D._dims,U=e.ensureSingle(I,"rect",t.railTouchRectClass,function(X){X.call(f,F,I,D).style("pointer-events","all")});U.attr({width:B.inputAreaLength,height:Math.max(B.inputAreaWidth,t.tickOffset+D.ticklen+B.labelHeight)}).call(P.fill,D.bgcolor).attr("opacity",0),E.setTranslate(U,0,B.currentValueTotalHeight)}function O(I,F){var D=F._dims,B=D.inputAreaLength-t.railInset*2,U=e.ensureSingle(I,"rect",t.railRectClass);U.attr({width:B,height:t.railWidth,rx:t.railRadius,ry:t.railRadius,"shape-rendering":"crispEdges"}).call(P.stroke,F.bordercolor).call(P.fill,F.bgcolor).style("stroke-width",F.borderwidth+"px"),E.setTranslate(U,t.railInset,(D.inputAreaWidth-t.railWidth)*.5+D.currentValueTotalHeight)}},{"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plot_api/plot_template":543,"../../plots/plots":619,"../color":366,"../drawing":388,"./constants":460,"@plotly/d3":58}],463:[function(c,ae,ie){"use strict";var b=c("./constants");ae.exports={moduleType:"component",name:b.name,layoutAttributes:c("./attributes"),supplyLayoutDefaults:c("./defaults"),draw:c("./draw")}},{"./attributes":459,"./constants":460,"./defaults":461,"./draw":462}],464:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=c("../../plots/plots"),E=c("../../registry"),e=c("../../lib"),p=e.strTranslate,g=c("../drawing"),a=c("../color"),t=c("../../lib/svg_text_utils"),i=c("../../constants/interactions"),n=c("../../constants/alignment").OPPOSITE_SIDE,r=/ [XY][0-9]* /;function d(s,m,x){var M=x.propContainer,v=x.propName,_=x.placeholder,l=x.traceIndex,y=x.avoid||{},T=x.attributes,w=x.transform,A=x.containerGroup,f=s._fullLayout,u=1,h=!1,o=M.title,S=(o&&o.text?o.text:"").trim(),R=o&&o.font?o.font:{},z=R.family,O=R.size,I=R.color,F;v==="title.text"?F="titleText":v.indexOf("axis")!==-1?F="axisTitleText":v.indexOf("colorbar"!==-1)&&(F="colorbarTitleText");var D=s._context.edits[F];S===""?u=0:S.replace(r," % ")===_.replace(r," % ")&&(u=.2,h=!0,D||(S="")),x._meta?S=e.templateString(S,x._meta):f._meta&&(S=e.templateString(S,f._meta));var B=S||D,U;A||(A=e.ensureSingle(f._infolayer,"g","g-"+m),U=f._hColorbarMoveTitle);var X=A.selectAll("text").data(B?[0]:[]);if(X.enter().append("text"),X.text(S).attr("class",m),X.exit().remove(),!B)return A;function oe(G){e.syncOrAsync([se,q],G)}function se(G){var Q;return!w&&U&&(w={}),w?(Q="",w.rotate&&(Q+="rotate("+[w.rotate,T.x,T.y]+")"),(w.offset||U)&&(Q+=p(0,(w.offset||0)-(U||0)))):Q=null,G.attr("transform",Q),G.style({"font-family":z,"font-size":b.round(O,2)+"px",fill:a.rgb(I),opacity:u*a.opacity(I),"font-weight":P.fontWeight}).attr(T).call(t.convertToTspans,s),P.previousPromises(s)}function q(G){var Q=b.select(G.node().parentNode);if(y&&y.selection&&y.side&&S){Q.attr("transform",null);var V=n[y.side],H=y.side==="left"||y.side==="top"?-1:1,ee=k(y.pad)?y.pad:2,J=g.bBox(Q.node()),W={left:0,top:0,right:f.width,bottom:f.height},re=y.maxShift||H*(W[y.side]-J[y.side]),j=0;if(re<0)j=re;else{var Z=y.offsetLeft||0,ne=y.offsetTop||0;J.left-=Z,J.right-=Z,J.top-=ne,J.bottom-=ne,y.selection.each(function(){var ge=g.bBox(this);e.bBoxIntersect(J,ge,ee)&&(j=Math.max(j,H*(ge[y.side]-J[V])+ee))}),j=Math.min(re,j)}if(j>0||re<0){var le={left:[-j,0],right:[j,0],top:[0,-j],bottom:[0,j]}[y.side];Q.attr("transform",p(le[0],le[1]))}}}X.call(oe);function K(){u=0,h=!0,X.text(_).on("mouseover.opacity",function(){b.select(this).transition().duration(i.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){b.select(this).transition().duration(i.HIDE_PLACEHOLDER).style("opacity",0)})}return D&&(S?X.on(".opacity",null):K(),X.call(t.makeEditable,{gd:s}).on("edit",function(G){l!==void 0?E.call("_guiRestyle",s,v,G,l):E.call("_guiRelayout",s,v,G)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call(oe)}).on("input",function(G){this.text(G||" ").call(t.positionText,T.x,T.y)})),X.classed("js-placeholder",h),A}ae.exports={draw:d}},{"../../constants/alignment":471,"../../constants/interactions":478,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../../registry":638,"../color":366,"../drawing":388,"@plotly/d3":58,"fast-isnumeric":190}],465:[function(c,ae,ie){"use strict";var b=c("../../plots/font_attributes"),k=c("../color/attributes"),P=c("../../lib/extend").extendFlat,E=c("../../plot_api/edit_types").overrideAll,e=c("../../plots/pad_attributes"),p=c("../../plot_api/plot_template").templatedArray,g=p("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});ae.exports=E(p("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:g,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:P(e({editType:"arraydraw"}),{}),font:b({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:k.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/font_attributes":585,"../../plots/pad_attributes":618,"../color/attributes":365}],466:[function(c,ae,ie){"use strict";ae.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],467:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/array_container_defaults"),P=c("./attributes"),E=c("./constants"),e=E.name,p=P.buttons;ae.exports=function(i,n){var r={name:e,handleItemDefaults:g};k(i,n,r)};function g(t,i,n){function r(m,x){return b.coerce(t,i,P,m,x)}var d=k(t,i,{name:"buttons",handleItemDefaults:a}),s=r("visible",d.length>0);!s||(r("active"),r("direction"),r("type"),r("showactive"),r("x"),r("y"),b.noneOrAll(t,i,["x","y"]),r("xanchor"),r("yanchor"),r("pad.t"),r("pad.r"),r("pad.b"),r("pad.l"),b.coerceFont(r,"font",n.font),r("bgcolor",n.paper_bgcolor),r("bordercolor"),r("borderwidth"))}function a(t,i){function n(d,s){return b.coerce(t,i,p,d,s)}var r=n("visible",t.method==="skip"||Array.isArray(t.args));r&&(n("method"),n("args"),n("args2"),n("label"),n("execute"))}},{"../../lib":503,"../../plots/array_container_defaults":549,"./attributes":465,"./constants":466}],468:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../plots/plots"),P=c("../color"),E=c("../drawing"),e=c("../../lib"),p=c("../../lib/svg_text_utils"),g=c("../../plot_api/plot_template").arrayEditor,a=c("../../constants/alignment").LINE_SPACING,t=c("./constants"),i=c("./scrollbox");ae.exports=function(R){var z=R._fullLayout,O=e.filterVisible(z[t.name]);function I(q){k.autoMargin(R,u(q))}var F=z._menulayer.selectAll("g."+t.containerClassName).data(O.length>0?[0]:[]);if(F.enter().append("g").classed(t.containerClassName,!0).style("cursor","pointer"),F.exit().each(function(){b.select(this).selectAll("g."+t.headerGroupClassName).each(I)}).remove(),O.length!==0){var D=F.selectAll("g."+t.headerGroupClassName).data(O,n);D.enter().append("g").classed(t.headerGroupClassName,!0);for(var B=e.ensureSingle(F,"g",t.dropdownButtonGroupClassName,function(q){q.style("pointer-events","all")}),U=0;U<O.length;U++){var X=O[U];f(R,X)}var oe="updatemenus"+z._uid,se=new i(R,B,oe);D.enter().size()&&(B.node().parentNode.appendChild(B.node()),B.call(o)),D.exit().each(function(q){B.call(o),I(q)}).remove(),D.each(function(q){var K=b.select(this),G=q.type==="dropdown"?B:null;k.manageCommandObserver(R,q,q.buttons,function(Q){s(R,q,q.buttons[Q.index],K,G,se,Q.index,!0)}),q.type==="dropdown"?(m(R,K,B,se,q),d(B,q)&&x(R,K,B,se,q)):x(R,K,null,null,q)})}};function n(S){return S._index}function r(S){return+S.attr(t.menuIndexAttrName)==-1}function d(S,R){return+S.attr(t.menuIndexAttrName)===R._index}function s(S,R,z,O,I,F,D,B){R.active=D,g(S.layout,t.name,R).applyUpdate("active",D),R.type==="buttons"?x(S,O,null,null,R):R.type==="dropdown"&&(I.attr(t.menuIndexAttrName,"-1"),m(S,O,I,F,R),B||x(S,O,I,F,R))}function m(S,R,z,O,I){var F=e.ensureSingle(R,"g",t.headerClassName,function(q){q.style("pointer-events","all")}),D=I._dims,B=I.active,U=I.buttons[B]||t.blankHeaderOpts,X={y:I.pad.t,yPad:0,x:I.pad.l,xPad:0,index:0},oe={width:D.headerWidth,height:D.headerHeight};F.call(_,I,U,S).call(h,I,X,oe);var se=e.ensureSingle(R,"text",t.headerArrowClassName,function(q){q.attr("text-anchor","end").call(E.font,I.font).text(t.arrowSymbol[I.direction])});se.attr({x:D.headerWidth-t.arrowOffsetX+I.pad.l,y:D.headerHeight/2+t.textOffsetY+I.pad.t}),F.on("click",function(){z.call(o,String(d(z,I)?-1:I._index)),x(S,R,z,O,I)}),F.on("mouseover",function(){F.call(w)}),F.on("mouseout",function(){F.call(A,I)}),E.setTranslate(R,D.lx,D.ly)}function x(S,R,z,O,I){z||(z=R,z.attr("pointer-events","all"));var F=!r(z)||I.type==="buttons"?I.buttons:[],D=I.type==="dropdown"?t.dropdownButtonClassName:t.buttonClassName,B=z.selectAll("g."+D).data(e.filterVisible(F)),U=B.enter().append("g").classed(D,!0),X=B.exit();I.type==="dropdown"?(U.attr("opacity","0").transition().attr("opacity","1"),X.transition().attr("opacity","0").remove()):X.remove();var oe=0,se=0,q=I._dims,K=["up","down"].indexOf(I.direction)!==-1;I.type==="dropdown"&&(K?se=q.headerHeight+t.gapButtonHeader:oe=q.headerWidth+t.gapButtonHeader),I.type==="dropdown"&&I.direction==="up"&&(se=-t.gapButtonHeader+t.gapButton-q.openHeight),I.type==="dropdown"&&I.direction==="left"&&(oe=-t.gapButtonHeader+t.gapButton-q.openWidth);var G={x:q.lx+oe+I.pad.l,y:q.ly+se+I.pad.t,yPad:t.gapButton,xPad:t.gapButton,index:0},Q={l:G.x+I.borderwidth,t:G.y+I.borderwidth};B.each(function(V,H){var ee=b.select(this);ee.call(_,I,V,S).call(h,I,G),ee.on("click",function(){b.event.defaultPrevented||(V.execute&&(V.args2&&I.active===H?(s(S,I,V,R,z,O,-1),k.executeAPICommand(S,V.method,V.args2)):(s(S,I,V,R,z,O,H),k.executeAPICommand(S,V.method,V.args))),S.emit("plotly_buttonclicked",{menu:I,button:V,active:I.active}))}),ee.on("mouseover",function(){ee.call(w)}),ee.on("mouseout",function(){ee.call(A,I),B.call(T,I)})}),B.call(T,I),K?(Q.w=Math.max(q.openWidth,q.headerWidth),Q.h=G.y-Q.t):(Q.w=G.x-Q.l,Q.h=Math.max(q.openHeight,q.headerHeight)),Q.direction=I.direction,O&&(B.size()?M(S,R,z,O,I,Q):v(O))}function M(S,R,z,O,I,F){var D=I.direction,B=D==="up"||D==="down",U=I._dims,X=I.active,oe,se,q;if(B)for(se=0,q=0;q<X;q++)se+=U.heights[q]+t.gapButton;else for(oe=0,q=0;q<X;q++)oe+=U.widths[q]+t.gapButton;O.enable(F,oe,se),O.hbar&&O.hbar.attr("opacity","0").transition().attr("opacity","1"),O.vbar&&O.vbar.attr("opacity","0").transition().attr("opacity","1")}function v(S){var R=!!S.hbar,z=!!S.vbar;R&&S.hbar.transition().attr("opacity","0").each("end",function(){R=!1,z||S.disable()}),z&&S.vbar.transition().attr("opacity","0").each("end",function(){z=!1,R||S.disable()})}function _(S,R,z,O){S.call(l,R).call(y,R,z,O)}function l(S,R){var z=e.ensureSingle(S,"rect",t.itemRectClassName,function(O){O.attr({rx:t.rx,ry:t.ry,"shape-rendering":"crispEdges"})});z.call(P.stroke,R.bordercolor).call(P.fill,R.bgcolor).style("stroke-width",R.borderwidth+"px")}function y(S,R,z,O){var I=e.ensureSingle(S,"text",t.itemTextClassName,function(B){B.attr({"text-anchor":"start","data-notex":1})}),F=z.label,D=O._fullLayout._meta;D&&(F=e.templateString(F,D)),I.call(E.font,R.font).text(F).call(p.convertToTspans,O)}function T(S,R){var z=R.active;S.each(function(O,I){var F=b.select(this);I===z&&R.showactive&&F.select("rect."+t.itemRectClassName).call(P.fill,t.activeColor)})}function w(S){S.select("rect."+t.itemRectClassName).call(P.fill,t.hoverColor)}function A(S,R){S.select("rect."+t.itemRectClassName).call(P.fill,R.bgcolor)}function f(S,R){var z=R._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},O=E.tester.selectAll("g."+t.dropdownButtonClassName).data(e.filterVisible(R.buttons));O.enter().append("g").classed(t.dropdownButtonClassName,!0);var I=["up","down"].indexOf(R.direction)!==-1;O.each(function(oe,se){var q=b.select(this);q.call(_,R,oe,S);var K=q.select("."+t.itemTextClassName),G=K.node()&&E.bBox(K.node()).width,Q=Math.max(G+t.textPadX,t.minWidth),V=R.font.size*a,H=p.lineCount(K),ee=Math.max(V*H,t.minHeight)+t.textOffsetY;ee=Math.ceil(ee),Q=Math.ceil(Q),z.widths[se]=Q,z.heights[se]=ee,z.height1=Math.max(z.height1,ee),z.width1=Math.max(z.width1,Q),I?(z.totalWidth=Math.max(z.totalWidth,Q),z.openWidth=z.totalWidth,z.totalHeight+=ee+t.gapButton,z.openHeight+=ee+t.gapButton):(z.totalWidth+=Q+t.gapButton,z.openWidth+=Q+t.gapButton,z.totalHeight=Math.max(z.totalHeight,ee),z.openHeight=z.totalHeight)}),I?z.totalHeight-=t.gapButton:z.totalWidth-=t.gapButton,z.headerWidth=z.width1+t.arrowPadX,z.headerHeight=z.height1,R.type==="dropdown"&&(I?(z.width1+=t.arrowPadX,z.totalHeight=z.height1):z.totalWidth=z.width1,z.totalWidth+=t.arrowPadX),O.remove();var F=z.totalWidth+R.pad.l+R.pad.r,D=z.totalHeight+R.pad.t+R.pad.b,B=S._fullLayout._size;z.lx=B.l+B.w*R.x,z.ly=B.t+B.h*(1-R.y);var U="left";e.isRightAnchor(R)&&(z.lx-=F,U="right"),e.isCenterAnchor(R)&&(z.lx-=F/2,U="center");var X="top";e.isBottomAnchor(R)&&(z.ly-=D,X="bottom"),e.isMiddleAnchor(R)&&(z.ly-=D/2,X="middle"),z.totalWidth=Math.ceil(z.totalWidth),z.totalHeight=Math.ceil(z.totalHeight),z.lx=Math.round(z.lx),z.ly=Math.round(z.ly),k.autoMargin(S,u(R),{x:R.x,y:R.y,l:F*({right:1,center:.5}[U]||0),r:F*({left:1,center:.5}[U]||0),b:D*({top:1,middle:.5}[X]||0),t:D*({bottom:1,middle:.5}[X]||0)})}function u(S){return t.autoMarginIdRoot+S._index}function h(S,R,z,O){O=O||{};var I=S.select("."+t.itemRectClassName),F=S.select("."+t.itemTextClassName),D=R.borderwidth,B=z.index,U=R._dims;E.setTranslate(S,D+z.x,D+z.y);var X=["up","down"].indexOf(R.direction)!==-1,oe=O.height||(X?U.heights[B]:U.height1);I.attr({x:0,y:0,width:O.width||(X?U.width1:U.widths[B]),height:oe});var se=R.font.size*a,q=p.lineCount(F),K=(q-1)*se/2;p.positionText(F,t.textOffsetX,oe/2-K+t.textOffsetY),X?z.y+=U.heights[B]+z.yPad:z.x+=U.widths[B]+z.xPad,z.index++}function o(S,R){S.attr(t.menuIndexAttrName,R||"-1").selectAll("g."+t.dropdownButtonClassName).remove()}},{"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plot_api/plot_template":543,"../../plots/plots":619,"../color":366,"../drawing":388,"./constants":466,"./scrollbox":470,"@plotly/d3":58}],469:[function(c,ae,ie){arguments[4][463][0].apply(ie,arguments)},{"./attributes":465,"./constants":466,"./defaults":467,"./draw":468,dup:463}],470:[function(c,ae,ie){"use strict";ae.exports=e;var b=c("@plotly/d3"),k=c("../color"),P=c("../drawing"),E=c("../../lib");function e(p,g,a){this.gd=p,this.container=g,this.id=a,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(g,a,t){var i=this.gd._fullLayout,n=i.width,r=i.height;this.position=g;var d=this.position.l,s=this.position.w,m=this.position.t,x=this.position.h,M=this.position.direction,v=M==="down",_=M==="left",l=M==="right",y=M==="up",T=s,w=x,A,f,u,h;!v&&!_&&!l&&!y&&(this.position.direction="down",v=!0);var o=v||y;o?(A=d,f=A+T,v?(u=m,h=Math.min(u+w,r),w=h-u):(h=m+w,u=Math.max(h-w,0),w=h-u)):(u=m,h=u+w,_?(f=d+T,A=Math.max(f-T,0),T=f-A):(A=d,f=Math.min(A+T,n),T=f-A)),this._box={l:A,t:u,w:T,h:w};var S=s>T,R=e.barLength+2*e.barPad,z=e.barWidth+2*e.barPad,O=d,I=m+x;I+z>r&&(I=r-z);var F=this.container.selectAll("rect.scrollbar-horizontal").data(S?[0]:[]);F.exit().on(".drag",null).remove(),F.enter().append("rect").classed("scrollbar-horizontal",!0).call(k.fill,e.barColor),S?(this.hbar=F.attr({rx:e.barRadius,ry:e.barRadius,x:O,y:I,width:R,height:z}),this._hbarXMin=O+R/2,this._hbarTranslateMax=T-R):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var D=x>w,B=e.barWidth+2*e.barPad,U=e.barLength+2*e.barPad,X=d+s,oe=m;X+B>n&&(X=n-B);var se=this.container.selectAll("rect.scrollbar-vertical").data(D?[0]:[]);se.exit().on(".drag",null).remove(),se.enter().append("rect").classed("scrollbar-vertical",!0).call(k.fill,e.barColor),D?(this.vbar=se.attr({rx:e.barRadius,ry:e.barRadius,x:X,y:oe,width:B,height:U}),this._vbarYMin=oe+U/2,this._vbarTranslateMax=w-U):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var q=this.id,K=A-.5,G=D?f+B+.5:f+.5,Q=u-.5,V=S?h+z+.5:h+.5,H=i._topdefs.selectAll("#"+q).data(S||D?[0]:[]);if(H.exit().remove(),H.enter().append("clipPath").attr("id",q).append("rect"),S||D?(this._clipRect=H.select("rect").attr({x:Math.floor(K),y:Math.floor(Q),width:Math.ceil(G)-Math.floor(K),height:Math.ceil(V)-Math.floor(Q)}),this.container.call(P.setClipUrl,q,this.gd),this.bg.attr({x:d,y:m,width:s,height:x})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(P.setClipUrl,null),delete this._clipRect),S||D){var ee=b.behavior.drag().on("dragstart",function(){b.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(ee);var J=b.behavior.drag().on("dragstart",function(){b.event.sourceEvent.preventDefault(),b.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));S&&this.hbar.on(".drag",null).call(J),D&&this.vbar.on(".drag",null).call(J)}this.setTranslate(a,t)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(P.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var g=this.translateX,a=this.translateY;this.hbar&&(g-=b.event.dx),this.vbar&&(a-=b.event.dy),this.setTranslate(g,a)},e.prototype._onBoxWheel=function(){var g=this.translateX,a=this.translateY;this.hbar&&(g+=b.event.deltaY),this.vbar&&(a+=b.event.deltaY),this.setTranslate(g,a)},e.prototype._onBarDrag=function(){var g=this.translateX,a=this.translateY;if(this.hbar){var t=g+this._hbarXMin,i=t+this._hbarTranslateMax,n=E.constrain(b.event.x,t,i),r=(n-t)/(i-t),d=this.position.w-this._box.w;g=r*d}if(this.vbar){var s=a+this._vbarYMin,m=s+this._vbarTranslateMax,x=E.constrain(b.event.y,s,m),M=(x-s)/(m-s),v=this.position.h-this._box.h;a=M*v}this.setTranslate(g,a)},e.prototype.setTranslate=function(g,a){var t=this.position.w-this._box.w,i=this.position.h-this._box.h;if(g=E.constrain(g||0,0,t),a=E.constrain(a||0,0,i),this.translateX=g,this.translateY=a,this.container.call(P.setTranslate,this._box.l-this.position.l-g,this._box.t-this.position.t-a),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+g-.5),y:Math.floor(this.position.t+a-.5)}),this.hbar){var n=g/t;this.hbar.call(P.setTranslate,g+n*this._hbarTranslateMax,a)}if(this.vbar){var r=a/i;this.vbar.call(P.setTranslate,g,a+r*this._vbarTranslateMax)}}},{"../../lib":503,"../color":366,"../drawing":388,"@plotly/d3":58}],471:[function(c,ae,ie){"use strict";ae.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],472:[function(c,ae,ie){"use strict";ae.exports={axisRefDescription:function(b,k,P){return["If set to a",b,"axis id (e.g. *"+b+"* or","*"+b+"2*), the `"+b+"` position refers to a",b,"coordinate. If set to *paper*, the `"+b+"`","position refers to the distance from the",k,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",k,"("+P+"). If set to a",b,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",k,"of the domain of that axis: e.g.,","*"+b+"2 domain* refers to the domain of the second",b," axis and a",b,"position of 0.5 refers to the","point between the",k,"and the",P,"of the domain of the","second",b,"axis."].join(" ")}}},{}],473:[function(c,ae,ie){"use strict";ae.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],474:[function(c,ae,ie){"use strict";ae.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],475:[function(c,ae,ie){"use strict";ae.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],476:[function(c,ae,ie){"use strict";ae.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],477:[function(c,ae,ie){"use strict";ae.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],478:[function(c,ae,ie){"use strict";ae.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],479:[function(c,ae,ie){"use strict";ae.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE*1e-4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:1-1e-6,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],480:[function(c,ae,ie){"use strict";ie.xmlns="http://www.w3.org/2000/xmlns/",ie.svg="http://www.w3.org/2000/svg",ie.xlink="http://www.w3.org/1999/xlink",ie.svgAttrs={xmlns:ie.svg,"xmlns:xlink":ie.xlink}},{}],481:[function(c,ae,ie){"use strict";ie.version=c("./version").version,c("native-promise-only"),c("../build/plotcss");for(var b=c("./registry"),k=ie.register=b.register,P=c("./plot_api"),E=Object.keys(P),e=0;e<E.length;e++){var p=E[e];p.charAt(0)!=="_"&&(ie[p]=P[p]),k({moduleType:"apiMethod",name:p,fn:P[p]})}k(c("./traces/scatter")),k([c("./components/legend"),c("./components/fx"),c("./components/annotations"),c("./components/annotations3d"),c("./components/shapes"),c("./components/images"),c("./components/updatemenus"),c("./components/sliders"),c("./components/rangeslider"),c("./components/rangeselector"),c("./components/grid"),c("./components/errorbars"),c("./components/colorscale"),c("./components/colorbar"),c("./components/modebar")]),k([c("./locale-en"),c("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(k(window.PlotlyLocales),delete window.PlotlyLocales),ie.Icons=c("./fonts/ploticon");var g=c("./components/fx"),a=c("./plots/plots");ie.Plots={resize:a.resize,graphJson:a.graphJson,sendDataToCloud:a.sendDataToCloud},ie.Fx={hover:g.hover,unhover:g.unhover,loneHover:g.loneHover,loneUnhover:g.loneUnhover},ie.Snapshot=c("./snapshot"),ie.PlotSchema=c("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":357,"./components/annotations3d":362,"./components/colorbar":372,"./components/colorscale":378,"./components/errorbars":394,"./components/fx":406,"./components/grid":410,"./components/images":415,"./components/legend":423,"./components/modebar":429,"./components/rangeselector":437,"./components/rangeslider":444,"./components/shapes":458,"./components/sliders":463,"./components/updatemenus":469,"./fonts/ploticon":482,"./locale-en":534,"./locale-en-us":533,"./plot_api":538,"./plot_api/plot_schema":542,"./plots/plots":619,"./registry":638,"./snapshot":643,"./traces/scatter":939,"./version":1123,"native-promise-only":245}],482:[function(c,ae,ie){"use strict";ae.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],483:[function(c,ae,ie){"use strict";ie.isLeftAnchor=function(k){return k.xanchor==="left"||k.xanchor==="auto"&&k.x<=1/3},ie.isCenterAnchor=function(k){return k.xanchor==="center"||k.xanchor==="auto"&&k.x>1/3&&k.x<2/3},ie.isRightAnchor=function(k){return k.xanchor==="right"||k.xanchor==="auto"&&k.x>=2/3},ie.isTopAnchor=function(k){return k.yanchor==="top"||k.yanchor==="auto"&&k.y>=2/3},ie.isMiddleAnchor=function(k){return k.yanchor==="middle"||k.yanchor==="auto"&&k.y>1/3&&k.y<2/3},ie.isBottomAnchor=function(k){return k.yanchor==="bottom"||k.yanchor==="auto"&&k.y<=1/3}},{}],484:[function(c,ae,ie){"use strict";var b=c("./mod"),k=b.mod,P=b.modHalf,E=Math.PI,e=2*E;function p(M){return M/180*E}function g(M){return M/E*180}function a(M){return Math.abs(M[1]-M[0])>e-1e-14}function t(M,v){return P(v-M,e)}function i(M,v){return Math.abs(t(M,v))}function n(M,v){if(a(v))return!0;var _,l;v[0]<v[1]?(_=v[0],l=v[1]):(_=v[1],l=v[0]),_=k(_,e),l=k(l,e),_>l&&(l+=e);var y=k(M,e),T=y+e;return y>=_&&y<=l||T>=_&&T<=l}function r(M,v,_,l){if(!n(v,l))return!1;var y,T;return _[0]<_[1]?(y=_[0],T=_[1]):(y=_[1],T=_[0]),M>=y&&M<=T}function d(M,v,_,l,y,T,w){y=y||0,T=T||0;var A=a([_,l]),f,u,h,o,S;A?(f=0,u=E,h=e):_<l?(f=_,h=l):(f=l,h=_),M<v?(o=M,S=v):(o=v,S=M);function R(F,D){return[F*Math.cos(D)+y,T-F*Math.sin(D)]}var z=Math.abs(h-f)<=E?0:1;function O(F,D,B){return"A"+[F,F]+" "+[0,z,B]+" "+R(F,D)}var I;return A?o===null?I="M"+R(S,f)+O(S,u,0)+O(S,h,0)+"Z":I="M"+R(o,f)+O(o,u,0)+O(o,h,0)+"ZM"+R(S,f)+O(S,u,1)+O(S,h,1)+"Z":o===null?(I="M"+R(S,f)+O(S,h,0),w&&(I+="L0,0Z")):I="M"+R(o,f)+"L"+R(S,f)+O(S,h,0)+"L"+R(o,h)+O(o,f,1)+"Z",I}function s(M,v,_,l,y){return d(null,M,v,_,l,y,0)}function m(M,v,_,l,y){return d(null,M,v,_,l,y,1)}function x(M,v,_,l,y,T){return d(M,v,_,l,y,T,1)}ae.exports={deg2rad:p,rad2deg:g,angleDelta:t,angleDist:i,isFullCircle:a,isAngleInsideSector:n,isPtInsideSector:r,pathArc:s,pathSector:m,pathAnnulus:x}},{"./mod":510}],485:[function(c,ae,ie){"use strict";var b=Array.isArray,k=ArrayBuffer,P=DataView;function E(a){return k.isView(a)&&!(a instanceof P)}ie.isTypedArray=E;function e(a){return b(a)||E(a)}ie.isArrayOrTypedArray=e;function p(a){return!e(a[0])}ie.isArray1D=p,ie.ensureArray=function(a,t){return b(a)||(a=[]),a.length=t,a},ie.concat=function(){var a=[],t=!0,i=0,n,r,d,s,m,x,M,v;for(d=0;d<arguments.length;d++)s=arguments[d],x=s.length,x&&(r?a.push(s):(r=s,m=x),b(s)?n=!1:(t=!1,i?n!==s.constructor&&(n=!1):n=s.constructor),i+=x);if(!i)return[];if(!a.length)return r;if(t)return r.concat.apply(r,a);if(n){for(M=new n(i),M.set(r),d=0;d<a.length;d++)s=a[d],M.set(s,m),m+=s.length;return M}for(M=new Array(i),v=0;v<r.length;v++)M[v]=r[v];for(d=0;d<a.length;d++){for(s=a[d],v=0;v<s.length;v++)M[m+v]=s[v];m+=v}return M},ie.maxRowLength=function(a){return g(a,Math.max,0)},ie.minRowLength=function(a){return g(a,Math.min,1/0)};function g(a,t,i){if(e(a))if(e(a[0])){for(var n=i,r=0;r<a.length;r++)n=t(n,a[r].length);return n}else return a.length;return 0}},{}],486:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../constants/numerical").BADNUM,P=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;ae.exports=function(e){return typeof e=="string"&&(e=e.replace(P,"")),b(e)?Number(e):k}},{"../constants/numerical":479,"fast-isnumeric":190}],487:[function(c,ae,ie){"use strict";ae.exports=function(k){var P=k._fullLayout;P._glcanvas&&P._glcanvas.size()&&P._glcanvas.each(function(E){E.regl&&E.regl.clear({color:!0,depth:!0})})}},{}],488:[function(c,ae,ie){"use strict";ae.exports=function(k){k._responsiveChartHandler&&(window.removeEventListener("resize",k._responsiveChartHandler),delete k._responsiveChartHandler)}},{}],489:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("tinycolor2"),P=c("../plots/attributes"),E=c("../components/colorscale/scales"),e=c("../components/color"),p=c("../constants/interactions").DESELECTDIM,g=c("./nested_property"),a=c("./regex").counter,t=c("./mod").modHalf,i=c("./array").isArrayOrTypedArray;ie.valObjectMeta={data_array:{coerceFunction:function(r,d,s){i(r)?d.set(r):s!==void 0&&d.set(s)}},enumerated:{coerceFunction:function(r,d,s,m){m.coerceNumber&&(r=+r),m.values.indexOf(r)===-1?d.set(s):d.set(r)},validateFunction:function(r,d){d.coerceNumber&&(r=+r);for(var s=d.values,m=0;m<s.length;m++){var x=String(s[m]);if(x.charAt(0)==="/"&&x.charAt(x.length-1)==="/"){var M=new RegExp(x.substr(1,x.length-2));if(M.test(r))return!0}else if(r===s[m])return!0}return!1}},boolean:{coerceFunction:function(r,d,s){r===!0||r===!1?d.set(r):d.set(s)}},number:{coerceFunction:function(r,d,s,m){!b(r)||m.min!==void 0&&r<m.min||m.max!==void 0&&r>m.max?d.set(s):d.set(+r)}},integer:{coerceFunction:function(r,d,s,m){r%1||!b(r)||m.min!==void 0&&r<m.min||m.max!==void 0&&r>m.max?d.set(s):d.set(+r)}},string:{coerceFunction:function(r,d,s,m){if(typeof r!="string"){var x=typeof r=="number";m.strict===!0||!x?d.set(s):d.set(String(r))}else m.noBlank&&!r?d.set(s):d.set(r)}},color:{coerceFunction:function(r,d,s){k(r).isValid()?d.set(r):d.set(s)}},colorlist:{coerceFunction:function(r,d,s){function m(x){return k(x).isValid()}!Array.isArray(r)||!r.length?d.set(s):r.every(m)?d.set(r):d.set(s)}},colorscale:{coerceFunction:function(r,d,s){d.set(E.get(r,s))}},angle:{coerceFunction:function(r,d,s){r==="auto"?d.set("auto"):b(r)?d.set(t(+r,360)):d.set(s)}},subplotid:{coerceFunction:function(r,d,s,m){var x=m.regex||a(s);if(typeof r=="string"&&x.test(r)){d.set(r);return}d.set(s)},validateFunction:function(r,d){var s=d.dflt;return r===s?!0:typeof r!="string"?!1:!!a(s).test(r)}},flaglist:{coerceFunction:function(r,d,s,m){if(typeof r!="string"){d.set(s);return}if((m.extras||[]).indexOf(r)!==-1){d.set(r);return}for(var x=r.split("+"),M=0;M<x.length;){var v=x[M];m.flags.indexOf(v)===-1||x.indexOf(v)<M?x.splice(M,1):M++}x.length?d.set(x.join("+")):d.set(s)}},any:{coerceFunction:function(r,d,s){r===void 0?d.set(s):d.set(r)}},info_array:{coerceFunction:function(r,d,s,m){function x(R,z,O){var I,F={set:function(D){I=D}};return O===void 0&&(O=z.dflt),ie.valObjectMeta[z.valType].coerceFunction(R,F,O,z),I}var M=m.dimensions===2||m.dimensions==="1-2"&&Array.isArray(r)&&Array.isArray(r[0]);if(!Array.isArray(r)){d.set(s);return}var v=m.items,_=[],l=Array.isArray(v),y=l&&M&&Array.isArray(v[0]),T=M&&l&&!y,w=l&&!T?v.length:r.length,A,f,u,h,o,S;if(s=Array.isArray(s)?s:[],M)for(A=0;A<w;A++)for(_[A]=[],u=Array.isArray(r[A])?r[A]:[],T?o=v.length:l?o=v[A].length:o=u.length,f=0;f<o;f++)T?h=v[f]:l?h=v[A][f]:h=v,S=x(u[f],h,(s[A]||[])[f]),S!==void 0&&(_[A][f]=S);else for(A=0;A<w;A++)S=x(r[A],l?v[A]:v,s[A]),S!==void 0&&(_[A]=S);d.set(_)},validateFunction:function(r,d){if(!Array.isArray(r))return!1;var s=d.items,m=Array.isArray(s),x=d.dimensions===2;if(!d.freeLength&&r.length!==s.length)return!1;for(var M=0;M<r.length;M++)if(x){if(!Array.isArray(r[M])||!d.freeLength&&r[M].length!==s[M].length)return!1;for(var v=0;v<r[M].length;v++)if(!n(r[M][v],m?s[M][v]:s))return!1}else if(!n(r[M],m?s[M]:s))return!1;return!0}}},ie.coerce=function(r,d,s,m,x){var M=g(s,m).get(),v=g(r,m),_=g(d,m),l=v.get(),y=d._template;if(l===void 0&&y&&(l=g(y,m).get(),y=0),x===void 0&&(x=M.dflt),M.arrayOk&&i(l))return _.set(l),l;var T=ie.valObjectMeta[M.valType].coerceFunction;T(l,_,x,M);var w=_.get();return y&&w===x&&!n(l,M)&&(l=g(y,m).get(),T(l,_,x,M),w=_.get()),w},ie.coerce2=function(r,d,s,m,x){var M=g(r,m),v=ie.coerce(r,d,s,m,x),_=M.get();return _!=null?v:!1},ie.coerceFont=function(r,d,s){var m={};return s=s||{},m.family=r(d+".family",s.family),m.size=r(d+".size",s.size),m.color=r(d+".color",s.color),m},ie.coercePattern=function(r,d,s,m){var x=r(d+".shape");if(x){r(d+".solidity"),r(d+".size");var M=r(d+".fillmode"),v=M==="overlay";if(!m){var _=r(d+".bgcolor",v?s:void 0);r(d+".fgcolor",v?e.contrast(_):s)}r(d+".fgopacity",v?.5:1)}},ie.coerceHoverinfo=function(r,d,s){var m=d._module.attributes,x=m.hoverinfo?m:P,M=x.hoverinfo,v;if(s._dataLength===1){var _=M.dflt==="all"?M.flags.slice():M.dflt.split("+");_.splice(_.indexOf("name"),1),v=_.join("+")}return ie.coerce(r,d,x,"hoverinfo",v)},ie.coerceSelectionMarkerOpacity=function(r,d){if(!!r.marker){var s=r.marker.opacity;if(s!==void 0){var m,x;!i(s)&&!r.selected&&!r.unselected&&(m=s,x=p*s),d("selected.marker.opacity",m),d("unselected.marker.opacity",x)}}};function n(r,d){var s=ie.valObjectMeta[d.valType];if(d.arrayOk&&i(r))return!0;if(s.validateFunction)return s.validateFunction(r,d);var m={},x=m,M={set:function(v){x=v}};return s.coerceFunction(r,M,m,d),x!==m}ie.validate=n},{"../components/color":366,"../components/colorscale/scales":381,"../constants/interactions":478,"../plots/attributes":550,"./array":485,"./mod":510,"./nested_property":511,"./regex":520,"fast-isnumeric":190,tinycolor2:312}],490:[function(c,ae,ie){"use strict";var b=c("d3-time-format").timeFormat,k=c("fast-isnumeric"),P=c("./loggers"),E=c("./mod").mod,e=c("../constants/numerical"),p=e.BADNUM,g=e.ONEDAY,a=e.ONEHOUR,t=e.ONEMIN,i=e.ONESEC,n=e.EPOCHJD,r=c("../registry"),d=c("d3-time-format").utcFormat,s=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,m=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,x=new Date().getFullYear()-70;function M(I){return I&&r.componentsRegistry.calendars&&typeof I=="string"&&I!=="gregorian"}ie.dateTick0=function(I,F){var D=v(I,!!F);if(F<2)return D;var B=ie.dateTime2ms(D,I);return B+=g*(F-1),ie.ms2DateTime(B,0,I)};function v(I,F){return M(I)?F?r.getComponentMethod("calendars","CANONICAL_SUNDAY")[I]:r.getComponentMethod("calendars","CANONICAL_TICK")[I]:F?"2000-01-02":"2000-01-01"}ie.dfltRange=function(I){return M(I)?r.getComponentMethod("calendars","DFLTRANGE")[I]:["2000-01-01","2001-01-01"]},ie.isJSDate=function(I){return typeof I=="object"&&I!==null&&typeof I.getTime=="function"};var _,l;ie.dateTime2ms=function(I,F){if(ie.isJSDate(I)){var D=I.getTimezoneOffset()*t,B=(I.getUTCMinutes()-I.getMinutes())*t+(I.getUTCSeconds()-I.getSeconds())*i+(I.getUTCMilliseconds()-I.getMilliseconds());if(B){var U=3*t;D=D-U/2+E(B-D+U/2,U)}return I=Number(I)-D,I>=_&&I<=l?I:p}if(typeof I!="string"&&typeof I!="number")return p;I=String(I);var X=M(F),oe=I.charAt(0);X&&(oe==="G"||oe==="g")&&(I=I.substr(1),F="");var se=X&&F.substr(0,7)==="chinese",q=I.match(se?m:s);if(!q)return p;var K=q[1],G=q[3]||"1",Q=Number(q[5]||1),V=Number(q[7]||0),H=Number(q[9]||0),ee=Number(q[11]||0);if(X){if(K.length===2)return p;K=Number(K);var J;try{var W=r.getComponentMethod("calendars","getCal")(F);if(se){var re=G.charAt(G.length-1)==="i";G=parseInt(G,10),J=W.newDate(K,W.toMonthIndex(K,G,re),Q)}else J=W.newDate(K,Number(G),Q)}catch{return p}return J?(J.toJD()-n)*g+V*a+H*t+ee*i:p}K.length===2?K=(Number(K)+2e3-x)%100+x:K=Number(K),G-=1;var j=new Date(Date.UTC(2e3,G,Q,V,H));return j.setUTCFullYear(K),j.getUTCMonth()!==G||j.getUTCDate()!==Q?p:j.getTime()+ee*i},_=ie.MIN_MS=ie.dateTime2ms("-9999"),l=ie.MAX_MS=ie.dateTime2ms("9999-12-31 23:59:59.9999"),ie.isDateTime=function(I,F){return ie.dateTime2ms(I,F)!==p};function y(I,F){return String(I+Math.pow(10,F)).substr(1)}var T=90*g,w=3*a,A=5*t;ie.ms2DateTime=function(I,F,D){if(typeof I!="number"||!(I>=_&&I<=l))return p;F||(F=0);var B=Math.floor(E(I+.05,1)*10),U=Math.round(I-B/10),X,oe,se,q,K,G;if(M(D)){var Q=Math.floor(U/g)+n,V=Math.floor(E(I,g));try{X=r.getComponentMethod("calendars","getCal")(D).fromJD(Q).formatDate("yyyy-mm-dd")}catch{X=d("G%Y-%m-%d")(new Date(U))}if(X.charAt(0)==="-")for(;X.length<11;)X="-0"+X.substr(1);else for(;X.length<10;)X="0"+X;oe=F<T?Math.floor(V/a):0,se=F<T?Math.floor(V%a/t):0,q=F<w?Math.floor(V%t/i):0,K=F<A?V%i*10+B:0}else G=new Date(U),X=d("%Y-%m-%d")(G),oe=F<T?G.getUTCHours():0,se=F<T?G.getUTCMinutes():0,q=F<w?G.getUTCSeconds():0,K=F<A?G.getUTCMilliseconds()*10+B:0;return f(X,oe,se,q,K)},ie.ms2DateTimeLocal=function(I){if(!(I>=_+g&&I<=l-g))return p;var F=Math.floor(E(I+.05,1)*10),D=new Date(Math.round(I-F/10)),B=b("%Y-%m-%d")(D),U=D.getHours(),X=D.getMinutes(),oe=D.getSeconds(),se=D.getUTCMilliseconds()*10+F;return f(B,U,X,oe,se)};function f(I,F,D,B,U){if((F||D||B||U)&&(I+=" "+y(F,2)+":"+y(D,2),(B||U)&&(I+=":"+y(B,2),U))){for(var X=4;U%10===0;)X-=1,U/=10;I+="."+y(U,X)}return I}ie.cleanDate=function(I,F,D){if(I===p)return F;if(ie.isJSDate(I)||typeof I=="number"&&isFinite(I)){if(M(D))return P.error("JS Dates and milliseconds are incompatible with world calendars",I),F;if(I=ie.ms2DateTimeLocal(+I),!I&&F!==void 0)return F}else if(!ie.isDateTime(I,D))return P.error("unrecognized date",I),F;return I};var u=/%\d?f/g,h=/%h/g,o={"1":"1","2":"1","3":"2","4":"2"};function S(I,F,D,B){I=I.replace(u,function(X){var oe=Math.min(+X.charAt(1)||6,6),se=(F/1e3%1+2).toFixed(oe).substr(2).replace(/0+$/,"")||"0";return se});var U=new Date(Math.floor(F+.05));if(I=I.replace(h,function(){return o[D("%q")(U)]}),M(B))try{I=r.getComponentMethod("calendars","worldCalFmt")(I,F,B)}catch{return"Invalid"}return D(I)(U)}var R=[59,59.9,59.99,59.999,59.9999];function z(I,F){var D=E(I+.05,g),B=y(Math.floor(D/a),2)+":"+y(E(Math.floor(D/t),60),2);if(F!=="M"){k(F)||(F=0);var U=Math.min(E(I/i,60),R[F]),X=(100+U).toFixed(F).substr(1);F>0&&(X=X.replace(/0+$/,"").replace(/[\.]$/,"")),B+=":"+X}return B}ie.formatDate=function(I,F,D,B,U,X){if(U=M(U)&&U,!F)if(D==="y")F=X.year;else if(D==="m")F=X.month;else if(D==="d")F=X.dayMonth+`
`+X.year;else return z(I,D)+`
`+S(X.dayMonthYear,I,B,U);return S(F,I,B,U)};var O=3*g;ie.incrementMonth=function(I,F,D){D=M(D)&&D;var B=E(I,g);if(I=Math.round(I-B),D)try{var U=Math.round(I/g)+n,X=r.getComponentMethod("calendars","getCal")(D),oe=X.fromJD(U);return F%12?X.add(oe,F,"m"):X.add(oe,F/12,"y"),(oe.toJD()-n)*g+B}catch{P.error("invalid ms "+I+" in calendar "+D)}var se=new Date(I+O);return se.setUTCMonth(se.getUTCMonth()+F)+B-O},ie.findExactDates=function(I,F){for(var D=0,B=0,U=0,X=0,oe,se,q=M(F)&&r.getComponentMethod("calendars","getCal")(F),K=0;K<I.length;K++){if(se=I[K],!k(se)){X++;continue}if(!(se%g))if(q)try{oe=q.fromJD(se/g+n),oe.day()===1?oe.month()===1?D++:B++:U++}catch{}else oe=new Date(se),oe.getUTCDate()===1?oe.getUTCMonth()===0?D++:B++:U++}B+=D,U+=B;var G=I.length-X;return{exactYears:D/G,exactMonths:B/G,exactDays:U/G}}},{"../constants/numerical":479,"../registry":638,"./loggers":507,"./mod":510,"d3-time-format":120,"fast-isnumeric":190}],491:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("./loggers"),P=c("./matrix"),E=c("gl-mat4");function e(x){var M;if(typeof x=="string"){if(M=document.getElementById(x),M===null)throw new Error("No DOM element with id '"+x+"' exists on the page.");return M}else if(x==null)throw new Error("DOM element provided is null or undefined");return x}function p(x){var M=b.select(x);return M.node()instanceof HTMLElement&&M.size()&&M.classed("js-plotly-plot")}function g(x){var M=x&&x.parentNode;M&&M.removeChild(x)}function a(x,M){t("global",x,M)}function t(x,M,v){var _="plotly.js-style-"+x,l=document.getElementById(_);l||(l=document.createElement("style"),l.setAttribute("id",_),l.appendChild(document.createTextNode("")),document.head.appendChild(l));var y=l.sheet;y.insertRule?y.insertRule(M+"{"+v+"}",0):y.addRule?y.addRule(M,v,0):k.warn("addStyleRule failed")}function i(x){var M="plotly.js-style-"+x,v=document.getElementById(M);v&&g(v)}function n(x){var M=d(x),v=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return M.forEach(function(_){var l=r(_);if(l){var y=P.convertCssMatrix(l);v=E.multiply(v,v,y)}}),v}function r(x){var M=window.getComputedStyle(x,null),v=M.getPropertyValue("-webkit-transform")||M.getPropertyValue("-moz-transform")||M.getPropertyValue("-ms-transform")||M.getPropertyValue("-o-transform")||M.getPropertyValue("transform");return v==="none"?null:v.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(_){return+_})}function d(x){for(var M=[];s(x);)M.push(x),x=x.parentNode;return M}function s(x){return x&&(x instanceof Element||x instanceof HTMLElement)}function m(x,M){return x&&M&&x.x===M.x&&x.y===M.y&&x.top===M.top&&x.left===M.left&&x.right===M.right&&x.bottom===M.bottom}ae.exports={getGraphDiv:e,isPlotDiv:p,removeElement:g,addStyleRule:a,addRelatedStyleRule:t,deleteRelatedStyleRule:i,getFullTransformMatrix:n,getElementTransformMatrix:r,getElementAndAncestors:d,equalDomRects:m}},{"./loggers":507,"./matrix":509,"@plotly/d3":58,"gl-mat4":210}],492:[function(c,ae,ie){"use strict";var b=c("events").EventEmitter,k={init:function(P){if(P._ev instanceof b)return P;var E=new b,e=new b;return P._ev=E,P._internalEv=e,P.on=E.on.bind(E),P.once=E.once.bind(E),P.removeListener=E.removeListener.bind(E),P.removeAllListeners=E.removeAllListeners.bind(E),P._internalOn=e.on.bind(e),P._internalOnce=e.once.bind(e),P._removeInternalListener=e.removeListener.bind(e),P._removeAllInternalListeners=e.removeAllListeners.bind(e),P.emit=function(p,g){typeof jQuery<"u"&&jQuery(P).trigger(p,g),E.emit(p,g),e.emit(p,g)},P},triggerHandler:function(P,E,e){var p,g;typeof jQuery<"u"&&(p=jQuery(P).triggerHandler(E,e));var a=P._ev;if(!a)return p;var t=a._events[E];if(!t)return p;function i(r){if(r.listener){if(a.removeListener(E,r.listener),!r.fired)return r.fired=!0,r.listener.apply(a,[e])}else return r.apply(a,[e])}t=Array.isArray(t)?t:[t];var n;for(n=0;n<t.length-1;n++)i(t[n]);return g=i(t[n]),p!==void 0?p:g},purge:function(P){return delete P._ev,delete P.on,delete P.once,delete P.removeListener,delete P.removeAllListeners,delete P.emit,delete P._ev,delete P._internalEv,delete P._internalOn,delete P._internalOnce,delete P._removeInternalListener,delete P._removeAllInternalListeners,P}};ae.exports=k},{events:84}],493:[function(c,ae,ie){"use strict";var b=c("./is_plain_object.js"),k=Array.isArray;function P(e,p){var g,a;for(g=0;g<e.length;g++){if(a=e[g],a!==null&&typeof a=="object")return!1;a!==void 0&&(p[g]=a)}return!0}ie.extendFlat=function(){return E(arguments,!1,!1,!1)},ie.extendDeep=function(){return E(arguments,!0,!1,!1)},ie.extendDeepAll=function(){return E(arguments,!0,!0,!1)},ie.extendDeepNoArrays=function(){return E(arguments,!0,!1,!0)};function E(e,p,g,a){var t=e[0],i=e.length,n,r,d,s,m,x,M;if(i===2&&k(t)&&k(e[1])&&t.length===0){if(M=P(e[1],t),M)return t;t.splice(0,t.length)}for(var v=1;v<i;v++){n=e[v];for(r in n)d=t[r],s=n[r],a&&k(s)?t[r]=s:p&&s&&(b(s)||(m=k(s)))?(m?(m=!1,x=d&&k(d)?d:[]):x=d&&b(d)?d:{},t[r]=E([x,s],p,g,a)):(typeof s<"u"||g)&&(t[r]=s)}return t}},{"./is_plain_object.js":504}],494:[function(c,ae,ie){"use strict";ae.exports=function(k){for(var P={},E=[],e=0,p=0;p<k.length;p++){var g=k[p];P[g]!==1&&(P[g]=1,E[e++]=g)}return E}},{}],495:[function(c,ae,ie){"use strict";ae.exports=function(e){for(var p=P(e)?k:b,g=[],a=0;a<e.length;a++){var t=e[a];p(t)&&g.push(t)}return g};function b(E){return E.visible===!0}function k(E){var e=E[0].trace;return e.visible===!0&&e._length!==0}function P(E){return Array.isArray(E)&&Array.isArray(E[0])&&E[0][0]&&E[0][0].trace}},{}],496:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("country-regex"),P=c("@turf/area"),E=c("@turf/centroid"),e=c("@turf/bbox"),p=c("./identity"),g=c("./loggers"),a=c("./is_plain_object"),t=c("./nested_property"),i=c("./polygon"),n=Object.keys(k),r={"ISO-3":p,"USA-states":p,"country names":d};function d(y){for(var T=0;T<n.length;T++){var w=n[T],A=new RegExp(k[w]);if(A.test(y.trim().toLowerCase()))return w}return g.log("Unrecognized country name: "+y+"."),!1}function s(y,T,w){if(!T||typeof T!="string")return!1;var A=r[y](T),f,u,h;if(A){if(y==="USA-states")for(f=[],h=0;h<w.length;h++)u=w[h],u.properties&&u.properties.gu&&u.properties.gu==="USA"&&f.push(u);else f=w;for(h=0;h<f.length;h++)if(u=f[h],u.id===A)return u;g.log(["Location with id",A,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}function m(y){var T=y.geometry,w=T.coordinates,A=y.id,f=[],u,h,o,S;function R(z){for(var O=0;O<z.length-1;O++)if(z[O][0]>0&&z[O+1][0]<0)return O;return null}switch(A==="RUS"||A==="FJI"?u=function(z){var O;if(R(z)===null)O=z;else for(O=new Array(z.length),S=0;S<z.length;S++)O[S]=[z[S][0]<0?z[S][0]+360:z[S][0],z[S][1]];f.push(i.tester(O))}:A==="ATA"?u=function(z){var O=R(z);if(O===null)return f.push(i.tester(z));var I=new Array(z.length+1),F=0;for(S=0;S<z.length;S++)S>O?I[F++]=[z[S][0]+360,z[S][1]]:S===O?(I[F++]=z[S],I[F++]=[z[S][0],-90]):I[F++]=z[S];var D=i.tester(I);D.pts.pop(),f.push(D)}:u=function(z){f.push(i.tester(z))},T.type){case"MultiPolygon":for(h=0;h<w.length;h++)for(o=0;o<w[h].length;o++)u(w[h][o]);break;case"Polygon":for(h=0;h<w.length;h++)u(w[h]);break}return f}function x(y){var T=y.geojson,w=window.PlotlyGeoAssets||{},A=typeof T=="string"?w[T]:T;return a(A)?A:(g.error("Oops ... something went wrong when fetching "+T),!1)}function M(y){var T=y[0].trace,w=x(T);if(!w)return!1;var A={},f=[],u;for(u=0;u<T._length;u++){var h=y[u];(h.loc||h.loc===0)&&(A[h.loc]=h)}function o(z){var O=t(z,T.featureidkey||"id").get(),I=A[O];if(I){var F=z.geometry;if(F.type==="Polygon"||F.type==="MultiPolygon"){var D={type:"Feature",id:O,geometry:F,properties:{}};D.properties.ct=v(D),I.fIn=z,I.fOut=D,f.push(D)}else g.log(["Location",I.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete A[O]}switch(w.type){case"FeatureCollection":var S=w.features;for(u=0;u<S.length;u++)o(S[u]);break;case"Feature":o(w);break;default:return g.warn(["Invalid GeoJSON type",(w.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var R in A)g.log(["Location *"+R+"*","does not have a matching feature with id-key","*"+T.featureidkey+"*."].join(" "));return f}function v(y){var T=y.geometry,w;if(T.type==="MultiPolygon")for(var A=T.coordinates,f=0,u=0;u<A.length;u++){var h={type:"Polygon",coordinates:A[u]},o=P.default(h);o>f&&(f=o,w=h)}else w=T;return E.default(w).geometry.coordinates}function _(y){var T=window.PlotlyGeoAssets||{},w=[];function A(S){return new Promise(function(R,z){b.json(S,function(O,I){if(O){delete T[S];var F=O.status===404?'GeoJSON at URL "'+S+'" does not exist.':"Unexpected error while fetching from "+S;return z(new Error(F))}return T[S]=I,R(I)})})}function f(S){return new Promise(function(R,z){var O=0,I=setInterval(function(){if(T[S]&&T[S]!=="pending")return clearInterval(I),R(T[S]);if(O>100)return clearInterval(I),z("Unexpected error while fetching from "+S);O++},50)})}for(var u=0;u<y.length;u++){var h=y[u][0].trace,o=h.geojson;typeof o=="string"&&(T[o]?T[o]==="pending"&&w.push(f(o)):(T[o]="pending",w.push(A(o))))}return w}function l(y){return e.default(y)}ae.exports={locationToFeature:s,feature2polygons:m,getTraceGeojson:x,extractTraceFeature:M,fetchTraceGeoData:_,computeBbox:l}},{"./identity":501,"./is_plain_object":504,"./loggers":507,"./nested_property":511,"./polygon":515,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],497:[function(c,ae,ie){"use strict";var b=c("../constants/numerical").BADNUM;ie.calcTraceToLineCoords=function(k){for(var P=k[0].trace,E=P.connectgaps,e=[],p=[],g=0;g<k.length;g++){var a=k[g],t=a.lonlat;t[0]!==b?p.push(t):!E&&p.length>0&&(e.push(p),p=[])}return p.length>0&&e.push(p),e},ie.makeLine=function(k){return k.length===1?{type:"LineString",coordinates:k[0]}:{type:"MultiLineString",coordinates:k}},ie.makePolygon=function(k){if(k.length===1)return{type:"Polygon",coordinates:k};for(var P=new Array(k.length),E=0;E<k.length;E++)P[E]=[k[E]];return{type:"MultiPolygon",coordinates:P}},ie.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":479}],498:[function(c,ae,ie){"use strict";var b=c("./mod").mod;ie.segmentsIntersect=k;function k(g,a,t,i,n,r,d,s){var m=t-g,x=n-g,M=d-n,v=i-a,_=r-a,l=s-r,y=m*l-M*v;if(y===0)return null;var T=(x*l-M*_)/y,w=(x*v-m*_)/y;return w<0||w>1||T<0||T>1?null:{x:g+m*T,y:a+v*T}}ie.segmentDistance=function(a,t,i,n,r,d,s,m){if(k(a,t,i,n,r,d,s,m))return 0;var x=i-a,M=n-t,v=s-r,_=m-d,l=x*x+M*M,y=v*v+_*_,T=Math.min(P(x,M,l,r-a,d-t),P(x,M,l,s-a,m-t),P(v,_,y,a-r,t-d),P(v,_,y,i-r,n-d));return Math.sqrt(T)};function P(g,a,t,i,n){var r=i*g+n*a;if(r<0)return i*i+n*n;if(r>t){var d=i-g,s=n-a;return d*d+s*s}else{var m=i*a-n*g;return m*m/t}}var E,e,p;ie.getTextLocation=function(a,t,i,n){if((a!==e||n!==p)&&(E={},e=a,p=n),E[i])return E[i];var r=a.getPointAtLength(b(i-n/2,t)),d=a.getPointAtLength(b(i+n/2,t)),s=Math.atan((d.y-r.y)/(d.x-r.x)),m=a.getPointAtLength(b(i,t)),x=(m.x*4+r.x+d.x)/6,M=(m.y*4+r.y+d.y)/6,v={x,y:M,theta:s};return E[i]=v,v},ie.clearLocationCache=function(){e=null},ie.getVisibleSegment=function(a,t,i){var n=t.left,r=t.right,d=t.top,s=t.bottom,m=0,x=a.getTotalLength(),M=x,v,_;function l(T){var w=a.getPointAtLength(T);T===0?v=w:T===x&&(_=w);var A=w.x<n?n-w.x:w.x>r?w.x-r:0,f=w.y<d?d-w.y:w.y>s?w.y-s:0;return Math.sqrt(A*A+f*f)}for(var y=l(m);y;){if(m+=y+i,m>M)return;y=l(m)}for(y=l(M);y;){if(M-=y+i,m>M)return;y=l(M)}return{min:m,max:M,len:M-m,total:x,isClosed:m===0&&M===x&&Math.abs(v.x-_.x)<.1&&Math.abs(v.y-_.y)<.1}},ie.findPointOnPath=function(a,t,i,n){n=n||{};for(var r=n.pathLength||a.getTotalLength(),d=n.tolerance||.001,s=n.iterationLimit||30,m=a.getPointAtLength(0)[i]>a.getPointAtLength(r)[i]?-1:1,x=0,M=0,v=r,_,l,y;x<s;){if(_=(M+v)/2,l=a.getPointAtLength(_),y=l[i]-t,Math.abs(y)<d)return l;m*y>0?v=_:M=_,x++}return l}},{"./mod":510}],499:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("tinycolor2"),P=c("color-normalize"),E=c("../components/colorscale"),e=c("../components/color/attributes").defaultLine,p=c("./array").isArrayOrTypedArray,g=P(e),a=1;function t(s,m){var x=s;return x[3]*=m,x}function i(s){if(b(s))return g;var m=P(s);return m.length?m:g}function n(s){return b(s)?s:a}function r(s,m,x){var M=s.color,v=p(M),_=p(m),l=E.extractOpts(s),y=[],T,w,A,f,u;if(l.colorscale!==void 0?T=E.makeColorScaleFuncFromTrace(s):T=i,v?w=function(o,S){return o[S]===void 0?g:P(T(o[S]))}:w=i,_?A=function(o,S){return o[S]===void 0?a:n(o[S])}:A=n,v||_)for(var h=0;h<x;h++)f=w(M,h),u=A(m,h),y[h]=t(f,u);else y=t(P(M),m);return y}function d(s){var m=E.extractOpts(s),x=m.colorscale;return m.reversescale&&(x=E.flipScale(m.colorscale)),x.map(function(M){var v=M[0],_=k(M[1]),l=_.toRgb();return{index:v,rgb:[l.r,l.g,l.b,l.a]}})}ae.exports={formatColor:r,parseColorScale:d}},{"../components/color/attributes":365,"../components/colorscale":378,"./array":485,"color-normalize":89,"fast-isnumeric":190,tinycolor2:312}],500:[function(c,ae,ie){"use strict";var b=c("./identity");function k(P){return[P]}ae.exports={keyFun:function(P){return P.key},repeat:k,descend:b,wrap:k,unwrap:function(P){return P[0]}}},{"./identity":501}],501:[function(c,ae,ie){"use strict";ae.exports=function(k){return k}},{}],502:[function(c,ae,ie){"use strict";ae.exports=function(k,P){if(!P)return k;var E=1/Math.abs(P),e=E>1?(E*k+E*P)/E:k+P,p=String(e).length;if(p>16){var g=String(P).length,a=String(k).length;if(p>=a+g){var t=parseFloat(e).toPrecision(12);t.indexOf("e+")===-1&&(e=+t)}}return e}},{}],503:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("d3-time-format").utcFormat,P=c("d3-format").format,E=c("fast-isnumeric"),e=c("../constants/numerical"),p=e.FP_SAFE,g=-p,a=e.BADNUM,t=ae.exports={};t.adjustFormat=function(G){return!G||/^\d[.]\df/.test(G)||/[.]\d%/.test(G)?G:G==="0.f"?"~f":/^\d%/.test(G)?"~%":/^\ds/.test(G)?"~s":!/^[~,.0$]/.test(G)&&/[&fps]/.test(G)?"~"+G:G};var i={};t.warnBadFormat=function(K){var G=String(K);i[G]||(i[G]=1,t.warn('encountered bad format: "'+G+'"'))},t.noFormat=function(K){return String(K)},t.numberFormat=function(K){var G;try{G=P(t.adjustFormat(K))}catch{return t.warnBadFormat(K),t.noFormat}return G},t.nestedProperty=c("./nested_property"),t.keyedContainer=c("./keyed_container"),t.relativeAttr=c("./relative_attr"),t.isPlainObject=c("./is_plain_object"),t.toLogRange=c("./to_log_range"),t.relinkPrivateKeys=c("./relink_private");var n=c("./array");t.isTypedArray=n.isTypedArray,t.isArrayOrTypedArray=n.isArrayOrTypedArray,t.isArray1D=n.isArray1D,t.ensureArray=n.ensureArray,t.concat=n.concat,t.maxRowLength=n.maxRowLength,t.minRowLength=n.minRowLength;var r=c("./mod");t.mod=r.mod,t.modHalf=r.modHalf;var d=c("./coerce");t.valObjectMeta=d.valObjectMeta,t.coerce=d.coerce,t.coerce2=d.coerce2,t.coerceFont=d.coerceFont,t.coercePattern=d.coercePattern,t.coerceHoverinfo=d.coerceHoverinfo,t.coerceSelectionMarkerOpacity=d.coerceSelectionMarkerOpacity,t.validate=d.validate;var s=c("./dates");t.dateTime2ms=s.dateTime2ms,t.isDateTime=s.isDateTime,t.ms2DateTime=s.ms2DateTime,t.ms2DateTimeLocal=s.ms2DateTimeLocal,t.cleanDate=s.cleanDate,t.isJSDate=s.isJSDate,t.formatDate=s.formatDate,t.incrementMonth=s.incrementMonth,t.dateTick0=s.dateTick0,t.dfltRange=s.dfltRange,t.findExactDates=s.findExactDates,t.MIN_MS=s.MIN_MS,t.MAX_MS=s.MAX_MS;var m=c("./search");t.findBin=m.findBin,t.sorterAsc=m.sorterAsc,t.sorterDes=m.sorterDes,t.distinctVals=m.distinctVals,t.roundUp=m.roundUp,t.sort=m.sort,t.findIndexOfMin=m.findIndexOfMin,t.sortObjectKeys=c("./sort_object_keys");var x=c("./stats");t.aggNums=x.aggNums,t.len=x.len,t.mean=x.mean,t.median=x.median,t.midRange=x.midRange,t.variance=x.variance,t.stdev=x.stdev,t.interp=x.interp;var M=c("./matrix");t.init2dArray=M.init2dArray,t.transposeRagged=M.transposeRagged,t.dot=M.dot,t.translationMatrix=M.translationMatrix,t.rotationMatrix=M.rotationMatrix,t.rotationXYMatrix=M.rotationXYMatrix,t.apply3DTransform=M.apply3DTransform,t.apply2DTransform=M.apply2DTransform,t.apply2DTransform2=M.apply2DTransform2,t.convertCssMatrix=M.convertCssMatrix,t.inverseTransformMatrix=M.inverseTransformMatrix;var v=c("./angles");t.deg2rad=v.deg2rad,t.rad2deg=v.rad2deg,t.angleDelta=v.angleDelta,t.angleDist=v.angleDist,t.isFullCircle=v.isFullCircle,t.isAngleInsideSector=v.isAngleInsideSector,t.isPtInsideSector=v.isPtInsideSector,t.pathArc=v.pathArc,t.pathSector=v.pathSector,t.pathAnnulus=v.pathAnnulus;var _=c("./anchor_utils");t.isLeftAnchor=_.isLeftAnchor,t.isCenterAnchor=_.isCenterAnchor,t.isRightAnchor=_.isRightAnchor,t.isTopAnchor=_.isTopAnchor,t.isMiddleAnchor=_.isMiddleAnchor,t.isBottomAnchor=_.isBottomAnchor;var l=c("./geometry2d");t.segmentsIntersect=l.segmentsIntersect,t.segmentDistance=l.segmentDistance,t.getTextLocation=l.getTextLocation,t.clearLocationCache=l.clearLocationCache,t.getVisibleSegment=l.getVisibleSegment,t.findPointOnPath=l.findPointOnPath;var y=c("./extend");t.extendFlat=y.extendFlat,t.extendDeep=y.extendDeep,t.extendDeepAll=y.extendDeepAll,t.extendDeepNoArrays=y.extendDeepNoArrays;var T=c("./loggers");t.log=T.log,t.warn=T.warn,t.error=T.error;var w=c("./regex");t.counterRegex=w.counter;var A=c("./throttle");t.throttle=A.throttle,t.throttleDone=A.done,t.clearThrottle=A.clear;var f=c("./dom");t.getGraphDiv=f.getGraphDiv,t.isPlotDiv=f.isPlotDiv,t.removeElement=f.removeElement,t.addStyleRule=f.addStyleRule,t.addRelatedStyleRule=f.addRelatedStyleRule,t.deleteRelatedStyleRule=f.deleteRelatedStyleRule,t.getFullTransformMatrix=f.getFullTransformMatrix,t.getElementTransformMatrix=f.getElementTransformMatrix,t.getElementAndAncestors=f.getElementAndAncestors,t.equalDomRects=f.equalDomRects,t.clearResponsive=c("./clear_responsive"),t.preserveDrawingBuffer=c("./preserve_drawing_buffer"),t.makeTraceGroups=c("./make_trace_groups"),t._=c("./localize"),t.notifier=c("./notifier"),t.filterUnique=c("./filter_unique"),t.filterVisible=c("./filter_visible"),t.pushUnique=c("./push_unique"),t.increment=c("./increment"),t.cleanNumber=c("./clean_number"),t.ensureNumber=function(G){return E(G)?(G=Number(G),G>p||G<g?a:G):a},t.isIndex=function(K,G){return G!==void 0&&K>=G?!1:E(K)&&K>=0&&K%1===0},t.noop=c("./noop"),t.identity=c("./identity"),t.repeat=function(K,G){for(var Q=new Array(G),V=0;V<G;V++)Q[V]=K;return Q},t.swapAttrs=function(K,G,Q,V){Q||(Q="x"),V||(V="y");for(var H=0;H<G.length;H++){var ee=G[H],J=t.nestedProperty(K,ee.replace("?",Q)),W=t.nestedProperty(K,ee.replace("?",V)),re=J.get();J.set(W.get()),W.set(re)}},t.raiseToTop=function(G){G.parentNode.appendChild(G)},t.cancelTransition=function(K){return K.transition().duration(0)},t.constrain=function(K,G,Q){return G>Q?Math.max(Q,Math.min(G,K)):Math.max(G,Math.min(Q,K))},t.bBoxIntersect=function(K,G,Q){return Q=Q||0,K.left<=G.right+Q&&G.left<=K.right+Q&&K.top<=G.bottom+Q&&G.top<=K.bottom+Q},t.simpleMap=function(K,G,Q,V,H){for(var ee=K.length,J=new Array(ee),W=0;W<ee;W++)J[W]=G(K[W],Q,V,H);return J},t.randstr=function K(G,Q,V,H){if(V||(V=16),Q===void 0&&(Q=24),Q<=0)return"0";var ee=Math.log(Math.pow(2,Q))/Math.log(V),J="",W,re,j;for(W=2;ee===1/0;W*=2)ee=Math.log(Math.pow(2,Q/W))/Math.log(V)*W;var Z=ee-Math.floor(ee);for(W=0;W<Math.floor(ee);W++)j=Math.floor(Math.random()*V).toString(V),J=j+J;Z&&(re=Math.pow(V,Z),j=Math.floor(Math.random()*re).toString(V),J=j+J);var ne=parseInt(J,V);return G&&G[J]||ne!==1/0&&ne>=Math.pow(2,Q)?H>10?(t.warn("randstr failed uniqueness"),J):K(G,Q,V,(H||0)+1):J},t.OptionControl=function(K,G){K||(K={}),G||(G="opt");var Q={};return Q.optionList=[],Q._newoption=function(V){V[G]=K,Q[V.name]=V,Q.optionList.push(V)},Q["_"+G]=K,Q},t.smooth=function(K,G){if(G=Math.round(G)||0,G<2)return K;var Q=K.length,V=2*Q,H=2*G-1,ee=new Array(H),J=new Array(Q),W,re,j,Z;for(W=0;W<H;W++)ee[W]=(1-Math.cos(Math.PI*(W+1)/G))/(2*G);for(W=0;W<Q;W++){for(Z=0,re=0;re<H;re++)j=W+re+1-G,j<-Q?j-=V*Math.round(j/V):j>=V&&(j-=V*Math.floor(j/V)),j<0?j=-1-j:j>=Q&&(j=V-1-j),Z+=K[j]*ee[re];J[W]=Z}return J},t.syncOrAsync=function(K,G,Q){var V,H;function ee(){return t.syncOrAsync(K,G,Q)}for(;K.length;)if(H=K.splice(0,1)[0],V=H(G),V&&V.then)return V.then(ee);return Q&&Q(G)},t.stripTrailingSlash=function(K){return K.substr(-1)==="/"?K.substr(0,K.length-1):K},t.noneOrAll=function(K,G,Q){if(!!K){var V=!1,H=!0,ee,J;for(ee=0;ee<Q.length;ee++)J=K[Q[ee]],J!=null?V=!0:H=!1;if(V&&!H)for(ee=0;ee<Q.length;ee++)K[Q[ee]]=G[Q[ee]]}},t.mergeArray=function(K,G,Q,V){var H=typeof V=="function";if(t.isArrayOrTypedArray(K))for(var ee=Math.min(K.length,G.length),J=0;J<ee;J++){var W=K[J];G[J][Q]=H?V(W):W}},t.mergeArrayCastPositive=function(K,G,Q){return t.mergeArray(K,G,Q,function(V){var H=+V;return isFinite(H)&&H>0?H:0})},t.fillArray=function(K,G,Q,V){if(V=V||t.identity,t.isArrayOrTypedArray(K))for(var H=0;H<G.length;H++)G[H][Q]=V(K[H])},t.castOption=function(K,G,Q,V){V=V||t.identity;var H=t.nestedProperty(K,Q).get();return t.isArrayOrTypedArray(H)?Array.isArray(G)&&t.isArrayOrTypedArray(H[G[0]])?V(H[G[0]][G[1]]):V(H[G]):H},t.extractOption=function(K,G,Q,V){if(Q in K)return K[Q];var H=t.nestedProperty(G,V).get();if(!Array.isArray(H))return H};function u(K){var G={};for(var Q in K)for(var V=K[Q],H=0;H<V.length;H++)G[V[H]]=+Q;return G}t.tagSelected=function(K,G,Q){var V=G.selectedpoints,H=G._indexToPoints,ee;H&&(ee=u(H));function J(ne){return ne!==void 0&&ne<K.length}for(var W=0;W<V.length;W++){var re=V[W];if(t.isIndex(re)||t.isArrayOrTypedArray(re)&&t.isIndex(re[0])&&t.isIndex(re[1])){var j=ee?ee[re]:re,Z=Q?Q[j]:j;J(Z)&&(K[Z].selected=1)}}},t.selIndices2selPoints=function(K){var G=K.selectedpoints,Q=K._indexToPoints;if(Q){for(var V=u(Q),H=[],ee=0;ee<G.length;ee++){var J=G[ee];if(t.isIndex(J)){var W=V[J];t.isIndex(W)&&H.push(W)}}return H}else return G},t.getTargetArray=function(K,G){var Q=G.target;if(typeof Q=="string"&&Q){var V=t.nestedProperty(K,Q).get();return Array.isArray(V)?V:!1}else if(Array.isArray(Q))return Q;return!1},t.minExtend=function(K,G){var Q={};typeof G!="object"&&(G={});var V=3,H=Object.keys(K),ee,J,W;for(ee=0;ee<H.length;ee++)J=H[ee],W=K[J],!(J.charAt(0)==="_"||typeof W=="function")&&(J==="module"?Q[J]=W:Array.isArray(W)?J==="colorscale"?Q[J]=W.slice():Q[J]=W.slice(0,V):t.isTypedArray(W)?Q[J]=W.subarray(0,V):W&&typeof W=="object"?Q[J]=t.minExtend(K[J],G[J]):Q[J]=W);for(H=Object.keys(G),ee=0;ee<H.length;ee++)J=H[ee],W=G[J],(typeof W!="object"||!(J in Q)||typeof Q[J]!="object")&&(Q[J]=W);return Q},t.titleCase=function(K){return K.charAt(0).toUpperCase()+K.substr(1)},t.containsAny=function(K,G){for(var Q=0;Q<G.length;Q++)if(K.indexOf(G[Q])!==-1)return!0;return!1},t.isIE=function(){return typeof window.navigator.msSaveBlob<"u"};var h=/Version\/[\d\.]+.*Safari/;t.isSafari=function(){return h.test(window.navigator.userAgent)};var o=/iPad|iPhone|iPod/;t.isIOS=function(){return o.test(window.navigator.userAgent)};var S=/Firefox\/(\d+)\.\d+/;t.getFirefoxVersion=function(){var K=S.exec(window.navigator.userAgent);if(K&&K.length===2){var G=parseInt(K[1]);if(!isNaN(G))return G}return null},t.isD3Selection=function(K){return K instanceof b.selection},t.ensureSingle=function(K,G,Q,V){var H=K.select(G+(Q?"."+Q:""));if(H.size())return H;var ee=K.append(G);return Q&&ee.classed(Q,!0),V&&ee.call(V),ee},t.ensureSingleById=function(K,G,Q,V){var H=K.select(G+"#"+Q);if(H.size())return H;var ee=K.append(G).attr("id",Q);return V&&ee.call(V),ee},t.objectFromPath=function(K,G){for(var Q=K.split("."),V,H=V={},ee=0;ee<Q.length;ee++){var J=Q[ee],W=null,re=Q[ee].match(/(.*)\[([0-9]+)\]/);re?(J=re[1],W=re[2],V=V[J]=[],ee===Q.length-1?V[W]=G:V[W]={},V=V[W]):(ee===Q.length-1?V[J]=G:V[J]={},V=V[J])}return H};var R=/^([^\[\.]+)\.(.+)?/,z=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;t.expandObjectPaths=function(K){var G,Q,V,H,ee,J,W;if(typeof K=="object"&&!Array.isArray(K))for(Q in K)K.hasOwnProperty(Q)&&((G=Q.match(R))?(H=K[Q],V=G[1],delete K[Q],K[V]=t.extendDeepNoArrays(K[V]||{},t.objectFromPath(Q,t.expandObjectPaths(H))[V])):(G=Q.match(z))?(H=K[Q],V=G[1],ee=parseInt(G[2]),delete K[Q],K[V]=K[V]||[],G[3]==="."?(W=G[4],J=K[V][ee]=K[V][ee]||{},t.extendDeepNoArrays(J,t.objectFromPath(W,t.expandObjectPaths(H)))):K[V][ee]=t.expandObjectPaths(H)):K[Q]=t.expandObjectPaths(K[Q]));return K},t.numSeparate=function(K,G,Q){if(Q||(Q=!1),typeof G!="string"||G.length===0)throw new Error("Separator string required for formatting!");typeof K=="number"&&(K=String(K));var V=/(\d+)(\d{3})/,H=G.charAt(0),ee=G.charAt(1),J=K.split("."),W=J[0],re=J.length>1?H+J[1]:"";if(ee&&(J.length>1||W.length>4||Q))for(;V.test(W);)W=W.replace(V,"$1"+ee+"$2");return W+re},t.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var O=/^\w*$/;t.templateString=function(K,G){var Q={};return K.replace(t.TEMPLATE_STRING_REGEX,function(V,H){var ee;return O.test(H)?ee=G[H]:(Q[H]=Q[H]||t.nestedProperty(G,H).get,ee=Q[H]()),t.isValidTextValue(ee)?ee:""})};var I={max:10,count:0,name:"hovertemplate"};t.hovertemplateString=function(){return B.apply(I,arguments)};var F={max:10,count:0,name:"texttemplate"};t.texttemplateString=function(){return B.apply(F,arguments)};var D=/^[:|\|]/;function B(K,G,Q){var V=this,H=arguments;G||(G={});var ee={};return K.replace(t.TEMPLATE_STRING_REGEX,function(J,W,re){var j=W==="xother"||W==="yother",Z=W==="_xother"||W==="_yother",ne=W==="_xother_"||W==="_yother_",le=W==="xother_"||W==="yother_",ge=j||Z||le||ne,pe=W;(Z||ne)&&(pe=pe.substring(1)),(le||ne)&&(pe=pe.substring(0,pe.length-1));var xe;if(ge){if(xe=G[pe],xe===void 0)return""}else{var Ee,Te;for(Te=3;Te<H.length;Te++)if(Ee=H[Te],!!Ee){if(Ee.hasOwnProperty(pe)){xe=Ee[pe];break}if(O.test(pe)||(xe=t.nestedProperty(Ee,pe).get(),xe=ee[pe]||t.nestedProperty(Ee,pe).get(),xe&&(ee[pe]=xe)),xe!==void 0)break}}if(xe===void 0&&V)return V.count<V.max&&(t.warn("Variable '"+pe+"' in "+V.name+" could not be found!"),xe=J),V.count===V.max&&t.warn("Too many "+V.name+" warnings - additional warnings will be suppressed"),V.count++,J;if(re){var de;if(re[0]===":"&&(de=Q?Q.numberFormat:t.numberFormat,xe=de(re.replace(D,""))(xe)),re[0]==="|"){de=Q?Q.timeFormat:k;var be=t.dateTime2ms(xe);xe=t.formatDate(be,re.replace(D,""),!1,de)}}else{var Le=pe+"Label";G.hasOwnProperty(Le)&&(xe=G[Le])}return ge&&(xe="("+xe+")",(Z||ne)&&(xe=" "+xe),(le||ne)&&(xe=xe+" ")),xe})}var U=48,X=57;t.subplotSort=function(K,G){for(var Q=Math.min(K.length,G.length)+1,V=0,H=0,ee=0;ee<Q;ee++){var J=K.charCodeAt(ee)||0,W=G.charCodeAt(ee)||0,re=J>=U&&J<=X,j=W>=U&&W<=X;if(re&&(V=10*V+J-U),j&&(H=10*H+W-U),!re||!j){if(V!==H)return V-H;if(J!==W)return J-W}}return H-V};var oe=2e9;t.seedPseudoRandom=function(){oe=2e9},t.pseudoRandom=function(){var K=oe;return oe=(69069*oe+1)%4294967296,Math.abs(oe-K)<429496729?t.pseudoRandom():oe/4294967296},t.fillText=function(K,G,Q){var V=Array.isArray(Q)?function(J){Q.push(J)}:function(J){Q.text=J},H=t.extractOption(K,G,"htx","hovertext");if(t.isValidTextValue(H))return V(H);var ee=t.extractOption(K,G,"tx","text");if(t.isValidTextValue(ee))return V(ee)},t.isValidTextValue=function(K){return K||K===0},t.formatPercent=function(K,G){G=G||0;for(var Q=(Math.round(100*K*Math.pow(10,G))*Math.pow(.1,G)).toFixed(G)+"%",V=0;V<G;V++)Q.indexOf(".")!==-1&&(Q=Q.replace("0%","%"),Q=Q.replace(".%","%"));return Q},t.isHidden=function(K){var G=window.getComputedStyle(K).display;return!G||G==="none"},t.strTranslate=function(K,G){return K||G?"translate("+K+","+G+")":""},t.strRotate=function(K){return K?"rotate("+K+")":""},t.strScale=function(K){return K!==1?"scale("+K+")":""},t.getTextTransform=function(K){var G=K.noCenter,Q=K.textX,V=K.textY,H=K.targetX,ee=K.targetY,J=K.anchorX||0,W=K.anchorY||0,re=K.rotate,j=K.scale;return j?j>1&&(j=1):j=0,t.strTranslate(H-j*(Q+J),ee-j*(V+W))+t.strScale(j)+(re?"rotate("+re+(G?"":" "+Q+" "+V)+")":"")},t.ensureUniformFontSize=function(K,G){var Q=t.extendFlat({},G);return Q.size=Math.max(G.size,K._fullLayout.uniformtext.minsize||0),Q},t.join2=function(K,G,Q){var V=K.length;return V>1?K.slice(0,-1).join(G)+Q+K[V-1]:K.join(G)},t.bigFont=function(K){return Math.round(1.2*K)};var se=t.getFirefoxVersion(),q=se!==null&&se<86;t.getPositionFromD3Event=function(){return q?[b.event.layerX,b.event.layerY]:[b.event.offsetX,b.event.offsetY]}},{"../constants/numerical":479,"./anchor_utils":483,"./angles":484,"./array":485,"./clean_number":486,"./clear_responsive":488,"./coerce":489,"./dates":490,"./dom":491,"./extend":493,"./filter_unique":494,"./filter_visible":495,"./geometry2d":498,"./identity":501,"./increment":502,"./is_plain_object":504,"./keyed_container":505,"./localize":506,"./loggers":507,"./make_trace_groups":508,"./matrix":509,"./mod":510,"./nested_property":511,"./noop":512,"./notifier":513,"./preserve_drawing_buffer":517,"./push_unique":518,"./regex":520,"./relative_attr":521,"./relink_private":522,"./search":523,"./sort_object_keys":526,"./stats":527,"./throttle":530,"./to_log_range":531,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],504:[function(c,ae,ie){"use strict";ae.exports=function(k){return window&&window.process&&window.process.versions?Object.prototype.toString.call(k)==="[object Object]":Object.prototype.toString.call(k)==="[object Object]"&&Object.getPrototypeOf(k).hasOwnProperty("hasOwnProperty")}},{}],505:[function(c,ae,ie){"use strict";var b=c("./nested_property"),k=/^\w*$/,P=0,E=1,e=2,p=3,g=4;ae.exports=function(t,i,n,r){n=n||"name",r=r||"value";var d,s,m,x={};i&&i.length?(m=b(t,i),s=m.get()):s=t,i=i||"";var M={};if(s)for(d=0;d<s.length;d++)M[s[d][n]]=d;var v=k.test(r),_={set:function(l,y){var T=y===null?g:P;if(!s){if(!m||T===g)return;s=[],m.set(s)}var w=M[l];if(w===void 0){if(T===g)return;T=T|p,w=s.length,M[l]=w}else y!==(v?s[w][r]:b(s[w],r).get())&&(T=T|e);var A=s[w]=s[w]||{};return A[n]=l,v?A[r]=y:b(A,r).set(y),y!==null&&(T=T&~g),x[w]=x[w]|T,_},get:function(l){if(!!s){var y=M[l];if(y!==void 0)return v?s[y][r]:b(s[y],r).get()}},rename:function(l,y){var T=M[l];return T===void 0||(x[T]=x[T]|E,M[y]=T,delete M[l],s[T][n]=y),_},remove:function(l){var y=M[l];if(y===void 0)return _;var T=s[y];if(Object.keys(T).length>2)return x[y]=x[y]|e,_.set(l,null);if(v){for(d=y;d<s.length;d++)x[d]=x[d]|p;for(d=y;d<s.length;d++)M[s[d][n]]--;s.splice(y,1),delete M[l]}else b(T,r).set(null),x[y]=x[y]|e|g;return _},constructUpdate:function(){for(var l,y,T={},w=Object.keys(x),A=0;A<w.length;A++)y=w[A],l=i+"["+y+"]",s[y]?(x[y]&E&&(T[l+"."+n]=s[y][n]),x[y]&e&&(v?T[l+"."+r]=x[y]&g?null:s[y][r]:T[l+"."+r]=x[y]&g?null:b(s[y],r).get())):T[l]=null;return T}};return _}},{"./nested_property":511}],506:[function(c,ae,ie){"use strict";var b=c("../registry");ae.exports=function(P,E){for(var e=P._context.locale,p=0;p<2;p++){for(var g=P._context.locales,a=0;a<2;a++){var t=(g[e]||{}).dictionary;if(t){var i=t[E];if(i)return i}g=b.localeRegistry}var n=e.split("-")[0];if(n===e)break;e=n}return E}},{"../registry":638}],507:[function(c,ae,ie){"use strict";var b=c("../plot_api/plot_config").dfltConfig,k=c("./notifier"),P=ae.exports={};P.log=function(){var E;if(b.logging>1){var e=["LOG:"];for(E=0;E<arguments.length;E++)e.push(arguments[E]);console.trace.apply(console,e)}if(b.notifyOnLogging>1){var p=[];for(E=0;E<arguments.length;E++)p.push(arguments[E]);k(p.join("<br>"),"long")}},P.warn=function(){var E;if(b.logging>0){var e=["WARN:"];for(E=0;E<arguments.length;E++)e.push(arguments[E]);console.trace.apply(console,e)}if(b.notifyOnLogging>0){var p=[];for(E=0;E<arguments.length;E++)p.push(arguments[E]);k(p.join("<br>"),"stick")}},P.error=function(){var E;if(b.logging>0){var e=["ERROR:"];for(E=0;E<arguments.length;E++)e.push(arguments[E]);console.error.apply(console,e)}if(b.notifyOnLogging>0){var p=[];for(E=0;E<arguments.length;E++)p.push(arguments[E]);k(p.join("<br>"),"stick")}}},{"../plot_api/plot_config":541,"./notifier":513}],508:[function(c,ae,ie){"use strict";var b=c("@plotly/d3");ae.exports=function(P,E,e){var p=P.selectAll("g."+e.replace(/\s/g,".")).data(E,function(a){return a[0].trace.uid});p.exit().remove(),p.enter().append("g").attr("class",e),p.order();var g=P.classed("rangeplot")?"nodeRangePlot3":"node3";return p.each(function(a){a[0][g]=b.select(this)}),p}},{"@plotly/d3":58}],509:[function(c,ae,ie){"use strict";var b=c("gl-mat4");ie.init2dArray=function(k,P){for(var E=new Array(k),e=0;e<k;e++)E[e]=new Array(P);return E},ie.transposeRagged=function(k){var P=0,E=k.length,e,p;for(e=0;e<E;e++)P=Math.max(P,k[e].length);var g=new Array(P);for(e=0;e<P;e++)for(g[e]=new Array(E),p=0;p<E;p++)g[e][p]=k[p][e];return g},ie.dot=function(k,P){if(!(k.length&&P.length)||k.length!==P.length)return null;var E=k.length,e,p;if(k[0].length)for(e=new Array(E),p=0;p<E;p++)e[p]=ie.dot(k[p],P);else if(P[0].length){var g=ie.transposeRagged(P);for(e=new Array(g.length),p=0;p<g.length;p++)e[p]=ie.dot(k,g[p])}else for(e=0,p=0;p<E;p++)e+=k[p]*P[p];return e},ie.translationMatrix=function(k,P){return[[1,0,k],[0,1,P],[0,0,1]]},ie.rotationMatrix=function(k){var P=k*Math.PI/180;return[[Math.cos(P),-Math.sin(P),0],[Math.sin(P),Math.cos(P),0],[0,0,1]]},ie.rotationXYMatrix=function(k,P,E){return ie.dot(ie.dot(ie.translationMatrix(P,E),ie.rotationMatrix(k)),ie.translationMatrix(-P,-E))},ie.apply3DTransform=function(k){return function(){var P=arguments,E=arguments.length===1?P[0]:[P[0],P[1],P[2]||0];return ie.dot(k,[E[0],E[1],E[2],1]).slice(0,3)}},ie.apply2DTransform=function(k){return function(){var P=arguments;P.length===3&&(P=P[0]);var E=arguments.length===1?P[0]:[P[0],P[1]];return ie.dot(k,[E[0],E[1],1]).slice(0,2)}},ie.apply2DTransform2=function(k){var P=ie.apply2DTransform(k);return function(E){return P(E.slice(0,2)).concat(P(E.slice(2,4)))}},ie.convertCssMatrix=function(k){if(k){var P=k.length;if(P===16)return k;if(P===6)return[k[0],k[1],0,0,k[2],k[3],0,0,0,0,1,0,k[4],k[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},ie.inverseTransformMatrix=function(k){var P=[];return b.invert(P,k),[[P[0],P[1],P[2],P[3]],[P[4],P[5],P[6],P[7]],[P[8],P[9],P[10],P[11]],[P[12],P[13],P[14],P[15]]]}},{"gl-mat4":210}],510:[function(c,ae,ie){"use strict";function b(P,E){var e=P%E;return e<0?e+E:e}function k(P,E){return Math.abs(P)>E/2?P-Math.round(P/E)*E:P}ae.exports={mod:b,modHalf:k}},{}],511:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("./array").isArrayOrTypedArray;ae.exports=function(r,d){if(b(d))d=String(d);else if(typeof d!="string"||d.substr(d.length-4)==="[-1]")throw"bad property string";for(var s=0,m=d.split("."),x,M,v;s<m.length;){if(x=String(m[s]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/),x){if(x[1])m[s]=x[1];else if(s===0)m.splice(0,1);else throw"bad property string";for(M=x[2].substr(1,x[2].length-2).split("]["),v=0;v<M.length;v++)s++,m.splice(s,0,Number(M[v]))}s++}return typeof r!="object"?i(r,d,m):{set:p(r,m,d),get:P(r,m),astr:d,parts:m,obj:r}};function P(n,r){return function(){var d=n,s,m,x,M,v;for(M=0;M<r.length-1;M++){if(s=r[M],s===-1){for(m=!0,x=[],v=0;v<d.length;v++)x[v]=P(d[v],r.slice(M+1))(),x[v]!==x[0]&&(m=!1);return m?x[0]:x}if(typeof s=="number"&&!k(d)||(d=d[s],typeof d!="object"||d===null))return}if(!(typeof d!="object"||d===null)&&(x=d[r[M]],x!==null))return x}}var E=/(^|\.)args\[/;function e(n,r){return n===void 0||n===null&&!r.match(E)}function p(n,r,d){return function(s){var m=n,x="",M=[[n,x]],v=e(s,d),_,l;for(l=0;l<r.length-1;l++){if(_=r[l],typeof _=="number"&&!k(m))throw"array index but container is not an array";if(_===-1){if(v=!a(m,r.slice(l+1),s,d),v)break;return}if(!t(m,_,r[l+1],v))break;if(m=m[_],typeof m!="object"||m===null)throw"container is not an object";x=g(x,_),M.push([m,x])}if(v){if(l===r.length-1&&(delete m[r[l]],Array.isArray(m)&&+r[l]===m.length-1))for(;m.length&&m[m.length-1]===void 0;)m.pop()}else m[r[l]]=s}}function g(n,r){var d=r;return b(r)?d="["+r+"]":n&&(d="."+r),n+d}function a(n,r,d,s){var m=k(d),x=!0,M=d,v=s.replace("-1",0),_=m?!1:e(d,v),l=r[0],y;for(y=0;y<n.length;y++)v=s.replace("-1",y),m&&(M=d[y%d.length],_=e(M,v)),_&&(x=!1),t(n,y,l,_)&&p(n[y],r,s.replace("-1",y))(M);return x}function t(n,r,d,s){if(n[r]===void 0){if(s)return!1;typeof d=="number"?n[r]=[]:n[r]={}}return!0}function i(n,r,d){return{set:function(){throw"bad container"},get:function(){},astr:r,parts:d,obj:n}}},{"./array":485,"fast-isnumeric":190}],512:[function(c,ae,ie){"use strict";ae.exports=function(){}},{}],513:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=[];ae.exports=function(E,e){if(P.indexOf(E)!==-1)return;P.push(E);var p=1e3;k(e)?p=e:e==="long"&&(p=3e3);var g=b.select("body").selectAll(".plotly-notifier").data([0]);g.enter().append("div").classed("plotly-notifier",!0);var a=g.selectAll(".notifier-note").data(P);function t(i){i.duration(700).style("opacity",0).each("end",function(n){var r=P.indexOf(n);r!==-1&&P.splice(r,1),b.select(this).remove()})}a.enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(i){var n=b.select(this);n.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){n.transition().call(t)});for(var r=n.append("p"),d=i.split(/<br\s*\/?>/g),s=0;s<d.length;s++)s&&r.append("br"),r.append("span").text(d[s]);e==="stick"?n.transition().duration(350).style("opacity",1):n.transition().duration(700).style("opacity",1).transition().delay(p).call(t)})}},{"@plotly/d3":58,"fast-isnumeric":190}],514:[function(c,ae,ie){"use strict";var b=c("./setcursor"),k="data-savedcursor",P="!!";ae.exports=function(e,p){var g=e.attr(k);if(p){if(!g){for(var a=(e.attr("class")||"").split(" "),t=0;t<a.length;t++){var i=a[t];i.indexOf("cursor-")===0&&e.attr(k,i.substr(7)).classed(i,!1)}e.attr(k)||e.attr(k,P)}b(e,p)}else g&&(e.attr(k,null),g===P?b(e):b(e,g))}},{"./setcursor":524}],515:[function(c,ae,ie){"use strict";var b=c("./matrix").dot,k=c("../constants/numerical").BADNUM,P=ae.exports={};P.tester=function(e){var p=e.slice(),g=p[0][0],a=g,t=p[0][1],i=t,n;for(p.push(p[0]),n=1;n<p.length;n++)g=Math.min(g,p[n][0]),a=Math.max(a,p[n][0]),t=Math.min(t,p[n][1]),i=Math.max(i,p[n][1]);var r=!1,d;p.length===5&&(p[0][0]===p[1][0]?p[2][0]===p[3][0]&&p[0][1]===p[3][1]&&p[1][1]===p[2][1]&&(r=!0,d=function(v){return v[0]===p[0][0]}):p[0][1]===p[1][1]&&p[2][1]===p[3][1]&&p[0][0]===p[3][0]&&p[1][0]===p[2][0]&&(r=!0,d=function(v){return v[1]===p[0][1]}));function s(v,_){var l=v[0],y=v[1];return!(l===k||l<g||l>a||y===k||y<t||y>i||_&&d(v))}function m(v,_){var l=v[0],y=v[1];if(l===k||l<g||l>a||y===k||y<t||y>i)return!1;var T=p.length,w=p[0][0],A=p[0][1],f=0,u,h,o,S,R;for(u=1;u<T;u++)if(h=w,o=A,w=p[u][0],A=p[u][1],S=Math.min(h,w),!(l<S||l>Math.max(h,w)||y>Math.max(o,A)))if(y<Math.min(o,A))l!==S&&f++;else{if(w===h?R=y:R=o+(l-h)*(A-o)/(w-h),y===R)return!(u===1&&_);y<=R&&l!==S&&f++}return f%2===1}var x=!0,M=p[0];for(n=1;n<p.length;n++)if(M[0]!==p[n][0]||M[1]!==p[n][1]){x=!1;break}return{xmin:g,xmax:a,ymin:t,ymax:i,pts:p,contains:r?s:m,isRect:r,degenerate:x}},P.isSegmentBent=function(e,p,g,a){var t=e[p],i=[e[g][0]-t[0],e[g][1]-t[1]],n=b(i,i),r=Math.sqrt(n),d=[-i[1]/r,i[0]/r],s,m,x;for(s=p+1;s<g;s++)if(m=[e[s][0]-t[0],e[s][1]-t[1]],x=b(m,i),x<0||x>n||Math.abs(b(m,d))>a)return!0;return!1},P.filter=function(e,p){var g=[e[0]],a=0,t=0;function i(r){e.push(r);var d=g.length,s=a;g.splice(t+1);for(var m=s+1;m<e.length;m++)(m===e.length-1||P.isSegmentBent(e,s,m+1,p))&&(g.push(e[m]),g.length<d-2&&(a=m,t=g.length-1),s=m)}if(e.length>1){var n=e.pop();i(n)}return{addPt:i,raw:e,filtered:g}}},{"../constants/numerical":479,"./matrix":509}],516:[function(c,ae,ie){(function(b){(function(){"use strict";var k=c("./show_no_webgl_msg"),P=c("regl");ae.exports=function(e,p,g){var a=e._fullLayout,t=!0;return a._glcanvas.each(function(i){if(i.regl){i.regl.preloadCachedCode(g);return}if(!(i.pick&&!a._has("parcoords"))){try{i.regl=P({canvas:this,attributes:{antialias:!i.pick,preserveDrawingBuffer:!0},pixelRatio:e._context.plotGlPixelRatio||b.devicePixelRatio,extensions:p||[],cachedCode:g||{}})}catch{t=!1}i.regl||(t=!1),t&&this.addEventListener("webglcontextlost",function(n){e&&e.emit&&e.emit("plotly_webglcontextlost",{event:n,layer:i.key})},!1)}}),t||k({container:a._glcontainer.node()}),t}}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":525,regl:283}],517:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("is-mobile");ae.exports=function(e){var p;if(e&&e.hasOwnProperty("userAgent")?p=e.userAgent:p=P(),typeof p!="string")return!0;var g=k({ua:{headers:{"user-agent":p}},tablet:!0,featureDetect:!1});if(!g)for(var a=p.split(" "),t=1;t<a.length;t++){var i=a[t];if(i.indexOf("Safari")!==-1)for(var n=t-1;n>-1;n--){var r=a[n];if(r.substr(0,8)==="Version/"){var d=r.substr(8).split(".")[0];if(b(d)&&(d=+d),d>=13)return!0}}}return g};function P(){var E;return typeof navigator<"u"&&(E=navigator.userAgent),E&&E.headers&&typeof E.headers["user-agent"]=="string"&&(E=E.headers["user-agent"]),E}},{"fast-isnumeric":190,"is-mobile":234}],518:[function(c,ae,ie){"use strict";ae.exports=function(k,P){if(P instanceof RegExp){for(var E=P.toString(),e=0;e<k.length;e++)if(k[e]instanceof RegExp&&k[e].toString()===E)return k;k.push(P)}else(P||P===0)&&k.indexOf(P)===-1&&k.push(P);return k}},{}],519:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("../plot_api/plot_config").dfltConfig;function P(e,p){for(var g=[],a,t=0;t<p.length;t++)a=p[t],a===e?g[t]=a:typeof a=="object"?g[t]=Array.isArray(a)?b.extendDeep([],a):b.extendDeepAll({},a):g[t]=a;return g}var E={};E.add=function(e,p,g,a,t){var i,n;if(e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},n=e.undoQueue.index,e.autoplay){e.undoQueue.inSequence||(e.autoplay=!1);return}!e.undoQueue.sequence||e.undoQueue.beginSequence?(i={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},e.undoQueue.queue.splice(n,e.undoQueue.queue.length-n,i),e.undoQueue.index+=1):i=e.undoQueue.queue[n-1],e.undoQueue.beginSequence=!1,i&&(i.undo.calls.unshift(p),i.undo.args.unshift(g),i.redo.calls.push(a),i.redo.args.push(t)),e.undoQueue.queue.length>k.queueLength&&(e.undoQueue.queue.shift(),e.undoQueue.index--)},E.startSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!0,e.undoQueue.beginSequence=!0},E.stopSequence=function(e){e.undoQueue=e.undoQueue||{index:0,queue:[],sequence:!1},e.undoQueue.sequence=!1,e.undoQueue.beginSequence=!1},E.undo=function(p){var g,a;if(!(p.undoQueue===void 0||isNaN(p.undoQueue.index)||p.undoQueue.index<=0)){for(p.undoQueue.index--,g=p.undoQueue.queue[p.undoQueue.index],p.undoQueue.inSequence=!0,a=0;a<g.undo.calls.length;a++)E.plotDo(p,g.undo.calls[a],g.undo.args[a]);p.undoQueue.inSequence=!1,p.autoplay=!1}},E.redo=function(p){var g,a;if(!(p.undoQueue===void 0||isNaN(p.undoQueue.index)||p.undoQueue.index>=p.undoQueue.queue.length)){for(g=p.undoQueue.queue[p.undoQueue.index],p.undoQueue.inSequence=!0,a=0;a<g.redo.calls.length;a++)E.plotDo(p,g.redo.calls[a],g.redo.args[a]);p.undoQueue.inSequence=!1,p.autoplay=!1,p.undoQueue.index++}},E.plotDo=function(e,p,g){e.autoplay=!0,g=P(e,g),p.apply(null,g)},ae.exports=E},{"../lib":503,"../plot_api/plot_config":541}],520:[function(c,ae,ie){"use strict";ie.counter=function(b,k,P,E){var e=(k||"")+(P?"":"$"),p=E===!1?"":"^";return b==="xy"?new RegExp(p+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(p+b+"([2-9]|[1-9][0-9]+)?"+e)}},{}],521:[function(c,ae,ie){"use strict";var b=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,k=/^[^\.\[\]]+$/;ae.exports=function(P,E){for(;E;){var e=P.match(b);if(e)P=e[1];else if(P.match(k))P="";else throw new Error("bad relativeAttr call:"+[P,E]);if(E.charAt(0)==="^")E=E.slice(1);else break}return P&&E.charAt(0)!=="["?P+"."+E:P+E}},{}],522:[function(c,ae,ie){"use strict";var b=c("./array").isArrayOrTypedArray,k=c("./is_plain_object");ae.exports=function P(E,e){for(var p in e){var g=e[p],a=E[p];if(a!==g)if(p.charAt(0)==="_"||typeof g=="function"){if(p in E)continue;E[p]=g}else if(b(g)&&b(a)&&k(g[0])){if(p==="customdata"||p==="ids")continue;for(var t=Math.min(g.length,a.length),i=0;i<t;i++)a[i]!==g[i]&&k(g[i])&&k(a[i])&&P(a[i],g[i])}else k(g)&&k(a)&&(P(a,g),Object.keys(a).length||delete E[p])}}},{"./array":485,"./is_plain_object":504}],523:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("./loggers"),P=c("./identity"),E=c("../constants/numerical").BADNUM,e=1e-9;ie.findBin=function(i,n,r){if(b(n.start))return r?Math.ceil((i-n.start)/n.size-e)-1:Math.floor((i-n.start)/n.size+e);var d=0,s=n.length,m=0,x=s>1?(n[s-1]-n[0])/(s-1):1,M,v;for(x>=0?v=r?p:g:v=r?t:a,i+=x*e*(r?-1:1)*(x>=0?1:-1);d<s&&m++<100;)M=Math.floor((d+s)/2),v(n[M],i)?d=M+1:s=M;return m>90&&k.log("Long binary search..."),d-1};function p(i,n){return i<n}function g(i,n){return i<=n}function a(i,n){return i>n}function t(i,n){return i>=n}ie.sorterAsc=function(i,n){return i-n},ie.sorterDes=function(i,n){return n-i},ie.distinctVals=function(i){var n=i.slice();n.sort(ie.sorterAsc);var r;for(r=n.length-1;r>-1&&n[r]===E;r--);for(var d=n[r]-n[0]||1,s=d/(r||1)/1e4,m=[],x,M=0;M<=r;M++){var v=n[M],_=v-x;x===void 0?(m.push(v),x=v):_>s&&(d=Math.min(d,_),m.push(v),x=v)}return{vals:m,minDiff:d}},ie.roundUp=function(i,n,r){for(var d=0,s=n.length-1,m,x=0,M=r?0:1,v=r?1:0,_=r?Math.ceil:Math.floor;d<s&&x++<100;)m=_((d+s)/2),n[m]<=i?d=m+M:s=m-v;return n[d]},ie.sort=function(i,n){for(var r=0,d=0,s=1;s<i.length;s++){var m=n(i[s],i[s-1]);if(m<0?r=1:m>0&&(d=1),r&&d)return i.sort(n)}return d?i:i.reverse()},ie.findIndexOfMin=function(i,n){n=n||P;for(var r=1/0,d,s=0;s<i.length;s++){var m=n(i[s]);m<r&&(r=m,d=s)}return d}},{"../constants/numerical":479,"./identity":501,"./loggers":507,"fast-isnumeric":190}],524:[function(c,ae,ie){"use strict";ae.exports=function(k,P){(k.attr("class")||"").split(" ").forEach(function(E){E.indexOf("cursor-")===0&&k.classed(E,!1)}),P&&k.classed("cursor-"+P,!0)}},{}],525:[function(c,ae,ie){"use strict";var b=c("../components/color"),k=function(){};ae.exports=function(E){for(var e in E)typeof E[e]=="function"&&(E[e]=k);E.destroy=function(){E.container.parentNode.removeChild(E.container)};var p=document.createElement("div");p.className="no-webgl",p.style.cursor="pointer",p.style.fontSize="24px",p.style.color=b.defaults[0],p.style.position="absolute",p.style.left=p.style.top="0px",p.style.width=p.style.height="100%",p.style["background-color"]=b.lightLine,p.style["z-index"]=30;var g=document.createElement("p");return g.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",g.style.position="relative",g.style.top="50%",g.style.left="50%",g.style.height="30%",g.style.width="50%",g.style.margin="-15% 0 0 -25%",p.appendChild(g),E.container.appendChild(p),E.container.style.background="#FFFFFF",E.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":366}],526:[function(c,ae,ie){"use strict";ae.exports=function(k){return Object.keys(k).sort()}},{}],527:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("./array").isArrayOrTypedArray;ie.aggNums=function(P,E,e,p){var g,a;if((!p||p>e.length)&&(p=e.length),b(E)||(E=!1),k(e[0])){for(a=new Array(p),g=0;g<p;g++)a[g]=ie.aggNums(P,E,e[g]);e=a}for(g=0;g<p;g++)b(E)?b(e[g])&&(E=P(+E,+e[g])):E=e[g];return E},ie.len=function(P){return ie.aggNums(function(E){return E+1},0,P)},ie.mean=function(P,E){return E||(E=ie.len(P)),ie.aggNums(function(e,p){return e+p},0,P)/E},ie.midRange=function(P){if(!(P===void 0||P.length===0))return(ie.aggNums(Math.max,null,P)+ie.aggNums(Math.min,null,P))/2},ie.variance=function(P,E,e){return E||(E=ie.len(P)),b(e)||(e=ie.mean(P,E)),ie.aggNums(function(p,g){return p+Math.pow(g-e,2)},0,P)/E},ie.stdev=function(P,E,e){return Math.sqrt(ie.variance(P,E,e))},ie.median=function(P){var E=P.slice().sort();return ie.interp(E,.5)},ie.interp=function(P,E){if(!b(E))throw"n should be a finite number";if(E=E*P.length-.5,E<0)return P[0];if(E>P.length-1)return P[P.length-1];var e=E%1;return e*P[Math.ceil(E)]+(1-e)*P[Math.floor(E)]}},{"./array":485,"fast-isnumeric":190}],528:[function(c,ae,ie){"use strict";var b=c("color-normalize");function k(P){return P?b(P):[0,0,0,1]}ae.exports=k},{"color-normalize":89}],529:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../lib"),P=k.strTranslate,E=c("../constants/xmlns_namespaces"),e=c("../constants/alignment").LINE_SPACING,p=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;ie.convertToTspans=function(D,B,U){var X=D.text(),oe=!D.attr("data-notex")&&B&&B._context.typesetMath&&typeof MathJax<"u"&&X.match(p),se=b.select(D.node().parentNode);if(se.empty())return;var q=D.attr("class")?D.attr("class").split(" ")[0]:"text";q+="-math",se.selectAll("svg."+q).remove(),se.selectAll("g."+q+"-group").remove(),D.style("display",null).attr({"data-unformatted":X,"data-math":"N"});function K(){se.empty()||(q=D.attr("class")+"-math",se.select("svg."+q).remove()),D.text("").style("white-space","pre");var G=z(D.node(),X);G&&D.style("pointer-events","all"),ie.positionText(D),U&&U.call(D)}return oe?(B&&B._promises||[]).push(new Promise(function(G){D.style("display","none");var Q=parseInt(D.node().style.fontSize,10),V={fontSize:Q};n(oe[2],V,function(H,ee,J){se.selectAll("svg."+q).remove(),se.selectAll("g."+q+"-group").remove();var W=H&&H.select("svg");if(!W||!W.node()){K(),G();return}var re=se.append("g").classed(q+"-group",!0).attr({"pointer-events":"none","data-unformatted":X,"data-math":"Y"});re.node().appendChild(W.node()),ee&&ee.node()&&W.node().insertBefore(ee.node().cloneNode(!0),W.node().firstChild);var j=J.width,Z=J.height;W.attr({class:q,height:Z,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var ne=D.node().style.fill||"black",le=W.select("g");le.attr({fill:ne,stroke:ne});var ge=le.node().getBoundingClientRect(),pe=ge.width,xe=ge.height;(pe>j||xe>Z)&&(W.style("overflow","hidden"),ge=W.node().getBoundingClientRect(),pe=ge.width,xe=ge.height);var Ee=+D.attr("x"),Te=+D.attr("y"),de=Q||D.node().getBoundingClientRect().height,be=-de/4;if(q[0]==="y")re.attr({transform:"rotate("+[-90,Ee,Te]+")"+P(-pe/2,be-xe/2)});else if(q[0]==="l")Te=be-xe/2;else if(q[0]==="a"&&q.indexOf("atitle")!==0)Ee=0,Te=be;else{var Le=D.attr("text-anchor");Ee=Ee-pe*(Le==="middle"?.5:Le==="end"?1:0),Te=Te+be-xe/2}W.attr({x:Ee,y:Te}),U&&U.call(D,re),G(re)})})):K(),D};var g=/(<|&lt;|&#60;)/g,a=/(>|&gt;|&#62;)/g;function t(D){return D.replace(g,"\\lt ").replace(a,"\\gt ")}var i=[["$","$"],["\\(","\\)"]];function n(D,B,U){var X=parseInt((MathJax.version||"").split(".")[0]);if(X!==2&&X!==3){k.warn("No MathJax version:",MathJax.version);return}var oe,se,q,K,G=function(){return se=k.extendDeepAll({},MathJax.Hub.config),q=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:i},displayAlign:"left"})},Q=function(){se=k.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=i},V=function(){if(oe=MathJax.Hub.config.menuSettings.renderer,oe!=="SVG")return MathJax.Hub.setRenderer("SVG")},H=function(){oe=MathJax.config.startup.output,oe!=="svg"&&(MathJax.config.startup.output="svg")},ee=function(){var ne="math-output-"+k.randstr({},64);K=b.select("body").append("div").attr({id:ne}).style({visibility:"hidden",position:"absolute","font-size":B.fontSize+"px"}).text(t(D));var le=K.node();return X===2?MathJax.Hub.Typeset(le):MathJax.typeset([le])},J=function(){var ne=K.select(X===2?".MathJax_SVG":".MathJax"),le=!ne.empty()&&K.select("svg").node();if(!le)k.log("There was an error in the tex syntax.",D),U();else{var ge=le.getBoundingClientRect(),pe;X===2?pe=b.select("body").select("#MathJax_SVG_glyphs"):pe=ne.select("defs"),U(ne,pe,ge)}K.remove()},W=function(){if(oe!=="SVG")return MathJax.Hub.setRenderer(oe)},re=function(){oe!=="svg"&&(MathJax.config.startup.output=oe)},j=function(){return q!==void 0&&(MathJax.Hub.processSectionDelay=q),MathJax.Hub.Config(se)},Z=function(){MathJax.config=se};X===2?MathJax.Hub.Queue(G,V,ee,J,W,j):X===3&&(Q(),H(),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){ee(),J(),re(),Z()}))}var r={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},d={sub:"0.3em",sup:"-0.6em"},s={sub:"-0.21em",sup:"0.42em"},m="\u200B",x=["http:","https:","mailto:","",void 0,":"],M=ie.NEWLINES=/(\r\n?|\n)/g,v=/(<[^<>]*>)/,_=/<(\/?)([^ >]*)(\s+(.*))?>/i,l=/<br(\s+.*)?>/i;ie.BR_TAG_ALL=/<br(\s+.*)?>/gi;var y=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,T=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,w=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,A=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function f(D,B){if(!D)return null;var U=D.match(B),X=U&&(U[3]||U[4]);return X&&S(X)}var u=/(^|;)\s*color:/;ie.plainText=function(D,B){B=B||{};for(var U=B.len!==void 0&&B.len!==-1?B.len:1/0,X=B.allowedTags!==void 0?B.allowedTags:["br"],oe="...",se=oe.length,q=D.split(v),K=[],G="",Q=0,V=0;V<q.length;V++){var H=q[V],ee=H.match(_),J=ee&&ee[2].toLowerCase();if(J)X.indexOf(J)!==-1&&(K.push(H),G=J);else{var W=H.length;if(Q+W<U)K.push(H),Q+=W;else if(Q<U){var re=U-Q;G&&(G!=="br"||re<=se||W<=se)&&K.pop(),U>se?K.push(H.substr(0,re-se)+oe):K.push(H.substr(0,re));break}G=""}}return K.join("")};var h={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},o=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function S(D){return D.replace(o,function(B,U){var X;return U.charAt(0)==="#"?X=R(U.charAt(1)==="x"?parseInt(U.substr(2),16):parseInt(U.substr(1),10)):X=h[U],X||B})}ie.convertEntities=S;function R(D){if(!(D>1114111)){var B=String.fromCodePoint;if(B)return B(D);var U=String.fromCharCode;return D<=65535?U(D):U((D>>10)+55232,D%1024+56320)}}function z(D,B){B=B.replace(M," ");var U=!1,X=[],oe,se=-1;function q(){se++;var xe=document.createElementNS(E.svg,"tspan");b.select(xe).attr({class:"line",dy:se*e+"em"}),D.appendChild(xe),oe=xe;var Ee=X;if(X=[{node:xe}],Ee.length>1)for(var Te=1;Te<Ee.length;Te++)K(Ee[Te])}function K(xe){var Ee=xe.type,Te={},de;if(Ee==="a"){de="a";var be=xe.target,Le=xe.href,De=xe.popup;Le&&(Te={"xlink:xlink:show":be==="_blank"||be.charAt(0)!=="_"?"new":"replace",target:be,"xlink:xlink:href":Le},De&&(Te.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+De+'");return false;'))}else de="tspan";xe.style&&(Te.style=xe.style);var ye=document.createElementNS(E.svg,de);if(Ee==="sup"||Ee==="sub"){G(oe,m),oe.appendChild(ye);var ke=document.createElementNS(E.svg,"tspan");G(ke,m),b.select(ke).attr("dy",s[Ee]),Te.dy=d[Ee],oe.appendChild(ye),oe.appendChild(ke)}else oe.appendChild(ye);b.select(ye).attr(Te),oe=xe.node=ye,X.push(xe)}function G(xe,Ee){xe.appendChild(document.createTextNode(Ee))}function Q(xe){if(X.length===1){k.log("Ignoring unexpected end tag </"+xe+">.",B);return}var Ee=X.pop();xe!==Ee.type&&k.log("Start tag <"+Ee.type+"> doesnt match end tag <"+xe+">. Pretending it did match.",B),oe=X[X.length-1].node}var V=l.test(B);V?q():(oe=D,X=[{node:D}]);for(var H=B.split(v),ee=0;ee<H.length;ee++){var J=H[ee],W=J.match(_),re=W&&W[2].toLowerCase(),j=r[re];if(re==="br")q();else if(j===void 0)G(oe,S(J));else if(W[1])Q(re);else{var Z=W[4],ne={type:re},le=f(Z,y);if(le?(le=le.replace(u,"$1 fill:"),j&&(le+=";"+j)):j&&(le=j),le&&(ne.style=le),re==="a"){U=!0;var ge=f(Z,T);if(ge){var pe=O(ge);pe&&(ne.href=pe,ne.target=f(Z,w)||"_blank",ne.popup=f(Z,A))}}K(ne)}}return U}function O(D){var B=encodeURI(decodeURI(D)),U=document.createElement("a"),X=document.createElement("a");U.href=D,X.href=B;var oe=U.protocol,se=X.protocol;return x.indexOf(oe)!==-1&&x.indexOf(se)!==-1?B:""}ie.sanitizeHTML=function(B){B=B.replace(M," ");for(var U=document.createElement("p"),X=U,oe=[],se=B.split(v),q=0;q<se.length;q++){var K=se[q],G=K.match(_),Q=G&&G[2].toLowerCase();if(Q in r)if(G[1])oe.length&&(X=oe.pop());else{var V=G[4],H=f(V,y),ee=H?{style:H}:{};if(Q==="a"){var J=f(V,T);if(J){var W=O(J);if(W){ee.href=W;var re=f(V,w);re&&(ee.target=re)}}}var j=document.createElement(Q);X.appendChild(j),b.select(j).attr(ee),X=j,oe.push(j)}else X.appendChild(document.createTextNode(S(K)))}var Z="innerHTML";return U[Z]},ie.lineCount=function(B){return B.selectAll("tspan.line").size()||1},ie.positionText=function(B,U,X){return B.each(function(){var oe=b.select(this);function se(G,Q){return Q===void 0?(Q=oe.attr(G),Q===null&&(oe.attr(G,0),Q=0)):oe.attr(G,Q),Q}var q=se("x",U),K=se("y",X);this.nodeName==="text"&&oe.selectAll("tspan.line").attr({x:q,y:K})})};function I(D,B,U){var X=U.horizontalAlign,oe=U.verticalAlign||"top",se=D.node().getBoundingClientRect(),q=B.node().getBoundingClientRect(),K,G,Q;return oe==="bottom"?G=function(){return se.bottom-K.height}:oe==="middle"?G=function(){return se.top+(se.height-K.height)/2}:G=function(){return se.top},X==="right"?Q=function(){return se.right-K.width}:X==="center"?Q=function(){return se.left+(se.width-K.width)/2}:Q=function(){return se.left},function(){K=this.node().getBoundingClientRect();var V=Q()-q.left,H=G()-q.top,ee=U.gd||{};if(U.gd){ee._fullLayout._calcInverseTransform(ee);var J=k.apply3DTransform(ee._fullLayout._invTransform)(V,H);V=J[0],H=J[1]}return this.style({top:H+"px",left:V+"px","z-index":1e3}),this}}var F="1px ";ie.makeTextShadow=function(D){var B=F,U=F,X=F;return B+U+X+D+", -"+B+"-"+U+X+D+", "+B+"-"+U+X+D+", -"+B+U+X+D},ie.makeEditable=function(D,B){var U=B.gd,X=B.delegate,oe=b.dispatch("edit","input","cancel"),se=X||D;if(D.style({"pointer-events":X?"none":"all"}),D.size()!==1)throw new Error("boo");function q(){G(),D.style({opacity:0});var Q=se.attr("class"),V;Q?V="."+Q.split(" ")[0]+"-math-group":V="[class*=-math-group]",V&&b.select(D.node().parentNode).select(V).style({opacity:0})}function K(Q){var V=Q.node(),H=document.createRange();H.selectNodeContents(V);var ee=window.getSelection();ee.removeAllRanges(),ee.addRange(H),V.focus()}function G(){var Q=b.select(U),V=Q.select(".svg-container"),H=V.append("div"),ee=D.node().style,J=parseFloat(ee.fontSize||12),W=B.text;W===void 0&&(W=D.attr("data-unformatted")),H.classed("plugin-editable editable",!0).style({position:"absolute","font-family":ee.fontFamily||"Arial","font-size":J,color:B.fill||ee.fill||"black",opacity:1,"background-color":B.background||"transparent",outline:"#ffffff33 1px solid",margin:[-J/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(W).call(I(D,V,B)).on("blur",function(){U._editing=!1,D.text(this.textContent).style({opacity:1});var re=b.select(this).attr("class"),j;re?j="."+re.split(" ")[0]+"-math-group":j="[class*=-math-group]",j&&b.select(D.node().parentNode).select(j).style({opacity:0});var Z=this.textContent;b.select(this).transition().duration(0).remove(),b.select(document).on("mouseup",null),oe.edit.call(D,Z)}).on("focus",function(){var re=this;U._editing=!0,b.select(document).on("mouseup",function(){if(b.event.target===re)return!1;document.activeElement===H.node()&&H.node().blur()})}).on("keyup",function(){b.event.which===27?(U._editing=!1,D.style({opacity:1}),b.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),oe.cancel.call(D,this.textContent)):(oe.input.call(D,this.textContent),b.select(this).call(I(D,V,B)))}).on("keydown",function(){b.event.which===13&&this.blur()}).call(K)}return B.immediate?q():se.on("click",q),b.rebind(D,oe,"on")}},{"../constants/alignment":471,"../constants/xmlns_namespaces":480,"../lib":503,"@plotly/d3":58}],530:[function(c,ae,ie){"use strict";var b={};ie.throttle=function(E,e,p){var g=b[E],a=Date.now();if(!g){for(var t in b)b[t].ts<a-6e4&&delete b[t];g=b[E]={ts:0,timer:null}}k(g);function i(){p(),g.ts=Date.now(),g.onDone&&(g.onDone(),g.onDone=null)}if(a>g.ts+e){i();return}g.timer=setTimeout(function(){i(),g.timer=null},e)},ie.done=function(P){var E=b[P];return!E||!E.timer?Promise.resolve():new Promise(function(e){var p=E.onDone;E.onDone=function(){p&&p(),e(),E.onDone=null}})},ie.clear=function(P){if(P)k(b[P]),delete b[P];else for(var E in b)ie.clear(E)};function k(P){P&&P.timer!==null&&(clearTimeout(P.timer),P.timer=null)}},{}],531:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric");ae.exports=function(P,E){if(P>0)return Math.log(P)/Math.LN10;var e=Math.log(Math.min(E[0],E[1]))/Math.LN10;return b(e)||(e=Math.log(Math.max(E[0],E[1]))/Math.LN10-6),e}},{"fast-isnumeric":190}],532:[function(c,ae,ie){"use strict";var b=ae.exports={},k=c("../plots/geo/constants").locationmodeToLayer,P=c("topojson-client").feature;b.getTopojsonName=function(E){return[E.scope.replace(/ /g,"-"),"_",E.resolution.toString(),"m"].join("")},b.getTopojsonPath=function(E,e){return E+e+".json"},b.getTopojsonFeatures=function(E,e){var p=k[E.locationmode],g=e.objects[p];return P(e,g).features}},{"../plots/geo/constants":587,"topojson-client":315}],533:[function(c,ae,ie){"use strict";ae.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],534:[function(c,ae,ie){"use strict";ae.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],535:[function(c,ae,ie){"use strict";var b=c("../registry");ae.exports=function(P){for(var E=b.layoutArrayContainers,e=b.layoutArrayRegexes,p=P.split("[")[0],g,a,t=0;t<e.length;t++)if(a=P.match(e[t]),a&&a.index===0){g=a[0];break}if(g||(g=E[E.indexOf(p)]),!g)return!1;var i=P.substr(g.length);return i?(a=i.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/),a?{array:g,index:Number(a[1]),property:a[3]||""}:!1):{array:g,index:"",property:""}}},{"../registry":638}],536:[function(c,ae,ie){"use strict";var b=c("../lib"),k=b.extendFlat,P=b.isPlainObject,E={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},p=E.flags.slice().concat(["fullReplot"]),g=e.flags.slice().concat("layoutReplot");ae.exports={traces:E,layout:e,traceFlags:function(){return a(p)},layoutFlags:function(){return a(g)},update:function(n,r){var d=r.editType;if(d&&d!=="none")for(var s=d.split("+"),m=0;m<s.length;m++)n[s[m]]=!0},overrideAll:t};function a(n){for(var r={},d=0;d<n.length;d++)r[n[d]]=!1;return r}function t(n,r,d){var s=k({},n);for(var m in s){var x=s[m];P(x)&&(s[m]=i(x,r,d,m))}return d==="from-root"&&(s.editType=r),s}function i(n,r,d,s){if(n.valType){var m=k({},n);if(m.editType=r,Array.isArray(n.items)){m.items=new Array(n.items.length);for(var x=0;x<n.items.length;x++)m.items[x]=i(n.items[x],r,"from-root")}return m}else return t(n,r,s.charAt(0)==="_"?"nested":"from-root")}},{"../lib":503}],537:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("gl-mat4/fromQuat"),P=c("../registry"),E=c("../lib"),e=c("../plots/plots"),p=c("../plots/cartesian/axis_ids"),g=c("../components/color"),a=p.cleanId,t=p.getFromTrace,i=P.traceIs;ie.clearPromiseQueue=function(l){Array.isArray(l._promises)&&l._promises.length>0&&E.log("Clearing previous rejected promises from queue."),l._promises=[]},ie.cleanLayout=function(l){var y,T;l||(l={}),l.xaxis1&&(l.xaxis||(l.xaxis=l.xaxis1),delete l.xaxis1),l.yaxis1&&(l.yaxis||(l.yaxis=l.yaxis1),delete l.yaxis1),l.scene1&&(l.scene||(l.scene=l.scene1),delete l.scene1);var w=(e.subplotsRegistry.cartesian||{}).attrRegex,A=(e.subplotsRegistry.polar||{}).attrRegex,f=(e.subplotsRegistry.ternary||{}).attrRegex,u=(e.subplotsRegistry.gl3d||{}).attrRegex,h=Object.keys(l);for(y=0;y<h.length;y++){var o=h[y];if(w&&w.test(o)){var S=l[o];S.anchor&&S.anchor!=="free"&&(S.anchor=a(S.anchor)),S.overlaying&&(S.overlaying=a(S.overlaying)),S.type||(S.isdate?S.type="date":S.islog?S.type="log":S.isdate===!1&&S.islog===!1&&(S.type="linear")),(S.autorange==="withzero"||S.autorange==="tozero")&&(S.autorange=!0,S.rangemode="tozero"),delete S.islog,delete S.isdate,delete S.categories,x(S,"domain")&&delete S.domain,S.autotick!==void 0&&(S.tickmode===void 0&&(S.tickmode=S.autotick?"auto":"linear"),delete S.autotick),r(S)}else if(A&&A.test(o)){var R=l[o];r(R.radialaxis)}else if(f&&f.test(o)){var z=l[o];r(z.aaxis),r(z.baxis),r(z.caxis)}else if(u&&u.test(o)){var O=l[o],I=O.cameraposition;if(Array.isArray(I)&&I[0].length===4){var F=I[0],D=I[1],B=I[2],U=k([],F),X=[];for(T=0;T<3;++T)X[T]=D[T]+B*U[2+4*T];O.camera={eye:{x:X[0],y:X[1],z:X[2]},center:{x:D[0],y:D[1],z:D[2]},up:{x:0,y:0,z:1}},delete O.cameraposition}r(O.xaxis),r(O.yaxis),r(O.zaxis)}}var oe=Array.isArray(l.annotations)?l.annotations.length:0;for(y=0;y<oe;y++){var se=l.annotations[y];!E.isPlainObject(se)||(se.ref&&(se.ref==="paper"?(se.xref="paper",se.yref="paper"):se.ref==="data"&&(se.xref="x",se.yref="y"),delete se.ref),n(se,"xref"),n(se,"yref"))}var q=Array.isArray(l.shapes)?l.shapes.length:0;for(y=0;y<q;y++){var K=l.shapes[y];!E.isPlainObject(K)||(n(K,"xref"),n(K,"yref"))}var G=Array.isArray(l.images)?l.images.length:0;for(y=0;y<G;y++){var Q=l.images[y];!E.isPlainObject(Q)||(n(Q,"xref"),n(Q,"yref"))}var V=l.legend;return V&&(V.x>3?(V.x=1.02,V.xanchor="left"):V.x<-2&&(V.x=-.02,V.xanchor="right"),V.y>3?(V.y=1.02,V.yanchor="bottom"):V.y<-2&&(V.y=-.02,V.yanchor="top")),r(l),l.dragmode==="rotate"&&(l.dragmode="orbit"),g.clean(l),l.template&&l.template.layout&&ie.cleanLayout(l.template.layout),l};function n(l,y){var T=l[y],w=y.charAt(0);T&&T!=="paper"&&(l[y]=a(T,w,!0))}function r(l){l&&((typeof l.title=="string"||typeof l.title=="number")&&(l.title={text:l.title}),y("titlefont","font"),y("titleposition","position"),y("titleside","side"),y("titleoffset","offset"));function y(T,w){var A=l[T],f=l.title&&l.title[w];A&&!f&&(l.title||(l.title={}),l.title[w]=l[T],delete l[T])}}ie.cleanData=function(l){for(var y=0;y<l.length;y++){var T=l[y],w;if(T.type==="histogramy"&&"xbins"in T&&!("ybins"in T)&&(T.ybins=T.xbins,delete T.xbins),T.error_y&&"opacity"in T.error_y){var A=g.defaults,f=T.error_y.color||(i(T,"bar")?g.defaultLine:A[y%A.length]);T.error_y.color=g.addOpacity(g.rgb(f),g.opacity(f)*T.error_y.opacity),delete T.error_y.opacity}if("bardir"in T&&(T.bardir==="h"&&(i(T,"bar")||T.type.substr(0,9)==="histogram")&&(T.orientation="h",ie.swapXYData(T)),delete T.bardir),T.type==="histogramy"&&ie.swapXYData(T),(T.type==="histogramx"||T.type==="histogramy")&&(T.type="histogram"),"scl"in T&&!("colorscale"in T)&&(T.colorscale=T.scl,delete T.scl),"reversescl"in T&&!("reversescale"in T)&&(T.reversescale=T.reversescl,delete T.reversescl),T.xaxis&&(T.xaxis=a(T.xaxis,"x")),T.yaxis&&(T.yaxis=a(T.yaxis,"y")),i(T,"gl3d")&&T.scene&&(T.scene=e.subplotsRegistry.gl3d.cleanId(T.scene)),!i(T,"pie-like")&&!i(T,"bar-like"))if(Array.isArray(T.textposition))for(w=0;w<T.textposition.length;w++)T.textposition[w]=m(T.textposition[w]);else T.textposition&&(T.textposition=m(T.textposition));var u=P.getModule(T);if(u&&u.colorbar){var h=u.colorbar.container,o=h?T[h]:T;o&&o.colorscale&&(o.colorscale==="YIGnBu"&&(o.colorscale="YlGnBu"),o.colorscale==="YIOrRd"&&(o.colorscale="YlOrRd"))}if(T.type==="surface"&&E.isPlainObject(T.contours)){var S=["x","y","z"];for(w=0;w<S.length;w++){var R=T.contours[S[w]];!E.isPlainObject(R)||(R.highlightColor&&(R.highlightcolor=R.highlightColor,delete R.highlightColor),R.highlightWidth&&(R.highlightwidth=R.highlightWidth,delete R.highlightWidth))}}if(T.type==="candlestick"||T.type==="ohlc"){var z=(T.increasing||{}).showlegend!==!1,O=(T.decreasing||{}).showlegend!==!1,I=d(T.increasing),F=d(T.decreasing);if(I!==!1&&F!==!1){var D=s(I,F,z,O);D&&(T.name=D)}else(I||F)&&!T.name&&(T.name=I||F)}if(Array.isArray(T.transforms)){var B=T.transforms;for(w=0;w<B.length;w++){var U=B[w];if(!!E.isPlainObject(U))switch(U.type){case"filter":U.filtersrc&&(U.target=U.filtersrc,delete U.filtersrc),U.calendar&&(U.valuecalendar||(U.valuecalendar=U.calendar),delete U.calendar);break;case"groupby":if(U.styles=U.styles||U.style,U.styles&&!Array.isArray(U.styles)){var X=U.styles,oe=Object.keys(X);U.styles=[];for(var se=0;se<oe.length;se++)U.styles.push({target:oe[se],value:X[oe[se]]})}break}}}x(T,"line")&&delete T.line,"marker"in T&&(x(T.marker,"line")&&delete T.marker.line,x(T,"marker")&&delete T.marker),g.clean(T),T.autobinx&&(delete T.autobinx,delete T.xbins),T.autobiny&&(delete T.autobiny,delete T.ybins),r(T),T.colorbar&&r(T.colorbar),T.marker&&T.marker.colorbar&&r(T.marker.colorbar),T.line&&T.line.colorbar&&r(T.line.colorbar),T.aaxis&&r(T.aaxis),T.baxis&&r(T.baxis)}};function d(l){if(!E.isPlainObject(l))return!1;var y=l.name;return delete l.name,delete l.showlegend,(typeof y=="string"||typeof y=="number")&&String(y)}function s(l,y,T,w){if(T&&!w)return l;if(w&&!T||!l.trim())return y;if(!y.trim())return l;var A=Math.min(l.length,y.length),f;for(f=0;f<A&&l.charAt(f)===y.charAt(f);f++);var u=l.substr(0,f);return u.trim()}function m(l){var y="middle",T="center";return typeof l=="string"&&(l.indexOf("top")!==-1?y="top":l.indexOf("bottom")!==-1&&(y="bottom"),l.indexOf("left")!==-1?T="left":l.indexOf("right")!==-1&&(T="right")),y+" "+T}function x(l,y){return y in l&&typeof l[y]=="object"&&Object.keys(l[y]).length===0}ie.swapXYData=function(l){var y;if(E.swapAttrs(l,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(l.z)&&Array.isArray(l.z[0])&&(l.transpose?delete l.transpose:l.transpose=!0),l.error_x&&l.error_y){var T=l.error_y,w="copy_ystyle"in T?T.copy_ystyle:!(T.color||T.thickness||T.width);E.swapAttrs(l,["error_?.copy_ystyle"]),w&&E.swapAttrs(l,["error_?.color","error_?.thickness","error_?.width"])}if(typeof l.hoverinfo=="string"){var A=l.hoverinfo.split("+");for(y=0;y<A.length;y++)A[y]==="x"?A[y]="y":A[y]==="y"&&(A[y]="x");l.hoverinfo=A.join("+")}},ie.coerceTraceIndices=function(l,y){if(b(y))return[y];if(!Array.isArray(y)||!y.length)return l.data.map(function(A,f){return f});if(Array.isArray(y)){for(var T=[],w=0;w<y.length;w++)E.isIndex(y[w],l.data.length)?T.push(y[w]):E.warn("trace index (",y[w],") is not a number or is out of bounds");return T}return y},ie.manageArrayContainers=function(l,y,T){var w=l.obj,A=l.parts,f=A.length,u=A[f-1],h=b(u);if(h&&y===null){var o=A.slice(0,f-1).join("."),S=E.nestedProperty(w,o).get();S.splice(u,1)}else h&&l.get()===void 0&&l.get()===void 0&&(T[l.astr]=null),l.set(y)};var M=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function v(l){var y=l.search(M);if(y>0)return l.substr(0,y)}ie.hasParent=function(l,y){for(var T=v(y);T;){if(T in l)return!0;T=v(T)}return!1};var _=["x","y","z"];ie.clearAxisTypes=function(l,y,T){for(var w=0;w<y.length;w++)for(var A=l._fullData[w],f=0;f<3;f++){var u=t(l,A,_[f]);if(u&&u.type!=="log"){var h=u._name,o=u._id.substr(1);if(o.substr(0,5)==="scene"){if(T[o]!==void 0)continue;h=o+"."+h}var S=h+".type";T[h]===void 0&&T[S]===void 0&&E.nestedProperty(l.layout,S).set(null)}}}},{"../components/color":366,"../lib":503,"../plots/cartesian/axis_ids":558,"../plots/plots":619,"../registry":638,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],538:[function(c,ae,ie){"use strict";var b=c("./plot_api");ie._doPlot=b._doPlot,ie.newPlot=b.newPlot,ie.restyle=b.restyle,ie.relayout=b.relayout,ie.redraw=b.redraw,ie.update=b.update,ie._guiRestyle=b._guiRestyle,ie._guiRelayout=b._guiRelayout,ie._guiUpdate=b._guiUpdate,ie._storeDirectGUIEdit=b._storeDirectGUIEdit,ie.react=b.react,ie.extendTraces=b.extendTraces,ie.prependTraces=b.prependTraces,ie.addTraces=b.addTraces,ie.deleteTraces=b.deleteTraces,ie.moveTraces=b.moveTraces,ie.purge=b.purge,ie.addFrames=b.addFrames,ie.deleteFrames=b.deleteFrames,ie.animate=b.animate,ie.setPlotConfig=b.setPlotConfig,ie.toImage=c("./to_image"),ie.validate=c("./validate"),ie.downloadImage=c("../snapshot/download");var k=c("./template_api");ie.makeTemplate=k.makeTemplate,ie.validateTemplate=k.validateTemplate},{"../snapshot/download":640,"./plot_api":540,"./template_api":545,"./to_image":546,"./validate":547}],539:[function(c,ae,ie){"use strict";var b=c("../lib/is_plain_object"),k=c("../lib/noop"),P=c("../lib/loggers"),E=c("../lib/search").sorterAsc,e=c("../registry");ie.containerArrayMatch=c("./container_array_match");var p=ie.isAddVal=function(t){return t==="add"||b(t)},g=ie.isRemoveVal=function(t){return t===null||t==="remove"};ie.applyContainerArrayChanges=function(t,i,n,r,d){var s=i.astr,m=e.getComponentMethod(s,"supplyLayoutDefaults"),x=e.getComponentMethod(s,"draw"),M=e.getComponentMethod(s,"drawOne"),v=r.replot||r.recalc||m===k||x===k,_=t.layout,l=t._fullLayout;if(n[""]){Object.keys(n).length>1&&P.warn("Full array edits are incompatible with other edits",s);var y=n[""][""];if(g(y))i.set(null);else if(Array.isArray(y))i.set(y);else return P.warn("Unrecognized full array edit value",s,y),!0;return v?!1:(m(_,l),x(t),!0)}var T=Object.keys(n).map(Number).sort(E),w=i.get(),A=w||[],f=d(l,s).get(),u=[],h=-1,o=A.length,S,R,z,O,I,F,D,B;for(S=0;S<T.length;S++){if(z=T[S],O=n[z],I=Object.keys(O),F=O[""],D=p(F),z<0||z>A.length-(D?0:1)){P.warn("index out of range",s,z);continue}if(F!==void 0)I.length>1&&P.warn("Insertion & removal are incompatible with edits to the same index.",s,z),g(F)?u.push(z):D?(F==="add"&&(F={}),A.splice(z,0,F),f&&f.splice(z,0,{})):P.warn("Unrecognized full object edit value",s,z,F),h===-1&&(h=z);else for(R=0;R<I.length;R++)B=s+"["+z+"].",d(A[z],I[R],B).set(O[I[R]])}for(S=u.length-1;S>=0;S--)A.splice(u[S],1),f&&f.splice(u[S],1);if(A.length?w||i.set(A):i.set(null),v)return!1;if(m(_,l),M!==k){var U;if(h===-1)U=T;else{for(o=Math.max(A.length,o),U=[],S=0;S<T.length&&(z=T[S],!(z>=h));S++)U.push(z);for(S=h;S<o;S++)U.push(S)}for(S=0;S<U.length;S++)M(t,U[S])}else x(t);return!0}},{"../lib/is_plain_object":504,"../lib/loggers":507,"../lib/noop":512,"../lib/search":523,"../registry":638,"./container_array_match":535}],540:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=c("has-hover"),E=c("../lib"),e=E.nestedProperty,p=c("../lib/events"),g=c("../lib/queue"),a=c("../registry"),t=c("./plot_schema"),i=c("../plots/plots"),n=c("../plots/cartesian/axes"),r=c("../components/drawing"),d=c("../components/color"),s=c("../plots/cartesian/graph_interact").initInteractions,m=c("../constants/xmlns_namespaces"),x=c("../plots/cartesian/select").clearSelect,M=c("./plot_config").dfltConfig,v=c("./manage_arrays"),_=c("./helpers"),l=c("./subroutines"),y=c("./edit_types"),T=c("../plots/cartesian/constants").AX_NAME_PATTERN,w=0,A=5;function f(Pe,We,je,nt){var kt;if(Pe=E.getGraphDiv(Pe),p.init(Pe),E.isPlainObject(We)){var wt=We;We=wt.data,je=wt.layout,nt=wt.config,kt=wt.frames}var Vt=p.triggerHandler(Pe,"plotly_beforeplot",[We,je,nt]);if(Vt===!1)return Promise.reject();!We&&!je&&!E.isPlotDiv(Pe)&&E.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",Pe);function qt(){if(kt)return ie.addFrames(Pe,kt)}R(Pe,nt),je||(je={}),b.select(Pe).classed("js-plotly-plot",!0),r.makeTester(),Array.isArray(Pe._promises)||(Pe._promises=[]);var zt=(Pe.data||[]).length===0&&Array.isArray(We);Array.isArray(We)&&(_.cleanData(We),zt?Pe.data=We:Pe.data.push.apply(Pe.data,We),Pe.empty=!1),(!Pe.layout||zt)&&(Pe.layout=_.cleanLayout(je)),i.supplyDefaults(Pe);var Ht=Pe._fullLayout,$t=Ht._has("cartesian");Ht._replotting=!0,(zt||Ht._shouldCreateBgLayer)&&(et(Pe),Ht._shouldCreateBgLayer&&delete Ht._shouldCreateBgLayer),r.initGradients(Pe),r.initPatterns(Pe),zt&&n.saveShowSpikeInitial(Pe);var Qt=!Pe.calcdata||Pe.calcdata.length!==(Pe._fullData||[]).length;Qt&&i.doCalcdata(Pe);for(var fr=0;fr<Pe.calcdata.length;fr++)Pe.calcdata[fr][0].trace=Pe._fullData[fr];Pe._context.responsive?Pe._responsiveChartHandler||(Pe._responsiveChartHandler=function(){E.isHidden(Pe)||i.resize(Pe)},window.addEventListener("resize",Pe._responsiveChartHandler)):E.clearResponsive(Pe);var jr=E.extendFlat({},Ht._size),cn=0;function Qr(){for(var Ne=Ht._basePlotModules,Xe=0;Xe<Ne.length;Xe++)Ne[Xe].drawFramework&&Ne[Xe].drawFramework(Pe);!Ht._glcanvas&&Ht._has("gl")&&(Ht._glcanvas=Ht._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function(vt){return vt.key}),Ht._glcanvas.enter().append("canvas").attr("class",function(vt){return"gl-canvas gl-canvas-"+vt.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var Ke=Pe._context.plotGlPixelRatio;if(Ht._glcanvas){Ht._glcanvas.attr("width",Ht.width*Ke).attr("height",Ht.height*Ke).style("width",Ht.width+"px").style("height",Ht.height+"px");var rt=Ht._glcanvas.data()[0].regl;if(rt&&(Math.floor(Ht.width*Ke)!==rt._gl.drawingBufferWidth||Math.floor(Ht.height*Ke)!==rt._gl.drawingBufferHeight)){var Je="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(cn)E.error(Je);else return E.log(Je+" Clearing graph and plotting again."),i.cleanPlot([],{},Pe._fullData,Ht),i.supplyDefaults(Pe),Ht=Pe._fullLayout,i.doCalcdata(Pe),cn++,Qr()}}return Ht.modebar.orientation==="h"?Ht._modebardiv.style("height",null).style("width","100%"):Ht._modebardiv.style("width",null).style("height",Ht.height+"px"),i.previousPromises(Pe)}function lt(){if(i.clearAutoMarginIds(Pe),l.drawMarginPushers(Pe),n.allowAutoMargin(Pe),Ht._has("pie"))for(var Ne=Pe._fullData,Xe=0;Xe<Ne.length;Xe++){var Ke=Ne[Xe];Ke.type==="pie"&&Ke.automargin&&i.allowAutoMargin(Pe,"pie."+Ke.uid+".automargin")}return i.doAutoMargin(Pe),i.previousPromises(Pe)}function Gt(){if(!!i.didMarginChange(jr,Ht._size))return E.syncOrAsync([lt,l.layoutStyles],Pe)}function Kt(){if(!Qt){Nt();return}return E.syncOrAsync([a.getComponentMethod("shapes","calcAutorange"),a.getComponentMethod("annotations","calcAutorange"),Nt],Pe)}function Nt(){Pe._transitioning||(l.doAutoRangeAndConstraints(Pe),zt&&n.saveRangeInitial(Pe),a.getComponentMethod("rangeslider","calcAutorange")(Pe))}function gr(){return n.draw(Pe,zt?"":"redraw")}var tt=[i.previousPromises,qt,Qr,lt,Gt];$t&&tt.push(Kt),tt.push(l.layoutStyles),$t&&tt.push(gr,function(Xe){Xe._fullLayout._insideTickLabelsAutorange&&ne(Xe,Xe._fullLayout._insideTickLabelsAutorange).then(function(){Xe._fullLayout._insideTickLabelsAutorange=void 0})}),tt.push(l.drawData,l.finalDraw,s,i.addLinks,i.rehover,i.redrag,i.doAutoMargin,we,i.previousPromises);function we(Ne){Ne._fullLayout._insideTickLabelsAutorange&&zt&&n.saveRangeInitial(Ne,!0)}var Me=E.syncOrAsync(tt,Pe);return(!Me||!Me.then)&&(Me=Promise.resolve()),Me.then(function(){return u(Pe),Pe})}function u(Pe){var We=Pe._fullLayout;We._redrawFromAutoMarginCount?We._redrawFromAutoMarginCount--:Pe.emit("plotly_afterplot")}function h(Pe){return E.extendFlat(M,Pe)}function o(Pe,We){try{Pe._fullLayout._paper.style("background",We)}catch(je){E.error(je)}}function S(Pe,We){var je=d.combine(We,"white");o(Pe,je)}function R(Pe,We){if(!Pe._context){Pe._context=E.extendDeep({},M);var je=b.select("base");Pe._context._baseUrl=je.size()&&je.attr("href")?window.location.href.split("#")[0]:""}var nt=Pe._context,kt,wt,Vt;if(We){for(wt=Object.keys(We),kt=0;kt<wt.length;kt++)Vt=wt[kt],!(Vt==="editable"||Vt==="edits")&&Vt in nt&&(Vt==="setBackground"&&We[Vt]==="opaque"?nt[Vt]=S:nt[Vt]=We[Vt]);We.plot3dPixelRatio&&!nt.plotGlPixelRatio&&(nt.plotGlPixelRatio=nt.plot3dPixelRatio);var qt=We.editable;if(qt!==void 0)for(nt.editable=qt,wt=Object.keys(nt.edits),kt=0;kt<wt.length;kt++)nt.edits[wt[kt]]=qt;if(We.edits)for(wt=Object.keys(We.edits),kt=0;kt<wt.length;kt++)Vt=wt[kt],Vt in nt.edits&&(nt.edits[Vt]=We.edits[Vt]);nt._exportedPlot=We._exportedPlot}nt.staticPlot&&(nt.editable=!1,nt.edits={},nt.autosizable=!1,nt.scrollZoom=!1,nt.doubleClick=!1,nt.showTips=!1,nt.showLink=!1,nt.displayModeBar=!1),nt.displayModeBar==="hover"&&!P&&(nt.displayModeBar=!0),(nt.setBackground==="transparent"||typeof nt.setBackground!="function")&&(nt.setBackground=o),nt._hasZeroHeight=nt._hasZeroHeight||Pe.clientHeight===0,nt._hasZeroWidth=nt._hasZeroWidth||Pe.clientWidth===0;var zt=nt.scrollZoom,Ht=nt._scrollZoom={};if(zt===!0)Ht.cartesian=1,Ht.gl3d=1,Ht.geo=1,Ht.mapbox=1;else if(typeof zt=="string"){var $t=zt.split("+");for(kt=0;kt<$t.length;kt++)Ht[$t[kt]]=1}else zt!==!1&&(Ht.gl3d=1,Ht.geo=1,Ht.mapbox=1)}function z(Pe){if(Pe=E.getGraphDiv(Pe),!E.isPlotDiv(Pe))throw new Error("This element is not a Plotly plot: "+Pe);return _.cleanData(Pe.data),_.cleanLayout(Pe.layout),Pe.calcdata=void 0,ie._doPlot(Pe).then(function(){return Pe.emit("plotly_redraw"),Pe})}function O(Pe,We,je,nt){return Pe=E.getGraphDiv(Pe),i.cleanPlot([],{},Pe._fullData||[],Pe._fullLayout||{}),i.purge(Pe),ie._doPlot(Pe,We,je,nt)}function I(Pe,We){var je=We+1,nt=[],kt,wt;for(kt=0;kt<Pe.length;kt++)wt=Pe[kt],wt<0?nt.push(je+wt):nt.push(wt);return nt}function F(Pe,We,je){var nt,kt;for(nt=0;nt<We.length;nt++){if(kt=We[nt],kt!==parseInt(kt,10))throw new Error("all values in "+je+" must be integers");if(kt>=Pe.data.length||kt<-Pe.data.length)throw new Error(je+" must be valid indices for gd.data.");if(We.indexOf(kt,nt+1)>-1||kt>=0&&We.indexOf(-Pe.data.length+kt)>-1||kt<0&&We.indexOf(Pe.data.length+kt)>-1)throw new Error("each index in "+je+" must be unique.")}}function D(Pe,We,je){if(!Array.isArray(Pe.data))throw new Error("gd.data must be an array.");if(typeof We>"u")throw new Error("currentIndices is a required argument.");if(Array.isArray(We)||(We=[We]),F(Pe,We,"currentIndices"),typeof je<"u"&&!Array.isArray(je)&&(je=[je]),typeof je<"u"&&F(Pe,je,"newIndices"),typeof je<"u"&&We.length!==je.length)throw new Error("current and new indices must be of equal length.")}function B(Pe,We,je){var nt,kt;if(!Array.isArray(Pe.data))throw new Error("gd.data must be an array.");if(typeof We>"u")throw new Error("traces must be defined.");for(Array.isArray(We)||(We=[We]),nt=0;nt<We.length;nt++)if(kt=We[nt],typeof kt!="object"||Array.isArray(kt)||kt===null)throw new Error("all values in traces array must be non-array objects");if(typeof je<"u"&&!Array.isArray(je)&&(je=[je]),typeof je<"u"&&je.length!==We.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function U(Pe,We,je,nt){var kt=E.isPlainObject(nt);if(!Array.isArray(Pe.data))throw new Error("gd.data must be an array");if(!E.isPlainObject(We))throw new Error("update must be a key:value object");if(typeof je>"u")throw new Error("indices must be an integer or array of integers");F(Pe,je,"indices");for(var wt in We){if(!Array.isArray(We[wt])||We[wt].length!==je.length)throw new Error("attribute "+wt+" must be an array of length equal to indices array length");if(kt&&(!(wt in nt)||!Array.isArray(nt[wt])||nt[wt].length!==We[wt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function X(Pe,We,je,nt){var kt=E.isPlainObject(nt),wt=[],Vt,qt,zt,Ht,$t;Array.isArray(je)||(je=[je]),je=I(je,Pe.data.length-1);for(var Qt in We)for(var fr=0;fr<je.length;fr++){if(Vt=Pe.data[je[fr]],zt=e(Vt,Qt),qt=zt.get(),Ht=We[Qt][fr],!E.isArrayOrTypedArray(Ht))throw new Error("attribute: "+Qt+" index: "+fr+" must be an array");if(!E.isArrayOrTypedArray(qt))throw new Error("cannot extend missing or non-array attribute: "+Qt);if(qt.constructor!==Ht.constructor)throw new Error("cannot extend array with an array of a different type: "+Qt);$t=kt?nt[Qt][fr]:nt,k($t)||($t=-1),wt.push({prop:zt,target:qt,insert:Ht,maxp:Math.floor($t)})}return wt}function oe(Pe,We,je,nt,kt){U(Pe,We,je,nt);for(var wt=X(Pe,We,je,nt),Vt={},qt={},zt=0;zt<wt.length;zt++){var Ht=wt[zt].prop,$t=wt[zt].maxp,Qt=kt(wt[zt].target,wt[zt].insert,$t);Ht.set(Qt[0]),Array.isArray(Vt[Ht.astr])||(Vt[Ht.astr]=[]),Vt[Ht.astr].push(Qt[1]),Array.isArray(qt[Ht.astr])||(qt[Ht.astr]=[]),qt[Ht.astr].push(wt[zt].target.length)}return{update:Vt,maxPoints:qt}}function se(Pe,We){var je=new Pe.constructor(Pe.length+We.length);return je.set(Pe),je.set(We,Pe.length),je}function q(Pe,We,je,nt){Pe=E.getGraphDiv(Pe);function kt(zt,Ht,$t){var Qt,fr;if(E.isTypedArray(zt))if($t<0){var jr=new zt.constructor(0),cn=se(zt,Ht);$t<0?(Qt=cn,fr=jr):(Qt=jr,fr=cn)}else if(Qt=new zt.constructor($t),fr=new zt.constructor(zt.length+Ht.length-$t),$t===Ht.length)Qt.set(Ht),fr.set(zt);else if($t<Ht.length){var Qr=Ht.length-$t;Qt.set(Ht.subarray(Qr)),fr.set(zt),fr.set(Ht.subarray(0,Qr),zt.length)}else{var lt=$t-Ht.length,Gt=zt.length-lt;Qt.set(zt.subarray(Gt)),Qt.set(Ht,lt),fr.set(zt.subarray(0,Gt))}else Qt=zt.concat(Ht),fr=$t>=0&&$t<Qt.length?Qt.splice(0,Qt.length-$t):[];return[Qt,fr]}var wt=oe(Pe,We,je,nt,kt),Vt=ie.redraw(Pe),qt=[Pe,wt.update,je,wt.maxPoints];return g.add(Pe,ie.prependTraces,qt,q,arguments),Vt}function K(Pe,We,je,nt){Pe=E.getGraphDiv(Pe);function kt(zt,Ht,$t){var Qt,fr;if(E.isTypedArray(zt))if($t<=0){var jr=new zt.constructor(0),cn=se(Ht,zt);$t<0?(Qt=cn,fr=jr):(Qt=jr,fr=cn)}else if(Qt=new zt.constructor($t),fr=new zt.constructor(zt.length+Ht.length-$t),$t===Ht.length)Qt.set(Ht),fr.set(zt);else if($t<Ht.length){var Qr=Ht.length-$t;Qt.set(Ht.subarray(0,Qr)),fr.set(Ht.subarray(Qr)),fr.set(zt,Qr)}else{var lt=$t-Ht.length;Qt.set(Ht),Qt.set(zt.subarray(0,lt),Ht.length),fr.set(zt.subarray(lt))}else Qt=Ht.concat(zt),fr=$t>=0&&$t<Qt.length?Qt.splice($t,Qt.length):[];return[Qt,fr]}var wt=oe(Pe,We,je,nt,kt),Vt=ie.redraw(Pe),qt=[Pe,wt.update,je,wt.maxPoints];return g.add(Pe,ie.extendTraces,qt,K,arguments),Vt}function G(Pe,We,je){Pe=E.getGraphDiv(Pe);var nt=[],kt=ie.deleteTraces,wt=G,Vt=[Pe,nt],qt=[Pe,We],zt,Ht;for(B(Pe,We,je),Array.isArray(We)||(We=[We]),We=We.map(function($t){return E.extendFlat({},$t)}),_.cleanData(We),zt=0;zt<We.length;zt++)Pe.data.push(We[zt]);for(zt=0;zt<We.length;zt++)nt.push(-We.length+zt);if(typeof je>"u")return Ht=ie.redraw(Pe),g.add(Pe,kt,Vt,wt,qt),Ht;Array.isArray(je)||(je=[je]);try{D(Pe,nt,je)}catch($t){throw Pe.data.splice(Pe.data.length-We.length,We.length),$t}return g.startSequence(Pe),g.add(Pe,kt,Vt,wt,qt),Ht=ie.moveTraces(Pe,nt,je),g.stopSequence(Pe),Ht}function Q(Pe,We){Pe=E.getGraphDiv(Pe);var je=[],nt=ie.addTraces,kt=Q,wt=[Pe,je,We],Vt=[Pe,We],qt,zt;if(typeof We>"u")throw new Error("indices must be an integer or array of integers.");for(Array.isArray(We)||(We=[We]),F(Pe,We,"indices"),We=I(We,Pe.data.length-1),We.sort(E.sorterDes),qt=0;qt<We.length;qt+=1)zt=Pe.data.splice(We[qt],1)[0],je.push(zt);var Ht=ie.redraw(Pe);return g.add(Pe,nt,wt,kt,Vt),Ht}function V(Pe,We,je){Pe=E.getGraphDiv(Pe);var nt=[],kt=[],wt=V,Vt=V,qt=[Pe,je,We],zt=[Pe,We,je],Ht;if(D(Pe,We,je),We=Array.isArray(We)?We:[We],typeof je>"u")for(je=[],Ht=0;Ht<We.length;Ht++)je.push(-We.length+Ht);for(je=Array.isArray(je)?je:[je],We=I(We,Pe.data.length-1),je=I(je,Pe.data.length-1),Ht=0;Ht<Pe.data.length;Ht++)We.indexOf(Ht)===-1&&nt.push(Pe.data[Ht]);for(Ht=0;Ht<We.length;Ht++)kt.push({newIndex:je[Ht],trace:Pe.data[We[Ht]]});for(kt.sort(function(Qt,fr){return Qt.newIndex-fr.newIndex}),Ht=0;Ht<kt.length;Ht+=1)nt.splice(kt[Ht].newIndex,0,kt[Ht].trace);Pe.data=nt;var $t=ie.redraw(Pe);return g.add(Pe,wt,qt,Vt,zt),$t}function H(Pe,We,je,nt){Pe=E.getGraphDiv(Pe),_.clearPromiseQueue(Pe);var kt={};if(typeof We=="string")kt[We]=je;else if(E.isPlainObject(We))kt=E.extendFlat({},We),nt===void 0&&(nt=je);else return E.warn("Restyle fail.",We,je,nt),Promise.reject();Object.keys(kt).length&&(Pe.changed=!0);var wt=_.coerceTraceIndices(Pe,nt),Vt=j(Pe,kt,wt),qt=Vt.flags;qt.calc&&(Pe.calcdata=void 0),qt.clearAxisTypes&&_.clearAxisTypes(Pe,wt,{});var zt=[];qt.fullReplot?zt.push(ie._doPlot):(zt.push(i.previousPromises),i.supplyDefaults(Pe),qt.markerSize&&(i.doCalcdata(Pe),ge(zt)),qt.style&&zt.push(l.doTraceStyle),qt.colorbars&&zt.push(l.doColorBars),zt.push(u)),zt.push(i.rehover,i.redrag),g.add(Pe,H,[Pe,Vt.undoit,Vt.traces],H,[Pe,Vt.redoit,Vt.traces]);var Ht=E.syncOrAsync(zt,Pe);return(!Ht||!Ht.then)&&(Ht=Promise.resolve()),Ht.then(function(){return Pe.emit("plotly_restyle",Vt.eventData),Pe})}function ee(Pe){return Pe===void 0?null:Pe}function J(Pe,We){return We?function(je,nt,kt){var wt=e(je,nt),Vt=wt.set;return wt.set=function(qt){var zt=(kt||"")+nt;W(zt,wt.get(),qt,Pe),Vt(qt)},wt}:e}function W(Pe,We,je,nt){if(Array.isArray(We)||Array.isArray(je))for(var kt=Array.isArray(We)?We:[],wt=Array.isArray(je)?je:[],Vt=Math.max(kt.length,wt.length),qt=0;qt<Vt;qt++)W(Pe+"["+qt+"]",kt[qt],wt[qt],nt);else if(E.isPlainObject(We)||E.isPlainObject(je)){var zt=E.isPlainObject(We)?We:{},Ht=E.isPlainObject(je)?je:{},$t=E.extendFlat({},zt,Ht);for(var Qt in $t)W(Pe+"."+Qt,zt[Qt],Ht[Qt],nt)}else nt[Pe]===void 0&&(nt[Pe]=ee(We))}function re(Pe,We,je){for(var nt in je){var kt=e(Pe,nt);W(nt,kt.get(),je[nt],We)}}function j(Pe,We,je){var nt=Pe._fullLayout,kt=Pe._fullData,wt=Pe.data,Vt=nt._guiEditing,qt=J(nt._preGUI,Vt),zt=E.extendDeepAll({},We),Ht;Z(We);var $t=y.traceFlags(),Qt={},fr={},jr;function cn(){return je.map(function(){})}function Qr(Xt){var tr=n.id2name(Xt);jr.indexOf(tr)===-1&&jr.push(tr)}function lt(Xt){return"LAYOUT"+Xt+".autorange"}function Gt(Xt){return"LAYOUT"+Xt+".range"}function Kt(Xt){for(var tr=Xt;tr<kt.length;tr++)if(kt[tr]._input===wt[Xt])return kt[tr]}function Nt(Xt,tr,Lr){if(Array.isArray(Xt)){Xt.forEach(function(Kr){Nt(Kr,tr,Lr)});return}if(!(Xt in We||_.hasParent(We,Xt))){var Nr;if(Xt.substr(0,6)==="LAYOUT")Nr=qt(Pe.layout,Xt.replace("LAYOUT",""));else{var Rr=je[Lr],Ar=nt._tracePreGUI[Kt(Rr)._fullInput.uid];Nr=J(Ar,Vt)(wt[Rr],Xt)}Xt in fr||(fr[Xt]=cn()),fr[Xt][Lr]===void 0&&(fr[Xt][Lr]=ee(Nr.get())),tr!==void 0&&Nr.set(tr)}}function gr(Xt){return function(tr){return kt[tr][Xt]}}function tt(Xt){return function(tr,Lr){return tr===!1?kt[je[Lr]][Xt]:null}}for(var we in We){if(_.hasParent(We,we))throw new Error("cannot set "+we+" and a parent attribute simultaneously");var Me=We[we],Ne,Xe,Ke,rt,Je,vt;if((we==="autobinx"||we==="autobiny")&&(we=we.charAt(we.length-1)+"bins",Array.isArray(Me)?Me=Me.map(tt(we)):Me===!1?Me=je.map(gr(we)):Me=null),Qt[we]=Me,we.substr(0,6)==="LAYOUT"){Ke=qt(Pe.layout,we.replace("LAYOUT","")),fr[we]=[ee(Ke.get())],Ke.set(Array.isArray(Me)?Me[0]:Me),$t.calc=!0;continue}for(fr[we]=cn(),Ht=0;Ht<je.length;Ht++){Ne=wt[je[Ht]],Xe=Kt(je[Ht]);var bt=nt._tracePreGUI[Xe._fullInput.uid];if(Ke=J(bt,Vt)(Ne,we),rt=Ke.get(),Je=Array.isArray(Me)?Me[Ht%Me.length]:Me,Je!==void 0){var Et=Ke.parts[Ke.parts.length-1],Wt=we.substr(0,we.length-Et.length-1),Ot=Wt?Wt+".":"",ir=Wt?e(Xe,Wt).get():Xe;if(vt=t.getTraceValObject(Xe,Ke.parts),vt&&vt.impliedEdits&&Je!==null)for(var vr in vt.impliedEdits)Nt(E.relativeAttr(we,vr),vt.impliedEdits[vr],Ht);else if((Et==="thicknessmode"||Et==="lenmode")&&rt!==Je&&(Je==="fraction"||Je==="pixels")&&ir){var _r=nt._size,ln=ir.orient,Cr=ln==="top"||ln==="bottom";if(Et==="thicknessmode"){var Gr=Cr?_r.h:_r.w;Nt(Ot+"thickness",ir.thickness*(Je==="fraction"?1/Gr:Gr),Ht)}else{var sn=Cr?_r.w:_r.h;Nt(Ot+"len",ir.len*(Je==="fraction"?1/sn:sn),Ht)}}else if(we==="type"&&(Je==="pie"!=(rt==="pie")||Je==="funnelarea"!=(rt==="funnelarea"))){var yr="x",mr="y";(Je==="bar"||rt==="bar")&&Ne.orientation==="h"&&(yr="y",mr="x"),E.swapAttrs(Ne,["?","?src"],"labels",yr),E.swapAttrs(Ne,["d?","?0"],"label",yr),E.swapAttrs(Ne,["?","?src"],"values",mr),rt==="pie"||rt==="funnelarea"?(e(Ne,"marker.color").set(e(Ne,"marker.colors").get()),nt._pielayer.selectAll("g.trace").remove()):a.traceIs(Ne,"cartesian")&&e(Ne,"marker.colors").set(e(Ne,"marker.color").get())}fr[we][Ht]=ee(rt);var Or=["swapxy","swapxyaxes","orientation","orientationaxes"];if(Or.indexOf(we)!==-1){if(we==="orientation"){Ke.set(Je);var zr=Ne.x&&!Ne.y?"h":"v";if((Ke.get()||zr)===Xe.orientation)continue}else we==="orientationaxes"&&(Ne.orientation={v:"h",h:"v"}[Xe.orientation]);_.swapXYData(Ne),$t.calc=$t.clearAxisTypes=!0}else i.dataArrayContainers.indexOf(Ke.parts[0])!==-1?(_.manageArrayContainers(Ke,Je,fr),$t.calc=!0):(vt?vt.arrayOk&&!a.traceIs(Xe,"regl")&&(E.isArrayOrTypedArray(Je)||E.isArrayOrTypedArray(rt))?$t.calc=!0:y.update($t,vt):$t.calc=!0,Ke.set(Je))}}if(["swapxyaxes","orientationaxes"].indexOf(we)!==-1&&n.swap(Pe,je),we==="orientationaxes"){var Sr=e(Pe.layout,"hovermode"),ot=Sr.get();ot==="x"?Sr.set("y"):ot==="y"?Sr.set("x"):ot==="x unified"?Sr.set("y unified"):ot==="y unified"&&Sr.set("x unified")}if(["orientation","type"].indexOf(we)!==-1){for(jr=[],Ht=0;Ht<je.length;Ht++){var Lt=wt[je[Ht]];a.traceIs(Lt,"cartesian")&&(Qr(Lt.xaxis||"x"),Qr(Lt.yaxis||"y"))}Nt(jr.map(lt),!0,0),Nt(jr.map(Gt),[0,1],0)}}return($t.calc||$t.plot)&&($t.fullReplot=!0),{flags:$t,undoit:fr,redoit:Qt,traces:je,eventData:E.extendDeepNoArrays([],[zt,je])}}function Z(Pe){var We=E.counterRegex("axis",".title",!1,!1),je=/colorbar\.title$/,nt=Object.keys(Pe),kt,wt,Vt;for(kt=0;kt<nt.length;kt++)wt=nt[kt],Vt=Pe[wt],(wt==="title"||We.test(wt)||je.test(wt))&&(typeof Vt=="string"||typeof Vt=="number")?qt(wt,wt.replace("title","title.text")):wt.indexOf("titlefont")>-1&&wt.indexOf("grouptitlefont")===-1?qt(wt,wt.replace("titlefont","title.font")):wt.indexOf("titleposition")>-1?qt(wt,wt.replace("titleposition","title.position")):wt.indexOf("titleside")>-1?qt(wt,wt.replace("titleside","title.side")):wt.indexOf("titleoffset")>-1&&qt(wt,wt.replace("titleoffset","title.offset"));function qt(zt,Ht){Pe[Ht]=Pe[zt],delete Pe[zt]}}function ne(Pe,We,je){Pe=E.getGraphDiv(Pe),_.clearPromiseQueue(Pe);var nt={};if(typeof We=="string")nt[We]=je;else if(E.isPlainObject(We))nt=E.extendFlat({},We);else return E.warn("Relayout fail.",We,je),Promise.reject();Object.keys(nt).length&&(Pe.changed=!0);var kt=Te(Pe,nt),wt=kt.flags;wt.calc&&(Pe.calcdata=void 0);var Vt=[i.previousPromises];wt.layoutReplot?Vt.push(l.layoutReplot):Object.keys(nt).length&&(le(Pe,wt,kt)||i.supplyDefaults(Pe),wt.legend&&Vt.push(l.doLegend),wt.layoutstyle&&Vt.push(l.layoutStyles),wt.axrange&&ge(Vt,kt.rangesAltered),wt.ticks&&Vt.push(l.doTicksRelayout),wt.modebar&&Vt.push(l.doModeBar),wt.camera&&Vt.push(l.doCamera),wt.colorbars&&Vt.push(l.doColorBars),Vt.push(u)),Vt.push(i.rehover,i.redrag),g.add(Pe,ne,[Pe,kt.undoit],ne,[Pe,kt.redoit]);var qt=E.syncOrAsync(Vt,Pe);return(!qt||!qt.then)&&(qt=Promise.resolve(Pe)),qt.then(function(){return Pe.emit("plotly_relayout",kt.eventData),Pe})}function le(Pe,We,je){var nt=Pe._fullLayout;if(!We.axrange)return!1;for(var kt in We)if(kt!=="axrange"&&We[kt])return!1;for(var wt in je.rangesAltered){var Vt=n.id2name(wt),qt=Pe.layout[Vt],zt=nt[Vt];if(zt.autorange=qt.autorange,qt.range&&(zt.range=qt.range.slice()),zt.cleanRange(),zt._matchGroup){for(var Ht in zt._matchGroup)if(Ht!==wt){var $t=nt[n.id2name(Ht)];$t.autorange=zt.autorange,$t.range=zt.range.slice(),$t._input.range=zt.range.slice()}}}return!0}function ge(Pe,We){var je=We?function(nt){var kt=[],wt=!0;for(var Vt in We){var qt=n.getFromId(nt,Vt);if(kt.push(Vt),(qt.ticklabelposition||"").indexOf("inside")!==-1&&qt._anchorAxis&&kt.push(qt._anchorAxis._id),qt._matchGroup)for(var zt in qt._matchGroup)We[zt]||kt.push(zt);qt.automargin&&(wt=!1)}return n.draw(nt,kt,{skipTitle:wt})}:function(nt){return n.draw(nt,"redraw")};Pe.push(x,l.doAutoRangeAndConstraints,je,l.drawData,l.finalDraw)}var pe=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,xe=/^[xyz]axis[0-9]*\.autorange$/,Ee=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function Te(Pe,We){var je=Pe.layout,nt=Pe._fullLayout,kt=nt._guiEditing,wt=J(nt._preGUI,kt),Vt=Object.keys(We),qt=n.list(Pe),zt=E.extendDeepAll({},We),Ht={},$t,Qt,fr;for(Z(We),Vt=Object.keys(We),Qt=0;Qt<Vt.length;Qt++)if(Vt[Qt].indexOf("allaxes")===0){for(fr=0;fr<qt.length;fr++){var jr=qt[fr]._id.substr(1),cn=jr.indexOf("scene")!==-1?jr+".":"",Qr=Vt[Qt].replace("allaxes",cn+qt[fr]._name);We[Qr]||(We[Qr]=We[Vt[Qt]])}delete We[Vt[Qt]]}var lt=y.layoutFlags(),Gt={},Kt={};function Nt(Rr,Ar){if(Array.isArray(Rr)){Rr.forEach(function(Dn){Nt(Dn,Ar)});return}if(!(Rr in We||_.hasParent(We,Rr))){var Kr=wt(je,Rr);Rr in Kt||(Kt[Rr]=ee(Kr.get())),Ar!==void 0&&Kr.set(Ar)}}var gr={},tt;function we(Rr){var Ar=n.name2id(Rr.split(".")[0]);return gr[Ar]=1,Ar}for(var Me in We){if(_.hasParent(We,Me))throw new Error("cannot set "+Me+" and a parent attribute simultaneously");for(var Ne=wt(je,Me),Xe=We[Me],Ke=Ne.parts.length,rt=Ke-1;rt>0&&typeof Ne.parts[rt]!="string";)rt--;var Je=Ne.parts[rt],vt=Ne.parts[rt-1]+"."+Je,bt=Ne.parts.slice(0,rt).join("."),Et=e(Pe.layout,bt).get(),Wt=e(nt,bt).get(),Ot=Ne.get();if(Xe!==void 0){Gt[Me]=Xe,Kt[Me]=Je==="reverse"?Xe:ee(Ot);var ir=t.getLayoutValObject(nt,Ne.parts);if(ir&&ir.impliedEdits&&Xe!==null)for(var vr in ir.impliedEdits)Nt(E.relativeAttr(Me,vr),ir.impliedEdits[vr]);if(["width","height"].indexOf(Me)!==-1)if(Xe){Nt("autosize",null);var _r=Me==="height"?"width":"height";Nt(_r,nt[_r])}else nt[Me]=Pe._initialAutoSize[Me];else if(Me==="autosize")Nt("width",Xe?null:nt.width),Nt("height",Xe?null:nt.height);else if(vt.match(pe))we(vt),e(nt,bt+"._inputRange").set(null);else if(vt.match(xe)){we(vt),e(nt,bt+"._inputRange").set(null);var ln=e(nt,bt).get();ln._inputDomain&&(ln._input.domain=ln._inputDomain.slice())}else vt.match(Ee)&&e(nt,bt+"._inputDomain").set(null);if(Je==="type"){tt=Et;var Cr=Wt.type==="linear"&&Xe==="log",Gr=Wt.type==="log"&&Xe==="linear";if(Cr||Gr){if(!tt||!tt.range)Nt(bt+".autorange",!0);else if(Wt.autorange)Cr&&(tt.range=tt.range[1]>tt.range[0]?[1,2]:[2,1]);else{var sn=tt.range[0],yr=tt.range[1];Cr?(sn<=0&&yr<=0&&Nt(bt+".autorange",!0),sn<=0?sn=yr/1e6:yr<=0&&(yr=sn/1e6),Nt(bt+".range[0]",Math.log(sn)/Math.LN10),Nt(bt+".range[1]",Math.log(yr)/Math.LN10)):(Nt(bt+".range[0]",Math.pow(10,sn)),Nt(bt+".range[1]",Math.pow(10,yr)))}Array.isArray(nt._subplots.polar)&&nt._subplots.polar.length&&nt[Ne.parts[0]]&&Ne.parts[1]==="radialaxis"&&delete nt[Ne.parts[0]]._subplot.viewInitial["radialaxis.range"],a.getComponentMethod("annotations","convertCoords")(Pe,Wt,Xe,Nt),a.getComponentMethod("images","convertCoords")(Pe,Wt,Xe,Nt)}else Nt(bt+".autorange",!0),Nt(bt+".range",null);e(nt,bt+"._inputRange").set(null)}else if(Je.match(T)){var mr=e(nt,Me).get(),Or=(Xe||{}).type;(!Or||Or==="-")&&(Or="linear"),a.getComponentMethod("annotations","convertCoords")(Pe,mr,Or,Nt),a.getComponentMethod("images","convertCoords")(Pe,mr,Or,Nt)}var zr=v.containerArrayMatch(Me);if(zr){$t=zr.array,Qt=zr.index;var Sr=zr.property,ot=ir||{editType:"calc"};Qt!==""&&Sr===""&&(v.isAddVal(Xe)?Kt[Me]=null:v.isRemoveVal(Xe)?Kt[Me]=(e(je,$t).get()||[])[Qt]:E.warn("unrecognized full object value",We)),y.update(lt,ot),Ht[$t]||(Ht[$t]={});var Lt=Ht[$t][Qt];Lt||(Lt=Ht[$t][Qt]={}),Lt[Sr]=Xe,delete We[Me]}else Je==="reverse"?(Et.range?Et.range.reverse():(Nt(bt+".autorange",!0),Et.range=[1,0]),Wt.autorange?lt.calc=!0:lt.plot=!0):(nt._has("scatter-like")&&nt._has("regl")&&Me==="dragmode"&&(Xe==="lasso"||Xe==="select")&&!(Ot==="lasso"||Ot==="select")||nt._has("gl2d")?lt.plot=!0:ir?y.update(lt,ir):lt.calc=!0,Ne.set(Xe))}}for($t in Ht){var Xt=v.applyContainerArrayChanges(Pe,wt(je,$t),Ht[$t],lt,wt);Xt||(lt.plot=!0)}for(var tr in gr){tt=n.getFromId(Pe,tr);var Lr=tt&&tt._constraintGroup;if(Lr){lt.calc=!0;for(var Nr in Lr)gr[Nr]||(n.getFromId(Pe,Nr)._constraintShrinkable=!0)}}return(de(Pe)||We.height||We.width)&&(lt.plot=!0),(lt.plot||lt.calc)&&(lt.layoutReplot=!0),{flags:lt,rangesAltered:gr,undoit:Kt,redoit:Gt,eventData:zt}}function de(Pe){var We=Pe._fullLayout,je=We.width,nt=We.height;return Pe.layout.autosize&&i.plotAutoSize(Pe,Pe.layout,We),We.width!==je||We.height!==nt}function be(Pe,We,je,nt){Pe=E.getGraphDiv(Pe),_.clearPromiseQueue(Pe),E.isPlainObject(We)||(We={}),E.isPlainObject(je)||(je={}),Object.keys(We).length&&(Pe.changed=!0),Object.keys(je).length&&(Pe.changed=!0);var kt=_.coerceTraceIndices(Pe,nt),wt=j(Pe,E.extendFlat({},We),kt),Vt=wt.flags,qt=Te(Pe,E.extendFlat({},je)),zt=qt.flags;(Vt.calc||zt.calc)&&(Pe.calcdata=void 0),Vt.clearAxisTypes&&_.clearAxisTypes(Pe,kt,je);var Ht=[];zt.layoutReplot?Ht.push(l.layoutReplot):Vt.fullReplot?Ht.push(ie._doPlot):(Ht.push(i.previousPromises),le(Pe,zt,qt)||i.supplyDefaults(Pe),Vt.style&&Ht.push(l.doTraceStyle),(Vt.colorbars||zt.colorbars)&&Ht.push(l.doColorBars),zt.legend&&Ht.push(l.doLegend),zt.layoutstyle&&Ht.push(l.layoutStyles),zt.axrange&&ge(Ht,qt.rangesAltered),zt.ticks&&Ht.push(l.doTicksRelayout),zt.modebar&&Ht.push(l.doModeBar),zt.camera&&Ht.push(l.doCamera),Ht.push(u)),Ht.push(i.rehover,i.redrag),g.add(Pe,be,[Pe,wt.undoit,qt.undoit,wt.traces],be,[Pe,wt.redoit,qt.redoit,wt.traces]);var $t=E.syncOrAsync(Ht,Pe);return(!$t||!$t.then)&&($t=Promise.resolve(Pe)),$t.then(function(){return Pe.emit("plotly_update",{data:wt.eventData,layout:qt.eventData}),Pe})}function Le(Pe){return function(je){je._fullLayout._guiEditing=!0;var nt=Pe.apply(null,arguments);return je._fullLayout._guiEditing=!1,nt}}var De=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],ye=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function ke(Pe,We){for(var je=0;je<We.length;je++){var nt=We[je],kt=Pe.match(nt.pattern);if(kt){var wt=kt[1]||"";return{head:wt,tail:Pe.substr(wt.length+1),attr:nt.attr}}}}function Oe(Pe,We){var je=e(We,Pe).get();if(je!==void 0)return je;var nt=Pe.split(".");for(nt.pop();nt.length>1;)if(nt.pop(),je=e(We,nt.join(".")+".uirevision").get(),je!==void 0)return je;return We.uirevision}function Qe(Pe,We){for(var je=0;je<We.length;je++)if(We[je]._fullInput.uid===Pe)return je;return-1}function Ve(Pe,We,je){for(var nt=0;nt<We.length;nt++)if(We[nt].uid===Pe)return nt;return!We[je]||We[je].uid?-1:je}function Ue(Pe,We){var je=E.isPlainObject(Pe),nt=Array.isArray(Pe);return je||nt?(je&&E.isPlainObject(We)||nt&&Array.isArray(We))&&JSON.stringify(Pe)===JSON.stringify(We):Pe===We}function Ie(Pe,We,je,nt){var kt=nt._preGUI,wt,Vt,qt,zt,Ht,$t,Qt,fr,jr,cn,Qr=[],lt={},Gt={};for(wt in kt){if(Ht=ke(wt,De),Ht){if(jr=Ht.head,cn=Ht.tail,Vt=Ht.attr||jr+".uirevision",qt=e(nt,Vt).get(),zt=qt&&Oe(Vt,We),zt&&zt===qt){if($t=kt[wt],$t===null&&($t=void 0),Qt=e(We,wt),fr=Qt.get(),Ue(fr,$t)){fr===void 0&&cn==="autorange"&&Qr.push(jr),Qt.set(ee(e(nt,wt).get()));continue}else if(cn==="autorange"||cn.substr(0,6)==="range["){var Kt=kt[jr+".range[0]"],Nt=kt[jr+".range[1]"],gr=kt[jr+".autorange"];if(gr||gr===null&&Kt===null&&Nt===null){if(!(jr in lt)){var tt=e(We,jr).get();lt[jr]=tt&&(tt.autorange||tt.autorange!==!1&&(!tt.range||tt.range.length!==2))}if(lt[jr]){Qt.set(ee(e(nt,wt).get()));continue}}}}}else E.warn("unrecognized GUI edit: "+wt);delete kt[wt],Ht&&Ht.tail.substr(0,6)==="range["&&(Gt[Ht.head]=1)}for(var we=0;we<Qr.length;we++){var Me=Qr[we];if(Gt[Me]){var Ne=e(We,Me).get();Ne&&delete Ne.autorange}}var Xe=nt._tracePreGUI;for(var Ke in Xe){var rt=Xe[Ke],Je=null,vt;for(wt in rt){if(!Je){var bt=Qe(Ke,je);if(bt<0){delete Xe[Ke];break}var Et=je[bt];vt=Et._fullInput;var Wt=Ve(Ke,Pe,vt.index);if(Wt<0){delete Xe[Ke];break}Je=Pe[Wt]}if(Ht=ke(wt,ye),Ht){if(Ht.attr?(qt=e(nt,Ht.attr).get(),zt=qt&&Oe(Ht.attr,We)):(qt=vt.uirevision,zt=Je.uirevision,zt===void 0&&(zt=We.uirevision)),zt&&zt===qt&&($t=rt[wt],$t===null&&($t=void 0),Qt=e(Je,wt),fr=Qt.get(),Ue(fr,$t))){Qt.set(ee(e(vt,wt).get()));continue}}else E.warn("unrecognized GUI edit: "+wt+" in trace uid "+Ke);delete rt[wt]}}}function at(Pe,We,je,nt){var kt,wt;function Vt(){return ie.addFrames(Pe,kt)}Pe=E.getGraphDiv(Pe),_.clearPromiseQueue(Pe);var qt=Pe._fullData,zt=Pe._fullLayout;if(!E.isPlotDiv(Pe)||!qt||!zt)wt=ie.newPlot(Pe,We,je,nt);else{if(E.isPlainObject(We)){var Ht=We;We=Ht.data,je=Ht.layout,nt=Ht.config,kt=Ht.frames}var $t=!1;if(nt){var Qt=E.extendDeep({},Pe._context);Pe._context=void 0,R(Pe,nt),$t=It(Qt,Pe._context)}Pe.data=We||[],_.cleanData(Pe.data),Pe.layout=je||{},_.cleanLayout(Pe.layout),Ie(Pe.data,Pe.layout,qt,zt),i.supplyDefaults(Pe,{skipUpdateCalc:!0});var fr=Pe._fullData,jr=Pe._fullLayout,cn=jr.datarevision===void 0,Qr=jr.transition,lt=Rt(Pe,zt,jr,cn,Qr),Gt=lt.newDataRevision,Kt=pt(Pe,qt,fr,cn,Qr,Gt);if(de(Pe)&&(lt.layoutReplot=!0),Kt.calc||lt.calc){Pe.calcdata=void 0;for(var Nt=Object.getOwnPropertyNames(jr),gr=0;gr<Nt.length;gr++){var tt=Nt[gr],we=tt.substring(0,5);if(we==="xaxis"||we==="yaxis"){var Me=jr[tt]._emptyCategories;Me&&Me()}}}else i.supplyDefaultsUpdateCalc(Pe.calcdata,fr);var Ne=[];if(kt&&(Pe._transitionData={},i.createTransitionData(Pe),Ne.push(Vt)),jr.transition&&!$t&&(Kt.anim||lt.anim))lt.ticks&&Ne.push(l.doTicksRelayout),i.doCalcdata(Pe),l.doAutoRangeAndConstraints(Pe),Ne.push(function(){return i.transitionFromReact(Pe,Kt,lt,zt)});else if(Kt.fullReplot||lt.layoutReplot||$t)Pe._fullLayout._skipDefaults=!0,Ne.push(ie._doPlot);else{for(var Xe in lt.arrays){var Ke=lt.arrays[Xe];if(Ke.length){var rt=a.getComponentMethod(Xe,"drawOne");if(rt!==E.noop)for(var Je=0;Je<Ke.length;Je++)rt(Pe,Ke[Je]);else{var vt=a.getComponentMethod(Xe,"draw");if(vt===E.noop)throw new Error("cannot draw components: "+Xe);vt(Pe)}}}Ne.push(i.previousPromises),Kt.style&&Ne.push(l.doTraceStyle),(Kt.colorbars||lt.colorbars)&&Ne.push(l.doColorBars),lt.legend&&Ne.push(l.doLegend),lt.layoutstyle&&Ne.push(l.layoutStyles),lt.axrange&&ge(Ne),lt.ticks&&Ne.push(l.doTicksRelayout),lt.modebar&&Ne.push(l.doModeBar),lt.camera&&Ne.push(l.doCamera),Ne.push(u)}Ne.push(i.rehover,i.redrag),wt=E.syncOrAsync(Ne,Pe),(!wt||!wt.then)&&(wt=Promise.resolve(Pe))}return wt.then(function(){return Pe.emit("plotly_react",{data:We,layout:je}),Pe})}function pt(Pe,We,je,nt,kt,wt){var Vt=We.length===je.length;if(!kt&&!Vt)return{fullReplot:!0,calc:!0};var qt=y.traceFlags();qt.arrays={},qt.nChanges=0,qt.nChangesAnim=0;var zt,Ht;function $t(jr){var cn=t.getTraceValObject(Ht,jr);return!Ht._module.animatable&&cn.anim&&(cn.anim=!1),cn}var Qt={getValObject:$t,flags:qt,immutable:nt,transition:kt,newDataRevision:wt,gd:Pe},fr={};for(zt=0;zt<We.length;zt++)if(je[zt]){if(Ht=je[zt]._fullInput,i.hasMakesDataTransform(Ht)&&(Ht=je[zt]),fr[Ht.uid])continue;fr[Ht.uid]=1,Mt(We[zt]._fullInput,Ht,[],Qt)}return(qt.calc||qt.plot)&&(qt.fullReplot=!0),kt&&qt.nChanges&&qt.nChangesAnim&&(qt.anim=qt.nChanges===qt.nChangesAnim&&Vt?"all":"some"),qt}function Rt(Pe,We,je,nt,kt){var wt=y.layoutFlags();wt.arrays={},wt.rangesAltered={},wt.nChanges=0,wt.nChangesAnim=0;function Vt(zt){return t.getLayoutValObject(je,zt)}var qt={getValObject:Vt,flags:wt,immutable:nt,transition:kt,gd:Pe};return Mt(We,je,[],qt),(wt.plot||wt.calc)&&(wt.layoutReplot=!0),kt&&wt.nChanges&&wt.nChangesAnim&&(wt.anim=wt.nChanges===wt.nChangesAnim?"all":"some"),wt}function Mt(Pe,We,je,nt){var kt,wt,Vt,qt=nt.getValObject,zt=nt.flags,Ht=nt.immutable,$t=nt.inArray,Qt=nt.arrayIndex;function fr(){var bt=kt.editType;if($t&&bt.indexOf("arraydraw")!==-1){E.pushUnique(zt.arrays[$t],Qt);return}y.update(zt,kt),bt!=="none"&&zt.nChanges++,nt.transition&&kt.anim&&zt.nChangesAnim++,(pe.test(Vt)||xe.test(Vt))&&(zt.rangesAltered[je[0]]=1),Ee.test(Vt)&&e(We,"_inputDomain").set(null),wt==="datarevision"&&(zt.newDataRevision=1)}function jr(bt){return bt.valType==="data_array"||bt.arrayOk}for(wt in Pe){if(zt.calc&&!nt.transition)return;var cn=Pe[wt],Qr=We[wt],lt=je.concat(wt);if(Vt=lt.join("."),!(wt.charAt(0)==="_"||typeof cn=="function"||cn===Qr)){if((wt==="tick0"||wt==="dtick")&&je[0]!=="geo"){var Gt=We.tickmode;if(Gt==="auto"||Gt==="array"||!Gt)continue}if(!(wt==="range"&&We.autorange)&&!((wt==="zmin"||wt==="zmax")&&We.type==="contourcarpet")&&(kt=qt(lt),!!kt&&!(kt._compareAsJSON&&JSON.stringify(cn)===JSON.stringify(Qr)))){var Kt=kt.valType,Nt,gr=jr(kt),tt=Array.isArray(cn),we=Array.isArray(Qr);if(tt&&we){var Me="_input_"+wt,Ne=Pe[Me],Xe=We[Me];if(Array.isArray(Ne)&&Ne===Xe)continue}if(Qr===void 0)gr&&tt?zt.calc=!0:fr();else if(kt._isLinkedToArray){var Ke=[],rt=!1;$t||(zt.arrays[wt]=Ke);var Je=Math.min(cn.length,Qr.length),vt=Math.max(cn.length,Qr.length);if(Je!==vt)if(kt.editType==="arraydraw")rt=!0;else{fr();continue}for(Nt=0;Nt<Je;Nt++)Mt(cn[Nt],Qr[Nt],lt.concat(Nt),E.extendFlat({inArray:wt,arrayIndex:Nt},nt));if(rt)for(Nt=Je;Nt<vt;Nt++)Ke.push(Nt)}else!Kt&&E.isPlainObject(cn)?Mt(cn,Qr,lt,nt):gr?tt&&we?(Ht&&(zt.calc=!0),(Ht||nt.newDataRevision)&&fr()):tt!==we?zt.calc=!0:fr():tt&&we?(cn.length!==Qr.length||String(cn)!==String(Qr))&&fr():fr()}}}for(wt in We)if(!(wt in Pe||wt.charAt(0)==="_"||typeof We[wt]=="function"))if(kt=qt(je.concat(wt)),jr(kt)&&Array.isArray(We[wt])){zt.calc=!0;return}else fr()}function It(Pe,We){var je;for(je in Pe)if(je.charAt(0)!=="_"){var nt=Pe[je],kt=We[je];if(nt!==kt)if(E.isPlainObject(nt)&&E.isPlainObject(kt)){if(It(nt,kt))return!0}else if(Array.isArray(nt)&&Array.isArray(kt)){if(nt.length!==kt.length)return!0;for(var wt=0;wt<nt.length;wt++)if(nt[wt]!==kt[wt])if(E.isPlainObject(nt[wt])&&E.isPlainObject(kt[wt])){if(It(nt[wt],kt[wt]))return!0}else return!0}else return!0}}function Bt(Pe,We,je){if(Pe=E.getGraphDiv(Pe),!E.isPlotDiv(Pe))throw new Error("This element is not a Plotly plot: "+Pe+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var nt=Pe._transitionData;nt._frameQueue||(nt._frameQueue=[]),je=i.supplyAnimationDefaults(je);var kt=je.transition,wt=je.frame;nt._frameWaitingCnt===void 0&&(nt._frameWaitingCnt=0);function Vt(Ht){return Array.isArray(kt)?Ht>=kt.length?kt[0]:kt[Ht]:kt}function qt(Ht){return Array.isArray(wt)?Ht>=wt.length?wt[0]:wt[Ht]:wt}function zt(Ht,$t){var Qt=0;return function(){if(Ht&&++Qt===$t)return Ht()}}return new Promise(function(Ht,$t){function Qt(){if(nt._frameQueue.length!==0){for(;nt._frameQueue.length;){var Je=nt._frameQueue.pop();Je.onInterrupt&&Je.onInterrupt()}Pe.emit("plotly_animationinterrupted",[])}}function fr(Je){if(Je.length!==0){for(var vt=0;vt<Je.length;vt++){var bt;Je[vt].type==="byname"?bt=i.computeFrame(Pe,Je[vt].name):bt=Je[vt].data;var Et=qt(vt),Wt=Vt(vt);Wt.duration=Math.min(Wt.duration,Et.duration);var Ot={frame:bt,name:Je[vt].name,frameOpts:Et,transitionOpts:Wt};vt===Je.length-1&&(Ot.onComplete=zt(Ht,2),Ot.onInterrupt=$t),nt._frameQueue.push(Ot)}je.mode==="immediate"&&(nt._lastFrameAt=-1/0),nt._animationRaf||Qr()}}function jr(){Pe.emit("plotly_animated"),window.cancelAnimationFrame(nt._animationRaf),nt._animationRaf=null}function cn(){nt._currentFrame&&nt._currentFrame.onComplete&&nt._currentFrame.onComplete();var Je=nt._currentFrame=nt._frameQueue.shift();if(Je){var vt=Je.name?Je.name.toString():null;Pe._fullLayout._currentFrame=vt,nt._lastFrameAt=Date.now(),nt._timeToNext=Je.frameOpts.duration,i.transition(Pe,Je.frame.data,Je.frame.layout,_.coerceTraceIndices(Pe,Je.frame.traces),Je.frameOpts,Je.transitionOpts).then(function(){Je.onComplete&&Je.onComplete()}),Pe.emit("plotly_animatingframe",{name:vt,frame:Je.frame,animation:{frame:Je.frameOpts,transition:Je.transitionOpts}})}else jr()}function Qr(){Pe.emit("plotly_animating"),nt._lastFrameAt=-1/0,nt._timeToNext=0,nt._runningTransitions=0,nt._currentFrame=null;var Je=function(){nt._animationRaf=window.requestAnimationFrame(Je),Date.now()-nt._lastFrameAt>nt._timeToNext&&cn()};Je()}var lt=0;function Gt(Je){return Array.isArray(kt)?lt>=kt.length?Je.transitionOpts=kt[lt]:Je.transitionOpts=kt[0]:Je.transitionOpts=kt,lt++,Je}var Kt,Nt,gr=[],tt=We==null,we=Array.isArray(We),Me=!tt&&!we&&E.isPlainObject(We);if(Me)gr.push({type:"object",data:Gt(E.extendFlat({},We))});else if(tt||["string","number"].indexOf(typeof We)!==-1)for(Kt=0;Kt<nt._frames.length;Kt++)Nt=nt._frames[Kt],!!Nt&&(tt||String(Nt.group)===String(We))&&gr.push({type:"byname",name:String(Nt.name),data:Gt({name:Nt.name})});else if(we)for(Kt=0;Kt<We.length;Kt++){var Ne=We[Kt];["number","string"].indexOf(typeof Ne)!==-1?(Ne=String(Ne),gr.push({type:"byname",name:Ne,data:Gt({name:Ne})})):E.isPlainObject(Ne)&&gr.push({type:"object",data:Gt(E.extendFlat({},Ne))})}for(Kt=0;Kt<gr.length;Kt++)if(Nt=gr[Kt],Nt.type==="byname"&&!nt._frameHash[Nt.data.name]){E.warn('animate failure: frame not found: "'+Nt.data.name+'"'),$t();return}["next","immediate"].indexOf(je.mode)!==-1&&Qt(),je.direction==="reverse"&&gr.reverse();var Xe=Pe._fullLayout._currentFrame;if(Xe&&je.fromcurrent){var Ke=-1;for(Kt=0;Kt<gr.length;Kt++)if(Nt=gr[Kt],Nt.type==="byname"&&Nt.name===Xe){Ke=Kt;break}if(Ke>0&&Ke<gr.length-1){var rt=[];for(Kt=0;Kt<gr.length;Kt++)Nt=gr[Kt],(gr[Kt].type!=="byname"||Kt>Ke)&&rt.push(Nt);gr=rt}}gr.length>0?fr(gr):(Pe.emit("plotly_animated"),Ht())})}function St(Pe,We,je){if(Pe=E.getGraphDiv(Pe),We==null)return Promise.resolve();if(!E.isPlotDiv(Pe))throw new Error("This element is not a Plotly plot: "+Pe+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var nt,kt,wt,Vt,qt=Pe._transitionData._frames,zt=Pe._transitionData._frameHash;if(!Array.isArray(We))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+We);var Ht=qt.length+We.length*2,$t=[],Qt={};for(nt=We.length-1;nt>=0;nt--)if(!!E.isPlainObject(We[nt])){var fr=We[nt].name,jr=(zt[fr]||Qt[fr]||{}).name,cn=We[nt].name,Qr=zt[jr]||Qt[jr];jr&&cn&&typeof cn=="number"&&Qr&&w<A&&(w++,E.warn('addFrames: overwriting frame "'+(zt[jr]||Qt[jr]).name+'" with a frame whose name of type "number" also equates to "'+jr+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),w===A&&E.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Qt[fr]={name:fr},$t.push({frame:i.supplyFrameDefaults(We[nt]),index:je&&je[nt]!==void 0&&je[nt]!==null?je[nt]:Ht+nt})}$t.sort(function(Me,Ne){return Me.index>Ne.index?-1:Me.index<Ne.index?1:0});var lt=[],Gt=[],Kt=qt.length;for(nt=$t.length-1;nt>=0;nt--){if(kt=$t[nt].frame,typeof kt.name=="number"&&E.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!kt.name)for(;zt[kt.name="frame "+Pe._transitionData._counter++];);if(zt[kt.name]){for(wt=0;wt<qt.length&&(qt[wt]||{}).name!==kt.name;wt++);lt.push({type:"replace",index:wt,value:kt}),Gt.unshift({type:"replace",index:wt,value:qt[wt]})}else Vt=Math.max(0,Math.min($t[nt].index,Kt)),lt.push({type:"insert",index:Vt,value:kt}),Gt.unshift({type:"delete",index:Vt}),Kt++}var Nt=i.modifyFrames,gr=i.modifyFrames,tt=[Pe,Gt],we=[Pe,lt];return g&&g.add(Pe,Nt,tt,gr,we),i.modifyFrames(Pe,lt)}function _t(Pe,We){if(Pe=E.getGraphDiv(Pe),!E.isPlotDiv(Pe))throw new Error("This element is not a Plotly plot: "+Pe);var je,nt,kt=Pe._transitionData._frames,wt=[],Vt=[];if(!We)for(We=[],je=0;je<kt.length;je++)We.push(je);for(We=We.slice(),We.sort(),je=We.length-1;je>=0;je--)nt=We[je],wt.push({type:"delete",index:nt}),Vt.unshift({type:"insert",index:nt,value:kt[nt]});var qt=i.modifyFrames,zt=i.modifyFrames,Ht=[Pe,Vt],$t=[Pe,wt];return g&&g.add(Pe,qt,Ht,zt,$t),i.modifyFrames(Pe,wt)}function it(Pe){Pe=E.getGraphDiv(Pe);var We=Pe._fullLayout||{},je=Pe._fullData||[];return i.cleanPlot([],{},je,We),i.purge(Pe),p.purge(Pe),We._container&&We._container.remove(),delete Pe._context,Pe}function ct(Pe){var We=Pe._fullLayout,je=Pe.getBoundingClientRect();if(!E.equalDomRects(je,We._lastBBox)){var nt=We._invTransform=E.inverseTransformMatrix(E.getFullTransformMatrix(Pe));We._invScaleX=Math.sqrt(nt[0][0]*nt[0][0]+nt[0][1]*nt[0][1]+nt[0][2]*nt[0][2]),We._invScaleY=Math.sqrt(nt[1][0]*nt[1][0]+nt[1][1]*nt[1][1]+nt[1][2]*nt[1][2]),We._lastBBox=je}}function et(Pe){var We=b.select(Pe),je=Pe._fullLayout;if(je._calcInverseTransform=ct,je._calcInverseTransform(Pe),je._container=We.selectAll(".plot-container").data([0]),je._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),je._paperdiv=je._container.selectAll(".svg-container").data([0]),je._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),je._glcontainer=je._paperdiv.selectAll(".gl-container").data([{}]),je._glcontainer.enter().append("div").classed("gl-container",!0),je._paperdiv.selectAll(".main-svg").remove(),je._paperdiv.select(".modebar-container").remove(),je._paper=je._paperdiv.insert("svg",":first-child").classed("main-svg",!0),je._toppaper=je._paperdiv.append("svg").classed("main-svg",!0),je._modebardiv=je._paperdiv.append("div"),delete je._modeBar,je._hoverpaper=je._paperdiv.append("svg").classed("main-svg",!0),!je._uid){var nt={};b.selectAll("defs").each(function(){this.id&&(nt[this.id.split("-")[1]]=1)}),je._uid=E.randstr(nt)}je._paperdiv.selectAll(".main-svg").attr(m.svgAttrs),je._defs=je._paper.append("defs").attr("id","defs-"+je._uid),je._clips=je._defs.append("g").classed("clips",!0),je._topdefs=je._toppaper.append("defs").attr("id","topdefs-"+je._uid),je._topclips=je._topdefs.append("g").classed("clips",!0),je._bgLayer=je._paper.append("g").classed("bglayer",!0),je._draggers=je._paper.append("g").classed("draglayer",!0);var kt=je._paper.append("g").classed("layer-below",!0);je._imageLowerLayer=kt.append("g").classed("imagelayer",!0),je._shapeLowerLayer=kt.append("g").classed("shapelayer",!0),je._cartesianlayer=je._paper.append("g").classed("cartesianlayer",!0),je._polarlayer=je._paper.append("g").classed("polarlayer",!0),je._smithlayer=je._paper.append("g").classed("smithlayer",!0),je._ternarylayer=je._paper.append("g").classed("ternarylayer",!0),je._geolayer=je._paper.append("g").classed("geolayer",!0),je._funnelarealayer=je._paper.append("g").classed("funnelarealayer",!0),je._pielayer=je._paper.append("g").classed("pielayer",!0),je._iciclelayer=je._paper.append("g").classed("iciclelayer",!0),je._treemaplayer=je._paper.append("g").classed("treemaplayer",!0),je._sunburstlayer=je._paper.append("g").classed("sunburstlayer",!0),je._indicatorlayer=je._toppaper.append("g").classed("indicatorlayer",!0),je._glimages=je._paper.append("g").classed("glimages",!0);var wt=je._toppaper.append("g").classed("layer-above",!0);je._imageUpperLayer=wt.append("g").classed("imagelayer",!0),je._shapeUpperLayer=wt.append("g").classed("shapelayer",!0),je._infolayer=je._toppaper.append("g").classed("infolayer",!0),je._menulayer=je._toppaper.append("g").classed("menulayer",!0),je._zoomlayer=je._toppaper.append("g").classed("zoomlayer",!0),je._hoverlayer=je._hoverpaper.append("g").classed("hoverlayer",!0),je._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),Pe.emit("plotly_framework")}ie.animate=Bt,ie.addFrames=St,ie.deleteFrames=_t,ie.addTraces=G,ie.deleteTraces=Q,ie.extendTraces=q,ie.moveTraces=V,ie.prependTraces=K,ie.newPlot=O,ie._doPlot=f,ie.purge=it,ie.react=at,ie.redraw=z,ie.relayout=ne,ie.restyle=H,ie.setPlotConfig=h,ie.update=be,ie._guiRelayout=Le(ne),ie._guiRestyle=Le(H),ie._guiUpdate=Le(be),ie._storeDirectGUIEdit=re},{"../components/color":366,"../components/drawing":388,"../constants/xmlns_namespaces":480,"../lib":503,"../lib/events":492,"../lib/queue":519,"../plots/cartesian/axes":554,"../plots/cartesian/constants":561,"../plots/cartesian/graph_interact":564,"../plots/cartesian/select":575,"../plots/plots":619,"../registry":638,"./edit_types":536,"./helpers":537,"./manage_arrays":539,"./plot_config":541,"./plot_schema":542,"./subroutines":544,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],541:[function(c,ae,ie){"use strict";var b={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},k={};function P(E,e){for(var p in E){var g=E[p];g.valType?e[p]=g.dflt:(e[p]||(e[p]={}),P(g,e[p]))}}P(b,k),ae.exports={configAttributes:b,dfltConfig:k}},{}],542:[function(c,ae,ie){"use strict";var b=c("../registry"),k=c("../lib"),P=c("../plots/attributes"),E=c("../plots/layout_attributes"),e=c("../plots/frame_attributes"),p=c("../plots/animation_attributes"),g=c("./plot_config").configAttributes,a=c("./edit_types"),t=k.extendDeepAll,i=k.isPlainObject,n=k.isArrayOrTypedArray,r=k.nestedProperty,d=k.valObjectMeta,s="_isSubplotObj",m="_isLinkedToArray",x="_arrayAttrRegexps",M="_deprecated",v=[s,m,x,M];ie.IS_SUBPLOT_OBJ=s,ie.IS_LINKED_TO_ARRAY=m,ie.DEPRECATED=M,ie.UNDERSCORE_ATTRS=v,ie.get=function(){var O={};b.allTypes.forEach(function(F){O[F]=T(F)});var I={};return Object.keys(b.transformsRegistry).forEach(function(F){I[F]=A(F)}),{defs:{valObjects:d,metaKeys:v.concat(["description","role","editType","impliedEdits"]),editType:{traces:a.traces,layout:a.layout},impliedEdits:{}},traces:O,layout:w(),transforms:I,frames:f(),animation:u(p),config:u(g)}},ie.crawl=function(O,I,F,D){var B=F||0;D=D||"",Object.keys(O).forEach(function(U){var X=O[U];if(v.indexOf(U)===-1){var oe=(D?D+".":"")+U;I(X,U,O,B,oe),!ie.isValObject(X)&&i(X)&&U!=="impliedEdits"&&ie.crawl(X,I,B+1,oe)}})},ie.isValObject=function(O){return O&&O.valType!==void 0},ie.findArrayAttributes=function(O){var I=[],F=[],D=[],B,U;function X(Q,V,H,ee){F=F.slice(0,ee).concat([V]),D=D.slice(0,ee).concat([Q&&Q._isLinkedToArray]);var J=Q&&(Q.valType==="data_array"||Q.arrayOk===!0)&&!(F[ee-1]==="colorbar"&&(V==="ticktext"||V==="tickvals"));!J||oe(B,0,"")}function oe(Q,V,H){var ee=Q[F[V]],J=H+F[V];if(V===F.length-1)n(ee)&&I.push(U+J);else if(D[V]){if(Array.isArray(ee))for(var W=0;W<ee.length;W++)i(ee[W])&&oe(ee[W],V+1,J+"["+W+"].")}else i(ee)&&oe(ee,V+1,J+".")}B=O,U="",ie.crawl(P,X),O._module&&O._module.attributes&&ie.crawl(O._module.attributes,X);var se=O.transforms;if(se)for(var q=0;q<se.length;q++){var K=se[q],G=K._module;G&&(U="transforms["+q+"].",B=K,ie.crawl(G.attributes,X))}return I},ie.getTraceValObject=function(O,I){var F=I[0],D=1,B,U;if(F==="transforms"){if(I.length===1)return P.transforms;var X=O.transforms;if(!Array.isArray(X)||!X.length)return!1;var oe=I[1];if(!y(oe)||oe>=X.length)return!1;B=(b.transformsRegistry[X[oe].type]||{}).attributes,U=B&&B[I[2]],D=3}else{var se=O._module;if(se||(se=(b.modules[O.type||P.type.dflt]||{})._module),!se)return!1;if(B=se.attributes,U=B&&B[F],!U){var q=se.basePlotModule;q&&q.attributes&&(U=q.attributes[F])}U||(U=P[F])}return l(U,I,D)},ie.getLayoutValObject=function(O,I){var F=_(O,I[0]);return l(F,I,1)};function _(O,I){var F,D,B,U,X=O._basePlotModules;if(X){var oe;for(F=0;F<X.length;F++){if(B=X[F],B.attrRegex&&B.attrRegex.test(I)){if(B.layoutAttrOverrides)return B.layoutAttrOverrides;!oe&&B.layoutAttributes&&(oe=B.layoutAttributes)}var se=B.baseLayoutAttrOverrides;if(se&&I in se)return se[I]}if(oe)return oe}var q=O._modules;if(q){for(F=0;F<q.length;F++)if(U=q[F].layoutAttributes,U&&I in U)return U[I]}for(D in b.componentsRegistry){if(B=b.componentsRegistry[D],B.name==="colorscale"&&I.indexOf("coloraxis")===0)return B.layoutAttributes[I];if(!B.schema&&I===B.name)return B.layoutAttributes}return I in E?E[I]:!1}function l(O,I,F){if(!O)return!1;if(O._isLinkedToArray){if(y(I[F]))F++;else if(F<I.length)return!1}for(;F<I.length;F++){var D=O[I[F]];if(i(D))O=D;else break;if(F===I.length-1)break;if(O._isLinkedToArray){if(F++,!y(I[F]))return!1}else if(O.valType==="info_array"){F++;var B=I[F];if(!y(B))return!1;var U=O.items;if(Array.isArray(U)){if(B>=U.length)return!1;if(O.dimensions===2){if(F++,I.length===F)return O;var X=I[F];if(!y(X))return!1;O=U[B][X]}else O=U[B]}else O=U}}return O}function y(O){return O===Math.round(O)&&O>=0}function T(O){var I,F;I=b.modules[O]._module,F=I.basePlotModule;var D={};D.type=null;var B=t({},P),U=t({},I.attributes);ie.crawl(U,function(se,q,K,G,Q){r(B,Q).set(void 0),se===void 0&&r(U,Q).set(void 0)}),t(D,B),b.traceIs(O,"noOpacity")&&delete D.opacity,b.traceIs(O,"showLegend")||(delete D.showlegend,delete D.legendgroup),b.traceIs(O,"noHover")&&(delete D.hoverinfo,delete D.hoverlabel),I.selectPoints||delete D.selectedpoints,t(D,U),F.attributes&&t(D,F.attributes),D.type=O;var X={meta:I.meta||{},categories:I.categories||{},animatable:Boolean(I.animatable),type:O,attributes:u(D)};if(I.layoutAttributes){var oe={};t(oe,I.layoutAttributes),X.layoutAttributes=u(oe)}return I.animatable||ie.crawl(X,function(se){ie.isValObject(se)&&"anim"in se&&delete se.anim}),X}function w(){var O={},I,F;t(O,E);for(I in b.subplotsRegistry)if(F=b.subplotsRegistry[I],!!F.layoutAttributes)if(Array.isArray(F.attr))for(var D=0;D<F.attr.length;D++)R(O,F,F.attr[D]);else{var B=F.attr==="subplot"?F.name:F.attr;R(O,F,B)}for(I in b.componentsRegistry){F=b.componentsRegistry[I];var U=F.schema;if(U&&(U.subplots||U.layout)){var X=U.subplots;if(X&&X.xaxis&&!X.yaxis)for(var oe in X.xaxis)delete O.yaxis[oe]}else F.name==="colorscale"?t(O,F.layoutAttributes):F.layoutAttributes&&z(O,F.layoutAttributes,F.name)}return{layoutAttributes:u(O)}}function A(O){var I=b.transformsRegistry[O],F=t({},I.attributes);return Object.keys(b.componentsRegistry).forEach(function(D){var B=b.componentsRegistry[D];B.schema&&B.schema.transforms&&B.schema.transforms[O]&&Object.keys(B.schema.transforms[O]).forEach(function(U){z(F,B.schema.transforms[O][U],U)})}),{attributes:u(F)}}function f(){var O={frames:t({},e)};return u(O),O.frames}function u(O){return h(O),o(O),S(O),O}function h(O){function I(D){return{valType:"string",editType:"none"}}function F(D,B,U){ie.isValObject(D)?(D.arrayOk===!0||D.valType==="data_array")&&(U[B+"src"]=I(B)):i(D)&&(D.role="object")}ie.crawl(O,F)}function o(O){function I(F,D,B){if(!!F){var U=F[m];!U||(delete F[m],B[D]={items:{}},B[D].items[U]=F,B[D].role="object")}}ie.crawl(O,I)}function S(O){function I(F){for(var D in F)if(i(F[D]))I(F[D]);else if(Array.isArray(F[D]))for(var B=0;B<F[D].length;B++)I(F[D][B]);else F[D]instanceof RegExp&&(F[D]=F[D].toString())}I(O)}function R(O,I,F){var D=r(O,F),B=t({},I.layoutAttributes);B[s]=!0,D.set(B)}function z(O,I,F){var D=r(O,F);D.set(t(D.get()||{},I))}},{"../lib":503,"../plots/animation_attributes":548,"../plots/attributes":550,"../plots/frame_attributes":586,"../plots/layout_attributes":610,"../registry":638,"./edit_types":536,"./plot_config":541}],543:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("../plots/attributes"),P="templateitemname",E={name:{valType:"string",editType:"none"}};E[P]={valType:"string",editType:"calc"},ie.templatedArray=function(g,a){return a._isLinkedToArray=g,a.name=E.name,a[P]=E[P],a},ie.traceTemplater=function(g){var a={},t,i;for(t in g)i=g[t],Array.isArray(i)&&i.length&&(a[t]=0);function n(r){t=b.coerce(r,{},k,"type");var d={type:t,_template:null};if(t in a){i=g[t];var s=a[t]%i.length;a[t]++,d._template=i[s]}return d}return{newTrace:n}},ie.newContainer=function(g,a,t){var i=g._template,n=i&&(i[a]||t&&i[t]);b.isPlainObject(n)||(n=null);var r=g[a]={_template:n};return r},ie.arrayTemplater=function(g,a,t){var i=g._template,n=i&&i[p(a)],r=i&&i[a];(!Array.isArray(r)||!r.length)&&(r=[]);var d={};function s(x){var M={name:x.name,_input:x},v=M[P]=x[P];if(!e(v))return M._template=n,M;for(var _=0;_<r.length;_++){var l=r[_];if(l.name===v)return d[v]=1,M._template=l,M}return M[t]=x[t]||!1,M._template=!1,M}function m(){for(var x=[],M=0;M<r.length;M++){var v=r[M],_=v.name;if(e(_)&&!d[_]){var l={_template:v,name:_,_input:{_templateitemname:_}};l[P]=v[P],x.push(l),d[_]=1}}return x}return{newItem:s,defaultItems:m}};function e(g){return g&&typeof g=="string"}function p(g){var a=g.length-1;return g.charAt(a)!=="s"&&b.warn("bad argument to arrayDefaultKey: "+g),g.substr(0,g.length-1)+"defaults"}ie.arrayDefaultKey=p,ie.arrayEditor=function(g,a,t){var i=(b.nestedProperty(g,a).get()||[]).length,n=t._index,r=n>=i&&(t._input||{})._templateitemname;r&&(n=i);var d=a+"["+n+"]",s;function m(){s={},r&&(s[d]={},s[d][P]=r)}m();function x(l,y){s[l]=y}function M(l,y){r?b.nestedProperty(s[d],l).set(y):s[d+"."+l]=y}function v(){var l=s;return m(),l}function _(l,y){l&&M(l,y);var T=v();for(var w in T)b.nestedProperty(g,w).set(T[w])}return{modifyBase:x,modifyItem:M,getUpdateObj:v,applyUpdate:_}}},{"../lib":503,"../plots/attributes":550}],544:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../registry"),P=c("../plots/plots"),E=c("../lib"),e=c("../lib/clear_gl_canvases"),p=c("../components/color"),g=c("../components/drawing"),a=c("../components/titles"),t=c("../components/modebar"),i=c("../plots/cartesian/axes"),n=c("../constants/alignment"),r=c("../plots/cartesian/constraints"),d=r.enforce,s=r.clean,m=c("../plots/cartesian/autorange").doAutoRange,x="start",M="middle",v="end";ie.layoutStyles=function(o){return E.syncOrAsync([P.doAutoMargin,l],o)};function _(o,S,R){for(var z=0;z<R.length;z++){var O=R[z][0],I=R[z][1];if(!(O[0]>=o[1]||O[1]<=o[0])&&I[0]<S[1]&&I[1]>S[0])return!0}return!1}function l(o){var S=o._fullLayout,R=S._size,z=R.p,O=i.list(o,"",!0),I,F,D,B,U,X;if(S._paperdiv.style({width:o._context.responsive&&S.autosize&&!o._context._hasZeroWidth&&!o.layout.width?"100%":S.width+"px",height:o._context.responsive&&S.autosize&&!o._context._hasZeroHeight&&!o.layout.height?"100%":S.height+"px"}).selectAll(".main-svg").call(g.setSize,S.width,S.height),o._context.setBackground(o,S.paper_bgcolor),ie.drawMainTitle(o),t.manage(o),!S._has("cartesian"))return P.previousPromises(o);function oe(It,Bt,St){var _t=It._lw/2;if(It._id.charAt(0)==="x"){if(Bt){if(St==="top")return Bt._offset-z-_t}else return R.t+R.h*(1-(It.position||0))+_t%1;return Bt._offset+Bt._length+z+_t}if(Bt){if(St==="right")return Bt._offset+Bt._length+z+_t}else return R.l+R.w*(It.position||0)+_t%1;return Bt._offset-z-_t}for(I=0;I<O.length;I++){B=O[I];var se=B._anchorAxis;B._linepositions={},B._lw=g.crispRound(o,B.linewidth,1),B._mainLinePosition=oe(B,se,B.side),B._mainMirrorPosition=B.mirror&&se?oe(B,se,n.OPPOSITE_SIDE[B.side]):null}var q=[],K=[],G=[],Q=p.opacity(S.paper_bgcolor)===1&&p.opacity(S.plot_bgcolor)===1&&S.paper_bgcolor===S.plot_bgcolor;for(F in S._plots)if(D=S._plots[F],D.mainplot)D.bg&&D.bg.remove(),D.bg=void 0;else{var V=D.xaxis.domain,H=D.yaxis.domain,ee=D.plotgroup;if(_(V,H,G)){var J=ee.node(),W=D.bg=E.ensureSingle(ee,"rect","bg");J.insertBefore(W.node(),J.childNodes[0]),K.push(F)}else ee.select("rect.bg").remove(),G.push([V,H]),Q||(q.push(F),K.push(F))}var re=S._bgLayer.selectAll(".bg").data(q);for(re.enter().append("rect").classed("bg",!0),re.exit().remove(),re.each(function(It){S._plots[It].bg=b.select(this)}),I=0;I<K.length;I++)D=S._plots[K[I]],U=D.xaxis,X=D.yaxis,D.bg&&U._offset!==void 0&&X._offset!==void 0&&D.bg.call(g.setRect,U._offset-z,X._offset-z,U._length+2*z,X._length+2*z).call(p.fill,S.plot_bgcolor).style("stroke-width",0);if(!S._hasOnlyLargeSploms)for(F in S._plots){D=S._plots[F],U=D.xaxis,X=D.yaxis;var j=D.clipId="clip"+S._uid+F+"plot",Z=E.ensureSingleById(S._clips,"clipPath",j,function(It){It.classed("plotclip",!0).append("rect")});D.clipRect=Z.select("rect").attr({width:U._length,height:X._length}),g.setTranslate(D.plot,U._offset,X._offset);var ne,le;D._hasClipOnAxisFalse?(ne=null,le=j):(ne=j,le=null),g.setClipUrl(D.plot,ne,o),D.layerClipId=le}var ge,pe,xe,Ee,Te,de,be,Le,De,ye,ke,Oe,Qe;function Ve(It){return"M"+ge+","+It+"H"+pe}function Ue(It){return"M"+U._offset+","+It+"h"+U._length}function Ie(It){return"M"+It+","+Le+"V"+be}function at(It){return"M"+It+","+X._offset+"v"+X._length}function pt(It,Bt,St){if(!It.showline||F!==It._mainSubplot)return"";if(!It._anchorAxis)return St(It._mainLinePosition);var _t=Bt(It._mainLinePosition);return It.mirror&&(_t+=Bt(It._mainMirrorPosition)),_t}for(F in S._plots){D=S._plots[F],U=D.xaxis,X=D.yaxis;var Rt="M0,0";y(U,F)&&(Te=w(U,"left",X,O),ge=U._offset-(Te?z+Te:0),de=w(U,"right",X,O),pe=U._offset+U._length+(de?z+de:0),xe=oe(U,X,"bottom"),Ee=oe(U,X,"top"),Qe=!U._anchorAxis||F!==U._mainSubplot,Qe&&(U.mirror==="allticks"||U.mirror==="all")&&(U._linepositions[F]=[xe,Ee]),Rt=pt(U,Ve,Ue),Qe&&U.showline&&(U.mirror==="all"||U.mirror==="allticks")&&(Rt+=Ve(xe)+Ve(Ee)),D.xlines.style("stroke-width",U._lw+"px").call(p.stroke,U.showline?U.linecolor:"rgba(0,0,0,0)")),D.xlines.attr("d",Rt);var Mt="M0,0";y(X,F)&&(ke=w(X,"bottom",U,O),be=X._offset+X._length+(ke?z:0),Oe=w(X,"top",U,O),Le=X._offset-(Oe?z:0),De=oe(X,U,"left"),ye=oe(X,U,"right"),Qe=!X._anchorAxis||F!==X._mainSubplot,Qe&&(X.mirror==="allticks"||X.mirror==="all")&&(X._linepositions[F]=[De,ye]),Mt=pt(X,Ie,at),Qe&&X.showline&&(X.mirror==="all"||X.mirror==="allticks")&&(Mt+=Ie(De)+Ie(ye)),D.ylines.style("stroke-width",X._lw+"px").call(p.stroke,X.showline?X.linecolor:"rgba(0,0,0,0)")),D.ylines.attr("d",Mt)}return i.makeClipPaths(o),P.previousPromises(o)}function y(o,S){return(o.ticks||o.showline)&&(S===o._mainSubplot||o.mirror==="all"||o.mirror==="allticks")}function T(o,S,R){if(!R.showline||!R._lw)return!1;if(R.mirror==="all"||R.mirror==="allticks")return!0;var z=R._anchorAxis;if(!z)return!1;var O=n.FROM_BL[S];return R.side===S?z.domain[O]===o.domain[O]:R.mirror&&z.domain[1-O]===o.domain[1-O]}function w(o,S,R,z){if(T(o,S,R))return R._lw;for(var O=0;O<z.length;O++){var I=z[O];if(I._mainAxis===R._mainAxis&&T(o,S,I))return I._lw}return 0}ie.drawMainTitle=function(o){var S=o._fullLayout,R=u(S),z=h(S);a.draw(o,"gtitle",{propContainer:S,propName:"title.text",placeholder:S._dfltTitle.plot,attributes:{x:A(S,R),y:f(S,z),"text-anchor":R,dy:z}})};function A(o,S){var R=o.title,z=o._size,O=0;switch(S===x?O=R.pad.l:S===v&&(O=-R.pad.r),R.xref){case"paper":return z.l+z.w*R.x+O;case"container":default:return o.width*R.x+O}}function f(o,S){var R=o.title,z=o._size,O=0;if(S==="0em"||!S?O=-R.pad.b:S===n.CAP_SHIFT+"em"&&(O=R.pad.t),R.y==="auto")return z.t/2;switch(R.yref){case"paper":return z.t+z.h-z.h*R.y+O;case"container":default:return o.height-o.height*R.y+O}}function u(o){var S=o.title,R=M;return E.isRightAnchor(S)?R=v:E.isLeftAnchor(S)&&(R=x),R}function h(o){var S=o.title,R="0em";return E.isTopAnchor(S)?R=n.CAP_SHIFT+"em":E.isMiddleAnchor(S)&&(R=n.MID_SHIFT+"em"),R}ie.doTraceStyle=function(o){var S=o.calcdata,R=[],z;for(z=0;z<S.length;z++){var O=S[z],I=O[0]||{},F=I.trace||{},D=F._module||{},B=D.arraysToCalcdata;B&&B(O,F);var U=D.editStyle;U&&R.push({fn:U,cd0:I})}if(R.length){for(z=0;z<R.length;z++){var X=R[z];X.fn(o,X.cd0)}e(o),ie.redrawReglTraces(o)}return P.style(o),k.getComponentMethod("legend","draw")(o),P.previousPromises(o)},ie.doColorBars=function(o){return k.getComponentMethod("colorbar","draw")(o),P.previousPromises(o)},ie.layoutReplot=function(o){var S=o.layout;return o.layout=void 0,k.call("_doPlot",o,"",S)},ie.doLegend=function(o){return k.getComponentMethod("legend","draw")(o),P.previousPromises(o)},ie.doTicksRelayout=function(o){return i.draw(o,"redraw"),o._fullLayout._hasOnlyLargeSploms&&(k.subplotsRegistry.splom.updateGrid(o),e(o),ie.redrawReglTraces(o)),ie.drawMainTitle(o),P.previousPromises(o)},ie.doModeBar=function(o){var S=o._fullLayout;t.manage(o);for(var R=0;R<S._basePlotModules.length;R++){var z=S._basePlotModules[R].updateFx;z&&z(o)}return P.previousPromises(o)},ie.doCamera=function(o){for(var S=o._fullLayout,R=S._subplots.gl3d,z=0;z<R.length;z++){var O=S[R[z]],I=O._scene;I.setViewport(O)}},ie.drawData=function(o){var S=o._fullLayout;e(o);for(var R=S._basePlotModules,z=0;z<R.length;z++)R[z].plot(o);return ie.redrawReglTraces(o),P.style(o),k.getComponentMethod("shapes","draw")(o),k.getComponentMethod("annotations","draw")(o),k.getComponentMethod("images","draw")(o),S._replotting=!1,P.previousPromises(o)},ie.redrawReglTraces=function(o){var S=o._fullLayout;if(S._has("regl")){var R=o._fullData,z=[],O=[],I,F;for(S._hasOnlyLargeSploms&&S._splomGrid.draw(),I=0;I<R.length;I++){var D=R[I];D.visible===!0&&D._length!==0&&(D.type==="splom"?S._splomScenes[D.uid].draw():D.type==="scattergl"?E.pushUnique(z,D.xaxis+D.yaxis):D.type==="scatterpolargl"&&E.pushUnique(O,D.subplot))}for(I=0;I<z.length;I++)F=S._plots[z[I]],F._scene&&F._scene.draw();for(I=0;I<O.length;I++)F=S[O[I]]._subplot,F._scene&&F._scene.draw()}},ie.doAutoRangeAndConstraints=function(o){for(var S=i.list(o,"",!0),R,z={},O=0;O<S.length;O++)if(R=S[O],!z[R._id]){z[R._id]=1,s(o,R),m(o,R);var I=R._matchGroup;if(I)for(var F in I){var D=i.getFromId(o,F);m(o,D,R.range),z[F]=1}}d(o)},ie.finalDraw=function(o){k.getComponentMethod("rangeslider","draw")(o),k.getComponentMethod("rangeselector","draw")(o)},ie.drawMarginPushers=function(o){k.getComponentMethod("legend","draw")(o),k.getComponentMethod("rangeselector","draw")(o),k.getComponentMethod("sliders","draw")(o),k.getComponentMethod("updatemenus","draw")(o),k.getComponentMethod("colorbar","draw")(o)}},{"../components/color":366,"../components/drawing":388,"../components/modebar":429,"../components/titles":464,"../constants/alignment":471,"../lib":503,"../lib/clear_gl_canvases":487,"../plots/cartesian/autorange":553,"../plots/cartesian/axes":554,"../plots/cartesian/constraints":562,"../plots/plots":619,"../registry":638,"@plotly/d3":58}],545:[function(c,ae,ie){"use strict";var b=c("../lib"),k=b.isPlainObject,P=c("./plot_schema"),E=c("../plots/plots"),e=c("../plots/attributes"),p=c("./plot_template"),g=c("./plot_config").dfltConfig;ie.makeTemplate=function(x){x=b.isPlainObject(x)?x:b.getGraphDiv(x),x=b.extendDeep({_context:g},{data:x.data,layout:x.layout}),E.supplyDefaults(x);var M=x.data||[],v=x.layout||{};v._basePlotModules=x._fullLayout._basePlotModules,v._modules=x._fullLayout._modules;var _={data:{},layout:{}};M.forEach(function(S){var R={};i(S,R,r.bind(null,S));var z=b.coerce(S,{},e,"type"),O=_.data[z];O||(O=_.data[z]=[]),O.push(R)}),i(v,_.layout,n.bind(null,v)),delete _.layout.template;var l=v.template;if(k(l)){var y=l.layout,T,w,A,f,u,h;k(y)&&a(y,_.layout);var o=l.data;if(k(o)){for(w in _.data)if(A=o[w],Array.isArray(A)){for(u=_.data[w],h=u.length,f=A.length,T=0;T<h;T++)a(A[T%f],u[T]);for(T=h;T<f;T++)u.push(b.extendDeep({},A[T]))}for(w in o)w in _.data||(_.data[w]=b.extendDeep([],o[w]))}}return _};function a(x,M){x=b.extendDeep({},x);var v=Object.keys(x).sort(),_,l;function y(u,h,o){if(k(h)&&k(u))a(u,h);else if(Array.isArray(h)&&Array.isArray(u)){var S=p.arrayTemplater({_template:x},o);for(l=0;l<h.length;l++){var R=h[l],z=S.newItem(R)._template;z&&a(z,R)}var O=S.defaultItems();for(l=0;l<O.length;l++)h.push(O[l]._template);for(l=0;l<h.length;l++)delete h[l].templateitemname}}for(_=0;_<v.length;_++){var T=v[_],w=x[T];if(T in M?y(w,M[T],T):M[T]=w,t(T)===T)for(var A in M){var f=t(A);A!==f&&f===T&&!(A in x)&&y(w,M[A],T)}}}function t(x){return x.replace(/[0-9]+$/,"")}function i(x,M,v,_,l){var y=l&&v(l);for(var T in x){var w=x[T],A=d(x,T,_),f=d(x,T,l),u=v(f);if(!u){var h=t(T);h!==T&&(f=d(x,h,l),u=v(f))}if(!(y&&y===u)&&!(!u||u._noTemplating||u.valType==="data_array"||u.arrayOk&&Array.isArray(w)))if(!u.valType&&k(w))i(w,M,v,A,f);else if(u._isLinkedToArray&&Array.isArray(w))for(var o=!1,S=0,R={},z=0;z<w.length;z++){var O=w[z];if(k(O)){var I=O.name;if(I)R[I]||(i(O,M,v,d(w,S,A),d(w,S,f)),S++,R[I]=1);else if(!o){var F=p.arrayDefaultKey(T),D=d(x,F,_),B=d(w,S,A);i(O,M,v,B,d(w,S,f));var U=b.nestedProperty(M,B),X=b.nestedProperty(M,D);X.set(U.get()),U.set(null),o=!0}}}else{var oe=b.nestedProperty(M,A);oe.set(w)}}}function n(x,M){return P.getLayoutValObject(x,b.nestedProperty({},M).parts)}function r(x,M){return P.getTraceValObject(x,b.nestedProperty({},M).parts)}function d(x,M,v){var _;return v?Array.isArray(x)?_=v+"["+M+"]":_=v+"."+M:_=M,_}ie.validateTemplate=function(x,M){var v=b.extendDeep({},{_context:g,data:x.data,layout:x.layout}),_=v.layout||{};k(M)||(M=_.template||{});var l=M.layout,y=M.data,T=[];v.layout=_,v.layout.template=M,E.supplyDefaults(v);var w=v._fullLayout,A=v._fullData,f={};function u(D,B){for(var U in D)if(U.charAt(0)!=="_"&&k(D[U])){var X=t(U),oe=[],se;for(se=0;se<B.length;se++)oe.push(d(D,U,B[se])),X!==U&&oe.push(d(D,X,B[se]));for(se=0;se<oe.length;se++)f[oe[se]]=1;u(D[U],oe)}}function h(D,B){for(var U in D)if(U.indexOf("defaults")===-1&&k(D[U])){var X=d(D,U,B);f[X]?h(D[U],X):T.push({code:"unused",path:X})}}if(k(l)?(u(w,["layout"]),h(l,"layout")):T.push({code:"layout"}),!k(y))T.push({code:"data"});else{for(var o={},S,R=0;R<A.length;R++){var z=A[R];S=z.type,o[S]=(o[S]||0)+1,z._fullInput._template||T.push({code:"missing",index:z._fullInput.index,traceType:S})}for(S in y){var O=y[S].length,I=o[S]||0;O>I?T.push({code:"unused",traceType:S,templateCount:O,dataCount:I}):I>O&&T.push({code:"reused",traceType:S,templateCount:O,dataCount:I})}}function F(D,B){for(var U in D)if(U.charAt(0)!=="_"){var X=D[U],oe=d(D,U,B);k(X)?(Array.isArray(D)&&X._template===!1&&X.templateitemname&&T.push({code:"missing",path:oe,templateitemname:X.templateitemname}),F(X,oe)):Array.isArray(X)&&s(X)&&F(X,oe)}}if(F({data:A,layout:w},""),T.length)return T.map(m)};function s(x){for(var M=0;M<x.length;M++)if(k(x[M]))return!0}function m(x){var M;switch(x.code){case"data":M="The template has no key data.";break;case"layout":M="The template has no key layout.";break;case"missing":x.path?M="There are no templates for item "+x.path+" with name "+x.templateitemname:M="There are no templates for trace "+x.index+", of type "+x.traceType+".";break;case"unused":x.path?M="The template item at "+x.path+" was not used in constructing the plot.":x.dataCount?M="Some of the templates of type "+x.traceType+" were not used. The template has "+x.templateCount+" traces, the data only has "+x.dataCount+" of this type.":M="The template has "+x.templateCount+" traces of type "+x.traceType+" but there are none in the data.";break;case"reused":M="Some of the templates of type "+x.traceType+" were used more than once. The template has "+x.templateCount+" traces, the data has "+x.dataCount+" of this type.";break}return x.msg=M,x}},{"../lib":503,"../plots/attributes":550,"../plots/plots":619,"./plot_config":541,"./plot_schema":542,"./plot_template":543}],546:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("./plot_api"),P=c("../plots/plots"),E=c("../lib"),e=c("../snapshot/helpers"),p=c("../snapshot/tosvg"),g=c("../snapshot/svgtoimg"),a=c("../version").version,t={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};function i(n,r){r=r||{};var d,s,m,x;E.isPlainObject(n)?(d=n.data||[],s=n.layout||{},m=n.config||{},x={}):(n=E.getGraphDiv(n),d=E.extendDeep([],n.data),s=E.extendDeep({},n.layout),m=n._context,x=n._fullLayout||{});function M(I){return!(I in r)||E.validate(r[I],t[I])}if(!M("width")&&r.width!==null||!M("height")&&r.height!==null)throw new Error("Height and width should be pixel values.");if(!M("format"))throw new Error("Export format is not "+E.join2(t.format.values,", "," or ")+".");var v={};function _(I,F){return E.coerce(r,v,t,I,F)}var l=_("format"),y=_("width"),T=_("height"),w=_("scale"),A=_("setBackground"),f=_("imageDataOnly"),u=document.createElement("div");u.style.position="absolute",u.style.left="-5000px",document.body.appendChild(u);var h=E.extendFlat({},s);y?h.width=y:r.width===null&&b(x.width)&&(h.width=x.width),T?h.height=T:r.height===null&&b(x.height)&&(h.height=x.height);var o=E.extendFlat({},m,{_exportedPlot:!0,staticPlot:!0,setBackground:A}),S=e.getRedrawFunc(u);function R(){return new Promise(function(I){setTimeout(I,e.getDelay(u._fullLayout))})}function z(){return new Promise(function(I,F){var D=p(u,l,w),B=u._fullLayout.width,U=u._fullLayout.height;function X(){k.purge(u),document.body.removeChild(u)}if(l==="full-json"){var oe=P.graphJson(u,!1,"keepdata","object",!0,!0);return oe.version=a,oe=JSON.stringify(oe),X(),I(f?oe:e.encodeJSON(oe))}if(X(),l==="svg")return I(f?D:e.encodeSVG(D));var se=document.createElement("canvas");se.id=E.randstr(),g({format:l,width:B,height:U,scale:w,canvas:se,svg:D,promise:!0}).then(I).catch(F)})}function O(I){return f?I.replace(e.IMAGE_URL_PREFIX,""):I}return new Promise(function(I,F){k.newPlot(u,d,h,o).then(S).then(R).then(z).then(function(D){I(O(D))}).catch(function(D){F(D)})})}ae.exports=i},{"../lib":503,"../plots/plots":619,"../snapshot/helpers":642,"../snapshot/svgtoimg":644,"../snapshot/tosvg":646,"../version":1123,"./plot_api":540,"fast-isnumeric":190}],547:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("../plots/plots"),P=c("./plot_schema"),E=c("./plot_config").dfltConfig,e=b.isPlainObject,p=Array.isArray,g=b.isArrayOrTypedArray;ae.exports=function(_,l){_===void 0&&(_=[]),l===void 0&&(l={});var y=P.get(),T=[],w={_context:b.extendFlat({},E)},A,f;p(_)?(w.data=b.extendDeep([],_),A=_):(w.data=[],A=[],T.push(r("array","data"))),e(l)?(w.layout=b.extendDeep({},l),f=l):(w.layout={},f={},arguments.length>1&&T.push(r("object","layout"))),k.supplyDefaults(w);for(var u=w._fullData,h=A.length,o=0;o<h;o++){var S=A[o],R=["data",o];if(!e(S)){T.push(r("object",R));continue}var z=u[o],O=z.type,I=y.traces[O].attributes;I.type={valType:"enumerated",values:[O]},z.visible===!1&&S.visible!==!1&&T.push(r("invisible",R)),a(S,z,I,T,R);var F=S.transforms,D=z.transforms;if(F){p(F)||T.push(r("array",R,["transforms"])),R.push("transforms");for(var B=0;B<F.length;B++){var U=["transforms",B],X=F[B].type;if(!e(F[B])){T.push(r("object",R,U));continue}var oe=y.transforms[X]?y.transforms[X].attributes:{};oe.type={valType:"enumerated",values:Object.keys(y.transforms)},a(F[B],D[B],oe,T,R,U)}}}var se=w._fullLayout,q=t(y,u);return a(f,se,q,T,"layout"),T.length===0?void 0:T};function a(v,_,l,y,T,w){w=w||[];for(var A=Object.keys(v),f=0;f<A.length;f++){var u=A[f];if(u!=="transforms"){var h=w.slice();h.push(u);var o=v[u],S=_[u],R=s(l,u),z=(R||{}).valType,O=z==="info_array",I=z==="colorscale",F=(R||{}).items;if(!d(l,u))y.push(r("schema",T,h));else if(e(o)&&e(S)&&z!=="any")a(o,S,R,y,T,h);else if(O&&p(o)){o.length>S.length&&y.push(r("unused",T,h.concat(S.length)));var D=S.length,B=Array.isArray(F);B&&(D=Math.min(D,F.length));var U,X,oe,se,q;if(R.dimensions===2)for(X=0;X<D;X++)if(p(o[X])){o[X].length>S[X].length&&y.push(r("unused",T,h.concat(X,S[X].length)));var K=S[X].length;for(U=0;U<(B?Math.min(K,F[X].length):K);U++)oe=B?F[X][U]:F,se=o[X][U],q=S[X][U],b.validate(se,oe)?q!==se&&q!==+se&&y.push(r("dynamic",T,h.concat(X,U),se,q)):y.push(r("value",T,h.concat(X,U),se))}else y.push(r("array",T,h.concat(X),o[X]));else for(X=0;X<D;X++)oe=B?F[X]:F,se=o[X],q=S[X],b.validate(se,oe)?q!==se&&q!==+se&&y.push(r("dynamic",T,h.concat(X),se,q)):y.push(r("value",T,h.concat(X),se))}else if(R.items&&!O&&p(o)){var G=F[Object.keys(F)[0]],Q=[],V,H;for(V=0;V<S.length;V++){var ee=S[V]._index||V;if(H=h.slice(),H.push(ee),e(o[ee])&&e(S[V])){Q.push(ee);var J=o[ee],W=S[V];e(J)&&J.visible!==!1&&W.visible===!1?y.push(r("invisible",T,H)):a(J,W,G,y,T,H)}}for(V=0;V<o.length;V++)H=h.slice(),H.push(V),e(o[V])?Q.indexOf(V)===-1&&y.push(r("unused",T,H)):y.push(r("object",T,H,o[V]))}else!e(o)&&e(S)?y.push(r("object",T,h,o)):!g(o)&&g(S)&&!O&&!I?y.push(r("array",T,h,o)):u in _?b.validate(o,R)?R.valType==="enumerated"&&(R.coerceNumber&&o!==+S||o!==S)&&y.push(r("dynamic",T,h,o,S)):y.push(r("value",T,h,o)):y.push(r("unused",T,h,o))}}return y}function t(v,_){for(var l=v.layout.layoutAttributes,y=0;y<_.length;y++){var T=_[y],w=v.traces[T.type],A=w.layoutAttributes;A&&(T.subplot?b.extendFlat(l[w.attributes.subplot.dflt],A):b.extendFlat(l,A))}return l}var i={object:function(v,_){var l;return v==="layout"&&_===""?l="The layout argument":v[0]==="data"&&_===""?l="Trace "+v[1]+" in the data argument":l=n(v)+"key "+_,l+" must be linked to an object container"},array:function(v,_){var l;return v==="data"?l="The data argument":l=n(v)+"key "+_,l+" must be linked to an array container"},schema:function(v,_){return n(v)+"key "+_+" is not part of the schema"},unused:function(v,_,l){var y=e(l)?"container":"key";return n(v)+y+" "+_+" did not get coerced"},dynamic:function(v,_,l,y){return[n(v)+"key",_,"(set to '"+l+"')","got reset to","'"+y+"'","during defaults."].join(" ")},invisible:function(v,_){return(_?n(v)+"item "+_:"Trace "+v[1])+" got defaulted to be not visible"},value:function(v,_,l){return[n(v)+"key "+_,"is set to an invalid value ("+l+")"].join(" ")}};function n(v){return p(v)?"In data trace "+v[1]+", ":"In "+v+", "}function r(v,_,l,y,T){l=l||"";var w,A;p(_)?(w=_[0],A=_[1]):(w=_,A=null);var f=M(l),u=i[v](_,f,y,T);return b.log(u),{code:v,container:w,trace:A,path:l,astr:f,msg:u}}function d(v,_){var l=x(_),y=l.keyMinusId,T=l.id;return y in v&&v[y]._isSubplotObj&&T?!0:_ in v}function s(v,_){if(_ in v)return v[_];var l=x(_);return v[l.keyMinusId]}var m=b.counterRegex("([a-z]+)");function x(v){var _=v.match(m);return{keyMinusId:_&&_[1],id:_&&_[2]}}function M(v){if(!p(v))return String(v);for(var _="",l=0;l<v.length;l++){var y=v[l];typeof y=="number"?_=_.substr(0,_.length-1)+"["+y+"]":_+=y,l<v.length-1&&(_+=".")}return _}},{"../lib":503,"../plots/plots":619,"./plot_config":541,"./plot_schema":542}],548:[function(c,ae,ie){"use strict";ae.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],549:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("../plot_api/plot_template");ae.exports=function(E,e,p){var g=p.name,a=p.inclusionAttr||"visible",t=e[g],i=b.isArrayOrTypedArray(E[g])?E[g]:[],n=e[g]=[],r=k.arrayTemplater(e,g,a),d,s;for(d=0;d<i.length;d++){var m=i[d];b.isPlainObject(m)?s=r.newItem(m):(s=r.newItem({}),s[a]=!1),s._index=d,s[a]!==!1&&p.handleItemDefaults(m,s,e,p),n.push(s)}var x=r.defaultItems();for(d=0;d<x.length;d++)s=x[d],s._index=n.length,p.handleItemDefaults({},s,e,p,{}),n.push(s);if(b.isArrayOrTypedArray(t)){var M=Math.min(t.length,n.length);for(d=0;d<M;d++)b.relinkPrivateKeys(n[d],t[d])}return n}},{"../lib":503,"../plot_api/plot_template":543}],550:[function(c,ae,ie){"use strict";var b=c("./font_attributes"),k=c("../components/fx/attributes");ae.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:b({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:k.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":397,"./font_attributes":585}],551:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=k.dateTime2ms,E=k.incrementMonth,e=c("../../constants/numerical"),p=e.ONEAVGMONTH;ae.exports=function(a,t,i,n){if(t.type!=="date")return{vals:n};var r=a[i+"periodalignment"];if(!r)return{vals:n};var d=a[i+"period"],s;if(b(d)){if(d=+d,d<=0)return{vals:n}}else if(typeof d=="string"&&d.charAt(0)==="M"){var m=+d.substring(1);if(m>0&&Math.round(m)===m)s=m;else return{vals:n}}for(var x=t.calendar,M=r==="start",v=r==="end",_=a[i+"period0"],l=P(_,x)||0,y=[],T=[],w=[],A=n.length,f=0;f<A;f++){var u=n[f],h,o,S;if(s){for(h=Math.round((u-l)/(s*p)),S=E(l,s*h,x);S>u;)S=E(S,-s,x);for(;S<=u;)S=E(S,s,x);o=E(S,-s,x)}else{for(h=Math.round((u-l)/d),S=l+h*d;S>u;)S-=d;for(;S<=u;)S+=d;o=S-d}y[f]=M?o:v?S:(o+S)/2,T[f]=o,w[f]=S}return{vals:y,starts:T,ends:w}}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],552:[function(c,ae,ie){"use strict";ae.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],553:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=c("../../lib"),E=c("../../constants/numerical").FP_SAFE,e=c("../../registry"),p=c("../../components/drawing"),g=c("./axis_ids"),a=g.getFromId,t=g.isLinked;ae.exports={getAutoRange:i,makePadFn:r,doAutoRange:x,findExtremes:M,concatExtremes:m};function i(A,f){var u,h,o=[],S=A._fullLayout,R=r(S,f,0),z=r(S,f,1),O=m(A,f),I=O.min,F=O.max;if(I.length===0||F.length===0)return P.simpleMap(f.range,f.r2l);var D=I[0].val,B=F[0].val;for(u=1;u<I.length&&D===B;u++)D=Math.min(D,I[u].val);for(u=1;u<F.length&&D===B;u++)B=Math.max(B,F[u].val);var U=!1;if(f.range){var X=P.simpleMap(f.range,f.r2l);U=X[1]<X[0]}f.autorange==="reversed"&&(U=!0,f.autorange=!0);var oe=f.rangemode,se=oe==="tozero",q=oe==="nonnegative",K=f._length,G=K/10,Q=0,V,H,ee,J,W,re;for(u=0;u<I.length;u++)for(V=I[u],h=0;h<F.length;h++)H=F[h],re=H.val-V.val-n(f,V.val,H.val),re>0&&(W=K-R(V)-z(H),W>G?re/W>Q&&(ee=V,J=H,Q=re/W):re/K>Q&&(ee={val:V.val,nopad:1},J={val:H.val,nopad:1},Q=re/K));function j(pe,xe){return Math.max(pe,z(xe))}if(D===B){var Z=D-1,ne=D+1;if(se)if(D===0)o=[0,1];else{var le=(D>0?F:I).reduce(j,0),ge=D/(1-Math.min(.5,le/K));o=D>0?[0,ge]:[ge,0]}else q?o=[Math.max(0,Z),Math.max(1,ne)]:o=[Z,ne]}else se?(ee.val>=0&&(ee={val:0,nopad:1}),J.val<=0&&(J={val:0,nopad:1})):q&&(ee.val-Q*R(ee)<0&&(ee={val:0,nopad:1}),J.val<=0&&(J={val:1,nopad:1})),Q=(J.val-ee.val-n(f,V.val,H.val))/(K-R(ee)-z(J)),o=[ee.val-Q*R(ee),J.val+Q*z(J)];return U&&o.reverse(),P.simpleMap(o,f.l2r||Number)}function n(A,f,u){var h=0;if(A.rangebreaks)for(var o=A.locateBreaks(f,u),S=0;S<o.length;S++){var R=o[S];h+=R.max-R.min}return h}function r(A,f,u){var h=.05*f._length,o=f._anchorAxis||{};if((f.ticklabelposition||"").indexOf("inside")!==-1||(o.ticklabelposition||"").indexOf("inside")!==-1){var S=f.autorange==="reversed";if(!S){var R=P.simpleMap(f.range,f.r2l);S=R[1]<R[0]}S&&(u=!u)}var z=0;return t(A,f._id)||(z=s(A,f,u)),h=Math.max(z,h),f.constrain==="domain"&&f._inputDomain&&(h*=(f._inputDomain[1]-f._inputDomain[0])/(f.domain[1]-f.domain[0])),function(I){return I.nopad?0:I.pad+(I.extrapad?h:z)}}var d=3;function s(A,f,u){var h=0,o=f._id.charAt(0)==="x";for(var S in A._plots){var R=A._plots[S];if(!(f._id!==R.xaxis._id&&f._id!==R.yaxis._id)){var z=(o?R.yaxis:R.xaxis)||{};if((z.ticklabelposition||"").indexOf("inside")!==-1&&(!u&&(z.side==="left"||z.side==="bottom")||u&&(z.side==="top"||z.side==="right"))){if(z._vals){var O=P.deg2rad(z._tickAngles[z._id+"tick"]||0),I=Math.abs(Math.cos(O)),F=Math.abs(Math.sin(O));if(!z._vals[0].bb){var D=z._id+"tick",B=z._selections[D];B.each(function(K){var G=b.select(this),Q=G.select(".text-math-group");Q.empty()&&(K.bb=p.bBox(G.node()))})}for(var U=0;U<z._vals.length;U++){var X=z._vals[U],oe=X.bb;if(oe){var se=2*d+oe.width,q=2*d+oe.height;h=Math.max(h,o?Math.max(se*I,q*F):Math.max(q*I,se*F))}}}z.ticks==="inside"&&z.ticklabelposition==="inside"&&(h+=z.ticklen||0)}}}return h}function m(A,f,u){var h=f._id,o=A._fullData,S=A._fullLayout,R=[],z=[],O,I,F;function D(se,q){for(O=0;O<q.length;O++){var K=se[q[O]],G=(K._extremes||{})[h];if(K.visible===!0&&G){for(I=0;I<G.min.length;I++)F=G.min[I],v(R,F.val,F.pad,{extrapad:F.extrapad});for(I=0;I<G.max.length;I++)F=G.max[I],_(z,F.val,F.pad,{extrapad:F.extrapad})}}}if(D(o,f._traceIndices),D(S.annotations||[],f._annIndices||[]),D(S.shapes||[],f._shapeIndices||[]),f._matchGroup&&!u){for(var B in f._matchGroup)if(B!==f._id){var U=a(A,B),X=m(A,U,!0),oe=f._length/U._length;for(I=0;I<X.min.length;I++)F=X.min[I],v(R,F.val,F.pad*oe,{extrapad:F.extrapad});for(I=0;I<X.max.length;I++)F=X.max[I],_(z,F.val,F.pad*oe,{extrapad:F.extrapad})}}return{min:R,max:z}}function x(A,f,u){if(f.setScale(),f.autorange){f.range=u?u.slice():i(A,f),f._r=f.range.slice(),f._rl=P.simpleMap(f._r,f.r2l);var h=f._input,o={};o[f._attr+".range"]=f.range,o[f._attr+".autorange"]=f.autorange,e.call("_storeDirectGUIEdit",A.layout,A._fullLayout._preGUI,o),h.range=f.range.slice(),h.autorange=f.autorange}var S=f._anchorAxis;if(S&&S.rangeslider){var R=S.rangeslider[f._name];R&&R.rangemode==="auto"&&(R.range=i(A,f)),S._input.rangeslider[f._name]=P.extendFlat({},R)}}function M(A,f,u){u||(u={}),A._m||A.setScale();var h=[],o=[],S=f.length,R=u.padded||!1,z=u.tozero&&(A.type==="linear"||A.type==="-"),O=A.type==="log",I=!1,F=u.vpadLinearized||!1,D,B,U,X,oe,se,q,K,G;function Q(Z){if(Array.isArray(Z))return I=!0,function(le){return Math.max(Number(Z[le]||0),0)};var ne=Math.max(Number(Z||0),0);return function(){return ne}}var V=Q((A._m>0?u.ppadplus:u.ppadminus)||u.ppad||0),H=Q((A._m>0?u.ppadminus:u.ppadplus)||u.ppad||0),ee=Q(u.vpadplus||u.vpad),J=Q(u.vpadminus||u.vpad);if(!I){if(K=1/0,G=-1/0,O)for(D=0;D<S;D++)B=f[D],B<K&&B>0&&(K=B),B>G&&B<E&&(G=B);else for(D=0;D<S;D++)B=f[D],B<K&&B>-E&&(K=B),B>G&&B<E&&(G=B);f=[K,G],S=2}var W={tozero:z,extrapad:R};function re(Z){U=f[Z],k(U)&&(se=V(Z),q=H(Z),F?(X=A.c2l(U)-J(Z),oe=A.c2l(U)+ee(Z)):(K=U-J(Z),G=U+ee(Z),O&&K<G/10&&(K=G/10),X=A.c2l(K),oe=A.c2l(G)),z&&(X=Math.min(0,X),oe=Math.max(0,oe)),y(X)&&v(h,X,q,W),y(oe)&&_(o,oe,se,W))}var j=Math.min(6,S);for(D=0;D<j;D++)re(D);for(D=S-1;D>=j;D--)re(D);return{min:h,max:o,opts:u}}function v(A,f,u,h){l(A,f,u,h,T)}function _(A,f,u,h){l(A,f,u,h,w)}function l(A,f,u,h,o){for(var S=h.tozero,R=h.extrapad,z=!0,O=0;O<A.length&&z;O++){var I=A[O];if(o(I.val,f)&&I.pad>=u&&(I.extrapad||!R)){z=!1;break}else o(f,I.val)&&I.pad<=u&&(R||!I.extrapad)&&(A.splice(O,1),O--)}if(z){var F=S&&f===0;A.push({val:f,pad:F?0:u,extrapad:F?!1:R})}}function y(A){return k(A)&&Math.abs(A)<E}function T(A,f){return A<=f}function w(A,f){return A>=f}},{"../../components/drawing":388,"../../constants/numerical":479,"../../lib":503,"../../registry":638,"./axis_ids":558,"@plotly/d3":58,"fast-isnumeric":190}],554:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=c("../../plots/plots"),E=c("../../registry"),e=c("../../lib"),p=e.strTranslate,g=c("../../lib/svg_text_utils"),a=c("../../components/titles"),t=c("../../components/color"),i=c("../../components/drawing"),n=c("./layout_attributes"),r=c("./clean_ticks"),d=c("../../constants/numerical"),s=d.ONEMAXYEAR,m=d.ONEAVGYEAR,x=d.ONEMINYEAR,M=d.ONEMAXQUARTER,v=d.ONEAVGQUARTER,_=d.ONEMINQUARTER,l=d.ONEMAXMONTH,y=d.ONEAVGMONTH,T=d.ONEMINMONTH,w=d.ONEWEEK,A=d.ONEDAY,f=A/2,u=d.ONEHOUR,h=d.ONEMIN,o=d.ONESEC,S=d.MINUS_SIGN,R=d.BADNUM,z={K:"zeroline"},O={K:"gridline",L:"path"},I={K:"tick",L:"path"},F={K:"tick",L:"text"},D=c("../../constants/alignment"),B=D.MID_SHIFT,U=D.CAP_SHIFT,X=D.LINE_SPACING,oe=D.OPPOSITE_SIDE,se=3,q=ae.exports={};q.setConvert=c("./set_convert");var K=c("./axis_autotype"),G=c("./axis_ids"),Q=G.idSort,V=G.isLinked;q.id2name=G.id2name,q.name2id=G.name2id,q.cleanId=G.cleanId,q.list=G.list,q.listIds=G.listIds,q.getFromId=G.getFromId,q.getFromTrace=G.getFromTrace;var H=c("./autorange");q.getAutoRange=H.getAutoRange,q.findExtremes=H.findExtremes;var ee=1e-4;function J(we){var Me=(we[1]-we[0])*ee;return[we[0]-Me,we[1]+Me]}q.coerceRef=function(we,Me,Ne,Xe,Ke,rt){var Je=Xe.charAt(Xe.length-1),vt=Ne._fullLayout._subplots[Je+"axis"],bt=Xe+"ref",Et={};return Ke||(Ke=vt[0]||(typeof rt=="string"?rt:rt[0])),rt||(rt=Ke),vt=vt.concat(vt.map(function(Wt){return Wt+" domain"})),Et[bt]={valType:"enumerated",values:vt.concat(rt?typeof rt=="string"?[rt]:rt:[]),dflt:Ke},e.coerce(we,Me,Et,bt)},q.getRefType=function(we){return we===void 0?we:we==="paper"?"paper":we==="pixel"?"pixel":/( domain)$/.test(we)?"domain":"range"},q.coercePosition=function(we,Me,Ne,Xe,Ke,rt){var Je,vt,bt=q.getRefType(Xe);if(bt!=="range")Je=e.ensureNumber,vt=Ne(Ke,rt);else{var Et=q.getFromId(Me,Xe);rt=Et.fraction2r(rt),vt=Ne(Ke,rt),Je=Et.cleanPos}we[Ke]=Je(vt)},q.cleanPosition=function(we,Me,Ne){var Xe=Ne==="paper"||Ne==="pixel"?e.ensureNumber:q.getFromId(Me,Ne).cleanPos;return Xe(we)},q.redrawComponents=function(we,Me){Me=Me||q.listIds(we);var Ne=we._fullLayout;function Xe(Ke,rt,Je,vt){for(var bt=E.getComponentMethod(Ke,rt),Et={},Wt=0;Wt<Me.length;Wt++)for(var Ot=Ne[q.id2name(Me[Wt])],ir=Ot[Je],vr=0;vr<ir.length;vr++){var _r=ir[vr];if(!Et[_r]&&(bt(we,_r),Et[_r]=1,vt))return}}Xe("annotations","drawOne","_annIndices"),Xe("shapes","drawOne","_shapeIndices"),Xe("images","draw","_imgIndices",!0)};var W=q.getDataConversions=function(we,Me,Ne,Xe){var Ke,rt=Ne==="x"||Ne==="y"||Ne==="z"?Ne:Xe;if(Array.isArray(rt)){if(Ke={type:K(Xe,void 0,{autotypenumbers:we._fullLayout.autotypenumbers}),_categories:[]},q.setConvert(Ke),Ke.type==="category")for(var Je=0;Je<Xe.length;Je++)Ke.d2c(Xe[Je])}else Ke=q.getFromTrace(we,Me,rt);return Ke?{d2c:Ke.d2c,c2d:Ke.c2d}:rt==="ids"?{d2c:j,c2d:j}:{d2c:re,c2d:re}};function re(we){return+we}function j(we){return String(we)}q.getDataToCoordFunc=function(we,Me,Ne,Xe){return W(we,Me,Ne,Xe).d2c},q.counterLetter=function(we){var Me=we.charAt(0);if(Me==="x")return"y";if(Me==="y")return"x"},q.minDtick=function(we,Me,Ne,Xe){["log","category","multicategory"].indexOf(we.type)!==-1||!Xe?we._minDtick=0:we._minDtick===void 0?(we._minDtick=Me,we._forceTick0=Ne):we._minDtick&&((we._minDtick/Me+1e-6)%1<2e-6&&((Ne-we._forceTick0)/Me%1+1.000001)%1<2e-6?(we._minDtick=Me,we._forceTick0=Ne):((Me/we._minDtick+1e-6)%1>2e-6||((Ne-we._forceTick0)/we._minDtick%1+1.000001)%1>2e-6)&&(we._minDtick=0))},q.saveRangeInitial=function(we,Me){for(var Ne=q.list(we,"",!0),Xe=!1,Ke=0;Ke<Ne.length;Ke++){var rt=Ne[Ke],Je=rt._rangeInitial===void 0,vt=Je||!(rt.range[0]===rt._rangeInitial[0]&&rt.range[1]===rt._rangeInitial[1]);(Je&&rt.autorange===!1||Me&&vt)&&(rt._rangeInitial=rt.range.slice(),Xe=!0)}return Xe},q.saveShowSpikeInitial=function(we,Me){for(var Ne=q.list(we,"",!0),Xe=!1,Ke="on",rt=0;rt<Ne.length;rt++){var Je=Ne[rt],vt=Je._showSpikeInitial===void 0,bt=vt||Je.showspikes!==Je._showspikes;(vt||Me&&bt)&&(Je._showSpikeInitial=Je.showspikes,Xe=!0),Ke==="on"&&!Je.showspikes&&(Ke="off")}return we._fullLayout._cartesianSpikesEnabled=Ke,Xe},q.autoBin=function(we,Me,Ne,Xe,Ke,rt){var Je=e.aggNums(Math.min,null,we),vt=e.aggNums(Math.max,null,we);if(Me.type==="category"||Me.type==="multicategory")return{start:Je-.5,end:vt+.5,size:Math.max(1,Math.round(rt)||1),_dataSpan:vt-Je};Ke||(Ke=Me.calendar);var bt;if(Me.type==="log"?bt={type:"linear",range:[Je,vt]}:bt={type:Me.type,range:e.simpleMap([Je,vt],Me.c2r,0,Ke),calendar:Ke},q.setConvert(bt),rt=rt&&r.dtick(rt,bt.type),rt)bt.dtick=rt,bt.tick0=r.tick0(void 0,bt.type,Ke);else{var Et;if(Ne)Et=(vt-Je)/Ne;else{var Wt=e.distinctVals(we),Ot=Math.pow(10,Math.floor(Math.log(Wt.minDiff)/Math.LN10)),ir=Ot*e.roundUp(Wt.minDiff/Ot,[.9,1.9,4.9,9.9],!0);Et=Math.max(ir,2*e.stdev(we)/Math.pow(we.length,Xe?.25:.4)),k(Et)||(Et=1)}q.autoTicks(bt,Et)}var vr=bt.dtick,_r=q.tickIncrement(q.tickFirst(bt),vr,"reverse",Ke),ln,Cr;if(typeof vr=="number")_r=Z(_r,we,bt,Je,vt),Cr=1+Math.floor((vt-_r)/vr),ln=_r+Cr*vr;else for(bt.dtick.charAt(0)==="M"&&(_r=ne(_r,we,vr,Je,Ke)),ln=_r,Cr=0;ln<=vt;)ln=q.tickIncrement(ln,vr,!1,Ke),Cr++;return{start:Me.c2r(_r,0,Ke),end:Me.c2r(ln,0,Ke),size:vr,_dataSpan:vt-Je}};function Z(we,Me,Ne,Xe,Ke){var rt=0,Je=0,vt=0,bt=0;function Et(vr){return(1+(vr-we)*100/Ne.dtick)%100<2}for(var Wt=0;Wt<Me.length;Wt++)Me[Wt]%1===0?vt++:k(Me[Wt])||bt++,Et(Me[Wt])&&rt++,Et(Me[Wt]+Ne.dtick/2)&&Je++;var Ot=Me.length-bt;if(vt===Ot&&Ne.type!=="date")Ne.dtick<1?we=Xe-.5*Ne.dtick:(we-=.5,we+Ne.dtick<Xe&&(we+=Ne.dtick));else if(Je<Ot*.1&&(rt>Ot*.3||Et(Xe)||Et(Ke))){var ir=Ne.dtick/2;we+=we+ir<Xe?ir:-ir}return we}function ne(we,Me,Ne,Xe,Ke){var rt=e.findExactDates(Me,Ke),Je=.8;if(rt.exactDays>Je){var vt=Number(Ne.substr(1));rt.exactYears>Je&&vt%12===0?we=q.tickIncrement(we,"M6","reverse")+A*1.5:rt.exactMonths>Je?we=q.tickIncrement(we,"M1","reverse")+A*15.5:we-=f;var bt=q.tickIncrement(we,Ne);if(bt<=Xe)return bt}return we}q.prepTicks=function(we,Me){var Ne=e.simpleMap(we.range,we.r2l,void 0,void 0,Me);if(we._dtickInit=we.dtick,we._tick0Init=we.tick0,we.tickmode==="auto"||!we.dtick){var Xe=we.nticks,Ke;Xe||(we.type==="category"||we.type==="multicategory"?(Ke=we.tickfont?e.bigFont(we.tickfont.size||12):15,Xe=we._length/Ke):(Ke=we._id.charAt(0)==="y"?40:80,Xe=e.constrain(we._length/Ke,4,9)+1),we._name==="radialaxis"&&(Xe*=2)),we.tickmode==="array"&&(Xe*=100),we._roughDTick=Math.abs(Ne[1]-Ne[0])/Xe,q.autoTicks(we,we._roughDTick),we._minDtick>0&&we.dtick<we._minDtick*2&&(we.dtick=we._minDtick,we.tick0=we.l2r(we._forceTick0))}we.ticklabelmode==="period"&&ge(we),we.tick0||(we.tick0=we.type==="date"?"2000-01-01":0),we.type==="date"&&we.dtick<.1&&(we.dtick=.1),Oe(we)};function le(we){return+we.substring(1)}function ge(we){var Me;function Ne(){return!(k(we.dtick)||we.dtick.charAt(0)!=="M")}var Xe=Ne(),Ke=q.getTickFormat(we);if(Ke){var rt=we._dtickInit!==we.dtick;/%[fLQsSMX]/.test(Ke)||(/%[HI]/.test(Ke)?(Me=u,rt&&!Xe&&we.dtick<u&&(we.dtick=u)):/%p/.test(Ke)?(Me=f,rt&&!Xe&&we.dtick<f&&(we.dtick=f)):/%[Aadejuwx]/.test(Ke)?(Me=A,rt&&!Xe&&we.dtick<A&&(we.dtick=A)):/%[UVW]/.test(Ke)?(Me=w,rt&&!Xe&&we.dtick<w&&(we.dtick=w)):/%[Bbm]/.test(Ke)?(Me=y,rt&&(Xe?le(we.dtick)<1:we.dtick<T)&&(we.dtick="M1")):/%[q]/.test(Ke)?(Me=v,rt&&(Xe?le(we.dtick)<3:we.dtick<_)&&(we.dtick="M3")):/%[Yy]/.test(Ke)&&(Me=m,rt&&(Xe?le(we.dtick)<12:we.dtick<x)&&(we.dtick="M12")))}Xe=Ne(),Xe&&we.tick0===we._dowTick0&&(we.tick0=we._rawTick0),we._definedDelta=Me}function pe(we,Me,Ne){for(var Xe=0;Xe<we.length;Xe++){var Ke=we[Xe].value,rt=Xe,Je=Xe+1;Xe<we.length-1?(rt=Xe,Je=Xe+1):Xe>0?(rt=Xe-1,Je=Xe):(rt=Xe,Je=Xe);var vt=we[rt].value,bt=we[Je].value,Et=Math.abs(bt-vt),Wt=Ne||Et,Ot=0;Wt>=x?Et>=x&&Et<=s?Ot=Et:Ot=m:Ne===v&&Wt>=_?Et>=_&&Et<=M?Ot=Et:Ot=v:Wt>=T?Et>=T&&Et<=l?Ot=Et:Ot=y:Ne===w&&Wt>=w?Ot=w:Wt>=A?Ot=A:Ne===f&&Wt>=f?Ot=f:Ne===u&&Wt>=u&&(Ot=u);var ir;Ot>=Et&&(Ot=Et,ir=!0);var vr=Ke+Ot;if(Me.rangebreaks&&Ot>0){for(var _r=84,ln=0,Cr=0;Cr<_r;Cr++){var Gr=(Cr+.5)/_r;Me.maskBreaks(Ke*(1-Gr)+Gr*vr)!==R&&ln++}Ot*=ln/_r,Ot||(we[Xe].drop=!0),ir&&Et>w&&(Ot=Et)}(Ot>0||Xe===0)&&(we[Xe].periodX=Ke+Ot/2)}}q.calcTicks=function(Me,Ne){q.prepTicks(Me,Ne);var Xe=e.simpleMap(Me.range,Me.r2l,void 0,void 0,Ne);if(Me.tickmode==="array")return xe(Me);var Ke=J(Xe),rt=Ke[0],Je=Ke[1],vt=Xe[1]<Xe[0],bt=Math.min(Xe[0],Xe[1]),Et=Math.max(Xe[0],Xe[1]),Wt=k(Me.dtick),Ot=Me.type==="log"&&!(Wt||Me.dtick.charAt(0)==="L"),ir=Me.ticklabelmode==="period";if(Me._tmin=q.tickFirst(Me,Ne),Me._tmin<rt!==vt)return[];(Me.type==="category"||Me.type==="multicategory")&&(Je=vt?Math.max(-.5,Je):Math.min(Me._categories.length-.5,Je));var vr=Me._tmin;Me.rangebreaks&&Me._tick0Init!==Me.tick0&&(vr=Nt(vr,Me),vt||(vr=q.tickIncrement(vr,Me.dtick,!vt,Me.calendar))),ir&&(vr=q.tickIncrement(vr,Me.dtick,!vt,Me.calendar));var _r=Me.ticklabelstep,ln=Math.max(1e3,Me._length||0),Cr=[],Gr=null,sn;Wt?sn=Me.dtick:Me.type==="date"?typeof Me.dtick=="string"&&Me.dtick.charAt(0)==="M"&&(sn=y*Me.dtick.substring(1)):sn=Me._roughDTick;for(var yr=Math.round((Me.r2l(vr)-Me.r2l(Me.tick0))/sn)-1;vt?vr>=Je:vr<=Je;vr=q.tickIncrement(vr,Me.dtick,vt,Me.calendar)){if(yr++,Me.rangebreaks&&!vt){if(vr<rt)continue;if(Me.maskBreaks(vr)===R&&Nt(vr,Me)>=Et)break}if(Cr.length>ln||vr===Gr)break;Gr=vr;var mr=!1;Ot&&vr!==(vr|0)&&(mr=!0);var Or={minor:mr,value:vr};_r>1&&yr%_r&&(Or.skipLabel=!0),Cr.push(Or)}ir&&pe(Cr,Me,Me._definedDelta);var zr;if(Me.rangebreaks){var Sr=Me._id.charAt(0)==="y",ot=1;Me.tickmode==="auto"&&(ot=Me.tickfont?Me.tickfont.size:12);var Lt=NaN;for(zr=Cr.length-1;zr>-1;zr--){if(Cr[zr].drop){Cr.splice(zr,1);continue}Cr[zr].value=Nt(Cr[zr].value,Me);var Xt=Me.c2p(Cr[zr].value);(Sr?Lt>Xt-ot:Lt<Xt+ot)?Cr.splice(vt?zr+1:zr,1):Lt=Xt}}Kt(Me)&&Math.abs(Xe[1]-Xe[0])===360&&Cr.pop(),Me._tmax=(Cr[Cr.length-1]||{}).value,Me._prevDateHead="",Me._inCalcTicks=!0;var tr,Lr=function(Sn){Sn.text=" ",Me._prevDateHead=tr},Nr=[],Rr,Ar;for(zr=0;zr<Cr.length;zr++){var Kr=Cr[zr].minor,Dn=Cr[zr].value;tr=Me._prevDateHead,Rr=q.tickText(Me,Dn,!1,Kr),Ar=Cr[zr].periodX,Ar!==void 0&&(Rr.periodX=Ar,(Ar>Et||Ar<bt)&&(Ar>Et&&(Rr.periodX=Et),Ar<bt&&(Rr.periodX=bt),Lr(Rr))),Cr[zr].skipLabel&&Lr(Rr),Nr.push(Rr)}return Me._inCalcTicks=!1,Nr};function xe(we){var Me=we.tickvals,Ne=we.ticktext,Xe=new Array(Me.length),Ke=e.simpleMap(we.range,we.r2l),rt=J(Ke),Je=Math.min(rt[0],rt[1]),vt=Math.max(rt[0],rt[1]),bt=0;Array.isArray(Ne)||(Ne=[]);var Et=we.type==="category"?we.d2l_noadd:we.d2l;we.type==="log"&&String(we.dtick).charAt(0)!=="L"&&(we.dtick="L"+Math.pow(10,Math.floor(Math.min(we.range[0],we.range[1]))-1));for(var Wt=0;Wt<Me.length;Wt++){var Ot=Et(Me[Wt]);Ot>Je&&Ot<vt&&(Ne[Wt]===void 0?Xe[bt]=q.tickText(we,Ot):Xe[bt]=Qe(we,Ot,String(Ne[Wt])),bt++)}return bt<Me.length&&Xe.splice(bt,Me.length-bt),we.rangebreaks&&(Xe=Xe.filter(function(ir){return we.maskBreaks(ir.x)!==R})),Xe}var Ee=[2,5,10],Te=[1,2,3,6,12],de=[1,2,5,10,15,30],be=[1,2,3,7,14],Le=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],De=[-.301,0,.301,.699,1],ye=[15,30,45,90,180];function ke(we,Me,Ne){return Me*e.roundUp(we/Me,Ne)}q.autoTicks=function(we,Me){var Ne;function Xe(Wt){return Math.pow(Wt,Math.floor(Math.log(Me)/Math.LN10))}if(we.type==="date"){we.tick0=e.dateTick0(we.calendar,0);var Ke=2*Me;if(Ke>m)Me/=m,Ne=Xe(10),we.dtick="M"+12*ke(Me,Ne,Ee);else if(Ke>y)Me/=y,we.dtick="M"+ke(Me,1,Te);else if(Ke>A){we.dtick=ke(Me,A,we._hasDayOfWeekBreaks?[1,2,7,14]:be);var rt=q.getTickFormat(we),Je=we.ticklabelmode==="period";Je&&(we._rawTick0=we.tick0),/%[uVW]/.test(rt)?we.tick0=e.dateTick0(we.calendar,2):we.tick0=e.dateTick0(we.calendar,1),Je&&(we._dowTick0=we.tick0)}else Ke>u?we.dtick=ke(Me,u,Te):Ke>h?we.dtick=ke(Me,h,de):Ke>o?we.dtick=ke(Me,o,de):(Ne=Xe(10),we.dtick=ke(Me,Ne,Ee))}else if(we.type==="log"){we.tick0=0;var vt=e.simpleMap(we.range,we.r2l);if(Me>.7)we.dtick=Math.ceil(Me);else if(Math.abs(vt[1]-vt[0])<1){var bt=1.5*Math.abs((vt[1]-vt[0])/Me);Me=Math.abs(Math.pow(10,vt[1])-Math.pow(10,vt[0]))/bt,Ne=Xe(10),we.dtick="L"+ke(Me,Ne,Ee)}else we.dtick=Me>.3?"D2":"D1"}else we.type==="category"||we.type==="multicategory"?(we.tick0=0,we.dtick=Math.ceil(Math.max(Me,1))):Kt(we)?(we.tick0=0,Ne=1,we.dtick=ke(Me,Ne,ye)):(we.tick0=0,Ne=Xe(10),we.dtick=ke(Me,Ne,Ee));if(we.dtick===0&&(we.dtick=1),!k(we.dtick)&&typeof we.dtick!="string"){var Et=we.dtick;throw we.dtick=1,"ax.dtick error: "+String(Et)}};function Oe(we){var Me=we.dtick;if(we._tickexponent=0,!k(Me)&&typeof Me!="string"&&(Me=1),(we.type==="category"||we.type==="multicategory")&&(we._tickround=null),we.type==="date"){var Ne=we.r2l(we.tick0),Xe=we.l2r(Ne).replace(/(^-|i)/g,""),Ke=Xe.length;if(String(Me).charAt(0)==="M")Ke>10||Xe.substr(5)!=="01-01"?we._tickround="d":we._tickround=+Me.substr(1)%12===0?"y":"m";else if(Me>=A&&Ke<=10||Me>=A*15)we._tickround="d";else if(Me>=h&&Ke<=16||Me>=u)we._tickround="M";else if(Me>=o&&Ke<=19||Me>=h)we._tickround="S";else{var rt=we.l2r(Ne+Me).replace(/^-/,"").length;we._tickround=Math.max(Ke,rt)-20,we._tickround<0&&(we._tickround=4)}}else if(k(Me)||Me.charAt(0)==="L"){var Je=we.range.map(we.r2d||Number);k(Me)||(Me=Number(Me.substr(1))),we._tickround=2-Math.floor(Math.log(Me)/Math.LN10+.01);var vt=Math.max(Math.abs(Je[0]),Math.abs(Je[1])),bt=Math.floor(Math.log(vt)/Math.LN10+.01),Et=we.minexponent===void 0?3:we.minexponent;Math.abs(bt)>Et&&(Bt(we.exponentformat)&&!St(bt)?we._tickexponent=3*Math.round((bt-1)/3):we._tickexponent=bt)}else we._tickround=null}q.tickIncrement=function(we,Me,Ne,Xe){var Ke=Ne?-1:1;if(k(Me))return e.increment(we,Ke*Me);var rt=Me.charAt(0),Je=Ke*Number(Me.substr(1));if(rt==="M")return e.incrementMonth(we,Je,Xe);if(rt==="L")return Math.log(Math.pow(10,we)+Je)/Math.LN10;if(rt==="D"){var vt=Me==="D2"?De:Le,bt=we+Ke*.01,Et=e.roundUp(e.mod(bt,1),vt,Ne);return Math.floor(bt)+Math.log(b.round(Math.pow(10,Et),1))/Math.LN10}throw"unrecognized dtick "+String(Me)},q.tickFirst=function(we,Me){var Ne=we.r2l||Number,Xe=e.simpleMap(we.range,Ne,void 0,void 0,Me),Ke=Xe[1]<Xe[0],rt=Ke?Math.floor:Math.ceil,Je=J(Xe)[0],vt=we.dtick,bt=Ne(we.tick0);if(k(vt)){var Et=rt((Je-bt)/vt)*vt+bt;return(we.type==="category"||we.type==="multicategory")&&(Et=e.constrain(Et,0,we._categories.length-1)),Et}var Wt=vt.charAt(0),Ot=Number(vt.substr(1));if(Wt==="M"){for(var ir=0,vr=bt,_r,ln,Cr;ir<10;){if(_r=q.tickIncrement(vr,vt,Ke,we.calendar),(_r-Je)*(vr-Je)<=0)return Ke?Math.min(vr,_r):Math.max(vr,_r);ln=(Je-(vr+_r)/2)/(_r-vr),Cr=Wt+(Math.abs(Math.round(ln))||1)*Ot,vr=q.tickIncrement(vr,Cr,ln<0?!Ke:Ke,we.calendar),ir++}return e.error("tickFirst did not converge",we),vr}else{if(Wt==="L")return Math.log(rt((Math.pow(10,Je)-bt)/Ot)*Ot+bt)/Math.LN10;if(Wt==="D"){var Gr=vt==="D2"?De:Le,sn=e.roundUp(e.mod(Je,1),Gr,Ke);return Math.floor(Je)+Math.log(b.round(Math.pow(10,sn),1))/Math.LN10}else throw"unrecognized dtick "+String(vt)}},q.tickText=function(we,Me,Ne,Xe){var Ke=Qe(we,Me),rt=we.tickmode==="array",Je=Ne||rt,vt=we.type,bt=vt==="category"?we.d2l_noadd:we.d2l,Et;if(rt&&Array.isArray(we.ticktext)){var Wt=e.simpleMap(we.range,we.r2l),Ot=(Math.abs(Wt[1]-Wt[0])-(we._lBreaks||0))/1e4;for(Et=0;Et<we.ticktext.length&&!(Math.abs(Me-bt(we.tickvals[Et]))<Ot);Et++);if(Et<we.ticktext.length)return Ke.text=String(we.ticktext[Et]),Ke}function ir(ln){if(ln===void 0)return!0;if(Ne)return ln==="none";var Cr={first:we._tmin,last:we._tmax}[ln];return ln!=="all"&&Me!==Cr}var vr=Ne?"never":we.exponentformat!=="none"&&ir(we.showexponent)?"hide":"";if(vt==="date"?Ve(we,Ke,Ne,Je):vt==="log"?Ue(we,Ke,Ne,Je,vr):vt==="category"?Ie(we,Ke):vt==="multicategory"?at(we,Ke,Ne):Kt(we)?Rt(we,Ke,Ne,Je,vr):pt(we,Ke,Ne,Je,vr),Xe||(we.tickprefix&&!ir(we.showtickprefix)&&(Ke.text=we.tickprefix+Ke.text),we.ticksuffix&&!ir(we.showticksuffix)&&(Ke.text+=we.ticksuffix)),we.tickson==="boundaries"||we.showdividers){var _r=function(ln){var Cr=we.l2p(ln);return Cr>=0&&Cr<=we._length?ln:null};Ke.xbnd=[_r(Ke.x-.5),_r(Ke.x+we.dtick-.5)]}return Ke},q.hoverLabelText=function(we,Me,Ne){Ne&&(we=e.extendFlat({},we,{hoverformat:Ne}));var Xe=Array.isArray(Me)?Me[0]:Me,Ke=Array.isArray(Me)?Me[1]:void 0;if(Ke!==void 0&&Ke!==Xe)return q.hoverLabelText(we,Xe,Ne)+" - "+q.hoverLabelText(we,Ke,Ne);var rt=we.type==="log"&&Xe<=0,Je=q.tickText(we,we.c2l(rt?-Xe:Xe),"hover").text;return rt?Xe===0?"0":S+Je:Je};function Qe(we,Me,Ne){var Xe=we.tickfont||{};return{x:Me,dx:0,dy:0,text:Ne||"",fontSize:Xe.size,font:Xe.family,fontColor:Xe.color}}function Ve(we,Me,Ne,Xe){var Ke=we._tickround,rt=Ne&&we.hoverformat||q.getTickFormat(we);Xe&&(k(Ke)?Ke=4:Ke={y:"m",m:"d",d:"M",M:"S",S:4}[Ke]);var Je=e.formatDate(Me.x,rt,Ke,we._dateFormat,we.calendar,we._extraFormat),vt,bt=Je.indexOf(`
`);if(bt!==-1&&(vt=Je.substr(bt+1),Je=Je.substr(0,bt)),Xe&&(Je==="00:00:00"||Je==="00:00"?(Je=vt,vt=""):Je.length===8&&(Je=Je.replace(/:00$/,""))),vt)if(Ne)Ke==="d"?Je+=", "+vt:Je=vt+(Je?", "+Je:"");else if(!we._inCalcTicks||we._prevDateHead!==vt)we._prevDateHead=vt,Je+="<br>"+vt;else{var Et=gr(we),Wt=we._trueSide||we.side;(!Et&&Wt==="top"||Et&&Wt==="bottom")&&(Je+="<br> ")}Me.text=Je}function Ue(we,Me,Ne,Xe,Ke){var rt=we.dtick,Je=Me.x,vt=we.tickformat,bt=typeof rt=="string"&&rt.charAt(0);if(Ke==="never"&&(Ke=""),Xe&&bt!=="L"&&(rt="L3",bt="L"),vt||bt==="L")Me.text=_t(Math.pow(10,Je),we,Ke,Xe);else if(k(rt)||bt==="D"&&e.mod(Je+.01,1)<.1){var Et=Math.round(Je),Wt=Math.abs(Et),Ot=we.exponentformat;Ot==="power"||Bt(Ot)&&St(Et)?(Et===0?Me.text=1:Et===1?Me.text="10":Me.text="10<sup>"+(Et>1?"":S)+Wt+"</sup>",Me.fontSize*=1.25):(Ot==="e"||Ot==="E")&&Wt>2?Me.text="1"+Ot+(Et>0?"+":S)+Wt:(Me.text=_t(Math.pow(10,Je),we,"","fakehover"),rt==="D1"&&we._id.charAt(0)==="y"&&(Me.dy-=Me.fontSize/6))}else if(bt==="D")Me.text=String(Math.round(Math.pow(10,e.mod(Je,1)))),Me.fontSize*=.75;else throw"unrecognized dtick "+String(rt);if(we.dtick==="D1"){var ir=String(Me.text).charAt(0);(ir==="0"||ir==="1")&&(we._id.charAt(0)==="y"?Me.dx-=Me.fontSize/4:(Me.dy+=Me.fontSize/2,Me.dx+=(we.range[1]>we.range[0]?1:-1)*Me.fontSize*(Je<0?.5:.25)))}}function Ie(we,Me){var Ne=we._categories[Math.round(Me.x)];Ne===void 0&&(Ne=""),Me.text=String(Ne)}function at(we,Me,Ne){var Xe=Math.round(Me.x),Ke=we._categories[Xe]||[],rt=Ke[1]===void 0?"":String(Ke[1]),Je=Ke[0]===void 0?"":String(Ke[0]);Ne?Me.text=Je+" - "+rt:(Me.text=rt,Me.text2=Je)}function pt(we,Me,Ne,Xe,Ke){Ke==="never"?Ke="":we.showexponent==="all"&&Math.abs(Me.x/we.dtick)<1e-6&&(Ke="hide"),Me.text=_t(Me.x,we,Ke,Xe)}function Rt(we,Me,Ne,Xe,Ke){if(we.thetaunit==="radians"&&!Ne){var rt=Me.x/180;if(rt===0)Me.text="0";else{var Je=Mt(rt);if(Je[1]>=100)Me.text=_t(e.deg2rad(Me.x),we,Ke,Xe);else{var vt=Me.x<0;Je[1]===1?Je[0]===1?Me.text="\u03C0":Me.text=Je[0]+"\u03C0":Me.text=["<sup>",Je[0],"</sup>","\u2044","<sub>",Je[1],"</sub>","\u03C0"].join(""),vt&&(Me.text=S+Me.text)}}}else Me.text=_t(Me.x,we,Ke,Xe)}function Mt(we){function Me(vt,bt){return Math.abs(vt-bt)<=1e-6}function Ne(vt,bt){return Me(bt,0)?vt:Ne(bt,vt%bt)}function Xe(vt){for(var bt=1;!Me(Math.round(vt*bt)/bt,vt);)bt*=10;return bt}var Ke=Xe(we),rt=we*Ke,Je=Math.abs(Ne(rt,Ke));return[Math.round(rt/Je),Math.round(Ke/Je)]}var It=["f","p","n","\u03BC","m","","k","M","G","T"];function Bt(we){return we==="SI"||we==="B"}function St(we){return we>14||we<-15}function _t(we,Me,Ne,Xe){var Ke=we<0,rt=Me._tickround,Je=Ne||Me.exponentformat||"B",vt=Me._tickexponent,bt=q.getTickFormat(Me),Et=Me.separatethousands;if(Xe){var Wt={exponentformat:Je,minexponent:Me.minexponent,dtick:Me.showexponent==="none"?Me.dtick:k(we)&&Math.abs(we)||1,range:Me.showexponent==="none"?Me.range.map(Me.r2d):[0,we||1]};Oe(Wt),rt=(Number(Wt._tickround)||0)+4,vt=Wt._tickexponent,Me.hoverformat&&(bt=Me.hoverformat)}if(bt)return Me._numFormat(bt)(we).replace(/-/g,S);var Ot=Math.pow(10,-rt)/2;if(Je==="none"&&(vt=0),we=Math.abs(we),we<Ot)we="0",Ke=!1;else{if(we+=Ot,vt&&(we*=Math.pow(10,-vt),rt+=vt),rt===0)we=String(Math.floor(we));else if(rt<0){we=String(Math.round(we)),we=we.substr(0,we.length+rt);for(var ir=rt;ir<0;ir++)we+="0"}else{we=String(we);var vr=we.indexOf(".")+1;vr&&(we=we.substr(0,vr+rt).replace(/\.?0+$/,""))}we=e.numSeparate(we,Me._separators,Et)}if(vt&&Je!=="hide"){Bt(Je)&&St(vt)&&(Je="power");var _r;vt<0?_r=S+-vt:Je!=="power"?_r="+"+vt:_r=String(vt),Je==="e"||Je==="E"?we+=Je+_r:Je==="power"?we+="\xD710<sup>"+_r+"</sup>":Je==="B"&&vt===9?we+="B":Bt(Je)&&(we+=It[vt/3+5])}return Ke?S+we:we}q.getTickFormat=function(we){var Me;function Ne(bt){return typeof bt!="string"?bt:Number(bt.replace("M",""))*y}function Xe(bt,Et){var Wt=["L","D"];if(typeof bt==typeof Et){if(typeof bt=="number")return bt-Et;var Ot=Wt.indexOf(bt.charAt(0)),ir=Wt.indexOf(Et.charAt(0));return Ot===ir?Number(bt.replace(/(L|D)/g,""))-Number(Et.replace(/(L|D)/g,"")):Ot-ir}else return typeof bt=="number"?1:-1}function Ke(bt,Et,Wt){var Ot=Wt||function(_r){return _r},ir=Et[0],vr=Et[1];return(!ir&&typeof ir!="number"||Ot(ir)<=Ot(bt))&&(!vr&&typeof vr!="number"||Ot(vr)>=Ot(bt))}function rt(bt,Et){var Wt=Et[0]===null,Ot=Et[1]===null,ir=Xe(bt,Et[0])>=0,vr=Xe(bt,Et[1])<=0;return(Wt||ir)&&(Ot||vr)}var Je,vt;if(we.tickformatstops&&we.tickformatstops.length>0)switch(we.type){case"date":case"linear":{for(Me=0;Me<we.tickformatstops.length;Me++)if(vt=we.tickformatstops[Me],vt.enabled&&Ke(we.dtick,vt.dtickrange,Ne)){Je=vt;break}break}case"log":{for(Me=0;Me<we.tickformatstops.length;Me++)if(vt=we.tickformatstops[Me],vt.enabled&&rt(we.dtick,vt.dtickrange)){Je=vt;break}break}default:}return Je?Je.value:we.tickformat},q.getSubplots=function(we,Me){var Ne=we._fullLayout._subplots,Xe=Ne.cartesian.concat(Ne.gl2d||[]),Ke=Me?q.findSubplotsWithAxis(Xe,Me):Xe;return Ke.sort(function(rt,Je){var vt=rt.substr(1).split("y"),bt=Je.substr(1).split("y");return vt[0]===bt[0]?+vt[1]-+bt[1]:+vt[0]-+bt[0]}),Ke},q.findSubplotsWithAxis=function(we,Me){for(var Ne=new RegExp(Me._id.charAt(0)==="x"?"^"+Me._id+"y":Me._id+"$"),Xe=[],Ke=0;Ke<we.length;Ke++){var rt=we[Ke];Ne.test(rt)&&Xe.push(rt)}return Xe},q.makeClipPaths=function(we){var Me=we._fullLayout;if(!Me._hasOnlyLargeSploms){var Ne={_offset:0,_length:Me.width,_id:""},Xe={_offset:0,_length:Me.height,_id:""},Ke=q.list(we,"x",!0),rt=q.list(we,"y",!0),Je=[],vt,bt;for(vt=0;vt<Ke.length;vt++)for(Je.push({x:Ke[vt],y:Xe}),bt=0;bt<rt.length;bt++)vt===0&&Je.push({x:Ne,y:rt[bt]}),Je.push({x:Ke[vt],y:rt[bt]});var Et=Me._clips.selectAll(".axesclip").data(Je,function(Wt){return Wt.x._id+Wt.y._id});Et.enter().append("clipPath").classed("axesclip",!0).attr("id",function(Wt){return"clip"+Me._uid+Wt.x._id+Wt.y._id}).append("rect"),Et.exit().remove(),Et.each(function(Wt){b.select(this).select("rect").attr({x:Wt.x._offset||0,y:Wt.y._offset||0,width:Wt.x._length||1,height:Wt.y._length||1})})}},q.draw=function(we,Me,Ne){var Xe=we._fullLayout;Me==="redraw"&&Xe._paper.selectAll("g.subplot").each(function(rt){var Je=rt[0],vt=Xe._plots[Je];if(vt){var bt=vt.xaxis,Et=vt.yaxis;vt.xaxislayer.selectAll("."+bt._id+"tick").remove(),vt.yaxislayer.selectAll("."+Et._id+"tick").remove(),vt.xaxislayer.selectAll("."+bt._id+"tick2").remove(),vt.yaxislayer.selectAll("."+Et._id+"tick2").remove(),vt.xaxislayer.selectAll("."+bt._id+"divider").remove(),vt.yaxislayer.selectAll("."+Et._id+"divider").remove(),vt.gridlayer&&vt.gridlayer.selectAll("path").remove(),vt.zerolinelayer&&vt.zerolinelayer.selectAll("path").remove(),Xe._infolayer.select(".g-"+bt._id+"title").remove(),Xe._infolayer.select(".g-"+Et._id+"title").remove()}});var Ke=!Me||Me==="redraw"?q.listIds(we):Me;return e.syncOrAsync(Ke.map(function(rt){return function(){if(!!rt){var Je=q.getFromId(we,rt),vt=q.drawOne(we,Je,Ne);return Je._r=Je.range.slice(),Je._rl=e.simpleMap(Je._r,Je.r2l),vt}}}))},q.drawOne=function(we,Me,Ne){Ne=Ne||{};var Xe,Ke,rt;Me.setScale();var Je=we._fullLayout,vt=Me._id,bt=vt.charAt(0),Et=q.counterLetter(vt),Wt=Je._plots[Me._mainSubplot];if(!Wt)return;var Ot=Wt[bt+"axislayer"],ir=Me._mainLinePosition,vr=Me._mainMirrorPosition,_r=Me._vals=q.calcTicks(Me),ln=[Me.mirror,ir,vr].join("_");for(Xe=0;Xe<_r.length;Xe++)_r[Xe].axInfo=ln;Me._selections={},Me._tickAngles&&(Me._prevTickAngles=Me._tickAngles),Me._tickAngles={},Me._depth=null;var Cr={};function Gr(Ka){var wr=vt+(Ka||"tick");return Cr[wr]||(Cr[wr]=Pe(Me,wr)),Cr[wr]}if(!!Me.visible){var sn=q.makeTransTickFn(Me),yr=q.makeTransTickLabelFn(Me),mr,Or,zr=Me.ticks==="inside",Sr=Me.ticks==="outside";if(Me.tickson==="boundaries"){var ot=it(Me,_r);Or=q.clipEnds(Me,ot),mr=zr?Or:ot}else Or=q.clipEnds(Me,_r),mr=zr&&Me.ticklabelmode!=="period"?Or:_r;var Lt=Me._gridVals=Or,Xt=et(Me,_r);if(!Je._hasOnlyLargeSploms){var tr=Me._subplotsWith,Lr={};for(Xe=0;Xe<tr.length;Xe++){Ke=tr[Xe],rt=Je._plots[Ke];var Nr=rt[Et+"axis"],Rr=Nr._mainAxis._id;if(!Lr[Rr]){Lr[Rr]=1;var Ar=bt==="x"?"M0,"+Nr._offset+"v"+Nr._length:"M"+Nr._offset+",0h"+Nr._length;q.drawGrid(we,Me,{vals:Lt,counterAxis:Nr,layer:rt.gridlayer.select("."+vt),path:Ar,transFn:sn}),q.drawZeroLine(we,Me,{counterAxis:Nr,layer:rt.zerolinelayer,path:Ar,transFn:sn})}}}var Kr=q.getTickSigns(Me),Dn=[];if(Me.ticks){var Sn=q.makeTickPath(Me,ir,Kr[2]),Jn,Bn;Me._anchorAxis&&Me.mirror&&Me.mirror!==!0?(Jn=q.makeTickPath(Me,vr,Kr[3]),Bn=Sn+Jn):(Jn="",Bn=Sn);var Xn;if(Me.showdividers&&Sr&&Me.tickson==="boundaries"){var ea={};for(Xe=0;Xe<Xt.length;Xe++)ea[Xt[Xe].x]=1;Xn=function(Ka){return ea[Ka.x]?Jn:Bn}}else Xn=Bn;q.drawTicks(we,Me,{vals:mr,layer:Ot,path:Xn,transFn:sn}),Me.mirror==="allticks"&&(Dn=Object.keys(Me._linepositions||{}))}for(Xe=0;Xe<Dn.length;Xe++){Ke=Dn[Xe],rt=Je._plots[Ke];var ka=Me._linepositions[Ke]||[],Ya=q.makeTickPath(Me,ka[0],Kr[0])+q.makeTickPath(Me,ka[1],Kr[1]);q.drawTicks(we,Me,{vals:mr,layer:rt[bt+"axislayer"],path:Ya,transFn:sn})}var fi=[];if(fi.push(function(){return q.drawLabels(we,Me,{vals:_r,layer:Ot,plotinfo:rt,transFn:yr,labelFns:q.makeLabelFns(Me,ir)})}),Me.type==="multicategory"){var pi={x:2,y:10}[bt];fi.push(function(){var Ka={x:"height",y:"width"}[bt],wr=Gr()[Ka]+pi+(Me._tickAngles[vt+"tick"]?Me.tickfont.size*X:0);return q.drawLabels(we,Me,{vals:ct(Me,_r),layer:Ot,cls:vt+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:sn,labelFns:q.makeLabelFns(Me,ir+wr*Kr[4])})}),fi.push(function(){return Me._depth=Kr[4]*(Gr("tick2")[Me.side]-ir),kt(we,Me,{vals:Xt,layer:Ot,path:q.makeTickPath(Me,ir,Kr[4],Me._depth),transFn:sn})})}else Me.title.hasOwnProperty("standoff")&&fi.push(function(){Me._depth=Kr[4]*(Gr()[Me.side]-ir)});var hi=E.getComponentMethod("rangeslider","isVisible")(Me);return fi.push(function(){var Ka=Me.side.charAt(0),wr=oe[Me.side].charAt(0),gn=q.getPxPosition(we,Me),hn=Sr?Me.ticklen:0,Tn,Vn,oa,na;if((Me.automargin||hi)&&(Me.type==="multicategory"?Tn=Gr("tick2"):(Tn=Gr(),bt==="x"&&Ka==="b"&&(Me._depth=Math.max(Tn.width>0?Tn.bottom-gn:0,hn)))),Me.automargin){Vn={x:0,y:0,r:0,l:0,t:0,b:0};var On=[0,1];if(bt==="x"){if(Ka==="b"?Vn[Ka]=Me._depth:(Vn[Ka]=Me._depth=Math.max(Tn.width>0?gn-Tn.top:0,hn),On.reverse()),Tn.width>0){var ta=Tn.right-(Me._offset+Me._length);ta>0&&(Vn.xr=1,Vn.r=ta);var Ua=Me._offset-Tn.left;Ua>0&&(Vn.xl=0,Vn.l=Ua)}}else if(Ka==="l"?Vn[Ka]=Me._depth=Math.max(Tn.height>0?gn-Tn.left:0,hn):(Vn[Ka]=Me._depth=Math.max(Tn.height>0?Tn.right-gn:0,hn),On.reverse()),Tn.height>0){var di=Tn.bottom-(Me._offset+Me._length);di>0&&(Vn.yb=0,Vn.b=di);var Ft=Me._offset-Tn.top;Ft>0&&(Vn.yt=1,Vn.t=Ft)}Vn[Et]=Me.anchor==="free"?Me.position:Me._anchorAxis.domain[On[0]],Me.title.text!==Je._dfltTitle[bt]&&(Vn[Ka]+=wt(Me)+(Me.title.standoff||0)),Me.mirror&&Me.anchor!=="free"&&(oa={x:0,y:0,r:0,l:0,t:0,b:0},oa[wr]=Me.linewidth,Me.mirror&&Me.mirror!==!0&&(oa[wr]+=hn),Me.mirror===!0||Me.mirror==="ticks"?oa[Et]=Me._anchorAxis.domain[On[1]]:(Me.mirror==="all"||Me.mirror==="allticks")&&(oa[Et]=[Me._counterDomainMin,Me._counterDomainMax][On[1]]))}hi&&(na=E.getComponentMethod("rangeslider","autoMarginOpts")(we,Me)),P.autoMargin(we,Qt(Me),Vn),P.autoMargin(we,fr(Me),oa),P.autoMargin(we,jr(Me),na)}),!Ne.skipTitle&&!(hi&&Me.side==="bottom")&&fi.push(function(){return Vt(we,Me)}),e.syncOrAsync(fi)}};function it(we,Me){var Ne=[],Xe,Ke=function(rt,Je){var vt=rt.xbnd[Je];vt!==null&&Ne.push(e.extendFlat({},rt,{x:vt}))};if(Me.length){for(Xe=0;Xe<Me.length;Xe++)Ke(Me[Xe],0);Ke(Me[Xe-1],1)}return Ne}function ct(we,Me){for(var Ne=[],Xe={},Ke=0;Ke<Me.length;Ke++){var rt=Me[Ke];Xe[rt.text2]?Xe[rt.text2].push(rt.x):Xe[rt.text2]=[rt.x]}for(var Je in Xe)Ne.push(Qe(we,e.interp(Xe[Je],.5),Je));return Ne}function et(we,Me){var Ne=[],Xe,Ke,rt=Me.length&&Me[Me.length-1].x<Me[0].x,Je=function(bt,Et){var Wt=bt.xbnd[Et];Wt!==null&&Ne.push(e.extendFlat({},bt,{x:Wt}))};if(we.showdividers&&Me.length){for(Xe=0;Xe<Me.length;Xe++){var vt=Me[Xe];vt.text2!==Ke&&Je(vt,rt?1:0),Ke=vt.text2}Je(Me[Xe-1],rt?0:1)}return Ne}function Pe(we,Me){var Ne,Xe,Ke,rt;return we._selections[Me].size()?(Ne=1/0,Xe=-1/0,Ke=1/0,rt=-1/0,we._selections[Me].each(function(){var Je=$t(this),vt=i.bBox(Je.node().parentNode);Ne=Math.min(Ne,vt.top),Xe=Math.max(Xe,vt.bottom),Ke=Math.min(Ke,vt.left),rt=Math.max(rt,vt.right)})):(Ne=0,Xe=0,Ke=0,rt=0),{top:Ne,bottom:Xe,left:Ke,right:rt,height:Xe-Ne,width:rt-Ke}}q.getTickSigns=function(we){var Me=we._id.charAt(0),Ne={x:"top",y:"right"}[Me],Xe=we.side===Ne?1:-1,Ke=[-1,1,Xe,-Xe];return we.ticks!=="inside"==(Me==="x")&&(Ke=Ke.map(function(rt){return-rt})),we.side&&Ke.push({l:-1,t:-1,r:1,b:1}[we.side.charAt(0)]),Ke},q.makeTransTickFn=function(we){return we._id.charAt(0)==="x"?function(Me){return p(we._offset+we.l2p(Me.x),0)}:function(Me){return p(0,we._offset+we.l2p(Me.x))}},q.makeTransTickLabelFn=function(we){var Me=je(we),Ne=Me[0],Xe=Me[1];return we._id.charAt(0)==="x"?function(Ke){return p(Ne+we._offset+we.l2p(We(Ke)),Xe)}:function(Ke){return p(Xe,Ne+we._offset+we.l2p(We(Ke)))}};function We(we){return we.periodX!==void 0?we.periodX:we.x}function je(we){var Me=we.ticklabelposition||"",Ne=function(vr){return Me.indexOf(vr)!==-1},Xe=Ne("top"),Ke=Ne("left"),rt=Ne("right"),Je=Ne("bottom"),vt=Ne("inside"),bt=Je||Ke||Xe||rt;if(!bt&&!vt)return[0,0];var Et=we.side,Wt=bt?(we.tickwidth||0)/2:0,Ot=se,ir=we.tickfont?we.tickfont.size:12;return(Je||Xe)&&(Wt+=ir*U,Ot+=(we.linewidth||0)/2),(Ke||rt)&&(Wt+=(we.linewidth||0)/2,Ot+=se),vt&&Et==="top"&&(Ot-=ir*(1-U)),(Ke||Xe)&&(Wt=-Wt),(Et==="bottom"||Et==="right")&&(Ot=-Ot),[bt?Wt:0,vt?Ot:0]}q.makeTickPath=function(we,Me,Ne,Xe){Xe=Xe!==void 0?Xe:we.ticklen;var Ke=we._id.charAt(0),rt=(we.linewidth||1)/2;return Ke==="x"?"M0,"+(Me+rt*Ne)+"v"+Xe*Ne:"M"+(Me+rt*Ne)+",0h"+Xe*Ne},q.makeLabelFns=function(we,Me,Ne){var Xe=we.ticklabelposition||"",Ke=function(Lr){return Xe.indexOf(Lr)!==-1},rt=Ke("top"),Je=Ke("left"),vt=Ke("right"),bt=Ke("bottom"),Et=bt||Je||rt||vt,Wt=Ke("inside"),Ot=Xe==="inside"&&we.ticks==="inside"||!Wt&&we.ticks==="outside"&&we.tickson!=="boundaries",ir=0,vr=0,_r=Ot?we.ticklen:0;if(Wt?_r*=-1:Et&&(_r=0),Ot&&(ir+=_r,Ne)){var ln=e.deg2rad(Ne);ir=_r*Math.cos(ln)+1,vr=_r*Math.sin(ln)}we.showticklabels&&(Ot||we.showline)&&(ir+=.2*we.tickfont.size),ir+=(we.linewidth||1)/2*(Wt?-1:1);var Cr={labelStandoff:ir,labelShift:vr},Gr,sn,yr,mr,Or=0,zr=we.side,Sr=we._id.charAt(0),ot=we.tickangle,Lt;if(Sr==="x")Lt=!Wt&&zr==="bottom"||Wt&&zr==="top",mr=Lt?1:-1,Wt&&(mr*=-1),Gr=vr*mr,sn=Me+ir*mr,yr=Lt?1:-.2,Math.abs(ot)===90&&(Wt?yr+=B:ot===-90&&zr==="bottom"?yr=U:ot===90&&zr==="top"?yr=B:yr=.5,Or=B/2*(ot/90)),Cr.xFn=function(Lr){return Lr.dx+Gr+Or*Lr.fontSize},Cr.yFn=function(Lr){return Lr.dy+sn+Lr.fontSize*yr},Cr.anchorFn=function(Lr,Nr){if(Et){if(Je)return"end";if(vt)return"start"}return!k(Nr)||Nr===0||Nr===180?"middle":Nr*mr<0!==Wt?"end":"start"},Cr.heightFn=function(Lr,Nr,Rr){return Nr<-60||Nr>60?-.5*Rr:we.side==="top"!==Wt?-Rr:0};else if(Sr==="y"){if(Lt=!Wt&&zr==="left"||Wt&&zr==="right",mr=Lt?1:-1,Wt&&(mr*=-1),Gr=ir,sn=vr*mr,yr=0,!Wt&&Math.abs(ot)===90&&(ot===-90&&zr==="left"||ot===90&&zr==="right"?yr=U:yr=.5),Wt){var Xt=k(ot)?+ot:0;if(Xt!==0){var tr=e.deg2rad(Xt);Or=Math.abs(Math.sin(tr))*U*mr,yr=0}}Cr.xFn=function(Lr){return Lr.dx+Me-(Gr+Lr.fontSize*yr)*mr+Or*Lr.fontSize},Cr.yFn=function(Lr){return Lr.dy+sn+Lr.fontSize*B},Cr.anchorFn=function(Lr,Nr){return k(Nr)&&Math.abs(Nr)===90?"middle":Lt?"end":"start"},Cr.heightFn=function(Lr,Nr,Rr){return we.side==="right"&&(Nr*=-1),Nr<-30?-Rr:Nr<30?-.5*Rr:0}}return Cr};function nt(we){return[we.text,we.x,we.axInfo,we.font,we.fontSize,we.fontColor].join("_")}q.drawTicks=function(we,Me,Ne){Ne=Ne||{};var Xe=Me._id+"tick",Ke=Ne.vals;Me.ticklabelmode==="period"&&(Ke=Ke.slice(),Ke.shift());var rt=Ne.layer.selectAll("path."+Xe).data(Me.ticks?Ke:[],nt);rt.exit().remove(),rt.enter().append("path").classed(Xe,1).classed("ticks",1).classed("crisp",Ne.crisp!==!1).call(t.stroke,Me.tickcolor).style("stroke-width",i.crispRound(we,Me.tickwidth,1)+"px").attr("d",Ne.path).style("display",null),tt(Me,[I]),rt.attr("transform",Ne.transFn)},q.drawGrid=function(we,Me,Ne){Ne=Ne||{};var Xe=Me._id+"grid",Ke=Ne.vals,rt=Ne.counterAxis;if(Me.showgrid===!1)Ke=[];else if(rt&&q.shouldShowZeroLine(we,Me,rt))for(var Je=Me.tickmode==="array",vt=0;vt<Ke.length;vt++){var bt=Ke[vt].x;if(Je?!bt:Math.abs(bt)<Me.dtick/100)if(Ke=Ke.slice(0,vt).concat(Ke.slice(vt+1)),Je)vt--;else break}var Et=Ne.layer.selectAll("path."+Xe).data(Ke,nt);Et.exit().remove(),Et.enter().append("path").classed(Xe,1).classed("crisp",Ne.crisp!==!1),Me._gw=i.crispRound(we,Me.gridwidth,1),Et.attr("transform",Ne.transFn).attr("d",Ne.path).call(t.stroke,Me.gridcolor||"#ddd").style("stroke-width",Me._gw+"px").style("display",null),tt(Me,[O]),typeof Ne.path=="function"&&Et.attr("d",Ne.path)},q.drawZeroLine=function(we,Me,Ne){Ne=Ne||Ne;var Xe=Me._id+"zl",Ke=q.shouldShowZeroLine(we,Me,Ne.counterAxis),rt=Ne.layer.selectAll("path."+Xe).data(Ke?[{x:0,id:Me._id}]:[]);rt.exit().remove(),rt.enter().append("path").classed(Xe,1).classed("zl",1).classed("crisp",Ne.crisp!==!1).each(function(){Ne.layer.selectAll("path").sort(function(Je,vt){return Q(Je.id,vt.id)})}),rt.attr("transform",Ne.transFn).attr("d",Ne.path).call(t.stroke,Me.zerolinecolor||t.defaultLine).style("stroke-width",i.crispRound(we,Me.zerolinewidth,Me._gw||1)+"px").style("display",null),tt(Me,[z])},q.drawLabels=function(we,Me,Ne){Ne=Ne||{};var Xe=we._fullLayout,Ke=Me._id,rt=Ke.charAt(0),Je=Ne.cls||Ke+"tick",vt=Ne.vals,bt=Ne.labelFns,Et=Ne.secondary?0:Me.tickangle,Wt=(Me._prevTickAngles||{})[Je],Ot=Ne.layer.selectAll("g."+Je).data(Me.showticklabels?vt:[],nt),ir=[];Ot.enter().append("g").classed(Je,1).append("text").attr("text-anchor","middle").each(function(mr){var Or=b.select(this),zr=we._promises.length;Or.call(g.positionText,bt.xFn(mr),bt.yFn(mr)).call(i.font,mr.font,mr.fontSize,mr.fontColor).text(mr.text).call(g.convertToTspans,we),we._promises[zr]?ir.push(we._promises.pop().then(function(){vr(Or,Et)})):vr(Or,Et)}),tt(Me,[F]),Ot.exit().remove(),Ne.repositionOnUpdate&&Ot.each(function(mr){b.select(this).select("text").call(g.positionText,bt.xFn(mr),bt.yFn(mr))});function vr(mr,Or){mr.each(function(zr){var Sr=b.select(this),ot=Sr.select(".text-math-group"),Lt=bt.anchorFn(zr,Or),Xt=Ne.transFn.call(Sr.node(),zr)+(k(Or)&&+Or!=0?" rotate("+Or+","+bt.xFn(zr)+","+(bt.yFn(zr)-zr.fontSize/2)+")":""),tr=g.lineCount(Sr),Lr=X*zr.fontSize,Nr=bt.heightFn(zr,k(Or)?+Or:0,(tr-1)*Lr);if(Nr&&(Xt+=p(0,Nr)),ot.empty()){var Rr=Sr.select("text");Rr.attr({transform:Xt,"text-anchor":Lt}),Rr.style("opacity",1),Me._adjustTickLabelsOverflow&&Me._adjustTickLabelsOverflow()}else{var Ar=i.bBox(ot.node()).width,Kr=Ar*{end:-.5,start:.5}[Lt];ot.attr("transform",Xt+p(Kr,0))}})}Me._adjustTickLabelsOverflow=function(){var mr=Me.ticklabeloverflow;if(!(!mr||mr==="allow")){var Or=mr.indexOf("hide")!==-1,zr=Me._id.charAt(0)==="x",Sr=0,ot=zr?we._fullLayout.width:we._fullLayout.height;if(mr.indexOf("domain")!==-1){var Lt=e.simpleMap(Me.range,Me.r2l);Sr=Me.l2p(Lt[0])+Me._offset,ot=Me.l2p(Lt[1])+Me._offset}var Xt=Math.min(Sr,ot),tr=Math.max(Sr,ot),Lr=Me.side,Nr=1/0,Rr=-1/0;Ot.each(function(Sn){var Jn=b.select(this),Bn=Jn.select(".text-math-group");if(Bn.empty()){var Xn=i.bBox(Jn.node()),ea=0;zr?(Xn.right>tr||Xn.left<Xt)&&(ea=1):(Xn.bottom>tr||Xn.top+(Me.tickangle?0:Sn.fontSize/4)<Xt)&&(ea=1);var ka=Jn.select("text");ea?Or&&ka.style("opacity",0):(ka.style("opacity",1),Lr==="bottom"||Lr==="right"?Nr=Math.min(Nr,zr?Xn.top:Xn.left):Nr=-1/0,Lr==="top"||Lr==="left"?Rr=Math.max(Rr,zr?Xn.bottom:Xn.right):Rr=1/0)}});for(var Ar in Xe._plots){var Kr=Xe._plots[Ar];if(!(Me._id!==Kr.xaxis._id&&Me._id!==Kr.yaxis._id)){var Dn=zr?Kr.yaxis:Kr.xaxis;Dn&&(Dn["_visibleLabelMin_"+Me._id]=Nr,Dn["_visibleLabelMax_"+Me._id]=Rr)}}}},Me._hideCounterAxisInsideTickLabels=function(mr){var Or=Me._id.charAt(0)==="x",zr=[];for(var Sr in Xe._plots){var ot=Xe._plots[Sr];Me._id!==ot.xaxis._id&&Me._id!==ot.yaxis._id||zr.push(Or?ot.yaxis:ot.xaxis)}zr.forEach(function(Lt,Xt){Lt&&gr(Lt)&&(mr||[z,O,I,F]).forEach(function(tr){var Lr=tr.K==="tick"&&tr.L==="text"&&Me.ticklabelmode==="period",Nr=Xe._plots[Me._mainSubplot],Rr;tr.K===z.K?Rr=Nr.zerolinelayer.selectAll("."+Me._id+"zl"):tr.K===O.K?Rr=Nr.gridlayer.selectAll("."+Me._id):Rr=Nr[Me._id.charAt(0)+"axislayer"],Rr.each(function(){var Ar=b.select(this);tr.L&&(Ar=Ar.selectAll(tr.L)),Ar.each(function(Kr){var Dn=Me.l2p(Lr?We(Kr):Kr.x)+Me._offset,Sn=b.select(this);Dn<Me["_visibleLabelMax_"+Lt._id]&&Dn>Me["_visibleLabelMin_"+Lt._id]?Sn.style("display","none"):tr.K==="tick"&&!Xt&&Sn.style("display",null)})})})})},vr(Ot,Wt+1?Wt:Et);function _r(){return ir.length&&Promise.all(ir)}var ln=null;function Cr(){if(vr(Ot,Et),vt.length&&rt==="x"&&!k(Et)&&(Me.type!=="log"||String(Me.dtick).charAt(0)!=="D")){ln=0;var mr=0,Or=[],zr;if(Ot.each(function(Xn){mr=Math.max(mr,Xn.fontSize);var ea=Me.l2p(Xn.x),ka=$t(this),Ya=i.bBox(ka.node());Or.push({top:0,bottom:10,height:10,left:ea-Ya.width/2,right:ea+Ya.width/2+2,width:Ya.width+2})}),(Me.tickson==="boundaries"||Me.showdividers)&&!Ne.secondary){var Sr=2;for(Me.ticks&&(Sr+=Me.tickwidth/2),zr=0;zr<Or.length;zr++){var ot=vt[zr].xbnd,Lt=Or[zr];if(ot[0]!==null&&Lt.left-Me.l2p(ot[0])<Sr||ot[1]!==null&&Me.l2p(ot[1])-Lt.right<Sr){ln=90;break}}}else{var Xt=vt.length,tr=Math.abs((vt[Xt-1].x-vt[0].x)*Me._m)/(Xt-1),Lr=Me.ticklabelposition||"",Nr=function(Xn){return Lr.indexOf(Xn)!==-1},Rr=Nr("top"),Ar=Nr("left"),Kr=Nr("right"),Dn=Nr("bottom"),Sn=Dn||Ar||Rr||Kr,Jn=Sn?(Me.tickwidth||0)+2*se:0,Bn=tr<mr*2.5||Me.type==="multicategory"||Me._name==="realaxis";for(zr=0;zr<Or.length-1;zr++)if(e.bBoxIntersect(Or[zr],Or[zr+1],Jn)){ln=Bn?90:30;break}}ln&&vr(Ot,ln)}}Me._selections&&(Me._selections[Je]=Ot);var Gr=[_r];Me.automargin&&Xe._redrawFromAutoMarginCount&&Wt===90?(ln=90,Gr.push(function(){vr(Ot,Wt)})):Gr.push(Cr),Me._tickAngles&&Gr.push(function(){Me._tickAngles[Je]=ln===null?k(Et)?Et:0:ln});var sn=Me._anchorAxis;sn&&sn.autorange&&gr(Me)&&!V(Xe,Me._id)&&(Xe._insideTickLabelsAutorange||(Xe._insideTickLabelsAutorange={}),Xe._insideTickLabelsAutorange[sn._name+".autorange"]=sn.autorange,Gr.push(function(){Ot.each(function(Or,zr){var Sr=$t(this),ot=Sr.select(".text-math-group");ot.empty()&&(Me._vals[zr].bb=i.bBox(Sr.node()))})}));var yr=e.syncOrAsync(Gr);return yr&&yr.then&&we._promises.push(yr),yr};function kt(we,Me,Ne){var Xe=Me._id+"divider",Ke=Ne.vals,rt=Ne.layer.selectAll("path."+Xe).data(Ke,nt);rt.exit().remove(),rt.enter().insert("path",":first-child").classed(Xe,1).classed("crisp",1).call(t.stroke,Me.dividercolor).style("stroke-width",i.crispRound(we,Me.dividerwidth,1)+"px"),rt.attr("transform",Ne.transFn).attr("d",Ne.path)}q.getPxPosition=function(we,Me){var Ne=we._fullLayout._size,Xe=Me._id.charAt(0),Ke=Me.side,rt;if(Me.anchor!=="free"?rt=Me._anchorAxis:Xe==="x"?rt={_offset:Ne.t+(1-(Me.position||0))*Ne.h,_length:0}:Xe==="y"&&(rt={_offset:Ne.l+(Me.position||0)*Ne.w,_length:0}),Ke==="top"||Ke==="left")return rt._offset;if(Ke==="bottom"||Ke==="right")return rt._offset+rt._length};function wt(we){var Me=we.title.font.size,Ne=(we.title.text.match(g.BR_TAG_ALL)||[]).length;return we.title.hasOwnProperty("standoff")?Ne?Me*(U+Ne*X):Me*U:Ne?Me*(Ne+1)*X:Me}function Vt(we,Me){var Ne=we._fullLayout,Xe=Me._id,Ke=Xe.charAt(0),rt=Me.title.font.size,Je;if(Me.title.hasOwnProperty("standoff"))Je=Me._depth+Me.title.standoff+wt(Me);else{var vt=gr(Me);if(Me.type==="multicategory")Je=Me._depth;else{var bt=1.5*rt;vt&&(bt=.5*rt,Me.ticks==="outside"&&(bt+=Me.ticklen)),Je=10+bt+(Me.linewidth?Me.linewidth-1:0)}vt||(Ke==="x"?Je+=Me.side==="top"?rt*(Me.showticklabels?1:0):rt*(Me.showticklabels?1.5:.5):Je+=Me.side==="right"?rt*(Me.showticklabels?1:.5):rt*(Me.showticklabels?.5:0))}var Et=q.getPxPosition(we,Me),Wt,Ot,ir;Ke==="x"?(Ot=Me._offset+Me._length/2,ir=Me.side==="top"?Et-Je:Et+Je):(ir=Me._offset+Me._length/2,Ot=Me.side==="right"?Et+Je:Et-Je,Wt={rotate:"-90",offset:0});var vr;if(Me.type!=="multicategory"){var _r=Me._selections[Me._id+"tick"];if(vr={selection:_r,side:Me.side},_r&&_r.node()&&_r.node().parentNode){var ln=i.getTranslate(_r.node().parentNode);vr.offsetLeft=ln.x,vr.offsetTop=ln.y}Me.title.hasOwnProperty("standoff")&&(vr.pad=0)}return a.draw(we,Xe+"title",{propContainer:Me,propName:Me._name+".title.text",placeholder:Ne._dfltTitle[Ke],avoid:vr,transform:Wt,attributes:{x:Ot,y:ir,"text-anchor":"middle"}})}q.shouldShowZeroLine=function(we,Me,Ne){var Xe=e.simpleMap(Me.range,Me.r2l);return Xe[0]*Xe[1]<=0&&Me.zeroline&&(Me.type==="linear"||Me.type==="-")&&!(Me.rangebreaks&&Me.maskBreaks(0)===R)&&(qt(Me,0)||!zt(we,Me,Ne,Xe)||Ht(we,Me))},q.clipEnds=function(we,Me){return Me.filter(function(Ne){return qt(we,Ne.x)})};function qt(we,Me){var Ne=we.l2p(Me);return Ne>1&&Ne<we._length-1}function zt(we,Me,Ne,Xe){var Ke=Ne._mainAxis;if(!Ke)return;var rt=we._fullLayout,Je=Me._id.charAt(0),vt=q.counterLetter(Me._id),bt=Me._offset+(Math.abs(Xe[0])<Math.abs(Xe[1])==(Je==="x")?0:Me._length);function Et(_r){if(!_r.showline||!_r.linewidth)return!1;var ln=Math.max((_r.linewidth+Me.zerolinewidth)/2,1);function Cr(yr){return typeof yr=="number"&&Math.abs(yr-bt)<ln}if(Cr(_r._mainLinePosition)||Cr(_r._mainMirrorPosition))return!0;var Gr=_r._linepositions||{};for(var sn in Gr)if(Cr(Gr[sn][0])||Cr(Gr[sn][1]))return!0}var Wt=rt._plots[Ne._mainSubplot];if(!(Wt.mainplotinfo||Wt).overlays.length)return Et(Ne,bt);for(var Ot=q.list(we,vt),ir=0;ir<Ot.length;ir++){var vr=Ot[ir];if(vr._mainAxis===Ke&&Et(vr,bt))return!0}}function Ht(we,Me){for(var Ne=we._fullData,Xe=Me._mainSubplot,Ke=Me._id.charAt(0),rt=0;rt<Ne.length;rt++){var Je=Ne[rt];if(Je.visible===!0&&Je.xaxis+Je.yaxis===Xe&&(E.traceIs(Je,"bar-like")&&Je.orientation==={x:"h",y:"v"}[Ke]||Je.fill&&Je.fill.charAt(Je.fill.length-1)===Ke))return!0}return!1}function $t(we){var Me=b.select(we),Ne=Me.select(".text-math-group");return Ne.empty()?Me.select("text"):Ne}q.allowAutoMargin=function(we){for(var Me=q.list(we,"",!0),Ne=0;Ne<Me.length;Ne++){var Xe=Me[Ne];Xe.automargin&&(P.allowAutoMargin(we,Qt(Xe)),Xe.mirror&&P.allowAutoMargin(we,fr(Xe))),E.getComponentMethod("rangeslider","isVisible")(Xe)&&P.allowAutoMargin(we,jr(Xe))}};function Qt(we){return we._id+".automargin"}function fr(we){return Qt(we)+".mirror"}function jr(we){return we._id+".rangeslider"}q.swap=function(we,Me){for(var Ne=cn(we,Me),Xe=0;Xe<Ne.length;Xe++)lt(we,Ne[Xe].x,Ne[Xe].y)};function cn(we,Me){var Ne=[],Xe,Ke;for(Xe=0;Xe<Me.length;Xe++){var rt=[],Je=we._fullData[Me[Xe]].xaxis,vt=we._fullData[Me[Xe]].yaxis;if(!(!Je||!vt)){for(Ke=0;Ke<Ne.length;Ke++)(Ne[Ke].x.indexOf(Je)!==-1||Ne[Ke].y.indexOf(vt)!==-1)&&rt.push(Ke);if(!rt.length){Ne.push({x:[Je],y:[vt]});continue}var bt=Ne[rt[0]],Et;if(rt.length>1)for(Ke=1;Ke<rt.length;Ke++)Et=Ne[rt[Ke]],Qr(bt.x,Et.x),Qr(bt.y,Et.y);Qr(bt.x,[Je]),Qr(bt.y,[vt])}}return Ne}function Qr(we,Me){for(var Ne=0;Ne<Me.length;Ne++)we.indexOf(Me[Ne])===-1&&we.push(Me[Ne])}function lt(we,Me,Ne){var Xe=[],Ke=[],rt=we.layout,Je,vt;for(Je=0;Je<Me.length;Je++)Xe.push(q.getFromId(we,Me[Je]));for(Je=0;Je<Ne.length;Je++)Ke.push(q.getFromId(we,Ne[Je]));var bt=Object.keys(n),Et=["anchor","domain","overlaying","position","side","tickangle","editType"],Wt=["linear","log"];for(Je=0;Je<bt.length;Je++){var Ot=bt[Je],ir=Xe[0][Ot],vr=Ke[0][Ot],_r=!0,ln=!1,Cr=!1;if(!(Ot.charAt(0)==="_"||typeof ir=="function"||Et.indexOf(Ot)!==-1)){for(vt=1;vt<Xe.length&&_r;vt++){var Gr=Xe[vt][Ot];Ot==="type"&&Wt.indexOf(ir)!==-1&&Wt.indexOf(Gr)!==-1&&ir!==Gr?ln=!0:Gr!==ir&&(_r=!1)}for(vt=1;vt<Ke.length&&_r;vt++){var sn=Ke[vt][Ot];Ot==="type"&&Wt.indexOf(vr)!==-1&&Wt.indexOf(sn)!==-1&&vr!==sn?Cr=!0:Ke[vt][Ot]!==vr&&(_r=!1)}_r&&(ln&&(rt[Xe[0]._name].type="linear"),Cr&&(rt[Ke[0]._name].type="linear"),Gt(rt,Ot,Xe,Ke,we._fullLayout._dfltTitle))}}for(Je=0;Je<we._fullLayout.annotations.length;Je++){var yr=we._fullLayout.annotations[Je];Me.indexOf(yr.xref)!==-1&&Ne.indexOf(yr.yref)!==-1&&e.swapAttrs(rt.annotations[Je],["?"])}}function Gt(we,Me,Ne,Xe,Ke){var rt=e.nestedProperty,Je=rt(we[Ne[0]._name],Me).get(),vt=rt(we[Xe[0]._name],Me).get(),bt;for(Me==="title"&&(Je&&Je.text===Ke.x&&(Je.text=Ke.y),vt&&vt.text===Ke.y&&(vt.text=Ke.x)),bt=0;bt<Ne.length;bt++)rt(we,Ne[bt]._name+"."+Me).set(vt);for(bt=0;bt<Xe.length;bt++)rt(we,Xe[bt]._name+"."+Me).set(Je)}function Kt(we){return we._id==="angularaxis"}function Nt(we,Me){for(var Ne=Me._rangebreaks.length,Xe=0;Xe<Ne;Xe++){var Ke=Me._rangebreaks[Xe];if(we>=Ke.min&&we<Ke.max)return Ke.max}return we}function gr(we){return(we.ticklabelposition||"").indexOf("inside")!==-1}function tt(we,Me){gr(we._anchorAxis||{})&&we._hideCounterAxisInsideTickLabels&&we._hideCounterAxisInsideTickLabels(Me)}},{"../../components/color":366,"../../components/drawing":388,"../../components/titles":464,"../../constants/alignment":471,"../../constants/numerical":479,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../../registry":638,"./autorange":553,"./axis_autotype":555,"./axis_ids":558,"./clean_ticks":560,"./layout_attributes":569,"./set_convert":576,"@plotly/d3":58,"fast-isnumeric":190}],555:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../../constants/numerical").BADNUM,E=k.isArrayOrTypedArray,e=k.isDateTime,p=k.cleanNumber,g=Math.round;ae.exports=function(m,x,M){var v=m,_=M.noMultiCategory;if(E(v)&&!v.length)return"-";if(!_&&d(v))return"multicategory";if(_&&Array.isArray(v[0])){for(var l=[],y=0;y<v.length;y++)if(E(v[y]))for(var T=0;T<v[y].length;T++)l.push(v[y][T]);v=l}if(i(v,x))return"date";var w=M.autotypenumbers!=="strict";return r(v,w)?"category":t(v,w)?"linear":"-"};function a(s,m){return m?b(s):typeof s=="number"}function t(s,m){for(var x=s.length,M=0;M<x;M++)if(a(s[M],m))return!0;return!1}function i(s,m){for(var x=s.length,M=n(x),v=0,_=0,l={},y=0;y<x;y+=M){var T=g(y),w=s[T],A=String(w);l[A]||(l[A]=1,e(w,m)&&v++,b(w)&&_++)}return v>_*2}function n(s){return Math.max(1,(s-1)/1e3)}function r(s,m){for(var x=s.length,M=n(x),v=0,_=0,l={},y=0;y<x;y+=M){var T=g(y),w=s[T],A=String(w);if(!l[A]){l[A]=1;var f=typeof w;f==="boolean"?_++:(m?p(w)!==P:f==="number")?v++:f==="string"&&_++}}return _>v*2}function d(s){return E(s[0])&&E(s[1])}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],556:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../registry"),P=c("../../lib"),E=c("../array_container_defaults"),e=c("./layout_attributes"),p=c("./tick_value_defaults"),g=c("./tick_mark_defaults"),a=c("./tick_label_defaults"),t=c("./prefix_suffix_defaults"),i=c("./category_order_defaults"),n=c("./line_grid_defaults"),r=c("./set_convert"),d=c("./constants").WEEKDAY_PATTERN,s=c("./constants").HOUR_PATTERN;ae.exports=function(_,l,y,T,w){var A=T.letter,f=T.font||{},u=T.splomStash||{},h=y("visible",!T.visibleDflt),o=l._template||{},S=l.type||o.type||"-",R;if(S==="date"){var z=k.getComponentMethod("calendars","handleDefaults");z(_,l,"calendar",T.calendar),T.noTicklabelmode||(R=y("ticklabelmode"))}var O="";(!T.noTicklabelposition||S==="multicategory")&&(O=P.coerce(_,l,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:R==="period"?["outside","inside"]:A==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),T.noTicklabeloverflow||y("ticklabeloverflow",O.indexOf("inside")!==-1?"hide past domain":S==="category"||S==="multicategory"?"allow":"hide past div"),r(l,w);var I=!l.isValidRange(_.range);I&&T.reverseDflt&&(I="reversed");var F=y("autorange",I);F&&(S==="linear"||S==="-")&&y("rangemode"),y("range"),l.cleanRange(),i(_,l,y,T),S!=="category"&&!T.noHover&&y("hoverformat");var D=y("color"),B=D!==e.color.dflt?D:f.color,U=u.label||w._dfltTitle[A];if(t(_,l,y,S,T),!h)return l;y("title.text",U),P.coerceFont(y,"title.font",{family:f.family,size:P.bigFont(f.size),color:B}),p(_,l,y,S),a(_,l,y,S,T),g(_,l,y,T),n(_,l,y,{dfltColor:D,bgColor:T.bgColor,showGrid:T.showGrid,attributes:e}),(l.showline||l.ticks)&&y("mirror"),T.automargin&&y("automargin");var X=S==="multicategory";if(!T.noTickson&&(S==="category"||X)&&(l.ticks||l.showgrid)){var oe;X&&(oe="boundaries");var se=y("tickson",oe);se==="boundaries"&&delete l.ticklabelposition}if(X){var q=y("showdividers");q&&(y("dividercolor"),y("dividerwidth"))}if(S==="date")if(E(_,l,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:m}),!l.rangebreaks.length)delete l.rangebreaks;else{for(var K=0;K<l.rangebreaks.length;K++)if(l.rangebreaks[K].pattern===d){l._hasDayOfWeekBreaks=!0;break}if(r(l,w),w._has("scattergl")||w._has("splom"))for(var G=0;G<T.data.length;G++){var Q=T.data[G];(Q.type==="scattergl"||Q.type==="splom")&&(Q.visible=!1,P.warn(Q.type+" traces do not work on axes with rangebreaks. Setting trace "+Q.index+" to `visible: false`."))}}return l};function m(v,_,l){function y(R,z){return P.coerce(v,_,e.rangebreaks,R,z)}var T=y("enabled");if(T){var w=y("bounds");if(w&&w.length>=2){var A="",f,u;if(w.length===2){for(f=0;f<2;f++)if(u=M(w[f]),u){A=d;break}}var h=y("pattern",A);if(h===d)for(f=0;f<2;f++)u=M(w[f]),u&&(_.bounds[f]=w[f]=u-1);if(h)for(f=0;f<2;f++)switch(u=w[f],h){case d:if(!b(u)){_.enabled=!1;return}if(u=+u,u!==Math.floor(u)||u<0||u>=7){_.enabled=!1;return}_.bounds[f]=w[f]=u;break;case s:if(!b(u)){_.enabled=!1;return}if(u=+u,u<0||u>24){_.enabled=!1;return}_.bounds[f]=w[f]=u;break}if(l.autorange===!1){var o=l.range;if(o[0]<o[1]){if(w[0]<o[0]&&w[1]>o[1]){_.enabled=!1;return}}else if(w[0]>o[0]&&w[1]<o[1]){_.enabled=!1;return}}}else{var S=y("values");if(S&&S.length)y("dvalue");else{_.enabled=!1;return}}}}var x={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function M(v){if(typeof v=="string")return x[v.substr(0,3).toLowerCase()]}},{"../../lib":503,"../../registry":638,"../array_container_defaults":549,"./category_order_defaults":559,"./constants":561,"./layout_attributes":569,"./line_grid_defaults":571,"./prefix_suffix_defaults":573,"./set_convert":576,"./tick_label_defaults":578,"./tick_mark_defaults":579,"./tick_value_defaults":580,"fast-isnumeric":190}],557:[function(c,ae,ie){"use strict";var b=c("../../constants/docs"),k=b.FORMAT_LINK,P=b.DATE_FORMAT_LINK;function E(g,a){return{valType:"string",dflt:"",editType:"none",description:(a?e:p)("hover text",g)+["By default the values are formatted using "+(a?"generic number format":"`"+g+"axis.hoverformat`")+"."].join(" ")}}function e(g,a){return["Sets the "+g+" formatting rule"+(a?"for `"+a+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+k+"."].join(" ")}function p(g,a){return e(g,a)+[" And for dates see: "+P+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}ae.exports={axisHoverFormat:E,descriptionOnlyNumbers:e,descriptionWithDates:p}},{"../../constants/docs":474}],558:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("./constants");ie.id2name=function(e){if(!(typeof e!="string"||!e.match(k.AX_ID_PATTERN))){var p=e.split(" ")[0].substr(1);return p==="1"&&(p=""),e.charAt(0)+"axis"+p}},ie.name2id=function(e){if(!!e.match(k.AX_NAME_PATTERN)){var p=e.substr(5);return p==="1"&&(p=""),e.charAt(0)+p}},ie.cleanId=function(e,p,g){var a=/( domain)$/.test(e);if(!(typeof e!="string"||!e.match(k.AX_ID_PATTERN))&&!(p&&e.charAt(0)!==p)&&!(a&&!g)){var t=e.split(" ")[0].substr(1).replace(/^0+/,"");return t==="1"&&(t=""),e.charAt(0)+t+(a&&g?" domain":"")}},ie.list=function(E,e,p){var g=E._fullLayout;if(!g)return[];var a=ie.listIds(E,e),t=new Array(a.length),i;for(i=0;i<a.length;i++){var n=a[i];t[i]=g[n.charAt(0)+"axis"+n.substr(1)]}if(!p){var r=g._subplots.gl3d||[];for(i=0;i<r.length;i++){var d=g[r[i]];e?t.push(d[e+"axis"]):t.push(d.xaxis,d.yaxis,d.zaxis)}}return t},ie.listIds=function(E,e){var p=E._fullLayout;if(!p)return[];var g=p._subplots;return e?g[e+"axis"]:g.xaxis.concat(g.yaxis)},ie.getFromId=function(E,e,p){var g=E._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),p==="x"?e=e.replace(/y[0-9]*/,""):p==="y"&&(e=e.replace(/x[0-9]*/,"")),g[ie.id2name(e)]},ie.getFromTrace=function(E,e,p){var g=E._fullLayout,a=null;if(b.traceIs(e,"gl3d")){var t=e.scene;t.substr(0,5)==="scene"&&(a=g[t][p+"axis"])}else a=ie.getFromId(E,e[p+"axis"]||p);return a},ie.idSort=function(E,e){var p=E.charAt(0),g=e.charAt(0);return p!==g?p>g?1:-1:+(E.substr(1)||1)-+(e.substr(1)||1)},ie.ref2id=function(E){return/^[xyz]/.test(E)?E.split(" ")[0]:!1};function P(E,e){if(e&&e.length){for(var p=0;p<e.length;p++)if(e[p][E])return!0}return!1}ie.isLinked=function(E,e){return P(e,E._axisMatchGroups)||P(e,E._axisConstraintGroups)}},{"../../registry":638,"./constants":561}],559:[function(c,ae,ie){"use strict";function b(k,P){var E=P.dataAttr||k._id.charAt(0),e={},p,g,a;if(P.axData)p=P.axData;else for(p=[],g=0;g<P.data.length;g++){var t=P.data[g];t[E+"axis"]===k._id&&p.push(t)}for(g=0;g<p.length;g++){var i=p[g][E];for(a=0;a<i.length;a++){var n=i[a];n!=null&&(e[n]=1)}}return Object.keys(e)}ae.exports=function(P,E,e,p){if(E.type==="category"){var g=P.categoryarray,a=Array.isArray(g)&&g.length>0,t;a&&(t="array");var i=e("categoryorder",t),n;i==="array"&&(n=e("categoryarray")),!a&&i==="array"&&(i=E.categoryorder="trace"),i==="trace"?E._initialCategories=[]:i==="array"?E._initialCategories=n.slice():(n=b(E,p).sort(),i==="category ascending"?E._initialCategories=n:i==="category descending"&&(E._initialCategories=n.reverse()))}}},{}],560:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../../constants/numerical"),E=P.ONEDAY,e=P.ONEWEEK;ie.dtick=function(p,g){var a=g==="log",t=g==="date",i=g==="category",n=t?E:1;if(!p)return n;if(b(p))return p=Number(p),p<=0?n:i?Math.max(1,Math.round(p)):t?Math.max(.1,p):p;if(typeof p!="string"||!(t||a))return n;var r=p.charAt(0),d=p.substr(1);return d=b(d)?Number(d):0,d<=0||!(t&&r==="M"&&d===Math.round(d)||a&&r==="L"||a&&r==="D"&&(d===1||d===2))?n:p},ie.tick0=function(p,g,a,t){if(g==="date")return k.cleanDate(p,k.dateTick0(a,t%e===0?1:0));if(!(t==="D1"||t==="D2"))return b(p)?Number(p):0}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],561:[function(c,ae,ie){"use strict";var b=c("../../lib/regex").counter;ae.exports={idRegex:{x:b("x","( domain)?"),y:b("y","( domain)?")},attrRegex:b("[xy]axis"),xAxisMatch:b("xaxis"),yAxisMatch:b("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":520}],562:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./autorange"),P=c("./axis_ids").id2name,E=c("./layout_attributes"),e=c("./scale_zoom"),p=c("./set_convert"),g=c("../../constants/numerical").ALMOST_EQUAL,a=c("../../constants/alignment").FROM_BL;ie.handleDefaults=function(x,M,v){var _=v.axIds,l=v.axHasImage,y=M._axisConstraintGroups=[],T=M._axisMatchGroups=[],w,A,f,u,h,o,S,R;for(w=0;w<_.length;w++)u=P(_[w]),h=x[u],o=M[u],t(h,o,{axIds:_,layoutOut:M,hasImage:l[u]});function z(se,q){for(w=0;w<se.length;w++){A=se[w];for(f in A)M[P(f)][q]=A}}for(z(T,"_matchGroup"),w=0;w<y.length;w++){A=y[w];for(f in A)if(o=M[P(f)],o.fixedrange){for(var O in A){var I=P(O);(x[I]||{}).fixedrange===!1&&b.warn("fixedrange was specified as false for axis "+I+" but was overridden because another axis in its constraint group has fixedrange true"),M[I].fixedrange=!0}break}}for(w=0;w<y.length;){A=y[w];for(f in A){o=M[P(f)],o._matchGroup&&Object.keys(o._matchGroup).length===Object.keys(A).length&&(y.splice(w,1),w--);break}w++}z(y,"_constraintGroup");var F=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],D=!1,B=!1;function U(){R=o[S],S==="rangebreaks"&&(B=o._hasDayOfWeekBreaks)}for(w=0;w<T.length;w++){A=T[w];for(var X=0;X<F.length;X++){S=F[X],R=null;var oe;for(f in A)if(u=P(f),h=x[u],o=M[u],S in o){if(!o.matches&&(oe=o,S in h)){U();break}R===null&&S in h&&U()}if(S==="range"&&R&&(D=!0),S==="autorange"&&R===null&&D&&(R=!1),R===null&&S in oe&&(R=oe[S]),R!==null)for(f in A)o=M[P(f)],o[S]=S==="range"?R.slice():R,S==="rangebreaks"&&(o._hasDayOfWeekBreaks=B,p(o,M))}}};function t(x,M,v){var _=v.axIds,l=v.layoutOut,y=v.hasImage,T=l._axisConstraintGroups,w=l._axisMatchGroups,A=M._id,f=A.charAt(0),u=((l._splomAxes||{})[f]||{})[A]||{},h=M._id,o=h.charAt(0)==="x";M._matchGroup=null,M._constraintGroup=null;function S(Q,V){return b.coerce(x,M,E,Q,V)}S("constrain",y?"domain":"range"),b.coerce(x,M,{constraintoward:{valType:"enumerated",values:o?["left","center","right"]:["bottom","middle","top"],dflt:o?"center":"middle"}},"constraintoward");var R=M.type,z,O,I=[];for(z=0;z<_.length;z++)if(O=_[z],O!==h){var F=l[P(O)];F.type===R&&I.push(O)}var D=n(T,h);if(D){var B=[];for(z=0;z<I.length;z++)O=I[z],D[O]||B.push(O);I=B}var U=I.length,X,oe;U&&(x.matches||u.matches)&&(X=b.coerce(x,M,{matches:{valType:"enumerated",values:I,dflt:I.indexOf(u.matches)!==-1?u.matches:void 0}},"matches"));var se=y&&!o?M.anchor:void 0;if(U&&!X&&(x.scaleanchor||se)&&(oe=b.coerce(x,M,{scaleanchor:{valType:"enumerated",values:I}},"scaleanchor",se)),X){M._matchGroup=r(w,h,X,1);var q=l[P(X)],K=i(l,M)/i(l,q);o!==(X.charAt(0)==="x")&&(K=(o?"x":"y")+K),r(T,h,X,K)}else x.matches&&_.indexOf(x.matches)!==-1&&b.warn("ignored "+M._name+'.matches: "'+x.matches+'" to avoid an infinite loop');if(oe){var G=S("scaleratio");G||(G=M.scaleratio=1),r(T,h,oe,G)}else x.scaleanchor&&_.indexOf(x.scaleanchor)!==-1&&b.warn("ignored "+M._name+'.scaleanchor: "'+x.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function i(x,M){var v=M.domain;return v||(v=x[P(M.overlaying)].domain),v[1]-v[0]}function n(x,M){for(var v=0;v<x.length;v++)if(x[v][M])return x[v];return null}function r(x,M,v,_){var l,y,T,w,A,f=n(x,M);f===null?(f={},f[M]=1,A=x.length,x.push(f)):A=x.indexOf(f);var u=Object.keys(f);for(l=0;l<x.length;l++)if(T=x[l],l!==A&&T[v]){var h=T[v];for(y=0;y<u.length;y++)w=u[y],T[w]=d(h,d(_,f[w]));x.splice(A,1);return}if(_!==1)for(y=0;y<u.length;y++){var o=u[y];f[o]=d(_,f[o])}f[v]=1}function d(x,M){var v="",_="",l,y;typeof x=="string"&&(v=x.match(/^[xy]*/)[0],l=v.length,x=+x.substr(l)),typeof M=="string"&&(_=M.match(/^[xy]*/)[0],y=_.length,M=+M.substr(y));var T=x*M;return!l&&!y?T:!l||!y||v.charAt(0)===_.charAt(0)?v+_+x*M:l===y?T:(l>y?v.substr(y):_.substr(l))+T}function s(x,M){for(var v=M._size,_=v.h/v.w,l={},y=Object.keys(x),T=0;T<y.length;T++){var w=y[T],A=x[w];if(typeof A=="string"){var f=A.match(/^[xy]*/)[0],u=f.length;A=+A.substr(u);for(var h=f.charAt(0)==="y"?_:1/_,o=0;o<u;o++)A*=h}l[w]=A}return l}ie.enforce=function(M){var v=M._fullLayout,_=v._axisConstraintGroups||[],l,y,T,w,A,f,u,h;for(l=0;l<_.length;l++){T=s(_[l],v);var o=Object.keys(T),S=1/0,R=0,z=1/0,O={},I={},F=!1;for(y=0;y<o.length;y++)w=o[y],I[w]=A=v[P(w)],A._inputDomain?A.domain=A._inputDomain.slice():A._inputDomain=A.domain.slice(),A._inputRange||(A._inputRange=A.range.slice()),A.setScale(),O[w]=f=Math.abs(A._m)/T[w],S=Math.min(S,f),(A.constrain==="domain"||!A._constraintShrinkable)&&(z=Math.min(z,f)),delete A._constraintShrinkable,R=Math.max(R,f),A.constrain==="domain"&&(F=!0);if(!(S>g*R&&!F)){for(y=0;y<o.length;y++)if(w=o[y],f=O[w],A=I[w],u=A.constrain,f!==z||u==="domain")if(h=f/z,u==="range")e(A,h);else{var D=A._inputDomain,B=(A.domain[1]-A.domain[0])/(D[1]-D[0]),U=(A.r2l(A.range[1])-A.r2l(A.range[0]))/(A.r2l(A._inputRange[1])-A.r2l(A._inputRange[0]));if(h/=B,h*U<1){A.domain=A._input.domain=D.slice(),e(A,h);continue}if(U<1&&(A.range=A._input.range=A._inputRange.slice(),h*=U),A.autorange){var X=A.r2l(A.range[0]),oe=A.r2l(A.range[1]),se=(X+oe)/2,q=se,K=se,G=Math.abs(oe-se),Q=se-G*h*1.0001,V=se+G*h*1.0001,H=k.makePadFn(v,A,0),ee=k.makePadFn(v,A,1);m(A,h);var J=Math.abs(A._m),W=k.concatExtremes(M,A),re=W.min,j=W.max,Z,ne;for(ne=0;ne<re.length;ne++)Z=re[ne].val-H(re[ne])/J,Z>Q&&Z<q&&(q=Z);for(ne=0;ne<j.length;ne++)Z=j[ne].val+ee(j[ne])/J,Z<V&&Z>K&&(K=Z);var le=(K-q)/(2*G);h/=le,q=A.l2r(q),K=A.l2r(K),A.range=A._input.range=X<oe?[q,K]:[K,q]}m(A,h)}}}},ie.getAxisGroup=function(M,v){for(var _=M._axisMatchGroups,l=0;l<_.length;l++){var y=_[l];if(y[v])return"g"+l}return v},ie.clean=function(M,v){if(v._inputDomain){for(var _=!1,l=v._id,y=M._fullLayout._axisConstraintGroups,T=0;T<y.length;T++)if(y[T][l]){_=!0;break}(!_||v.constrain!=="domain")&&(v._input.domain=v.domain=v._inputDomain,delete v._inputDomain)}};function m(x,M){var v=x._inputDomain,_=a[x.constraintoward],l=v[0]+(v[1]-v[0])*_;x.domain=x._input.domain=[l+(v[0]-l)/M,l+(v[1]-l)/M],x.setScale()}},{"../../constants/alignment":471,"../../constants/numerical":479,"../../lib":503,"./autorange":553,"./axis_ids":558,"./layout_attributes":569,"./scale_zoom":574,"./set_convert":576}],563:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=k.numberFormat,E=c("tinycolor2"),e=c("has-passive-events"),p=c("../../registry"),g=k.strTranslate,a=c("../../lib/svg_text_utils"),t=c("../../components/color"),i=c("../../components/drawing"),n=c("../../components/fx"),r=c("./axes"),d=c("../../lib/setcursor"),s=c("../../components/dragelement"),m=c("../../components/dragelement/helpers"),x=m.selectingOrDrawing,M=m.freeMode,v=c("../../constants/alignment").FROM_TL,_=c("../../lib/clear_gl_canvases"),l=c("../../plot_api/subroutines").redrawReglTraces,y=c("../plots"),T=c("./axis_ids").getFromId,w=c("./select").prepSelect,A=c("./select").clearSelect,f=c("./select").selectOnClick,u=c("./scale_zoom"),h=c("./constants"),o=h.MINDRAG,S=h.MINZOOM,R=!0;function z(Z,ne,le,ge,pe,xe,Ee,Te){var de=Z._fullLayout._zoomlayer,be=Ee+Te==="nsew",Le=(Ee+Te).length===1,De,ye,ke,Oe,Qe,Ve,Ue,Ie,at,pt,Rt,Mt,It,Bt,St,_t,it,ct,et,Pe,We,je,nt;function kt(){if(De=ne.xaxis,ye=ne.yaxis,at=De._length,pt=ye._length,Ue=De._offset,Ie=ye._offset,ke={},ke[De._id]=De,Oe={},Oe[ye._id]=ye,Ee&&Te)for(var Cr=ne.overlays,Gr=0;Gr<Cr.length;Gr++){var sn=Cr[Gr].xaxis;ke[sn._id]=sn;var yr=Cr[Gr].yaxis;Oe[yr._id]=yr}Qe=j(ke),Ve=j(Oe),It=F(Qe,Te),Bt=F(Ve,Ee),St=!Bt&&!It,Mt=W(Z,Z._fullLayout._axisMatchGroups,ke,Oe),Rt=W(Z,Z._fullLayout._axisConstraintGroups,ke,Oe,Mt);var mr=Rt.isSubplotConstrained||Mt.isSubplotConstrained;_t=Te||mr,it=Ee||mr;var Or=Z._fullLayout;ct=Or._has("scattergl"),et=Or._has("splom"),Pe=Or._has("svg")}kt();var wt=oe(Bt+It,Z._fullLayout.dragmode,be),Vt=I(ne,Ee+Te+"drag",wt,le,ge,pe,xe);if(St&&!be)return Vt.onmousedown=null,Vt.style.pointerEvents="none",Vt;var qt={element:Vt,gd:Z,plotinfo:ne};qt.prepFn=function(Cr,Gr,sn){var yr=qt.dragmode,mr=Z._fullLayout.dragmode;mr!==yr&&(qt.dragmode=mr),kt(),je=Z._fullLayout._invScaleX,nt=Z._fullLayout._invScaleY,St||(be?Cr.shiftKey?mr==="pan"?mr="zoom":x(mr)||(mr="pan"):Cr.ctrlKey&&(mr="pan"):mr="pan"),M(mr)?qt.minDrag=1:qt.minDrag=void 0,x(mr)?(qt.xaxes=Qe,qt.yaxes=Ve,w(Cr,Gr,sn,qt,mr)):(qt.clickFn=Ht,x(yr)&&zt(),St||(mr==="zoom"?(qt.moveFn=tt,qt.doneFn=Me,qt.minDrag=1,gr(Cr,Gr,sn)):mr==="pan"&&(qt.moveFn=vt,qt.doneFn=Ot))),Z._fullLayout._redrag=function(){var Or=Z._dragdata;if(Or&&Or.element===Vt){var zr=Z._fullLayout.dragmode;x(zr)||(kt(),ir([0,0,at,pt]),qt.moveFn(Or.dx,Or.dy))}}};function zt(){qt.plotinfo.selection=!1,A(Z)}function Ht(Cr,Gr){var sn=qt.gd;if(sn._fullLayout._activeShapeIndex>=0){sn._fullLayout._deactivateShape(sn);return}var yr=sn._fullLayout.clickmode;if(Q(sn),Cr===2&&!Le&&Wt(),be)yr.indexOf("select")>-1&&f(Gr,sn,Qe,Ve,ne.id,qt),yr.indexOf("event")>-1&&n.click(sn,Gr,ne.id);else if(Cr===1&&Le){var mr=Ee?ye:De,Or=Ee==="s"||Te==="w"?0:1,zr=mr._name+".range["+Or+"]",Sr=D(mr,Or),ot="left",Lt="middle";if(mr.fixedrange)return;Ee?(Lt=Ee==="n"?"top":"bottom",mr.side==="right"&&(ot="right")):Te==="e"&&(ot="right"),sn._context.showAxisRangeEntryBoxes&&b.select(Vt).call(a.makeEditable,{gd:sn,immediate:!0,background:sn._fullLayout.paper_bgcolor,text:String(Sr),fill:mr.tickfont?mr.tickfont.color:"#444",horizontalAlign:ot,verticalAlign:Lt}).on("edit",function(Xt){var tr=mr.d2r(Xt);tr!==void 0&&p.call("_guiRelayout",sn,zr,tr)})}}s.init(qt);var $t,Qt,fr,jr,cn,Qr,lt,Gt,Kt,Nt;function gr(Cr,Gr,sn){var yr=Vt.getBoundingClientRect();$t=Gr-yr.left,Qt=sn-yr.top,Z._fullLayout._calcInverseTransform(Z);var mr=k.apply3DTransform(Z._fullLayout._invTransform)($t,Qt);$t=mr[0],Qt=mr[1],fr={l:$t,r:$t,w:0,t:Qt,b:Qt,h:0},jr=Z._hmpixcount?Z._hmlumcount/Z._hmpixcount:E(Z._fullLayout.plot_bgcolor).getLuminance(),cn="M0,0H"+at+"V"+pt+"H0V0",Qr=!1,lt="xy",Nt=!1,Gt=se(de,jr,Ue,Ie,cn),Kt=q(de,Ue,Ie)}function tt(Cr,Gr){if(Z._transitioningWithDuration)return!1;var sn=Math.max(0,Math.min(at,je*Cr+$t)),yr=Math.max(0,Math.min(pt,nt*Gr+Qt)),mr=Math.abs(sn-$t),Or=Math.abs(yr-Qt);fr.l=Math.min($t,sn),fr.r=Math.max($t,sn),fr.t=Math.min(Qt,yr),fr.b=Math.max(Qt,yr);function zr(){lt="",fr.r=fr.l,fr.t=fr.b,Kt.attr("d","M0,0Z")}if(Rt.isSubplotConstrained)mr>S||Or>S?(lt="xy",mr/at>Or/pt?(Or=mr*pt/at,Qt>yr?fr.t=Qt-Or:fr.b=Qt+Or):(mr=Or*at/pt,$t>sn?fr.l=$t-mr:fr.r=$t+mr),Kt.attr("d",J(fr))):zr();else if(Mt.isSubplotConstrained)if(mr>S||Or>S){lt="xy";var Sr=Math.min(fr.l/at,(pt-fr.b)/pt),ot=Math.max(fr.r/at,(pt-fr.t)/pt);fr.l=Sr*at,fr.r=ot*at,fr.b=(1-Sr)*pt,fr.t=(1-ot)*pt,Kt.attr("d",J(fr))}else zr();else!Bt||Or<Math.min(Math.max(mr*.6,o),S)?mr<o||!It?zr():(fr.t=0,fr.b=pt,lt="x",Kt.attr("d",H(fr,Qt))):!It||mr<Math.min(Or*.6,S)?(fr.l=0,fr.r=at,lt="y",Kt.attr("d",ee(fr,$t))):(lt="xy",Kt.attr("d",J(fr)));fr.w=fr.r-fr.l,fr.h=fr.b-fr.t,lt&&(Nt=!0),Z._dragged=Nt,K(Gt,Kt,fr,cn,Qr,jr),we(),Z.emit("plotly_relayouting",We),Qr=!0}function we(){We={},(lt==="xy"||lt==="x")&&(B(Qe,fr.l/at,fr.r/at,We,Rt.xaxes),bt("x",We)),(lt==="xy"||lt==="y")&&(B(Ve,(pt-fr.b)/pt,(pt-fr.t)/pt,We,Rt.yaxes),bt("y",We))}function Me(){we(),Q(Z),Ot(),V(Z)}var Ne=[0,0,at,pt],Xe=null,Ke=h.REDRAWDELAY,rt=ne.mainplot?Z._fullLayout._plots[ne.mainplot]:ne;function Je(Cr){if(!Z._context._scrollZoom.cartesian&&!Z._fullLayout._enablescrollzoom)return;if(zt(),Z._transitioningWithDuration){Cr.preventDefault(),Cr.stopPropagation();return}kt(),clearTimeout(Xe);var Gr=-Cr.deltaY;if(isFinite(Gr)||(Gr=Cr.wheelDelta/10),!isFinite(Gr)){k.log("Did not find wheel motion attributes: ",Cr);return}var sn=Math.exp(-Math.min(Math.max(Gr,-20),20)/200),yr=rt.draglayer.select(".nsewdrag").node().getBoundingClientRect(),mr=(Cr.clientX-yr.left)/yr.width,Or=(yr.bottom-Cr.clientY)/yr.height,zr;function Sr(ot,Lt,Xt){if(ot.fixedrange)return;var tr=k.simpleMap(ot.range,ot.r2l),Lr=tr[0]+(tr[1]-tr[0])*Lt;function Nr(Rr){return ot.l2r(Lr+(Rr-Lr)*Xt)}ot.range=tr.map(Nr)}if(_t){for(Te||(mr=.5),zr=0;zr<Qe.length;zr++)Sr(Qe[zr],mr,sn);bt("x"),Ne[2]*=sn,Ne[0]+=Ne[2]*mr*(1/sn-1)}if(it){for(Ee||(Or=.5),zr=0;zr<Ve.length;zr++)Sr(Ve[zr],Or,sn);bt("y"),Ne[3]*=sn,Ne[1]+=Ne[3]*(1-Or)*(1/sn-1)}ir(Ne),Et(),Z.emit("plotly_relayouting",We),Xe=setTimeout(function(){!Z._fullLayout||(Ne=[0,0,at,pt],Ot())},Ke),Cr.preventDefault()}Ee.length*Te.length!==1&&re(Vt,Je);function vt(Cr,Gr){if(Cr=Cr*je,Gr=Gr*nt,Z._transitioningWithDuration)return;if(Z._fullLayout._replotting=!0,It==="ew"||Bt==="ns"){var sn=It?-Cr:0,yr=Bt?-Gr:0;if(Mt.isSubplotConstrained){if(It&&Bt){var mr=(Cr/at-Gr/pt)/2;Cr=mr*at,Gr=-mr*pt,sn=-Cr,yr=-Gr}Bt?sn=-yr*at/pt:yr=-sn*pt/at}It&&(U(Qe,Cr),bt("x")),Bt&&(U(Ve,Gr),bt("y")),ir([sn,yr,at,pt]),Et(),Z.emit("plotly_relayouting",We);return}function Or(Nr,Rr,Ar){for(var Kr=1-Rr,Dn,Sn,Jn=0;Jn<Nr.length;Jn++){var Bn=Nr[Jn];if(!Bn.fixedrange){Dn=Bn,Sn=Bn._rl[Kr]+(Bn._rl[Rr]-Bn._rl[Kr])/X(Ar/Bn._length);var Xn=Bn.l2r(Sn);Xn!==!1&&Xn!==void 0&&(Bn.range[Rr]=Xn)}}return Dn._length*(Dn._rl[Rr]-Sn)/(Dn._rl[Rr]-Dn._rl[Kr])}var zr=It==="w"==(Bt==="n")?1:-1;if(It&&Bt&&(Rt.isSubplotConstrained||Mt.isSubplotConstrained)){var Sr=(Cr/at+zr*Gr/pt)/2;Cr=Sr*at,Gr=zr*Sr*pt}var ot,Lt;if(It==="w"?Cr=Or(Qe,0,Cr):It==="e"?Cr=Or(Qe,1,-Cr):It||(Cr=0),Bt==="n"?Gr=Or(Ve,1,Gr):Bt==="s"?Gr=Or(Ve,0,-Gr):Bt||(Gr=0),ot=It==="w"?Cr:0,Lt=Bt==="n"?Gr:0,Rt.isSubplotConstrained&&!Mt.isSubplotConstrained||Mt.isSubplotConstrained&&It&&Bt&&zr>0){var Xt;if(Mt.isSubplotConstrained||!It&&Bt.length===1){for(Xt=0;Xt<Qe.length;Xt++)Qe[Xt].range=Qe[Xt]._r.slice(),u(Qe[Xt],1-Gr/pt);Cr=Gr*at/pt,ot=Cr/2}if(Mt.isSubplotConstrained||!Bt&&It.length===1){for(Xt=0;Xt<Ve.length;Xt++)Ve[Xt].range=Ve[Xt]._r.slice(),u(Ve[Xt],1-Cr/at);Gr=Cr*pt/at,Lt=Gr/2}}(!Mt.isSubplotConstrained||!Bt)&&bt("x"),(!Mt.isSubplotConstrained||!It)&&bt("y");var tr=at-Cr,Lr=pt-Gr;Mt.isSubplotConstrained&&!(It&&Bt)&&(It?(Lt=ot?0:Cr*pt/at,Lr=tr*pt/at):(ot=Lt?0:Gr*at/pt,tr=Lr*at/pt)),ir([ot,Lt,tr,Lr]),Et(),Z.emit("plotly_relayouting",We)}function bt(Cr,Gr){for(var sn=Mt.isSubplotConstrained?{x:Ve,y:Qe}[Cr]:Mt[Cr+"axes"],yr=Mt.isSubplotConstrained?{x:Qe,y:Ve}[Cr]:[],mr=0;mr<sn.length;mr++){var Or=sn[mr],zr=Or._id,Sr=Mt.xLinks[zr]||Mt.yLinks[zr],ot=yr[0]||ke[Sr]||Oe[Sr];ot&&(Gr?(Gr[Or._name+".range[0]"]=Gr[ot._name+".range[0]"],Gr[Or._name+".range[1]"]=Gr[ot._name+".range[1]"]):Or.range=ot.range.slice())}}function Et(){var Cr=[],Gr;function sn(Or){for(Gr=0;Gr<Or.length;Gr++)Or[Gr].fixedrange||Cr.push(Or[Gr]._id)}for(_t&&(sn(Qe),sn(Rt.xaxes),sn(Mt.xaxes)),it&&(sn(Ve),sn(Rt.yaxes),sn(Mt.yaxes)),We={},Gr=0;Gr<Cr.length;Gr++){var yr=Cr[Gr],mr=T(Z,yr);r.drawOne(Z,mr,{skipTitle:!0}),We[mr._name+".range[0]"]=mr.range[0],We[mr._name+".range[1]"]=mr.range[1]}r.redrawComponents(Z,Cr)}function Wt(){if(!Z._transitioningWithDuration){var Cr=Z._context.doubleClick,Gr=[];It&&(Gr=Gr.concat(Qe)),Bt&&(Gr=Gr.concat(Ve)),Mt.xaxes&&(Gr=Gr.concat(Mt.xaxes)),Mt.yaxes&&(Gr=Gr.concat(Mt.yaxes));var sn={},yr,mr,Or;if(Cr==="reset+autosize"){for(Cr="autosize",mr=0;mr<Gr.length;mr++)if(yr=Gr[mr],yr._rangeInitial&&(yr.range[0]!==yr._rangeInitial[0]||yr.range[1]!==yr._rangeInitial[1])||!yr._rangeInitial&&!yr.autorange){Cr="reset";break}}if(Cr==="autosize")for(mr=0;mr<Gr.length;mr++)yr=Gr[mr],yr.fixedrange||(sn[yr._name+".autorange"]=!0);else if(Cr==="reset")for((It||Rt.isSubplotConstrained)&&(Gr=Gr.concat(Rt.xaxes)),Bt&&!Rt.isSubplotConstrained&&(Gr=Gr.concat(Rt.yaxes)),Rt.isSubplotConstrained&&(It?Bt||(Gr=Gr.concat(Ve)):Gr=Gr.concat(Qe)),mr=0;mr<Gr.length;mr++)yr=Gr[mr],yr.fixedrange||(yr._rangeInitial?(Or=yr._rangeInitial,sn[yr._name+".range[0]"]=Or[0],sn[yr._name+".range[1]"]=Or[1]):sn[yr._name+".autorange"]=!0);Z.emit("plotly_doubleclick",null),p.call("_guiRelayout",Z,sn)}}function Ot(){ir([0,0,at,pt]),k.syncOrAsync([y.previousPromises,function(){Z._fullLayout._replotting=!1,p.call("_guiRelayout",Z,We)}],Z)}function ir(Cr){var Gr=Z._fullLayout,sn=Gr._plots,yr=Gr._subplots.cartesian,mr,Or,zr,Sr;if(et&&p.subplotsRegistry.splom.drag(Z),ct){for(mr=0;mr<yr.length;mr++)if(Or=sn[yr[mr]],zr=Or.xaxis,Sr=Or.yaxis,Or._scene){var ot=k.simpleMap(zr.range,zr.r2l),Lt=k.simpleMap(Sr.range,Sr.r2l);Or._scene.update({range:[ot[0],Lt[0],ot[1],Lt[1]]})}}if((et||ct)&&(_(Z),l(Z)),Pe){var Xt=Cr[2]/De._length,tr=Cr[3]/ye._length;for(mr=0;mr<yr.length;mr++){Or=sn[yr[mr]],zr=Or.xaxis,Sr=Or.yaxis;var Lr=(_t||Mt.isSubplotConstrained)&&!zr.fixedrange&&ke[zr._id],Nr=(it||Mt.isSubplotConstrained)&&!Sr.fixedrange&&Oe[Sr._id],Rr,Ar,Kr,Dn;if(Lr?(Rr=Xt,Kr=Te||Mt.isSubplotConstrained?Cr[0]:ln(zr,Rr)):Mt.xaHash[zr._id]?(Rr=Xt,Kr=Cr[0]*zr._length/De._length):Mt.yaHash[zr._id]?(Rr=tr,Kr=Bt==="ns"?-Cr[1]*zr._length/ye._length:ln(zr,Rr,{n:"top",s:"bottom"}[Bt])):(Rr=vr(zr,Xt,tr),Kr=_r(zr,Rr)),Nr?(Ar=tr,Dn=Ee||Mt.isSubplotConstrained?Cr[1]:ln(Sr,Ar)):Mt.yaHash[Sr._id]?(Ar=tr,Dn=Cr[1]*Sr._length/ye._length):Mt.xaHash[Sr._id]?(Ar=Xt,Dn=It==="ew"?-Cr[0]*Sr._length/De._length:ln(Sr,Ar,{e:"right",w:"left"}[It])):(Ar=vr(Sr,Xt,tr),Dn=_r(Sr,Ar)),!(!Rr&&!Ar)){Rr||(Rr=1),Ar||(Ar=1);var Sn=zr._offset-Kr/Rr,Jn=Sr._offset-Dn/Ar;Or.clipRect.call(i.setTranslate,Kr,Dn).call(i.setScale,Rr,Ar),Or.plot.call(i.setTranslate,Sn,Jn).call(i.setScale,1/Rr,1/Ar),(Rr!==Or.xScaleFactor||Ar!==Or.yScaleFactor)&&(i.setPointGroupScale(Or.zoomScalePts,Rr,Ar),i.setTextPointsScale(Or.zoomScaleTxt,Rr,Ar)),i.hideOutsideRangePoints(Or.clipOnAxisFalseTraces,Or),Or.xScaleFactor=Rr,Or.yScaleFactor=Ar}}}}function vr(Cr,Gr,sn){return Cr.fixedrange?0:_t&&Rt.xaHash[Cr._id]?Gr:it&&(Rt.isSubplotConstrained?Rt.xaHash:Rt.yaHash)[Cr._id]?sn:0}function _r(Cr,Gr){return Gr?(Cr.range=Cr._r.slice(),u(Cr,Gr),ln(Cr,Gr)):0}function ln(Cr,Gr,sn){return Cr._length*(1-Gr)*v[sn||Cr.constraintoward||"middle"]}return Vt}function O(Z,ne,le,ge){var pe=k.ensureSingle(Z.draglayer,ne,le,function(xe){xe.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",Z.id)});return pe.call(d,ge),pe.node()}function I(Z,ne,le,ge,pe,xe,Ee){var Te=O(Z,"rect",ne,le);return b.select(Te).call(i.setRect,ge,pe,xe,Ee),Te}function F(Z,ne){for(var le=0;le<Z.length;le++)if(!Z[le].fixedrange)return ne;return""}function D(Z,ne){var le=Z.range[ne],ge=Math.abs(le-Z.range[1-ne]),pe;return Z.type==="date"?le:Z.type==="log"?(pe=Math.ceil(Math.max(0,-Math.log(ge)/Math.LN10))+3,P("."+pe+"g")(Math.pow(10,le))):(pe=Math.floor(Math.log(Math.abs(le))/Math.LN10)-Math.floor(Math.log(ge)/Math.LN10)+4,P("."+String(pe)+"g")(le))}function B(Z,ne,le,ge,pe){for(var xe=0;xe<Z.length;xe++){var Ee=Z[xe];if(!Ee.fixedrange)if(Ee.rangebreaks){var Te=Ee._id.charAt(0)==="y",de=Te?1-ne:ne,be=Te?1-le:le;ge[Ee._name+".range[0]"]=Ee.l2r(Ee.p2l(de*Ee._length)),ge[Ee._name+".range[1]"]=Ee.l2r(Ee.p2l(be*Ee._length))}else{var Le=Ee._rl[0],De=Ee._rl[1]-Le;ge[Ee._name+".range[0]"]=Ee.l2r(Le+De*ne),ge[Ee._name+".range[1]"]=Ee.l2r(Le+De*le)}}if(pe&&pe.length){var ye=(ne+(1-le))/2;B(pe,ye,1-ye,ge,[])}}function U(Z,ne){for(var le=0;le<Z.length;le++){var ge=Z[le];if(!ge.fixedrange)if(ge.rangebreaks){var pe=0,xe=ge._length,Ee=ge.p2l(pe+ne)-ge.p2l(pe),Te=ge.p2l(xe+ne)-ge.p2l(xe),de=(Ee+Te)/2;ge.range=[ge.l2r(ge._rl[0]-de),ge.l2r(ge._rl[1]-de)]}else ge.range=[ge.l2r(ge._rl[0]-ne/ge._m),ge.l2r(ge._rl[1]-ne/ge._m)]}}function X(Z){return 1-(Z>=0?Math.min(Z,.9):1/(1/Math.max(Z,-.3)+3.222))}function oe(Z,ne,le){return Z?Z==="nsew"?le?"":ne==="pan"?"move":"crosshair":Z.toLowerCase()+"-resize":"pointer"}function se(Z,ne,le,ge,pe){return Z.append("path").attr("class","zoombox").style({fill:ne>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",g(le,ge)).attr("d",pe+"Z")}function q(Z,ne,le){return Z.append("path").attr("class","zoombox-corners").style({fill:t.background,stroke:t.defaultLine,"stroke-width":1,opacity:0}).attr("transform",g(ne,le)).attr("d","M0,0Z")}function K(Z,ne,le,ge,pe,xe){Z.attr("d",ge+"M"+le.l+","+le.t+"v"+le.h+"h"+le.w+"v-"+le.h+"h-"+le.w+"Z"),G(Z,ne,pe,xe)}function G(Z,ne,le,ge){le||(Z.transition().style("fill",ge>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ne.transition().style("opacity",1).duration(200))}function Q(Z){b.select(Z).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function V(Z){R&&Z.data&&Z._context.showTips&&(k.notifier(k._(Z,"Double-click to zoom back out"),"long"),R=!1)}function H(Z,ne){return"M"+(Z.l-.5)+","+(ne-S-.5)+"h-3v"+(2*S+1)+"h3ZM"+(Z.r+.5)+","+(ne-S-.5)+"h3v"+(2*S+1)+"h-3Z"}function ee(Z,ne){return"M"+(ne-S-.5)+","+(Z.t-.5)+"v-3h"+(2*S+1)+"v3ZM"+(ne-S-.5)+","+(Z.b+.5)+"v3h"+(2*S+1)+"v-3Z"}function J(Z){var ne=Math.floor(Math.min(Z.b-Z.t,Z.r-Z.l,S)/2);return"M"+(Z.l-3.5)+","+(Z.t-.5+ne)+"h3v"+-ne+"h"+ne+"v-3h-"+(ne+3)+"ZM"+(Z.r+3.5)+","+(Z.t-.5+ne)+"h-3v"+-ne+"h"+-ne+"v-3h"+(ne+3)+"ZM"+(Z.r+3.5)+","+(Z.b+.5-ne)+"h-3v"+ne+"h"+-ne+"v3h"+(ne+3)+"ZM"+(Z.l-3.5)+","+(Z.b+.5-ne)+"h3v"+ne+"h"+ne+"v3h-"+(ne+3)+"Z"}function W(Z,ne,le,ge,pe){for(var xe=!1,Ee={},Te={},de,be,Le,De,ye=(pe||{}).xaHash,ke=(pe||{}).yaHash,Oe=0;Oe<ne.length;Oe++){var Qe=ne[Oe];for(de in le)if(Qe[de]){for(Le in Qe)!(pe&&(ye[Le]||ke[Le]))&&!(Le.charAt(0)==="x"?le:ge)[Le]&&(Ee[Le]=de);for(be in ge)!(pe&&(ye[be]||ke[be]))&&Qe[be]&&(xe=!0)}for(be in ge)if(Qe[be])for(De in Qe)!(pe&&(ye[De]||ke[De]))&&!(De.charAt(0)==="x"?le:ge)[De]&&(Te[De]=be)}xe&&(k.extendFlat(Ee,Te),Te={});var Ve={},Ue=[];for(Le in Ee){var Ie=T(Z,Le);Ue.push(Ie),Ve[Ie._id]=Ie}var at={},pt=[];for(De in Te){var Rt=T(Z,De);pt.push(Rt),at[Rt._id]=Rt}return{xaHash:Ve,yaHash:at,xaxes:Ue,yaxes:pt,xLinks:Ee,yLinks:Te,isSubplotConstrained:xe}}function re(Z,ne){if(!e)Z.onwheel!==void 0?Z.onwheel=ne:Z.onmousewheel!==void 0?Z.onmousewheel=ne:Z.isAddedWheelEvent||(Z.isAddedWheelEvent=!0,Z.addEventListener("wheel",ne,{passive:!1}));else{var le=Z.onwheel!==void 0?"wheel":"mousewheel";Z._onwheel&&Z.removeEventListener(le,Z._onwheel),Z._onwheel=ne,Z.addEventListener(le,ne,{passive:!1})}}function j(Z){var ne=[];for(var le in Z)ne.push(Z[le]);return ne}ae.exports={makeDragBox:z,makeDragger:O,makeRectDragger:I,makeZoombox:se,makeCorners:q,updateZoombox:K,xyCorners:J,transitionZoombox:G,removeZoombox:Q,showDoubleClickNotifier:V,attachWheelEventHandler:re}},{"../../components/color":366,"../../components/dragelement":385,"../../components/dragelement/helpers":384,"../../components/drawing":388,"../../components/fx":406,"../../constants/alignment":471,"../../lib":503,"../../lib/clear_gl_canvases":487,"../../lib/setcursor":524,"../../lib/svg_text_utils":529,"../../plot_api/subroutines":544,"../../registry":638,"../plots":619,"./axes":554,"./axis_ids":558,"./constants":561,"./scale_zoom":574,"./select":575,"@plotly/d3":58,"has-passive-events":229,tinycolor2:312}],564:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/fx"),P=c("../../components/dragelement"),E=c("../../lib/setcursor"),e=c("./dragbox").makeDragBox,p=c("./constants").DRAGGERSIZE;ie.initInteractions=function(a){var t=a._fullLayout;if(a._context.staticPlot){b.select(a).selectAll(".drag").remove();return}if(!(!t._has("cartesian")&&!t._has("splom"))){var i=Object.keys(t._plots||{}).sort(function(r,d){if((t._plots[r].mainplot&&!0)===(t._plots[d].mainplot&&!0)){var s=r.split("y"),m=d.split("y");return s[0]===m[0]?Number(s[1]||1)-Number(m[1]||1):Number(s[0]||1)-Number(m[0]||1)}return t._plots[r].mainplot?1:-1});i.forEach(function(r){var d=t._plots[r],s=d.xaxis,m=d.yaxis;if(!d.mainplot){var x=e(a,d,s._offset,m._offset,s._length,m._length,"ns","ew");x.onmousemove=function(_){a._fullLayout._rehover=function(){a._fullLayout._hoversubplot===r&&a._fullLayout._plots[r]&&k.hover(a,_,r)},k.hover(a,_,r),a._fullLayout._lasthover=x,a._fullLayout._hoversubplot=r},x.onmouseout=function(_){a._dragging||(a._fullLayout._hoversubplot=null,P.unhover(a,_))},a._context.showAxisDragHandles&&(e(a,d,s._offset-p,m._offset-p,p,p,"n","w"),e(a,d,s._offset+s._length,m._offset-p,p,p,"n","e"),e(a,d,s._offset-p,m._offset+m._length,p,p,"s","w"),e(a,d,s._offset+s._length,m._offset+m._length,p,p,"s","e"))}if(a._context.showAxisDragHandles){if(r===s._mainSubplot){var M=s._mainLinePosition;s.side==="top"&&(M-=p),e(a,d,s._offset+s._length*.1,M,s._length*.8,p,"","ew"),e(a,d,s._offset,M,s._length*.1,p,"","w"),e(a,d,s._offset+s._length*.9,M,s._length*.1,p,"","e")}if(r===m._mainSubplot){var v=m._mainLinePosition;m.side!=="right"&&(v-=p),e(a,d,v,m._offset+m._length*.1,p,m._length*.8,"ns",""),e(a,d,v,m._offset+m._length*.9,p,m._length*.1,"s",""),e(a,d,v,m._offset,p,m._length*.1,"n","")}}});var n=t._hoverlayer.node();n.onmousemove=function(r){r.target=a._fullLayout._lasthover,k.hover(a,r,t._hoversubplot)},n.onclick=function(r){r.target=a._fullLayout._lasthover,k.click(a,r)},n.onmousedown=function(r){a._fullLayout._lasthover.onmousedown(r)},ie.updateFx(a)}},ie.updateFx=function(g){var a=g._fullLayout,t=a.dragmode==="pan"?"move":"crosshair";E(a._draggers,t)}},{"../../components/dragelement":385,"../../components/fx":406,"../../lib/setcursor":524,"./constants":561,"./dragbox":563,"@plotly/d3":58}],565:[function(c,ae,ie){"use strict";function b(P){var E=P._fullLayout._zoomlayer;E&&E.selectAll(".outline-controllers").remove()}function k(P){var E=P._fullLayout._zoomlayer;E&&E.selectAll(".select-outline").remove(),P._fullLayout._drawing=!1}ae.exports={clearOutlineControllers:b,clearSelect:k}},{}],566:[function(c,ae,ie){"use strict";var b=c("../../lib").strTranslate;function k(p,g){switch(p.type){case"log":return p.p2d(g);case"date":return p.p2r(g,0,p.calendar);default:return p.p2r(g)}}function P(p,g){switch(p.type){case"log":return p.d2p(g);case"date":return p.r2p(g,0,p.calendar);default:return p.r2p(g)}}function E(p){var g=p._id.charAt(0)==="y"?1:0;return function(a){return k(p,a[g])}}function e(p){return b(p.xaxis._offset,p.yaxis._offset)}ae.exports={p2r:k,r2p:P,axValue:E,getTransform:e}},{"../../lib":503}],567:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("./axis_ids");ae.exports=function(e){return function(g,a){var t=g[e];if(!!Array.isArray(t))for(var i=b.subplotsRegistry.cartesian,n=i.idRegex,r=a._subplots,d=r.xaxis,s=r.yaxis,m=r.cartesian,x=a._has("cartesian")||a._has("gl2d"),M=0;M<t.length;M++){var v=t[M];if(!!k.isPlainObject(v)){var _=P.cleanId(v.xref,"x",!1),l=P.cleanId(v.yref,"y",!1),y=n.x.test(_),T=n.y.test(l);if(y||T){x||k.pushUnique(a._basePlotModules,i);var w=!1;y&&d.indexOf(_)===-1&&(d.push(_),w=!0),T&&s.indexOf(l)===-1&&(s.push(l),w=!0),w&&y&&T&&m.push(_+l)}}}}}},{"../../lib":503,"../../registry":638,"./axis_ids":558}],568:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../registry"),P=c("../../lib"),E=c("../plots"),e=c("../../components/drawing"),p=c("../get_data").getModuleCalcData,g=c("./axis_ids"),a=c("./constants"),t=c("../../constants/xmlns_namespaces"),i=P.ensureSingle;function n(M,v,_){return P.ensureSingle(M,v,_,function(l){l.datum(_)})}ie.name="cartesian",ie.attr=["xaxis","yaxis"],ie.idRoot=["x","y"],ie.idRegex=a.idRegex,ie.attrRegex=a.attrRegex,ie.attributes=c("./attributes"),ie.layoutAttributes=c("./layout_attributes"),ie.supplyLayoutDefaults=c("./layout_defaults"),ie.transitionAxes=c("./transition_axes"),ie.finalizeSubplots=function(M,v){var _=v._subplots,l=_.xaxis,y=_.yaxis,T=_.cartesian,w=T.concat(_.gl2d||[]),A={},f={},u,h,o;for(u=0;u<w.length;u++){var S=w[u].split("y");A[S[0]]=1,f["y"+S[1]]=1}for(u=0;u<l.length;u++)h=l[u],A[h]||(o=(M[g.id2name(h)]||{}).anchor,a.idRegex.y.test(o)||(o="y"),T.push(h+o),w.push(h+o),f[o]||(f[o]=1,P.pushUnique(y,o)));for(u=0;u<y.length;u++)o=y[u],f[o]||(h=(M[g.id2name(o)]||{}).anchor,a.idRegex.x.test(h)||(h="x"),T.push(h+o),w.push(h+o),A[h]||(A[h]=1,P.pushUnique(l,h)));if(!w.length){h="",o="";for(var R in M)if(a.attrRegex.test(R)){var z=R.charAt(0);z==="x"?(!h||+R.substr(5)<+h.substr(5))&&(h=R):(!o||+R.substr(5)<+o.substr(5))&&(o=R)}h=h?g.name2id(h):"x",o=o?g.name2id(o):"y",l.push(h),y.push(o),T.push(h+o)}},ie.plot=function(M,v,_,l){var y=M._fullLayout,T=y._subplots.cartesian,w=M.calcdata,A;if(!Array.isArray(v))for(v=[],A=0;A<w.length;A++)v.push(A);for(A=0;A<T.length;A++){for(var f=T[A],u=y._plots[f],h=[],o,S=0;S<w.length;S++){var R=w[S],z=R[0].trace;z.xaxis+z.yaxis===f&&((v.indexOf(z.index)!==-1||z.carpet)&&(o&&o[0].trace.xaxis+o[0].trace.yaxis===f&&["tonextx","tonexty","tonext"].indexOf(z.fill)!==-1&&h.indexOf(o)===-1&&h.push(o),h.push(R)),o=R)}r(M,u,h,_,l)}};function r(M,v,_,l,y){for(var T=a.traceLayerClasses,w=M._fullLayout,A=w._modules,f,u,h,o=[],S=[],R=0;R<A.length;R++){f=A[R];var z=f.name,O=k.modules[z].categories;if(O.svg){var I=f.layerName||z+"layer",F=f.plot;u=p(_,F),h=u[0],_=u[1],h.length&&o.push({i:T.indexOf(I),className:I,plotMethod:F,cdModule:h}),O.zoomScale&&S.push("."+I)}}o.sort(function(U,X){return U.i-X.i});var D=v.plot.selectAll("g.mlayer").data(o,function(U){return U.className});if(D.enter().append("g").attr("class",function(U){return U.className}).classed("mlayer",!0).classed("rangeplot",v.isRangePlot),D.exit().remove(),D.order(),D.each(function(U){var X=b.select(this),oe=U.className;U.plotMethod(M,v,U.cdModule,X,l,y),a.clipOnAxisFalseQuery.indexOf("."+oe)===-1&&e.setClipUrl(X,v.layerClipId,M)}),w._has("scattergl")&&(f=k.getModule("scattergl"),h=p(_,f)[0],f.plot(M,v,h)),!M._context.staticPlot&&(v._hasClipOnAxisFalse&&(v.clipOnAxisFalseTraces=v.plot.selectAll(a.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),S.length)){var B=v.plot.selectAll(S.join(",")).selectAll(".trace");v.zoomScalePts=B.selectAll("path.point"),v.zoomScaleTxt=B.selectAll(".textpoint")}}ie.clean=function(M,v,_,l){var y=l._plots||{},T=v._plots||{},w=l._subplots||{},A,f,u;if(l._hasOnlyLargeSploms&&!v._hasOnlyLargeSploms)for(u in y)A=y[u],A.plotgroup&&A.plotgroup.remove();var h=l._has&&l._has("gl"),o=v._has&&v._has("gl");if(h&&!o)for(u in y)A=y[u],A._scene&&A._scene.destroy();if(w.xaxis&&w.yaxis){var S=g.listIds({_fullLayout:l});for(f=0;f<S.length;f++){var R=S[f];v[g.id2name(R)]||l._infolayer.selectAll(".g-"+R+"title").remove()}}var z=l._has&&l._has("cartesian"),O=v._has&&v._has("cartesian");if(z&&!O)m(l._cartesianlayer.selectAll(".subplot"),l),l._defs.selectAll(".axesclip").remove(),delete l._axisConstraintGroups,delete l._axisMatchGroups;else if(w.cartesian)for(f=0;f<w.cartesian.length;f++){var I=w.cartesian[f];if(!T[I]){var F="."+I+",."+I+"-x,."+I+"-y";l._cartesianlayer.selectAll(F).remove(),x(I,l)}}},ie.drawFramework=function(M){var v=M._fullLayout,_=d(M),l=v._cartesianlayer.selectAll(".subplot").data(_,String);l.enter().append("g").attr("class",function(y){return"subplot "+y[0]}),l.order(),l.exit().call(m,v),l.each(function(y){var T=y[0],w=v._plots[T];w.plotgroup=b.select(this),s(M,w),w.draglayer=i(v._draggers,"g",T)})},ie.rangePlot=function(M,v,_){s(M,v),r(M,v,_),E.style(M)};function d(M){var v=M._fullLayout,_=v._subplots.cartesian,l=_.length,y,T,w,A,f,u,h=[],o=[];for(y=0;y<l;y++){w=_[y],A=v._plots[w],f=A.xaxis,u=A.yaxis;var S=f._mainAxis,R=u._mainAxis,z=S._id+R._id,O=v._plots[z];A.overlays=[],z!==w&&O?(A.mainplot=z,A.mainplotinfo=O,o.push(w)):(A.mainplot=void 0,A.mainplotinfo=void 0,h.push(w))}for(y=0;y<o.length;y++)w=o[y],A=v._plots[w],A.mainplotinfo.overlays.push(A);var I=h.concat(o),F=new Array(l);for(y=0;y<l;y++){w=I[y],A=v._plots[w],f=A.xaxis,u=A.yaxis;var D=[w,f.layer,u.layer,f.overlaying||"",u.overlaying||""];for(T=0;T<A.overlays.length;T++)D.push(A.overlays[T].id);F[y]=D}return F}function s(M,v){var _=v.plotgroup,l=v.id,y=a.layerValue2layerClass[v.xaxis.layer],T=a.layerValue2layerClass[v.yaxis.layer],w=M._fullLayout._hasOnlyLargeSploms;if(v.mainplot){var f=v.mainplotinfo,u=f.plotgroup,h=l+"-x",o=l+"-y";v.gridlayer=f.gridlayer,v.zerolinelayer=f.zerolinelayer,i(f.overlinesBelow,"path",h),i(f.overlinesBelow,"path",o),i(f.overaxesBelow,"g",h),i(f.overaxesBelow,"g",o),v.plot=i(f.overplot,"g",l),i(f.overlinesAbove,"path",h),i(f.overlinesAbove,"path",o),i(f.overaxesAbove,"g",h),i(f.overaxesAbove,"g",o),v.xlines=u.select(".overlines-"+y).select("."+h),v.ylines=u.select(".overlines-"+T).select("."+o),v.xaxislayer=u.select(".overaxes-"+y).select("."+h),v.yaxislayer=u.select(".overaxes-"+T).select("."+o)}else if(w)v.xlines=i(_,"path","xlines-above"),v.ylines=i(_,"path","ylines-above"),v.xaxislayer=i(_,"g","xaxislayer-above"),v.yaxislayer=i(_,"g","yaxislayer-above");else{var A=i(_,"g","layer-subplot");v.shapelayer=i(A,"g","shapelayer"),v.imagelayer=i(A,"g","imagelayer"),v.gridlayer=i(_,"g","gridlayer"),v.zerolinelayer=i(_,"g","zerolinelayer"),i(_,"path","xlines-below"),i(_,"path","ylines-below"),v.overlinesBelow=i(_,"g","overlines-below"),i(_,"g","xaxislayer-below"),i(_,"g","yaxislayer-below"),v.overaxesBelow=i(_,"g","overaxes-below"),v.plot=i(_,"g","plot"),v.overplot=i(_,"g","overplot"),v.xlines=i(_,"path","xlines-above"),v.ylines=i(_,"path","ylines-above"),v.overlinesAbove=i(_,"g","overlines-above"),i(_,"g","xaxislayer-above"),i(_,"g","yaxislayer-above"),v.overaxesAbove=i(_,"g","overaxes-above"),v.xlines=_.select(".xlines-"+y),v.ylines=_.select(".ylines-"+T),v.xaxislayer=_.select(".xaxislayer-"+y),v.yaxislayer=_.select(".yaxislayer-"+T)}w||(n(v.gridlayer,"g",v.xaxis._id),n(v.gridlayer,"g",v.yaxis._id),v.gridlayer.selectAll("g").map(function(S){return S[0]}).sort(g.idSort)),v.xlines.style("fill","none").classed("crisp",!0),v.ylines.style("fill","none").classed("crisp",!0)}function m(M,v){if(!!M){var _={};M.each(function(f){var u=f[0],h=b.select(this);h.remove(),x(u,v),_[u]=!0});for(var l in v._plots)for(var y=v._plots[l],T=y.overlays||[],w=0;w<T.length;w++){var A=T[w];_[A.id]&&A.plot.selectAll(".trace").remove()}}}function x(M,v){v._draggers.selectAll("g."+M).remove(),v._defs.select("#clip"+v._uid+M+"plot").remove()}ie.toSVG=function(M){var v=M._fullLayout._glimages,_=b.select(M).selectAll(".svg-container"),l=_.filter(function(T,w){return w===_.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function y(){var T=this,w=T.toDataURL("image/png"),A=v.append("svg:image");A.attr({xmlns:t.svg,"xlink:href":w,preserveAspectRatio:"none",x:0,y:0,width:T.style.width,height:T.style.height})}l.each(y)},ie.updateFx=c("./graph_interact").updateFx},{"../../components/drawing":388,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../registry":638,"../get_data":593,"../plots":619,"./attributes":552,"./axis_ids":558,"./constants":561,"./graph_interact":564,"./layout_attributes":569,"./layout_defaults":570,"./transition_axes":581,"@plotly/d3":58}],569:[function(c,ae,ie){"use strict";var b=c("../font_attributes"),k=c("../../components/color/attributes"),P=c("../../components/drawing/attributes").dash,E=c("../../lib/extend").extendFlat,e=c("../../plot_api/plot_template").templatedArray,p=c("../../plots/cartesian/axis_format_attributes").descriptionWithDates,g=c("../../constants/numerical").ONEDAY,a=c("./constants"),t=a.HOUR_PATTERN,i=a.WEEKDAY_PATTERN;ae.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:k.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:b({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[i,t,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:g},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:k.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:E({},P,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:b({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:p("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:p("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:k.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:k.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:k.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:k.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",a.idRegex.x.toString(),a.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:b({editType:"ticks"})}}},{"../../components/color/attributes":365,"../../components/drawing/attributes":387,"../../constants/numerical":479,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_format_attributes":557,"../font_attributes":585,"./constants":561}],570:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color"),P=c("../../components/fx/helpers").isUnifiedHover,E=c("../../components/fx/hovermode_defaults"),e=c("../../plot_api/plot_template"),p=c("../layout_attributes"),g=c("./layout_attributes"),a=c("./type_defaults"),t=c("./axis_defaults"),i=c("./constraints"),n=c("./position_defaults"),r=c("./axis_ids"),d=r.id2name,s=r.name2id,m=c("./constants").AX_ID_PATTERN,x=c("../../registry"),M=x.traceIs,v=x.getComponentMethod;function _(l,y,T){Array.isArray(l[y])?l[y].push(T):l[y]=[T]}ae.exports=function(y,T,w){var A=T.autotypenumbers,f={},u={},h={},o={},S={},R={},z={},O={},I={},F={},D,B;for(D=0;D<w.length;D++){var U=w[D];if(!(!M(U,"cartesian")&&!M(U,"gl2d"))){var X;if(U.xaxis)X=d(U.xaxis),_(f,X,U);else if(U.xaxes)for(B=0;B<U.xaxes.length;B++)_(f,d(U.xaxes[B]),U);var oe;if(U.yaxis)oe=d(U.yaxis),_(f,oe,U);else if(U.yaxes)for(B=0;B<U.yaxes.length;B++)_(f,d(U.yaxes[B]),U);if(U.type==="funnel"?U.orientation==="h"?(X&&(u[X]=!0),oe&&(z[oe]=!0)):oe&&(h[oe]=!0):U.type==="image"?(oe&&(O[oe]=!0),X&&(O[X]=!0)):(oe&&(S[oe]=!0,R[oe]=!0),(!M(U,"carpet")||U.type==="carpet"&&!U._cheater)&&X&&(o[X]=!0)),U.type==="carpet"&&U._cheater&&X&&(u[X]=!0),M(U,"2dMap")&&(I[X]=!0,I[oe]=!0),M(U,"oriented")){var se=U.orientation==="h"?oe:X;F[se]=!0}}}var q=T._subplots,K=q.xaxis,G=q.yaxis,Q=b.simpleMap(K,d),V=b.simpleMap(G,d),H=Q.concat(V),ee=k.background;K.length&&G.length&&(ee=b.coerce(y,T,p,"plot_bgcolor"));var J=k.combine(ee,T.paper_bgcolor),W,re,j,Z,ne;function le(){var et=f[W]||[];ne._traceIndices=et.map(function(Pe){return Pe._expandedIndex}),ne._annIndices=[],ne._shapeIndices=[],ne._imgIndices=[],ne._subplotsWith=[],ne._counterAxes=[],ne._name=ne._attr=W,ne._id=re}function ge(et,Pe){return b.coerce(Z,ne,g,et,Pe)}function pe(et,Pe){return b.coerce2(Z,ne,g,et,Pe)}function xe(et){return et==="x"?G:K}function Ee(et,Pe){for(var We=et==="x"?Q:V,je=[],nt=0;nt<We.length;nt++){var kt=We[nt];kt!==Pe&&!(y[kt]||{}).overlaying&&je.push(s(kt))}return je}var Te={x:xe("x"),y:xe("y")},de=Te.x.concat(Te.y),be={},Le=[];function De(){var et=Z.matches;m.test(et)&&de.indexOf(et)===-1&&(be[et]=Z.type,Le=Object.keys(be))}var ye=E(y,T),ke=P(ye);for(D=0;D<H.length;D++){W=H[D],re=s(W),j=W.charAt(0),b.isPlainObject(y[W])||(y[W]={}),Z=y[W],ne=e.newContainer(T,W,j+"axis"),le();var Oe=j==="x"&&!o[W]&&u[W]||j==="y"&&!S[W]&&h[W],Qe=j==="y"&&(!R[W]&&z[W]||O[W]),Ve={letter:j,font:T.font,outerTicks:I[W],showGrid:!F[W],data:f[W]||[],bgColor:J,calendar:T.calendar,automargin:!0,visibleDflt:Oe,reverseDflt:Qe,autotypenumbersDflt:A,splomStash:((T._splomAxes||{})[j]||{})[re]};ge("uirevision",T.uirevision),a(Z,ne,ge,Ve),t(Z,ne,ge,Ve,T);var Ue=ke&&j===ye.charAt(0),Ie=pe("spikecolor",ke?ne.color:void 0),at=pe("spikethickness",ke?1.5:void 0),pt=pe("spikedash",ke?"dot":void 0),Rt=pe("spikemode",ke?"across":void 0),Mt=pe("spikesnap"),It=ge("showspikes",!!Ue||!!Ie||!!at||!!pt||!!Rt||!!Mt);It||(delete ne.spikecolor,delete ne.spikethickness,delete ne.spikedash,delete ne.spikemode,delete ne.spikesnap),n(Z,ne,ge,{letter:j,counterAxes:Te[j],overlayableAxes:Ee(j,W),grid:T.grid}),ge("title.standoff"),De(),ne._input=Z}for(D=0;D<Le.length;){re=Le[D++],W=d(re),j=W.charAt(0),b.isPlainObject(y[W])||(y[W]={}),Z=y[W],ne=e.newContainer(T,W,j+"axis"),le();var Bt={letter:j,font:T.font,outerTicks:I[W],showGrid:!F[W],data:[],bgColor:J,calendar:T.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:A,splomStash:((T._splomAxes||{})[j]||{})[re]};ge("uirevision",T.uirevision),ne.type=be[re]||"linear",t(Z,ne,ge,Bt,T),n(Z,ne,ge,{letter:j,counterAxes:Te[j],overlayableAxes:Ee(j,W),grid:T.grid}),ge("fixedrange"),De(),ne._input=Z}var St=v("rangeslider","handleDefaults"),_t=v("rangeselector","handleDefaults");for(D=0;D<Q.length;D++)W=Q[D],Z=y[W],ne=T[W],St(y,T,W),ne.type==="date"&&_t(Z,ne,T,V,ne.calendar),ge("fixedrange");for(D=0;D<V.length;D++){W=V[D],Z=y[W],ne=T[W];var it=T[d(ne.anchor)],ct=v("rangeslider","isVisible")(it);ge("fixedrange",ct)}i.handleDefaults(y,T,{axIds:de.concat(Le).sort(r.idSort),axHasImage:O})}},{"../../components/color":366,"../../components/fx/helpers":402,"../../components/fx/hovermode_defaults":405,"../../lib":503,"../../plot_api/plot_template":543,"../../registry":638,"../layout_attributes":610,"./axis_defaults":556,"./axis_ids":558,"./constants":561,"./constraints":562,"./layout_attributes":569,"./position_defaults":572,"./type_defaults":582}],571:[function(c,ae,ie){"use strict";var b=c("tinycolor2").mix,k=c("../../components/color/attributes").lightFraction,P=c("../../lib");ae.exports=function(e,p,g,a){a=a||{};var t=a.dfltColor;function i(y,T){return P.coerce2(e,p,a.attributes,y,T)}var n=i("linecolor",t),r=i("linewidth"),d=g("showline",a.showLine||!!n||!!r);d||(delete p.linecolor,delete p.linewidth);var s=b(t,a.bgColor,a.blend||k).toRgbString(),m=i("gridcolor",s),x=i("gridwidth"),M=g("showgrid",a.showGrid||!!m||!!x);if(M||(delete p.gridcolor,delete p.gridwidth),!a.noZeroLine){var v=i("zerolinecolor",t),_=i("zerolinewidth"),l=g("zeroline",a.showGrid||!!v||!!_);l||(delete p.zerolinecolor,delete p.zerolinewidth)}}},{"../../components/color/attributes":365,"../../lib":503,tinycolor2:312}],572:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib");ae.exports=function(E,e,p,g){var a=g.counterAxes||[],t=g.overlayableAxes||[],i=g.letter,n=g.grid,r,d,s,m;n&&(d=n._domains[i][n._axisMap[e._id]],r=n._anchors[e._id],d&&(s=n[i+"side"].split(" ")[0],m=n.domain[i][s==="right"||s==="top"?1:0])),d=d||[0,1],r=r||(b(E.position)?"free":a[0]||"free"),s=s||(i==="x"?"bottom":"left"),m=m||0;var x=k.coerce(E,e,{anchor:{valType:"enumerated",values:["free"].concat(a),dflt:r}},"anchor");x==="free"&&p("position",m),k.coerce(E,e,{side:{valType:"enumerated",values:i==="x"?["bottom","top"]:["left","right"],dflt:s}},"side");var M=!1;if(t.length&&(M=k.coerce(E,e,{overlaying:{valType:"enumerated",values:[!1].concat(t),dflt:!1}},"overlaying")),!M){var v=p("domain",d);v[0]>v[1]-1/4096&&(e.domain=d),k.noneOrAll(E.domain,e.domain,d)}return p("layer"),e}},{"../../lib":503,"fast-isnumeric":190}],573:[function(c,ae,ie){"use strict";var b=c("./show_dflt");ae.exports=function(P,E,e,p,g){g||(g={});var a=g.tickSuffixDflt,t=b(P),i=e("tickprefix");i&&e("showtickprefix",t);var n=e("ticksuffix",a);n&&e("showticksuffix",t)}},{"./show_dflt":577}],574:[function(c,ae,ie){"use strict";var b=c("../../constants/alignment").FROM_BL;ae.exports=function(P,E,e){e===void 0&&(e=b[P.constraintoward||"center"]);var p=[P.r2l(P.range[0]),P.r2l(P.range[1])],g=p[0]+(p[1]-p[0])*e;P.range=P._input.range=[P.l2r(g+(p[0]-g)*E),P.l2r(g+(p[1]-g)*E)],P.setScale()}},{"../../constants/alignment":471}],575:[function(c,ae,ie){"use strict";var b=c("polybooljs"),k=c("../../registry"),P=c("../../components/drawing").dashStyle,E=c("../../components/color"),e=c("../../components/fx"),p=c("../../components/fx/helpers").makeEventData,g=c("../../components/dragelement/helpers"),a=g.freeMode,t=g.rectMode,i=g.drawMode,n=g.openMode,r=g.selectMode,d=c("../../components/shapes/draw_newshape/display_outlines"),s=c("../../components/shapes/draw_newshape/helpers").handleEllipse,m=c("../../components/shapes/draw_newshape/newshapes"),x=c("../../lib"),M=c("../../lib/polygon"),v=c("../../lib/throttle"),_=c("./axis_ids").getFromId,l=c("../../lib/clear_gl_canvases"),y=c("../../plot_api/subroutines").redrawReglTraces,T=c("./constants"),w=T.MINSELECT,A=M.filter,f=M.tester,u=c("./handle_outline").clearSelect,h=c("./helpers"),o=h.p2r,S=h.axValue,R=h.getTransform;function z(W,re,j,Z,ne){var le=a(ne),ge=t(ne),pe=n(ne),xe=i(ne),Ee=r(ne),Te=ne==="drawline",de=ne==="drawcircle",be=Te||de,Le=Z.gd,De=Le._fullLayout,ye=De._zoomlayer,ke=Z.element.getBoundingClientRect(),Oe=Z.plotinfo,Qe=R(Oe),Ve=re-ke.left,Ue=j-ke.top;De._calcInverseTransform(Le);var Ie=x.apply3DTransform(De._invTransform)(Ve,Ue);Ve=Ie[0],Ue=Ie[1];var at=De._invScaleX,pt=De._invScaleY,Rt=Ve,Mt=Ue,It="M"+Ve+","+Ue,Bt=Z.xaxes[0]._length,St=Z.yaxes[0]._length,_t=Z.xaxes.concat(Z.yaxes),it=W.altKey&&!(i(ne)&&pe),ct,et,Pe,We,je,nt,kt;U(W,Le,Z),le&&(ct=A([[Ve,Ue]],T.BENDPX));var wt=ye.selectAll("path.select-outline-"+Oe.id).data(xe?[0]:[1,2]),Vt=De.newshape;wt.enter().append("path").attr("class",function(jr){return"select-outline select-outline-"+jr+" select-outline-"+Oe.id}).style(xe?{opacity:Vt.opacity/2,fill:pe?void 0:Vt.fillcolor,stroke:Vt.line.color,"stroke-dasharray":P(Vt.line.dash,Vt.line.width),"stroke-width":Vt.line.width+"px"}:{}).attr("fill-rule",Vt.fillrule).classed("cursor-move",!!xe).attr("transform",Qe).attr("d",It+"Z");var qt=ye.append("path").attr("class","zoombox-corners").style({fill:E.background,stroke:E.defaultLine,"stroke-width":1}).attr("transform",Qe).attr("d","M0,0Z"),zt=De._uid+T.SELECTID,Ht=[],$t=oe(Le,Z.xaxes,Z.yaxes,Z.subplot);function Qt(jr,cn){return jr-cn}var fr;Oe.fillRangeItems?fr=Oe.fillRangeItems:ge?fr=function(jr,cn){var Qr=jr.range={};for(je=0;je<_t.length;je++){var lt=_t[je],Gt=lt._id.charAt(0);Qr[lt._id]=[o(lt,cn[Gt+"min"]),o(lt,cn[Gt+"max"])].sort(Qt)}}:fr=function(jr,cn,Qr){var lt=jr.lassoPoints={};for(je=0;je<_t.length;je++){var Gt=_t[je];lt[Gt._id]=Qr.filtered.map(S(Gt))}},Z.moveFn=function(jr,cn){Rt=Math.max(0,Math.min(Bt,at*jr+Ve)),Mt=Math.max(0,Math.min(St,pt*cn+Ue));var Qr=Math.abs(Rt-Ve),lt=Math.abs(Mt-Ue);if(ge){var Gt,Kt,Nt;if(Ee){var gr=De.selectdirection;switch(gr==="any"?lt<Math.min(Qr*.6,w)?Gt="h":Qr<Math.min(lt*.6,w)?Gt="v":Gt="d":Gt=gr,Gt){case"h":Kt=de?St/2:0,Nt=St;break;case"v":Kt=de?Bt/2:0,Nt=Bt;break}}if(xe)switch(De.newshape.drawdirection){case"vertical":Gt="h",Kt=de?St/2:0,Nt=St;break;case"horizontal":Gt="v",Kt=de?Bt/2:0,Nt=Bt;break;case"ortho":Qr<lt?(Gt="h",Kt=Ue,Nt=Mt):(Gt="v",Kt=Ve,Nt=Rt);break;default:Gt="d"}Gt==="h"?(We=be?s(de,[Rt,Kt],[Rt,Nt]):[[Ve,Kt],[Ve,Nt],[Rt,Nt],[Rt,Kt]],We.xmin=be?Rt:Math.min(Ve,Rt),We.xmax=be?Rt:Math.max(Ve,Rt),We.ymin=Math.min(Kt,Nt),We.ymax=Math.max(Kt,Nt),qt.attr("d","M"+We.xmin+","+(Ue-w)+"h-4v"+2*w+"h4ZM"+(We.xmax-1)+","+(Ue-w)+"h4v"+2*w+"h-4Z")):Gt==="v"?(We=be?s(de,[Kt,Mt],[Nt,Mt]):[[Kt,Ue],[Kt,Mt],[Nt,Mt],[Nt,Ue]],We.xmin=Math.min(Kt,Nt),We.xmax=Math.max(Kt,Nt),We.ymin=be?Mt:Math.min(Ue,Mt),We.ymax=be?Mt:Math.max(Ue,Mt),qt.attr("d","M"+(Ve-w)+","+We.ymin+"v-4h"+2*w+"v4ZM"+(Ve-w)+","+(We.ymax-1)+"v4h"+2*w+"v-4Z")):Gt==="d"&&(We=be?s(de,[Ve,Ue],[Rt,Mt]):[[Ve,Ue],[Ve,Mt],[Rt,Mt],[Rt,Ue]],We.xmin=Math.min(Ve,Rt),We.xmax=Math.max(Ve,Rt),We.ymin=Math.min(Ue,Mt),We.ymax=Math.max(Ue,Mt),qt.attr("d","M0,0Z"))}else le&&(ct.addPt([Rt,Mt]),We=ct.filtered);Z.selectionDefs&&Z.selectionDefs.length?(Pe=H(Z.mergedPolygons,We,it),We.subtract=it,et=B(Z.selectionDefs.concat([We]))):(Pe=[We],et=f(We)),d(J(Pe,pe),wt,Z),Ee&&v.throttle(zt,T.SELECTDELAY,function(){Ht=[];var tt,we=[],Me;for(je=0;je<$t.length;je++)if(nt=$t[je],Me=nt._module.selectPoints(nt,et),we.push(Me),tt=ee(Me,nt),Ht.length)for(var Ne=0;Ne<tt.length;Ne++)Ht.push(tt[Ne]);else Ht=tt;kt={points:Ht},V(Le,$t,kt),fr(kt,We,ct),Z.gd.emit("plotly_selecting",kt)})},Z.clickFn=function(jr,cn){if(qt.remove(),Le._fullLayout._activeShapeIndex>=0){Le._fullLayout._deactivateShape(Le);return}if(!xe){var Qr=De.clickmode;v.done(zt).then(function(){if(v.clear(zt),jr===2){for(wt.remove(),je=0;je<$t.length;je++)nt=$t[je],nt._module.selectPoints(nt,!1);V(Le,$t),X(Z),Le.emit("plotly_deselect",null)}else Qr.indexOf("select")>-1&&O(cn,Le,Z.xaxes,Z.yaxes,Z.subplot,Z,wt),Qr==="event"&&Le.emit("plotly_selected",void 0);e.click(Le,cn)}).catch(x.error)}},Z.doneFn=function(){qt.remove(),v.done(zt).then(function(){v.clear(zt),Z.gd.emit("plotly_selected",kt),We&&Z.selectionDefs&&(We.subtract=it,Z.selectionDefs.push(We),Z.mergedPolygons.length=0,[].push.apply(Z.mergedPolygons,Pe)),Z.doneFnCompleted&&Z.doneFnCompleted(Ht)}).catch(x.error),xe&&X(Z)}}function O(W,re,j,Z,ne,le,ge){var pe=re._hoverdata,xe=re._fullLayout,Ee=xe.clickmode,Te=Ee.indexOf("event")>-1,de=[],be,Le,De,ye,ke,Oe,Qe,Ve,Ue,Ie;if(se(pe)){U(W,re,le),be=oe(re,j,Z,ne);var at=q(pe,be),pt=at.pointNumbers.length>0;if(pt?G(be,at):Q(be)&&(Qe=K(at))){for(ge&&ge.remove(),Ie=0;Ie<be.length;Ie++)Le=be[Ie],Le._module.selectPoints(Le,!1);V(re,be),X(le),Te&&re.emit("plotly_deselect",null)}else{Ve=W.shiftKey&&(Qe!==void 0?Qe:K(at)),De=I(at.pointNumber,at.searchInfo,Ve);var Rt=le.selectionDefs.concat([De]);for(ye=B(Rt),Ie=0;Ie<be.length;Ie++)if(ke=be[Ie]._module.selectPoints(be[Ie],ye),Oe=ee(ke,be[Ie]),de.length)for(var Mt=0;Mt<Oe.length;Mt++)de.push(Oe[Mt]);else de=Oe;if(Ue={points:de},V(re,be,Ue),De&&le&&le.selectionDefs.push(De),ge){var It=le.mergedPolygons,Bt=n(le.dragmode);d(J(It,Bt),ge,le)}Te&&re.emit("plotly_selected",Ue)}}}function I(W,re,j){return{pointNumber:W,searchInfo:re,subtract:j}}function F(W){return"pointNumber"in W&&"searchInfo"in W}function D(W){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(re,j,Z,ne){var le=W.searchInfo.cd[0].trace._expandedIndex,ge=ne.cd[0].trace._expandedIndex;return ge===le&&Z===W.pointNumber},isRect:!1,degenerate:!1,subtract:W.subtract}}function B(W){for(var re=[],j=F(W[0])?0:W[0][0][0],Z=j,ne=F(W[0])?0:W[0][0][1],le=ne,ge=0;ge<W.length;ge++)if(F(W[ge]))re.push(D(W[ge]));else{var pe=M.tester(W[ge]);pe.subtract=W[ge].subtract,re.push(pe),j=Math.min(j,pe.xmin),Z=Math.max(Z,pe.xmax),ne=Math.min(ne,pe.ymin),le=Math.max(le,pe.ymax)}function xe(Ee,Te,de,be){for(var Le=!1,De=0;De<re.length;De++)re[De].contains(Ee,Te,de,be)&&(Le=re[De].subtract===!1);return Le}return{xmin:j,xmax:Z,ymin:ne,ymax:le,pts:[],contains:xe,isRect:!1,degenerate:!1}}function U(W,re,j){re._fullLayout._drawing=!1;var Z=re._fullLayout,ne=j.plotinfo,le=j.dragmode,ge=Z._lastSelectedSubplot&&Z._lastSelectedSubplot===ne.id,pe=(W.shiftKey||W.altKey)&&!(i(le)&&n(le));ge&&pe&&ne.selection&&ne.selection.selectionDefs&&!j.selectionDefs?(j.selectionDefs=ne.selection.selectionDefs,j.mergedPolygons=ne.selection.mergedPolygons):(!pe||!ne.selection)&&X(j),ge||(u(re),Z._lastSelectedSubplot=ne.id)}function X(W){var re=W.dragmode,j=W.plotinfo,Z=W.gd;if(Z._fullLayout._activeShapeIndex>=0&&Z._fullLayout._deactivateShape(Z),i(re)){var ne=Z._fullLayout,le=ne._zoomlayer,ge=le.selectAll(".select-outline-"+j.id);if(ge&&Z._fullLayout._drawing){var pe=m(ge,W);pe&&k.call("_guiRelayout",Z,{shapes:pe}),Z._fullLayout._drawing=!1}}j.selection={},j.selection.selectionDefs=W.selectionDefs=[],j.selection.mergedPolygons=W.mergedPolygons=[]}function oe(W,re,j,Z){var ne=[],le=re.map(function(Le){return Le._id}),ge=j.map(function(Le){return Le._id}),pe,xe,Ee;for(Ee=0;Ee<W.calcdata.length;Ee++)if(pe=W.calcdata[Ee],xe=pe[0].trace,!(xe.visible!==!0||!xe._module||!xe._module.selectPoints))if(Z&&(xe.subplot===Z||xe.geo===Z))ne.push(be(xe._module,pe,re[0],j[0]));else if(xe.type==="splom"&&xe._xaxes[le[0]]&&xe._yaxes[ge[0]]){var Te=be(xe._module,pe,re[0],j[0]);Te.scene=W._fullLayout._splomScenes[xe.uid],ne.push(Te)}else if(xe.type==="sankey"){var de=be(xe._module,pe,re[0],j[0]);ne.push(de)}else{if(le.indexOf(xe.xaxis)===-1||ge.indexOf(xe.yaxis)===-1)continue;ne.push(be(xe._module,pe,_(W,xe.xaxis),_(W,xe.yaxis)))}return ne;function be(Le,De,ye,ke){return{_module:Le,cd:De,xaxis:ye,yaxis:ke}}}function se(W){return W&&Array.isArray(W)&&W[0].hoverOnBox!==!0}function q(W,re){var j=W[0],Z=-1,ne=[],le,ge;for(ge=0;ge<re.length;ge++)if(le=re[ge],j.fullData._expandedIndex===le.cd[0].trace._expandedIndex){if(j.hoverOnBox===!0)break;j.pointNumber!==void 0?Z=j.pointNumber:j.binNumber!==void 0&&(Z=j.binNumber,ne=j.pointNumbers);break}return{pointNumber:Z,pointNumbers:ne,searchInfo:le}}function K(W){var re=W.searchInfo.cd[0].trace,j=W.pointNumber,Z=W.pointNumbers,ne=Z.length>0,le=ne?Z[0]:j;return re.selectedpoints?re.selectedpoints.indexOf(le)>-1:!1}function G(W,re){var j=[],Z,ne,le,ge;for(ge=0;ge<W.length;ge++)Z=W[ge],Z.cd[0].trace.selectedpoints&&Z.cd[0].trace.selectedpoints.length>0&&j.push(Z);if(j.length===1&&(le=j[0]===re.searchInfo,le&&(ne=re.searchInfo.cd[0].trace,ne.selectedpoints.length===re.pointNumbers.length))){for(ge=0;ge<re.pointNumbers.length;ge++)if(ne.selectedpoints.indexOf(re.pointNumbers[ge])<0)return!1;return!0}return!1}function Q(W){var re=0,j,Z,ne;for(ne=0;ne<W.length;ne++)if(j=W[ne],Z=j.cd[0].trace,Z.selectedpoints&&(Z.selectedpoints.length>1||(re+=Z.selectedpoints.length,re>1)))return!1;return re===1}function V(W,re,j){var Z,ne,le,ge;for(Z=0;Z<re.length;Z++){var pe=re[Z].cd[0].trace._fullInput,xe=W._fullLayout._tracePreGUI[pe.uid]||{};xe.selectedpoints===void 0&&(xe.selectedpoints=pe._input.selectedpoints||null)}if(j){var Ee=j.points||[];for(Z=0;Z<re.length;Z++)ge=re[Z].cd[0].trace,ge._input.selectedpoints=ge._fullInput.selectedpoints=[],ge._fullInput!==ge&&(ge.selectedpoints=[]);for(Z=0;Z<Ee.length;Z++){var Te=Ee[Z],de=Te.data,be=Te.fullData;Te.pointIndices?([].push.apply(de.selectedpoints,Te.pointIndices),ge._fullInput!==ge&&[].push.apply(be.selectedpoints,Te.pointIndices)):(de.selectedpoints.push(Te.pointIndex),ge._fullInput!==ge&&be.selectedpoints.push(Te.pointIndex))}}else for(Z=0;Z<re.length;Z++)ge=re[Z].cd[0].trace,delete ge.selectedpoints,delete ge._input.selectedpoints,ge._fullInput!==ge&&delete ge._fullInput.selectedpoints;var Le=!1;for(Z=0;Z<re.length;Z++){ne=re[Z],le=ne.cd,ge=le[0].trace,k.traceIs(ge,"regl")&&(Le=!0);var De=ne._module,ye=De.styleOnSelect||De.style;ye&&(ye(W,le,le[0].node3),le[0].nodeRangePlot3&&ye(W,le,le[0].nodeRangePlot3))}Le&&(l(W),y(W))}function H(W,re,j){var Z;return j?(Z=b.difference({regions:W,inverted:!1},{regions:[re],inverted:!1}),Z.regions):(Z=b.union({regions:W,inverted:!1},{regions:[re],inverted:!1}),Z.regions)}function ee(W,re){if(Array.isArray(W))for(var j=re.cd,Z=re.cd[0].trace,ne=0;ne<W.length;ne++)W[ne]=p(W[ne],Z,j);return W}function J(W,re){for(var j=[],Z=0;Z<W.length;Z++){j[Z]=[];for(var ne=0;ne<W[Z].length;ne++){j[Z][ne]=[],j[Z][ne][0]=ne?"L":"M";for(var le=0;le<W[Z][ne].length;le++)j[Z][ne].push(W[Z][ne][le])}re||j[Z].push(["Z",j[Z][0][1],j[Z][0][2]])}return j}ae.exports={prepSelect:z,clearSelect:u,clearSelectionsCache:X,selectOnClick:O}},{"../../components/color":366,"../../components/dragelement/helpers":384,"../../components/drawing":388,"../../components/fx":406,"../../components/fx/helpers":402,"../../components/shapes/draw_newshape/display_outlines":454,"../../components/shapes/draw_newshape/helpers":455,"../../components/shapes/draw_newshape/newshapes":456,"../../lib":503,"../../lib/clear_gl_canvases":487,"../../lib/polygon":515,"../../lib/throttle":530,"../../plot_api/subroutines":544,"../../registry":638,"./axis_ids":558,"./constants":561,"./handle_outline":565,"./helpers":566,polybooljs:254}],576:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("d3-time-format").utcFormat,P=c("../../lib"),E=P.numberFormat,e=c("fast-isnumeric"),p=P.cleanNumber,g=P.ms2DateTime,a=P.dateTime2ms,t=P.ensureNumber,i=P.isArrayOrTypedArray,n=c("../../constants/numerical"),r=n.FP_SAFE,d=n.BADNUM,s=n.LOG_CLIP,m=n.ONEWEEK,x=n.ONEDAY,M=n.ONEHOUR,v=n.ONEMIN,_=n.ONESEC,l=c("./axis_ids"),y=c("./constants"),T=y.HOUR_PATTERN,w=y.WEEKDAY_PATTERN;function A(u){return Math.pow(10,u)}function f(u){return u!=null}ae.exports=function(h,o){o=o||{};var S=h._id||"x",R=S.charAt(0);function z(H,ee){if(H>0)return Math.log(H)/Math.LN10;if(H<=0&&ee&&h.range&&h.range.length===2){var J=h.range[0],W=h.range[1];return .5*(J+W-2*s*Math.abs(J-W))}else return d}function O(H,ee,J,W){if((W||{}).msUTC&&e(H))return+H;var re=a(H,J||h.calendar);if(re===d)if(e(H)){H=+H;var j=Math.floor(P.mod(H+.05,1)*10),Z=Math.round(H-j/10);re=a(new Date(Z))+j/10}else return d;return re}function I(H,ee,J){return g(H,ee,J||h.calendar)}function F(H){return h._categories[Math.round(H)]}function D(H){if(f(H)){if(h._categoriesMap===void 0&&(h._categoriesMap={}),h._categoriesMap[H]!==void 0)return h._categoriesMap[H];h._categories.push(typeof H=="number"?String(H):H);var ee=h._categories.length-1;return h._categoriesMap[H]=ee,ee}return d}function B(H,ee){for(var J=new Array(ee),W=0;W<ee;W++){var re=(H[0]||[])[W],j=(H[1]||[])[W];J[W]=U([re,j])}return J}function U(H){if(h._categoriesMap)return h._categoriesMap[H]}function X(H){var ee=U(H);if(ee!==void 0)return ee;if(e(H))return+H}function oe(H){return e(H)?+H:U(H)}function se(H,ee,J){return b.round(J+ee*H,2)}function q(H,ee,J){return(H-J)/ee}var K=function(ee){return e(ee)?se(ee,h._m,h._b):d},G=function(H){return q(H,h._m,h._b)};if(h.rangebreaks){var Q=R==="y";K=function(H){if(!e(H))return d;var ee=h._rangebreaks.length;if(!ee)return se(H,h._m,h._b);var J=Q;h.range[0]>h.range[1]&&(J=!J);for(var W=J?-1:1,re=W*H,j=0,Z=0;Z<ee;Z++){var ne=W*h._rangebreaks[Z].min,le=W*h._rangebreaks[Z].max;if(re<ne)break;if(re>le)j=Z+1;else{j=re<(ne+le)/2?Z:Z+1;break}}var ge=h._B[j]||0;return isFinite(ge)?se(H,h._m2,ge):0},G=function(H){var ee=h._rangebreaks.length;if(!ee)return q(H,h._m,h._b);for(var J=0,W=0;W<ee&&!(H<h._rangebreaks[W].pmin);W++)H>h._rangebreaks[W].pmax&&(J=W+1);return q(H,h._m2,h._B[J])}}h.c2l=h.type==="log"?z:t,h.l2c=h.type==="log"?A:t,h.l2p=K,h.p2l=G,h.c2p=h.type==="log"?function(H,ee){return K(z(H,ee))}:K,h.p2c=h.type==="log"?function(H){return A(G(H))}:G,["linear","-"].indexOf(h.type)!==-1?(h.d2r=h.r2d=h.d2c=h.r2c=h.d2l=h.r2l=p,h.c2d=h.c2r=h.l2d=h.l2r=t,h.d2p=h.r2p=function(H){return h.l2p(p(H))},h.p2d=h.p2r=G,h.cleanPos=t):h.type==="log"?(h.d2r=h.d2l=function(H,ee){return z(p(H),ee)},h.r2d=h.r2c=function(H){return A(p(H))},h.d2c=h.r2l=p,h.c2d=h.l2r=t,h.c2r=z,h.l2d=A,h.d2p=function(H,ee){return h.l2p(h.d2r(H,ee))},h.p2d=function(H){return A(G(H))},h.r2p=function(H){return h.l2p(p(H))},h.p2r=G,h.cleanPos=t):h.type==="date"?(h.d2r=h.r2d=P.identity,h.d2c=h.r2c=h.d2l=h.r2l=O,h.c2d=h.c2r=h.l2d=h.l2r=I,h.d2p=h.r2p=function(H,ee,J){return h.l2p(O(H,0,J))},h.p2d=h.p2r=function(H,ee,J){return I(G(H),ee,J)},h.cleanPos=function(H){return P.cleanDate(H,d,h.calendar)}):h.type==="category"?(h.d2c=h.d2l=D,h.r2d=h.c2d=h.l2d=F,h.d2r=h.d2l_noadd=X,h.r2c=function(H){var ee=oe(H);return ee!==void 0?ee:h.fraction2r(.5)},h.l2r=h.c2r=t,h.r2l=oe,h.d2p=function(H){return h.l2p(h.r2c(H))},h.p2d=function(H){return F(G(H))},h.r2p=h.d2p,h.p2r=G,h.cleanPos=function(H){return typeof H=="string"&&H!==""?H:t(H)}):h.type==="multicategory"&&(h.r2d=h.c2d=h.l2d=F,h.d2r=h.d2l_noadd=X,h.r2c=function(H){var ee=X(H);return ee!==void 0?ee:h.fraction2r(.5)},h.r2c_just_indices=U,h.l2r=h.c2r=t,h.r2l=X,h.d2p=function(H){return h.l2p(h.r2c(H))},h.p2d=function(H){return F(G(H))},h.r2p=h.d2p,h.p2r=G,h.cleanPos=function(H){return Array.isArray(H)||typeof H=="string"&&H!==""?H:t(H)},h.setupMultiCategory=function(H){var ee=h._traceIndices,J,W,re=h._matchGroup;if(re&&h._categories.length===0){for(var j in re)if(j!==S){var Z=o[l.id2name(j)];ee=ee.concat(Z._traceIndices)}}var ne=[[0,{}],[0,{}]],le=[];for(J=0;J<ee.length;J++){var ge=H[ee[J]];if(R in ge){var pe=ge[R],xe=ge._length||P.minRowLength(pe);if(i(pe[0])&&i(pe[1]))for(W=0;W<xe;W++){var Ee=pe[0][W],Te=pe[1][W];f(Ee)&&f(Te)&&(le.push([Ee,Te]),Ee in ne[0][1]||(ne[0][1][Ee]=ne[0][0]++),Te in ne[1][1]||(ne[1][1][Te]=ne[1][0]++))}}}for(le.sort(function(de,be){var Le=ne[0][1],De=Le[de[0]]-Le[be[0]];if(De)return De;var ye=ne[1][1];return ye[de[1]]-ye[be[1]]}),J=0;J<le.length;J++)D(le[J])}),h.fraction2r=function(H){var ee=h.r2l(h.range[0]),J=h.r2l(h.range[1]);return h.l2r(ee+H*(J-ee))},h.r2fraction=function(H){var ee=h.r2l(h.range[0]),J=h.r2l(h.range[1]);return(h.r2l(H)-ee)/(J-ee)},h.cleanRange=function(H,ee){ee||(ee={}),H||(H="range");var J=P.nestedProperty(h,H).get(),W,re;if(h.type==="date"?re=P.dfltRange(h.calendar):R==="y"?re=y.DFLTRANGEY:h._name==="realaxis"?re=[0,1]:re=ee.dfltRange||y.DFLTRANGEX,re=re.slice(),(h.rangemode==="tozero"||h.rangemode==="nonnegative")&&(re[0]=0),!J||J.length!==2){P.nestedProperty(h,H).set(re);return}for(h.type==="date"&&!h.autorange&&(J[0]=P.cleanDate(J[0],d,h.calendar),J[1]=P.cleanDate(J[1],d,h.calendar)),W=0;W<2;W++)if(h.type==="date"){if(!P.isDateTime(J[W],h.calendar)){h[H]=re;break}if(h.r2l(J[0])===h.r2l(J[1])){var j=P.constrain(h.r2l(J[0]),P.MIN_MS+1e3,P.MAX_MS-1e3);J[0]=h.l2r(j-1e3),J[1]=h.l2r(j+1e3);break}}else{if(!e(J[W]))if(e(J[1-W]))J[W]=J[1-W]*(W?10:.1);else{h[H]=re;break}if(J[W]<-r?J[W]=-r:J[W]>r&&(J[W]=r),J[0]===J[1]){var Z=Math.max(1,Math.abs(J[0]*1e-6));J[0]-=Z,J[1]+=Z}}},h.setScale=function(H){var ee=o._size;if(h.overlaying){var J=l.getFromId({_fullLayout:o},h.overlaying);h.domain=J.domain}var W=H&&h._r?"_r":"range",re=h.calendar;h.cleanRange(W);var j=h.r2l(h[W][0],re),Z=h.r2l(h[W][1],re),ne=R==="y";if(ne?(h._offset=ee.t+(1-h.domain[1])*ee.h,h._length=ee.h*(h.domain[1]-h.domain[0]),h._m=h._length/(j-Z),h._b=-h._m*Z):(h._offset=ee.l+h.domain[0]*ee.w,h._length=ee.w*(h.domain[1]-h.domain[0]),h._m=h._length/(Z-j),h._b=-h._m*j),h._rangebreaks=[],h._lBreaks=0,h._m2=0,h._B=[],h.rangebreaks){var le,ge;if(h._rangebreaks=h.locateBreaks(Math.min(j,Z),Math.max(j,Z)),h._rangebreaks.length){for(le=0;le<h._rangebreaks.length;le++)ge=h._rangebreaks[le],h._lBreaks+=Math.abs(ge.max-ge.min);var pe=ne;j>Z&&(pe=!pe),pe&&h._rangebreaks.reverse();var xe=pe?-1:1;for(h._m2=xe*h._length/(Math.abs(Z-j)-h._lBreaks),h._B.push(-h._m2*(ne?Z:j)),le=0;le<h._rangebreaks.length;le++)ge=h._rangebreaks[le],h._B.push(h._B[h._B.length-1]-xe*h._m2*(ge.max-ge.min));for(le=0;le<h._rangebreaks.length;le++)ge=h._rangebreaks[le],ge.pmin=K(ge.min),ge.pmax=K(ge.max)}}if(!isFinite(h._m)||!isFinite(h._b)||h._length<0)throw o._replotting=!1,new Error("Something went wrong with axis scaling")},h.maskBreaks=function(H){var ee=h.rangebreaks||[],J,W,re,j,Z;ee._cachedPatterns||(ee._cachedPatterns=ee.map(function(Le){return Le.enabled&&Le.bounds?P.simpleMap(Le.bounds,Le.pattern?p:h.d2c):null})),ee._cachedValues||(ee._cachedValues=ee.map(function(Le){return Le.enabled&&Le.values?P.simpleMap(Le.values,h.d2c).sort(P.sorterAsc):null}));for(var ne=0;ne<ee.length;ne++){var le=ee[ne];if(le.enabled){if(le.bounds){var ge=le.pattern;switch(J=ee._cachedPatterns[ne],W=J[0],re=J[1],ge){case w:Z=new Date(H),j=Z.getUTCDay(),W>re&&(re+=7,j<W&&(j+=7));break;case T:Z=new Date(H);var pe=Z.getUTCHours(),xe=Z.getUTCMinutes(),Ee=Z.getUTCSeconds(),Te=Z.getUTCMilliseconds();j=pe+(xe/60+Ee/3600+Te/36e5),W>re&&(re+=24,j<W&&(j+=24));break;case"":j=H;break}if(j>=W&&j<re)return d}else for(var de=ee._cachedValues[ne],be=0;be<de.length;be++)if(W=de[be],re=W+le.dvalue,H>=W&&H<re)return d}}return H},h.locateBreaks=function(H,ee){var J,W,re,j,Z=[];if(!h.rangebreaks)return Z;var ne=h.rangebreaks.slice().sort(function(ye,ke){return ye.pattern===w&&ke.pattern===T?-1:ke.pattern===w&&ye.pattern===T?1:0}),le=function(ye,ke){if(ye=P.constrain(ye,H,ee),ke=P.constrain(ke,H,ee),ye!==ke){for(var Oe=!0,Qe=0;Qe<Z.length;Qe++){var Ve=Z[Qe];ye<Ve.max&&ke>=Ve.min&&(ye<Ve.min&&(Ve.min=ye),ke>Ve.max&&(Ve.max=ke),Oe=!1)}Oe&&Z.push({min:ye,max:ke})}};for(J=0;J<ne.length;J++){var ge=ne[J];if(ge.enabled)if(ge.bounds){var pe=H,xe=ee;ge.pattern&&(pe=Math.floor(pe)),W=P.simpleMap(ge.bounds,ge.pattern?p:h.r2l),re=W[0],j=W[1];var Ee=new Date(pe),Te,de;switch(ge.pattern){case w:de=m,Te=((j<re?7:0)+(j-re))*x,pe+=re*x-(Ee.getUTCDay()*x+Ee.getUTCHours()*M+Ee.getUTCMinutes()*v+Ee.getUTCSeconds()*_+Ee.getUTCMilliseconds());break;case T:de=x,Te=((j<re?24:0)+(j-re))*M,pe+=re*M-(Ee.getUTCHours()*M+Ee.getUTCMinutes()*v+Ee.getUTCSeconds()*_+Ee.getUTCMilliseconds());break;default:pe=Math.min(W[0],W[1]),xe=Math.max(W[0],W[1]),de=xe-pe,Te=de}for(var be=pe;be<xe;be+=de)le(be,be+Te)}else for(var Le=P.simpleMap(ge.values,h.d2c),De=0;De<Le.length;De++)re=Le[De],j=re+ge.dvalue,le(re,j)}return Z.sort(function(ye,ke){return ye.min-ke.min}),Z},h.makeCalcdata=function(H,ee,J){var W,re,j,Z,ne=h.type,le=ne==="date"&&H[ee+"calendar"];if(ee in H){if(W=H[ee],Z=H._length||P.minRowLength(W),P.isTypedArray(W)&&(ne==="linear"||ne==="log")){if(Z===W.length)return W;if(W.subarray)return W.subarray(0,Z)}if(ne==="multicategory")return B(W,Z);for(re=new Array(Z),j=0;j<Z;j++)re[j]=h.d2c(W[j],0,le,J)}else{var ge=ee+"0"in H?h.d2c(H[ee+"0"],0,le):0,pe=H["d"+ee]?Number(H["d"+ee]):1;for(W=H[{x:"y",y:"x"}[ee]],Z=H._length||W.length,re=new Array(Z),j=0;j<Z;j++)re[j]=ge+j*pe}if(h.rangebreaks)for(j=0;j<Z;j++)re[j]=h.maskBreaks(re[j]);return re},h.isValidRange=function(H){return Array.isArray(H)&&H.length===2&&e(h.r2l(H[0]))&&e(h.r2l(H[1]))},h.isPtWithinRange=function(H,ee){var J=h.c2l(H[R],null,ee),W=h.r2l(h.range[0]),re=h.r2l(h.range[1]);return W<re?W<=J&&J<=re:re<=J&&J<=W},h._emptyCategories=function(){h._categories=[],h._categoriesMap={}},h.clearCalc=function(){var H=h._matchGroup;if(H){var ee=null,J=null;for(var W in H){var re=o[l.id2name(W)];if(re._categories){ee=re._categories,J=re._categoriesMap;break}}ee&&J?(h._categories=ee,h._categoriesMap=J):h._emptyCategories()}else h._emptyCategories();if(h._initialCategories)for(var j=0;j<h._initialCategories.length;j++)D(h._initialCategories[j])},h.sortByInitialCategories=function(){var H=[];if(h._emptyCategories(),h._initialCategories)for(var ee=0;ee<h._initialCategories.length;ee++)D(h._initialCategories[ee]);H=H.concat(h._traceIndices);var J=h._matchGroup;for(var W in J)if(S!==W){var re=o[l.id2name(W)];re._categories=h._categories,re._categoriesMap=h._categoriesMap,H=H.concat(re._traceIndices)}return H};var V=o._d3locale;h.type==="date"&&(h._dateFormat=V?V.timeFormat:k,h._extraFormat=o._extraFormat),h._separators=o.separators,h._numFormat=V?V.numberFormat:E,delete h._minDtick,delete h._forceTick0}},{"../../constants/numerical":479,"../../lib":503,"./axis_ids":558,"./constants":561,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],577:[function(c,ae,ie){"use strict";ae.exports=function(k){var P=["showexponent","showtickprefix","showticksuffix"],E=P.filter(function(p){return k[p]!==void 0}),e=function(p){return k[p]===k[E[0]]};if(E.every(e)||E.length===1)return k[E[0]]}},{}],578:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color").contrast,P=c("./layout_attributes"),E=c("./show_dflt"),e=c("../array_container_defaults");ae.exports=function(a,t,i,n,r){r||(r={});var d=E(a),s=i("showticklabels");if(s){var m=r.font||{},x=t.color,M=t.ticklabelposition||"",v=M.indexOf("inside")!==-1?k(r.bgColor):x&&x!==P.color.dflt?x:m.color;if(b.coerceFont(i,"tickfont",{family:m.family,size:m.size,color:v}),!r.noTicklabelstep&&n!=="multicategory"&&n!=="log"&&i("ticklabelstep"),r.noAng||i("tickangle"),n!=="category"){var _=i("tickformat");e(a,t,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:p}),t.tickformatstops.length||delete t.tickformatstops,!r.noExp&&!_&&n!=="date"&&(i("showexponent",d),i("exponentformat"),i("minexponent"),i("separatethousands"))}}};function p(g,a){function t(n,r){return b.coerce(g,a,P.tickformatstops,n,r)}var i=t("enabled");i&&(t("dtickrange"),t("value"))}},{"../../components/color":366,"../../lib":503,"../array_container_defaults":549,"./layout_attributes":569,"./show_dflt":577}],579:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(E,e,p,g){var a=b.coerce2(E,e,k,"ticklen"),t=b.coerce2(E,e,k,"tickwidth"),i=b.coerce2(E,e,k,"tickcolor",e.color),n=p("ticks",g.outerTicks||a||t||i?"outside":"");n||(delete e.ticklen,delete e.tickwidth,delete e.tickcolor)}},{"../../lib":503,"./layout_attributes":569}],580:[function(c,ae,ie){"use strict";var b=c("./clean_ticks"),k=c("../../lib").isArrayOrTypedArray;ae.exports=function(E,e,p,g){function a(x){var M=E[x];return M!==void 0?M:(e._template||{})[x]}var t=a("tick0"),i=a("dtick"),n=a("tickvals"),r=k(n)?"array":i?"linear":"auto",d=p("tickmode",r);if(d==="auto")p("nticks");else if(d==="linear"){var s=e.dtick=b.dtick(i,g);e.tick0=b.tick0(t,g,e.calendar,s)}else if(g!=="multicategory"){var m=p("tickvals");m===void 0?e.tickmode="auto":p("ticktext")}}},{"../../lib":503,"./clean_ticks":560}],581:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../registry"),P=c("../../lib"),E=c("../../components/drawing"),e=c("./axes");ae.exports=function(g,a,t,i){var n=g._fullLayout;if(a.length===0){e.redrawComponents(g);return}function r(T){var w=T.xaxis,A=T.yaxis;n._defs.select("#"+T.clipId+"> rect").call(E.setTranslate,0,0).call(E.setScale,1,1),T.plot.call(E.setTranslate,w._offset,A._offset).call(E.setScale,1,1);var f=T.plot.selectAll(".scatterlayer .trace");f.selectAll(".point").call(E.setPointGroupScale,1,1),f.selectAll(".textpoint").call(E.setTextPointsScale,1,1),f.call(E.hideOutsideRangePoints,T)}function d(T,w){var A=T.plotinfo,f=A.xaxis,u=A.yaxis,h=f._length,o=u._length,S=!!T.xr1,R=!!T.yr1,z=[];if(S){var O=P.simpleMap(T.xr0,f.r2l),I=P.simpleMap(T.xr1,f.r2l),F=O[1]-O[0],D=I[1]-I[0];z[0]=(O[0]*(1-w)+w*I[0]-O[0])/(O[1]-O[0])*h,z[2]=h*(1-w+w*D/F),f.range[0]=f.l2r(O[0]*(1-w)+w*I[0]),f.range[1]=f.l2r(O[1]*(1-w)+w*I[1])}else z[0]=0,z[2]=h;if(R){var B=P.simpleMap(T.yr0,u.r2l),U=P.simpleMap(T.yr1,u.r2l),X=B[1]-B[0],oe=U[1]-U[0];z[1]=(B[1]*(1-w)+w*U[1]-B[1])/(B[0]-B[1])*o,z[3]=o*(1-w+w*oe/X),u.range[0]=f.l2r(B[0]*(1-w)+w*U[0]),u.range[1]=u.l2r(B[1]*(1-w)+w*U[1])}else z[1]=0,z[3]=o;e.drawOne(g,f,{skipTitle:!0}),e.drawOne(g,u,{skipTitle:!0}),e.redrawComponents(g,[f._id,u._id]);var se=S?h/z[2]:1,q=R?o/z[3]:1,K=S?z[0]:0,G=R?z[1]:0,Q=S?z[0]/z[2]*h:0,V=R?z[1]/z[3]*o:0,H=f._offset-Q,ee=u._offset-V;A.clipRect.call(E.setTranslate,K,G).call(E.setScale,1/se,1/q),A.plot.call(E.setTranslate,H,ee).call(E.setScale,se,q),E.setPointGroupScale(A.zoomScalePts,1/se,1/q),E.setTextPointsScale(A.zoomScaleTxt,1/se,1/q)}var s;i&&(s=i());function m(){for(var T={},w=0;w<a.length;w++){var A=a[w],f=A.plotinfo.xaxis,u=A.plotinfo.yaxis;A.xr1&&(T[f._name+".range"]=A.xr1.slice()),A.yr1&&(T[u._name+".range"]=A.yr1.slice())}return s&&s(),k.call("relayout",g,T).then(function(){for(var h=0;h<a.length;h++)r(a[h].plotinfo)})}function x(){for(var T={},w=0;w<a.length;w++){var A=a[w],f=A.plotinfo.xaxis,u=A.plotinfo.yaxis;A.xr0&&(T[f._name+".range"]=A.xr0.slice()),A.yr0&&(T[u._name+".range"]=A.yr0.slice())}return k.call("relayout",g,T).then(function(){for(var h=0;h<a.length;h++)r(a[h].plotinfo)})}var M,v,_,l=b.ease(t.easing);g._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(_),_=null,x()});function y(){v=Date.now();for(var T=Math.min(1,(v-M)/t.duration),w=l(T),A=0;A<a.length;A++)d(a[A],w);v-M>t.duration?(m(),_=window.cancelAnimationFrame(y)):_=window.requestAnimationFrame(y)}return M=Date.now(),_=window.requestAnimationFrame(y),Promise.resolve()}},{"../../components/drawing":388,"../../lib":503,"../../registry":638,"./axes":554,"@plotly/d3":58}],582:[function(c,ae,ie){"use strict";var b=c("../../registry").traceIs,k=c("./axis_autotype");ae.exports=function(a,t,i,n){i("autotypenumbers",n.autotypenumbersDflt);var r=i("type",(n.splomStash||{}).type);r==="-"&&(P(t,n.data),t.type==="-"?t.type="linear":a.type=t.type)};function P(g,a){if(g.type==="-"){var t=g._id,i=t.charAt(0),n;t.indexOf("scene")!==-1&&(t=i);var r=E(a,t,i);if(!!r){if(r.type==="histogram"&&i==={v:"y",h:"x"}[r.orientation||"v"]){g.type="linear";return}var d=i+"calendar",s=r[d],m={noMultiCategory:!b(r,"cartesian")||b(r,"noMultiCategory")};if(r.type==="box"&&r._hasPreCompStats&&i==={h:"x",v:"y"}[r.orientation||"v"]&&(m.noMultiCategory=!0),m.autotypenumbers=g.autotypenumbers,p(r,i)){var x=e(r),M=[];for(n=0;n<a.length;n++){var v=a[n];!b(v,"box-violin")||(v[i+"axis"]||i)!==t||(v[x]!==void 0?M.push(v[x][0]):v.name!==void 0?M.push(v.name):M.push("text"),v[d]!==s&&(s=void 0))}g.type=k(M,s,m)}else if(r.type==="splom"){var _=r.dimensions,l=_[r._axesDim[t]];l.visible&&(g.type=k(l.values,s,m))}else g.type=k(r[i]||[r[i+"0"]],s,m)}}}function E(g,a,t){for(var i=0;i<g.length;i++){var n=g[i];if(n.type==="splom"&&n._length>0&&(n["_"+t+"axes"]||{})[a])return n;if((n[t+"axis"]||t)===a){if(p(n,t))return n;if((n[t]||[]).length||n[t+"0"])return n}}}function e(g){return{v:"x",h:"y"}[g.orientation||"v"]}function p(g,a){var t=e(g),i=b(g,"box-violin"),n=b(g._fullInput||{},"candlestick");return i&&!n&&a===t&&g[t]===void 0&&g[t+"0"]===void 0}},{"../../registry":638,"./axis_autotype":555}],583:[function(c,ae,ie){"use strict";var b=c("../registry"),k=c("../lib");ie.manageCommandObserver=function(a,t,i,n){var r={},d=!0;t&&t._commandObserver&&(r=t._commandObserver),r.cache||(r.cache={}),r.lookupTable={};var s=ie.hasSimpleAPICommandBindings(a,i,r.lookupTable);if(t&&t._commandObserver){if(s)return r;if(t._commandObserver.remove)return t._commandObserver.remove(),t._commandObserver=null,r}if(s){P(a,s,r.cache),r.check=function(){if(!!d){var v=P(a,s,r.cache);return v.changed&&n&&r.lookupTable[v.value]!==void 0&&(r.disable(),Promise.resolve(n({value:v.value,type:s.type,prop:s.prop,traces:s.traces,index:r.lookupTable[v.value]})).then(r.enable,r.enable)),v.changed}};for(var m=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],x=0;x<m.length;x++)a._internalOn(m[x],r.check);r.remove=function(){for(var M=0;M<m.length;M++)a._removeInternalListener(m[M],r.check)}}else k.log("Unable to automatically bind plot updates to API command"),r.lookupTable={},r.remove=function(){};return r.disable=function(){d=!1},r.enable=function(){d=!0},t&&(t._commandObserver=r),r},ie.hasSimpleAPICommandBindings=function(a,t,i){var n,r=t.length,d;for(n=0;n<r;n++){var s,m=t[n],x=m.method,M=m.args;if(Array.isArray(M)||(M=[]),!x)return!1;var v=ie.computeAPICommandBindings(a,x,M);if(v.length!==1)return!1;if(!d)d=v[0],Array.isArray(d.traces)&&d.traces.sort();else{if(s=v[0],s.type!==d.type||s.prop!==d.prop)return!1;if(Array.isArray(d.traces))if(Array.isArray(s.traces)){s.traces.sort();for(var _=0;_<d.traces.length;_++)if(d.traces[_]!==s.traces[_])return!1}else return!1;else if(s.prop!==d.prop)return!1}s=v[0];var l=s.value;if(Array.isArray(l))if(l.length===1)l=l[0];else return!1;i&&(i[l]=n)}return d};function P(a,t,i){var n,r,d,s=!1;if(t.type==="data")n=a._fullData[t.traces!==null?t.traces[0]:0];else if(t.type==="layout")n=a._fullLayout;else return!1;return r=k.nestedProperty(n,t.prop).get(),d=i[t.type]=i[t.type]||{},d.hasOwnProperty(t.prop)&&d[t.prop]!==r&&(s=!0),d[t.prop]=r,{changed:s,value:r}}ie.executeAPICommand=function(a,t,i){if(t==="skip")return Promise.resolve();var n=b.apiMethodRegistry[t],r=[a];Array.isArray(i)||(i=[]);for(var d=0;d<i.length;d++)r.push(i[d]);return n.apply(null,r).catch(function(s){return k.warn("API call to Plotly."+t+" rejected.",s),Promise.reject(s)})},ie.computeAPICommandBindings=function(a,t,i){var n;switch(Array.isArray(i)||(i=[]),t){case"restyle":n=p(a,i);break;case"relayout":n=e(a,i);break;case"update":n=p(a,[i[0],i[2]]).concat(e(a,[i[1]]));break;case"animate":n=E(a,i);break;default:n=[]}return n};function E(a,t){return Array.isArray(t[0])&&t[0].length===1&&["string","number"].indexOf(typeof t[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:t[0][0].toString()}]:[]}function e(a,t){var i=[],n=t[0],r={};if(typeof n=="string")r[n]=t[1];else if(k.isPlainObject(n))r=n;else return i;return g(r,function(d,s,m){i.push({type:"layout",prop:d,value:m})},"",0),i}function p(a,t){var i,n,r,d,s=[];if(n=t[0],r=t[1],i=t[2],d={},typeof n=="string")d[n]=r;else if(k.isPlainObject(n))d=n,i===void 0&&(i=r);else return s;return i===void 0&&(i=null),g(d,function(m,x,M){var v,_;if(Array.isArray(M)){_=M.slice();var l=Math.min(_.length,a.data.length);i&&(l=Math.min(l,i.length)),v=[];for(var y=0;y<l;y++)v[y]=i?i[y]:y}else _=M,v=i?i.slice():null;if(v===null)Array.isArray(_)&&(_=_[0]);else if(Array.isArray(v)){if(!Array.isArray(_)){var T=_;_=[];for(var w=0;w<v.length;w++)_[w]=T}_.length=Math.min(v.length,_.length)}s.push({type:"data",prop:m,traces:v,value:_})},"",0),s}function g(a,t,i,n){Object.keys(a).forEach(function(r){var d=a[r];if(r[0]!=="_"){var s=i+(n>0?".":"")+r;k.isPlainObject(d)?g(d,t,s,n+1):t(s,r,d)}})}},{"../lib":503,"../registry":638}],584:[function(c,ae,ie){"use strict";var b=c("../lib/extend").extendFlat;ie.attributes=function(k,P){k=k||{},P=P||{};var E={valType:"info_array",editType:k.editType,items:[{valType:"number",min:0,max:1,editType:k.editType},{valType:"number",min:0,max:1,editType:k.editType}],dflt:[0,1]},e=k.name?k.name+" ":"",p=k.trace?"trace ":"subplot ",g=P.description?" "+P.description:"",a={x:b({},E,{}),y:b({},E,{}),editType:k.editType};return k.noGridCell||(a.row={valType:"integer",min:0,dflt:0,editType:k.editType},a.column={valType:"integer",min:0,dflt:0,editType:k.editType}),a},ie.defaults=function(k,P,E,e){var p=e&&e.x||[0,1],g=e&&e.y||[0,1],a=P.grid;if(a){var t=E("domain.column");t!==void 0&&(t<a.columns?p=a._domains.x[t]:delete k.domain.column);var i=E("domain.row");i!==void 0&&(i<a.rows?g=a._domains.y[i]:delete k.domain.row)}var n=E("domain.x",p),r=E("domain.y",g);n[0]<n[1]||(k.domain.x=p.slice()),r[0]<r[1]||(k.domain.y=g.slice())}},{"../lib/extend":493}],585:[function(c,ae,ie){"use strict";ae.exports=function(b){var k=b.editType,P=b.colorEditType;P===void 0&&(P=k);var E={family:{valType:"string",noBlank:!0,strict:!0,editType:k},size:{valType:"number",min:1,editType:k},color:{valType:"color",editType:P},editType:k};return b.autoSize&&(E.size.dflt="auto"),b.autoColor&&(E.color.dflt="auto"),b.arrayOk&&(E.family.arrayOk=!0,E.size.arrayOk=!0,E.color.arrayOk=!0),E}},{}],586:[function(c,ae,ie){"use strict";ae.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],587:[function(c,ae,ie){"use strict";ie.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},ie.axesNames=["lonaxis","lataxis"],ie.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},ie.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},ie.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},ie.clipPad=.001,ie.precision=.1,ie.landColor="#F0DC82",ie.waterColor="#3399FF",ie.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},ie.sphereSVG={type:"Sphere"},ie.fillLayers={ocean:1,land:1,lakes:1},ie.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},ie.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],ie.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],ie.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],588:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("d3-geo"),P=k.geoPath,E=k.geoDistance,e=c("d3-geo-projection"),p=c("../../registry"),g=c("../../lib"),a=g.strTranslate,t=c("../../components/color"),i=c("../../components/drawing"),n=c("../../components/fx"),r=c("../plots"),d=c("../cartesian/axes"),s=c("../cartesian/autorange").getAutoRange,m=c("../../components/dragelement"),x=c("../cartesian/select").prepSelect,M=c("../cartesian/select").clearSelect,v=c("../cartesian/select").selectOnClick,_=c("./zoom"),l=c("./constants"),y=c("../../lib/geo_location_utils"),T=c("../../lib/topojson_utils"),w=c("topojson-client").feature;function A(S){this.id=S.id,this.graphDiv=S.graphDiv,this.container=S.container,this.topojsonURL=S.topojsonURL,this.isStatic=S.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var f=A.prototype;ae.exports=function(R){return new A(R)},f.plot=function(S,R,z){var O=this,I=R[this.id],F=[],D=!1;for(var B in l.layerNameToAdjective)if(B!=="frame"&&I["show"+B]){D=!0;break}for(var U=0;U<S.length;U++)if(S[0][0].trace.locationmode){D=!0;break}if(D){var X=T.getTopojsonName(I);(O.topojson===null||X!==O.topojsonName)&&(O.topojsonName=X,PlotlyGeoAssets.topojson[O.topojsonName]===void 0&&F.push(O.fetchTopojson()))}F=F.concat(y.fetchTraceGeoData(S)),z.push(new Promise(function(oe,se){Promise.all(F).then(function(){O.topojson=PlotlyGeoAssets.topojson[O.topojsonName],O.update(S,R),oe()}).catch(se)}))},f.fetchTopojson=function(){var S=this,R=T.getTopojsonPath(S.topojsonURL,S.topojsonName);return new Promise(function(z,O){b.json(R,function(I,F){if(I)return I.status===404?O(new Error(["plotly.js could not find topojson file at",R,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):O(new Error(["unexpected error while fetching topojson file at",R].join(" ")));PlotlyGeoAssets.topojson[S.topojsonName]=F,z()})})},f.update=function(S,R){var z=R[this.id];this.hasChoropleth=!1;for(var O=0;O<S.length;O++){var I=S[O],F=I[0].trace;F.type==="choropleth"&&(this.hasChoropleth=!0),F.visible===!0&&F._length>0&&F._module.calcGeoJSON(I,R)}var D=this.updateProjection(S,R);if(!D){(!this.viewInitial||this.scope!==z.scope)&&this.saveViewInitial(z),this.scope=z.scope,this.updateBaseLayers(R,z),this.updateDims(R,z),this.updateFx(R,z),r.generalUpdatePerTraceModule(this.graphDiv,this,S,z);var B=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=B.selectAll(".point"),this.dataPoints.text=B.selectAll("text"),this.dataPaths.line=B.selectAll(".js-line");var U=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=U.selectAll("path"),this.render()}},f.updateProjection=function(S,R){var z=this.graphDiv,O=R[this.id],I=R._size,F=O.domain,D=O.projection,B=O.lonaxis,U=O.lataxis,X=B._ax,oe=U._ax,se=this.projection=u(O),q=[[I.l+I.w*F.x[0],I.t+I.h*(1-F.y[1])],[I.l+I.w*F.x[1],I.t+I.h*(1-F.y[0])]],K=O.center||{},G=D.rotation||{},Q=B.range||[],V=U.range||[];if(O.fitbounds){X._length=q[1][0]-q[0][0],oe._length=q[1][1]-q[0][1],X.range=s(z,X),oe.range=s(z,oe);var H=(X.range[0]+X.range[1])/2,ee=(oe.range[0]+oe.range[1])/2;if(O._isScoped)K={lon:H,lat:ee};else if(O._isClipped){K={lon:H,lat:ee},G={lon:H,lat:ee,roll:G.roll};var J=D.type,W=l.lonaxisSpan[J]/2||180,re=l.lataxisSpan[J]/2||90;Q=[H-W,H+W],V=[ee-re,ee+re]}else K={lon:H,lat:ee},G={lon:H,lat:G.lat,roll:G.roll}}se.center([K.lon-G.lon,K.lat-G.lat]).rotate([-G.lon,-G.lat,G.roll]).parallels(D.parallels);var j=o(Q,V);se.fitExtent(q,j);var Z=this.bounds=se.getBounds(j),ne=this.fitScale=se.scale(),le=se.translate();if(O.fitbounds){var ge=se.getBounds(o(X.range,oe.range)),pe=Math.min((Z[1][0]-Z[0][0])/(ge[1][0]-ge[0][0]),(Z[1][1]-Z[0][1])/(ge[1][1]-ge[0][1]));isFinite(pe)?se.scale(pe*ne):g.warn("Something went wrong during"+this.id+"fitbounds computations.")}else se.scale(D.scale*ne);var xe=this.midPt=[(Z[0][0]+Z[1][0])/2,(Z[0][1]+Z[1][1])/2];if(se.translate([le[0]+(xe[0]-le[0]),le[1]+(xe[1]-le[1])]).clipExtent(Z),O._isAlbersUsa){var Ee=se([K.lon,K.lat]),Te=se.translate();se.translate([Te[0]-(Ee[0]-Te[0]),Te[1]-(Ee[1]-Te[1])])}},f.updateBaseLayers=function(S,R){var z=this,O=z.topojson,I=z.layers,F=z.basePaths;function D(q){return q==="lonaxis"||q==="lataxis"}function B(q){return Boolean(l.lineLayers[q])}function U(q){return Boolean(l.fillLayers[q])}var X=this.hasChoropleth?l.layersForChoropleth:l.layers,oe=X.filter(function(q){return B(q)||U(q)?R["show"+q]:D(q)?R[q].showgrid:!0}),se=z.framework.selectAll(".layer").data(oe,String);se.exit().each(function(q){delete I[q],delete F[q],b.select(this).remove()}),se.enter().append("g").attr("class",function(q){return"layer "+q}).each(function(q){var K=I[q]=b.select(this);q==="bg"?z.bgRect=K.append("rect").style("pointer-events","all"):D(q)?F[q]=K.append("path").style("fill","none"):q==="backplot"?K.append("g").classed("choroplethlayer",!0):q==="frontplot"?K.append("g").classed("scatterlayer",!0):B(q)?F[q]=K.append("path").style("fill","none").style("stroke-miterlimit",2):U(q)&&(F[q]=K.append("path").style("stroke","none"))}),se.order(),se.each(function(q){var K=F[q],G=l.layerNameToAdjective[q];q==="frame"?K.datum(l.sphereSVG):B(q)||U(q)?K.datum(w(O,O.objects[q])):D(q)&&K.datum(h(q,R,S)).call(t.stroke,R[q].gridcolor).call(i.dashLine,"",R[q].gridwidth),B(q)?K.call(t.stroke,R[G+"color"]).call(i.dashLine,"",R[G+"width"]):U(q)&&K.call(t.fill,R[G+"color"])})},f.updateDims=function(S,R){var z=this.bounds,O=(R.framewidth||0)/2,I=z[0][0]-O,F=z[0][1]-O,D=z[1][0]-I+O,B=z[1][1]-F+O;i.setRect(this.clipRect,I,F,D,B),this.bgRect.call(i.setRect,I,F,D,B).call(t.fill,R.bgcolor),this.xaxis._offset=I,this.xaxis._length=D,this.yaxis._offset=F,this.yaxis._length=B},f.updateFx=function(S,R){var z=this,O=z.graphDiv,I=z.bgRect,F=S.dragmode,D=S.clickmode;if(z.isStatic)return;function B(){var se=z.viewInitial,q={};for(var K in se)q[z.id+"."+K]=se[K];p.call("_guiRelayout",O,q),O.emit("plotly_doubleclick",null)}function U(se){return z.projection.invert([se[0]+z.xaxis._offset,se[1]+z.yaxis._offset])}var X;F==="select"?X=function(se,q){var K=se.range={};K[z.id]=[U([q.xmin,q.ymin]),U([q.xmax,q.ymax])]}:F==="lasso"&&(X=function(se,q,K){var G=se.lassoPoints={};G[z.id]=K.filtered.map(U)});var oe={element:z.bgRect.node(),gd:O,plotinfo:{id:z.id,xaxis:z.xaxis,yaxis:z.yaxis,fillRangeItems:X},xaxes:[z.xaxis],yaxes:[z.yaxis],subplot:z.id,clickFn:function(se){se===2&&M(O)}};F==="pan"?(I.node().onmousedown=null,I.call(_(z,R)),I.on("dblclick.zoom",B),O._context._scrollZoom.geo||I.on("wheel.zoom",null)):(F==="select"||F==="lasso")&&(I.on(".zoom",null),oe.prepFn=function(se,q,K){x(se,q,K,oe,F)},m.init(oe)),I.on("mousemove",function(){var se=z.projection.invert(g.getPositionFromD3Event());if(!se)return m.unhover(O,b.event);z.xaxis.p2c=function(){return se[0]},z.yaxis.p2c=function(){return se[1]},n.hover(O,b.event,z.id)}),I.on("mouseout",function(){O._dragging||m.unhover(O,b.event)}),I.on("click",function(){F!=="select"&&F!=="lasso"&&(D.indexOf("select")>-1&&v(b.event,O,[z.xaxis],[z.yaxis],z.id,oe),D.indexOf("event")>-1&&n.click(O,b.event))})},f.makeFramework=function(){var S=this,R=S.graphDiv,z=R._fullLayout,O="clip"+z._uid+S.id;S.clipDef=z._clips.append("clipPath").attr("id",O),S.clipRect=S.clipDef.append("rect"),S.framework=b.select(S.container).append("g").attr("class","geo "+S.id).call(i.setClipUrl,O,R),S.project=function(I){var F=S.projection(I);return F?[F[0]-S.xaxis._offset,F[1]-S.yaxis._offset]:[null,null]},S.xaxis={_id:"x",c2p:function(I){return S.project(I)[0]}},S.yaxis={_id:"y",c2p:function(I){return S.project(I)[1]}},S.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},d.setConvert(S.mockAxis,z)},f.saveViewInitial=function(S){var R=S.center||{},z=S.projection,O=z.rotation||{};this.viewInitial={fitbounds:S.fitbounds,"projection.scale":z.scale};var I;S._isScoped?I={"center.lon":R.lon,"center.lat":R.lat}:S._isClipped?I={"projection.rotation.lon":O.lon,"projection.rotation.lat":O.lat}:I={"center.lon":R.lon,"center.lat":R.lat,"projection.rotation.lon":O.lon},g.extendFlat(this.viewInitial,I)},f.render=function(){var S=this.projection,R=S.getPath(),z;function O(F){var D=S(F.lonlat);return D?a(D[0],D[1]):null}function I(F){return S.isLonLatOverEdges(F.lonlat)?"none":null}for(z in this.basePaths)this.basePaths[z].attr("d",R);for(z in this.dataPaths)this.dataPaths[z].attr("d",function(F){return R(F.geojson)});for(z in this.dataPoints)this.dataPoints[z].attr("display",I).attr("transform",O)};function u(S){var R=S.projection,z=R.type,O=l.projNames[z];O="geo"+g.titleCase(O);for(var I=k[O]||e[O],F=I(),D=S._isSatellite?Math.acos(1/R.distance)*180/Math.PI:S._isClipped?l.lonaxisSpan[z]/2:null,B=["center","rotate","parallels","clipExtent"],U=function(se){return se?F:[]},X=0;X<B.length;X++){var oe=B[X];typeof F[oe]!="function"&&(F[oe]=U)}return F.isLonLatOverEdges=function(se){if(F(se)===null)return!0;if(D){var q=F.rotate(),K=E(se,[-q[0],-q[1]]),G=D*Math.PI/180;return K>G}else return!1},F.getPath=function(){return P().projection(F)},F.getBounds=function(se){return F.getPath().bounds(se)},F.precision(l.precision),S._isSatellite&&F.tilt(R.tilt).distance(R.distance),D&&F.clipAngle(D-l.clipPad),F}function h(S,R,z){var O=1e-6,I=2.5,F=R[S],D=l.scopeDefaults[R.scope],B,U,X;S==="lonaxis"?(B=D.lonaxisRange,U=D.lataxisRange,X=function(ee,J){return[ee,J]}):S==="lataxis"&&(B=D.lataxisRange,U=D.lonaxisRange,X=function(ee,J){return[J,ee]});var oe={type:"linear",range:[B[0],B[1]-O],tick0:F.tick0,dtick:F.dtick};d.setConvert(oe,z);var se=d.calcTicks(oe);!R.isScoped&&S==="lonaxis"&&se.pop();for(var q=se.length,K=new Array(q),G=0;G<q;G++)for(var Q=se[G].x,V=K[G]=[],H=U[0];H<U[1]+I;H+=I)V.push(X(Q,H));return{type:"MultiLineString",coordinates:K}}function o(S,R){var z=l.clipPad,O=S[0]+z,I=S[1]-z,F=R[0]+z,D=R[1]-z;O>0&&I<0&&(I+=360);var B=(I-O)/4;return{type:"Polygon",coordinates:[[[O,F],[O,D],[O+B,D],[O+2*B,D],[O+3*B,D],[I,D],[I,F],[I-B,F],[I-2*B,F],[I-3*B,F],[O,F]]]}}},{"../../components/color":366,"../../components/dragelement":385,"../../components/drawing":388,"../../components/fx":406,"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/topojson_utils":532,"../../registry":638,"../cartesian/autorange":553,"../cartesian/axes":554,"../cartesian/select":575,"../plots":619,"./constants":587,"./zoom":592,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":315}],589:[function(c,ae,ie){"use strict";var b=c("../../plots/get_data").getSubplotCalcData,k=c("../../lib").counterRegex,P=c("./geo"),E="geo",e=k(E),p={};p[E]={valType:"subplotid",dflt:E,editType:"calc"};function g(i){for(var n=i._fullLayout,r=i.calcdata,d=n._subplots[E],s=0;s<d.length;s++){var m=d[s],x=b(r,E,m),M=n[m],v=M._subplot;v||(v=P({id:m,graphDiv:i,container:n._geolayer.node(),topojsonURL:i._context.topojsonURL,staticPlot:i._context.staticPlot}),n[m]._subplot=v),v.plot(x,n,i._promises)}}function a(i,n,r,d){for(var s=d._subplots[E]||[],m=0;m<s.length;m++){var x=s[m],M=d[x]._subplot;!n[x]&&!!M&&(M.framework.remove(),M.clipDef.remove())}}function t(i){for(var n=i._fullLayout,r=n._subplots[E],d=0;d<r.length;d++){var s=n[r[d]],m=s._subplot;m.updateFx(n,s)}}ae.exports={attr:E,name:E,idRoot:E,idRegex:e,attrRegex:e,attributes:p,layoutAttributes:c("./layout_attributes"),supplyLayoutDefaults:c("./layout_defaults"),plot:g,updateFx:t,clean:a}},{"../../lib":503,"../../plots/get_data":593,"./geo":588,"./layout_attributes":590,"./layout_defaults":591}],590:[function(c,ae,ie){"use strict";var b=c("../../components/color/attributes"),k=c("../domain").attributes,P=c("./constants"),E=c("../../plot_api/edit_types").overrideAll,e=c("../../lib/sort_object_keys"),p={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:b.lightLine},gridwidth:{valType:"number",min:0,dflt:1}},g=ae.exports=E({domain:k({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:e(P.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:e(P.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:b.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:P.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:P.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:P.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:P.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:b.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:b.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:b.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:b.background},lonaxis:p,lataxis:p},"plot","from-root");g.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":365,"../../lib/sort_object_keys":526,"../../plot_api/edit_types":536,"../domain":584,"./constants":587}],591:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../subplot_defaults"),P=c("../get_data").getSubplotData,E=c("./constants"),e=c("./layout_attributes"),p=E.axesNames;ae.exports=function(t,i,n){k(t,i,n,{type:"geo",attributes:e,handleDefaults:g,fullData:n,partition:"y"})};function g(a,t,i,n){var r=P(n.fullData,"geo",n.id),d=r.map(function(V){return V._expandedIndex}),s=i("resolution"),m=i("scope"),x=E.scopeDefaults[m],M=i("projection.type",x.projType),v=t._isAlbersUsa=M==="albers usa";v&&(m=t.scope="usa");var _=t._isScoped=m!=="world",l=t._isSatellite=M==="satellite",y=t._isConic=M.indexOf("conic")!==-1||M==="albers",T=t._isClipped=!!E.lonaxisSpan[M];if(a.visible===!1){var w=b.extendDeep({},t._template);w.showcoastlines=!1,w.showcountries=!1,w.showframe=!1,w.showlakes=!1,w.showland=!1,w.showocean=!1,w.showrivers=!1,w.showsubunits=!1,w.lonaxis&&(w.lonaxis.showgrid=!1),w.lataxis&&(w.lataxis.showgrid=!1),t._template=w}for(var A=i("visible"),f,u=0;u<p.length;u++){var h=p[u],o=[30,10][u],S;if(_)S=x[h+"Range"];else{var R=E[h+"Span"],z=(R[M]||R["*"])/2,O=i("projection.rotation."+h.substr(0,3),x.projRotate[u]);S=[O-z,O+z]}var I=i(h+".range",S);i(h+".tick0"),i(h+".dtick",o),f=i(h+".showgrid",A?void 0:!1),f&&(i(h+".gridcolor"),i(h+".gridwidth")),t[h]._ax={type:"linear",_id:h.slice(0,3),_traceIndices:d,setScale:b.identity,c2l:b.identity,r2l:b.identity,autorange:!0,range:I.slice(),_m:1,_input:{}}}var F=t.lonaxis.range,D=t.lataxis.range,B=F[0],U=F[1];B>0&&U<0&&(U+=360);var X=(B+U)/2,oe;if(!v){var se=_?x.projRotate:[X,0,0];oe=i("projection.rotation.lon",se[0]),i("projection.rotation.lat",se[1]),i("projection.rotation.roll",se[2]),f=i("showcoastlines",!_&&A),f&&(i("coastlinecolor"),i("coastlinewidth")),f=i("showocean",A?void 0:!1),f&&i("oceancolor")}var q,K;if(v?(q=-96.6,K=38.7):(q=_?X:oe,K=(D[0]+D[1])/2),i("center.lon",q),i("center.lat",K),l&&(i("projection.tilt"),i("projection.distance")),y){var G=x.projParallels||[0,60];i("projection.parallels",G)}i("projection.scale"),f=i("showland",A?void 0:!1),f&&i("landcolor"),f=i("showlakes",A?void 0:!1),f&&i("lakecolor"),f=i("showrivers",A?void 0:!1),f&&(i("rivercolor"),i("riverwidth")),f=i("showcountries",_&&m!=="usa"&&A),f&&(i("countrycolor"),i("countrywidth")),(m==="usa"||m==="north america"&&s===50)&&(i("showsubunits",A),i("subunitcolor"),i("subunitwidth")),_||(f=i("showframe",A),f&&(i("framecolor"),i("framewidth"))),i("bgcolor");var Q=i("fitbounds");Q&&(delete t.projection.scale,_?(delete t.center.lon,delete t.center.lat):T?(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon,delete t.projection.rotation.lat,delete t.lonaxis.range,delete t.lataxis.range):(delete t.center.lon,delete t.center.lat,delete t.projection.rotation.lon))}},{"../../lib":503,"../get_data":593,"../subplot_defaults":632,"./constants":587,"./layout_attributes":590}],592:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../registry"),E=Math.PI/180,e=180/Math.PI,p={cursor:"pointer"},g={cursor:"auto"};function a(h,o){var S=h.projection,R;return o._isScoped?R=n:o._isClipped?R=d:R=r,R(h,S)}ae.exports=a;function t(h,o){return b.behavior.zoom().translate(o.translate()).scale(o.scale())}function i(h,o,S){var R=h.id,z=h.graphDiv,O=z.layout,I=O[R],F=z._fullLayout,D=F[R],B={},U={};function X(oe,se){B[R+"."+oe]=k.nestedProperty(I,oe).get(),P.call("_storeDirectGUIEdit",O,F._preGUI,B);var q=k.nestedProperty(D,oe);q.get()!==se&&(q.set(se),k.nestedProperty(I,oe).set(se),U[R+"."+oe]=se)}S(X),X("projection.scale",o.scale()/h.fitScale),X("fitbounds",!1),z.emit("plotly_relayout",U)}function n(h,o){var S=t(h,o);function R(){b.select(this).style(p)}function z(){o.scale(b.event.scale).translate(b.event.translate),h.render();var F=o.invert(h.midPt);h.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":o.scale()/h.fitScale,"geo.center.lon":F[0],"geo.center.lat":F[1]})}function O(F){var D=o.invert(h.midPt);F("center.lon",D[0]),F("center.lat",D[1])}function I(){b.select(this).style(g),i(h,o,O)}return S.on("zoomstart",R).on("zoom",z).on("zoomend",I),S}function r(h,o){var S=t(h,o),R=2,z,O,I,F,D,B,U,X,oe;function se(H){return o.invert(H)}function q(H){var ee=se(H);if(!ee)return!0;var J=o(ee);return Math.abs(J[0]-H[0])>R||Math.abs(J[1]-H[1])>R}function K(){b.select(this).style(p),z=b.mouse(this),O=o.rotate(),I=o.translate(),F=O,D=se(z)}function G(){if(B=b.mouse(this),q(z)){S.scale(o.scale()),S.translate(o.translate());return}o.scale(b.event.scale),o.translate([I[0],b.event.translate[1]]),D?se(B)&&(X=se(B),U=[F[0]+(X[0]-D[0]),O[1],O[2]],o.rotate(U),F=U):(z=B,D=se(z)),oe=!0,h.render();var H=o.rotate(),ee=o.invert(h.midPt);h.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":o.scale()/h.fitScale,"geo.center.lon":ee[0],"geo.center.lat":ee[1],"geo.projection.rotation.lon":-H[0]})}function Q(){b.select(this).style(g),oe&&i(h,o,V)}function V(H){var ee=o.rotate(),J=o.invert(h.midPt);H("projection.rotation.lon",-ee[0]),H("center.lon",J[0]),H("center.lat",J[1])}return S.on("zoomstart",K).on("zoom",G).on("zoomend",Q),S}function d(h,o){var S={r:o.rotate(),k:o.scale()},R=t(h,o),z=u(R,"zoomstart","zoom","zoomend"),O=0,I=R.on,F;R.on("zoomstart",function(){b.select(this).style(p);var oe=b.mouse(this),se=o.rotate(),q=se,K=o.translate(),G=m(se);F=s(o,oe),I.call(R,"zoom",function(){var Q=b.mouse(this);if(o.scale(S.k=b.event.scale),!F)oe=Q,F=s(o,oe);else if(s(o,Q)){o.rotate(se).translate(K);var V=s(o,Q),H=M(F,V),ee=T(x(G,H)),J=S.r=v(ee,F,q);(!isFinite(J[0])||!isFinite(J[1])||!isFinite(J[2]))&&(J=q),o.rotate(J),q=J}B(z.of(this,arguments))}),D(z.of(this,arguments))}).on("zoomend",function(){b.select(this).style(g),I.call(R,"zoom",null),U(z.of(this,arguments)),i(h,o,X)}).on("zoom.redraw",function(){h.render();var oe=o.rotate();h.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":o.scale()/h.fitScale,"geo.projection.rotation.lon":-oe[0],"geo.projection.rotation.lat":-oe[1]})});function D(oe){O++||oe({type:"zoomstart"})}function B(oe){oe({type:"zoom"})}function U(oe){--O||oe({type:"zoomend"})}function X(oe){var se=o.rotate();oe("projection.rotation.lon",-se[0]),oe("projection.rotation.lat",-se[1])}return b.rebind(R,z,"on")}function s(h,o){var S=h.invert(o);return S&&isFinite(S[0])&&isFinite(S[1])&&w(S)}function m(h){var o=.5*h[0]*E,S=.5*h[1]*E,R=.5*h[2]*E,z=Math.sin(o),O=Math.cos(o),I=Math.sin(S),F=Math.cos(S),D=Math.sin(R),B=Math.cos(R);return[O*F*B+z*I*D,z*F*B-O*I*D,O*I*B+z*F*D,O*F*D-z*I*B]}function x(h,o){var S=h[0],R=h[1],z=h[2],O=h[3],I=o[0],F=o[1],D=o[2],B=o[3];return[S*I-R*F-z*D-O*B,S*F+R*I+z*B-O*D,S*D-R*B+z*I+O*F,S*B+R*D-z*F+O*I]}function M(h,o){if(!(!h||!o)){var S=f(h,o),R=Math.sqrt(A(S,S)),z=.5*Math.acos(Math.max(-1,Math.min(1,A(h,o)))),O=Math.sin(z)/R;return R&&[Math.cos(z),S[2]*O,-S[1]*O,S[0]*O]}}function v(h,o,S){var R=y(o,2,h[0]);R=y(R,1,h[1]),R=y(R,0,h[2]-S[2]);var z=o[0],O=o[1],I=o[2],F=R[0],D=R[1],B=R[2],U=Math.atan2(O,z)*e,X=Math.sqrt(z*z+O*O),oe,se;Math.abs(D)>X?(se=(D>0?90:-90)-U,oe=0):(se=Math.asin(D/X)*e-U,oe=Math.sqrt(X*X-D*D));var q=180-se-2*U,K=(Math.atan2(B,F)-Math.atan2(I,oe))*e,G=(Math.atan2(B,F)-Math.atan2(I,-oe))*e,Q=_(S[0],S[1],se,K),V=_(S[0],S[1],q,G);return Q<=V?[se,K,S[2]]:[q,G,S[2]]}function _(h,o,S,R){var z=l(S-h),O=l(R-o);return Math.sqrt(z*z+O*O)}function l(h){return(h%360+540)%360-180}function y(h,o,S){var R=S*E,z=h.slice(),O=o===0?1:0,I=o===2?1:2,F=Math.cos(R),D=Math.sin(R);return z[O]=h[O]*F-h[I]*D,z[I]=h[I]*F+h[O]*D,z}function T(h){return[Math.atan2(2*(h[0]*h[1]+h[2]*h[3]),1-2*(h[1]*h[1]+h[2]*h[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(h[0]*h[2]-h[3]*h[1]))))*e,Math.atan2(2*(h[0]*h[3]+h[1]*h[2]),1-2*(h[2]*h[2]+h[3]*h[3]))*e]}function w(h){var o=h[0]*E,S=h[1]*E,R=Math.cos(S);return[R*Math.cos(o),R*Math.sin(o),Math.sin(S)]}function A(h,o){for(var S=0,R=0,z=h.length;R<z;++R)S+=h[R]*o[R];return S}function f(h,o){return[h[1]*o[2]-h[2]*o[1],h[2]*o[0]-h[0]*o[2],h[0]*o[1]-h[1]*o[0]]}function u(h){for(var o=0,S=arguments.length,R=[];++o<S;)R.push(arguments[o]);var z=b.dispatch.apply(null,R);return z.of=function(O,I){return function(F){var D;try{D=F.sourceEvent=b.event,F.target=h,b.event=F,z[F.type].apply(O,I)}finally{b.event=D}}},z}},{"../../lib":503,"../../registry":638,"@plotly/d3":58}],593:[function(c,ae,ie){"use strict";var b=c("../registry"),k=c("./cartesian/constants").SUBPLOT_PATTERN;ie.getSubplotCalcData=function(P,E,e){var p=b.subplotsRegistry[E];if(!p)return[];for(var g=p.attr,a=[],t=0;t<P.length;t++){var i=P[t],n=i[0].trace;n[g]===e&&a.push(i)}return a},ie.getModuleCalcData=function(P,E){var e=[],p=[],g;if(typeof E=="string"?g=b.getModule(E).plot:typeof E=="function"?g=E:g=E.plot,!g)return[e,P];for(var a=0;a<P.length;a++){var t=P[a],i=t[0].trace;i.visible!==!0||i._length===0||(i._module.plot===g?e.push(t):p.push(t))}return[e,p]},ie.getSubplotData=function(E,e,p){if(!b.subplotsRegistry[e])return[];var g=b.subplotsRegistry[e].attr,a=[],t,i,n;if(e==="gl2d"){var r=p.match(k);i="x"+r[1],n="y"+r[2]}for(var d=0;d<E.length;d++)t=E[d],e==="gl2d"&&b.traceIs(t,"gl2d")?t[g[0]]===i&&t[g[1]]===n&&a.push(t):t[g]===p&&a.push(t);return a}},{"../registry":638,"./cartesian/constants":561}],594:[function(c,ae,ie){"use strict";var b=c("mouse-change"),k=c("mouse-wheel"),P=c("mouse-event-offset"),E=c("../cartesian/constants"),e=c("has-passive-events");ae.exports=g;function p(a,t){this.element=a,this.plot=t,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}function g(a){var t=a.mouseContainer,i=a.glplot,n=new p(t,i);function r(){a.xaxis.autorange=!1,a.yaxis.autorange=!1}function d(){for(var m=a.graphDiv._fullLayout._axisConstraintGroups,x=a.xaxis._id,M=a.yaxis._id,v=0;v<m.length;v++)if(m[v][x]!==-1){if(m[v][M]!==-1)return!0;break}return!1}n.mouseListener=b(t,s),t.addEventListener("touchstart",function(m){var x=P(m.changedTouches[0],t);s(0,x[0],x[1]),s(1,x[0],x[1]),m.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchmove",function(m){m.preventDefault();var x=P(m.changedTouches[0],t);s(1,x[0],x[1]),m.preventDefault()},e?{passive:!1}:!1),t.addEventListener("touchend",function(m){s(0,n.lastPos[0],n.lastPos[1]),m.preventDefault()},e?{passive:!1}:!1);function s(m,x,M){var v=a.calcDataBox(),_=i.viewBox,l=n.lastPos[0],y=n.lastPos[1],T=E.MINDRAG*i.pixelRatio,w=E.MINZOOM*i.pixelRatio,A,f;x*=i.pixelRatio,M*=i.pixelRatio,M=_[3]-_[1]-M;function u(O,I,F){var D=Math.min(I,F),B=Math.max(I,F);D!==B?(v[O]=D,v[O+2]=B,n.dataBox=v,a.setRanges(v)):(a.selectBox.selectBox=[0,0,1,1],a.glplot.setDirty())}switch(a.fullLayout.dragmode){case"zoom":if(m){var h=x/(_[2]-_[0])*(v[2]-v[0])+v[0],o=M/(_[3]-_[1])*(v[3]-v[1])+v[1];n.boxInited||(n.boxStart[0]=h,n.boxStart[1]=o,n.dragStart[0]=x,n.dragStart[1]=M),n.boxEnd[0]=h,n.boxEnd[1]=o,n.boxInited=!0,!n.boxEnabled&&(n.boxStart[0]!==n.boxEnd[0]||n.boxStart[1]!==n.boxEnd[1])&&(n.boxEnabled=!0);var S=Math.abs(n.dragStart[0]-x)<w,R=Math.abs(n.dragStart[1]-M)<w;if(d()&&!(S&&R)){A=n.boxEnd[0]-n.boxStart[0],f=n.boxEnd[1]-n.boxStart[1];var z=(v[3]-v[1])/(v[2]-v[0]);Math.abs(A*z)>Math.abs(f)?(n.boxEnd[1]=n.boxStart[1]+Math.abs(A)*z*(f>=0?1:-1),n.boxEnd[1]<v[1]?(n.boxEnd[1]=v[1],n.boxEnd[0]=n.boxStart[0]+(v[1]-n.boxStart[1])/Math.abs(z)):n.boxEnd[1]>v[3]&&(n.boxEnd[1]=v[3],n.boxEnd[0]=n.boxStart[0]+(v[3]-n.boxStart[1])/Math.abs(z))):(n.boxEnd[0]=n.boxStart[0]+Math.abs(f)/z*(A>=0?1:-1),n.boxEnd[0]<v[0]?(n.boxEnd[0]=v[0],n.boxEnd[1]=n.boxStart[1]+(v[0]-n.boxStart[0])*Math.abs(z)):n.boxEnd[0]>v[2]&&(n.boxEnd[0]=v[2],n.boxEnd[1]=n.boxStart[1]+(v[2]-n.boxStart[0])*Math.abs(z)))}else S&&(n.boxEnd[0]=n.boxStart[0]),R&&(n.boxEnd[1]=n.boxStart[1])}else n.boxEnabled?(A=n.boxStart[0]!==n.boxEnd[0],f=n.boxStart[1]!==n.boxEnd[1],A||f?(A&&(u(0,n.boxStart[0],n.boxEnd[0]),a.xaxis.autorange=!1),f&&(u(1,n.boxStart[1],n.boxEnd[1]),a.yaxis.autorange=!1),a.relayoutCallback()):a.glplot.setDirty(),n.boxEnabled=!1,n.boxInited=!1):n.boxInited&&(n.boxInited=!1);break;case"pan":n.boxEnabled=!1,n.boxInited=!1,m?(n.panning||(n.dragStart[0]=x,n.dragStart[1]=M),Math.abs(n.dragStart[0]-x)<T&&(x=n.dragStart[0]),Math.abs(n.dragStart[1]-M)<T&&(M=n.dragStart[1]),A=(l-x)*(v[2]-v[0])/(i.viewBox[2]-i.viewBox[0]),f=(y-M)*(v[3]-v[1])/(i.viewBox[3]-i.viewBox[1]),v[0]+=A,v[2]+=A,v[1]+=f,v[3]+=f,a.setRanges(v),n.panning=!0,n.lastInputTime=Date.now(),r(),a.cameraChanged(),a.handleAnnotations()):n.panning&&(n.panning=!1,a.relayoutCallback());break}n.lastPos[0]=x,n.lastPos[1]=M}return n.wheelListener=k(t,function(m,x){if(!a.scrollZoom)return!1;var M=a.calcDataBox(),v=i.viewBox,_=n.lastPos[0],l=n.lastPos[1],y=Math.exp(5*x/(v[3]-v[1])),T=_/(v[2]-v[0])*(M[2]-M[0])+M[0],w=l/(v[3]-v[1])*(M[3]-M[1])+M[1];return M[0]=(M[0]-T)*y+T,M[2]=(M[2]-T)*y+T,M[1]=(M[1]-w)*y+w,M[3]=(M[3]-w)*y+w,a.setRanges(M),n.lastInputTime=Date.now(),r(),a.cameraChanged(),a.handleAnnotations(),a.relayoutCallback(),!0},!0),n}},{"../cartesian/constants":561,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],595:[function(c,ae,ie){"use strict";var b=c("../cartesian/axes"),k=c("../../lib/str2rgbarray");function P(g){this.scene=g,this.gl=g.gl,this.pixelRatio=g.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var E=P.prototype,e=["xaxis","yaxis"];E.merge=function(g){this.titleEnable=!1,this.backgroundColor=k(g.plot_bgcolor);var a,t,i,n,r,d,s,m,x,M,v;for(M=0;M<2;++M){a=e[M];var _=a.charAt(0);for(t=g[this.scene[a]._name],i=t.title.text===this.scene.fullLayout._dfltTitle[_]?"":t.title.text,v=0;v<=2;v+=2)this.labelEnable[M+v]=!1,this.labels[M+v]=i,this.labelColor[M+v]=k(t.title.font.color),this.labelFont[M+v]=t.title.font.family,this.labelSize[M+v]=t.title.font.size,this.labelPad[M+v]=this.getLabelPad(a,t),this.tickEnable[M+v]=!1,this.tickColor[M+v]=k((t.tickfont||{}).color),this.tickAngle[M+v]=t.tickangle==="auto"?0:Math.PI*-t.tickangle/180,this.tickPad[M+v]=this.getTickPad(t),this.tickMarkLength[M+v]=0,this.tickMarkWidth[M+v]=t.tickwidth||0,this.tickMarkColor[M+v]=k(t.tickcolor),this.borderLineEnable[M+v]=!1,this.borderLineColor[M+v]=k(t.linecolor),this.borderLineWidth[M+v]=t.linewidth||0;s=this.hasSharedAxis(t),r=this.hasAxisInDfltPos(a,t)&&!s,d=this.hasAxisInAltrPos(a,t)&&!s,n=t.mirror||!1,m=s?String(n).indexOf("all")!==-1:!!n,x=s?n==="allticks":String(n).indexOf("ticks")!==-1,r?this.labelEnable[M]=!0:d&&(this.labelEnable[M+2]=!0),r?this.tickEnable[M]=t.showticklabels:d&&(this.tickEnable[M+2]=t.showticklabels),(r||m)&&(this.borderLineEnable[M]=t.showline),(d||m)&&(this.borderLineEnable[M+2]=t.showline),(r||x)&&(this.tickMarkLength[M]=this.getTickMarkLength(t)),(d||x)&&(this.tickMarkLength[M+2]=this.getTickMarkLength(t)),this.gridLineEnable[M]=t.showgrid,this.gridLineColor[M]=k(t.gridcolor),this.gridLineWidth[M]=t.gridwidth,this.zeroLineEnable[M]=t.zeroline,this.zeroLineColor[M]=k(t.zerolinecolor),this.zeroLineWidth[M]=t.zerolinewidth}},E.hasSharedAxis=function(g){var a=this.scene,t=a.fullLayout._subplots.gl2d,i=b.findSubplotsWithAxis(t,g);return i.indexOf(a.id)!==0},E.hasAxisInDfltPos=function(g,a){var t=a.side;if(g==="xaxis")return t==="bottom";if(g==="yaxis")return t==="left"},E.hasAxisInAltrPos=function(g,a){var t=a.side;if(g==="xaxis")return t==="top";if(g==="yaxis")return t==="right"},E.getLabelPad=function(g,a){var t=1.5,i=a.title.font.size,n=a.showticklabels;if(g==="xaxis")return a.side==="top"?-10+i*(t+(n?1:0)):-10+i*(t+(n?.5:0));if(g==="yaxis")return a.side==="right"?10+i*(t+(n?1:.5)):10+i*(t+(n?.5:0))},E.getTickPad=function(g){return g.ticks==="outside"?10+g.ticklen:15},E.getTickMarkLength=function(g){if(!g.ticks)return 0;var a=g.ticklen;return g.ticks==="inside"?-a:a};function p(g){return new P(g)}ae.exports=p},{"../../lib/str2rgbarray":528,"../cartesian/axes":554}],596:[function(c,ae,ie){"use strict";var b=c("../../plot_api/edit_types").overrideAll,k=c("./scene2d"),P=c("../layout_attributes"),E=c("../../constants/xmlns_namespaces"),e=c("../cartesian/constants"),p=c("../cartesian"),g=c("../../components/fx/layout_attributes"),a=c("../get_data").getSubplotData;ie.name="gl2d",ie.attr=["xaxis","yaxis"],ie.idRoot=["x","y"],ie.idRegex=e.idRegex,ie.attrRegex=e.attrRegex,ie.attributes=c("../cartesian/attributes"),ie.supplyLayoutDefaults=function(t,i,n){i._has("cartesian")||p.supplyLayoutDefaults(t,i,n)},ie.layoutAttrOverrides=b(p.layoutAttributes,"plot","from-root"),ie.baseLayoutAttrOverrides=b({plot_bgcolor:P.plot_bgcolor,hoverlabel:g.hoverlabel},"plot","nested"),ie.plot=function(i){for(var n=i._fullLayout,r=i._fullData,d=n._subplots.gl2d,s=0;s<d.length;s++){var m=d[s],x=n._plots[m],M=a(r,"gl2d",m),v=x._scene2d;v===void 0&&(v=new k({id:m,graphDiv:i,container:i.querySelector(".gl-container"),staticPlot:i._context.staticPlot,plotGlPixelRatio:i._context.plotGlPixelRatio},n),x._scene2d=v),v.plot(M,i.calcdata,n,i.layout)}},ie.clean=function(t,i,n,r){for(var d=r._subplots.gl2d||[],s=0;s<d.length;s++){var m=d[s],x=r._plots[m];if(!!x._scene2d){var M=a(t,"gl2d",m);M.length===0&&(x._scene2d.destroy(),delete r._plots[m])}}p.clean.apply(this,arguments)},ie.drawFramework=function(t){t._context.staticPlot||p.drawFramework(t)},ie.toSVG=function(t){for(var i=t._fullLayout,n=i._subplots.gl2d,r=0;r<n.length;r++){var d=i._plots[n[r]],s=d._scene2d,m=s.toImage("png"),x=i._glimages.append("svg:image");x.attr({xmlns:E.svg,"xlink:href":m,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),s.destroy()}},ie.updateFx=function(t){for(var i=t._fullLayout,n=i._subplots.gl2d,r=0;r<n.length;r++){var d=i._plots[n[r]]._scene2d;d.updateFx(i.dragmode)}}},{"../../components/fx/layout_attributes":407,"../../constants/xmlns_namespaces":480,"../../plot_api/edit_types":536,"../cartesian":568,"../cartesian/attributes":552,"../cartesian/constants":561,"../get_data":593,"../layout_attributes":610,"./scene2d":597}],597:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../plots/cartesian/axes"),P=c("../../components/fx"),E=c("../../../stackgl_modules").gl_plot2d,e=c("../../../stackgl_modules").gl_spikes2d,p=c("../../../stackgl_modules").gl_select_box,g=c("webgl-context"),a=c("./convert"),t=c("./camera"),i=c("../../lib/show_no_webgl_msg"),n=c("../cartesian/constraints"),r=n.enforce,d=n.clean,s=c("../cartesian/autorange").doAutoRange,m=c("../../components/dragelement/helpers"),x=m.drawMode,M=m.selectMode,v=["xaxis","yaxis"],_,l,y=c("../cartesian/constants").SUBPLOT_PATTERN;function T(f,u){this.container=f.container,this.graphDiv=f.graphDiv,this.pixelRatio=f.plotGlPixelRatio||window.devicePixelRatio,this.id=f.id,this.staticPlot=!!f.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(u),this.makeFramework(),!this.stopped&&(this.glplotOptions=a(this),this.glplotOptions.merge(u),this.glplot=E(this.glplotOptions),this.camera=t(this),this.traces={},this.spikes=e(this.glplot),this.selectBox=p(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}ae.exports=T;var w=T.prototype;w.makeFramework=function(){if(this.staticPlot){if(!l&&(_=document.createElement("canvas"),l=g({canvas:_,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}),!l))throw new Error("Error creating static canvas/context for image server");this.canvas=_,this.gl=l}else{var f=this.container.querySelector(".gl-canvas-focus"),u=g({canvas:f,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!u){i(this),this.stopped=!0;return}this.canvas=f,this.gl=u}var h=this.canvas;h.style.width="100%",h.style.height="100%",h.style.position="absolute",h.style.top="0px",h.style.left="0px",h.style["pointer-events"]="none",this.updateSize(h);var o=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");o.style.position="absolute",o.style.top=o.style.left="0px",o.style.width=o.style.height="100%",o.style["z-index"]=20,o.style["pointer-events"]="none";var S=this.mouseContainer=document.createElement("div");S.style.position="absolute",S.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var R=this.container;R.appendChild(o),R.appendChild(S);var z=this;S.addEventListener("mouseout",function(){z.isMouseOver=!1,z.unhover()}),S.addEventListener("mouseover",function(){z.isMouseOver=!0})},w.toImage=function(f){f||(f="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(_),this.updateSize(this.canvas);var u=this.glplot.gl,h=u.drawingBufferWidth,o=u.drawingBufferHeight;u.clearColor(1,1,1,0),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),u.bindFramebuffer(u.FRAMEBUFFER,null);var S=new Uint8Array(h*o*4);u.readPixels(0,0,h,o,u.RGBA,u.UNSIGNED_BYTE,S);for(var R=0,z=o-1;R<z;++R,--z)for(var O=0;O<h;++O)for(var I=0;I<4;++I){var F=S[4*(h*R+O)+I];S[4*(h*R+O)+I]=S[4*(h*z+O)+I],S[4*(h*z+O)+I]=F}var D=document.createElement("canvas");D.width=h,D.height=o;var B=D.getContext("2d"),U=B.createImageData(h,o);U.data.set(S),B.putImageData(U,0,0);var X;switch(f){case"jpeg":X=D.toDataURL("image/jpeg");break;case"webp":X=D.toDataURL("image/webp");break;default:X=D.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(_),X},w.updateSize=function(f){f||(f=this.canvas);var u=this.pixelRatio,h=this.fullLayout,o=h.width,S=h.height,R=Math.ceil(u*o)|0,z=Math.ceil(u*S)|0;return(f.width!==R||f.height!==z)&&(f.width=R,f.height=z),f},w.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var f=[k.calcTicks(this.xaxis),k.calcTicks(this.yaxis)],u=0;u<2;++u)for(var h=0;h<f[u].length;++h)f[u][h].text=f[u][h].text+"";return f};function A(f,u){for(var h=0;h<2;++h){var o=f[h],S=u[h];if(o.length!==S.length)return!0;for(var R=0;R<o.length;++R)if(o[R].x!==S[R].x)return!0}return!1}w.updateRefs=function(f){this.fullLayout=f;var u=this.id.match(y),h="xaxis"+u[1],o="yaxis"+u[2];this.xaxis=this.fullLayout[h],this.yaxis=this.fullLayout[o]},w.relayoutCallback=function(){var f=this.graphDiv,u=this.xaxis,h=this.yaxis,o=f.layout,S={},R=S[u._name+".range"]=u.range.slice(),z=S[h._name+".range"]=h.range.slice();S[u._name+".autorange"]=u.autorange,S[h._name+".autorange"]=h.autorange,b.call("_storeDirectGUIEdit",f.layout,f._fullLayout._preGUI,S);var O=o[u._name];O.range=R,O.autorange=u.autorange;var I=o[h._name];I.range=z,I.autorange=h.autorange,S.lastInputTime=this.camera.lastInputTime,f.emit("plotly_relayout",S)},w.cameraChanged=function(){var f=this.camera;this.glplot.setDataBox(this.calcDataBox());var u=this.computeTickMarks(),h=this.glplotOptions.ticks;A(u,h)&&(this.glplotOptions.ticks=u,this.glplotOptions.dataBox=f.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},w.handleAnnotations=function(){for(var f=this.graphDiv,u=this.fullLayout.annotations,h=0;h<u.length;h++){var o=u[h];o.xref===this.xaxis._id&&o.yref===this.yaxis._id&&b.getComponentMethod("annotations","drawOne")(f,h)}},w.destroy=function(){if(!!this.glplot){var f=this.traces;f&&Object.keys(f).map(function(u){f[u].dispose(),delete f[u]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},w.plot=function(f,u,h){var o=this.glplot;this.updateRefs(h),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(f,u),this.updateFx(h.dragmode);var S=h.width,R=h.height;this.updateSize(this.canvas);var z=this.glplotOptions;z.merge(h),z.screenBox=[0,0,S,R];var O={_fullLayout:{_axisConstraintGroups:h._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:h._size}};d(O,this.xaxis),d(O,this.yaxis);var I=h._size,F=this.xaxis.domain,D=this.yaxis.domain;z.viewBox=[I.l+F[0]*I.w,I.b+D[0]*I.h,S-I.r-(1-F[1])*I.w,R-I.t-(1-D[1])*I.h],this.mouseContainer.style.width=I.w*(F[1]-F[0])+"px",this.mouseContainer.style.height=I.h*(D[1]-D[0])+"px",this.mouseContainer.height=I.h*(D[1]-D[0]),this.mouseContainer.style.left=I.l+F[0]*I.w+"px",this.mouseContainer.style.top=I.t+(1-D[1])*I.h+"px";var B,U;for(U=0;U<2;++U)B=this[v[U]],B._length=z.viewBox[U+2]-z.viewBox[U],s(this.graphDiv,B),B.setScale();r(O),z.ticks=this.computeTickMarks(),z.dataBox=this.calcDataBox(),z.merge(h),o.update(z),this.glplot.draw()},w.calcDataBox=function(){var f=this.xaxis,u=this.yaxis,h=f.range,o=u.range,S=f.r2l,R=u.r2l;return[S(h[0]),R(o[0]),S(h[1]),R(o[1])]},w.setRanges=function(f){var u=this.xaxis,h=this.yaxis,o=u.l2r,S=h.l2r;u.range=[o(f[0]),o(f[2])],h.range=[S(f[1]),S(f[3])]},w.updateTraces=function(f,u){var h=Object.keys(this.traces),o,S,R;this.fullData=f;e:for(o=0;o<h.length;o++){var z=h[o],O=this.traces[z];for(S=0;S<f.length;S++)if(R=f[S],R.uid===z&&R.type===O.type)continue e;O.dispose(),delete this.traces[z]}for(o=0;o<f.length;o++){R=f[o];var I=u[o],F=this.traces[R.uid];F?F.update(R,I):(F=R._module.plot(this,R,I),this.traces[R.uid]=F)}this.glplot.objects.sort(function(D,B){return D._trace.index-B._trace.index})},w.updateFx=function(f){M(f)||x(f)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),f==="pan"?this.mouseContainer.style.cursor="move":f==="zoom"?this.mouseContainer.style.cursor="crosshair":this.mouseContainer.style.cursor=null},w.emitPointAction=function(f,u){for(var h=f.trace.uid,o=f.pointIndex,S,R=0;R<this.fullData.length;R++)this.fullData[R].uid===h&&(S=this.fullData[R]);var z={x:f.traceCoord[0],y:f.traceCoord[1],curveNumber:S.index,pointNumber:o,data:S._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};P.appendArrayPointValue(z,S,o),this.graphDiv.emit(u,{points:[z]})},w.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var f=this.glplot,u=this.camera,h=u.mouseListener,o=this.lastButtonState===1&&h.buttons===0,S=this.fullLayout;this.lastButtonState=h.buttons,this.cameraChanged();var R=h.x*f.pixelRatio,z=this.canvas.height-f.pixelRatio*h.y,O;if(u.boxEnabled&&S.dragmode==="zoom"){this.selectBox.enabled=!0;for(var I=this.selectBox.selectBox=[Math.min(u.boxStart[0],u.boxEnd[0]),Math.min(u.boxStart[1],u.boxEnd[1]),Math.max(u.boxStart[0],u.boxEnd[0]),Math.max(u.boxStart[1],u.boxEnd[1])],F=0;F<2;F++)u.boxStart[F]===u.boxEnd[F]&&(I[F]=f.dataBox[F],I[F+2]=f.dataBox[F+2]);f.setDirty()}else if(!u.panning&&this.isMouseOver){this.selectBox.enabled=!1;var D=S._size,B=this.xaxis.domain,U=this.yaxis.domain;O=f.pick(R/f.pixelRatio+D.l+B[0]*D.w,z/f.pixelRatio-(D.t+(1-U[1])*D.h));var X=O&&O.object._trace.handlePick(O);if(X&&o&&this.emitPointAction(X,"plotly_click"),O&&O.object._trace.hoverinfo!=="skip"&&S.hovermode&&X&&(!this.lastPickResult||this.lastPickResult.traceUid!==X.trace.uid||this.lastPickResult.dataCoord[0]!==X.dataCoord[0]||this.lastPickResult.dataCoord[1]!==X.dataCoord[1])){var oe=X;this.lastPickResult={traceUid:X.trace?X.trace.uid:null,dataCoord:X.dataCoord.slice()},this.spikes.update({center:O.dataCoord}),oe.screenCoord=[((f.viewBox[2]-f.viewBox[0])*(O.dataCoord[0]-f.dataBox[0])/(f.dataBox[2]-f.dataBox[0])+f.viewBox[0])/f.pixelRatio,(this.canvas.height-(f.viewBox[3]-f.viewBox[1])*(O.dataCoord[1]-f.dataBox[1])/(f.dataBox[3]-f.dataBox[1])-f.viewBox[1])/f.pixelRatio],this.emitPointAction(X,"plotly_hover");var se=this.fullData[oe.trace.index]||{},q=oe.pointIndex,K=P.castHoverinfo(se,S,q);if(K&&K!=="all"){var G=K.split("+");G.indexOf("x")===-1&&(oe.traceCoord[0]=void 0),G.indexOf("y")===-1&&(oe.traceCoord[1]=void 0),G.indexOf("z")===-1&&(oe.traceCoord[2]=void 0),G.indexOf("text")===-1&&(oe.textLabel=void 0),G.indexOf("name")===-1&&(oe.name=void 0)}P.loneHover({x:oe.screenCoord[0],y:oe.screenCoord[1],xLabel:this.hoverFormatter("xaxis",oe.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",oe.traceCoord[1]),zLabel:oe.traceCoord[2],text:oe.textLabel,name:oe.name,color:P.castHoverOption(se,q,"bgcolor")||oe.color,borderColor:P.castHoverOption(se,q,"bordercolor"),fontFamily:P.castHoverOption(se,q,"font.family"),fontSize:P.castHoverOption(se,q,"font.size"),fontColor:P.castHoverOption(se,q,"font.color"),nameLength:P.castHoverOption(se,q,"namelength"),textAlign:P.castHoverOption(se,q,"align")},{container:this.svgContainer,gd:this.graphDiv})}}O||this.unhover(),f.draw()}},w.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),P.loneUnhover(this.svgContainer))},w.hoverFormatter=function(f,u){if(u!==void 0){var h=this[f];return k.tickText(h,h.c2l(u),"hover").text}}},{"../../../stackgl_modules":1124,"../../components/dragelement/helpers":384,"../../components/fx":406,"../../lib/show_no_webgl_msg":525,"../../plots/cartesian/axes":554,"../../registry":638,"../cartesian/autorange":553,"../cartesian/constants":561,"../cartesian/constraints":562,"./camera":594,"./convert":595,"webgl-context":331}],598:[function(c,ae,ie){"use strict";var b=c("../../plot_api/edit_types").overrideAll,k=c("../../components/fx/layout_attributes"),P=c("./scene"),E=c("../get_data").getSubplotData,e=c("../../lib"),p=c("../../constants/xmlns_namespaces"),g="gl3d",a="scene";ie.name=g,ie.attr=a,ie.idRoot=a,ie.idRegex=ie.attrRegex=e.counterRegex("scene"),ie.attributes=c("./layout/attributes"),ie.layoutAttributes=c("./layout/layout_attributes"),ie.baseLayoutAttrOverrides=b({hoverlabel:k.hoverlabel},"plot","nested"),ie.supplyLayoutDefaults=c("./layout/defaults"),ie.plot=function(i){for(var n=i._fullLayout,r=i._fullData,d=n._subplots[g],s=0;s<d.length;s++){var m=d[s],x=E(r,g,m),M=n[m],v=M.camera,_=M._scene;_||(_=new P({id:m,graphDiv:i,container:i.querySelector(".gl-container"),staticPlot:i._context.staticPlot,plotGlPixelRatio:i._context.plotGlPixelRatio,camera:v},n),M._scene=_),_.viewInitial||(_.viewInitial={up:{x:v.up.x,y:v.up.y,z:v.up.z},eye:{x:v.eye.x,y:v.eye.y,z:v.eye.z},center:{x:v.center.x,y:v.center.y,z:v.center.z}}),_.plot(x,n,i.layout)}},ie.clean=function(t,i,n,r){for(var d=r._subplots[g]||[],s=0;s<d.length;s++){var m=d[s];!i[m]&&!!r[m]._scene&&(r[m]._scene.destroy(),r._infolayer&&r._infolayer.selectAll(".annotation-"+m).remove())}},ie.toSVG=function(t){for(var i=t._fullLayout,n=i._subplots[g],r=i._size,d=0;d<n.length;d++){var s=i[n[d]],m=s.domain,x=s._scene,M=x.toImage("png"),v=i._glimages.append("svg:image");v.attr({xmlns:p.svg,"xlink:href":M,x:r.l+r.w*m.x[0],y:r.t+r.h*(1-m.y[1]),width:r.w*(m.x[1]-m.x[0]),height:r.h*(m.y[1]-m.y[0]),preserveAspectRatio:"none"}),x.destroy()}},ie.cleanId=function(i){if(!!i.match(/^scene[0-9]*$/)){var n=i.substr(5);return n==="1"&&(n=""),a+n}},ie.updateFx=function(t){for(var i=t._fullLayout,n=i._subplots[g],r=0;r<n.length;r++){var d=i[n[r]]._scene;d.updateFx(i.dragmode,i.hovermode)}}},{"../../components/fx/layout_attributes":407,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../plot_api/edit_types":536,"../get_data":593,"./layout/attributes":599,"./layout/defaults":603,"./layout/layout_attributes":604,"./scene":608}],599:[function(c,ae,ie){"use strict";ae.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],600:[function(c,ae,ie){"use strict";var b=c("../../../components/color"),k=c("../../cartesian/layout_attributes"),P=c("../../../lib/extend").extendFlat,E=c("../../../plot_api/edit_types").overrideAll;ae.exports=E({visible:k.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:b.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:k.color,categoryorder:k.categoryorder,categoryarray:k.categoryarray,title:{text:k.title.text,font:k.title.font},type:P({},k.type,{values:["-","linear","log","date","category"]}),autotypenumbers:k.autotypenumbers,autorange:k.autorange,rangemode:k.rangemode,range:P({},k.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:k.tickmode,nticks:k.nticks,tick0:k.tick0,dtick:k.dtick,tickvals:k.tickvals,ticktext:k.ticktext,ticks:k.ticks,mirror:k.mirror,ticklen:k.ticklen,tickwidth:k.tickwidth,tickcolor:k.tickcolor,showticklabels:k.showticklabels,tickfont:k.tickfont,tickangle:k.tickangle,tickprefix:k.tickprefix,showtickprefix:k.showtickprefix,ticksuffix:k.ticksuffix,showticksuffix:k.showticksuffix,showexponent:k.showexponent,exponentformat:k.exponentformat,minexponent:k.minexponent,separatethousands:k.separatethousands,tickformat:k.tickformat,tickformatstops:k.tickformatstops,hoverformat:k.hoverformat,showline:k.showline,linecolor:k.linecolor,linewidth:k.linewidth,showgrid:k.showgrid,gridcolor:P({},k.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:k.gridwidth,zeroline:k.zeroline,zerolinecolor:k.zerolinecolor,zerolinewidth:k.zerolinewidth,_deprecated:{title:k._deprecated.title,titlefont:k._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":366,"../../../lib/extend":493,"../../../plot_api/edit_types":536,"../../cartesian/layout_attributes":569}],601:[function(c,ae,ie){"use strict";var b=c("tinycolor2").mix,k=c("../../../lib"),P=c("../../../plot_api/plot_template"),E=c("./axis_attributes"),e=c("../../cartesian/type_defaults"),p=c("../../cartesian/axis_defaults"),g=["xaxis","yaxis","zaxis"],a=100*(204-68)/(255-68);ae.exports=function(i,n,r){var d,s;function m(v,_){return k.coerce(d,s,E,v,_)}for(var x=0;x<g.length;x++){var M=g[x];d=i[M]||{},s=P.newContainer(n,M),s._id=M[0]+r.scene,s._name=M,e(d,s,m,r),p(d,s,m,{font:r.font,letter:M[0],data:r.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:r.bgColor,calendar:r.calendar},r.fullLayout),m("gridcolor",b(s.color,r.bgColor,a).toRgbString()),m("title.text",M[0]),s.setScale=k.noop,m("showspikes")&&(m("spikesides"),m("spikethickness"),m("spikecolor",s.color)),m("showaxeslabels"),m("showbackground")&&m("backgroundcolor")}}},{"../../../lib":503,"../../../plot_api/plot_template":543,"../../cartesian/axis_defaults":556,"../../cartesian/type_defaults":582,"./axis_attributes":600,tinycolor2:312}],602:[function(c,ae,ie){"use strict";var b=c("../../../lib/str2rgbarray"),k=c("../../../lib"),P=["xaxis","yaxis","zaxis"];function E(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}var e=E.prototype;e.merge=function(g,a){for(var t=this,i=0;i<3;++i){var n=a[P[i]];if(!n.visible){t.tickEnable[i]=!1,t.labelEnable[i]=!1,t.lineEnable[i]=!1,t.lineTickEnable[i]=!1,t.gridEnable[i]=!1,t.zeroEnable[i]=!1,t.backgroundEnable[i]=!1;continue}t.labels[i]=g._meta?k.templateString(n.title.text,g._meta):n.title.text,"font"in n.title&&(n.title.font.color&&(t.labelColor[i]=b(n.title.font.color)),n.title.font.family&&(t.labelFont[i]=n.title.font.family),n.title.font.size&&(t.labelSize[i]=n.title.font.size)),"showline"in n&&(t.lineEnable[i]=n.showline),"linecolor"in n&&(t.lineColor[i]=b(n.linecolor)),"linewidth"in n&&(t.lineWidth[i]=n.linewidth),"showgrid"in n&&(t.gridEnable[i]=n.showgrid),"gridcolor"in n&&(t.gridColor[i]=b(n.gridcolor)),"gridwidth"in n&&(t.gridWidth[i]=n.gridwidth),n.type==="log"?t.zeroEnable[i]=!1:"zeroline"in n&&(t.zeroEnable[i]=n.zeroline),"zerolinecolor"in n&&(t.zeroLineColor[i]=b(n.zerolinecolor)),"zerolinewidth"in n&&(t.zeroLineWidth[i]=n.zerolinewidth),"ticks"in n&&!!n.ticks?t.lineTickEnable[i]=!0:t.lineTickEnable[i]=!1,"ticklen"in n&&(t.lineTickLength[i]=t._defaultLineTickLength[i]=n.ticklen),"tickcolor"in n&&(t.lineTickColor[i]=b(n.tickcolor)),"tickwidth"in n&&(t.lineTickWidth[i]=n.tickwidth),"tickangle"in n&&(t.tickAngle[i]=n.tickangle==="auto"?-3600:Math.PI*-n.tickangle/180),"showticklabels"in n&&(t.tickEnable[i]=n.showticklabels),"tickfont"in n&&(n.tickfont.color&&(t.tickColor[i]=b(n.tickfont.color)),n.tickfont.family&&(t.tickFont[i]=n.tickfont.family),n.tickfont.size&&(t.tickSize[i]=n.tickfont.size)),"mirror"in n?["ticks","all","allticks"].indexOf(n.mirror)!==-1?(t.lineTickMirror[i]=!0,t.lineMirror[i]=!0):n.mirror===!0?(t.lineTickMirror[i]=!1,t.lineMirror[i]=!0):(t.lineTickMirror[i]=!1,t.lineMirror[i]=!1):t.lineMirror[i]=!1,"showbackground"in n&&n.showbackground!==!1?(t.backgroundEnable[i]=!0,t.backgroundColor[i]=b(n.backgroundcolor)):t.backgroundEnable[i]=!1}};function p(g,a){var t=new E;return t.merge(g,a),t}ae.exports=p},{"../../../lib":503,"../../../lib/str2rgbarray":528}],603:[function(c,ae,ie){"use strict";var b=c("../../../lib"),k=c("../../../components/color"),P=c("../../../registry"),E=c("../../subplot_defaults"),e=c("./axis_defaults"),p=c("./layout_attributes"),g=c("../../get_data").getSubplotData,a="gl3d";ae.exports=function(n,r,d){var s=r._basePlotModules.length>1;function m(x){if(!s){var M=b.validate(n[x],p[x]);if(M)return n[x]}}E(n,r,d,{type:a,attributes:p,handleDefaults:t,fullLayout:r,font:r.font,fullData:d,getDfltFromLayout:m,autotypenumbersDflt:r.autotypenumbers,paper_bgcolor:r.paper_bgcolor,calendar:r.calendar})};function t(i,n,r,d){for(var s=r("bgcolor"),m=k.combine(s,d.paper_bgcolor),x=["up","center","eye"],M=0;M<x.length;M++)r("camera."+x[M]+".x"),r("camera."+x[M]+".y"),r("camera."+x[M]+".z");r("camera.projection.type");var v=!!r("aspectratio.x")&&!!r("aspectratio.y")&&!!r("aspectratio.z"),_=v?"manual":"auto",l=r("aspectmode",_);v||(i.aspectratio=n.aspectratio={x:1,y:1,z:1},l==="manual"&&(n.aspectmode="auto"),i.aspectmode=n.aspectmode);var y=g(d.fullData,a,d.id);e(i,n,{font:d.font,scene:d.id,data:y,bgColor:m,calendar:d.calendar,autotypenumbersDflt:d.autotypenumbersDflt,fullLayout:d.fullLayout}),P.getComponentMethod("annotations3d","handleDefaults")(i,n,d);var T=d.getDfltFromLayout("dragmode");if(T!==!1&&!T)if(T="orbit",i.camera&&i.camera.up){var w=i.camera.up.x,A=i.camera.up.y,f=i.camera.up.z;f!==0&&(!w||!A||!f||f/Math.sqrt(w*w+A*A+f*f)>.999)&&(T="turntable")}else T="turntable";r("dragmode",T),r("hovermode",d.getDfltFromLayout("hovermode"))}},{"../../../components/color":366,"../../../lib":503,"../../../registry":638,"../../get_data":593,"../../subplot_defaults":632,"./axis_defaults":601,"./layout_attributes":604}],604:[function(c,ae,ie){"use strict";var b=c("./axis_attributes"),k=c("../../domain").attributes,P=c("../../../lib/extend").extendFlat,E=c("../../../lib").counterRegex;function e(p,g,a){return{x:{valType:"number",dflt:p,editType:"camera"},y:{valType:"number",dflt:g,editType:"camera"},z:{valType:"number",dflt:a,editType:"camera"},editType:"camera"}}ae.exports={_arrayAttrRegexps:[E("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:P(e(0,0,1),{}),center:P(e(0,0,0),{}),eye:P(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:k({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:b,yaxis:b,zaxis:b,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":503,"../../../lib/extend":493,"../../domain":584,"./axis_attributes":600}],605:[function(c,ae,ie){"use strict";var b=c("../../../lib/str2rgbarray"),k=["xaxis","yaxis","zaxis"];function P(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}var E=P.prototype;E.merge=function(p){for(var g=0;g<3;++g){var a=p[k[g]];if(!a.visible){this.enabled[g]=!1,this.drawSides[g]=!1;continue}this.enabled[g]=a.showspikes,this.colors[g]=b(a.spikecolor),this.drawSides[g]=a.spikesides,this.lineWidth[g]=a.spikethickness}};function e(p){var g=new P;return g.merge(p),g}ae.exports=e},{"../../../lib/str2rgbarray":528}],606:[function(c,ae,ie){"use strict";ae.exports=p;var b=c("../../cartesian/axes"),k=c("../../../lib"),P=["xaxis","yaxis","zaxis"],E=[0,0,0];function e(g){for(var a=new Array(3),t=0;t<3;++t){for(var i=g[t],n=new Array(i.length),r=0;r<i.length;++r)n[r]=i[r].x;a[t]=n}return a}function p(g){for(var a=g.axesOptions,t=g.glplot.axesPixels,i=g.fullSceneLayout,n=[[],[],[]],r=0;r<3;++r){var d=i[P[r]];if(d._length=(t[r].hi-t[r].lo)*t[r].pixelsPerDataUnit/g.dataScale[r],Math.abs(d._length)===1/0||isNaN(d._length))n[r]=[];else{d._input_range=d.range.slice(),d.range[0]=t[r].lo/g.dataScale[r],d.range[1]=t[r].hi/g.dataScale[r],d._m=1/(g.dataScale[r]*t[r].pixelsPerDataUnit),d.range[0]===d.range[1]&&(d.range[0]-=1,d.range[1]+=1);var s=d.tickmode;if(d.tickmode==="auto"){d.tickmode="linear";var m=d.nticks||k.constrain(d._length/40,4,9);b.autoTicks(d,Math.abs(d.range[1]-d.range[0])/m)}for(var x=b.calcTicks(d,{msUTC:!0}),M=0;M<x.length;++M)x[M].x=x[M].x*g.dataScale[r],d.type==="date"&&(x[M].text=x[M].text.replace(/\<br\>/g," "));n[r]=x,d.tickmode=s}}a.ticks=n;for(var r=0;r<3;++r){E[r]=.5*(g.glplot.bounds[0][r]+g.glplot.bounds[1][r]);for(var M=0;M<2;++M)a.bounds[M][r]=g.glplot.bounds[M][r]}g.contourLevels=e(n)}},{"../../../lib":503,"../../cartesian/axes":554}],607:[function(c,ae,ie){"use strict";function b(P,E){var e=[0,0,0,0],p,g;for(p=0;p<4;++p)for(g=0;g<4;++g)e[g]+=P[4*p+g]*E[p];return e}function k(P,E){var e=b(P.projection,b(P.view,b(P.model,[E[0],E[1],E[2],1])));return e}ae.exports=k},{}],608:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_plot3d,k=b.createCamera,P=b.createScene,E=c("webgl-context"),e=c("has-passive-events"),p=c("../../registry"),g=c("../../lib"),a=g.preserveDrawingBuffer(),t=c("../../plots/cartesian/axes"),i=c("../../components/fx"),n=c("../../lib/str2rgbarray"),r=c("../../lib/show_no_webgl_msg"),d=c("./project"),s=c("./layout/convert"),m=c("./layout/spikes"),x=c("./layout/tick_marks"),M,v;function _(S,R){var z=document.createElement("div"),O=S.container;this.graphDiv=S.graphDiv;var I=document.createElementNS("http://www.w3.org/2000/svg","svg");I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",I.style["z-index"]=20,I.style["pointer-events"]="none",z.appendChild(I),this.svgContainer=I,z.id=S.id,z.style.position="absolute",z.style.top=z.style.left="0px",z.style.width=z.style.height="100%",O.appendChild(z),this.fullLayout=R,this.id=S.id||"scene",this.fullSceneLayout=R[this.id],this.plotArgs=[[],{},{}],this.axesOptions=s(R,R[this.id]),this.spikeOptions=m(R[this.id]),this.container=z,this.staticMode=!!S.staticPlot,this.pixelRatio=this.pixelRatio||S.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=p.getComponentMethod("annotations3d","convert"),this.drawAnnotations=p.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var l=_.prototype;l.prepareOptions=function(){var S=this,R={canvas:S.canvas,gl:S.gl,glOptions:{preserveDrawingBuffer:a,premultipliedAlpha:!0,antialias:!0},container:S.container,axes:S.axesOptions,spikes:S.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:S.camera,pixelRatio:S.pixelRatio};if(S.staticMode){if(!v&&(M=document.createElement("canvas"),v=E({canvas:M,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}),!v))throw new Error("error creating static canvas/context for image server");R.gl=v,R.canvas=M}return R};var y=!0;l.tryCreatePlot=function(){var S=this,R=S.prepareOptions(),z=!0;try{S.glplot=P(R)}catch{if(S.staticMode||!y||a)z=!1;else{g.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{a=R.glOptions.preserveDrawingBuffer=!0,S.glplot=P(R)}catch{a=R.glOptions.preserveDrawingBuffer=!1,z=!1}}}return y=!1,z},l.initializeGLCamera=function(){var S=this,R=S.fullSceneLayout.camera,z=R.projection.type==="orthographic";S.camera=k(S.container,{center:[R.center.x,R.center.y,R.center.z],eye:[R.eye.x,R.eye.y,R.eye.z],up:[R.up.x,R.up.y,R.up.z],_ortho:z,zoomMin:.01,zoomMax:100,mode:"orbit"})},l.initializeGLPlot=function(){var S=this;S.initializeGLCamera();var R=S.tryCreatePlot();if(!R)return r(S);S.traces={},S.make4thDimension();var z=S.graphDiv,O=z.layout,I=function(){var D={};return S.isCameraChanged(O)&&(D[S.id+".camera"]=S.getCamera()),S.isAspectChanged(O)&&(D[S.id+".aspectratio"]=S.glplot.getAspectratio(),O[S.id].aspectmode!=="manual"&&(S.fullSceneLayout.aspectmode=O[S.id].aspectmode=D[S.id+".aspectmode"]="manual")),D},F=function(D){if(D.fullSceneLayout.dragmode!==!1){var B=I();D.saveLayout(O),D.graphDiv.emit("plotly_relayout",B)}};return S.glplot.canvas&&(S.glplot.canvas.addEventListener("mouseup",function(){F(S)}),S.glplot.canvas.addEventListener("wheel",function(D){if(z._context._scrollZoom.gl3d){if(S.camera._ortho){var B=D.deltaX>D.deltaY?1.1:.9090909090909091,U=S.glplot.getAspectratio();S.glplot.setAspectratio({x:B*U.x,y:B*U.y,z:B*U.z})}F(S)}},e?{passive:!1}:!1),S.glplot.canvas.addEventListener("mousemove",function(){if(S.fullSceneLayout.dragmode!==!1&&S.camera.mouseListener.buttons!==0){var D=I();S.graphDiv.emit("plotly_relayouting",D)}}),S.staticMode||S.glplot.canvas.addEventListener("webglcontextlost",function(D){z&&z.emit&&z.emit("plotly_webglcontextlost",{event:D,layer:S.id})},!1)),S.glplot.oncontextloss=function(){S.recoverContext()},S.glplot.onrender=function(){S.render()},!0},l.render=function(){var S=this,R=S.graphDiv,z,O=S.svgContainer,I=S.container.getBoundingClientRect();R._fullLayout._calcInverseTransform(R);var F=R._fullLayout._invScaleX,D=R._fullLayout._invScaleY,B=I.width*F,U=I.height*D;O.setAttributeNS(null,"viewBox","0 0 "+B+" "+U),O.setAttributeNS(null,"width",B),O.setAttributeNS(null,"height",U),x(S),S.glplot.axes.update(S.axesOptions);for(var X=Object.keys(S.traces),oe=null,se=S.glplot.selection,q=0;q<X.length;++q)z=S.traces[X[q]],z.data.hoverinfo!=="skip"&&z.handlePick(se)&&(oe=z),z.setContourLevels&&z.setContourLevels();function K(ge,pe,xe){var Ee=S.fullSceneLayout[ge+"axis"];return Ee.type!=="log"&&(pe=Ee.d2l(pe)),t.hoverLabelText(Ee,pe,xe)}if(oe!==null){var G=d(S.glplot.cameraParams,se.dataCoordinate);z=oe.data;var Q=R._fullData[z.index],V=se.index,H={xLabel:K("x",se.traceCoordinate[0],z.xhoverformat),yLabel:K("y",se.traceCoordinate[1],z.yhoverformat),zLabel:K("z",se.traceCoordinate[2],z.zhoverformat)},ee=i.castHoverinfo(Q,S.fullLayout,V),J=(ee||"").split("+"),W=ee&&ee==="all";!Q.hovertemplate&&!W&&(J.indexOf("x")===-1&&(H.xLabel=void 0),J.indexOf("y")===-1&&(H.yLabel=void 0),J.indexOf("z")===-1&&(H.zLabel=void 0),J.indexOf("text")===-1&&(se.textLabel=void 0),J.indexOf("name")===-1&&(oe.name=void 0));var re,j=[];z.type==="cone"||z.type==="streamtube"?(H.uLabel=K("x",se.traceCoordinate[3],z.uhoverformat),(W||J.indexOf("u")!==-1)&&j.push("u: "+H.uLabel),H.vLabel=K("y",se.traceCoordinate[4],z.vhoverformat),(W||J.indexOf("v")!==-1)&&j.push("v: "+H.vLabel),H.wLabel=K("z",se.traceCoordinate[5],z.whoverformat),(W||J.indexOf("w")!==-1)&&j.push("w: "+H.wLabel),H.normLabel=se.traceCoordinate[6].toPrecision(3),(W||J.indexOf("norm")!==-1)&&j.push("norm: "+H.normLabel),z.type==="streamtube"&&(H.divergenceLabel=se.traceCoordinate[7].toPrecision(3),(W||J.indexOf("divergence")!==-1)&&j.push("divergence: "+H.divergenceLabel)),se.textLabel&&j.push(se.textLabel),re=j.join("<br>")):z.type==="isosurface"||z.type==="volume"?(H.valueLabel=t.hoverLabelText(S._mockAxis,S._mockAxis.d2l(se.traceCoordinate[3]),z.valuehoverformat),j.push("value: "+H.valueLabel),se.textLabel&&j.push(se.textLabel),re=j.join("<br>")):re=se.textLabel;var Z={x:se.traceCoordinate[0],y:se.traceCoordinate[1],z:se.traceCoordinate[2],data:Q._input,fullData:Q,curveNumber:Q.index,pointNumber:V};i.appendArrayPointValue(Z,Q,V),z._module.eventData&&(Z=Q._module.eventData(Z,se,Q,{},V));var ne={points:[Z]};if(S.fullSceneLayout.hovermode){var le=[];i.loneHover({trace:Q,x:(.5+.5*G[0]/G[3])*B,y:(.5-.5*G[1]/G[3])*U,xLabel:H.xLabel,yLabel:H.yLabel,zLabel:H.zLabel,text:re,name:oe.name,color:i.castHoverOption(Q,V,"bgcolor")||oe.color,borderColor:i.castHoverOption(Q,V,"bordercolor"),fontFamily:i.castHoverOption(Q,V,"font.family"),fontSize:i.castHoverOption(Q,V,"font.size"),fontColor:i.castHoverOption(Q,V,"font.color"),nameLength:i.castHoverOption(Q,V,"namelength"),textAlign:i.castHoverOption(Q,V,"align"),hovertemplate:g.castOption(Q,V,"hovertemplate"),hovertemplateLabels:g.extendFlat({},Z,H),eventData:[Z]},{container:O,gd:R,inOut_bbox:le}),Z.bbox=le[0]}se.buttons&&se.distance<5?R.emit("plotly_click",ne):R.emit("plotly_hover",ne),this.oldEventData=ne}else i.loneUnhover(O),this.oldEventData&&R.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;S.drawAnnotations(S)},l.recoverContext=function(){var S=this;S.glplot.dispose();var R=function(){if(S.glplot.gl.isContextLost()){requestAnimationFrame(R);return}if(!S.initializeGLPlot()){g.error("Catastrophic and unrecoverable WebGL error. Context lost.");return}S.plot.apply(S,S.plotArgs)};requestAnimationFrame(R)};var T=["xaxis","yaxis","zaxis"];function w(S,R,z){for(var O=S.fullSceneLayout,I=0;I<3;I++){var F=T[I],D=F.charAt(0),B=O[F],U=R[D],X=R[D+"calendar"],oe=R["_"+D+"length"];if(!g.isArrayOrTypedArray(U))z[0][I]=Math.min(z[0][I],0),z[1][I]=Math.max(z[1][I],oe-1);else for(var se,q=0;q<(oe||U.length);q++)if(g.isArrayOrTypedArray(U[q]))for(var K=0;K<U[q].length;++K)se=B.d2l(U[q][K],0,X),!isNaN(se)&&isFinite(se)&&(z[0][I]=Math.min(z[0][I],se),z[1][I]=Math.max(z[1][I],se));else se=B.d2l(U[q],0,X),!isNaN(se)&&isFinite(se)&&(z[0][I]=Math.min(z[0][I],se),z[1][I]=Math.max(z[1][I],se))}}function A(S,R){for(var z=S.fullSceneLayout,O=z.annotations||[],I=0;I<3;I++)for(var F=T[I],D=F.charAt(0),B=z[F],U=0;U<O.length;U++){var X=O[U];if(X.visible){var oe=B.r2l(X[D]);!isNaN(oe)&&isFinite(oe)&&(R[0][I]=Math.min(R[0][I],oe),R[1][I]=Math.max(R[1][I],oe))}}}l.plot=function(S,R,z){var O=this;if(O.plotArgs=[S,R,z],O.glplot.contextLost)return;var I,F,D,B,U,X,oe=R[O.id],se=z[O.id];O.fullLayout=R,O.fullSceneLayout=oe,O.axesOptions.merge(R,oe),O.spikeOptions.merge(oe),O.setViewport(oe),O.updateFx(oe.dragmode,oe.hovermode),O.camera.enableWheel=O.graphDiv._context._scrollZoom.gl3d,O.glplot.setClearColor(n(oe.bgcolor)),O.setConvert(U),S?Array.isArray(S)||(S=[S]):S=[];var q=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(D=0;D<S.length;++D)I=S[D],!(I.visible!==!0||I._length===0)&&w(this,I,q);A(this,q);var K=[1,1,1];for(B=0;B<3;++B)q[1][B]===q[0][B]?K[B]=1:K[B]=1/(q[1][B]-q[0][B]);for(O.dataScale=K,O.convertAnnotations(this),D=0;D<S.length;++D)I=S[D],!(I.visible!==!0||I._length===0)&&(F=O.traces[I.uid],F?F.data.type===I.type?F.update(I):(F.dispose(),F=I._module.plot(this,I),O.traces[I.uid]=F):(F=I._module.plot(this,I),O.traces[I.uid]=F),F.name=I.name);var G=Object.keys(O.traces);e:for(D=0;D<G.length;++D){for(B=0;B<S.length;++B)if(S[B].uid===G[D]&&S[B].visible===!0&&S[B]._length!==0)continue e;F=O.traces[G[D]],F.dispose(),delete O.traces[G[D]]}O.glplot.objects.sort(function(Oe,Qe){return Oe._trace.data.index-Qe._trace.data.index});var Q=[[0,0,0],[0,0,0]],V=[],H={};for(D=0;D<3;++D){if(U=oe[T[D]],X=U.type,X in H?(H[X].acc*=K[D],H[X].count+=1):H[X]={acc:K[D],count:1},U.autorange){Q[0][D]=1/0,Q[1][D]=-1/0;var ee=O.glplot.objects,J=O.fullSceneLayout.annotations||[],W=U._name.charAt(0);for(B=0;B<ee.length;B++){var re=ee[B],j=re.bounds,Z=re._trace.data._pad||0;re.constructor.name==="ErrorBars"&&U._lowerLogErrorBound?Q[0][D]=Math.min(Q[0][D],U._lowerLogErrorBound):Q[0][D]=Math.min(Q[0][D],j[0][D]/K[D]-Z),Q[1][D]=Math.max(Q[1][D],j[1][D]/K[D]+Z)}for(B=0;B<J.length;B++){var ne=J[B];if(ne.visible){var le=U.r2l(ne[W]);Q[0][D]=Math.min(Q[0][D],le),Q[1][D]=Math.max(Q[1][D],le)}}if("rangemode"in U&&U.rangemode==="tozero"&&(Q[0][D]=Math.min(Q[0][D],0),Q[1][D]=Math.max(Q[1][D],0)),Q[0][D]>Q[1][D])Q[0][D]=-1,Q[1][D]=1;else{var ge=Q[1][D]-Q[0][D];Q[0][D]-=ge/32,Q[1][D]+=ge/32}if(U.autorange==="reversed"){var pe=Q[0][D];Q[0][D]=Q[1][D],Q[1][D]=pe}}else{var xe=U.range;Q[0][D]=U.r2l(xe[0]),Q[1][D]=U.r2l(xe[1])}Q[0][D]===Q[1][D]&&(Q[0][D]-=1,Q[1][D]+=1),V[D]=Q[1][D]-Q[0][D],O.glplot.setBounds(D,{min:Q[0][D]*K[D],max:Q[1][D]*K[D]})}var Ee,Te=oe.aspectmode;if(Te==="cube")Ee=[1,1,1];else if(Te==="manual"){var de=oe.aspectratio;Ee=[de.x,de.y,de.z]}else if(Te==="auto"||Te==="data"){var be=[1,1,1];for(D=0;D<3;++D){U=oe[T[D]],X=U.type;var Le=H[X];be[D]=Math.pow(Le.acc,1/Le.count)/K[D]}Te==="data"||Math.max.apply(null,be)/Math.min.apply(null,be)<=4?Ee=be:Ee=[1,1,1]}else throw new Error("scene.js aspectRatio was not one of the enumerated types");oe.aspectratio.x=se.aspectratio.x=Ee[0],oe.aspectratio.y=se.aspectratio.y=Ee[1],oe.aspectratio.z=se.aspectratio.z=Ee[2],O.glplot.setAspectratio(oe.aspectratio),O.viewInitial.aspectratio||(O.viewInitial.aspectratio={x:oe.aspectratio.x,y:oe.aspectratio.y,z:oe.aspectratio.z}),O.viewInitial.aspectmode||(O.viewInitial.aspectmode=oe.aspectmode);var De=oe.domain||null,ye=R._size||null;if(De&&ye){var ke=O.container.style;ke.position="absolute",ke.left=ye.l+De.x[0]*ye.w+"px",ke.top=ye.t+(1-De.y[1])*ye.h+"px",ke.width=ye.w*(De.x[1]-De.x[0])+"px",ke.height=ye.h*(De.y[1]-De.y[0])+"px"}O.glplot.redraw()},l.destroy=function(){var S=this;!S.glplot||(S.camera.mouseListener.enabled=!1,S.container.removeEventListener("wheel",S.camera.wheelListener),S.camera=null,S.glplot.dispose(),S.container.parentNode.removeChild(S.container),S.glplot=null)};function f(S){return[[S.eye.x,S.eye.y,S.eye.z],[S.center.x,S.center.y,S.center.z],[S.up.x,S.up.y,S.up.z]]}function u(S){return{up:{x:S.up[0],y:S.up[1],z:S.up[2]},center:{x:S.center[0],y:S.center[1],z:S.center[2]},eye:{x:S.eye[0],y:S.eye[1],z:S.eye[2]},projection:{type:S._ortho===!0?"orthographic":"perspective"}}}l.getCamera=function(){var S=this;return S.camera.view.recalcMatrix(S.camera.view.lastT()),u(S.camera)},l.setViewport=function(S){var R=this,z=S.camera;R.camera.lookAt.apply(this,f(z)),R.glplot.setAspectratio(S.aspectratio);var O=z.projection.type==="orthographic",I=R.camera._ortho;O!==I&&(R.glplot.redraw(),R.glplot.clearRGBA(),R.glplot.dispose(),R.initializeGLPlot())},l.isCameraChanged=function(S){var R=this,z=R.getCamera(),O=g.nestedProperty(S,R.id+".camera"),I=O.get();function F(X,oe,se,q){var K=["up","center","eye"],G=["x","y","z"];return oe[K[se]]&&X[K[se]][G[q]]===oe[K[se]][G[q]]}var D=!1;if(I===void 0)D=!0;else{for(var B=0;B<3;B++)for(var U=0;U<3;U++)if(!F(z,I,B,U)){D=!0;break}(!I.projection||z.projection&&z.projection.type!==I.projection.type)&&(D=!0)}return D},l.isAspectChanged=function(S){var R=this,z=R.glplot.getAspectratio(),O=g.nestedProperty(S,R.id+".aspectratio"),I=O.get();return I===void 0||I.x!==z.x||I.y!==z.y||I.z!==z.z},l.saveLayout=function(S){var R=this,z=R.fullLayout,O,I,F,D,B,U,X=R.isCameraChanged(S),oe=R.isAspectChanged(S),se=X||oe;if(se){var q={};if(X&&(O=R.getCamera(),I=g.nestedProperty(S,R.id+".camera"),F=I.get(),q[R.id+".camera"]=F),oe&&(D=R.glplot.getAspectratio(),B=g.nestedProperty(S,R.id+".aspectratio"),U=B.get(),q[R.id+".aspectratio"]=U),p.call("_storeDirectGUIEdit",S,z._preGUI,q),X){I.set(O);var K=g.nestedProperty(z,R.id+".camera");K.set(O)}if(oe){B.set(D);var G=g.nestedProperty(z,R.id+".aspectratio");G.set(D),R.glplot.redraw()}}return se},l.updateFx=function(S,R){var z=this,O=z.camera;if(O)if(S==="orbit")O.mode="orbit",O.keyBindingMode="rotate";else if(S==="turntable"){O.up=[0,0,1],O.mode="turntable",O.keyBindingMode="rotate";var I=z.graphDiv,F=I._fullLayout,D=z.fullSceneLayout.camera,B=D.up.x,U=D.up.y,X=D.up.z;if(X/Math.sqrt(B*B+U*U+X*X)<.999){var oe=z.id+".camera.up",se={x:0,y:0,z:1},q={};q[oe]=se;var K=I.layout;p.call("_storeDirectGUIEdit",K,F._preGUI,q),D.up=se,g.nestedProperty(K,oe).set(se)}}else O.keyBindingMode=S;z.fullSceneLayout.hovermode=R};function h(S,R,z){for(var O=0,I=z-1;O<I;++O,--I)for(var F=0;F<R;++F)for(var D=0;D<4;++D){var B=4*(R*O+F)+D,U=4*(R*I+F)+D,X=S[B];S[B]=S[U],S[U]=X}}function o(S,R,z){for(var O=0;O<z;++O)for(var I=0;I<R;++I){var F=4*(R*O+I),D=S[F+3];if(D>0)for(var B=255/D,U=0;U<3;++U)S[F+U]=Math.min(B*S[F+U],255)}}l.toImage=function(S){var R=this;S||(S="png"),R.staticMode&&R.container.appendChild(M),R.glplot.redraw();var z=R.glplot.gl,O=z.drawingBufferWidth,I=z.drawingBufferHeight;z.bindFramebuffer(z.FRAMEBUFFER,null);var F=new Uint8Array(O*I*4);z.readPixels(0,0,O,I,z.RGBA,z.UNSIGNED_BYTE,F),h(F,O,I),o(F,O,I);var D=document.createElement("canvas");D.width=O,D.height=I;var B=D.getContext("2d"),U=B.createImageData(O,I);U.data.set(F),B.putImageData(U,0,0);var X;switch(S){case"jpeg":X=D.toDataURL("image/jpeg");break;case"webp":X=D.toDataURL("image/webp");break;default:X=D.toDataURL("image/png")}return R.staticMode&&R.container.removeChild(M),X},l.setConvert=function(){for(var S=this,R=0;R<3;R++){var z=S.fullSceneLayout[T[R]];t.setConvert(z,S.fullLayout),z.setScale=g.noop}},l.make4thDimension=function(){var S=this,R=S.graphDiv,z=R._fullLayout;S._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},t.setConvert(S._mockAxis,z)},ae.exports=_},{"../../../stackgl_modules":1124,"../../components/fx":406,"../../lib":503,"../../lib/show_no_webgl_msg":525,"../../lib/str2rgbarray":528,"../../plots/cartesian/axes":554,"../../registry":638,"./layout/convert":602,"./layout/spikes":605,"./layout/tick_marks":606,"./project":607,"has-passive-events":229,"webgl-context":331}],609:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e){e=e||k.length;for(var p=new Array(e),g=0;g<e;g++)p[g]=[k[g],P[g],E[g]];return p}},{}],610:[function(c,ae,ie){"use strict";var b=c("./font_attributes"),k=c("./animation_attributes"),P=c("../components/color/attributes"),E=c("../components/shapes/draw_newshape/attributes"),e=c("./pad_attributes"),p=c("../lib/extend").extendFlat,g=b({editType:"calc"});g.family.dflt='"Open Sans", verdana, arial, sans-serif',g.size.dflt=12,g.color.dflt=P.defaultLine,ae.exports={font:g,title:{text:{valType:"string",editType:"layoutstyle"},font:b({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:p(e({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:P.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:P.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:P.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:E.newshape,activeshape:E.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:p({},k.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:b({editType:"layoutstyle"})}}},{"../components/color/attributes":365,"../components/shapes/draw_newshape/attributes":451,"../lib/extend":493,"./animation_attributes":548,"./font_attributes":585,"./pad_attributes":618}],611:[function(c,ae,ie){"use strict";var b=c("../../lib/sort_object_keys"),k="1.10.1",P='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',E=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',P].join(" "),e=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),p=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),g={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:P,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:E,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:E,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:e,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:p,tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},a=b(g);ae.exports={requiredVersion:k,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:g,styleValuesNonMapbox:a,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+k+"."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",a.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":526}],612:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E){var e=P.split(" "),p=e[0],g=e[1],a=b.isArrayOrTypedArray(E)?b.mean(E):E,t=.5+a/100,i=1.5+a/100,n=["",""],r=[0,0];switch(p){case"top":n[0]="top",r[1]=-i;break;case"bottom":n[0]="bottom",r[1]=i;break}switch(g){case"left":n[1]="right",r[0]=-t;break;case"right":n[1]="left",r[0]=t;break}var d;return n[0]&&n[1]?d=n.join("-"):n[0]?d=n[0]:n[1]?d=n[1]:d="center",{anchor:d,offset:r}}},{"../../lib":503}],613:[function(c,ae,ie){"use strict";var b=c("mapbox-gl/dist/mapbox-gl-unminified"),k=c("../../lib"),P=k.strTranslate,E=k.strScale,e=c("../../plots/get_data").getSubplotCalcData,p=c("../../constants/xmlns_namespaces"),g=c("@plotly/d3"),a=c("../../components/drawing"),t=c("../../lib/svg_text_utils"),i=c("./mapbox"),n="mapbox",r=ie.constants=c("./constants");ie.name=n,ie.attr="subplot",ie.idRoot=n,ie.idRegex=ie.attrRegex=k.counterRegex(n),ie.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},ie.layoutAttributes=c("./layout_attributes"),ie.supplyLayoutDefaults=c("./layout_defaults"),ie.plot=function(x){var M=x._fullLayout,v=x.calcdata,_=M._subplots[n];if(b.version!==r.requiredVersion)throw new Error(r.wrongVersionErrorMsg);var l=d(x,_);b.accessToken=l;for(var y=0;y<_.length;y++){var T=_[y],w=e(v,n,T),A=M[T],f=A._subplot;f||(f=new i(x,T),M[T]._subplot=f),f.viewInitial||(f.viewInitial={center:k.extendFlat({},A.center),zoom:A.zoom,bearing:A.bearing,pitch:A.pitch}),f.plot(w,M,x._promises)}},ie.clean=function(m,x,M,v){for(var _=v._subplots[n]||[],l=0;l<_.length;l++){var y=_[l];!x[y]&&!!v[y]._subplot&&v[y]._subplot.destroy()}},ie.toSVG=function(m){for(var x=m._fullLayout,M=x._subplots[n],v=x._size,_=0;_<M.length;_++){var l=x[M[_]],y=l.domain,T=l._subplot,w=T.toImage("png"),A=x._glimages.append("svg:image");A.attr({xmlns:p.svg,"xlink:href":w,x:v.l+v.w*y.x[0],y:v.t+v.h*(1-y.y[1]),width:v.w*(y.x[1]-y.x[0]),height:v.h*(y.y[1]-y.y[0]),preserveAspectRatio:"none"});var f=g.select(l._subplot.div),u=f.select(".mapboxgl-ctrl-logo").node().offsetParent===null;if(!u){var h=x._glimages.append("g");h.attr("transform",P(v.l+v.w*y.x[0]+10,v.t+v.h*(1-y.y[0])-31)),h.append("path").attr("d",r.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),h.append("path").attr("d",r.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),h.append("path").attr("d",r.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),h.append("polygon").attr("points",r.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var o=f.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),S=x._glimages.append("g"),R=S.append("text");R.text(o).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":o});var z=a.bBox(R.node()),O=v.w*(y.x[1]-y.x[0]);if(z.width>O/2){var I=o.split("|").join("<br>");R.text(I).attr("data-unformatted",I).call(t.convertToTspans,m),z=a.bBox(R.node())}R.attr("transform",P(-3,-z.height+8)),S.insert("rect",".static-attribution").attr({x:-z.width-6,y:-z.height-3,width:z.width+6,height:z.height+3,fill:"rgba(255, 255, 255, 0.75)"});var F=1;z.width+6>O&&(F=O/(z.width+6));var D=[v.l+v.w*y.x[1],v.t+v.h*(1-y.y[0])];S.attr("transform",P(D[0],D[1])+E(F))}};function d(m,x){var M=m._fullLayout,v=m._context;if(v.mapboxAccessToken==="")return"";for(var _=[],l=[],y=!1,T=!1,w=0;w<x.length;w++){var A=M[x[w]],f=A.accesstoken;s(A.style)&&(f?k.pushUnique(_,f):(s(A._input.style)&&(k.error("Uses Mapbox map style, but did not set an access token."),y=!0),T=!0)),f&&k.pushUnique(l,f)}if(T){var u=y?r.noAccessTokenErrorMsg:r.missingStyleErrorMsg;throw k.error(u),new Error(u)}return _.length?(_.length>1&&k.warn(r.multipleTokensErrorMsg),_[0]):(l.length&&k.log(["Listed mapbox access token(s)",l.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}function s(m){return typeof m=="string"&&(r.styleValuesMapbox.indexOf(m)!==-1||m.indexOf("mapbox://")===0)}ie.updateFx=function(m){for(var x=m._fullLayout,M=x._subplots[n],v=0;v<M.length;v++){var _=x[M[v]]._subplot;_.updateFx(x)}}},{"../../components/drawing":388,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/get_data":593,"./constants":611,"./layout_attributes":615,"./layout_defaults":616,"./mapbox":617,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],614:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../lib/svg_text_utils").sanitizeHTML,P=c("./convert_text_opts"),E=c("./constants");function e(i,n){this.subplot=i,this.uid=i.uid+"-"+n,this.index=n,this.idSource="source-"+this.uid,this.idLayer=E.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var p=e.prototype;p.update=function(n){this.visible?this.needsNewImage(n)?this.updateImage(n):this.needsNewSource(n)?(this.removeLayer(),this.updateSource(n),this.updateLayer(n)):this.needsNewLayer(n)?this.updateLayer(n):this.updateStyle(n):(this.updateSource(n),this.updateLayer(n)),this.visible=g(n)},p.needsNewImage=function(i){var n=this.subplot.map;return n.getSource(this.idSource)&&this.sourceType==="image"&&i.sourcetype==="image"&&(this.source!==i.source||JSON.stringify(this.coordinates)!==JSON.stringify(i.coordinates))},p.needsNewSource=function(i){return this.sourceType!==i.sourcetype||JSON.stringify(this.source)!==JSON.stringify(i.source)||this.layerType!==i.type},p.needsNewLayer=function(i){return this.layerType!==i.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},p.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},p.updateImage=function(i){var n=this.subplot.map;n.getSource(this.idSource).updateImage({url:i.source,coordinates:i.coordinates});var r=this.findFollowingMapboxLayerId(this.lookupBelow());r!==null&&this.subplot.map.moveLayer(this.idLayer,r)},p.updateSource=function(i){var n=this.subplot.map;if(n.getSource(this.idSource)&&n.removeSource(this.idSource),this.sourceType=i.sourcetype,this.source=i.source,!!g(i)){var r=t(i);n.addSource(this.idSource,r)}},p.findFollowingMapboxLayerId=function(i){if(i==="traces")for(var n=this.subplot.getMapLayers(),r=0;r<n.length;r++){var d=n[r].id;if(typeof d=="string"&&d.indexOf(E.traceLayerPrefix)===0){i=d;break}}return i},p.updateLayer=function(i){var n=this.subplot,r=a(i),d=this.lookupBelow(),s=this.findFollowingMapboxLayerId(d);this.removeLayer(),g(i)&&n.addLayer({id:this.idLayer,source:this.idSource,"source-layer":i.sourcelayer||"",type:i.type,minzoom:i.minzoom,maxzoom:i.maxzoom,layout:r.layout,paint:r.paint},s),this.layerType=i.type,this.below=d},p.updateStyle=function(i){if(g(i)){var n=a(i);this.subplot.setOptions(this.idLayer,"setLayoutProperty",n.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",n.paint)}},p.removeLayer=function(){var i=this.subplot.map;i.getLayer(this.idLayer)&&i.removeLayer(this.idLayer)},p.dispose=function(){var i=this.subplot.map;i.getLayer(this.idLayer)&&i.removeLayer(this.idLayer),i.getSource(this.idSource)&&i.removeSource(this.idSource)};function g(i){if(!i.visible)return!1;var n=i.source;if(Array.isArray(n)&&n.length>0){for(var r=0;r<n.length;r++)if(typeof n[r]!="string"||n[r].length===0)return!1;return!0}return b.isPlainObject(n)||typeof n=="string"&&n.length>0}function a(i){var n={},r={};switch(i.type){case"circle":b.extendFlat(r,{"circle-radius":i.circle.radius,"circle-color":i.color,"circle-opacity":i.opacity});break;case"line":b.extendFlat(r,{"line-width":i.line.width,"line-color":i.color,"line-opacity":i.opacity,"line-dasharray":i.line.dash});break;case"fill":b.extendFlat(r,{"fill-color":i.color,"fill-outline-color":i.fill.outlinecolor,"fill-opacity":i.opacity});break;case"symbol":var d=i.symbol,s=P(d.textposition,d.iconsize);b.extendFlat(n,{"icon-image":d.icon+"-15","icon-size":d.iconsize/10,"text-field":d.text,"text-size":d.textfont.size,"text-anchor":s.anchor,"text-offset":s.offset,"symbol-placement":d.placement}),b.extendFlat(r,{"icon-color":i.color,"text-color":d.textfont.color,"text-opacity":i.opacity});break;case"raster":b.extendFlat(r,{"raster-fade-duration":0,"raster-opacity":i.opacity});break}return{layout:n,paint:r}}function t(i){var n=i.sourcetype,r=i.source,d={type:n},s;return n==="geojson"?s="data":n==="vector"?s=typeof r=="string"?"url":"tiles":n==="raster"?(s="tiles",d.tileSize=256):n==="image"&&(s="url",d.coordinates=i.coordinates),d[s]=r,i.sourceattribution&&(d.attribution=k(i.sourceattribution)),d}ae.exports=function(n,r,d){var s=new e(n,r);return s.update(d),s}},{"../../lib":503,"../../lib/svg_text_utils":529,"./constants":611,"./convert_text_opts":612}],615:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color").defaultLine,P=c("../domain").attributes,E=c("../font_attributes"),e=c("../../traces/scatter/attributes").textposition,p=c("../../plot_api/edit_types").overrideAll,g=c("../../plot_api/plot_template").templatedArray,a=c("./constants"),t=E({});t.family.dflt="Open Sans Regular, Arial Unicode MS Regular";var i=ae.exports=p({_arrayAttrRegexps:[b.counterRegex("mapbox",".layers",!0)],domain:P({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:a.styleValuesMapbox.concat(a.styleValuesNonMapbox),dflt:a.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:g("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:k},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:k}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:t,textposition:b.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root");i.uirevision={valType:"any",editType:"none"}},{"../../components/color":366,"../../lib":503,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../traces/scatter/attributes":927,"../domain":584,"../font_attributes":585,"./constants":611}],616:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../subplot_defaults"),P=c("../array_container_defaults"),E=c("./layout_attributes");ae.exports=function(a,t,i){k(a,t,i,{type:"mapbox",attributes:E,handleDefaults:e,partition:"y",accessToken:t._mapboxAccessToken})};function e(g,a,t,i){t("accesstoken",i.accessToken),t("style"),t("center.lon"),t("center.lat"),t("zoom"),t("bearing"),t("pitch"),P(g,a,{name:"layers",handleItemDefaults:p}),a._input=g}function p(g,a){function t(m,x){return b.coerce(g,a,E.layers,m,x)}var i=t("visible");if(i){var n=t("sourcetype"),r=n==="raster"||n==="image";t("source"),t("sourceattribution"),n==="vector"&&t("sourcelayer"),n==="image"&&t("coordinates");var d;r&&(d="raster");var s=t("type",d);r&&s!=="raster"&&(s=a.type="raster",b.log("Source types *raster* and *image* must drawn *raster* layer type.")),t("below"),t("color"),t("opacity"),t("minzoom"),t("maxzoom"),s==="circle"&&t("circle.radius"),s==="line"&&(t("line.width"),t("line.dash")),s==="fill"&&t("fill.outlinecolor"),s==="symbol"&&(t("symbol.icon"),t("symbol.iconsize"),t("symbol.text"),b.coerceFont(t,"symbol.textfont"),t("symbol.textposition"),t("symbol.placement"))}}},{"../../lib":503,"../array_container_defaults":549,"../subplot_defaults":632,"./layout_attributes":615}],617:[function(c,ae,ie){"use strict";var b=c("mapbox-gl/dist/mapbox-gl-unminified"),k=c("../../lib"),P=c("../../lib/geo_location_utils"),E=c("../../registry"),e=c("../cartesian/axes"),p=c("../../components/dragelement"),g=c("../../components/fx"),a=c("../../components/dragelement/helpers"),t=a.rectMode,i=a.drawMode,n=a.selectMode,r=c("../cartesian/select").prepSelect,d=c("../cartesian/select").clearSelect,s=c("../cartesian/select").clearSelectionsCache,m=c("../cartesian/select").selectOnClick,x=c("./constants"),M=c("./layers");function v(A,f){this.id=f,this.gd=A;var u=A._fullLayout,h=A._context;this.container=u._glcontainer.node(),this.isStatic=h.staticPlot,this.uid=u._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(u),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var _=v.prototype;_.plot=function(A,f,u){var h=this,o=f[h.id];h.map&&o.accesstoken!==h.accessToken&&(h.map.remove(),h.map=null,h.styleObj=null,h.traceHash={},h.layerList=[]);var S;h.map?S=new Promise(function(R,z){h.updateMap(A,f,R,z)}):S=new Promise(function(R,z){h.createMap(A,f,R,z)}),u.push(S)},_.createMap=function(A,f,u,h){var o=this,S=f[o.id],R=o.styleObj=y(S.style);o.accessToken=S.accesstoken;var z=o.map=new b.Map({container:o.div,style:R.style,center:w(S.center),zoom:S.zoom,bearing:S.bearing,pitch:S.pitch,interactive:!o.isStatic,preserveDrawingBuffer:o.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new b.AttributionControl({compact:!0}));z._canvas.style.left="0px",z._canvas.style.top="0px",o.rejectOnError(h),o.isStatic||o.initFx(A,f);var O=[];O.push(new Promise(function(I){z.once("load",I)})),O=O.concat(P.fetchTraceGeoData(A)),Promise.all(O).then(function(){o.fillBelowLookup(A,f),o.updateData(A),o.updateLayout(f),o.resolveOnRender(u)}).catch(h)},_.updateMap=function(A,f,u,h){var o=this,S=o.map,R=f[this.id];o.rejectOnError(h);var z=[],O=y(R.style);JSON.stringify(o.styleObj)!==JSON.stringify(O)&&(o.styleObj=O,S.setStyle(O.style),o.traceHash={},z.push(new Promise(function(I){S.once("styledata",I)}))),z=z.concat(P.fetchTraceGeoData(A)),Promise.all(z).then(function(){o.fillBelowLookup(A,f),o.updateData(A),o.updateLayout(f),o.resolveOnRender(u)}).catch(h)},_.fillBelowLookup=function(A,f){var u=f[this.id],h=u.layers,o,S,R=this.belowLookup={},z=!1;for(o=0;o<A.length;o++){var O=A[o][0].trace,I=O._module;typeof O.below=="string"?S=O.below:I.getBelow&&(S=I.getBelow(O,this)),S===""&&(z=!0),R["trace-"+O.uid]=S||""}for(o=0;o<h.length;o++){var F=h[o];typeof F.below=="string"?S=F.below:z?S="traces":S="",R["layout-"+o]=S}var D={},B,U;for(B in R)S=R[B],D[S]?D[S].push(B):D[S]=[B];for(S in D){var X=D[S];if(X.length>1)for(o=0;o<X.length;o++)B=X[o],B.indexOf("trace-")===0?(U=B.split("trace-")[1],this.traceHash[U]&&(this.traceHash[U].below=null)):B.indexOf("layout-")===0&&(U=B.split("layout-")[1],this.layerList[U]&&(this.layerList[U].below=null))}};var l={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};_.updateData=function(A){var f=this.traceHash,u,h,o,S,R=A.slice().sort(function(D,B){return l[D[0].trace.type]-l[B[0].trace.type]});for(o=0;o<R.length;o++){var z=R[o];h=z[0].trace,u=f[h.uid];var O=!1;u&&(u.type===h.type?(u.update(z),O=!0):u.dispose()),!O&&h._module&&(f[h.uid]=h._module.plot(this,z))}var I=Object.keys(f);e:for(o=0;o<I.length;o++){var F=I[o];for(S=0;S<A.length;S++)if(h=A[S][0].trace,F===h.uid)continue e;u=f[F],u.dispose(),delete f[F]}},_.updateLayout=function(A){var f=this.map,u=A[this.id];!this.dragging&&!this.wheeling&&(f.setCenter(w(u.center)),f.setZoom(u.zoom),f.setBearing(u.bearing),f.setPitch(u.pitch)),this.updateLayers(A),this.updateFramework(A),this.updateFx(A),this.map.resize(),this.gd._context._scrollZoom.mapbox?f.scrollZoom.enable():f.scrollZoom.disable()},_.resolveOnRender=function(A){var f=this.map;f.on("render",function u(){f.loaded()&&(f.off("render",u),setTimeout(A,10))})},_.rejectOnError=function(A){var f=this.map;function u(){A(new Error(x.mapOnErrorMsg))}f.once("error",u),f.once("style.error",u),f.once("source.error",u),f.once("tile.error",u),f.once("layer.error",u)},_.createFramework=function(A){var f=this,u=f.div=document.createElement("div");u.id=f.uid,u.style.position="absolute",f.container.appendChild(u),f.xaxis={_id:"x",c2p:function(h){return f.project(h).x}},f.yaxis={_id:"y",c2p:function(h){return f.project(h).y}},f.updateFramework(A),f.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(f.mockAxis,A)},_.initFx=function(A,f){var u=this,h=u.gd,o=u.map;o.on("moveend",function(z){if(!!u.map){var O=h._fullLayout;if(z.originalEvent||u.wheeling){var I=O[u.id];E.call("_storeDirectGUIEdit",h.layout,O._preGUI,u.getViewEdits(I));var F=u.getView();I._input.center=I.center=F.center,I._input.zoom=I.zoom=F.zoom,I._input.bearing=I.bearing=F.bearing,I._input.pitch=I.pitch=F.pitch,h.emit("plotly_relayout",u.getViewEditsWithDerived(F))}z.originalEvent&&z.originalEvent.type==="mouseup"?u.dragging=!1:u.wheeling&&(u.wheeling=!1),O._rehover&&O._rehover()}}),o.on("wheel",function(){u.wheeling=!0}),o.on("mousemove",function(z){var O=u.div.getBoundingClientRect(),I=[z.originalEvent.offsetX,z.originalEvent.offsetY];z.target.getBoundingClientRect=function(){return O},u.xaxis.p2c=function(){return o.unproject(I).lng},u.yaxis.p2c=function(){return o.unproject(I).lat},h._fullLayout._rehover=function(){h._fullLayout._hoversubplot===u.id&&h._fullLayout[u.id]&&g.hover(h,z,u.id)},g.hover(h,z,u.id),h._fullLayout._hoversubplot=u.id});function S(){g.loneUnhover(f._hoverlayer)}o.on("dragstart",function(){u.dragging=!0,S()}),o.on("zoomstart",S),o.on("mouseout",function(){h._fullLayout._hoversubplot=null});function R(){var z=u.getView();h.emit("plotly_relayouting",u.getViewEditsWithDerived(z))}o.on("drag",R),o.on("zoom",R),o.on("dblclick",function(){var z=h._fullLayout[u.id];E.call("_storeDirectGUIEdit",h.layout,h._fullLayout._preGUI,u.getViewEdits(z));var O=u.viewInitial;o.setCenter(w(O.center)),o.setZoom(O.zoom),o.setBearing(O.bearing),o.setPitch(O.pitch);var I=u.getView();z._input.center=z.center=I.center,z._input.zoom=z.zoom=I.zoom,z._input.bearing=z.bearing=I.bearing,z._input.pitch=z.pitch=I.pitch,h.emit("plotly_doubleclick",null),h.emit("plotly_relayout",u.getViewEditsWithDerived(I))}),u.clearSelect=function(){s(u.dragOptions),d(u.dragOptions.gd)},u.onClickInPanFn=function(z){return function(O){var I=h._fullLayout.clickmode;I.indexOf("select")>-1&&m(O.originalEvent,h,[u.xaxis],[u.yaxis],u.id,z),I.indexOf("event")>-1&&g.click(h,O.originalEvent)}}},_.updateFx=function(A){var f=this,u=f.map,h=f.gd;if(f.isStatic)return;function o(O){var I=f.map.unproject(O);return[I.lng,I.lat]}var S=A.dragmode,R;t(S)?R=function(O,I){var F=O.range={};F[f.id]=[o([I.xmin,I.ymin]),o([I.xmax,I.ymax])]}:R=function(O,I,F){var D=O.lassoPoints={};D[f.id]=F.filtered.map(o)};var z=f.dragOptions;f.dragOptions=k.extendDeep(z||{},{dragmode:A.dragmode,element:f.div,gd:h,plotinfo:{id:f.id,domain:A[f.id].domain,xaxis:f.xaxis,yaxis:f.yaxis,fillRangeItems:R},xaxes:[f.xaxis],yaxes:[f.yaxis],subplot:f.id}),u.off("click",f.onClickInPanHandler),n(S)||i(S)?(u.dragPan.disable(),u.on("zoomstart",f.clearSelect),f.dragOptions.prepFn=function(O,I,F){r(O,I,F,f.dragOptions,S)},p.init(f.dragOptions)):(u.dragPan.enable(),u.off("zoomstart",f.clearSelect),f.div.onmousedown=null,f.onClickInPanHandler=f.onClickInPanFn(f.dragOptions),u.on("click",f.onClickInPanHandler))},_.updateFramework=function(A){var f=A[this.id].domain,u=A._size,h=this.div.style;h.width=u.w*(f.x[1]-f.x[0])+"px",h.height=u.h*(f.y[1]-f.y[0])+"px",h.left=u.l+f.x[0]*u.w+"px",h.top=u.t+(1-f.y[1])*u.h+"px",this.xaxis._offset=u.l+f.x[0]*u.w,this.xaxis._length=u.w*(f.x[1]-f.x[0]),this.yaxis._offset=u.t+(1-f.y[1])*u.h,this.yaxis._length=u.h*(f.y[1]-f.y[0])},_.updateLayers=function(A){var f=A[this.id],u=f.layers,h=this.layerList,o;if(u.length!==h.length){for(o=0;o<h.length;o++)h[o].dispose();for(h=this.layerList=[],o=0;o<u.length;o++)h.push(M(this,o,u[o]))}else for(o=0;o<u.length;o++)h[o].update(u[o])},_.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},_.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},_.setOptions=function(A,f,u){for(var h in u)this.map[f](A,h,u[h])},_.getMapLayers=function(){return this.map.getStyle().layers},_.addLayer=function(A,f){var u=this.map;if(typeof f=="string"){if(f===""){u.addLayer(A,f);return}for(var h=this.getMapLayers(),o=0;o<h.length;o++)if(f===h[o].id){u.addLayer(A,f);return}k.warn(["Trying to add layer with *below* value",f,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}u.addLayer(A)},_.project=function(A){return this.map.project(new b.LngLat(A[0],A[1]))},_.getView=function(){var A=this.map,f=A.getCenter(),u=f.lng,h=f.lat,o={lon:u,lat:h},S=A.getCanvas(),R=parseInt(S.style.width),z=parseInt(S.style.height);return{center:o,zoom:A.getZoom(),bearing:A.getBearing(),pitch:A.getPitch(),_derived:{coordinates:[A.unproject([0,0]).toArray(),A.unproject([R,0]).toArray(),A.unproject([R,z]).toArray(),A.unproject([0,z]).toArray()]}}},_.getViewEdits=function(A){for(var f=this.id,u=["center","zoom","bearing","pitch"],h={},o=0;o<u.length;o++){var S=u[o];h[f+"."+S]=A[S]}return h},_.getViewEditsWithDerived=function(A){var f=this.id,u=this.getViewEdits(A);return u[f+"._derived"]=A._derived,u};function y(A){var f={};return k.isPlainObject(A)?(f.id=A.id,f.style=A):typeof A=="string"?(f.id=A,x.styleValuesMapbox.indexOf(A)!==-1?f.style=T(A):x.stylesNonMapbox[A]?f.style=x.stylesNonMapbox[A]:f.style=A):(f.id=x.styleValueDflt,f.style=T(x.styleValueDflt)),f.transition={duration:0,delay:0},f}function T(A){return x.styleUrlPrefix+A+"-"+x.styleUrlSuffix}function w(A){return[A.lon,A.lat]}ae.exports=v},{"../../components/dragelement":385,"../../components/dragelement/helpers":384,"../../components/fx":406,"../../lib":503,"../../lib/geo_location_utils":496,"../../registry":638,"../cartesian/axes":554,"../cartesian/select":575,"./constants":611,"./layers":614,"mapbox-gl/dist/mapbox-gl-unminified":239}],618:[function(c,ae,ie){"use strict";ae.exports=function(b){var k=b.editType;return{t:{valType:"number",dflt:0,editType:k},r:{valType:"number",dflt:0,editType:k},b:{valType:"number",dflt:0,editType:k},l:{valType:"number",dflt:0,editType:k},editType:k}}},{}],619:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("d3-time-format").timeFormatLocale,P=c("d3-format").formatLocale,E=c("fast-isnumeric"),e=c("../registry"),p=c("../plot_api/plot_schema"),g=c("../plot_api/plot_template"),a=c("../lib"),t=c("../components/color"),i=c("../constants/numerical").BADNUM,n=c("./cartesian/axis_ids"),r=c("./cartesian/handle_outline").clearSelect,d=c("./animation_attributes"),s=c("./frame_attributes"),m=c("../plots/get_data").getModuleCalcData,x=a.relinkPrivateKeys,M=a._,v=ae.exports={};a.extendFlat(v,e),v.attributes=c("./attributes"),v.attributes.type.values=v.allTypes,v.fontAttrs=c("./font_attributes"),v.layoutAttributes=c("./layout_attributes"),v.fontWeight="normal";var _=v.transformsRegistry,l=c("./command");v.executeAPICommand=l.executeAPICommand,v.computeAPICommandBindings=l.computeAPICommandBindings,v.manageCommandObserver=l.manageCommandObserver,v.hasSimpleAPICommandBindings=l.hasSimpleAPICommandBindings,v.redrawText=function(V){return V=a.getGraphDiv(V),new Promise(function(H){setTimeout(function(){!V._fullLayout||(e.getComponentMethod("annotations","draw")(V),e.getComponentMethod("legend","draw")(V),e.getComponentMethod("colorbar","draw")(V),H(v.previousPromises(V)))},300)})},v.resize=function(V){V=a.getGraphDiv(V);var H,ee=new Promise(function(J,W){(!V||a.isHidden(V))&&W(new Error("Resize must be passed a displayed plot div element.")),V._redrawTimer&&clearTimeout(V._redrawTimer),V._resolveResize&&(H=V._resolveResize),V._resolveResize=J,V._redrawTimer=setTimeout(function(){if(!V.layout||V.layout.width&&V.layout.height||a.isHidden(V)){J(V);return}delete V.layout.width,delete V.layout.height;var re=V.changed;V.autoplay=!0,e.call("relayout",V,{autosize:!0}).then(function(){V.changed=re,V._resolveResize===J&&(delete V._resolveResize,J(V))})},100)});return H&&H(ee),ee},v.previousPromises=function(V){if((V._promises||[]).length)return Promise.all(V._promises).then(function(){V._promises=[]})},v.addLinks=function(V){if(!(!V._context.showLink&&!V._context.showSources)){var H=V._fullLayout,ee=a.ensureSingle(H._paper,"text","js-plot-link-container",function(ne){ne.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:t.defaultLine,"pointer-events":"all"}).each(function(){var le=b.select(this);le.append("tspan").classed("js-link-to-tool",!0),le.append("tspan").classed("js-link-spacer",!0),le.append("tspan").classed("js-sourcelinks",!0)})}),J=ee.node(),W={y:H._paper.attr("height")-9};document.body.contains(J)&&J.getComputedTextLength()>=H.width-20?(W["text-anchor"]="start",W.x=5):(W["text-anchor"]="end",W.x=H._paper.attr("width")-7),ee.attr(W);var re=ee.select(".js-link-to-tool"),j=ee.select(".js-link-spacer"),Z=ee.select(".js-sourcelinks");V._context.showSources&&V._context.showSources(V),V._context.showLink&&y(V,re),j.text(re.text()&&Z.text()?" - ":"")}};function y(V,H){H.text("");var ee=H.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(V._context.linkText+" "+String.fromCharCode(187));if(V._context.sendData)ee.on("click",function(){v.sendDataToCloud(V)});else{var J=window.location.pathname.split("/"),W=window.location.search;ee.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+J[2].split(".")[0]+"/"+J[1]+W})}}v.sendDataToCloud=function(V){var H=(window.PLOTLYENV||{}).BASE_URL||V._context.plotlyServerURL;if(!!H){V.emit("plotly_beforeexport");var ee=b.select(V).append("div").attr("id","hiddenform").style("display","none"),J=ee.append("form").attr({action:H+"/external",method:"post",target:"_blank"}),W=J.append("input").attr({type:"text",name:"data"});return W.node().value=v.graphJson(V,!1,"keepdata"),J.node().submit(),ee.remove(),V.emit("plotly_afterexport"),!1}};var T=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],w=["year","month","dayMonth","dayMonthYear"];v.supplyDefaults=function(V,H){var ee=H&&H.skipUpdateCalc,J=V._fullLayout||{};if(J._skipDefaults){delete J._skipDefaults;return}var W=V._fullLayout={},re=V.layout||{},j=V._fullData||[],Z=V._fullData=[],ne=V.data||[],le=V.calcdata||[],ge=V._context||{},pe;V._transitionData||v.createTransitionData(V),W._dfltTitle={plot:M(V,"Click to enter Plot title"),x:M(V,"Click to enter X axis title"),y:M(V,"Click to enter Y axis title"),colorbar:M(V,"Click to enter Colorscale title"),annotation:M(V,"new text")},W._traceWord=M(V,"trace");var xe=u(V,T);if(W._mapboxAccessToken=ge.mapboxAccessToken,J._initialAutoSizeIsDone){var Ee=J.width,Te=J.height;v.supplyLayoutGlobalDefaults(re,W,xe),re.width||(W.width=Ee),re.height||(W.height=Te),v.sanitizeMargins(W)}else{v.supplyLayoutGlobalDefaults(re,W,xe);var de=!re.width||!re.height,be=W.autosize,Le=ge.autosizable,De=de&&(be||Le);De?v.plotAutoSize(V,re,W):de&&v.sanitizeMargins(W),!be&&de&&(re.width=W.width,re.height=W.height)}W._d3locale=h(xe,W.separators),W._extraFormat=u(V,w),W._initialAutoSizeIsDone=!0,W._dataLength=ne.length,W._modules=[],W._visibleModules=[],W._basePlotModules=[];var ye=W._subplots=f(),ke=W._splomAxes={x:{},y:{}},Oe=W._splomSubplots={};W._splomGridDflt={},W._scatterStackOpts={},W._firstScatter={},W._alignmentOpts={},W._colorAxes={},W._requestRangeslider={},W._traceUids=A(j,ne),W._globalTransforms=(V._context||{}).globalTransforms,v.supplyDataDefaults(ne,Z,re,W);var Qe=Object.keys(ke.x),Ve=Object.keys(ke.y);if(Qe.length>1&&Ve.length>1){for(e.getComponentMethod("grid","sizeDefaults")(re,W),pe=0;pe<Qe.length;pe++)a.pushUnique(ye.xaxis,Qe[pe]);for(pe=0;pe<Ve.length;pe++)a.pushUnique(ye.yaxis,Ve[pe]);for(var Ue in Oe)a.pushUnique(ye.cartesian,Ue)}if(W._has=v._hasPlotType.bind(W),j.length===Z.length)for(pe=0;pe<Z.length;pe++)x(Z[pe],j[pe]);v.supplyLayoutModuleDefaults(re,W,Z,V._transitionData);var Ie=W._visibleModules,at=[];for(pe=0;pe<Ie.length;pe++){var pt=Ie[pe].crossTraceDefaults;pt&&a.pushUnique(at,pt)}for(pe=0;pe<at.length;pe++)at[pe](Z,W);W._hasOnlyLargeSploms=W._basePlotModules.length===1&&W._basePlotModules[0].name==="splom"&&Qe.length>15&&Ve.length>15&&W.shapes.length===0&&W.images.length===0,v.linkSubplots(Z,W,j,J),v.cleanPlot(Z,W,j,J);var Rt=!!(J._has&&J._has("gl2d")),Mt=!!(W._has&&W._has("gl2d")),It=!!(J._has&&J._has("cartesian")),Bt=!!(W._has&&W._has("cartesian")),St=It||Rt,_t=Bt||Mt;St&&!_t?J._bgLayer.remove():_t&&!St&&(W._shouldCreateBgLayer=!0),J._zoomlayer&&!V._dragging&&r({_fullLayout:J}),o(Z,W),x(W,J),e.getComponentMethod("colorscale","crossTraceDefaults")(Z,W),W._preGUI||(W._preGUI={}),W._tracePreGUI||(W._tracePreGUI={});var it=W._tracePreGUI,ct={},et;for(et in it)ct[et]="old";for(pe=0;pe<Z.length;pe++)et=Z[pe]._fullInput.uid,ct[et]||(it[et]={}),ct[et]="new";for(et in ct)ct[et]==="old"&&delete it[et];I(W),e.getComponentMethod("rangeslider","makeData")(W),!ee&&le.length===Z.length&&v.supplyDefaultsUpdateCalc(le,Z)},v.supplyDefaultsUpdateCalc=function(V,H){for(var ee=0;ee<H.length;ee++){var J=H[ee],W=(V[ee]||[])[0];if(W&&W.trace){var re=W.trace;if(re._hasCalcTransform){var j=re._arrayAttrs,Z,ne,le;for(Z=0;Z<j.length;Z++)ne=j[Z],le=a.nestedProperty(re,ne).get().slice(),a.nestedProperty(J,ne).set(le)}W.trace=J}}};function A(V,H){var ee=H.length,J=[],W,re;for(W=0;W<V.length;W++){var j=V[W]._fullInput;j!==re&&J.push(j),re=j}var Z=J.length,ne=new Array(ee),le={};function ge(Ee,Te){ne[Te]=Ee,le[Ee]=1}function pe(Ee,Te){if(Ee&&typeof Ee=="string"&&!le[Ee])return ge(Ee,Te),!0}for(W=0;W<ee;W++){var xe=H[W].uid;typeof xe=="number"&&(xe=String(xe)),!pe(xe,W)&&(W<Z&&pe(J[W].uid,W)||ge(a.randstr(le),W))}return ne}function f(){var V=e.collectableSubplotTypes,H={},ee,J;if(!V){V=[];var W=e.subplotsRegistry;for(var re in W){var j=W[re],Z=j.attr;if(Z&&(V.push(re),Array.isArray(Z)))for(J=0;J<Z.length;J++)a.pushUnique(V,Z[J])}}for(ee=0;ee<V.length;ee++)H[V[ee]]=[];return H}function u(V,H){var ee=V._context.locale;ee||(ee="en-US");var J=!1,W={};function re(pe){for(var xe=!0,Ee=0;Ee<H.length;Ee++){var Te=H[Ee];W[Te]||(pe[Te]?W[Te]=pe[Te]:xe=!1)}xe&&(J=!0)}for(var j=0;j<2;j++){for(var Z=V._context.locales,ne=0;ne<2;ne++){var le=(Z[ee]||{}).format;if(le&&(re(le),J))break;Z=e.localeRegistry}var ge=ee.split("-")[0];if(J||ge===ee)break;ee=ge}return J||re(e.localeRegistry.en.format),W}function h(V,H){return V.decimal=H.charAt(0),V.thousands=H.charAt(1),{numberFormat:function(ee){try{ee=P(V).format(a.adjustFormat(ee))}catch{return a.warnBadFormat(ee),a.noFormat}return ee},timeFormat:k(V).utcFormat}}function o(V,H){var ee,J=[];H.meta&&(ee=H._meta={meta:H.meta,layout:{meta:H.meta}});for(var W=0;W<V.length;W++){var re=V[W];re.meta?J[re.index]=re._meta={meta:re.meta}:H.meta&&(re._meta={meta:H.meta}),H.meta&&(re._meta.layout={meta:H.meta})}J.length&&(ee||(ee=H._meta={}),ee.data=J)}v.createTransitionData=function(V){V._transitionData||(V._transitionData={}),V._transitionData._frames||(V._transitionData._frames=[]),V._transitionData._frameHash||(V._transitionData._frameHash={}),V._transitionData._counter||(V._transitionData._counter=0),V._transitionData._interruptCallbacks||(V._transitionData._interruptCallbacks=[])},v._hasPlotType=function(V){var H,ee=this._basePlotModules||[];for(H=0;H<ee.length;H++)if(ee[H].name===V)return!0;var J=this._modules||[];for(H=0;H<J.length;H++){var W=J[H].name;if(W===V)return!0;var re=e.modules[W];if(re&&re.categories[V])return!0}return!1},v.cleanPlot=function(V,H,ee,J){var W,re,j=J._basePlotModules||[];for(W=0;W<j.length;W++){var Z=j[W];Z.clean&&Z.clean(V,H,ee,J)}var ne=J._has&&J._has("gl"),le=H._has&&H._has("gl");ne&&!le&&J._glcontainer!==void 0&&(J._glcontainer.selectAll(".gl-canvas").remove(),J._glcontainer.selectAll(".no-webgl").remove(),J._glcanvas=null);var ge=!!J._infolayer;e:for(W=0;W<ee.length;W++){var pe=ee[W],xe=pe.uid;for(re=0;re<V.length;re++){var Ee=V[re];if(xe===Ee.uid)continue e}ge&&J._infolayer.select(".cb"+xe).remove()}},v.linkSubplots=function(V,H,ee,J){var W,re,j=J._plots||{},Z=H._plots={},ne=H._subplots,le={_fullData:V,_fullLayout:H},ge=ne.cartesian.concat(ne.gl2d||[]);for(W=0;W<ge.length;W++){var pe=ge[W],xe=j[pe],Ee=n.getFromId(le,pe,"x"),Te=n.getFromId(le,pe,"y"),de;for(xe?de=Z[pe]=xe:(de=Z[pe]={},de.id=pe),Ee._counterAxes.push(Te._id),Te._counterAxes.push(Ee._id),Ee._subplotsWith.push(pe),Te._subplotsWith.push(pe),de.xaxis=Ee,de.yaxis=Te,de._hasClipOnAxisFalse=!1,re=0;re<V.length;re++){var be=V[re];if(be.xaxis===de.xaxis._id&&be.yaxis===de.yaxis._id&&be.cliponaxis===!1){de._hasClipOnAxisFalse=!0;break}}}var Le=n.list(le,null,!0),De;for(W=0;W<Le.length;W++){De=Le[W];var ye=null;De.overlaying&&(ye=n.getFromId(le,De.overlaying),ye&&ye.overlaying&&(De.overlaying=!1,ye=null)),De._mainAxis=ye||De,ye&&(De.domain=ye.domain.slice()),De._anchorAxis=De.anchor==="free"?null:n.getFromId(le,De.anchor)}for(W=0;W<Le.length;W++)if(De=Le[W],De._counterAxes.sort(n.idSort),De._subplotsWith.sort(a.subplotSort),De._mainSubplot=S(De,H),De._counterAxes.length&&(De.spikemode&&De.spikemode.indexOf("across")!==-1||De.automargin&&De.mirror&&De.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(De))){var ke=1,Oe=0;for(re=0;re<De._counterAxes.length;re++){var Qe=n.getFromId(le,De._counterAxes[re]);ke=Math.min(ke,Qe.domain[0]),Oe=Math.max(Oe,Qe.domain[1])}ke<Oe&&(De._counterDomainMin=ke,De._counterDomainMax=Oe)}};function S(V,H){var ee={_fullLayout:H},J=V._id.charAt(0)==="x",W=V._mainAxis._anchorAxis,re="",j="",Z="";if(W&&(Z=W._mainAxis._id,re=J?V._id+Z:Z+V._id),!re||!H._plots[re]){re="";for(var ne=V._counterAxes,le=0;le<ne.length;le++){var ge=ne[le],pe=J?V._id+ge:ge+V._id;j||(j=pe);var xe=n.getFromId(ee,ge);if(Z&&xe.overlaying===Z){re=pe;break}}}return re||j}v.clearExpandedTraceDefaultColors=function(V){var H,ee,J;function W(j,Z,ne,le){ee[le]=Z,ee.length=le+1,j.valType==="color"&&j.dflt===void 0&&H.push(ee.join("."))}for(ee=[],H=V._module._colorAttrs,H||(V._module._colorAttrs=H=[],p.crawl(V._module.attributes,W)),J=0;J<H.length;J++){var re=a.nestedProperty(V,"_input."+H[J]);re.get()||a.nestedProperty(V,H[J]).set(null)}},v.supplyDataDefaults=function(V,H,ee,J){var W=J._modules,re=J._visibleModules,j=J._basePlotModules,Z=0,ne=0,le,ge,pe;J._transformModules=[];function xe(Ve){H.push(Ve);var Ue=Ve._module;!Ue||(a.pushUnique(W,Ue),Ve.visible===!0&&a.pushUnique(re,Ue),a.pushUnique(j,Ve._module.basePlotModule),Z++,Ve._input.visible!==!1&&ne++)}var Ee={},Te=[],de=(ee.template||{}).data||{},be=g.traceTemplater(de);for(le=0;le<V.length;le++){if(pe=V[le],ge=be.newTrace(pe),ge.uid=J._traceUids[le],v.supplyTraceDefaults(pe,ge,ne,J,le),ge.index=le,ge._input=pe,ge._expandedIndex=Z,ge.transforms&&ge.transforms.length)for(var Le=pe.visible!==!1&&ge.visible===!1,De=z(ge,H,ee,J),ye=0;ye<De.length;ye++){var ke=De[ye],Oe={_template:ge._template,type:ge.type,uid:ge.uid+ye};Le&&ke.visible===!1&&delete ke.visible,v.supplyTraceDefaults(ke,Oe,Z,J,le),x(Oe,ke),Oe.index=le,Oe._input=pe,Oe._fullInput=ge,Oe._expandedIndex=Z,Oe._expandedInput=ke,xe(Oe)}else ge._fullInput=ge,ge._expandedInput=ge,xe(ge);e.traceIs(ge,"carpetAxis")&&(Ee[ge.carpet]=ge),e.traceIs(ge,"carpetDependent")&&Te.push(le)}for(le=0;le<Te.length;le++)if(ge=H[Te[le]],!!ge.visible){var Qe=Ee[ge.carpet];if(ge._carpet=Qe,!Qe||!Qe.visible){ge.visible=!1;continue}ge.xaxis=Qe.xaxis,ge.yaxis=Qe.yaxis}},v.supplyAnimationDefaults=function(V){V=V||{};var H,ee={};function J(W,re){return a.coerce(V||{},ee,d,W,re)}if(J("mode"),J("direction"),J("fromcurrent"),Array.isArray(V.frame))for(ee.frame=[],H=0;H<V.frame.length;H++)ee.frame[H]=v.supplyAnimationFrameDefaults(V.frame[H]||{});else ee.frame=v.supplyAnimationFrameDefaults(V.frame||{});if(Array.isArray(V.transition))for(ee.transition=[],H=0;H<V.transition.length;H++)ee.transition[H]=v.supplyAnimationTransitionDefaults(V.transition[H]||{});else ee.transition=v.supplyAnimationTransitionDefaults(V.transition||{});return ee},v.supplyAnimationFrameDefaults=function(V){var H={};function ee(J,W){return a.coerce(V||{},H,d.frame,J,W)}return ee("duration"),ee("redraw"),H},v.supplyAnimationTransitionDefaults=function(V){var H={};function ee(J,W){return a.coerce(V||{},H,d.transition,J,W)}return ee("duration"),ee("easing"),H},v.supplyFrameDefaults=function(V){var H={};function ee(J,W){return a.coerce(V,H,s,J,W)}return ee("group"),ee("name"),ee("traces"),ee("baseframe"),ee("data"),ee("layout"),H},v.supplyTraceDefaults=function(V,H,ee,J,W){var re=J.colorway||t.defaults,j=re[ee%re.length],Z;function ne(De,ye){return a.coerce(V,H,v.attributes,De,ye)}var le=ne("visible");ne("type"),ne("name",J._traceWord+" "+W),ne("uirevision",J.uirevision);var ge=v.getModule(H);if(H._module=ge,ge){var pe=ge.basePlotModule,xe=pe.attr,Ee=pe.attributes;if(xe&&Ee){var Te=J._subplots,de="";if(le||pe.name!=="gl2d"){if(Array.isArray(xe))for(Z=0;Z<xe.length;Z++){var be=xe[Z],Le=a.coerce(V,H,Ee,be);Te[be]&&a.pushUnique(Te[be],Le),de+=Le}else de=a.coerce(V,H,Ee,xe);Te[pe.name]&&a.pushUnique(Te[pe.name],de)}}}return le&&(ne("customdata"),ne("ids"),ne("meta"),e.traceIs(H,"showLegend")?(a.coerce(V,H,ge.attributes.showlegend?ge.attributes:v.attributes,"showlegend"),ne("legendgroup"),ne("legendgrouptitle.text"),ne("legendrank"),H._dfltShowLegend=!0):H._dfltShowLegend=!1,ge&&ge.supplyDefaults(V,H,j,J),e.traceIs(H,"noOpacity")||ne("opacity"),e.traceIs(H,"notLegendIsolatable")&&(H.visible=!!H.visible),e.traceIs(H,"noHover")||(H.hovertemplate||a.coerceHoverinfo(V,H,J),H.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(V,H,j,J)),ge&&ge.selectPoints&&ne("selectedpoints"),v.supplyTransformDefaults(V,H,J)),H};function R(V){var H=V.transforms;if(Array.isArray(H)&&H.length)for(var ee=0;ee<H.length;ee++){var J=H[ee],W=J._module||_[J.type];if(W&&W.makesData)return!0}return!1}v.hasMakesDataTransform=R,v.supplyTransformDefaults=function(V,H,ee){if(!!(H._length||R(V))){var J=ee._globalTransforms||[],W=ee._transformModules||[];if(!(!Array.isArray(V.transforms)&&J.length===0))for(var re=V.transforms||[],j=J.concat(re),Z=H.transforms=[],ne=0;ne<j.length;ne++){var le=j[ne],ge=le.type,pe=_[ge],xe,Ee=!(le._module&&le._module===pe),Te=pe&&typeof pe.transform=="function";pe||a.warn("Unrecognized transform type "+ge+"."),pe&&pe.supplyDefaults&&(Ee||Te)?(xe=pe.supplyDefaults(le,H,ee,V),xe.type=ge,xe._module=pe,a.pushUnique(W,pe)):xe=a.extendFlat({},le),Z.push(xe)}}};function z(V,H,ee,J){for(var W=V.transforms,re=[V],j=0;j<W.length;j++){var Z=W[j],ne=_[Z.type];ne&&ne.transform&&(re=ne.transform(re,{transform:Z,fullTrace:V,fullData:H,layout:ee,fullLayout:J,transformIndex:j}))}return re}v.supplyLayoutGlobalDefaults=function(V,H,ee){function J(le,ge){return a.coerce(V,H,v.layoutAttributes,le,ge)}var W=V.template;a.isPlainObject(W)&&(H.template=W,H._template=W.layout,H._dataTemplate=W.data),J("autotypenumbers");var re=a.coerceFont(J,"font"),j=re.size;a.coerceFont(J,"title.font",a.extendFlat({},re,{size:Math.round(j*1.4)})),J("title.text",H._dfltTitle.plot),J("title.xref"),J("title.yref"),J("title.x"),J("title.y"),J("title.xanchor"),J("title.yanchor"),J("title.pad.t"),J("title.pad.r"),J("title.pad.b"),J("title.pad.l");var Z=J("uniformtext.mode");Z&&J("uniformtext.minsize"),J("autosize",!(V.width&&V.height)),J("width"),J("height"),J("margin.l"),J("margin.r"),J("margin.t"),J("margin.b"),J("margin.pad"),J("margin.autoexpand"),V.width&&V.height&&v.sanitizeMargins(H),e.getComponentMethod("grid","sizeDefaults")(V,H),J("paper_bgcolor"),J("separators",ee.decimal+ee.thousands),J("hidesources"),J("colorway"),J("datarevision");var ne=J("uirevision");J("editrevision",ne),J("selectionrevision",ne),e.getComponentMethod("modebar","supplyLayoutDefaults")(V,H),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(V,H,J),J("meta"),a.isPlainObject(V.transition)&&(J("transition.duration"),J("transition.easing"),J("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(V,H,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(V,H,J)};function O(V){return typeof V=="string"&&V.substr(V.length-2)==="px"&&parseFloat(V)}v.plotAutoSize=function(H,ee,J){var W=H._context||{},re=W.frameMargins,j,Z,ne=a.isPlotDiv(H);if(ne&&H.emit("plotly_autosize"),W.fillFrame)j=window.innerWidth,Z=window.innerHeight,document.body.style.overflow="hidden";else{var le=ne?window.getComputedStyle(H):{};if(j=O(le.width)||O(le.maxWidth)||J.width,Z=O(le.height)||O(le.maxHeight)||J.height,E(re)&&re>0){var ge=1-2*re;j=Math.round(ge*j),Z=Math.round(ge*Z)}}var pe=v.layoutAttributes.width.min,xe=v.layoutAttributes.height.min;j<pe&&(j=pe),Z<xe&&(Z=xe);var Ee=!ee.width&&Math.abs(J.width-j)>1,Te=!ee.height&&Math.abs(J.height-Z)>1;(Te||Ee)&&(Ee&&(J.width=j),Te&&(J.height=Z)),H._initialAutoSize||(H._initialAutoSize={width:j,height:Z}),v.sanitizeMargins(J)},v.supplyLayoutModuleDefaults=function(V,H,ee,J){var W=e.componentsRegistry,re=H._basePlotModules,j,Z,ne,le=e.subplotsRegistry.cartesian;for(j in W)ne=W[j],ne.includeBasePlot&&ne.includeBasePlot(V,H);re.length||re.push(le),H._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(V,H),le.finalizeSubplots(V,H));for(var ge in H._subplots)H._subplots[ge].sort(a.subplotSort);for(Z=0;Z<re.length;Z++)ne=re[Z],ne.supplyLayoutDefaults&&ne.supplyLayoutDefaults(V,H,ee);var pe=H._modules;for(Z=0;Z<pe.length;Z++)ne=pe[Z],ne.supplyLayoutDefaults&&ne.supplyLayoutDefaults(V,H,ee);var xe=H._transformModules;for(Z=0;Z<xe.length;Z++)ne=xe[Z],ne.supplyLayoutDefaults&&ne.supplyLayoutDefaults(V,H,ee,J);for(j in W)ne=W[j],ne.supplyLayoutDefaults&&ne.supplyLayoutDefaults(V,H,ee)},v.purge=function(V){var H=V._fullLayout||{};H._glcontainer!==void 0&&(H._glcontainer.selectAll(".gl-canvas").remove(),H._glcontainer.remove(),H._glcanvas=null),H._modeBar&&H._modeBar.destroy(),V._transitionData&&(V._transitionData._interruptCallbacks&&(V._transitionData._interruptCallbacks.length=0),V._transitionData._animationRaf&&window.cancelAnimationFrame(V._transitionData._animationRaf)),a.clearThrottle(),a.clearResponsive(V),delete V.data,delete V.layout,delete V._fullData,delete V._fullLayout,delete V.calcdata,delete V.empty,delete V.fid,delete V.undoqueue,delete V.undonum,delete V.autoplay,delete V.changed,delete V._promises,delete V._redrawTimer,delete V._hmlumcount,delete V._hmpixcount,delete V._transitionData,delete V._transitioning,delete V._initialAutoSize,delete V._transitioningWithDuration,delete V._dragging,delete V._dragged,delete V._dragdata,delete V._hoverdata,delete V._snapshotInProgress,delete V._editing,delete V._mouseDownTime,delete V._legendMouseDownTime,V.removeAllListeners&&V.removeAllListeners()},v.style=function(V){var H=V._fullLayout._visibleModules,ee=[],J;for(J=0;J<H.length;J++){var W=H[J];W.style&&a.pushUnique(ee,W.style)}for(J=0;J<ee.length;J++)ee[J](V)},v.sanitizeMargins=function(V){if(!(!V||!V.margin)){var H=V.width,ee=V.height,J=V.margin,W=H-(J.l+J.r),re=ee-(J.t+J.b),j;W<0&&(j=(H-1)/(J.l+J.r),J.l=Math.floor(j*J.l),J.r=Math.floor(j*J.r)),re<0&&(j=(ee-1)/(J.t+J.b),J.t=Math.floor(j*J.t),J.b=Math.floor(j*J.b))}},v.clearAutoMarginIds=function(V){V._fullLayout._pushmarginIds={}},v.allowAutoMargin=function(V,H){V._fullLayout._pushmarginIds[H]=1};function I(V){var H=V.margin;if(!V._size){var ee=V._size={l:Math.round(H.l),r:Math.round(H.r),t:Math.round(H.t),b:Math.round(H.b),p:Math.round(H.pad)};ee.w=Math.round(V.width)-ee.l-ee.r,ee.h=Math.round(V.height)-ee.t-ee.b}V._pushmargin||(V._pushmargin={}),V._pushmarginIds||(V._pushmarginIds={})}var F=2,D=2,B=64,U=64;v.autoMargin=function(V,H,ee){var J=V._fullLayout,W=J.width,re=J.height,j=J.margin,Z=a.constrain(W-j.l-j.r,F,B),ne=a.constrain(re-j.t-j.b,D,U),le=Math.max(0,W-Z),ge=Math.max(0,re-ne),pe=J._pushmargin,xe=J._pushmarginIds;if(j.autoexpand!==!1){if(!ee)delete pe[H],delete xe[H];else{var Ee=ee.pad;if(Ee===void 0&&(Ee=Math.min(12,j.l,j.r,j.t,j.b)),le){var Te=(ee.l+ee.r)/le;Te>1&&(ee.l/=Te,ee.r/=Te)}if(ge){var de=(ee.t+ee.b)/ge;de>1&&(ee.t/=de,ee.b/=de)}var be=ee.xl!==void 0?ee.xl:ee.x,Le=ee.xr!==void 0?ee.xr:ee.x,De=ee.yt!==void 0?ee.yt:ee.y,ye=ee.yb!==void 0?ee.yb:ee.y;pe[H]={l:{val:be,size:ee.l+Ee},r:{val:Le,size:ee.r+Ee},b:{val:ye,size:ee.b+Ee},t:{val:De,size:ee.t+Ee}},xe[H]=1}if(!J._replotting)return v.doAutoMargin(V)}},v.doAutoMargin=function(V){var H=V._fullLayout,ee=H.width,J=H.height;H._size||(H._size={}),I(H);var W=H._size,re=H.margin,j=a.extendFlat({},W),Z=re.l,ne=re.r,le=re.t,ge=re.b,pe=H._pushmargin,xe=H._pushmarginIds;if(H.margin.autoexpand!==!1){for(var Ee in pe)xe[Ee]||delete pe[Ee];pe.base={l:{val:0,size:Z},r:{val:1,size:ne},t:{val:1,size:le},b:{val:0,size:ge}};for(var Te in pe){var de=pe[Te].l||{},be=pe[Te].b||{},Le=de.val,De=de.size,ye=be.val,ke=be.size;for(var Oe in pe){if(E(De)&&pe[Oe].r){var Qe=pe[Oe].r.val,Ve=pe[Oe].r.size;if(Qe>Le){var Ue=(De*Qe+(Ve-ee)*Le)/(Qe-Le),Ie=(Ve*(1-Le)+(De-ee)*(1-Qe))/(Qe-Le);Ue+Ie>Z+ne&&(Z=Ue,ne=Ie)}}if(E(ke)&&pe[Oe].t){var at=pe[Oe].t.val,pt=pe[Oe].t.size;if(at>ye){var Rt=(ke*at+(pt-J)*ye)/(at-ye),Mt=(pt*(1-ye)+(ke-J)*(1-at))/(at-ye);Rt+Mt>ge+le&&(ge=Rt,le=Mt)}}}}}var It=a.constrain(ee-re.l-re.r,F,B),Bt=a.constrain(J-re.t-re.b,D,U),St=Math.max(0,ee-It),_t=Math.max(0,J-Bt);if(St){var it=(Z+ne)/St;it>1&&(Z/=it,ne/=it)}if(_t){var ct=(ge+le)/_t;ct>1&&(ge/=ct,le/=ct)}if(W.l=Math.round(Z),W.r=Math.round(ne),W.t=Math.round(le),W.b=Math.round(ge),W.p=Math.round(re.pad),W.w=Math.round(ee)-W.l-W.r,W.h=Math.round(J)-W.t-W.b,!H._replotting&&v.didMarginChange(j,W)){"_redrawFromAutoMarginCount"in H?H._redrawFromAutoMarginCount++:H._redrawFromAutoMarginCount=1;var et=3*(1+Object.keys(xe).length);if(H._redrawFromAutoMarginCount<et)return e.call("_doPlot",V);H._size=j,a.warn("Too many auto-margin redraws.")}X(V)};function X(V){var H=n.list(V,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(ee){for(var J=0;J<H.length;J++){var W=H[J][ee];W&&W()}})}var oe=["l","r","t","b","p","w","h"];v.didMarginChange=function(V,H){for(var ee=0;ee<oe.length;ee++){var J=oe[ee],W=V[J],re=H[J];if(!E(W)||Math.abs(re-W)>1)return!0}return!1},v.graphJson=function(V,H,ee,J,W,re){(W&&H&&!V._fullData||W&&!H&&!V._fullLayout)&&v.supplyDefaults(V);var j=W?V._fullData:V.data,Z=W?V._fullLayout:V.layout,ne=(V._transitionData||{})._frames;function le(xe,Ee){if(typeof xe=="function")return Ee?"_function_":null;if(a.isPlainObject(xe)){var Te={},de;return Object.keys(xe).sort().forEach(function(be){if(["_","["].indexOf(be.charAt(0))===-1){if(typeof xe[be]=="function"){Ee&&(Te[be]="_function");return}if(ee==="keepdata"){if(be.substr(be.length-3)==="src")return}else if(ee==="keepstream"){if(de=xe[be+"src"],typeof de=="string"&&de.indexOf(":")>0&&!a.isPlainObject(xe.stream))return}else if(ee!=="keepall"&&(de=xe[be+"src"],typeof de=="string"&&de.indexOf(":")>0))return;Te[be]=le(xe[be],Ee)}}),Te}return Array.isArray(xe)?xe.map(function(be){return le(be,Ee)}):a.isTypedArray(xe)?a.simpleMap(xe,a.identity):a.isJSDate(xe)?a.ms2DateTimeLocal(+xe):xe}var ge={data:(j||[]).map(function(xe){var Ee=le(xe);return H&&delete Ee.fit,Ee})};if(!H&&(ge.layout=le(Z),W)){var pe=Z._size;ge.layout.computed={margin:{b:pe.b,l:pe.l,r:pe.r,t:pe.t}}}return ne&&(ge.frames=le(ne)),re&&(ge.config=le(V._context,!0)),J==="object"?ge:JSON.stringify(ge)},v.modifyFrames=function(V,H){var ee,J,W,re=V._transitionData._frames,j=V._transitionData._frameHash;for(ee=0;ee<H.length;ee++)switch(J=H[ee],J.type){case"replace":W=J.value;var Z=(re[J.index]||{}).name,ne=W.name;re[J.index]=j[ne]=W,ne!==Z&&(delete j[Z],j[ne]=W);break;case"insert":W=J.value,j[W.name]=W,re.splice(J.index,0,W);break;case"delete":W=re[J.index],delete j[W.name],re.splice(J.index,1);break}return Promise.resolve()},v.computeFrame=function(V,H){var ee=V._transitionData._frameHash,J,W,re,j;if(!H)throw new Error("computeFrame must be given a string frame name");var Z=ee[H.toString()];if(!Z)return!1;for(var ne=[Z],le=[Z.name];Z.baseframe&&(Z=ee[Z.baseframe.toString()])&&le.indexOf(Z.name)===-1;)ne.push(Z),le.push(Z.name);for(var ge={};Z=ne.pop();)if(Z.layout&&(ge.layout=v.extendLayout(ge.layout,Z.layout)),Z.data){if(ge.data||(ge.data=[]),W=Z.traces,!W)for(W=[],J=0;J<Z.data.length;J++)W[J]=J;for(ge.traces||(ge.traces=[]),J=0;J<Z.data.length;J++)re=W[J],re!=null&&(j=ge.traces.indexOf(re),j===-1&&(j=ge.data.length,ge.traces[j]=re),ge.data[j]=v.extendTrace(ge.data[j],Z.data[J]))}return ge},v.recomputeFrameHash=function(V){for(var H=V._transitionData._frameHash={},ee=V._transitionData._frames,J=0;J<ee.length;J++){var W=ee[J];W&&W.name&&(H[W.name]=W)}},v.extendObjectWithContainers=function(V,H,ee){var J,W,re,j,Z,ne,le,ge,pe=a.extendDeepNoArrays({},H||{}),xe=a.expandObjectPaths(pe),Ee={};if(ee&&ee.length)for(re=0;re<ee.length;re++)J=a.nestedProperty(xe,ee[re]),W=J.get(),W===void 0?a.nestedProperty(Ee,ee[re]).set(null):(J.set(null),a.nestedProperty(Ee,ee[re]).set(W));if(V=a.extendDeepNoArrays(V||{},xe),ee&&ee.length){for(re=0;re<ee.length;re++)if(Z=a.nestedProperty(Ee,ee[re]),le=Z.get(),!!le){for(ne=a.nestedProperty(V,ee[re]),ge=ne.get(),Array.isArray(ge)||(ge=[],ne.set(ge)),j=0;j<le.length;j++){var Te=le[j];Te===null?ge[j]=null:ge[j]=v.extendObjectWithContainers(ge[j],Te)}ne.set(ge)}}return V},v.dataArrayContainers=["transforms","dimensions"],v.layoutArrayContainers=e.layoutArrayContainers,v.extendTrace=function(V,H){return v.extendObjectWithContainers(V,H,v.dataArrayContainers)},v.extendLayout=function(V,H){return v.extendObjectWithContainers(V,H,v.layoutArrayContainers)},v.transition=function(V,H,ee,J,W,re){var j={redraw:W.redraw},Z={},ne=[];return j.prepareFn=function(){for(var le=Array.isArray(H)?H.length:0,ge=J.slice(0,le),pe=0;pe<ge.length;pe++){var xe=ge[pe],Ee=V._fullData[xe],Te=Ee._module;if(!!Te){if(Te.animatable){var de=Te.basePlotModule.name;Z[de]||(Z[de]=[]),Z[de].push(xe)}V.data[ge[pe]]=v.extendTrace(V.data[ge[pe]],H[pe])}}var be=a.expandObjectPaths(a.extendDeepNoArrays({},ee)),Le=/^[xy]axis[0-9]*$/;for(var De in be)!Le.test(De)||delete be[De].range;v.extendLayout(V.layout,be),delete V.calcdata,v.supplyDefaults(V),v.doCalcdata(V);var ye=a.expandObjectPaths(ee);if(ye){var ke=V._fullLayout._plots;for(var Oe in ke){var Qe=ke[Oe],Ve=Qe.xaxis,Ue=Qe.yaxis,Ie=Ve.range.slice(),at=Ue.range.slice(),pt=null,Rt=null,Mt=null,It=null;Array.isArray(ye[Ve._name+".range"])?pt=ye[Ve._name+".range"].slice():Array.isArray((ye[Ve._name]||{}).range)&&(pt=ye[Ve._name].range.slice()),Array.isArray(ye[Ue._name+".range"])?Rt=ye[Ue._name+".range"].slice():Array.isArray((ye[Ue._name]||{}).range)&&(Rt=ye[Ue._name].range.slice()),Ie&&pt&&(Ve.r2l(Ie[0])!==Ve.r2l(pt[0])||Ve.r2l(Ie[1])!==Ve.r2l(pt[1]))&&(Mt={xr0:Ie,xr1:pt}),at&&Rt&&(Ue.r2l(at[0])!==Ue.r2l(Rt[0])||Ue.r2l(at[1])!==Ue.r2l(Rt[1]))&&(It={yr0:at,yr1:Rt}),(Mt||It)&&ne.push(a.extendFlat({plotinfo:Qe},Mt,It))}}return Promise.resolve()},j.runFn=function(le){var ge,pe=V._fullLayout._basePlotModules,xe=ne.length,Ee;if(ee)for(Ee=0;Ee<pe.length;Ee++)pe[Ee].transitionAxes&&pe[Ee].transitionAxes(V,ne,re,le);xe?(ge=a.extendFlat({},re),ge.duration=0,delete Z.cartesian):ge=re;for(var Te in Z){var de=Z[Te],be=V._fullData[de[0]]._module;be.basePlotModule.plot(V,de,ge,le)}},se(V,re,j)},v.transitionFromReact=function(V,H,ee,J){var W=V._fullLayout,re=W.transition,j={},Z=[];return j.prepareFn=function(){var ne=W._plots;j.redraw=!1,H.anim==="some"&&(j.redraw=!0),ee.anim==="some"&&(j.redraw=!0);for(var le in ne){var ge=ne[le],pe=ge.xaxis,xe=ge.yaxis,Ee=J[pe._name].range.slice(),Te=J[xe._name].range.slice(),de=pe.range.slice(),be=xe.range.slice();pe.setScale(),xe.setScale();var Le=null,De=null;(pe.r2l(Ee[0])!==pe.r2l(de[0])||pe.r2l(Ee[1])!==pe.r2l(de[1]))&&(Le={xr0:Ee,xr1:de}),(xe.r2l(Te[0])!==xe.r2l(be[0])||xe.r2l(Te[1])!==xe.r2l(be[1]))&&(De={yr0:Te,yr1:be}),(Le||De)&&Z.push(a.extendFlat({plotinfo:ge},Le,De))}return Promise.resolve()},j.runFn=function(ne){for(var le=V._fullData,ge=V._fullLayout,pe=ge._basePlotModules,xe,Ee,Te,de=[],be=0;be<le.length;be++)de.push(be);function Le(){if(!!V._fullLayout)for(var ye=0;ye<pe.length;ye++)pe[ye].transitionAxes&&pe[ye].transitionAxes(V,Z,xe,ne)}function De(){if(!!V._fullLayout)for(var ye=0;ye<pe.length;ye++)pe[ye].plot(V,Te,Ee,ne)}Z.length&&H.anim?re.ordering==="traces first"?(xe=a.extendFlat({},re,{duration:0}),Te=de,Ee=re,setTimeout(Le,re.duration),De()):(xe=re,Te=null,Ee=a.extendFlat({},re,{duration:0}),setTimeout(De,xe.duration),Le()):Z.length?(xe=re,Le()):H.anim&&(Te=de,Ee=re,De())},se(V,re,j)};function se(V,H,ee){var J=!1;function W(pe){var xe=Promise.resolve();if(!pe)return xe;for(;pe.length;)xe=xe.then(pe.shift());return xe}function re(pe){if(!!pe)for(;pe.length;)pe.shift()}function j(){return V.emit("plotly_transitioning",[]),new Promise(function(pe){V._transitioning=!0,H.duration>0&&(V._transitioningWithDuration=!0),V._transitionData._interruptCallbacks.push(function(){J=!0}),ee.redraw&&V._transitionData._interruptCallbacks.push(function(){return e.call("redraw",V)}),V._transitionData._interruptCallbacks.push(function(){V.emit("plotly_transitioninterrupted",[])});var xe=0,Ee=0;function Te(){return xe++,function(){Ee++,!J&&Ee===xe&&Z(pe)}}ee.runFn(Te),setTimeout(Te())})}function Z(pe){if(!!V._transitionData)return re(V._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(ee.redraw)return e.call("redraw",V)}).then(function(){V._transitioning=!1,V._transitioningWithDuration=!1,V.emit("plotly_transitioned",[])}).then(pe)}function ne(){if(!!V._transitionData)return V._transitioning=!1,W(V._transitionData._interruptCallbacks)}var le=[v.previousPromises,ne,ee.prepareFn,v.rehover,j],ge=a.syncOrAsync(le,V);return(!ge||!ge.then)&&(ge=Promise.resolve()),ge.then(function(){return V})}v.doCalcdata=function(V,H){var ee=n.list(V),J=V._fullData,W=V._fullLayout,re,j,Z,ne,le=new Array(J.length),ge=(V.calcdata||[]).slice();for(V.calcdata=le,W._numBoxes=0,W._numViolins=0,W._violinScaleGroupStats={},V._hmpixcount=0,V._hmlumcount=0,W._piecolormap={},W._sunburstcolormap={},W._treemapcolormap={},W._iciclecolormap={},W._funnelareacolormap={},Z=0;Z<J.length;Z++)if(Array.isArray(H)&&H.indexOf(Z)===-1){le[Z]=ge[Z];continue}for(Z=0;Z<J.length;Z++)re=J[Z],re._arrayAttrs=p.findArrayAttributes(re),re._extremes={};var pe=W._subplots.polar||[];for(Z=0;Z<pe.length;Z++)ee.push(W[pe[Z]].radialaxis,W[pe[Z]].angularaxis);for(var xe in W._colorAxes){var Ee=W[xe];Ee.cauto!==!1&&(delete Ee.cmin,delete Ee.cmax)}var Te=!1;function de(De){if(re=J[De],j=re._module,re.visible===!0&&re.transforms){if(j&&j.calc){var ye=j.calc(V,re);ye[0]&&ye[0].t&&ye[0].t._scene&&delete ye[0].t._scene.dirty}for(ne=0;ne<re.transforms.length;ne++){var ke=re.transforms[ne];j=_[ke.type],j&&j.calcTransform&&(re._hasCalcTransform=!0,Te=!0,j.calcTransform(V,re,ke))}}}function be(De,ye){if(re=J[De],j=re._module,!!j.isContainer===ye){var ke=[];if(re.visible===!0&&re._length!==0){delete re._indexToPoints;var Oe=re.transforms||[];for(ne=Oe.length-1;ne>=0;ne--)if(Oe[ne].enabled){re._indexToPoints=Oe[ne]._indexToPoints;break}j&&j.calc&&(ke=j.calc(V,re))}(!Array.isArray(ke)||!ke[0])&&(ke=[{x:i,y:i}]),ke[0].t||(ke[0].t={}),ke[0].trace=re,le[De]=ke}}for(G(ee,J,W),Z=0;Z<J.length;Z++)be(Z,!0);for(Z=0;Z<J.length;Z++)de(Z);for(Te&&G(ee,J,W),Z=0;Z<J.length;Z++)be(Z,!0);for(Z=0;Z<J.length;Z++)be(Z,!1);Q(V);var Le=K(ee,V);if(Le.length){for(W._numBoxes=0,W._numViolins=0,Z=0;Z<Le.length;Z++)be(Le[Z],!0);for(Z=0;Z<Le.length;Z++)be(Le[Z],!1);Q(V)}e.getComponentMethod("fx","calc")(V),e.getComponentMethod("errorbars","calc")(V)};var q=/(total|sum|min|max|mean|median) (ascending|descending)/;function K(V,H){var ee=[],J,W,re,j,Z;function ne(St,_t,it){var ct=_t._id.charAt(0);if(St==="histogram2dcontour"){var et=_t._counterAxes[0],Pe=n.getFromId(H,et),We=ct==="x"||et==="x"&&Pe.type==="category",je=ct==="y"||et==="y"&&Pe.type==="category";return function(nt,kt){return nt===0||kt===0||We&&nt===it[kt].length-1||je&&kt===it.length-1?-1:(ct==="y"?kt:nt)-1}}else return function(nt,kt){return ct==="y"?kt:nt}}var le={min:function(St){return a.aggNums(Math.min,null,St)},max:function(St){return a.aggNums(Math.max,null,St)},sum:function(St){return a.aggNums(function(_t,it){return _t+it},null,St)},total:function(St){return a.aggNums(function(_t,it){return _t+it},null,St)},mean:function(St){return a.mean(St)},median:function(St){return a.median(St)}};for(J=0;J<V.length;J++){var ge=V[J];if(ge.type==="category"){var pe=ge.categoryorder.match(q);if(pe){var xe=pe[1],Ee=pe[2],Te=ge._id.charAt(0),de=Te==="x",be=[];for(W=0;W<ge._categories.length;W++)be.push([ge._categories[W],[]]);for(W=0;W<ge._traceIndices.length;W++){var Le=ge._traceIndices[W],De=H._fullData[Le];if(De.visible===!0){var ye=De.type;e.traceIs(De,"histogram")&&(delete De._xautoBinFinished,delete De._yautoBinFinished);var ke=ye==="splom",Oe=ye==="scattergl",Qe=H.calcdata[Le];for(re=0;re<Qe.length;re++){var Ve=Qe[re],Ue,Ie;if(ke){var at=De._axesDim[ge._id];if(!de){var pt=De._diag[at][0];pt&&(ge=H._fullLayout[n.id2name(pt)])}var Rt=Ve.trace.dimensions[at].values;for(j=0;j<Rt.length;j++)for(Ue=ge._categoriesMap[Rt[j]],Z=0;Z<Ve.trace.dimensions.length;Z++)if(Z!==at){var Mt=Ve.trace.dimensions[Z];be[Ue][1].push(Mt.values[j])}}else if(Oe){for(j=0;j<Ve.t.x.length;j++)de?(Ue=Ve.t.x[j],Ie=Ve.t.y[j]):(Ue=Ve.t.y[j],Ie=Ve.t.x[j]),be[Ue][1].push(Ie);Ve.t&&Ve.t._scene&&delete Ve.t._scene.dirty}else if(Ve.hasOwnProperty("z")){Ie=Ve.z;var It=ne(De.type,ge,Ie);for(j=0;j<Ie.length;j++)for(Z=0;Z<Ie[j].length;Z++)Ue=It(Z,j),Ue+1&&be[Ue][1].push(Ie[j][Z])}else for(Ue=Ve.p,Ue===void 0&&(Ue=Ve[Te]),Ie=Ve.s,Ie===void 0&&(Ie=Ve.v),Ie===void 0&&(Ie=de?Ve.y:Ve.x),Array.isArray(Ie)||(Ie===void 0?Ie=[]:Ie=[Ie]),j=0;j<Ie.length;j++)be[Ue][1].push(Ie[j])}}}ge._categoriesValue=be;var Bt=[];for(W=0;W<be.length;W++)Bt.push([be[W][0],le[xe](be[W][1])]);Bt.sort(function(St,_t){return St[1]-_t[1]}),ge._categoriesAggregatedValue=Bt,ge._initialCategories=Bt.map(function(St){return St[0]}),Ee==="descending"&&ge._initialCategories.reverse(),ee=ee.concat(ge.sortByInitialCategories())}}}return ee}function G(V,H,ee){var J={};function W(ne){ne.clearCalc(),ne.type==="multicategory"&&ne.setupMultiCategory(H),J[ne._id]=1}a.simpleMap(V,W);for(var re=ee._axisMatchGroups||[],j=0;j<re.length;j++)for(var Z in re[j])J[Z]||W(ee[n.id2name(Z)])}function Q(V){var H=V._fullLayout,ee=H._visibleModules,J={},W,re,j;for(re=0;re<ee.length;re++){var Z=ee[re],ne=Z.crossTraceCalc;if(ne){var le=Z.basePlotModule.name;J[le]?a.pushUnique(J[le],ne):J[le]=[ne]}}for(j in J){var ge=J[j],pe=H._subplots[j];if(Array.isArray(pe))for(W=0;W<pe.length;W++){var xe=pe[W],Ee=j==="cartesian"?H._plots[xe]:H[xe];for(re=0;re<ge.length;re++)ge[re](V,Ee,xe)}else for(re=0;re<ge.length;re++)ge[re](V)}}v.rehover=function(V){V._fullLayout._rehover&&V._fullLayout._rehover()},v.redrag=function(V){V._fullLayout._redrag&&V._fullLayout._redrag()},v.generalUpdatePerTraceModule=function(V,H,ee,J){var W=H.traceHash,re={},j;for(j=0;j<ee.length;j++){var Z=ee[j],ne=Z[0].trace;ne.visible&&(re[ne.type]=re[ne.type]||[],re[ne.type].push(Z))}for(var le in W)if(!re[le]){var ge=W[le][0],pe=ge[0].trace;pe.visible=!1,re[le]=[ge]}for(var xe in re){var Ee=re[xe],Te=Ee[0][0].trace._module;Te.plot(V,H,a.filterVisible(Ee),J)}H.traceHash=re},v.plotBasePlot=function(V,H,ee,J,W){var re=e.getModule(V),j=m(H.calcdata,re)[0];re.plot(H,j,J,W)},v.cleanBasePlot=function(V,H,ee,J,W){var re=W._has&&W._has(V),j=ee._has&&ee._has(V);re&&!j&&W["_"+V+"layer"].selectAll("g.trace").remove()}},{"../components/color":366,"../constants/numerical":479,"../lib":503,"../plot_api/plot_schema":542,"../plot_api/plot_template":543,"../plots/get_data":593,"../registry":638,"./animation_attributes":548,"./attributes":550,"./cartesian/axis_ids":558,"./cartesian/handle_outline":565,"./command":583,"./font_attributes":585,"./frame_attributes":586,"./layout_attributes":610,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],620:[function(c,ae,ie){"use strict";ae.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],621:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../lib/polygon").tester,P=b.findIndexOfMin,E=b.isAngleInsideSector,e=b.angleDelta,p=b.angleDist;function g(_,l,y,T,w){if(!E(l,T))return!1;var A,f;y[0]<y[1]?(A=y[0],f=y[1]):(A=y[1],f=y[0]);var u=k(r(A,T[0],T[1],w)),h=k(r(f,T[0],T[1],w)),o=[_*Math.cos(l),_*Math.sin(l)];return h.contains(o)&&!u.contains(o)}function a(_,l,y,T){var w,A,f=T[0],u=T[1],h=m(Math.sin(l)-Math.sin(_)),o=m(Math.cos(l)-Math.cos(_)),S=Math.tan(y),R=m(1/S),z=h/o,O=u-z*f;return R?h&&o?(w=O/(S-z),A=S*w):o?(w=u*R,A=u):(w=f,A=f*S):h&&o?(w=0,A=O):o?(w=0,A=u):w=A=NaN,[w,A]}function t(_,l,y,T){var w=-l*y,A=l*l+1,f=2*(l*w-y),u=w*w+y*y-_*_,h=Math.sqrt(f*f-4*A*u),o=(-f+h)/(2*A),S=(-f-h)/(2*A);return[[o,l*o+w+T],[S,l*S+w+T]]}function i(_,l){var y=l.length,T=new Array(y+1),w;for(w=0;w<y;w++){var A=l[w];T[w]=[_*Math.cos(A),_*Math.sin(A)]}return T[w]=T[0].slice(),T}function n(_,l,y,T){var w=T.length,A=[],f,u;function h(B){return[_*Math.cos(B),_*Math.sin(B)]}function o(B,U,X){return a(B,U,X,h(B))}function S(B){return b.mod(B,w)}function R(B){return E(B,[l,y])}var z=P(T,function(B){return R(B)?p(B,l):1/0}),O=o(T[z],T[S(z-1)],l);for(A.push(O),f=z,u=0;u<w;f++,u++){var I=T[S(f)];if(!R(I))break;A.push(h(I))}var F=P(T,function(B){return R(B)?p(B,y):1/0}),D=o(T[F],T[S(F+1)],y);return A.push(D),A.push([0,0]),A.push(A[0].slice()),A}function r(_,l,y,T){return b.isFullCircle([l,y])?i(_,T):n(_,l,y,T)}function d(_,l,y,T){for(var w=1/0,A=1/0,f=r(_,l,y,T),u=0;u<f.length;u++){var h=f[u];w=Math.min(w,h[0]),A=Math.min(A,-h[1])}return[w,A]}function s(_,l){var y=function(A){var f=e(A,_);return f>0?f:1/0},T=P(l,y),w=b.mod(T+1,l.length);return[l[T],l[w]]}function m(_){return Math.abs(_)>1e-10?_:0}function x(_,l,y){l=l||0,y=y||0;for(var T=_.length,w=new Array(T),A=0;A<T;A++){var f=_[A];w[A]=[l+f[0],y-f[1]]}return w}function M(_,l,y,T,w,A){var f=r(_,l,y,T);return"M"+x(f,w,A).join("L")}function v(_,l,y,T,w,A,f){var u,h;_<l?(u=_,h=l):(u=l,h=_);var o=x(r(u,y,T,w),A,f),S=x(r(h,y,T,w),A,f);return"M"+S.reverse().join("L")+"M"+o.join("L")}ae.exports={isPtInsidePolygon:g,findPolygonOffset:d,findEnclosingVertexAngles:s,findIntersectionXY:a,findXYatLength:t,clampTiny:m,pathPolygon:M,pathPolygonAnnulus:v}},{"../../lib":503,"../../lib/polygon":515}],622:[function(c,ae,ie){"use strict";var b=c("../get_data").getSubplotCalcData,k=c("../../lib").counterRegex,P=c("./polar"),E=c("./constants"),e=E.attr,p=E.name,g=k(p),a={};a[e]={valType:"subplotid",dflt:p,editType:"calc"};function t(n){for(var r=n._fullLayout,d=n.calcdata,s=r._subplots[p],m=0;m<s.length;m++){var x=s[m],M=b(d,p,x),v=r[x]._subplot;v||(v=P(n,x),r[x]._subplot=v),v.plot(M,r,n._promises)}}function i(n,r,d,s){for(var m=s._subplots[p]||[],x=s._has&&s._has("gl"),M=r._has&&r._has("gl"),v=x&&!M,_=0;_<m.length;_++){var l=m[_],y=s[l]._subplot;if(!r[l]&&!!y){y.framework.remove(),y.layers["radial-axis-title"].remove();for(var T in y.clipPaths)y.clipPaths[T].remove()}v&&y._scene&&(y._scene.destroy(),y._scene=null)}}ae.exports={attr:e,name:p,idRoot:p,idRegex:g,attrRegex:g,attributes:a,layoutAttributes:c("./layout_attributes"),supplyLayoutDefaults:c("./layout_defaults"),plot:t,clean:i,toSVG:c("../cartesian").toSVG}},{"../../lib":503,"../cartesian":568,"../get_data":593,"./constants":620,"./layout_attributes":623,"./layout_defaults":624,"./polar":625}],623:[function(c,ae,ie){"use strict";var b=c("../../components/color/attributes"),k=c("../cartesian/layout_attributes"),P=c("../domain").attributes,E=c("../../lib").extendFlat,e=c("../../plot_api/edit_types").overrideAll,p=e({color:k.color,showline:E({},k.showline,{dflt:!0}),linecolor:k.linecolor,linewidth:k.linewidth,showgrid:E({},k.showgrid,{dflt:!0}),gridcolor:k.gridcolor,gridwidth:k.gridwidth},"plot","from-root"),g=e({tickmode:k.tickmode,nticks:k.nticks,tick0:k.tick0,dtick:k.dtick,tickvals:k.tickvals,ticktext:k.ticktext,ticks:k.ticks,ticklen:k.ticklen,tickwidth:k.tickwidth,tickcolor:k.tickcolor,ticklabelstep:k.ticklabelstep,showticklabels:k.showticklabels,showtickprefix:k.showtickprefix,tickprefix:k.tickprefix,showticksuffix:k.showticksuffix,ticksuffix:k.ticksuffix,showexponent:k.showexponent,exponentformat:k.exponentformat,minexponent:k.minexponent,separatethousands:k.separatethousands,tickfont:k.tickfont,tickangle:k.tickangle,tickformat:k.tickformat,tickformatstops:k.tickformatstops,layer:k.layer},"plot","from-root"),a={visible:E({},k.visible,{dflt:!0}),type:E({},k.type,{values:["-","linear","log","date","category"]}),autotypenumbers:k.autotypenumbers,autorange:E({},k.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:E({},k.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:k.categoryorder,categoryarray:k.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:E({},k.title.text,{editType:"plot",dflt:""}),font:E({},k.title.font,{editType:"plot"}),editType:"plot"},hoverformat:k.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:k._deprecated.title,titlefont:k._deprecated.titlefont}};E(a,p,g);var t={visible:E({},k.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:k.autotypenumbers,categoryorder:k.categoryorder,categoryarray:k.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:k.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};E(t,p,g),ae.exports={domain:P({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:b.background},radialaxis:a,angularaxis:t,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":365,"../../lib":503,"../../plot_api/edit_types":536,"../cartesian/layout_attributes":569,"../domain":584}],624:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color"),P=c("../../plot_api/plot_template"),E=c("../subplot_defaults"),e=c("../get_data").getSubplotData,p=c("../cartesian/tick_value_defaults"),g=c("../cartesian/tick_mark_defaults"),a=c("../cartesian/tick_label_defaults"),t=c("../cartesian/prefix_suffix_defaults"),i=c("../cartesian/category_order_defaults"),n=c("../cartesian/line_grid_defaults"),r=c("../cartesian/axis_autotype"),d=c("./layout_attributes"),s=c("./set_convert"),m=c("./constants"),x=m.axisNames;function M(_,l,y,T){var w=y("bgcolor");T.bgColor=k.combine(w,T.paper_bgcolor);var A=y("sector");y("hole");var f=e(T.fullData,m.name,T.id),u=T.layoutOut,h;function o(G,Q){return y(h+"."+G,Q)}for(var S=0;S<x.length;S++){h=x[S],b.isPlainObject(_[h])||(_[h]={});var R=_[h],z=P.newContainer(l,h);z._id=z._name=h,z._attr=T.id+"."+h,z._traceIndices=f.map(function(G){return G._expandedIndex});var O=m.axisName2dataArray[h],I=v(R,z,o,f,O,T);i(R,z,o,{axData:f,dataAttr:O});var F=o("visible");switch(s(z,l,u),o("uirevision",l.uirevision),z._m=1,h){case"radialaxis":var D=o("autorange",!z.isValidRange(R.range));R.autorange=D,D&&(I==="linear"||I==="-")&&o("rangemode"),D==="reversed"&&(z._m=-1),o("range"),z.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if(I==="date"){b.log("Polar plots do not support date angular axes yet.");for(var B=0;B<f.length;B++)f[B].visible=!1;I=R.type=z.type="linear"}o(I==="linear"?"thetaunit":"period");var U=o("direction");o("rotation",{counterclockwise:0,clockwise:90}[U]);break}if(t(R,z,o,z.type,{tickSuffixDflt:z.thetaunit==="degrees"?"\xB0":void 0}),F){var X,oe,se,q,K=T.font||{};X=o("color"),oe=X===R.color?X:K.color,se=K.size,q=K.family,p(R,z,o,z.type),a(R,z,o,z.type,{font:{color:oe,size:se,family:q}}),g(R,z,o,{outerTicks:!0}),n(R,z,o,{dfltColor:X,bgColor:T.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:d[h]}),o("layer"),h==="radialaxis"&&(o("side"),o("angle",A[0]),o("title.text"),b.coerceFont(o,"title.font",{color:oe,size:b.bigFont(se),family:q}))}I!=="category"&&o("hoverformat"),z._input=R}l.angularaxis.type==="category"&&y("gridshape")}function v(_,l,y,T,w,A){var f=y("autotypenumbers",A.autotypenumbersDflt),u=y("type");if(u==="-"){for(var h,o=0;o<T.length;o++)if(T[o].visible){h=T[o];break}h&&h[w]&&(l.type=r(h[w],"gregorian",{noMultiCategory:!0,autotypenumbers:f})),l.type==="-"?l.type="linear":_.type=l.type}return l.type}ae.exports=function(l,y,T){E(l,y,T,{type:m.name,attributes:d,handleDefaults:M,font:y.font,autotypenumbersDflt:y.autotypenumbers,paper_bgcolor:y.paper_bgcolor,fullData:T,layoutOut:y})}},{"../../components/color":366,"../../lib":503,"../../plot_api/plot_template":543,"../cartesian/axis_autotype":555,"../cartesian/category_order_defaults":559,"../cartesian/line_grid_defaults":571,"../cartesian/prefix_suffix_defaults":573,"../cartesian/tick_label_defaults":578,"../cartesian/tick_mark_defaults":579,"../cartesian/tick_value_defaults":580,"../get_data":593,"../subplot_defaults":632,"./constants":620,"./layout_attributes":623,"./set_convert":626}],625:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("tinycolor2"),P=c("../../registry"),E=c("../../lib"),e=E.strRotate,p=E.strTranslate,g=c("../../components/color"),a=c("../../components/drawing"),t=c("../plots"),i=c("../../plots/cartesian/axes"),n=c("../cartesian/set_convert"),r=c("./set_convert"),d=c("../cartesian/autorange").doAutoRange,s=c("../cartesian/dragbox"),m=c("../../components/dragelement"),x=c("../../components/fx"),M=c("../../components/titles"),v=c("../cartesian/select").prepSelect,_=c("../cartesian/select").selectOnClick,l=c("../cartesian/select").clearSelect,y=c("../../lib/setcursor"),T=c("../../lib/clear_gl_canvases"),w=c("../../plot_api/subroutines").redrawReglTraces,A=c("../../constants/alignment").MID_SHIFT,f=c("./constants"),u=c("./helpers"),h=c("../smith/helpers"),o=h.smith,S=h.reactanceArc,R=h.resistanceArc,z=h.smithTransform,O=E._,I=E.mod,F=E.deg2rad,D=E.rad2deg;function B(K,G,Q){this.isSmith=Q||!1,this.id=G,this.gd=K,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var V=K._fullLayout,H="clip"+V._uid+G;this.clipIds.forTraces=H+"-for-traces",this.clipPaths.forTraces=V._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=V["_"+(Q?"smith":"polar")+"layer"].append("g").attr("class",G),this.getHole=function(ee){return this.isSmith?0:ee.hole},this.getSector=function(ee){return this.isSmith?[0,360]:ee.sector},this.getRadial=function(ee){return this.isSmith?ee.realaxis:ee.radialaxis},this.getAngular=function(ee){return this.isSmith?ee.imaginaryaxis:ee.angularaxis},Q||(this.radialTickLayout=null,this.angularTickLayout=null)}var U=B.prototype;ae.exports=function(G,Q,V){return new B(G,Q,V)},U.plot=function(K,G){for(var Q=this,V=G[Q.id],H=!1,ee=0;ee<K.length;ee++){var J=K[ee][0].trace;if(J.cliponaxis===!1){H=!0;break}}Q._hasClipOnAxisFalse=H,Q.updateLayers(G,V),Q.updateLayout(G,V),t.generalUpdatePerTraceModule(Q.gd,Q,K,V),Q.updateFx(G,V),Q.isSmith&&(delete V.realaxis.range,delete V.imaginaryaxis.range)},U.updateLayers=function(K,G){var Q=this,V=Q.isSmith,H=Q.layers,ee=Q.getRadial(G),J=Q.getAngular(G),W=f.layerNames,re=W.indexOf("frontplot"),j=W.slice(0,re),Z=J.layer==="below traces",ne=ee.layer==="below traces";Z&&j.push("angular-line"),ne&&j.push("radial-line"),Z&&j.push("angular-axis"),ne&&j.push("radial-axis"),j.push("frontplot"),Z||j.push("angular-line"),ne||j.push("radial-line"),Z||j.push("angular-axis"),ne||j.push("radial-axis");var le=(V?"smith":"polar")+"sublayer",ge=Q.framework.selectAll("."+le).data(j,String);ge.enter().append("g").attr("class",function(pe){return le+" "+pe}).each(function(pe){var xe=H[pe]=b.select(this);switch(pe){case"frontplot":V||xe.append("g").classed("barlayer",!0),xe.append("g").classed("scatterlayer",!0);break;case"backplot":xe.append("g").classed("maplayer",!0);break;case"plotbg":H.bg=xe.append("path");break;case"radial-grid":xe.style("fill","none");break;case"angular-grid":xe.style("fill","none");break;case"radial-line":xe.append("line").style("fill","none");break;case"angular-line":xe.append("path").style("fill","none");break}}),ge.order()},U.updateLayout=function(K,G){var Q=this,V=Q.layers,H=K._size,ee=Q.getRadial(G),J=Q.getAngular(G),W=G.domain.x,re=G.domain.y;Q.xOffset=H.l+H.w*W[0],Q.yOffset=H.t+H.h*(1-re[1]);var j=Q.xLength=H.w*(W[1]-W[0]),Z=Q.yLength=H.h*(re[1]-re[0]),ne=Q.getSector(G);Q.sectorInRad=ne.map(F);var le=Q.sectorBBox=oe(ne),ge=le[2]-le[0],pe=le[3]-le[1],xe=Z/j,Ee=Math.abs(pe/ge),Te,de,be,Le,De;xe>Ee?(Te=j,de=j*Ee,De=(Z-de)/H.h/2,be=[W[0],W[1]],Le=[re[0]+De,re[1]-De]):(Te=Z/Ee,de=Z,De=(j-Te)/H.w/2,be=[W[0]+De,W[1]-De],Le=[re[0],re[1]]),Q.xLength2=Te,Q.yLength2=de,Q.xDomain2=be,Q.yDomain2=Le;var ye=Q.xOffset2=H.l+H.w*be[0],ke=Q.yOffset2=H.t+H.h*(1-Le[1]),Oe=Q.radius=Te/ge,Qe=Q.innerRadius=Q.getHole(G)*Oe,Ve=Q.cx=ye-Oe*le[0],Ue=Q.cy=ke+Oe*le[3],Ie=Q.cxx=Ve-ye,at=Q.cyy=Ue-ke,pt=ee.side,Rt;pt==="counterclockwise"?(Rt=pt,pt="top"):pt==="clockwise"&&(Rt=pt,pt="bottom"),Q.radialAxis=Q.mockAxis(K,G,ee,{_id:"x",side:pt,_trueSide:Rt,domain:[Qe/H.w,Oe/H.w]}),Q.angularAxis=Q.mockAxis(K,G,J,{side:"right",domain:[0,Math.PI],autorange:!1}),Q.doAutoRange(K,G),Q.updateAngularAxis(K,G),Q.updateRadialAxis(K,G),Q.updateRadialAxisTitle(K,G),Q.xaxis=Q.mockCartesianAxis(K,G,{_id:"x",domain:be}),Q.yaxis=Q.mockCartesianAxis(K,G,{_id:"y",domain:Le});var Mt=Q.pathSubplot();Q.clipPaths.forTraces.select("path").attr("d",Mt).attr("transform",p(Ie,at)),V.frontplot.attr("transform",p(ye,ke)).call(a.setClipUrl,Q._hasClipOnAxisFalse?null:Q.clipIds.forTraces,Q.gd),V.bg.attr("d",Mt).attr("transform",p(Ve,Ue)).call(g.fill,G.bgcolor)},U.mockAxis=function(K,G,Q,V){var H=E.extendFlat({},Q,V);return r(H,G,K),H},U.mockCartesianAxis=function(K,G,Q){var V=this,H=V.isSmith,ee=Q._id,J=E.extendFlat({type:"linear"},Q);n(J,K);var W={x:[0,2],y:[1,3]};return J.setRange=function(){var re=V.sectorBBox,j=W[ee],Z=V.radialAxis._rl,ne=(Z[1]-Z[0])/(1-V.getHole(G));J.range=[re[j[0]]*ne,re[j[1]]*ne]},J.isPtWithinRange=ee==="x"&&!H?function(re){return V.isPtInside(re)}:function(){return!0},J.setRange(),J.setScale(),J},U.doAutoRange=function(K,G){var Q=this,V=Q.gd,H=Q.radialAxis,ee=Q.getRadial(G);d(V,H);var J=H.range;ee.range=J.slice(),ee._input.range=J.slice(),H._rl=[H.r2l(J[0],null,"gregorian"),H.r2l(J[1],null,"gregorian")]},U.updateRadialAxis=function(K,G){var Q=this,V=Q.gd,H=Q.layers,ee=Q.radius,J=Q.innerRadius,W=Q.cx,re=Q.cy,j=Q.getRadial(G),Z=I(Q.getSector(G)[0],360),ne=Q.radialAxis,le=J<ee,ge=Q.isSmith;ge||(Q.fillViewInitialKey("radialaxis.angle",j.angle),Q.fillViewInitialKey("radialaxis.range",ne.range.slice()),ne.setGeometry()),ne.tickangle==="auto"&&Z>90&&Z<=270&&(ne.tickangle=180);var pe=ge?function(Oe){var Qe=z(Q,o([Oe.x,0]));return p(Qe[0]-W,Qe[1]-re)}:function(Oe){return p(ne.l2p(Oe.x)+J,0)},xe=ge?function(Oe){return R(Q,Oe.x,-1/0,1/0)}:function(Oe){return Q.pathArc(ne.r2p(Oe.x)+J)},Ee=X(j);if(Q.radialTickLayout!==Ee&&(H["radial-axis"].selectAll(".xtick").remove(),Q.radialTickLayout=Ee),le){ne.setScale();var Te=0,de=ge?(ne.tickvals||[]).filter(function(Oe){return Oe>=0}).map(function(Oe){return i.tickText(ne,Oe,!0,!1)}):i.calcTicks(ne),be=ge?de:i.clipEnds(ne,de),Le=i.getTickSigns(ne)[2];ge&&((ne.ticks==="top"&&ne.side==="bottom"||ne.ticks==="bottom"&&ne.side==="top")&&(Le=-Le),ne.ticks==="top"&&ne.side==="top"&&(Te=-ne.ticklen),ne.ticks==="bottom"&&ne.side==="bottom"&&(Te=ne.ticklen)),i.drawTicks(V,ne,{vals:de,layer:H["radial-axis"],path:i.makeTickPath(ne,0,Le),transFn:pe,crisp:!1}),i.drawGrid(V,ne,{vals:be,layer:H["radial-grid"],path:xe,transFn:E.noop,crisp:!1}),i.drawLabels(V,ne,{vals:de,layer:H["radial-axis"],transFn:pe,labelFns:i.makeLabelFns(ne,Te)})}var De=Q.radialAxisAngle=Q.vangles?D(se(F(j.angle),Q.vangles)):j.angle,ye=p(W,re),ke=ye+e(-De);q(H["radial-axis"],le&&(j.showticklabels||j.ticks),{transform:ke}),q(H["radial-grid"],le&&j.showgrid,{transform:ge?"":ye}),q(H["radial-line"].select("line"),le&&j.showline,{x1:ge?-ee:J,y1:0,x2:ee,y2:0,transform:ke}).attr("stroke-width",j.linewidth).call(g.stroke,j.linecolor)},U.updateRadialAxisTitle=function(K,G,Q){if(!this.isSmith){var V=this,H=V.gd,ee=V.radius,J=V.cx,W=V.cy,re=V.getRadial(G),j=V.id+"title",Z=0;if(re.title){var ne=a.bBox(V.layers["radial-axis"].node()).height,le=re.title.font.size,ge=re.side;Z=ge==="top"?le:ge==="counterclockwise"?-(ne+le*.4):ne+le*.8}var pe=Q!==void 0?Q:V.radialAxisAngle,xe=F(pe),Ee=Math.cos(xe),Te=Math.sin(xe),de=J+ee/2*Ee+Z*Te,be=W-ee/2*Te+Z*Ee;V.layers["radial-axis-title"]=M.draw(H,j,{propContainer:re,propName:V.id+".radialaxis.title",placeholder:O(H,"Click to enter radial axis title"),attributes:{x:de,y:be,"text-anchor":"middle"},transform:{rotate:-pe}})}},U.updateAngularAxis=function(K,G){var Q=this,V=Q.gd,H=Q.layers,ee=Q.radius,J=Q.innerRadius,W=Q.cx,re=Q.cy,j=Q.getAngular(G),Z=Q.angularAxis,ne=Q.isSmith;ne||(Q.fillViewInitialKey("angularaxis.rotation",j.rotation),Z.setGeometry(),Z.setScale());var le=ne?function(Qe){var Ve=z(Q,o([0,Qe.x]));return Math.atan2(Ve[0]-W,Ve[1]-re)-Math.PI/2}:function(Qe){return Z.t2g(Qe.x)};Z.type==="linear"&&Z.thetaunit==="radians"&&(Z.tick0=D(Z.tick0),Z.dtick=D(Z.dtick));var ge=function(Qe){return p(W+ee*Math.cos(Qe),re-ee*Math.sin(Qe))},pe=ne?function(Qe){var Ve=z(Q,o([0,Qe.x]));return p(Ve[0],Ve[1])}:function(Qe){return ge(le(Qe))},xe=ne?function(Qe){var Ve=z(Q,o([0,Qe.x])),Ue=Math.atan2(Ve[0]-W,Ve[1]-re)-Math.PI/2;return p(Ve[0],Ve[1])+e(-D(Ue))}:function(Qe){var Ve=le(Qe);return ge(Ve)+e(-D(Ve))},Ee=ne?function(Qe){return S(Q,Qe.x,0,1/0)}:function(Qe){var Ve=le(Qe),Ue=Math.cos(Ve),Ie=Math.sin(Ve);return"M"+[W+J*Ue,re-J*Ie]+"L"+[W+ee*Ue,re-ee*Ie]},Te=i.makeLabelFns(Z,0),de=Te.labelStandoff,be={};be.xFn=function(Qe){var Ve=le(Qe);return Math.cos(Ve)*de},be.yFn=function(Qe){var Ve=le(Qe),Ue=Math.sin(Ve)>0?.2:1;return-Math.sin(Ve)*(de+Qe.fontSize*Ue)+Math.abs(Math.cos(Ve))*(Qe.fontSize*A)},be.anchorFn=function(Qe){var Ve=le(Qe),Ue=Math.cos(Ve);return Math.abs(Ue)<.1?"middle":Ue>0?"start":"end"},be.heightFn=function(Qe,Ve,Ue){var Ie=le(Qe);return-.5*(1+Math.sin(Ie))*Ue};var Le=X(j);Q.angularTickLayout!==Le&&(H["angular-axis"].selectAll("."+Z._id+"tick").remove(),Q.angularTickLayout=Le);var De=ne?[1/0].concat(Z.tickvals||[]).map(function(Qe){return i.tickText(Z,Qe,!0,!1)}):i.calcTicks(Z);ne&&(De[0].text="\u221E",De[0].fontSize*=1.75);var ye;if(G.gridshape==="linear"?(ye=De.map(le),E.angleDelta(ye[0],ye[1])<0&&(ye=ye.slice().reverse())):ye=null,Q.vangles=ye,Z.type==="category"&&(De=De.filter(function(Qe){return E.isAngleInsideSector(le(Qe),Q.sectorInRad)})),Z.visible){var ke=Z.ticks==="inside"?-1:1,Oe=(Z.linewidth||1)/2;i.drawTicks(V,Z,{vals:De,layer:H["angular-axis"],path:"M"+ke*Oe+",0h"+ke*Z.ticklen,transFn:xe,crisp:!1}),i.drawGrid(V,Z,{vals:De,layer:H["angular-grid"],path:Ee,transFn:E.noop,crisp:!1}),i.drawLabels(V,Z,{vals:De,layer:H["angular-axis"],repositionOnUpdate:!0,transFn:pe,labelFns:be})}q(H["angular-line"].select("path"),j.showline,{d:Q.pathSubplot(),transform:p(W,re)}).attr("stroke-width",j.linewidth).call(g.stroke,j.linecolor)},U.updateFx=function(K,G){if(!this.gd._context.staticPlot){var Q=!this.isSmith;Q&&(this.updateAngularDrag(K),this.updateRadialDrag(K,G,0),this.updateRadialDrag(K,G,1)),this.updateHoverAndMainDrag(K)}},U.updateHoverAndMainDrag=function(K){var G=this,Q=G.isSmith,V=G.gd,H=G.layers,ee=K._zoomlayer,J=f.MINZOOM,W=f.OFFEDGE,re=G.radius,j=G.innerRadius,Z=G.cx,ne=G.cy,le=G.cxx,ge=G.cyy,pe=G.sectorInRad,xe=G.vangles,Ee=G.radialAxis,Te=u.clampTiny,de=u.findXYatLength,be=u.findEnclosingVertexAngles,Le=f.cornerHalfWidth,De=f.cornerLen/2,ye,ke,Oe=s.makeDragger(H,"path","maindrag","crosshair");b.select(Oe).attr("d",G.pathSubplot()).attr("transform",p(Z,ne)),Oe.onmousemove=function($t){x.hover(V,$t,G.id),V._fullLayout._lasthover=Oe,V._fullLayout._hoversubplot=G.id},Oe.onmouseout=function($t){V._dragging||m.unhover(V,$t)};var Qe={element:Oe,gd:V,subplot:G.id,plotinfo:{id:G.id,xaxis:G.xaxis,yaxis:G.yaxis},xaxes:[G.xaxis],yaxes:[G.yaxis]},Ve,Ue,Ie,at,pt,Rt,Mt,It,Bt;function St($t,Qt){return Math.sqrt($t*$t+Qt*Qt)}function _t($t,Qt){return St($t-le,Qt-ge)}function it($t,Qt){return Math.atan2(ge-Qt,$t-le)}function ct($t,Qt){return[$t*Math.cos(Qt),$t*Math.sin(-Qt)]}function et($t,Qt){if($t===0)return G.pathSector(2*Le);var fr=De/$t,jr=Qt-fr,cn=Qt+fr,Qr=Math.max(0,Math.min($t,re)),lt=Qr-Le,Gt=Qr+Le;return"M"+ct(lt,jr)+"A"+[lt,lt]+" 0,0,0 "+ct(lt,cn)+"L"+ct(Gt,cn)+"A"+[Gt,Gt]+" 0,0,1 "+ct(Gt,jr)+"Z"}function Pe($t,Qt,fr){if($t===0)return G.pathSector(2*Le);var jr=ct($t,Qt),cn=ct($t,fr),Qr=Te((jr[0]+cn[0])/2),lt=Te((jr[1]+cn[1])/2),Gt,Kt;if(Qr&&lt){var Nt=lt/Qr,gr=-1/Nt,tt=de(Le,Nt,Qr,lt);Gt=de(De,gr,tt[0][0],tt[0][1]),Kt=de(De,gr,tt[1][0],tt[1][1])}else{var we,Me;lt?(we=De,Me=Le):(we=Le,Me=De),Gt=[[Qr-we,lt-Me],[Qr+we,lt-Me]],Kt=[[Qr-we,lt+Me],[Qr+we,lt+Me]]}return"M"+Gt.join("L")+"L"+Kt.reverse().join("L")+"Z"}function We(){Ie=null,at=null,pt=G.pathSubplot(),Rt=!1;var $t=V._fullLayout[G.id];Mt=k($t.bgcolor).getLuminance(),It=s.makeZoombox(ee,Mt,Z,ne,pt),It.attr("fill-rule","evenodd"),Bt=s.makeCorners(ee,Z,ne),l(V)}function je($t,Qt){return Qt=Math.max(Math.min(Qt,re),j),$t<W?$t=0:re-$t<W?$t=re:Qt<W?Qt=0:re-Qt<W&&(Qt=re),Math.abs(Qt-$t)>J?($t<Qt?(Ie=$t,at=Qt):(Ie=Qt,at=$t),!0):(Ie=null,at=null,!1)}function nt($t,Qt){$t=$t||pt,Qt=Qt||"M0,0Z",It.attr("d",$t),Bt.attr("d",Qt),s.transitionZoombox(It,Bt,Rt,Mt),Rt=!0;var fr={};zt(fr),V.emit("plotly_relayouting",fr)}function kt($t,Qt){$t=$t*ye,Qt=Qt*ke;var fr=Ve+$t,jr=Ue+Qt,cn=_t(Ve,Ue),Qr=Math.min(_t(fr,jr),re),lt=it(Ve,Ue),Gt,Kt;je(cn,Qr)&&(Gt=pt+G.pathSector(at),Ie&&(Gt+=G.pathSector(Ie)),Kt=et(Ie,lt)+et(at,lt)),nt(Gt,Kt)}function wt($t,Qt,fr,jr){var cn=u.findIntersectionXY(fr,jr,fr,[$t-le,ge-Qt]);return St(cn[0],cn[1])}function Vt($t,Qt){var fr=Ve+$t,jr=Ue+Qt,cn=it(Ve,Ue),Qr=it(fr,jr),lt=be(cn,xe),Gt=be(Qr,xe),Kt=wt(Ve,Ue,lt[0],lt[1]),Nt=Math.min(wt(fr,jr,Gt[0],Gt[1]),re),gr,tt;je(Kt,Nt)&&(gr=pt+G.pathSector(at),Ie&&(gr+=G.pathSector(Ie)),tt=[Pe(Ie,lt[0],lt[1]),Pe(at,lt[0],lt[1])].join(" ")),nt(gr,tt)}function qt(){if(s.removeZoombox(V),!(Ie===null||at===null)){var $t={};zt($t),s.showDoubleClickNotifier(V),P.call("_guiRelayout",V,$t)}}function zt($t){var Qt=Ee._rl,fr=(Qt[1]-Qt[0])/(1-j/re)/re,jr=[Qt[0]+(Ie-j)*fr,Qt[0]+(at-j)*fr];$t[G.id+".radialaxis.range"]=jr}function Ht($t,Qt){var fr=V._fullLayout.clickmode;if(s.removeZoombox(V),$t===2){var jr={};for(var cn in G.viewInitial)jr[G.id+"."+cn]=G.viewInitial[cn];V.emit("plotly_doubleclick",null),P.call("_guiRelayout",V,jr)}fr.indexOf("select")>-1&&$t===1&&_(Qt,V,[G.xaxis],[G.yaxis],G.id,Qe),fr.indexOf("event")>-1&&x.click(V,Qt,G.id)}Qe.prepFn=function($t,Qt,fr){var jr=V._fullLayout.dragmode,cn=Oe.getBoundingClientRect();V._fullLayout._calcInverseTransform(V);var Qr=V._fullLayout._invTransform;ye=V._fullLayout._invScaleX,ke=V._fullLayout._invScaleY;var lt=E.apply3DTransform(Qr)(Qt-cn.left,fr-cn.top);if(Ve=lt[0],Ue=lt[1],xe){var Gt=u.findPolygonOffset(re,pe[0],pe[1],xe);Ve+=le+Gt[0],Ue+=ge+Gt[1]}switch(jr){case"zoom":Qe.clickFn=Ht,Q||(xe?Qe.moveFn=Vt:Qe.moveFn=kt,Qe.doneFn=qt,We($t,Qt,fr));break;case"select":case"lasso":v($t,Qt,fr,Qe,jr);break}},m.init(Qe)},U.updateRadialDrag=function(K,G,Q){var V=this,H=V.gd,ee=V.layers,J=V.radius,W=V.innerRadius,re=V.cx,j=V.cy,Z=V.radialAxis,ne=f.radialDragBoxSize,le=ne/2;if(!Z.visible)return;var ge=F(V.radialAxisAngle),pe=Z._rl,xe=pe[0],Ee=pe[1],Te=pe[Q],de=.75*(pe[1]-pe[0])/(1-V.getHole(G))/J,be,Le,De;Q?(be=re+(J+le)*Math.cos(ge),Le=j-(J+le)*Math.sin(ge),De="radialdrag"):(be=re+(W-le)*Math.cos(ge),Le=j-(W-le)*Math.sin(ge),De="radialdrag-inner");var ye=s.makeRectDragger(ee,De,"crosshair",-le,-le,ne,ne),ke={element:ye,gd:H};q(b.select(ye),Z.visible&&W<J,{transform:p(be,Le)});var Oe,Qe,Ve;function Ue(Mt,It){if(Oe)Oe(Mt,It);else{var Bt=[Mt,-It],St=[Math.cos(ge),Math.sin(ge)],_t=Math.abs(E.dot(Bt,St)/Math.sqrt(E.dot(Bt,Bt)));isNaN(_t)||(Oe=_t<.5?pt:Rt)}var it={};Ie(it),H.emit("plotly_relayouting",it)}function Ie(Mt){Qe!==null?Mt[V.id+".radialaxis.angle"]=Qe:Ve!==null&&(Mt[V.id+".radialaxis.range["+Q+"]"]=Ve)}function at(){Qe!==null?P.call("_guiRelayout",H,V.id+".radialaxis.angle",Qe):Ve!==null&&P.call("_guiRelayout",H,V.id+".radialaxis.range["+Q+"]",Ve)}function pt(Mt,It){if(Q!==0){var Bt=be+Mt,St=Le+It;Qe=Math.atan2(j-St,Bt-re),V.vangles&&(Qe=se(Qe,V.vangles)),Qe=D(Qe);var _t=p(re,j)+e(-Qe);ee["radial-axis"].attr("transform",_t),ee["radial-line"].select("line").attr("transform",_t);var it=V.gd._fullLayout,ct=it[V.id];V.updateRadialAxisTitle(it,ct,Qe)}}function Rt(Mt,It){var Bt=E.dot([Mt,-It],[Math.cos(ge),Math.sin(ge)]);if(Ve=Te-de*Bt,de>0!=(Q?Ve>xe:Ve<Ee)){Ve=null;return}var St=H._fullLayout,_t=St[V.id];Z.range[Q]=Ve,Z._rl[Q]=Ve,V.updateRadialAxis(St,_t),V.xaxis.setRange(),V.xaxis.setScale(),V.yaxis.setRange(),V.yaxis.setScale();var it=!1;for(var ct in V.traceHash){var et=V.traceHash[ct],Pe=E.filterVisible(et),We=et[0][0].trace._module;We.plot(H,V,Pe,_t),P.traceIs(ct,"gl")&&Pe.length&&(it=!0)}it&&(T(H),w(H))}ke.prepFn=function(){Oe=null,Qe=null,Ve=null,ke.moveFn=Ue,ke.doneFn=at,l(H)},ke.clampFn=function(Mt,It){return Math.sqrt(Mt*Mt+It*It)<f.MINDRAG&&(Mt=0,It=0),[Mt,It]},m.init(ke)},U.updateAngularDrag=function(K){var G=this,Q=G.gd,V=G.layers,H=G.radius,ee=G.angularAxis,J=G.cx,W=G.cy,re=G.cxx,j=G.cyy,Z=f.angularDragBoxSize,ne=s.makeDragger(V,"path","angulardrag","move"),le={element:ne,gd:Q};b.select(ne).attr("d",G.pathAnnulus(H,H+Z)).attr("transform",p(J,W)).call(y,"move");function ge(Ve,Ue){return Math.atan2(j+Z-Ue,Ve-re-Z)}var pe=V.frontplot.select(".scatterlayer").selectAll(".trace"),xe=pe.selectAll(".point"),Ee=pe.selectAll(".textpoint"),Te,de,be,Le,De,ye;function ke(Ve,Ue){var Ie=G.gd._fullLayout,at=Ie[G.id],pt=Te+Ve*K._invScaleX,Rt=de+Ue*K._invScaleY,Mt=ge(pt,Rt),It=D(Mt-ye);if(Le=be+It,V.frontplot.attr("transform",p(G.xOffset2,G.yOffset2)+e([-It,re,j])),G.vangles){De=G.radialAxisAngle+It;var Bt=p(J,W)+e(-It),St=p(J,W)+e(-De);V.bg.attr("transform",Bt),V["radial-grid"].attr("transform",Bt),V["radial-axis"].attr("transform",St),V["radial-line"].select("line").attr("transform",St),G.updateRadialAxisTitle(Ie,at,De)}else G.clipPaths.forTraces.select("path").attr("transform",p(re,j)+e(It));xe.each(function(){var je=b.select(this),nt=a.getTranslate(je);je.attr("transform",p(nt.x,nt.y)+e([It]))}),Ee.each(function(){var je=b.select(this),nt=je.select("text"),kt=a.getTranslate(je);je.attr("transform",e([It,nt.attr("x"),nt.attr("y")])+p(kt.x,kt.y))}),ee.rotation=E.modHalf(Le,360),G.updateAngularAxis(Ie,at),G._hasClipOnAxisFalse&&!E.isFullCircle(G.sectorInRad)&&pe.call(a.hideOutsideRangePoints,G);var _t=!1;for(var it in G.traceHash)if(P.traceIs(it,"gl")){var ct=G.traceHash[it],et=E.filterVisible(ct),Pe=ct[0][0].trace._module;Pe.plot(Q,G,et,at),et.length&&(_t=!0)}_t&&(T(Q),w(Q));var We={};Oe(We),Q.emit("plotly_relayouting",We)}function Oe(Ve){Ve[G.id+".angularaxis.rotation"]=Le,G.vangles&&(Ve[G.id+".radialaxis.angle"]=De)}function Qe(){Ee.select("text").attr("transform",null);var Ve={};Oe(Ve),P.call("_guiRelayout",Q,Ve)}le.prepFn=function(Ve,Ue,Ie){var at=K[G.id];be=at.angularaxis.rotation;var pt=ne.getBoundingClientRect();Te=Ue-pt.left,de=Ie-pt.top,Q._fullLayout._calcInverseTransform(Q);var Rt=E.apply3DTransform(K._invTransform)(Te,de);Te=Rt[0],de=Rt[1],ye=ge(Te,de),le.moveFn=ke,le.doneFn=Qe,l(Q)},G.vangles&&!E.isFullCircle(G.sectorInRad)&&(le.prepFn=E.noop,y(b.select(ne),null)),m.init(le)},U.isPtInside=function(K){if(this.isSmith)return!0;var G=this.sectorInRad,Q=this.vangles,V=this.angularAxis.c2g(K.theta),H=this.radialAxis,ee=H.c2l(K.r),J=H._rl,W=Q?u.isPtInsidePolygon:E.isPtInsideSector;return W(ee,V,J,G,Q)},U.pathArc=function(K){var G=this.sectorInRad,Q=this.vangles,V=Q?u.pathPolygon:E.pathArc;return V(K,G[0],G[1],Q)},U.pathSector=function(K){var G=this.sectorInRad,Q=this.vangles,V=Q?u.pathPolygon:E.pathSector;return V(K,G[0],G[1],Q)},U.pathAnnulus=function(K,G){var Q=this.sectorInRad,V=this.vangles,H=V?u.pathPolygonAnnulus:E.pathAnnulus;return H(K,G,Q[0],Q[1],V)},U.pathSubplot=function(){var K=this.innerRadius,G=this.radius;return K?this.pathAnnulus(K,G):this.pathSector(G)},U.fillViewInitialKey=function(K,G){K in this.viewInitial||(this.viewInitial[K]=G)};function X(K){var G=K.ticks+String(K.ticklen)+String(K.showticklabels);return"side"in K&&(G+=K.side),G}function oe(K){var G=K[0],Q=K[1],V=Q-G,H=I(G,360),ee=H+V,J=Math.cos(F(H)),W=Math.sin(F(H)),re=Math.cos(F(ee)),j=Math.sin(F(ee)),Z,ne,le,ge;return H<=90&&ee>=90||H>90&&ee>=450?ge=1:W<=0&&j<=0?ge=0:ge=Math.max(W,j),H<=180&&ee>=180||H>180&&ee>=540?Z=-1:J>=0&&re>=0?Z=0:Z=Math.min(J,re),H<=270&&ee>=270||H>270&&ee>=630?ne=-1:W>=0&&j>=0?ne=0:ne=Math.min(W,j),ee>=360?le=1:J<=0&&re<=0?le=0:le=Math.max(J,re),[Z,ne,le,ge]}function se(K,G){var Q=function(H){return E.angleDist(K,H)},V=E.findIndexOfMin(G,Q);return G[V]}function q(K,G,Q){return G?(K.attr("display",null),K.attr(Q)):K&&K.attr("display","none"),K}},{"../../components/color":366,"../../components/dragelement":385,"../../components/drawing":388,"../../components/fx":406,"../../components/titles":464,"../../constants/alignment":471,"../../lib":503,"../../lib/clear_gl_canvases":487,"../../lib/setcursor":524,"../../plot_api/subroutines":544,"../../plots/cartesian/axes":554,"../../registry":638,"../cartesian/autorange":553,"../cartesian/dragbox":563,"../cartesian/select":575,"../cartesian/set_convert":576,"../plots":619,"../smith/helpers":628,"./constants":620,"./helpers":621,"./set_convert":626,"@plotly/d3":58,tinycolor2:312}],626:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../cartesian/set_convert"),P=b.deg2rad,E=b.rad2deg;ae.exports=function(i,n,r){switch(k(i,r),i._id){case"x":case"radialaxis":e(i,n);break;case"angularaxis":a(i,n);break}};function e(t,i){var n=i._subplot;t.setGeometry=function(){var r=t._rl[0],d=t._rl[1],s=n.innerRadius,m=(n.radius-s)/(d-r),x=s/m,M=r>d?function(v){return v<=0}:function(v){return v>=0};t.c2g=function(v){var _=t.c2l(v)-r;return(M(_)?_:0)+x},t.g2c=function(v){return t.l2c(v+r-x)},t.g2p=function(v){return v*m},t.c2p=function(v){return t.g2p(t.c2g(v))}}}function p(t,i){return i==="degrees"?P(t):t}function g(t,i){return i==="degrees"?E(t):t}function a(t,i){var n=t.type;if(n==="linear"){var r=t.d2c,d=t.c2d;t.d2c=function(s,m){return p(r(s),m)},t.c2d=function(s,m){return d(g(s,m))}}t.makeCalcdata=function(s,m){var x=s[m],M=s._length,v,_,l=function(f){return t.d2c(f,s.thetaunit)};if(x){if(b.isTypedArray(x)&&n==="linear"){if(M===x.length)return x;if(x.subarray)return x.subarray(0,M)}for(v=new Array(M),_=0;_<M;_++)v[_]=l(x[_])}else{var y=m+"0",T="d"+m,w=y in s?l(s[y]):0,A=s[T]?l(s[T]):(t.period||2*Math.PI)/M;for(v=new Array(M),_=0;_<M;_++)v[_]=w+_*A}return v},t.setGeometry=function(){var s=i.sector,m=s.map(P),x={clockwise:-1,counterclockwise:1}[t.direction],M=P(t.rotation),v=function(u){return x*u+M},_=function(u){return(u-M)/x},l,y,T,w;switch(n){case"linear":y=l=b.identity,w=P,T=E,t.range=b.isFullCircle(m)?[s[0],s[0]+360]:m.map(_).map(E);break;case"category":var A=t._categories.length,f=t.period?Math.max(t.period,A):A;f===0&&(f=1),y=w=function(u){return u*2*Math.PI/f},l=T=function(u){return u*f/Math.PI/2},t.range=[0,f];break}t.c2g=function(u){return v(y(u))},t.g2c=function(u){return l(_(u))},t.t2g=function(u){return v(w(u))},t.g2t=function(u){return T(_(u))}}}},{"../../lib":503,"../cartesian/set_convert":576}],627:[function(c,ae,ie){"use strict";ae.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],628:[function(c,ae,ie){"use strict";function b(g){return g<0?-1:g>0?1:0}function k(g){var a=g[0],t=g[1];if(!isFinite(a)||!isFinite(t))return[1,0];var i=(a+1)*(a+1)+t*t;return[(a*a+t*t-1)/i,2*t/i]}function P(g,a){var t=a[0],i=a[1];return[t*g.radius+g.cx,-i*g.radius+g.cy]}function E(g,a){return a*g.radius}function e(g,a,t,i){var n=P(g,k([t,a])),r=n[0],d=n[1],s=P(g,k([i,a])),m=s[0],x=s[1];if(a===0)return["M"+r+","+d,"L"+m+","+x].join(" ");var M=E(g,1/Math.abs(a));return["M"+r+","+d,"A"+M+","+M+" 0 0,"+(a<0?1:0)+" "+m+","+x].join(" ")}function p(g,a,t,i){var n=E(g,1/(a+1)),r=P(g,k([a,t])),d=r[0],s=r[1],m=P(g,k([a,i])),x=m[0],M=m[1];if(b(t)!==b(i)){var v=P(g,k([a,0])),_=v[0],l=v[1];return["M"+d+","+s,"A"+n+","+n+" 0 0,"+(0<t?0:1)+" "+_+","+l,"A"+n+","+n+" 0 0,"+(i<0?0:1)+x+","+M].join(" ")}return["M"+d+","+s,"A"+n+","+n+" 0 0,"+(i<t?0:1)+" "+x+","+M].join(" ")}ae.exports={smith:k,reactanceArc:e,resistanceArc:p,smithTransform:P}},{}],629:[function(c,ae,ie){"use strict";var b=c("../get_data").getSubplotCalcData,k=c("../../lib").counterRegex,P=c("../polar/polar"),E=c("./constants"),e=E.attr,p=E.name,g=k(p),a={};a[e]={valType:"subplotid",dflt:p,editType:"calc"};function t(n){for(var r=n._fullLayout,d=n.calcdata,s=r._subplots[p],m=0;m<s.length;m++){var x=s[m],M=b(d,p,x),v=r[x]._subplot;v||(v=P(n,x,!0),r[x]._subplot=v),v.plot(M,r,n._promises)}}function i(n,r,d,s){for(var m=s._subplots[p]||[],x=0;x<m.length;x++){var M=m[x],v=s[M]._subplot;if(!r[M]&&!!v){v.framework.remove();for(var _ in v.clipPaths)v.clipPaths[_].remove()}}}ae.exports={attr:e,name:p,idRoot:p,idRegex:g,attrRegex:g,attributes:a,layoutAttributes:c("./layout_attributes"),supplyLayoutDefaults:c("./layout_defaults"),plot:t,clean:i,toSVG:c("../cartesian").toSVG}},{"../../lib":503,"../cartesian":568,"../get_data":593,"../polar/polar":625,"./constants":627,"./layout_attributes":630,"./layout_defaults":631}],630:[function(c,ae,ie){"use strict";var b=c("../../components/color/attributes"),k=c("../cartesian/layout_attributes"),P=c("../domain").attributes,E=c("../../lib").extendFlat,e=c("../../plot_api/edit_types").overrideAll,p=e({color:k.color,showline:E({},k.showline,{dflt:!0}),linecolor:k.linecolor,linewidth:k.linewidth,showgrid:E({},k.showgrid,{dflt:!0}),gridcolor:k.gridcolor,gridwidth:k.gridwidth},"plot","from-root"),g=e({ticklen:k.ticklen,tickwidth:E({},k.tickwidth,{dflt:2}),tickcolor:k.tickcolor,showticklabels:k.showticklabels,showtickprefix:k.showtickprefix,tickprefix:k.tickprefix,showticksuffix:k.showticksuffix,ticksuffix:k.ticksuffix,tickfont:k.tickfont,tickformat:k.tickformat,hoverformat:k.hoverformat,layer:k.layer},"plot","from-root"),a=E({visible:E({},k.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:E({},k.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},p,g),t=E({visible:E({},k.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:k.ticks,editType:"calc"},p,g);ae.exports={domain:P({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:b.background},realaxis:a,imaginaryaxis:t,editType:"calc"}},{"../../components/color/attributes":365,"../../lib":503,"../../plot_api/edit_types":536,"../cartesian/layout_attributes":569,"../domain":584}],631:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color"),P=c("../../plot_api/plot_template"),E=c("../subplot_defaults"),e=c("../get_data").getSubplotData,p=c("../cartesian/prefix_suffix_defaults"),g=c("../cartesian/tick_label_defaults"),a=c("../cartesian/line_grid_defaults"),t=c("../cartesian/set_convert"),i=c("./layout_attributes"),n=c("./constants"),r=n.axisNames,d=m(function(x){return x.slice().reverse().map(function(M){return-M}).concat([0]).concat(x)},String);function s(x,M,v,_){var l=v("bgcolor");_.bgColor=k.combine(l,_.paper_bgcolor);var y=e(_.fullData,n.name,_.id),T=_.layoutOut,w;function A(U,X){return v(w+"."+U,X)}for(var f=0;f<r.length;f++){w=r[f],b.isPlainObject(x[w])||(x[w]={});var u=x[w],h=P.newContainer(M,w);h._id=h._name=w,h._attr=_.id+"."+w,h._traceIndices=y.map(function(U){return U._expandedIndex});var o=A("visible");if(h.type="linear",t(h,T),p(u,h,A,h.type),o){var S=w==="realaxis";if(S&&A("side"),S)A("tickvals");else{var R=d(M.realaxis.tickvals||i.realaxis.tickvals.dflt);A("tickvals",R)}var z,O,I,F,D=_.font||{};o&&(z=A("color"),O=z===u.color?z:D.color,I=D.size,F=D.family),g(u,h,A,h.type,{noTicklabelstep:!0,noAng:!S,noExp:!0,font:{color:O,size:I,family:F}}),b.coerce2(x,M,i,w+".ticklen"),b.coerce2(x,M,i,w+".tickwidth"),b.coerce2(x,M,i,w+".tickcolor",M.color);var B=A("ticks");B||(delete M[w].ticklen,delete M[w].tickwidth,delete M[w].tickcolor),a(u,h,A,{dfltColor:z,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:i[w]}),A("layer")}A("hoverformat"),delete h.type,h._input=u}}ae.exports=function(M,v,_){E(M,v,_,{noUirevision:!0,type:n.name,attributes:i,handleDefaults:s,font:v.font,paper_bgcolor:v.paper_bgcolor,fullData:_,layoutOut:v})};function m(x,M){var v={};return function(_){var l=M?M(_):_;if(l in v)return v[l];var y=x(_);return v[l]=y,y}}},{"../../components/color":366,"../../lib":503,"../../plot_api/plot_template":543,"../cartesian/line_grid_defaults":571,"../cartesian/prefix_suffix_defaults":573,"../cartesian/set_convert":576,"../cartesian/tick_label_defaults":578,"../get_data":593,"../subplot_defaults":632,"./constants":627,"./layout_attributes":630}],632:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("../plot_api/plot_template"),P=c("./domain").defaults;ae.exports=function(e,p,g,a){var t=a.type,i=a.attributes,n=a.handleDefaults,r=a.partition||"x",d=p._subplots[t],s=d.length,m=s&&d[0].replace(/\d+$/,""),x,M;function v(T,w){return b.coerce(x,M,i,T,w)}for(var _=0;_<s;_++){var l=d[_];e[l]?x=e[l]:x=e[l]={},M=k.newContainer(p,l,m),a.noUirevision||v("uirevision",p.uirevision);var y={};y[r]=[_/s,(_+1)/s],P(M,p,v,y),a.id=l,n(x,M,v,a)}}},{"../lib":503,"../plot_api/plot_template":543,"./domain":584}],633:[function(c,ae,ie){"use strict";var b=c("../constants/docs"),k=b.FORMAT_LINK,P=b.DATE_FORMAT_LINK;function E(p){var g=p&&p.supportOther;return["Variables are inserted using %{variable},",'for example "y: %{y}"'+(g?" as well as %{xother}, {%_xother}, {%_xother_}, {%xother_}. When showing info for several points, *xother* will be added to those with different x positions from the first point. An underscore before or after *(x|y)other* will add a space on that side, only when this field is shown.":"."),`Numbers are formatted using d3-format's syntax %{variable:d3-format}, for example "Price: %{y:$.2f}".`,k,"for details on the formatting syntax.",`Dates are formatted using d3-time-format's syntax %{variable|d3-time-format}, for example "Day: %{2019-01-01|%A}".`,P,"for details on the date formatting syntax."].join(" ")}function e(p){var g=p.description?" "+p.description:"",a=p.keys||[];if(a.length>0){for(var t=[],i=0;i<a.length;i++)t[i]="`"+a[i]+"`";g=g+"Finally, the template string has access to ",a.length===1?g="variable "+t[0]:g="variables "+t.slice(0,-1).join(", ")+" and "+t.slice(-1)+"."}return g}ie.hovertemplateAttrs=function(p,g){p=p||{},g=g||{};var a=e(g),t={valType:"string",dflt:"",editType:p.editType||"none"};return p.arrayOk!==!1&&(t.arrayOk=!0),t},ie.texttemplateAttrs=function(p,g){p=p||{},g=g||{};var a=e(g),t={valType:"string",dflt:"",editType:p.editType||"calc"};return p.arrayOk!==!1&&(t.arrayOk=!0),t}},{"../constants/docs":474}],634:[function(c,ae,ie){"use strict";var b=c("./ternary"),k=c("../../plots/get_data").getSubplotCalcData,P=c("../../lib").counterRegex,E="ternary";ie.name=E;var e=ie.attr="subplot";ie.idRoot=E,ie.idRegex=ie.attrRegex=P(E);var p=ie.attributes={};p[e]={valType:"subplotid",dflt:"ternary",editType:"calc"},ie.layoutAttributes=c("./layout_attributes"),ie.supplyLayoutDefaults=c("./layout_defaults"),ie.plot=function(a){for(var t=a._fullLayout,i=a.calcdata,n=t._subplots[E],r=0;r<n.length;r++){var d=n[r],s=k(i,E,d),m=t[d]._subplot;m||(m=new b({id:d,graphDiv:a,container:t._ternarylayer.node()},t),t[d]._subplot=m),m.plot(s,t,a._promises)}},ie.clean=function(g,a,t,i){for(var n=i._subplots[E]||[],r=0;r<n.length;r++){var d=n[r],s=i[d]._subplot;!a[d]&&!!s&&(s.plotContainer.remove(),s.clipDef.remove(),s.clipDefRelative.remove(),s.layers["a-title"].remove(),s.layers["b-title"].remove(),s.layers["c-title"].remove())}}},{"../../lib":503,"../../plots/get_data":593,"./layout_attributes":635,"./layout_defaults":636,"./ternary":637}],635:[function(c,ae,ie){"use strict";var b=c("../../components/color/attributes"),k=c("../domain").attributes,P=c("../cartesian/layout_attributes"),E=c("../../plot_api/edit_types").overrideAll,e=c("../../lib/extend").extendFlat,p={title:{text:P.title.text,font:P.title.font},color:P.color,tickmode:P.tickmode,nticks:e({},P.nticks,{dflt:6,min:1}),tick0:P.tick0,dtick:P.dtick,tickvals:P.tickvals,ticktext:P.ticktext,ticks:P.ticks,ticklen:P.ticklen,tickwidth:P.tickwidth,tickcolor:P.tickcolor,ticklabelstep:P.ticklabelstep,showticklabels:P.showticklabels,showtickprefix:P.showtickprefix,tickprefix:P.tickprefix,showticksuffix:P.showticksuffix,ticksuffix:P.ticksuffix,showexponent:P.showexponent,exponentformat:P.exponentformat,minexponent:P.minexponent,separatethousands:P.separatethousands,tickfont:P.tickfont,tickangle:P.tickangle,tickformat:P.tickformat,tickformatstops:P.tickformatstops,hoverformat:P.hoverformat,showline:e({},P.showline,{dflt:!0}),linecolor:P.linecolor,linewidth:P.linewidth,showgrid:e({},P.showgrid,{dflt:!0}),gridcolor:P.gridcolor,gridwidth:P.gridwidth,layer:P.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:P._deprecated.title,titlefont:P._deprecated.titlefont}},g=ae.exports=E({domain:k({name:"ternary"}),bgcolor:{valType:"color",dflt:b.background},sum:{valType:"number",dflt:1,min:0},aaxis:p,baxis:p,caxis:p},"plot","from-root");g.uirevision={valType:"any",editType:"none"},g.aaxis.uirevision=g.baxis.uirevision=g.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":365,"../../lib/extend":493,"../../plot_api/edit_types":536,"../cartesian/layout_attributes":569,"../domain":584}],636:[function(c,ae,ie){"use strict";var b=c("../../components/color"),k=c("../../plot_api/plot_template"),P=c("../../lib"),E=c("../subplot_defaults"),e=c("../cartesian/tick_label_defaults"),p=c("../cartesian/prefix_suffix_defaults"),g=c("../cartesian/tick_mark_defaults"),a=c("../cartesian/tick_value_defaults"),t=c("../cartesian/line_grid_defaults"),i=c("./layout_attributes"),n=["aaxis","baxis","caxis"];ae.exports=function(m,x,M){E(m,x,M,{type:"ternary",attributes:i,handleDefaults:r,font:x.font,paper_bgcolor:x.paper_bgcolor})};function r(s,m,x,M){var v=x("bgcolor"),_=x("sum");M.bgColor=b.combine(v,M.paper_bgcolor);for(var l,y,T,w=0;w<n.length;w++)l=n[w],y=s[l]||{},T=k.newContainer(m,l),T._name=l,d(y,T,M,m);var A=m.aaxis,f=m.baxis,u=m.caxis;A.min+f.min+u.min>=_&&(A.min=0,f.min=0,u.min=0,s.aaxis&&delete s.aaxis.min,s.baxis&&delete s.baxis.min,s.caxis&&delete s.caxis.min)}function d(s,m,x,M){var v=i[m._name];function _(h,o){return P.coerce(s,m,v,h,o)}_("uirevision",M.uirevision),m.type="linear";var l=_("color"),y=l!==v.color.dflt?l:x.font.color,T=m._name,w=T.charAt(0).toUpperCase(),A="Component "+w,f=_("title.text",A);m._hovertitle=f===A?f:w,P.coerceFont(_,"title.font",{family:x.font.family,size:P.bigFont(x.font.size),color:y}),_("min"),a(s,m,_,"linear"),p(s,m,_,"linear"),e(s,m,_,"linear"),g(s,m,_,{outerTicks:!0});var u=_("showticklabels");u&&(P.coerceFont(_,"tickfont",{family:x.font.family,size:x.font.size,color:y}),_("tickangle"),_("tickformat")),t(s,m,_,{dfltColor:l,bgColor:x.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:v}),_("hoverformat"),_("layer")}},{"../../components/color":366,"../../lib":503,"../../plot_api/plot_template":543,"../cartesian/line_grid_defaults":571,"../cartesian/prefix_suffix_defaults":573,"../cartesian/tick_label_defaults":578,"../cartesian/tick_mark_defaults":579,"../cartesian/tick_value_defaults":580,"../subplot_defaults":632,"./layout_attributes":635}],637:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("tinycolor2"),P=c("../../registry"),E=c("../../lib"),e=E.strTranslate,p=E._,g=c("../../components/color"),a=c("../../components/drawing"),t=c("../cartesian/set_convert"),i=c("../../lib/extend").extendFlat,n=c("../plots"),r=c("../cartesian/axes"),d=c("../../components/dragelement"),s=c("../../components/fx"),m=c("../../components/dragelement/helpers"),x=m.freeMode,M=m.rectMode,v=c("../../components/titles"),_=c("../cartesian/select").prepSelect,l=c("../cartesian/select").selectOnClick,y=c("../cartesian/select").clearSelect,T=c("../cartesian/select").clearSelectionsCache,w=c("../cartesian/constants");function A(D,B){this.id=D.id,this.graphDiv=D.graphDiv,this.init(B),this.makeFramework(B),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}ae.exports=A;var f=A.prototype;f.init=function(D){this.container=D._ternarylayer,this.defs=D._defs,this.layoutId=D._uid,this.traceHash={},this.layers={}},f.plot=function(D,B){var U=this,X=B[U.id],oe=B._size;U._hasClipOnAxisFalse=!1;for(var se=0;se<D.length;se++){var q=D[se][0].trace;if(q.cliponaxis===!1){U._hasClipOnAxisFalse=!0;break}}U.updateLayers(X),U.adjustLayout(X,oe),n.generalUpdatePerTraceModule(U.graphDiv,U,D,X),U.layers.plotbg.select("path").call(g.fill,X.bgcolor)},f.makeFramework=function(D){var B=this,U=B.graphDiv,X=D[B.id],oe=B.clipId="clip"+B.layoutId+B.id,se=B.clipIdRelative="clip-relative"+B.layoutId+B.id;B.clipDef=E.ensureSingleById(D._clips,"clipPath",oe,function(q){q.append("path").attr("d","M0,0Z")}),B.clipDefRelative=E.ensureSingleById(D._clips,"clipPath",se,function(q){q.append("path").attr("d","M0,0Z")}),B.plotContainer=E.ensureSingle(B.container,"g",B.id),B.updateLayers(X),a.setClipUrl(B.layers.backplot,oe,U),a.setClipUrl(B.layers.grids,oe,U)},f.updateLayers=function(D){var B=this,U=B.layers,X=["draglayer","plotbg","backplot","grids"];D.aaxis.layer==="below traces"&&X.push("aaxis","aline"),D.baxis.layer==="below traces"&&X.push("baxis","bline"),D.caxis.layer==="below traces"&&X.push("caxis","cline"),X.push("frontplot"),D.aaxis.layer==="above traces"&&X.push("aaxis","aline"),D.baxis.layer==="above traces"&&X.push("baxis","bline"),D.caxis.layer==="above traces"&&X.push("caxis","cline");var oe=B.plotContainer.selectAll("g.toplevel").data(X,String),se=["agrid","bgrid","cgrid"];oe.enter().append("g").attr("class",function(q){return"toplevel "+q}).each(function(q){var K=b.select(this);U[q]=K,q==="frontplot"?K.append("g").classed("scatterlayer",!0):q==="backplot"?K.append("g").classed("maplayer",!0):q==="plotbg"?K.append("path").attr("d","M0,0Z"):q==="aline"||q==="bline"||q==="cline"?K.append("path"):q==="grids"&&se.forEach(function(G){U[G]=K.append("g").classed("grid "+G,!0)})}),oe.order()};var u=Math.sqrt(4/3);f.adjustLayout=function(D,B){var U=this,X=D.domain,oe=(X.x[0]+X.x[1])/2,se=(X.y[0]+X.y[1])/2,q=X.x[1]-X.x[0],K=X.y[1]-X.y[0],G=q*B.w,Q=K*B.h,V=D.sum,H=D.aaxis.min,ee=D.baxis.min,J=D.caxis.min,W,re,j,Z,ne,le;G>u*Q?(Z=Q,j=Z*u):(j=G,Z=j/u),ne=q*j/G,le=K*Z/Q,W=B.l+B.w*oe-j/2,re=B.t+B.h*(1-se)-Z/2,U.x0=W,U.y0=re,U.w=j,U.h=Z,U.sum=V,U.xaxis={type:"linear",range:[H+2*J-V,V-H-2*ee],domain:[oe-ne/2,oe+ne/2],_id:"x"},t(U.xaxis,U.graphDiv._fullLayout),U.xaxis.setScale(),U.xaxis.isPtWithinRange=function(ke){return ke.a>=U.aaxis.range[0]&&ke.a<=U.aaxis.range[1]&&ke.b>=U.baxis.range[1]&&ke.b<=U.baxis.range[0]&&ke.c>=U.caxis.range[1]&&ke.c<=U.caxis.range[0]},U.yaxis={type:"linear",range:[H,V-ee-J],domain:[se-le/2,se+le/2],_id:"y"},t(U.yaxis,U.graphDiv._fullLayout),U.yaxis.setScale(),U.yaxis.isPtWithinRange=function(){return!0};var ge=U.yaxis.domain[0],pe=U.aaxis=i({},D.aaxis,{range:[H,V-ee-J],side:"left",tickangle:(+D.aaxis.tickangle||0)-30,domain:[ge,ge+le*u],anchor:"free",position:0,_id:"y",_length:j});t(pe,U.graphDiv._fullLayout),pe.setScale();var xe=U.baxis=i({},D.baxis,{range:[V-H-J,ee],side:"bottom",domain:U.xaxis.domain,anchor:"free",position:0,_id:"x",_length:j});t(xe,U.graphDiv._fullLayout),xe.setScale();var Ee=U.caxis=i({},D.caxis,{range:[V-H-ee,J],side:"right",tickangle:(+D.caxis.tickangle||0)+30,domain:[ge,ge+le*u],anchor:"free",position:0,_id:"y",_length:j});t(Ee,U.graphDiv._fullLayout),Ee.setScale();var Te="M"+W+","+(re+Z)+"h"+j+"l-"+j/2+",-"+Z+"Z";U.clipDef.select("path").attr("d",Te),U.layers.plotbg.select("path").attr("d",Te);var de="M0,"+Z+"h"+j+"l-"+j/2+",-"+Z+"Z";U.clipDefRelative.select("path").attr("d",de);var be=e(W,re);U.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",be),U.clipDefRelative.select("path").attr("transform",null);var Le=e(W-xe._offset,re+Z);U.layers.baxis.attr("transform",Le),U.layers.bgrid.attr("transform",Le);var De=e(W+j/2,re)+"rotate(30)"+e(0,-pe._offset);U.layers.aaxis.attr("transform",De),U.layers.agrid.attr("transform",De);var ye=e(W+j/2,re)+"rotate(-30)"+e(0,-Ee._offset);U.layers.caxis.attr("transform",ye),U.layers.cgrid.attr("transform",ye),U.drawAxes(!0),U.layers.aline.select("path").attr("d",pe.showline?"M"+W+","+(re+Z)+"l"+j/2+",-"+Z:"M0,0").call(g.stroke,pe.linecolor||"#000").style("stroke-width",(pe.linewidth||0)+"px"),U.layers.bline.select("path").attr("d",xe.showline?"M"+W+","+(re+Z)+"h"+j:"M0,0").call(g.stroke,xe.linecolor||"#000").style("stroke-width",(xe.linewidth||0)+"px"),U.layers.cline.select("path").attr("d",Ee.showline?"M"+(W+j/2)+","+re+"l"+j/2+","+Z:"M0,0").call(g.stroke,Ee.linecolor||"#000").style("stroke-width",(Ee.linewidth||0)+"px"),U.graphDiv._context.staticPlot||U.initInteractions(),a.setClipUrl(U.layers.frontplot,U._hasClipOnAxisFalse?null:U.clipId,U.graphDiv)},f.drawAxes=function(D){var B=this,U=B.graphDiv,X=B.id.substr(7)+"title",oe=B.layers,se=B.aaxis,q=B.baxis,K=B.caxis;if(B.drawAx(se),B.drawAx(q),B.drawAx(K),D){var G=Math.max(se.showticklabels?se.tickfont.size/2:0,(K.showticklabels?K.tickfont.size*.75:0)+(K.ticks==="outside"?K.ticklen*.87:0)),Q=(q.showticklabels?q.tickfont.size:0)+(q.ticks==="outside"?q.ticklen:0)+3;oe["a-title"]=v.draw(U,"a"+X,{propContainer:se,propName:B.id+".aaxis.title",placeholder:p(U,"Click to enter Component A title"),attributes:{x:B.x0+B.w/2,y:B.y0-se.title.font.size/3-G,"text-anchor":"middle"}}),oe["b-title"]=v.draw(U,"b"+X,{propContainer:q,propName:B.id+".baxis.title",placeholder:p(U,"Click to enter Component B title"),attributes:{x:B.x0-Q,y:B.y0+B.h+q.title.font.size*.83+Q,"text-anchor":"middle"}}),oe["c-title"]=v.draw(U,"c"+X,{propContainer:K,propName:B.id+".caxis.title",placeholder:p(U,"Click to enter Component C title"),attributes:{x:B.x0+B.w+Q,y:B.y0+B.h+K.title.font.size*.83+Q,"text-anchor":"middle"}})}},f.drawAx=function(D){var B=this,U=B.graphDiv,X=D._name,oe=X.charAt(0),se=D._id,q=B.layers[X],K=30,G=oe+"tickLayout",Q=h(D);B[G]!==Q&&(q.selectAll("."+se+"tick").remove(),B[G]=Q),D.setScale();var V=r.calcTicks(D),H=r.clipEnds(D,V),ee=r.makeTransTickFn(D),J=r.getTickSigns(D)[2],W=E.deg2rad(K),re=J*(D.linewidth||1)/2,j=J*D.ticklen,Z=B.w,ne=B.h,le=oe==="b"?"M0,"+re+"l"+Math.sin(W)*j+","+Math.cos(W)*j:"M"+re+",0l"+Math.cos(W)*j+","+-Math.sin(W)*j,ge={a:"M0,0l"+ne+",-"+Z/2,b:"M0,0l-"+Z/2+",-"+ne,c:"M0,0l-"+ne+","+Z/2}[oe];r.drawTicks(U,D,{vals:D.ticks==="inside"?H:V,layer:q,path:le,transFn:ee,crisp:!1}),r.drawGrid(U,D,{vals:H,layer:B.layers[oe+"grid"],path:ge,transFn:ee,crisp:!1}),r.drawLabels(U,D,{vals:V,layer:q,transFn:ee,labelFns:r.makeLabelFns(D,0,K)})};function h(D){return D.ticks+String(D.ticklen)+String(D.showticklabels)}var o=w.MINZOOM/2+.87,S="m-0.87,.5h"+o+"v3h-"+(o+5.2)+"l"+(o/2+2.6)+",-"+(o*.87+4.5)+"l2.6,1.5l-"+o/2+","+o*.87+"Z",R="m0.87,.5h-"+o+"v3h"+(o+5.2)+"l-"+(o/2+2.6)+",-"+(o*.87+4.5)+"l-2.6,1.5l"+o/2+","+o*.87+"Z",z="m0,1l"+o/2+","+o*.87+"l2.6,-1.5l-"+(o/2+2.6)+",-"+(o*.87+4.5)+"l-"+(o/2+2.6)+","+(o*.87+4.5)+"l2.6,1.5l"+o/2+",-"+o*.87+"Z",O="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z",I=!0;f.clearSelect=function(){T(this.dragOptions),y(this.dragOptions.gd)},f.initInteractions=function(){var D=this,B=D.layers.plotbg.select("path").node(),U=D.graphDiv,X=U._fullLayout._zoomlayer,oe,se;this.dragOptions={element:B,gd:U,plotinfo:{id:D.id,domain:U._fullLayout[D.id].domain,xaxis:D.xaxis,yaxis:D.yaxis},subplot:D.id,prepFn:function(Le,De,ye){D.dragOptions.xaxes=[D.xaxis],D.dragOptions.yaxes=[D.yaxis],oe=U._fullLayout._invScaleX,se=U._fullLayout._invScaleY;var ke=D.dragOptions.dragmode=U._fullLayout.dragmode;x(ke)?D.dragOptions.minDrag=1:D.dragOptions.minDrag=void 0,ke==="zoom"?(D.dragOptions.moveFn=xe,D.dragOptions.clickFn=Z,D.dragOptions.doneFn=Ee,ne(Le,De,ye)):ke==="pan"?(D.dragOptions.moveFn=de,D.dragOptions.clickFn=Z,D.dragOptions.doneFn=be,Te(),D.clearSelect(U)):(M(ke)||x(ke))&&_(Le,De,ye,D.dragOptions,ke)}};var q,K,G,Q,V,H,ee,J,W,re;function j(Le){var De={};return De[D.id+".aaxis.min"]=Le.a,De[D.id+".baxis.min"]=Le.b,De[D.id+".caxis.min"]=Le.c,De}function Z(Le,De){var ye=U._fullLayout.clickmode;F(U),Le===2&&(U.emit("plotly_doubleclick",null),P.call("_guiRelayout",U,j({a:0,b:0,c:0}))),ye.indexOf("select")>-1&&Le===1&&l(De,U,[D.xaxis],[D.yaxis],D.id,D.dragOptions),ye.indexOf("event")>-1&&s.click(U,De,D.id)}function ne(Le,De,ye){var ke=B.getBoundingClientRect();q=De-ke.left,K=ye-ke.top,U._fullLayout._calcInverseTransform(U);var Oe=U._fullLayout._invTransform,Qe=E.apply3DTransform(Oe)(q,K);q=Qe[0],K=Qe[1],G={a:D.aaxis.range[0],b:D.baxis.range[1],c:D.caxis.range[1]},V=G,Q=D.aaxis.range[1]-G.a,H=k(D.graphDiv._fullLayout[D.id].bgcolor).getLuminance(),ee="M0,"+D.h+"L"+D.w/2+", 0L"+D.w+","+D.h+"Z",J=!1,W=X.append("path").attr("class","zoombox").attr("transform",e(D.x0,D.y0)).style({fill:H>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",ee),re=X.append("path").attr("class","zoombox-corners").attr("transform",e(D.x0,D.y0)).style({fill:g.background,stroke:g.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),D.clearSelect(U)}function le(Le,De){return 1-De/D.h}function ge(Le,De){return 1-(Le+(D.h-De)/Math.sqrt(3))/D.w}function pe(Le,De){return(Le-(D.h-De)/Math.sqrt(3))/D.w}function xe(Le,De){var ye=q+Le*oe,ke=K+De*se,Oe=Math.max(0,Math.min(1,le(q,K),le(ye,ke))),Qe=Math.max(0,Math.min(1,ge(q,K),ge(ye,ke))),Ve=Math.max(0,Math.min(1,pe(q,K),pe(ye,ke))),Ue=(Oe/2+Ve)*D.w,Ie=(1-Oe/2-Qe)*D.w,at=(Ue+Ie)/2,pt=Ie-Ue,Rt=(1-Oe)*D.h,Mt=Rt-pt/u;pt<w.MINZOOM?(V=G,W.attr("d",ee),re.attr("d","M0,0Z")):(V={a:G.a+Oe*Q,b:G.b+Qe*Q,c:G.c+Ve*Q},W.attr("d",ee+"M"+Ue+","+Rt+"H"+Ie+"L"+at+","+Mt+"L"+Ue+","+Rt+"Z"),re.attr("d","M"+q+","+K+O+"M"+Ue+","+Rt+S+"M"+Ie+","+Rt+R+"M"+at+","+Mt+z)),J||(W.transition().style("fill",H>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),re.transition().style("opacity",1).duration(200),J=!0),U.emit("plotly_relayouting",j(V))}function Ee(){F(U),V!==G&&(P.call("_guiRelayout",U,j(V)),I&&U.data&&U._context.showTips&&(E.notifier(p(U,"Double-click to zoom back out"),"long"),I=!1))}function Te(){G={a:D.aaxis.range[0],b:D.baxis.range[1],c:D.caxis.range[1]},V=G}function de(Le,De){var ye=Le/D.xaxis._m,ke=De/D.yaxis._m;V={a:G.a-ke,b:G.b+(ye+ke)/2,c:G.c-(ye-ke)/2};var Oe=[V.a,V.b,V.c].sort(E.sorterAsc),Qe={a:Oe.indexOf(V.a),b:Oe.indexOf(V.b),c:Oe.indexOf(V.c)};Oe[0]<0&&(Oe[1]+Oe[0]/2<0?(Oe[2]+=Oe[0]+Oe[1],Oe[0]=Oe[1]=0):(Oe[2]+=Oe[0]/2,Oe[1]+=Oe[0]/2,Oe[0]=0),V={a:Oe[Qe.a],b:Oe[Qe.b],c:Oe[Qe.c]},De=(G.a-V.a)*D.yaxis._m,Le=(G.c-V.c-G.b+V.b)*D.xaxis._m);var Ve=e(D.x0+Le,D.y0+De);D.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Ve);var Ue=e(-Le,-De);D.clipDefRelative.select("path").attr("transform",Ue),D.aaxis.range=[V.a,D.sum-V.b-V.c],D.baxis.range=[D.sum-V.a-V.c,V.b],D.caxis.range=[D.sum-V.a-V.b,V.c],D.drawAxes(!1),D._hasClipOnAxisFalse&&D.plotContainer.select(".scatterlayer").selectAll(".trace").call(a.hideOutsideRangePoints,D),U.emit("plotly_relayouting",j(V))}function be(){P.call("_guiRelayout",U,j(V))}B.onmousemove=function(Le){s.hover(U,Le,D.id),U._fullLayout._lasthover=B,U._fullLayout._hoversubplot=D.id},B.onmouseout=function(Le){U._dragging||d.unhover(U,Le)},d.init(this.dragOptions)};function F(D){b.select(D).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}},{"../../components/color":366,"../../components/dragelement":385,"../../components/dragelement/helpers":384,"../../components/drawing":388,"../../components/fx":406,"../../components/titles":464,"../../lib":503,"../../lib/extend":493,"../../registry":638,"../cartesian/axes":554,"../cartesian/constants":561,"../cartesian/select":575,"../cartesian/set_convert":576,"../plots":619,"@plotly/d3":58,tinycolor2:312}],638:[function(c,ae,ie){"use strict";var b=c("./lib/loggers"),k=c("./lib/noop"),P=c("./lib/push_unique"),E=c("./lib/is_plain_object"),e=c("./lib/dom").addStyleRule,p=c("./lib/extend"),g=c("./plots/attributes"),a=c("./plots/layout_attributes"),t=p.extendFlat,i=p.extendDeepAll;ie.modules={},ie.allCategories={},ie.allTypes=[],ie.subplotsRegistry={},ie.transformsRegistry={},ie.componentsRegistry={},ie.layoutArrayContainers=[],ie.layoutArrayRegexes=[],ie.traceLayoutAttributes={},ie.localeRegistry={},ie.apiMethodRegistry={},ie.collectableSubplotTypes=null,ie.register=function(T){if(ie.collectableSubplotTypes=null,T)T&&!Array.isArray(T)&&(T=[T]);else throw new Error("No argument passed to Plotly.register.");for(var w=0;w<T.length;w++){var A=T[w];if(!A)throw new Error("Invalid module was attempted to be registered!");switch(A.moduleType){case"trace":n(A);break;case"transform":s(A);break;case"component":d(A);break;case"locale":m(A);break;case"apiMethod":var f=A.name;ie.apiMethodRegistry[f]=A.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},ie.getModule=function(y){var T=ie.modules[l(y)];return T?T._module:!1},ie.traceIs=function(y,T){if(y=l(y),y==="various")return!1;var w=ie.modules[y];return w||(y&&b.log("Unrecognized trace type "+y+"."),w=ie.modules[g.type.dflt]),!!w.categories[T]},ie.getTransformIndices=function(y,T){for(var w=[],A=y.transforms||[],f=0;f<A.length;f++)A[f].type===T&&w.push(f);return w},ie.hasTransform=function(y,T){for(var w=y.transforms||[],A=0;A<w.length;A++)if(w[A].type===T)return!0;return!1},ie.getComponentMethod=function(y,T){var w=ie.componentsRegistry[y];return w&&w[T]||k},ie.call=function(){var y=arguments[0],T=[].slice.call(arguments,1);return ie.apiMethodRegistry[y].apply(null,T)};function n(y){var T=y.name,w=y.categories,A=y.meta;if(ie.modules[T]){b.log("Type "+T+" already registered");return}ie.subplotsRegistry[y.basePlotModule.name]||r(y.basePlotModule);for(var f={},u=0;u<w.length;u++)f[w[u]]=!0,ie.allCategories[w[u]]=!0;ie.modules[T]={_module:y,categories:f},A&&Object.keys(A).length&&(ie.modules[T].meta=A),ie.allTypes.push(T);for(var h in ie.componentsRegistry)M(h,T);y.layoutAttributes&&t(ie.traceLayoutAttributes,y.layoutAttributes);var o=y.basePlotModule,S=o.name;if(S==="mapbox"){var R=o.constants.styleRules;for(var z in R)e(".js-plotly-plot .plotly .mapboxgl-"+z,R[z])}(S==="geo"||S==="mapbox")&&typeof window!==void 0&&window.PlotlyGeoAssets===void 0&&(window.PlotlyGeoAssets={topojson:{}})}function r(y){var T=y.name;if(ie.subplotsRegistry[T]){b.log("Plot type "+T+" already registered.");return}x(y),ie.subplotsRegistry[T]=y;for(var w in ie.componentsRegistry)_(w,y.name)}function d(y){if(typeof y.name!="string")throw new Error("Component module *name* must be a string.");var T=y.name;ie.componentsRegistry[T]=y,y.layoutAttributes&&(y.layoutAttributes._isLinkedToArray&&P(ie.layoutArrayContainers,T),x(y));for(var w in ie.modules)M(T,w);for(var A in ie.subplotsRegistry)_(T,A);for(var f in ie.transformsRegistry)v(T,f);y.schema&&y.schema.layout&&i(a,y.schema.layout)}function s(y){if(typeof y.name!="string")throw new Error("Transform module *name* must be a string.");var T="Transform module "+y.name,w=typeof y.transform=="function",A=typeof y.calcTransform=="function";if(!w&&!A)throw new Error(T+" is missing a *transform* or *calcTransform* method.");w&&A&&b.log([T+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),E(y.attributes)||b.log(T+" registered without an *attributes* object."),typeof y.supplyDefaults!="function"&&b.log(T+" registered without a *supplyDefaults* method."),ie.transformsRegistry[y.name]=y;for(var f in ie.componentsRegistry)v(f,y.name)}function m(y){var T=y.name,w=T.split("-")[0],A=y.dictionary,f=y.format,u=A&&Object.keys(A).length,h=f&&Object.keys(f).length,o=ie.localeRegistry,S=o[T];if(S||(o[T]=S={}),w!==T){var R=o[w];R||(o[w]=R={}),u&&R.dictionary===S.dictionary&&(R.dictionary=A),h&&R.format===S.format&&(R.format=f)}u&&(S.dictionary=A),h&&(S.format=f)}function x(y){if(y.layoutAttributes){var T=y.layoutAttributes._arrayAttrRegexps;if(T)for(var w=0;w<T.length;w++)P(ie.layoutArrayRegexes,T[w])}}function M(y,T){var w=ie.componentsRegistry[y].schema;if(!(!w||!w.traces)){var A=w.traces[T];A&&i(ie.modules[T]._module.attributes,A)}}function v(y,T){var w=ie.componentsRegistry[y].schema;if(!(!w||!w.transforms)){var A=w.transforms[T];A&&i(ie.transformsRegistry[T].attributes,A)}}function _(y,T){var w=ie.componentsRegistry[y].schema;if(!(!w||!w.subplots)){var A=ie.subplotsRegistry[T],f=A.layoutAttributes,u=A.attr==="subplot"?A.name:A.attr;Array.isArray(u)&&(u=u[0]);var h=w.subplots[u];f&&h&&i(f,h)}}function l(y){return typeof y=="object"&&(y=y.type),y}},{"./lib/dom":491,"./lib/extend":493,"./lib/is_plain_object":504,"./lib/loggers":507,"./lib/noop":512,"./lib/push_unique":518,"./plots/attributes":550,"./plots/layout_attributes":610}],639:[function(c,ae,ie){"use strict";var b=c("../registry"),k=c("../lib"),P=k.extendFlat,E=k.extendDeep;function e(g){var a;switch(g){case"themes__thumb":a={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":a={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:a={}}return a}function p(g){var a=["xaxis","yaxis","zaxis"];return a.indexOf(g.slice(0,5))>-1}ae.exports=function(a,t){var i,n=a.data,r=a.layout,d=E([],n),s=E({},r,e(t.tileClass)),m=a._context||{};if(t.width&&(s.width=t.width),t.height&&(s.height=t.height),t.tileClass==="thumbnail"||t.tileClass==="themes__thumb"){s.annotations=[];var x=Object.keys(s);for(i=0;i<x.length;i++)p(x[i])&&(s[x[i]].title={text:""});for(i=0;i<d.length;i++){var M=d[i];M.showscale=!1,M.marker&&(M.marker.showscale=!1),b.traceIs(M,"pie-like")&&(M.textposition="none")}}if(Array.isArray(t.annotations))for(i=0;i<t.annotations.length;i++)s.annotations.push(t.annotations[i]);var v=Object.keys(s).filter(function(w){return w.match(/^scene\d*$/)});if(v.length){var _={};for(t.tileClass==="thumbnail"&&(_={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),i=0;i<v.length;i++){var l=s[v[i]];l.xaxis||(l.xaxis={}),l.yaxis||(l.yaxis={}),l.zaxis||(l.zaxis={}),P(l.xaxis,_),P(l.yaxis,_),P(l.zaxis,_),l._scene=null}}var y=document.createElement("div");t.tileClass&&(y.className=t.tileClass);var T={gd:y,td:y,layout:s,data:d,config:{staticPlot:t.staticPlot===void 0?!0:t.staticPlot,plotGlPixelRatio:t.plotGlPixelRatio===void 0?2:t.plotGlPixelRatio,displaylogo:t.displaylogo||!1,showLink:t.showLink||!1,showTips:t.showTips||!1,mapboxAccessToken:m.mapboxAccessToken}};return t.setBackground!=="transparent"&&(T.config.setBackground=t.setBackground||"opaque"),T.gd.defaultLayout=e(t.tileClass),T}},{"../lib":503,"../registry":638}],640:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("../plot_api/to_image"),P=c("./filesaver"),E=c("./helpers");function e(p,g){var a;return b.isPlainObject(p)||(a=b.getGraphDiv(p)),g=g||{},g.format=g.format||"png",g.width=g.width||null,g.height=g.height||null,g.imageDataOnly=!0,new Promise(function(t,i){a&&a._snapshotInProgress&&i(new Error("Snapshotting already in progress.")),b.isIE()&&g.format!=="svg"&&i(new Error(E.MSG_IE_BAD_FORMAT)),a&&(a._snapshotInProgress=!0);var n=k(p,g),r=g.filename||p.fn||"newplot";r+="."+g.format.replace("-","."),n.then(function(d){return a&&(a._snapshotInProgress=!1),P(d,r,g.format)}).then(function(d){t(d)}).catch(function(d){a&&(a._snapshotInProgress=!1),i(d)})})}ae.exports=e},{"../lib":503,"../plot_api/to_image":546,"./filesaver":641,"./helpers":642}],641:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("./helpers");function P(E,e,p){var g=document.createElement("a"),a="download"in g,t=new Promise(function(i,n){var r,d;if(b.isIE())return r=k.createBlob(E,"svg"),window.navigator.msSaveBlob(r,e),r=null,i(e);if(a)return r=k.createBlob(E,p),d=k.createObjectURL(r),g.href=d,g.download=e,document.body.appendChild(g),g.click(),document.body.removeChild(g),k.revokeObjectURL(d),r=null,i(e);if(b.isSafari()){var s=p==="svg"?",":";base64,";return k.octetStream(s+encodeURIComponent(E)),i(e)}n(new Error("download error"))});return t}ae.exports=P},{"../lib":503,"./helpers":642}],642:[function(c,ae,ie){"use strict";var b=c("../registry");ie.getDelay=function(E){return E._has&&(E._has("gl3d")||E._has("gl2d")||E._has("mapbox"))?500:0},ie.getRedrawFunc=function(E){return function(){b.getComponentMethod("colorbar","draw")(E)}},ie.encodeSVG=function(E){return"data:image/svg+xml,"+encodeURIComponent(E)},ie.encodeJSON=function(E){return"data:application/json,"+encodeURIComponent(E)};var k=window.URL||window.webkitURL;ie.createObjectURL=function(E){return k.createObjectURL(E)},ie.revokeObjectURL=function(E){return k.revokeObjectURL(E)},ie.createBlob=function(E,e){if(e==="svg")return new window.Blob([E],{type:"image/svg+xml;charset=utf-8"});if(e==="full-json")return new window.Blob([E],{type:"application/json;charset=utf-8"});var p=P(window.atob(E));return new window.Blob([p],{type:"image/"+e})},ie.octetStream=function(E){document.location.href="data:application/octet-stream"+E};function P(E){for(var e=E.length,p=new ArrayBuffer(e),g=new Uint8Array(p),a=0;a<e;a++)g[a]=E.charCodeAt(a);return p}ie.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,ie.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":638}],643:[function(c,ae,ie){"use strict";var b=c("./helpers"),k={getDelay:b.getDelay,getRedrawFunc:b.getRedrawFunc,clone:c("./cloneplot"),toSVG:c("./tosvg"),svgToImg:c("./svgtoimg"),toImage:c("./toimage"),downloadImage:c("./download")};ae.exports=k},{"./cloneplot":639,"./download":640,"./helpers":642,"./svgtoimg":644,"./toimage":645,"./tosvg":646}],644:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("events").EventEmitter,P=c("./helpers");function E(e){var p=e.emitter||new k,g=new Promise(function(a,t){var i=window.Image,n=e.svg,r=e.format||"png";if(b.isIE()&&r!=="svg"){var d=new Error(P.MSG_IE_BAD_FORMAT);return t(d),e.promise?g:p.emit("error",d)}var s=e.canvas,m=e.scale||1,x=e.width||300,M=e.height||150,v=m*x,_=m*M,l=s.getContext("2d"),y=new i,T,w;r==="svg"||b.isSafari()?w=P.encodeSVG(n):(T=P.createBlob(n,"svg"),w=P.createObjectURL(T)),s.width=v,s.height=_,y.onload=function(){var A;switch(T=null,P.revokeObjectURL(w),r!=="svg"&&l.drawImage(y,0,0,v,_),r){case"jpeg":A=s.toDataURL("image/jpeg");break;case"png":A=s.toDataURL("image/png");break;case"webp":A=s.toDataURL("image/webp");break;case"svg":A=w;break;default:var f="Image format is not jpeg, png, svg or webp.";if(t(new Error(f)),!e.promise)return p.emit("error",f)}a(A),e.promise||p.emit("success",A)},y.onerror=function(A){if(T=null,P.revokeObjectURL(w),t(A),!e.promise)return p.emit("error",A)},y.src=w});return e.promise?g:p}ae.exports=E},{"../lib":503,"./helpers":642,events:84}],645:[function(c,ae,ie){"use strict";var b=c("events").EventEmitter,k=c("../registry"),P=c("../lib"),E=c("./helpers"),e=c("./cloneplot"),p=c("./tosvg"),g=c("./svgtoimg");function a(t,i){var n=new b,r=e(t,{format:"png"}),d=r.gd;d.style.position="absolute",d.style.left="-5000px",document.body.appendChild(d);function s(){var x=E.getDelay(d._fullLayout);setTimeout(function(){var M=p(d),v=document.createElement("canvas");v.id=P.randstr(),n=g({format:i.format,width:d._fullLayout.width,height:d._fullLayout.height,canvas:v,emitter:n,svg:M}),n.clean=function(){d&&document.body.removeChild(d)}},x)}var m=E.getRedrawFunc(d);return k.call("_doPlot",d,r.data,r.layout,r.config).then(m).then(s).catch(function(x){n.emit("error",x)}),n}ae.exports=a},{"../lib":503,"../registry":638,"./cloneplot":639,"./helpers":642,"./svgtoimg":644,"./tosvg":646,events:84}],646:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../lib"),P=c("../components/drawing"),E=c("../components/color"),e=c("../constants/xmlns_namespaces"),p=/"/g,g="TOBESTRIPPED",a=new RegExp('("'+g+")|("+g+'")',"g");function t(n){var r=b.select("body").append("div").style({display:"none"}).html(""),d=n.replace(/(&[^;]*;)/gi,function(s){return s==="&lt;"?"&#60;":s==="&rt;"?"&#62;":s.indexOf("<")!==-1||s.indexOf(">")!==-1?"":r.html(s).text()});return r.remove(),d}function i(n){return n.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}ae.exports=function(r,d,s){var m=r._fullLayout,x=m._paper,M=m._toppaper,v=m.width,_=m.height,l;x.insert("rect",":first-child").call(P.setRect,0,0,v,_).call(E.fill,m.paper_bgcolor);var y=m._basePlotModules||[];for(l=0;l<y.length;l++){var T=y[l];T.toSVG&&T.toSVG(r)}if(M){var w=M.node().childNodes,A=Array.prototype.slice.call(w);for(l=0;l<A.length;l++){var f=A[l];f.childNodes.length&&x.node().appendChild(f)}}m._draggers&&m._draggers.remove(),x.node().style.background="",x.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var h=b.select(this);if(this.style.visibility==="hidden"||this.style.display==="none"){h.remove();return}else h.style({visibility:null,display:null});var o=this.style.fontFamily;o&&o.indexOf('"')!==-1&&h.style("font-family",o.replace(p,g))}),x.selectAll(".gradient_filled,.pattern_filled").each(function(){var h=b.select(this),o=this.style.fill;o&&o.indexOf("url(")!==-1&&h.style("fill",o.replace(p,g));var S=this.style.stroke;S&&S.indexOf("url(")!==-1&&h.style("stroke",S.replace(p,g))}),(d==="pdf"||d==="eps")&&x.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),x.node().setAttributeNS(e.xmlns,"xmlns",e.svg),x.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),d==="svg"&&s&&(x.attr("width",s*v),x.attr("height",s*_),x.attr("viewBox","0 0 "+v+" "+_));var u=new window.XMLSerializer().serializeToString(x.node());return u=t(u),u=i(u),u=u.replace(a,"'"),k.isIE()&&(u=u.replace(/"/gi,"'"),u=u.replace(/(\('#)([^']*)('\))/gi,'("#$2")'),u=u.replace(/(\\')/gi,'"')),u}},{"../components/color":366,"../components/drawing":388,"../constants/xmlns_namespaces":480,"../lib":503,"@plotly/d3":58}],647:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E){for(var e=0;e<P.length;e++)P[e].i=e;b.mergeArray(E.text,P,"tx"),b.mergeArray(E.hovertext,P,"htx");var p=E.marker;if(p){b.mergeArray(p.opacity,P,"mo",!0),b.mergeArray(p.color,P,"mc");var g=p.line;g&&(b.mergeArray(g.color,P,"mlc"),b.mergeArrayCastPositive(g.width,P,"mlw"))}}},{"../../lib":503}],648:[function(c,ae,ie){"use strict";var b=c("../scatter/attributes"),k=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,P=c("../../plots/template_attributes").hovertemplateAttrs,E=c("../../plots/template_attributes").texttemplateAttrs,e=c("../../components/colorscale/attributes"),p=c("../../plots/font_attributes"),g=c("./constants"),a=c("../../components/drawing/attributes").pattern,t=c("../../lib/extend").extendFlat,i=p({editType:"calc",arrayOk:!0,colorEditType:"style"}),n=b.marker,r=n.line,d=t({},r.width,{dflt:0}),s=t({width:d,editType:"calc"},e("marker.line")),m=t({line:s,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:a});ae.exports={x:b.x,x0:b.x0,dx:b.dx,y:b.y,y0:b.y0,dy:b.dy,xperiod:b.xperiod,yperiod:b.yperiod,xperiod0:b.xperiod0,yperiod0:b.yperiod0,xperiodalignment:b.xperiodalignment,yperiodalignment:b.yperiodalignment,xhoverformat:k("x"),yhoverformat:k("y"),text:b.text,texttemplate:E({editType:"plot"},{keys:g.eventDataKeys}),hovertext:b.hovertext,hovertemplate:P({},{keys:g.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:t({},i,{}),insidetextfont:t({},i,{}),outsidetextfont:t({},i,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:t({},b.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:m,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:b.selected.marker.opacity,color:b.selected.marker.color,editType:"style"},textfont:b.selected.textfont,editType:"style"},unselected:{marker:{opacity:b.unselected.marker.opacity,color:b.unselected.marker.color,editType:"style"},textfont:b.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"../scatter/attributes":927,"./constants":650}],649:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../plots/cartesian/align_period"),P=c("../../components/colorscale/helpers").hasColorscale,E=c("../../components/colorscale/calc"),e=c("./arrays_to_calcdata"),p=c("../scatter/calc_selection");ae.exports=function(a,t){var i=b.getFromId(a,t.xaxis||"x"),n=b.getFromId(a,t.yaxis||"y"),r,d,s,m,x,M,v={msUTC:!!(t.base||t.base===0)};t.orientation==="h"?(r=i.makeCalcdata(t,"x",v),s=n.makeCalcdata(t,"y"),m=k(t,n,"y",s),x=!!t.yperiodalignment,M="y"):(r=n.makeCalcdata(t,"y",v),s=i.makeCalcdata(t,"x"),m=k(t,i,"x",s),x=!!t.xperiodalignment,M="x"),d=m.vals;for(var _=Math.min(d.length,r.length),l=new Array(_),y=0;y<_;y++)l[y]={p:d[y],s:r[y]},x&&(l[y].orig_p=s[y],l[y][M+"End"]=m.ends[y],l[y][M+"Start"]=m.starts[y]),t.ids&&(l[y].id=String(t.ids[y]));return P(t,"marker")&&E(a,t,{vals:t.marker.color,containerStr:"marker",cLetter:"c"}),P(t,"marker.line")&&E(a,t,{vals:t.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(l,t),p(l,t),l}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../scatter/calc_selection":929,"./arrays_to_calcdata":647}],650:[function(c,ae,ie){"use strict";ae.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],651:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib").isArrayOrTypedArray,P=c("../../constants/numerical").BADNUM,E=c("../../registry"),e=c("../../plots/cartesian/axes"),p=c("../../plots/cartesian/constraints").getAxisGroup,g=c("./sieve.js");function a(u,h){for(var o=h.xaxis,S=h.yaxis,R=u._fullLayout,z=u._fullData,O=u.calcdata,I=[],F=[],D=0;D<z.length;D++){var B=z[D];if(B.visible===!0&&E.traceIs(B,"bar")&&B.xaxis===o._id&&B.yaxis===S._id&&(B.orientation==="h"?I.push(O[D]):F.push(O[D]),B._computePh))for(var U=u.calcdata[D],X=0;X<U.length;X++)typeof U[X].ph0=="function"&&(U[X].ph0=U[X].ph0()),typeof U[X].ph1=="function"&&(U[X].ph1=U[X].ph1())}var oe={xCat:o.type==="category"||o.type==="multicategory",yCat:S.type==="category"||S.type==="multicategory",mode:R.barmode,norm:R.barnorm,gap:R.bargap,groupgap:R.bargroupgap};t(u,o,S,F,oe),t(u,S,o,I,oe)}function t(u,h,o,S,R){if(!!S.length){var z,O,I,F,D;switch(i(o,S),R.mode){case"overlay":n(h,o,S,R);break;case"group":for(z=[],O=[],I=0;I<S.length;I++)F=S[I],D=F[0].trace,D.offset===void 0?O.push(F):z.push(F);O.length&&r(u,h,o,O,R),z.length&&n(h,o,z,R);break;case"stack":case"relative":for(z=[],O=[],I=0;I<S.length;I++)F=S[I],D=F[0].trace,D.base===void 0?O.push(F):z.push(F);O.length&&d(u,h,o,O,R),z.length&&n(h,o,z,R);break}A(S,h)}}function i(u,h){var o,S;for(o=0;o<h.length;o++){var R=h[o],z=R[0].trace,O=z.type==="funnel"?z._base:z.base,I,F=z.orientation==="h"?z.xcalendar:z.ycalendar,D=u.type==="category"||u.type==="multicategory"?function(){return null}:u.d2c;if(k(O)){for(S=0;S<Math.min(O.length,R.length);S++)I=D(O[S],0,F),b(I)?(R[S].b=+I,R[S].hasB=1):R[S].b=0;for(;S<R.length;S++)R[S].b=0}else{I=D(O,0,F);var B=b(I);for(I=B?I:0,S=0;S<R.length;S++)R[S].b=I,B&&(R[S].hasB=1)}}}function n(u,h,o,S){for(var R=0;R<o.length;R++){var z=o[R],O=new g([z],{posAxis:u,sepNegVal:!1,overlapNoMerge:!S.norm});s(u,O,S),S.norm?(y(O),w(h,O,S)):_(h,O)}}function r(u,h,o,S,R){var z=new g(S,{posAxis:h,sepNegVal:!1,overlapNoMerge:!R.norm});m(u,h,z,R),T(z,h),R.norm?(y(z),w(o,z,R)):_(o,z)}function d(u,h,o,S,R){var z=new g(S,{posAxis:h,sepNegVal:R.mode==="relative",overlapNoMerge:!(R.norm||R.mode==="stack"||R.mode==="relative")});s(h,z,R),l(o,z,R);for(var O=0;O<S.length;O++)for(var I=S[O],F=0;F<I.length;F++){var D=I[F];if(D.s!==P){var B=D.b+D.s===z.get(D.p,D.s);B&&(D._outmost=!0)}}R.norm&&w(o,z,R)}function s(u,h,o){for(var S=h.minDiff,R=h.traces,z=S*(1-o.gap),O=z,I=O*(1-(o.groupgap||0)),F=-I/2,D=0;D<R.length;D++){var B=R[D],U=B[0].t;U.barwidth=I,U.poffset=F,U.bargroupwidth=z,U.bardelta=S}h.binWidth=R[0][0].t.barwidth/100,x(h),M(u,h),v(u,h)}function m(u,h,o,S){for(var R=u._fullLayout,z=o.positions,O=o.distinctPositions,I=o.minDiff,F=o.traces,D=F.length,B=z.length!==O.length,U=I*(1-S.gap),X=p(R,h._id)+F[0][0].trace.orientation,oe=R._alignmentOpts[X]||{},se=0;se<D;se++){var q=F[se],K=q[0].trace,G=oe[K.alignmentgroup]||{},Q=Object.keys(G.offsetGroups||{}).length,V;Q?V=U/Q:V=B?U/D:U;var H=V*(1-(S.groupgap||0)),ee;Q?ee=((2*K._offsetIndex+1-Q)*V-H)/2:ee=B?((2*se+1-D)*V-H)/2:-H/2;var J=q[0].t;J.barwidth=H,J.poffset=ee,J.bargroupwidth=U,J.bardelta=I}o.binWidth=F[0][0].t.barwidth/100,x(o),M(h,o),v(h,o,B)}function x(u){var h=u.traces,o,S;for(o=0;o<h.length;o++){var R=h[o],z=R[0],O=z.trace,I=z.t,F=O._offset||O.offset,D=I.poffset,B;if(k(F)){for(B=Array.prototype.slice.call(F,0,R.length),S=0;S<B.length;S++)b(B[S])||(B[S]=D);for(S=B.length;S<R.length;S++)B.push(D);I.poffset=B}else F!==void 0&&(I.poffset=F);var U=O._width||O.width,X=I.barwidth;if(k(U)){var oe=Array.prototype.slice.call(U,0,R.length);for(S=0;S<oe.length;S++)b(oe[S])||(oe[S]=X);for(S=oe.length;S<R.length;S++)oe.push(X);if(I.barwidth=oe,F===void 0){for(B=[],S=0;S<R.length;S++)B.push(D+(X-oe[S])/2);I.poffset=B}}else U!==void 0&&(I.barwidth=U,F===void 0&&(I.poffset=D+(X-U)/2))}}function M(u,h){for(var o=h.traces,S=f(u),R=0;R<o.length;R++)for(var z=o[R],O=z[0].t,I=O.poffset,F=Array.isArray(I),D=O.barwidth,B=Array.isArray(D),U=0;U<z.length;U++){var X=z[U],oe=X.w=B?D[U]:D;X[S]=X.p+(F?I[U]:I)+oe/2}}function v(u,h,o){var S=h.traces,R=h.minDiff,z=R/2;e.minDtick(u,h.minDiff,h.distinctPositions[0],o);for(var O=0;O<S.length;O++){var I=S[O],F=I[0],D=F.trace,B=[],U,X,oe,se;for(se=0;se<I.length;se++)U=I[se],X=U.p-z,oe=U.p+z,B.push(X,oe);if(D.width||D.offset){var q=F.t,K=q.poffset,G=q.barwidth,Q=Array.isArray(K),V=Array.isArray(G);for(se=0;se<I.length;se++){U=I[se];var H=Q?K[se]:K,ee=V?G[se]:G;X=U.p+H,oe=X+ee,B.push(X,oe)}}D._extremes[u._id]=e.findExtremes(u,B,{padded:!1})}}function _(u,h){for(var o=h.traces,S=f(u),R=0;R<o.length;R++){for(var z=o[R],O=z[0].trace,I=[],F=!1,D=0;D<z.length;D++){var B=z[D],U=B.b,X=U+B.s;B[S]=X,I.push(X),B.hasB&&I.push(U),(!B.hasB||!B.b)&&(F=!0)}O._extremes[u._id]=e.findExtremes(u,I,{tozero:F,padded:!0})}}function l(u,h,o){var S=f(u),R=h.traces,z,O,I,F,D,B;for(F=0;F<R.length;F++)if(z=R[F],O=z[0].trace,O.type==="funnel")for(D=0;D<z.length;D++)B=z[D],B.s!==P&&h.put(B.p,-.5*B.s);for(F=0;F<R.length;F++){z=R[F],O=z[0].trace,I=O.type==="funnel";var U=[];for(D=0;D<z.length;D++)if(B=z[D],B.s!==P){var X;I?X=B.s:X=B.s+B.b;var oe=h.put(B.p,X),se=oe+X;B.b=oe,B[S]=se,o.norm||(U.push(se),B.hasB&&U.push(oe))}o.norm||(O._extremes[u._id]=e.findExtremes(u,U,{tozero:!0,padded:!0}))}}function y(u){for(var h=u.traces,o=0;o<h.length;o++)for(var S=h[o],R=0;R<S.length;R++){var z=S[R];z.s!==P&&u.put(z.p,z.b+z.s)}}function T(u,h){for(var o=u.traces,S=0;S<o.length;S++){var R=o[S],z=R[0].trace;if(z.base===void 0)for(var O=new g([R],{posAxis:h,sepNegVal:!0,overlapNoMerge:!0}),I=0;I<R.length;I++){var F=R[I];if(F.p!==P){var D=O.put(F.p,F.b+F.s);D&&(F.b=D)}}}}function w(u,h,o){var S=h.traces,R=f(u),z=o.norm==="fraction"?1:100,O=z/1e9,I=u.l2c(u.c2l(0)),F=o.mode==="stack"?z:I;function D(ee){return b(u.c2l(ee))&&(ee<I-O||ee>F+O||!b(I))}for(var B=0;B<S.length;B++){for(var U=S[B],X=U[0].trace,oe=[],se=!1,q=!1,K=0;K<U.length;K++){var G=U[K];if(G.s!==P){var Q=Math.abs(z/h.get(G.p,G.s));G.b*=Q,G.s*=Q;var V=G.b,H=V+G.s;G[R]=H,oe.push(H),q=q||D(H),G.hasB&&(oe.push(V),q=q||D(V)),(!G.hasB||!G.b)&&(se=!0)}}X._extremes[u._id]=e.findExtremes(u,oe,{tozero:se,padded:q})}}function A(u,h){var o=f(h),S={},R,z,O,I=1/0,F=-1/0;for(R=0;R<u.length;R++)for(O=u[R],z=0;z<O.length;z++){var D=O[z].p;b(D)&&(I=Math.min(I,D),F=Math.max(F,D))}var B=1e4/(F-I),U=S.round=function(Q){return String(Math.round(B*(Q-I)))};for(R=0;R<u.length;R++){O=u[R],O[0].t.extents=S;var X=O[0].t.poffset,oe=Array.isArray(X);for(z=0;z<O.length;z++){var se=O[z],q=se[o]-se.w/2;if(b(q)){var K=se[o]+se.w/2,G=U(se.p);S[G]?S[G]=[Math.min(q,S[G][0]),Math.max(K,S[G][1])]:S[G]=[q,K]}se.p0=se.p+(oe?X[z]:X),se.p1=se.p0+se.w,se.s0=se.b,se.s1=se.s0+se.s}}}function f(u){return u._id.charAt(0)}ae.exports={crossTraceCalc:a,setGroupPositions:t}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axes":554,"../../plots/cartesian/constraints":562,"../../registry":638,"./sieve.js":661,"fast-isnumeric":190}],652:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color"),P=c("../../registry"),E=c("../scatter/xy_defaults"),e=c("../scatter/period_defaults"),p=c("./style_defaults"),g=c("../../plots/cartesian/constraints").getAxisGroup,a=c("./attributes"),t=b.coerceFont;function i(s,m,x,M){function v(w,A){return b.coerce(s,m,a,w,A)}var _=E(s,m,M,v);if(!_){m.visible=!1;return}e(s,m,M,v),v("xhoverformat"),v("yhoverformat"),v("orientation",m.x&&!m.y?"h":"v"),v("base"),v("offset"),v("width"),v("text"),v("hovertext"),v("hovertemplate");var l=v("textposition");d(s,m,M,v,l,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),p(s,m,v,x,M);var y=(m.marker.line||{}).color,T=P.getComponentMethod("errorbars","supplyDefaults");T(s,m,y||k.defaultLine,{axis:"y"}),T(s,m,y||k.defaultLine,{axis:"x",inherit:"y"}),b.coerceSelectionMarkerOpacity(m,v)}function n(s,m,x,M){var v=m.orientation,_=m[{v:"x",h:"y"}[v]+"axis"],l=g(x,_)+v,y=x._alignmentOpts||{},T=M("alignmentgroup"),w=y[l];w||(w=y[l]={});var A=w[T];A?A.traces.push(m):A=w[T]={traces:[m],alignmentIndex:Object.keys(w).length,offsetGroups:{}};var f=M("offsetgroup"),u=A.offsetGroups,h=u[f];f&&(h||(h=u[f]={offsetIndex:Object.keys(u).length}),m._offsetIndex=h.offsetIndex)}function r(s,m){var x,M;function v(l){return b.coerce(M._input,M,a,l)}if(m.barmode==="group")for(var _=0;_<s.length;_++)M=s[_],M.type==="bar"&&(x=M._input,n(x,M,m,v))}function d(s,m,x,M,v,_){_=_||{};var l=_.moduleHasSelected!==!1,y=_.moduleHasUnselected!==!1,T=_.moduleHasConstrain!==!1,w=_.moduleHasCliponaxis!==!1,A=_.moduleHasTextangle!==!1,f=_.moduleHasInsideanchor!==!1,u=!!_.hasPathbar,h=Array.isArray(v)||v==="auto",o=h||v==="inside",S=h||v==="outside";if(o||S){var R=t(M,"textfont",x.font),z=b.extendFlat({},R),O=s.textfont&&s.textfont.color,I=!O;if(I&&delete z.color,t(M,"insidetextfont",z),u){var F=b.extendFlat({},R);I&&delete F.color,t(M,"pathbar.textfont",F)}S&&t(M,"outsidetextfont",R),l&&M("selected.textfont.color"),y&&M("unselected.textfont.color"),T&&M("constraintext"),w&&M("cliponaxis"),A&&M("textangle"),M("texttemplate")}o&&f&&M("insidetextanchor")}ae.exports={supplyDefaults:i,crossTraceDefaults:r,handleGroupingDefaults:n,handleText:d}},{"../../components/color":366,"../../lib":503,"../../plots/cartesian/constraints":562,"../../registry":638,"../scatter/period_defaults":947,"../scatter/xy_defaults":954,"./attributes":648,"./style_defaults":663}],653:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E){return k.x="xVal"in P?P.xVal:P.x,k.y="yVal"in P?P.yVal:P.y,P.xa&&(k.xaxis=P.xa),P.ya&&(k.yaxis=P.ya),E.orientation==="h"?(k.label=k.y,k.value=k.x):(k.label=k.x,k.value=k.y),k}},{}],654:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("tinycolor2"),P=c("../../lib").isArrayOrTypedArray;ie.coerceString=function(E,e,p){if(typeof e=="string"){if(e||!E.noBlank)return e}else if((typeof e=="number"||e===!0)&&!E.strict)return String(e);return p!==void 0?p:E.dflt},ie.coerceNumber=function(E,e,p){if(b(e)){e=+e;var g=E.min,a=E.max,t=g!==void 0&&e<g||a!==void 0&&e>a;if(!t)return e}return p!==void 0?p:E.dflt},ie.coerceColor=function(E,e,p){return k(e).isValid()?e:p!==void 0?p:E.dflt},ie.coerceEnumerated=function(E,e,p){return E.coerceNumber&&(e=+e),E.values.indexOf(e)!==-1?e:p!==void 0?p:E.dflt},ie.getValue=function(E,e){var p;return Array.isArray(E)?e<E.length&&(p=E[e]):p=E,p},ie.getLineWidth=function(E,e){var p=0<e.mlw?e.mlw:P(E.marker.line.width)?0:E.marker.line.width;return p}},{"../../lib":503,"fast-isnumeric":190,tinycolor2:312}],655:[function(c,ae,ie){"use strict";var b=c("../../components/fx"),k=c("../../registry"),P=c("../../components/color"),E=c("../../lib").fillText,e=c("./helpers").getLineWidth,p=c("../../plots/cartesian/axes").hoverLabelText,g=c("../../constants/numerical").BADNUM;function a(n,r,d,s,m){var x=t(n,r,d,s,m);if(x){var M=x.cd,v=M[0].trace,_=M[x.index];return x.color=i(v,_),k.getComponentMethod("errorbars","hoverInfo")(_,v,x),[x]}}function t(n,r,d,s,m){var x=n.cd,M=x[0].trace,v=x[0].t,_=s==="closest",l=M.type==="waterfall",y=n.maxHoverDistance,T=n.maxSpikeDistance,w,A,f,u,h,o,S;M.orientation==="h"?(w=d,A=r,f="y",u="x",h=K,o=oe):(w=r,A=d,f="x",u="y",o=K,h=oe);var R=M[f+"period"],z=_||R;function O(ne){return F(ne,-1)}function I(ne){return F(ne,1)}function F(ne,le){var ge=ne.w;return ne[f]+le*ge/2}function D(ne){return ne[f+"End"]-ne[f+"Start"]}var B=_?O:R?function(ne){return ne.p-D(ne)/2}:function(ne){return Math.min(O(ne),ne.p-v.bardelta/2)},U=_?I:R?function(ne){return ne.p+D(ne)/2}:function(ne){return Math.max(I(ne),ne.p+v.bardelta/2)};function X(ne,le,ge){return m.finiteRange&&(ge=0),b.inbox(ne-w,le-w,ge+Math.min(1,Math.abs(le-ne)/S)-1)}function oe(ne){return X(B(ne),U(ne),y)}function se(ne){return X(O(ne),I(ne),T)}function q(ne){var le=ne[u];if(l){var ge=Math.abs(ne.rawS)||0;A>0?le+=ge:A<0&&(le-=ge)}return le}function K(ne){var le=A,ge=ne.b,pe=q(ne);return b.inbox(ge-le,pe-le,y+(pe-le)/(pe-ge)-1)}function G(ne){var le=A,ge=ne.b,pe=q(ne);return b.inbox(ge-le,pe-le,T+(pe-le)/(pe-ge)-1)}var Q=n[f+"a"],V=n[u+"a"];S=Math.abs(Q.r2c(Q.range[1])-Q.r2c(Q.range[0]));function H(ne){return(h(ne)+o(ne))/2}var ee=b.getDistanceFunction(s,h,o,H);if(b.getClosest(x,ee,n),n.index!==!1&&x[n.index].p!==g){z||(B=function(ne){return Math.min(O(ne),ne.p-v.bargroupwidth/2)},U=function(ne){return Math.max(I(ne),ne.p+v.bargroupwidth/2)});var J=n.index,W=x[J],re=M.base?W.b+W.s:W.s;n[u+"0"]=n[u+"1"]=V.c2p(W[u],!0),n[u+"LabelVal"]=re;var j=v.extents[v.extents.round(W.p)];n[f+"0"]=Q.c2p(_?B(W):j[0],!0),n[f+"1"]=Q.c2p(_?U(W):j[1],!0);var Z=W.orig_p!==void 0;return n[f+"LabelVal"]=Z?W.orig_p:W.p,n.labelLabel=p(Q,n[f+"LabelVal"],M[f+"hoverformat"]),n.valueLabel=p(V,n[u+"LabelVal"],M[u+"hoverformat"]),n.baseLabel=p(V,W.b,M[u+"hoverformat"]),n.spikeDistance=(G(W)+se(W))/2,n[f+"Spike"]=Q.c2p(W.p,!0),E(W,M,n),n.hovertemplate=M.hovertemplate,n}}function i(n,r){var d=r.mcc||n.marker.color,s=r.mlcc||n.marker.line.color,m=e(n,r);if(P.opacity(d))return d;if(P.opacity(s)&&m)return s}ae.exports={hoverPoints:a,hoverOnBars:t,getTraceColor:i}},{"../../components/color":366,"../../components/fx":406,"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"./helpers":654}],656:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults").supplyDefaults,crossTraceDefaults:c("./defaults").crossTraceDefaults,supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc"),crossTraceCalc:c("./cross_trace_calc").crossTraceCalc,colorbar:c("../scatter/marker_colorbar"),arraysToCalcdata:c("./arrays_to_calcdata"),plot:c("./plot").plot,style:c("./style").style,styleOnSelect:c("./style").styleOnSelect,hoverPoints:c("./hover").hoverPoints,eventData:c("./event_data"),selectPoints:c("./select"),moduleType:"trace",name:"bar",basePlotModule:c("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":568,"../scatter/marker_colorbar":945,"./arrays_to_calcdata":647,"./attributes":648,"./calc":649,"./cross_trace_calc":651,"./defaults":652,"./event_data":653,"./hover":655,"./layout_attributes":657,"./layout_defaults":658,"./plot":659,"./select":660,"./style":662}],657:[function(c,ae,ie){"use strict";ae.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],658:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../plots/cartesian/axes"),P=c("../../lib"),E=c("./layout_attributes");ae.exports=function(e,p,g){function a(v,_){return P.coerce(e,p,E,v,_)}for(var t=!1,i=!1,n=!1,r={},d=a("barmode"),s=0;s<g.length;s++){var m=g[s];if(b.traceIs(m,"bar")&&m.visible)t=!0;else continue;if(d==="group"){var x=m.xaxis+m.yaxis;r[x]&&(n=!0),r[x]=!0}if(m.visible&&m.type==="histogram"){var M=k.getFromId({_fullLayout:p},m[m.orientation==="v"?"xaxis":"yaxis"]);M.type!=="category"&&(i=!0)}}if(!t){delete p.barmode;return}d!=="overlay"&&a("barnorm"),a("bargap",i&&!n?0:.2),a("bargroupgap")}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"./layout_attributes":657}],659:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=c("../../lib"),E=c("../../lib/svg_text_utils"),e=c("../../components/color"),p=c("../../components/drawing"),g=c("../../registry"),a=c("../../plots/cartesian/axes").tickText,t=c("./uniform_text"),i=t.recordMinTextSize,n=t.clearMinTextSize,r=c("./style"),d=c("./helpers"),s=c("./constants"),m=c("./attributes"),x=m.text,M=m.textposition,v=c("../../components/fx/helpers").appendArrayPointValue,_=s.TEXTPAD;function l(B){return B.id}function y(B){if(B.ids)return l}function T(B,U){return B<U?1:-1}function w(B,U,X,oe){var se=[],q=[],K=oe?U:X,G=oe?X:U;return se[0]=K.c2p(B.s0,!0),q[0]=G.c2p(B.p0,!0),se[1]=K.c2p(B.s1,!0),q[1]=G.c2p(B.p1,!0),oe?[se,q]:[q,se]}function A(B,U,X,oe){if(!U.uniformtext.mode&&f(X)){var se;return oe&&(se=oe()),B.transition().duration(X.duration).ease(X.easing).each("end",function(){se&&se()}).each("interrupt",function(){se&&se()})}else return B}function f(B){return B&&B.duration>0}function u(B,U,X,oe,se,q){var K=U.xaxis,G=U.yaxis,Q=B._fullLayout;se||(se={mode:Q.barmode,norm:Q.barmode,gap:Q.bargap,groupgap:Q.bargroupgap},n("bar",Q));var V=P.makeTraceGroups(oe,X,"trace bars").each(function(H){var ee=b.select(this),J=H[0].trace,W=J.type==="waterfall",re=J.type==="funnel",j=J.type==="bar",Z=j||re,ne=0;W&&J.connector.visible&&J.connector.mode==="between"&&(ne=J.connector.line.width/2);var le=J.orientation==="h",ge=f(se),pe=P.ensureSingle(ee,"g","points"),xe=y(J),Ee=pe.selectAll("g.point").data(P.identity,xe);Ee.enter().append("g").classed("point",!0),Ee.exit().remove(),Ee.each(function(de,be){var Le=b.select(this),De=w(de,K,G,le),ye=De[0][0],ke=De[0][1],Oe=De[1][0],Qe=De[1][1],Ve=(le?ke-ye:Qe-Oe)===0;Ve&&Z&&d.getLineWidth(J,de)&&(Ve=!1),Ve||(Ve=!k(ye)||!k(ke)||!k(Oe)||!k(Qe)),de.isBlank=Ve,Ve&&(le?ke=ye:Qe=Oe),ne&&!Ve&&(le?(ye-=T(ye,ke)*ne,ke+=T(ye,ke)*ne):(Oe-=T(Oe,Qe)*ne,Qe+=T(Oe,Qe)*ne));var Ue,Ie;if(J.type==="waterfall"){if(!Ve){var at=J[de.dir].marker;Ue=at.line.width,Ie=at.color}}else Ue=d.getLineWidth(J,de),Ie=de.mc||J.marker.color;function pt(_t){var it=b.round(Ue/2%1,2);return se.gap===0&&se.groupgap===0?b.round(Math.round(_t)-it,2):_t}function Rt(_t,it,ct){return ct&&_t===it?_t:Math.abs(_t-it)>=2?pt(_t):_t>it?Math.ceil(_t):Math.floor(_t)}if(!B._context.staticPlot){var Mt=e.opacity(Ie),It=Mt<1||Ue>.01?pt:Rt;ye=It(ye,ke,le),ke=It(ke,ye,le),Oe=It(Oe,Qe,!le),Qe=It(Qe,Oe,!le)}var Bt=A(P.ensureSingle(Le,"path"),Q,se,q);if(Bt.style("vector-effect","non-scaling-stroke").attr("d",isNaN((ke-ye)*(Qe-Oe))||Ve&&B._context.staticPlot?"M0,0Z":"M"+ye+","+Oe+"V"+Qe+"H"+ke+"V"+Oe+"Z").call(p.setClipUrl,U.layerClipId,B),!Q.uniformtext.mode&&ge){var St=p.makePointStyleFns(J);p.singlePointStyle(de,Bt,J,St,B)}h(B,U,Le,H,be,ye,ke,Oe,Qe,se,q),U.layerClipId&&p.hideOutsideRangePoint(de,Le.select("text"),K,G,J.xcalendar,J.ycalendar)});var Te=J.cliponaxis===!1;p.setClipUrl(ee,Te?null:U.layerClipId,B)});g.getComponentMethod("errorbars","plot")(B,V,U,se)}function h(B,U,X,oe,se,q,K,G,Q,V,H){var ee=U.xaxis,J=U.yaxis,W=B._fullLayout,re;function j(_t,it,ct){var et=P.ensureSingle(_t,"text").text(it).attr({class:"bartext bartext-"+re,"text-anchor":"middle","data-notex":1}).call(p.font,ct).call(E.convertToTspans,B);return et}var Z=oe[0].trace,ne=Z.orientation==="h",le=O(W,oe,se,ee,J);re=I(Z,se);var ge=V.mode==="stack"||V.mode==="relative",pe=oe[se],xe=!ge||pe._outmost;if(!le||re==="none"||(pe.isBlank||q===K||G===Q)&&(re==="auto"||re==="inside")){X.select("text").remove();return}var Ee=W.font,Te=r.getBarColor(oe[se],Z),de=r.getInsideTextFont(Z,se,Ee,Te),be=r.getOutsideTextFont(Z,se,Ee),Le=X.datum();ne?ee.type==="log"&&Le.s0<=0&&(ee.range[0]<ee.range[1]?q=0:q=ee._length):J.type==="log"&&Le.s0<=0&&(J.range[0]<J.range[1]?G=J._length:G=0);var De=Math.abs(K-q)-2*_,ye=Math.abs(Q-G)-2*_,ke,Oe,Qe,Ve,Ue;if(re==="outside"&&!xe&&!pe.hasB&&(re="inside"),re==="auto")if(xe){re="inside",Ue=P.ensureUniformFontSize(B,de),ke=j(X,le,Ue),Oe=p.bBox(ke.node()),Qe=Oe.width,Ve=Oe.height;var Ie=Qe>0&&Ve>0,at=Qe<=De&&Ve<=ye,pt=Qe<=ye&&Ve<=De,Rt=ne?De>=Qe*(ye/Ve):ye>=Ve*(De/Qe);Ie&&(at||pt||Rt)?re="inside":(re="outside",ke.remove(),ke=null)}else re="inside";if(!ke){Ue=P.ensureUniformFontSize(B,re==="outside"?be:de),ke=j(X,le,Ue);var Mt=ke.attr("transform");if(ke.attr("transform",""),Oe=p.bBox(ke.node()),Qe=Oe.width,Ve=Oe.height,ke.attr("transform",Mt),Qe<=0||Ve<=0){ke.remove();return}}var It=Z.textangle,Bt,St;re==="outside"?(St=Z.constraintext==="both"||Z.constraintext==="outside",Bt=z(q,K,G,Q,Oe,{isHorizontal:ne,constrained:St,angle:It})):(St=Z.constraintext==="both"||Z.constraintext==="inside",Bt=R(q,K,G,Q,Oe,{isHorizontal:ne,constrained:St,angle:It,anchor:Z.insidetextanchor})),Bt.fontSize=Ue.size,i(Z.type==="histogram"?"bar":Z.type,Bt,W),pe.transform=Bt,A(ke,W,V,H).attr("transform",P.getTextTransform(Bt))}function o(B){return B==="auto"?0:B}function S(B,U){var X=Math.PI/180*U,oe=Math.abs(Math.sin(X)),se=Math.abs(Math.cos(X));return{x:B.width*se+B.height*oe,y:B.width*oe+B.height*se}}function R(B,U,X,oe,se,q){var K=!!q.isHorizontal,G=!!q.constrained,Q=q.angle||0,V=q.anchor||"end",H=V==="end",ee=V==="start",J=q.leftToRight||0,W=(J+1)/2,re=1-W,j=se.width,Z=se.height,ne=Math.abs(U-B),le=Math.abs(oe-X),ge=ne>2*_&&le>2*_?_:0;ne-=2*ge,le-=2*ge;var pe=o(Q);Q==="auto"&&!(j<=ne&&Z<=le)&&(j>ne||Z>le)&&(!(j>le||Z>ne)||j<Z!=ne<le)&&(pe+=90);var xe=S(se,pe),Ee=1;G&&(Ee=Math.min(1,ne/xe.x,le/xe.y));var Te=se.left*re+se.right*W,de=(se.top+se.bottom)/2,be=(B+_)*re+(U-_)*W,Le=(X+oe)/2,De=0,ye=0;if(ee||H){var ke=(K?xe.x:xe.y)/2,Oe=K?T(B,U):T(X,oe);K?ee?(be=B+Oe*ge,De=-Oe*ke):(be=U-Oe*ge,De=Oe*ke):ee?(Le=X+Oe*ge,ye=-Oe*ke):(Le=oe-Oe*ge,ye=Oe*ke)}return{textX:Te,textY:de,targetX:be,targetY:Le,anchorX:De,anchorY:ye,scale:Ee,rotate:pe}}function z(B,U,X,oe,se,q){var K=!!q.isHorizontal,G=!!q.constrained,Q=q.angle||0,V=se.width,H=se.height,ee=Math.abs(U-B),J=Math.abs(oe-X),W;K?W=J>2*_?_:0:W=ee>2*_?_:0;var re=1;G&&(re=K?Math.min(1,J/H):Math.min(1,ee/V));var j=o(Q),Z=S(se,j),ne=(K?Z.x:Z.y)/2,le=(se.left+se.right)/2,ge=(se.top+se.bottom)/2,pe=(B+U)/2,xe=(X+oe)/2,Ee=0,Te=0,de=K?T(U,B):T(X,oe);return K?(pe=U-de*W,Ee=de*ne):(xe=oe+de*W,Te=-de*ne),{textX:le,textY:ge,targetX:pe,targetY:xe,anchorX:Ee,anchorY:Te,scale:re,rotate:j}}function O(B,U,X,oe,se){var q=U[0].trace,K=q.texttemplate,G;return K?G=F(B,U,X,oe,se):q.textinfo?G=D(U,X,oe,se):G=d.getValue(q.text,X),d.coerceString(x,G)}function I(B,U){var X=d.getValue(B.textposition,U);return d.coerceEnumerated(M,X)}function F(B,U,X,oe,se){var q=U[0].trace,K=P.castOption(q,X,"texttemplate");if(!K)return"";var G=q.type==="histogram",Q=q.type==="waterfall",V=q.type==="funnel",H=q.orientation==="h",ee,J,W,re;H?(ee="y",J=se,W="x",re=oe):(ee="x",J=oe,W="y",re=se);function j(Ee){return a(J,J.c2l(Ee),!0).text}function Z(Ee){return a(re,re.c2l(Ee),!0).text}var ne=U[X],le={};le.label=ne.p,le.labelLabel=le[ee+"Label"]=j(ne.p);var ge=P.castOption(q,ne.i,"text");(ge===0||ge)&&(le.text=ge),le.value=ne.s,le.valueLabel=le[W+"Label"]=Z(ne.s);var pe={};v(pe,q,ne.i),(G||pe.x===void 0)&&(pe.x=H?le.value:le.label),(G||pe.y===void 0)&&(pe.y=H?le.label:le.value),(G||pe.xLabel===void 0)&&(pe.xLabel=H?le.valueLabel:le.labelLabel),(G||pe.yLabel===void 0)&&(pe.yLabel=H?le.labelLabel:le.valueLabel),Q&&(le.delta=+ne.rawS||ne.s,le.deltaLabel=Z(le.delta),le.final=ne.v,le.finalLabel=Z(le.final),le.initial=le.final-le.delta,le.initialLabel=Z(le.initial)),V&&(le.value=ne.s,le.valueLabel=Z(le.value),le.percentInitial=ne.begR,le.percentInitialLabel=P.formatPercent(ne.begR),le.percentPrevious=ne.difR,le.percentPreviousLabel=P.formatPercent(ne.difR),le.percentTotal=ne.sumR,le.percenTotalLabel=P.formatPercent(ne.sumR));var xe=P.castOption(q,ne.i,"customdata");return xe&&(le.customdata=xe),P.texttemplateString(K,le,B._d3locale,pe,le,q._meta||{})}function D(B,U,X,oe){var se=B[0].trace,q=se.orientation==="h",K=se.type==="waterfall",G=se.type==="funnel";function Q(xe){var Ee=q?oe:X;return a(Ee,xe,!0).text}function V(xe){var Ee=q?X:oe;return a(Ee,+xe,!0).text}var H=se.textinfo,ee=B[U],J=H.split("+"),W=[],re,j=function(xe){return J.indexOf(xe)!==-1};if(j("label")&&W.push(Q(B[U].p)),j("text")&&(re=P.castOption(se,ee.i,"text"),(re===0||re)&&W.push(re)),K){var Z=+ee.rawS||ee.s,ne=ee.v,le=ne-Z;j("initial")&&W.push(V(le)),j("delta")&&W.push(V(Z)),j("final")&&W.push(V(ne))}if(G){j("value")&&W.push(V(ee.s));var ge=0;j("percent initial")&&ge++,j("percent previous")&&ge++,j("percent total")&&ge++;var pe=ge>1;j("percent initial")&&(re=P.formatPercent(ee.begR),pe&&(re+=" of initial"),W.push(re)),j("percent previous")&&(re=P.formatPercent(ee.difR),pe&&(re+=" of previous"),W.push(re)),j("percent total")&&(re=P.formatPercent(ee.sumR),pe&&(re+=" of total"),W.push(re))}return W.join("<br>")}ae.exports={plot:u,toMoveInsideBar:R}},{"../../components/color":366,"../../components/drawing":388,"../../components/fx/helpers":402,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../registry":638,"./attributes":648,"./constants":650,"./helpers":654,"./style":662,"./uniform_text":664,"@plotly/d3":58,"fast-isnumeric":190}],660:[function(c,ae,ie){"use strict";ae.exports=function(P,E){var e=P.cd,p=P.xaxis,g=P.yaxis,a=e[0].trace,t=a.type==="funnel",i=a.orientation==="h",n=[],r;if(E===!1)for(r=0;r<e.length;r++)e[r].selected=0;else for(r=0;r<e.length;r++){var d=e[r],s="ct"in d?d.ct:b(d,p,g,i,t);E.contains(s,!1,r,P)?(n.push({pointNumber:r,x:p.c2d(d.x),y:g.c2d(d.y)}),d.selected=1):d.selected=0}return n};function b(k,P,E,e,p){var g=P.c2p(e?k.s0:k.p0,!0),a=P.c2p(e?k.s1:k.p1,!0),t=E.c2p(e?k.p0:k.s0,!0),i=E.c2p(e?k.p1:k.s1,!0);return p?[(g+a)/2,(t+i)/2]:e?[a,(t+i)/2]:[(g+a)/2,i]}},{}],661:[function(c,ae,ie){"use strict";ae.exports=P;var b=c("../../lib").distinctVals,k=c("../../constants/numerical").BADNUM;function P(E,e){this.traces=E,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var p=1/0,g=[],a=0;a<E.length;a++){for(var t=E[a],i=0;i<t.length;i++){var n=t[i];n.p!==k&&g.push(n.p)}t[0]&&t[0].width1&&(p=Math.min(t[0].width1,p))}this.positions=g;var r=b(g);this.distinctPositions=r.vals,r.vals.length===1&&p!==1/0?this.minDiff=p:this.minDiff=Math.min(r.minDiff,p);var d=(e.posAxis||{}).type;(d==="category"||d==="multicategory")&&(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}P.prototype.put=function(e,p){var g=this.getLabel(e,p),a=this.bins[g]||0;return this.bins[g]=a+p,a},P.prototype.get=function(e,p){var g=this.getLabel(e,p);return this.bins[g]||0},P.prototype.getLabel=function(e,p){var g=p<0&&this.sepNegVal?"v":"^",a=this.overlapNoMerge?e:Math.round(e/this.binWidth);return g+a}},{"../../constants/numerical":479,"../../lib":503}],662:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/color"),P=c("../../components/drawing"),E=c("../../lib"),e=c("../../registry"),p=c("./uniform_text").resizeText,g=c("./attributes"),a=g.textfont,t=g.insidetextfont,i=g.outsidetextfont,n=c("./helpers");function r(A){var f=b.select(A).selectAll("g.barlayer").selectAll("g.trace");p(A,f,"bar");var u=f.size(),h=A._fullLayout;f.style("opacity",function(o){return o[0].trace.opacity}).each(function(o){(h.barmode==="stack"&&u>1||h.bargap===0&&h.bargroupgap===0&&!o[0].trace.marker.line.width)&&b.select(this).attr("shape-rendering","crispEdges")}),f.selectAll("g.points").each(function(o){var S=b.select(this),R=o[0].trace;d(S,R,A)}),e.getComponentMethod("errorbars","style")(f)}function d(A,f,u){P.pointStyle(A.selectAll("path"),f,u),s(A,f,u)}function s(A,f,u){A.selectAll("text").each(function(h){var o=b.select(this),S=E.ensureUniformFontSize(u,v(o,h,f,u));P.font(o,S)})}function m(A,f,u){var h=f[0].trace;h.selectedpoints?x(u,h,A):(d(u,h,A),e.getComponentMethod("errorbars","style")(u))}function x(A,f,u){P.selectedPointStyle(A.selectAll("path"),f),M(A.selectAll("text"),f,u)}function M(A,f,u){A.each(function(h){var o=b.select(this),S;if(h.selected){S=E.ensureUniformFontSize(u,v(o,h,f,u));var R=f.selected.textfont&&f.selected.textfont.color;R&&(S.color=R),P.font(o,S)}else P.selectedTextStyle(o,f)})}function v(A,f,u,h){var o=h._fullLayout.font,S=u.textfont;if(A.classed("bartext-inside")){var R=w(f,u);S=l(u,f.i,o,R)}else A.classed("bartext-outside")&&(S=y(u,f.i,o));return S}function _(A,f,u){return T(a,A.textfont,f,u)}function l(A,f,u,h){var o=_(A,f,u),S=A._input.textfont===void 0||A._input.textfont.color===void 0||Array.isArray(A.textfont.color)&&A.textfont.color[f]===void 0;return S&&(o={color:k.contrast(h),family:o.family,size:o.size}),T(t,A.insidetextfont,f,o)}function y(A,f,u){var h=_(A,f,u);return T(i,A.outsidetextfont,f,h)}function T(A,f,u,h){f=f||{};var o=n.getValue(f.family,u),S=n.getValue(f.size,u),R=n.getValue(f.color,u);return{family:n.coerceString(A.family,o,h.family),size:n.coerceNumber(A.size,S,h.size),color:n.coerceColor(A.color,R,h.color)}}function w(A,f){return f.type==="waterfall"?f[A.dir].marker.color:A.mcc||A.mc||f.marker.color}ae.exports={style:r,styleTextPoints:s,styleOnSelect:m,getInsideTextFont:l,getOutsideTextFont:y,getBarColor:w,resizeText:p}},{"../../components/color":366,"../../components/drawing":388,"../../lib":503,"../../registry":638,"./attributes":648,"./helpers":654,"./uniform_text":664,"@plotly/d3":58}],663:[function(c,ae,ie){"use strict";var b=c("../../components/color"),k=c("../../components/colorscale/helpers").hasColorscale,P=c("../../components/colorscale/defaults"),E=c("../../lib").coercePattern;ae.exports=function(p,g,a,t,i){var n=a("marker.color",t),r=k(p,"marker");r&&P(p,g,i,a,{prefix:"marker.",cLetter:"c"}),a("marker.line.color",b.defaultLine),k(p,"marker.line")&&P(p,g,i,a,{prefix:"marker.line.",cLetter:"c"}),a("marker.line.width"),a("marker.opacity"),E(a,"marker.pattern",n,r),a("selected.marker.color"),a("unselected.marker.color")}},{"../../components/color":366,"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503}],664:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib");function P(g,a,t){var i=g._fullLayout,n=i["_"+t+"Text_minsize"];if(n){var r=i.uniformtext.mode==="hide",d;switch(t){case"funnelarea":case"pie":case"sunburst":d="g.slice";break;case"treemap":case"icicle":d="g.slice, g.pathbar";break;default:d="g.points > g.point"}a.selectAll(d).each(function(s){var m=s.transform;if(m){m.scale=r&&m.hide?0:n/m.fontSize;var x=b.select(this).select("text");x.attr("transform",k.getTextTransform(m))}})}}function E(g,a,t){if(t.uniformtext.mode){var i=p(g),n=t.uniformtext.minsize,r=a.scale*a.fontSize;a.hide=r<n,t[i]=t[i]||1/0,a.hide||(t[i]=Math.min(t[i],Math.max(r,n)))}}function e(g,a){var t=p(g);a[t]=void 0}function p(g){return"_"+g+"Text_minsize"}ae.exports={recordMinTextSize:E,clearMinTextSize:e,resizeText:P}},{"../../lib":503,"@plotly/d3":58}],665:[function(c,ae,ie){"use strict";var b=c("../../plots/template_attributes").hovertemplateAttrs,k=c("../../lib/extend").extendFlat,P=c("../scatterpolar/attributes"),E=c("../bar/attributes");ae.exports={r:P.r,theta:P.theta,r0:P.r0,dr:P.dr,theta0:P.theta0,dtheta:P.dtheta,thetaunit:P.thetaunit,base:k({},E.base,{}),offset:k({},E.offset,{}),width:k({},E.width,{}),text:k({},E.text,{}),hovertext:k({},E.hovertext,{}),marker:E.marker,hoverinfo:P.hoverinfo,hovertemplate:b(),selected:E.selected,unselected:E.unselected}},{"../../lib/extend":493,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatterpolar/attributes":1002}],666:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/helpers").hasColorscale,k=c("../../components/colorscale/calc"),P=c("../bar/arrays_to_calcdata"),E=c("../bar/cross_trace_calc").setGroupPositions,e=c("../scatter/calc_selection"),p=c("../../registry").traceIs,g=c("../../lib").extendFlat;function a(i,n){for(var r=i._fullLayout,d=n.subplot,s=r[d].radialaxis,m=r[d].angularaxis,x=s.makeCalcdata(n,"r"),M=m.makeCalcdata(n,"theta"),v=n._length,_=new Array(v),l=x,y=M,T=0;T<v;T++)_[T]={p:y[T],s:l[T]};function w(A){var f=n[A];f!==void 0&&(n["_"+A]=Array.isArray(f)?m.makeCalcdata(n,A):m.d2c(f,n.thetaunit))}return m.type==="linear"&&(w("width"),w("offset")),b(n,"marker")&&k(i,n,{vals:n.marker.color,containerStr:"marker",cLetter:"c"}),b(n,"marker.line")&&k(i,n,{vals:n.marker.line.color,containerStr:"marker.line",cLetter:"c"}),P(_,n),e(_,n),_}function t(i,n,r){for(var d=i.calcdata,s=[],m=0;m<d.length;m++){var x=d[m],M=x[0].trace;M.visible===!0&&p(M,"bar")&&M.subplot===r&&s.push(x)}var v=g({},n.radialaxis,{_id:"x"}),_=n.angularaxis;E(i,_,v,s,{mode:n.barmode,norm:n.barnorm,gap:n.bargap,groupgap:n.bargroupgap})}ae.exports={calc:a,crossTraceCalc:t}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"../../lib":503,"../../registry":638,"../bar/arrays_to_calcdata":647,"../bar/cross_trace_calc":651,"../scatter/calc_selection":929}],667:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatterpolar/defaults").handleRThetaDefaults,P=c("../bar/style_defaults"),E=c("./attributes");ae.exports=function(p,g,a,t){function i(r,d){return b.coerce(p,g,E,r,d)}var n=k(p,g,t,i);if(!n){g.visible=!1;return}i("thetaunit"),i("base"),i("offset"),i("width"),i("text"),i("hovertext"),i("hovertemplate"),P(p,g,i,a,t),b.coerceSelectionMarkerOpacity(g,i)}},{"../../lib":503,"../bar/style_defaults":663,"../scatterpolar/defaults":1004,"./attributes":665}],668:[function(c,ae,ie){"use strict";var b=c("../../components/fx"),k=c("../../lib"),P=c("../bar/hover").getTraceColor,E=k.fillText,e=c("../scatterpolar/hover").makeHoverPointText,p=c("../../plots/polar/helpers").isPtInsidePolygon;ae.exports=function(a,t,i){var n=a.cd,r=n[0].trace,d=a.subplot,s=d.radialAxis,m=d.angularAxis,x=d.vangles,M=x?p:k.isPtInsideSector,v=a.maxHoverDistance,_=m._period||2*Math.PI,l=Math.abs(s.g2p(Math.sqrt(t*t+i*i))),y=Math.atan2(i,t);s.range[0]>s.range[1]&&(y+=Math.PI);var T=function(u){return M(l,y,[u.rp0,u.rp1],[u.thetag0,u.thetag1],x)?v+Math.min(1,Math.abs(u.thetag1-u.thetag0)/_)-1+(u.rp1-l)/(u.rp1-u.rp0)-1:1/0};if(b.getClosest(n,T,a),a.index!==!1){var w=a.index,A=n[w];a.x0=a.x1=A.ct[0],a.y0=a.y1=A.ct[1];var f=k.extendFlat({},A,{r:A.s,theta:A.p});return E(A,r,a),e(f,r,d,a),a.hovertemplate=r.hovertemplate,a.color=P(r,A),a.xLabelVal=a.yLabelVal=void 0,A.s<0&&(a.idealAlign="left"),[a]}}},{"../../components/fx":406,"../../lib":503,"../../plots/polar/helpers":621,"../bar/hover":655,"../scatterpolar/hover":1006}],669:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"barpolar",basePlotModule:c("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults"),supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc").calc,crossTraceCalc:c("./calc").crossTraceCalc,plot:c("./plot"),colorbar:c("../scatter/marker_colorbar"),formatLabels:c("../scatterpolar/format_labels"),style:c("../bar/style").style,styleOnSelect:c("../bar/style").styleOnSelect,hoverPoints:c("./hover"),selectPoints:c("../bar/select"),meta:{}}},{"../../plots/polar":622,"../bar/select":660,"../bar/style":662,"../scatter/marker_colorbar":945,"../scatterpolar/format_labels":1005,"./attributes":665,"./calc":666,"./defaults":667,"./hover":668,"./layout_attributes":670,"./layout_defaults":671,"./plot":672}],670:[function(c,ae,ie){"use strict";ae.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],671:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(P,E,e){var p={},g;function a(n,r){return b.coerce(P[g]||{},E[g],k,n,r)}for(var t=0;t<e.length;t++){var i=e[t];i.type==="barpolar"&&i.visible===!0&&(g=i.subplot,p[g]||(a("barmode"),a("bargap"),p[g]=1))}}},{"../../lib":503,"./layout_attributes":670}],672:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("fast-isnumeric"),P=c("../../lib"),E=c("../../components/drawing"),e=c("../../plots/polar/helpers");ae.exports=function(a,t,i){var n=t.xaxis,r=t.yaxis,d=t.radialAxis,s=t.angularAxis,m=p(t),x=t.layers.frontplot.select("g.barlayer");P.makeTraceGroups(x,i,"trace bars").each(function(){var M=b.select(this),v=P.ensureSingle(M,"g","points"),_=v.selectAll("g.point").data(P.identity);_.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),_.exit().remove(),_.each(function(l){var y=b.select(this),T=l.rp0=d.c2p(l.s0),w=l.rp1=d.c2p(l.s1),A=l.thetag0=s.c2g(l.p0),f=l.thetag1=s.c2g(l.p1),u;if(!k(T)||!k(w)||!k(A)||!k(f)||T===w||A===f)u="M0,0Z";else{var h=d.c2g(l.s1),o=(A+f)/2;l.ct=[n.c2p(h*Math.cos(o)),r.c2p(h*Math.sin(o))],u=m(T,w,A,f)}P.ensureSingle(y,"path").attr("d",u)}),E.setClipUrl(M,t._hasClipOnAxisFalse?t.clipIds.forTraces:null,a)})};function p(g){var a=g.cxx,t=g.cyy;return g.vangles?function(i,n,r,d){var s,m;P.angleDelta(r,d)>0?(s=r,m=d):(s=d,m=r);var x=e.findEnclosingVertexAngles(s,g.vangles)[0],M=e.findEnclosingVertexAngles(m,g.vangles)[1],v=[x,(s+m)/2,M];return e.pathPolygonAnnulus(i,n,s,m,v,a,t)}:function(i,n,r,d){return P.pathAnnulus(i,n,r,d,a,t)}}},{"../../components/drawing":388,"../../lib":503,"../../plots/polar/helpers":621,"@plotly/d3":58,"fast-isnumeric":190}],673:[function(c,ae,ie){"use strict";var b=c("../scatter/attributes"),k=c("../bar/attributes"),P=c("../../components/color/attributes"),E=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=c("../../plots/template_attributes").hovertemplateAttrs,p=c("../../lib/extend").extendFlat,g=b.marker,a=g.line;ae.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:b.xperiod,yperiod:b.yperiod,xperiod0:b.xperiod0,yperiod0:b.yperiod0,xperiodalignment:b.xperiodalignment,yperiodalignment:b.yperiodalignment,xhoverformat:E("x"),yhoverformat:E("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:p({},g.symbol,{arrayOk:!1,editType:"plot"}),opacity:p({},g.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:p({},g.size,{arrayOk:!1,editType:"calc"}),color:p({},g.color,{arrayOk:!1,editType:"style"}),line:{color:p({},a.color,{arrayOk:!1,dflt:P.defaultLine,editType:"style"}),width:p({},a.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:b.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:k.offsetgroup,alignmentgroup:k.alignmentgroup,selected:{marker:b.selected.marker,editType:"style"},unselected:{marker:b.unselected.marker,editType:"style"},text:p({},b.text,{}),hovertext:p({},b.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":365,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatter/attributes":927}],674:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../plots/cartesian/axes"),P=c("../../plots/cartesian/align_period"),E=c("../../lib"),e=c("../../constants/numerical").BADNUM,p=E._;ae.exports=function(y,T){var w=y._fullLayout,A=k.getFromId(y,T.xaxis||"x"),f=k.getFromId(y,T.yaxis||"y"),u=[],h=T.type==="violin"?"_numViolins":"_numBoxes",o,S,R,z,O,I,F;T.orientation==="h"?(R=A,z="x",O=f,I="y",F=!!T.yperiodalignment):(R=f,z="y",O=A,I="x",F=!!T.xperiodalignment);var D=g(T,I,O,w[h]),B=D[0],U=D[1],X=E.distinctVals(B,O),oe=X.vals,se=X.minDiff/2,q,K,G,Q,V,H,ee=(T.boxpoints||T.points)==="all"?E.identity:function(Mt){return Mt.v<q.lf||Mt.v>q.uf};if(T._hasPreCompStats){var J=T[z],W=function(Mt){return R.d2c((T[Mt]||[])[o])},re=1/0,j=-1/0;for(o=0;o<T._length;o++){var Z=B[o];if(!!b(Z)){if(q={},q.pos=q[I]=Z,F&&U&&(q.orig_p=U[o]),q.q1=W("q1"),q.med=W("median"),q.q3=W("q3"),K=[],J&&E.isArrayOrTypedArray(J[o]))for(S=0;S<J[o].length;S++)H=R.d2c(J[o][S]),H!==e&&(V={v:H,i:[o,S]},n(V,T,[o,S]),K.push(V));if(q.pts=K.sort(d),G=q[z]=K.map(s),Q=G.length,q.med!==e&&q.q1!==e&&q.q3!==e&&q.med>=q.q1&&q.q3>=q.med){var ne=W("lowerfence");q.lf=ne!==e&&ne<=q.q1?ne:m(q,G,Q);var le=W("upperfence");q.uf=le!==e&&le>=q.q3?le:x(q,G,Q);var ge=W("mean");q.mean=ge!==e?ge:Q?E.mean(G,Q):(q.q1+q.q3)/2;var pe=W("sd");q.sd=ge!==e&&pe>=0?pe:Q?E.stdev(G,Q,q.mean):q.q3-q.q1,q.lo=M(q),q.uo=v(q);var xe=W("notchspan");xe=xe!==e&&xe>0?xe:_(q,Q),q.ln=q.med-xe,q.un=q.med+xe;var Ee=q.lf,Te=q.uf;T.boxpoints&&G.length&&(Ee=Math.min(Ee,G[0]),Te=Math.max(Te,G[Q-1])),T.notched&&(Ee=Math.min(Ee,q.ln),Te=Math.max(Te,q.un)),q.min=Ee,q.max=Te}else{E.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+q.q1,"median = "+q.med,"q3 = "+q.q3].join(`
`));var de;q.med!==e?de=q.med:q.q1!==e?q.q3!==e?de=(q.q1+q.q3)/2:de=q.q1:q.q3!==e?de=q.q3:de=0,q.med=de,q.q1=q.q3=de,q.lf=q.uf=de,q.mean=q.sd=de,q.ln=q.un=de,q.min=q.max=de}re=Math.min(re,q.min),j=Math.max(j,q.max),q.pts2=K.filter(ee),u.push(q)}}T._extremes[R._id]=k.findExtremes(R,[re,j],{padded:!0})}else{var be=R.makeCalcdata(T,z),Le=a(oe,se),De=oe.length,ye=t(De);for(o=0;o<T._length;o++)if(H=be[o],!!b(H)){var ke=E.findBin(B[o],Le);ke>=0&&ke<De&&(V={v:H,i:o},n(V,T,o),ye[ke].push(V))}var Oe=1/0,Qe=-1/0,Ve=T.quartilemethod,Ue=Ve==="exclusive",Ie=Ve==="inclusive";for(o=0;o<De;o++)if(ye[o].length>0){if(q={},q.pos=q[I]=oe[o],K=q.pts=ye[o].sort(d),G=q[z]=K.map(s),Q=G.length,q.min=G[0],q.max=G[Q-1],q.mean=E.mean(G,Q),q.sd=E.stdev(G,Q,q.mean),q.med=E.interp(G,.5),Q%2&&(Ue||Ie)){var at,pt;Ue?(at=G.slice(0,Q/2),pt=G.slice(Q/2+1)):Ie&&(at=G.slice(0,Q/2+1),pt=G.slice(Q/2)),q.q1=E.interp(at,.5),q.q3=E.interp(pt,.5)}else q.q1=E.interp(G,.25),q.q3=E.interp(G,.75);q.lf=m(q,G,Q),q.uf=x(q,G,Q),q.lo=M(q),q.uo=v(q);var Rt=_(q,Q);q.ln=q.med-Rt,q.un=q.med+Rt,Oe=Math.min(Oe,q.ln),Qe=Math.max(Qe,q.un),q.pts2=K.filter(ee),u.push(q)}T._extremes[R._id]=k.findExtremes(R,T.notched?be.concat([Oe,Qe]):be,{padded:!0})}return r(u,T),u.length>0?(u[0].t={num:w[h],dPos:se,posLetter:I,valLetter:z,labels:{med:p(y,"median:"),min:p(y,"min:"),q1:p(y,"q1:"),q3:p(y,"q3:"),max:p(y,"max:"),mean:T.boxmean==="sd"?p(y,"mean \xB1 \u03C3:"):p(y,"mean:"),lf:p(y,"lower fence:"),uf:p(y,"upper fence:")}},w[h]++,u):[{t:{empty:!0}}]};function g(l,y,T,w){var A=y in l,f=y+"0"in l,u="d"+y in l;if(A||f&&u){var h=T.makeCalcdata(l,y),o=P(l,T,y,h).vals;return[o,h]}var S;f?S=l[y+"0"]:"name"in l&&(T.type==="category"||b(l.name)&&["linear","log"].indexOf(T.type)!==-1||E.isDateTime(l.name)&&T.type==="date")?S=l.name:S=w;for(var R=T.type==="multicategory"?T.r2c_just_indices(S):T.d2c(S,0,l[y+"calendar"]),z=l._length,O=new Array(z),I=0;I<z;I++)O[I]=R;return[O]}function a(l,y){for(var T=l.length,w=new Array(T+1),A=0;A<T;A++)w[A]=l[A]-y;return w[T]=l[T-1]+y,w}function t(l){for(var y=new Array(l),T=0;T<l;T++)y[T]=[];return y}var i={text:"tx",hovertext:"htx"};function n(l,y,T){for(var w in i)E.isArrayOrTypedArray(y[w])&&(Array.isArray(T)?E.isArrayOrTypedArray(y[w][T[0]])&&(l[i[w]]=y[w][T[0]][T[1]]):l[i[w]]=y[w][T])}function r(l,y){if(E.isArrayOrTypedArray(y.selectedpoints))for(var T=0;T<l.length;T++){for(var w=l[T].pts||[],A={},f=0;f<w.length;f++)A[w[f].i]=f;E.tagSelected(w,y,A)}}function d(l,y){return l.v-y.v}function s(l){return l.v}function m(l,y,T){return T===0?l.q1:Math.min(l.q1,y[Math.min(E.findBin(2.5*l.q1-1.5*l.q3,y,!0)+1,T-1)])}function x(l,y,T){return T===0?l.q3:Math.max(l.q3,y[Math.max(E.findBin(2.5*l.q3-1.5*l.q1,y),0)])}function M(l){return 4*l.q1-3*l.q3}function v(l){return 4*l.q3-3*l.q1}function _(l,y){return y===0?0:1.57*(l.q3-l.q1)/Math.sqrt(y)}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"fast-isnumeric":190}],675:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../lib"),P=c("../../plots/cartesian/constraints").getAxisGroup,E=["v","h"];function e(g,a){for(var t=g.calcdata,i=a.xaxis,n=a.yaxis,r=0;r<E.length;r++){for(var d=E[r],s=d==="h"?n:i,m=[],x=0;x<t.length;x++){var M=t[x],v=M[0].t,_=M[0].trace;_.visible===!0&&(_.type==="box"||_.type==="candlestick")&&!v.empty&&(_.orientation||"v")===d&&_.xaxis===i._id&&_.yaxis===n._id&&m.push(x)}p("box",g,m,s)}}function p(g,a,t,i){var n=a.calcdata,r=a._fullLayout,d=i._id,s=d.charAt(0),m,x,M,v=[],_=0;for(m=0;m<t.length;m++)for(M=n[t[m]],x=0;x<M.length;x++)v.push(i.c2l(M[x].pos,!0)),_+=(M[x].pts2||[]).length;if(!!v.length){var l=k.distinctVals(v);(i.type==="category"||i.type==="multicategory")&&(l.minDiff=1);var y=l.minDiff/2;b.minDtick(i,l.minDiff,l.vals[0],!0);var T=g==="violin"?"_numViolins":"_numBoxes",w=r[T],A=r[g+"mode"]==="group"&&w>1,f=1-r[g+"gap"],u=1-r[g+"groupgap"];for(m=0;m<t.length;m++){M=n[t[m]];var h=M[0].trace,o=M[0].t,S=h.width,R=h.side,z,O,I,F;if(S)z=O=F=S/2,I=0;else if(z=y,A){var D=P(r,i._id)+h.orientation,B=r._alignmentOpts[D]||{},U=B[h.alignmentgroup]||{},X=Object.keys(U.offsetGroups||{}).length,oe=X||w,se=X?h._offsetIndex:o.num;O=z*f*u/oe,I=2*z*(-.5+(se+.5)/oe)*f,F=z*f/oe}else O=z*f*u,I=0,F=z;o.dPos=z,o.bPos=I,o.bdPos=O,o.wHover=F;var q,K,G=I+O,Q,V,H,ee,J,W,re=Boolean(S),j=(h.boxpoints||h.points)&&_>0;if(R==="positive"?(q=z*(S?1:.5),Q=G,K=Q=I):R==="negative"?(q=Q=I,K=z*(S?1:.5),V=G):(q=K=z,Q=V=G),j){var Z=h.pointpos,ne=h.jitter,le=h.marker.size/2,ge=0;Z+ne>=0&&(ge=G*(Z+ne),ge>q?(re=!0,J=le,H=ge):ge>Q&&(J=le,H=q)),ge<=q&&(H=q);var pe=0;Z-ne<=0&&(pe=-G*(Z-ne),pe>K?(re=!0,W=le,ee=pe):pe>V&&(W=le,ee=K)),pe<=K&&(ee=K)}else H=q,ee=K;var xe=new Array(M.length);for(x=0;x<M.length;x++)xe[x]=M[x].pos;h._extremes[d]=b.findExtremes(i,xe,{padded:re,vpadminus:ee,vpadplus:H,vpadLinearized:!0,ppadminus:{x:W,y:J}[s],ppadplus:{x:J,y:W}[s]})}}}ae.exports={crossTraceCalc:e,setPositionOffset:p}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../plots/cartesian/constraints":562}],676:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../registry"),P=c("../../components/color"),E=c("../scatter/period_defaults"),e=c("../bar/defaults").handleGroupingDefaults,p=c("../../plots/cartesian/axis_autotype"),g=c("./attributes");function a(r,d,s,m){function x(A,f){return b.coerce(r,d,g,A,f)}if(t(r,d,x,m),d.visible!==!1){E(r,d,m,x),x("xhoverformat"),x("yhoverformat");var M=d._hasPreCompStats;M&&(x("lowerfence"),x("upperfence")),x("line.color",(r.marker||{}).color||s),x("line.width"),x("fillcolor",P.addOpacity(d.line.color,.5));var v=!1;if(M){var _=x("mean"),l=x("sd");_&&_.length&&(v=!0,l&&l.length&&(v="sd"))}x("boxmean",v),x("whiskerwidth"),x("width"),x("quartilemethod");var y=!1;if(M){var T=x("notchspan");T&&T.length&&(y=!0)}else b.validate(r.notchwidth,g.notchwidth)&&(y=!0);var w=x("notched",y);w&&x("notchwidth"),i(r,d,x,{prefix:"box"})}}function t(r,d,s,m){function x(X){var oe=0;return X&&X.length&&(oe+=1,b.isArrayOrTypedArray(X[0])&&X[0].length&&(oe+=1)),oe}function M(X){return b.validate(r[X],g[X])}var v=s("y"),_=s("x"),l;if(d.type==="box"){var y=s("q1"),T=s("median"),w=s("q3");d._hasPreCompStats=y&&y.length&&T&&T.length&&w&&w.length,l=Math.min(b.minRowLength(y),b.minRowLength(T),b.minRowLength(w))}var A=x(v),f=x(_),u=A&&b.minRowLength(v),h=f&&b.minRowLength(_),o=m.calendar,S={autotypenumbers:m.autotypenumbers},R,z;if(d._hasPreCompStats)switch(String(f)+String(A)){case"00":var O=M("x0")||M("dx"),I=M("y0")||M("dy");I&&!O?R="h":R="v",z=l;break;case"10":R="v",z=Math.min(l,h);break;case"20":R="h",z=Math.min(l,_.length);break;case"01":R="h",z=Math.min(l,u);break;case"02":R="v",z=Math.min(l,v.length);break;case"12":R="v",z=Math.min(l,h,v.length);break;case"21":R="h",z=Math.min(l,_.length,u);break;case"11":z=0;break;case"22":var F=!1,D;for(D=0;D<_.length;D++)if(p(_[D],o,S)==="category"){F=!0;break}if(F)R="v",z=Math.min(l,h,v.length);else{for(D=0;D<v.length;D++)if(p(v[D],o,S)==="category"){F=!0;break}F?(R="h",z=Math.min(l,_.length,u)):(R="v",z=Math.min(l,h,v.length))}break}else A>0?(R="v",f>0?z=Math.min(h,u):z=Math.min(u)):f>0?(R="h",z=Math.min(h)):z=0;if(!z){d.visible=!1;return}d._length=z;var B=s("orientation",R);d._hasPreCompStats?B==="v"&&f===0?(s("x0",0),s("dx",1)):B==="h"&&A===0&&(s("y0",0),s("dy",1)):B==="v"&&f===0?s("x0"):B==="h"&&A===0&&s("y0");var U=k.getComponentMethod("calendars","handleTraceDefaults");U(r,d,["x","y"],m)}function i(r,d,s,m){var x=m.prefix,M=b.coerce2(r,d,g,"marker.outliercolor"),v=s("marker.line.outliercolor"),_="outliers";d._hasPreCompStats?_="all":(M||v)&&(_="suspectedoutliers");var l=s(x+"points",_);l?(s("jitter",l==="all"?.3:0),s("pointpos",l==="all"?-1.5:0),s("marker.symbol"),s("marker.opacity"),s("marker.size"),s("marker.color",d.line.color),s("marker.line.color"),s("marker.line.width"),l==="suspectedoutliers"&&(s("marker.line.outliercolor",d.marker.color),s("marker.line.outlierwidth")),s("selected.marker.color"),s("unselected.marker.color"),s("selected.marker.size"),s("unselected.marker.size"),s("text"),s("hovertext")):delete d.marker;var y=s("hoveron");(y==="all"||y.indexOf("points")!==-1)&&s("hovertemplate"),b.coerceSelectionMarkerOpacity(d,s)}function n(r,d){var s,m;function x(_){return b.coerce(m._input,m,g,_)}for(var M=0;M<r.length;M++){m=r[M];var v=m.type;(v==="box"||v==="violin")&&(s=m._input,d[v+"mode"]==="group"&&e(s,m,d,x))}}ae.exports={supplyDefaults:a,crossTraceDefaults:n,handleSampleDefaults:t,handlePointsDefaults:i}},{"../../components/color":366,"../../lib":503,"../../plots/cartesian/axis_autotype":555,"../../registry":638,"../bar/defaults":652,"../scatter/period_defaults":947,"./attributes":673}],677:[function(c,ae,ie){"use strict";ae.exports=function(k,P){return P.hoverOnBox&&(k.hoverOnBox=P.hoverOnBox),"xVal"in P&&(k.x=P.xVal),"yVal"in P&&(k.y=P.yVal),P.xa&&(k.xaxis=P.xa),P.ya&&(k.yaxis=P.ya),k}},{}],678:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../lib"),P=c("../../components/fx"),E=c("../../components/color"),e=k.fillText;function p(t,i,n,r){var d=t.cd,s=d[0].trace,m=s.hoveron,x=[],M;return m.indexOf("boxes")!==-1&&(x=x.concat(g(t,i,n,r))),m.indexOf("points")!==-1&&(M=a(t,i,n)),r==="closest"?M?[M]:x:(M&&x.push(M),x)}function g(t,i,n,r){var d=t.cd,s=t.xa,m=t.ya,x=d[0].trace,M=d[0].t,v=x.type==="violin",_=[],l,y,T,w,A,f,u,h,o,S,R,z=M.bdPos,O,I,F=M.wHover,D=function(j){return T.c2l(j.pos)+M.bPos-T.c2l(f)};v&&x.side!=="both"?(x.side==="positive"&&(o=function(j){var Z=D(j);return P.inbox(Z,Z+F,S)},O=z,I=0),x.side==="negative"&&(o=function(j){var Z=D(j);return P.inbox(Z-F,Z,S)},O=0,I=z)):(o=function(j){var Z=D(j);return P.inbox(Z-F,Z+F,S)},O=I=z);var B;v?B=function(j){return P.inbox(j.span[0]-A,j.span[1]-A,S)}:B=function(j){return P.inbox(j.min-A,j.max-A,S)},x.orientation==="h"?(A=i,f=n,u=B,h=o,l="y",T=m,y="x",w=s):(A=n,f=i,u=o,h=B,l="x",T=s,y="y",w=m);var U=Math.min(1,z/Math.abs(T.r2c(T.range[1])-T.r2c(T.range[0])));S=t.maxHoverDistance-U,R=t.maxSpikeDistance-U;function X(j){return(u(j)+h(j))/2}var oe=P.getDistanceFunction(r,u,h,X);if(P.getClosest(d,oe,t),t.index===!1)return[];var se=d[t.index],q=x.line.color,K=(x.marker||{}).color;E.opacity(q)&&x.line.width?t.color=q:E.opacity(K)&&x.boxpoints?t.color=K:t.color=x.fillcolor,t[l+"0"]=T.c2p(se.pos+M.bPos-I,!0),t[l+"1"]=T.c2p(se.pos+M.bPos+O,!0),t[l+"LabelVal"]=se.orig_p!==void 0?se.orig_p:se.pos;var G=l+"Spike";t.spikeDistance=X(se)*R/S,t[G]=T.c2p(se.pos,!0);var Q={},V=["med","q1","q3","min","max"];(x.boxmean||(x.meanline||{}).visible)&&V.push("mean"),(x.boxpoints||x.points)&&V.push("lf","uf");for(var H=0;H<V.length;H++){var ee=V[H];if(!(!(ee in se)||se[ee]in Q)){Q[se[ee]]=!0;var J=se[ee],W=w.c2p(J,!0),re=k.extendFlat({},t);re.attr=ee,re[y+"0"]=re[y+"1"]=W,re[y+"LabelVal"]=J,re[y+"Label"]=(M.labels?M.labels[ee]+" ":"")+b.hoverLabelText(w,J,x[y+"hoverformat"]),re.hoverOnBox=!0,ee==="mean"&&"sd"in se&&x.boxmean==="sd"&&(re[y+"err"]=se.sd),t.name="",t.spikeDistance=void 0,t[G]=void 0,re.hovertemplate=!1,_.push(re)}}return _}function a(t,i,n){for(var r=t.cd,d=t.xa,s=t.ya,m=r[0].trace,x=d.c2p(i),M=s.c2p(n),v,_=function(D){var B=Math.max(3,D.mrc||0);return Math.max(Math.abs(d.c2p(D.x)-x)-B,1-3/B)},l=function(D){var B=Math.max(3,D.mrc||0);return Math.max(Math.abs(s.c2p(D.y)-M)-B,1-3/B)},y=P.quadrature(_,l),T=!1,w,A,f=0;f<r.length;f++){w=r[f];for(var u=0;u<(w.pts||[]).length;u++){A=w.pts[u];var h=y(A);h<=t.distance&&(t.distance=h,T=[f,u])}}if(!T)return!1;w=r[T[0]],A=w.pts[T[1]];var o=d.c2p(A.x,!0),S=s.c2p(A.y,!0),R=A.mrc||1;v=k.extendFlat({},t,{index:A.i,color:(m.marker||{}).color,name:m.name,x0:o-R,x1:o+R,y0:S-R,y1:S+R,spikeDistance:t.distance,hovertemplate:m.hovertemplate});var z=w.orig_p,O=z!==void 0?z:w.pos,I;m.orientation==="h"?(I=s,v.xLabelVal=A.x,v.yLabelVal=O):(I=d,v.xLabelVal=O,v.yLabelVal=A.y);var F=I._id.charAt(0);return v[F+"Spike"]=I.c2p(w.pos,!0),e(A,m,v),v}ae.exports={hoverPoints:p,hoverOnBoxes:g,hoverOnPoints:a}},{"../../components/color":366,"../../components/fx":406,"../../lib":503,"../../plots/cartesian/axes":554}],679:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults").supplyDefaults,crossTraceDefaults:c("./defaults").crossTraceDefaults,supplyLayoutDefaults:c("./layout_defaults").supplyLayoutDefaults,calc:c("./calc"),crossTraceCalc:c("./cross_trace_calc").crossTraceCalc,plot:c("./plot").plot,style:c("./style").style,styleOnSelect:c("./style").styleOnSelect,hoverPoints:c("./hover").hoverPoints,eventData:c("./event_data"),selectPoints:c("./select"),moduleType:"trace",name:"box",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"./attributes":673,"./calc":674,"./cross_trace_calc":675,"./defaults":676,"./event_data":677,"./hover":678,"./layout_attributes":680,"./layout_defaults":681,"./plot":682,"./select":683,"./style":684}],680:[function(c,ae,ie){"use strict";ae.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],681:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("./layout_attributes");function E(p,g,a,t,i){for(var n=i+"Layout",r=!1,d=0;d<a.length;d++){var s=a[d];if(b.traceIs(s,n)){r=!0;break}}!r||(t(i+"mode"),t(i+"gap"),t(i+"groupgap"))}function e(p,g,a){function t(i,n){return k.coerce(p,g,P,i,n)}E(p,g,a,t,"box")}ae.exports={supplyLayoutDefaults:e,_supply:E}},{"../../lib":503,"../../registry":638,"./layout_attributes":680}],682:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../components/drawing"),E=5,e=.01;function p(i,n,r,d){var s=n.xaxis,m=n.yaxis;k.makeTraceGroups(d,r,"trace boxes").each(function(x){var M=b.select(this),v=x[0],_=v.t,l=v.trace;if(_.wdPos=_.bdPos*l.whiskerwidth,l.visible!==!0||_.empty){M.remove();return}var y,T;l.orientation==="h"?(y=m,T=s):(y=s,T=m),g(M,{pos:y,val:T},l,_),a(M,{x:s,y:m},l,_),t(M,{pos:y,val:T},l,_)})}function g(i,n,r,d){var s=r.orientation==="h",m=n.val,x=n.pos,M=!!x.rangebreaks,v=d.bPos,_=d.wdPos||0,l=d.bPosPxOffset||0,y=r.whiskerwidth||0,T=r.notched||!1,w=T?1-2*r.notchwidth:1,A,f;Array.isArray(d.bdPos)?(A=d.bdPos[0],f=d.bdPos[1]):(A=d.bdPos,f=d.bdPos);var u=i.selectAll("path.box").data(r.type!=="violin"||r.box.visible?k.identity:[]);u.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),u.exit().remove(),u.each(function(h){if(h.empty)return"M0,0Z";var o=x.c2l(h.pos+v,!0),S=x.l2p(o-A)+l,R=x.l2p(o+f)+l,z=M?(S+R)/2:x.l2p(o)+l,O=r.whiskerwidth,I=M?S*O+(1-O)*z:x.l2p(o-_)+l,F=M?R*O+(1-O)*z:x.l2p(o+_)+l,D=x.l2p(o-A*w)+l,B=x.l2p(o+f*w)+l,U=m.c2p(h.q1,!0),X=m.c2p(h.q3,!0),oe=k.constrain(m.c2p(h.med,!0),Math.min(U,X)+1,Math.max(U,X)-1),se=h.lf===void 0||r.boxpoints===!1,q=m.c2p(se?h.min:h.lf,!0),K=m.c2p(se?h.max:h.uf,!0),G=m.c2p(h.ln,!0),Q=m.c2p(h.un,!0);s?b.select(this).attr("d","M"+oe+","+D+"V"+B+"M"+U+","+S+"V"+R+(T?"H"+G+"L"+oe+","+B+"L"+Q+","+R:"")+"H"+X+"V"+S+(T?"H"+Q+"L"+oe+","+D+"L"+G+","+S:"")+"ZM"+U+","+z+"H"+q+"M"+X+","+z+"H"+K+(y===0?"":"M"+q+","+I+"V"+F+"M"+K+","+I+"V"+F)):b.select(this).attr("d","M"+D+","+oe+"H"+B+"M"+S+","+U+"H"+R+(T?"V"+G+"L"+B+","+oe+"L"+R+","+Q:"")+"V"+X+"H"+S+(T?"V"+Q+"L"+D+","+oe+"L"+S+","+G:"")+"ZM"+z+","+U+"V"+q+"M"+z+","+X+"V"+K+(y===0?"":"M"+I+","+q+"H"+F+"M"+I+","+K+"H"+F))})}function a(i,n,r,d){var s=n.x,m=n.y,x=d.bdPos,M=d.bPos,v=r.boxpoints||r.points;k.seedPseudoRandom();var _=function(T){return T.forEach(function(w){w.t=d,w.trace=r}),T},l=i.selectAll("g.points").data(v?_:[]);l.enter().append("g").attr("class","points"),l.exit().remove();var y=l.selectAll("path").data(function(T){var w,A=T.pts2,f=Math.max((T.max-T.min)/10,T.q3-T.q1),u=f*1e-9,h=f*e,o=[],S=0,R;if(r.jitter){if(f===0)for(S=1,o=new Array(A.length),w=0;w<A.length;w++)o[w]=1;else for(w=0;w<A.length;w++){var z=Math.max(0,w-E),O=A[z].v,I=Math.min(A.length-1,w+E),F=A[I].v;v!=="all"&&(A[w].v<T.lf?F=Math.min(F,T.lf):O=Math.max(O,T.uf));var D=Math.sqrt(h*(I-z)/(F-O+u))||0;D=k.constrain(Math.abs(D),0,1),o.push(D),S=Math.max(D,S)}R=r.jitter*2/(S||1)}for(w=0;w<A.length;w++){var B=A[w],U=B.v,X=r.jitter?R*o[w]*(k.pseudoRandom()-.5):0,oe=T.pos+M+x*(r.pointpos+X);r.orientation==="h"?(B.y=oe,B.x=U):(B.x=oe,B.y=U),v==="suspectedoutliers"&&U<T.uo&&U>T.lo&&(B.so=!0)}return A});y.enter().append("path").classed("point",!0),y.exit().remove(),y.call(P.translatePoints,s,m)}function t(i,n,r,d){var s=n.val,m=n.pos,x=!!m.rangebreaks,M=d.bPos,v=d.bPosPxOffset||0,_=r.boxmean||(r.meanline||{}).visible,l,y;Array.isArray(d.bdPos)?(l=d.bdPos[0],y=d.bdPos[1]):(l=d.bdPos,y=d.bdPos);var T=i.selectAll("path.mean").data(r.type==="box"&&r.boxmean||r.type==="violin"&&r.box.visible&&r.meanline.visible?k.identity:[]);T.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),T.exit().remove(),T.each(function(w){var A=m.c2l(w.pos+M,!0),f=m.l2p(A-l)+v,u=m.l2p(A+y)+v,h=x?(f+u)/2:m.l2p(A)+v,o=s.c2p(w.mean,!0),S=s.c2p(w.mean-w.sd,!0),R=s.c2p(w.mean+w.sd,!0);r.orientation==="h"?b.select(this).attr("d","M"+o+","+f+"V"+u+(_==="sd"?"m0,0L"+S+","+h+"L"+o+","+f+"L"+R+","+h+"Z":"")):b.select(this).attr("d","M"+f+","+o+"H"+u+(_==="sd"?"m0,0L"+h+","+S+"L"+f+","+o+"L"+h+","+R+"Z":""))})}ae.exports={plot:p,plotBoxAndWhiskers:g,plotPoints:a,plotBoxMean:t}},{"../../components/drawing":388,"../../lib":503,"@plotly/d3":58}],683:[function(c,ae,ie){"use strict";ae.exports=function(k,P){var E=k.cd,e=k.xaxis,p=k.yaxis,g=[],a,t;if(P===!1)for(a=0;a<E.length;a++)for(t=0;t<(E[a].pts||[]).length;t++)E[a].pts[t].selected=0;else for(a=0;a<E.length;a++)for(t=0;t<(E[a].pts||[]).length;t++){var i=E[a].pts[t],n=e.c2p(i.x),r=p.c2p(i.y);P.contains([n,r],null,i.i,k)?(g.push({pointNumber:i.i,x:e.c2d(i.x),y:p.c2d(i.y)}),i.selected=1):i.selected=0}return g}},{}],684:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/color"),P=c("../../components/drawing");function E(p,g,a){var t=a||b.select(p).selectAll("g.trace.boxes");t.style("opacity",function(i){return i[0].trace.opacity}),t.each(function(i){var n=b.select(this),r=i[0].trace,d=r.line.width;function s(M,v,_,l){M.style("stroke-width",v+"px").call(k.stroke,_).call(k.fill,l)}var m=n.selectAll("path.box");if(r.type==="candlestick")m.each(function(M){if(!M.empty){var v=b.select(this),_=r[M.dir];s(v,_.line.width,_.line.color,_.fillcolor),v.style("opacity",r.selectedpoints&&!M.selected?.3:1)}});else{s(m,d,r.line.color,r.fillcolor),n.selectAll("path.mean").style({"stroke-width":d,"stroke-dasharray":2*d+"px,"+d+"px"}).call(k.stroke,r.line.color);var x=n.selectAll("path.point");P.pointStyle(x,r,p)}})}function e(p,g,a){var t=g[0].trace,i=a.selectAll("path.point");t.selectedpoints?P.selectedPointStyle(i,t):P.pointStyle(i,t,p)}ae.exports={style:E,styleOnSelect:e}},{"../../components/color":366,"../../components/drawing":388,"@plotly/d3":58}],685:[function(c,ae,ie){"use strict";var b=c("../../lib").extendFlat,k=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,P=c("../ohlc/attributes"),E=c("../box/attributes");function e(p){return{line:{color:b({},E.line.color,{dflt:p}),width:E.line.width,editType:"style"},fillcolor:E.fillcolor,editType:"style"}}ae.exports={xperiod:P.xperiod,xperiod0:P.xperiod0,xperiodalignment:P.xperiodalignment,xhoverformat:k("x"),yhoverformat:k("y"),x:P.x,open:P.open,high:P.high,low:P.low,close:P.close,line:{width:b({},E.line.width,{}),editType:"style"},increasing:e(P.increasing.line.color.dflt),decreasing:e(P.decreasing.line.color.dflt),text:P.text,hovertext:P.hovertext,whiskerwidth:b({},E.whiskerwidth,{dflt:0}),hoverlabel:P.hoverlabel}},{"../../lib":503,"../../plots/cartesian/axis_format_attributes":557,"../box/attributes":673,"../ohlc/attributes":872}],686:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("../../plots/cartesian/align_period"),E=c("../ohlc/calc").calcCommon;ae.exports=function(p,g){var a=p._fullLayout,t=k.getFromId(p,g.xaxis),i=k.getFromId(p,g.yaxis),n=t.makeCalcdata(g,"x"),r=P(g,t,"x",n).vals,d=E(p,g,n,r,i,e);return d.length?(b.extendFlat(d[0].t,{num:a._numBoxes,dPos:b.distinctVals(r).minDiff/2,posLetter:"x",valLetter:"y"}),a._numBoxes++,d):[{t:{empty:!0}}]};function e(p,g,a,t){return{min:a,q1:Math.min(p,t),med:t,q3:Math.max(p,t),max:g}}},{"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../ohlc/calc":873}],687:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color"),P=c("../ohlc/ohlc_defaults"),E=c("../scatter/period_defaults"),e=c("./attributes");ae.exports=function(a,t,i,n){function r(s,m){return b.coerce(a,t,e,s,m)}var d=P(a,t,r,n);if(!d){t.visible=!1;return}E(a,t,n,r,{x:!0}),r("xhoverformat"),r("yhoverformat"),r("line.width"),p(a,t,r,"increasing"),p(a,t,r,"decreasing"),r("text"),r("hovertext"),r("whiskerwidth"),n._requestRangeslider[t.xaxis]=!0};function p(g,a,t,i){var n=t(i+".line.color");t(i+".line.width",a.line.width),t(i+".fillcolor",k.addOpacity(n,.5))}},{"../../components/color":366,"../../lib":503,"../ohlc/ohlc_defaults":877,"../scatter/period_defaults":947,"./attributes":685}],688:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"candlestick",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:c("./attributes"),layoutAttributes:c("../box/layout_attributes"),supplyLayoutDefaults:c("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:c("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:c("./defaults"),calc:c("./calc"),plot:c("../box/plot").plot,layerName:"boxlayer",style:c("../box/style").style,hoverPoints:c("../ohlc/hover").hoverPoints,selectPoints:c("../ohlc/select")}},{"../../plots/cartesian":568,"../box/cross_trace_calc":675,"../box/layout_attributes":680,"../box/layout_defaults":681,"../box/plot":682,"../box/style":684,"../ohlc/hover":875,"../ohlc/select":879,"./attributes":685,"./calc":686,"./defaults":687}],689:[function(c,ae,ie){"use strict";var b=c("./axis_defaults"),k=c("../../plot_api/plot_template");ae.exports=function(e,p,g,a,t){var i=a("a");i||(a("da"),a("a0"));var n=a("b");n||(a("db"),a("b0")),P(e,p,g,t)};function P(E,e,p,g){var a=["aaxis","baxis"];a.forEach(function(t){var i=t.charAt(0),n=E[t]||{},r=k.newContainer(e,t),d={noTicklabelstep:!0,tickfont:"x",id:i+"axis",letter:i,font:e.font,name:t,data:E[i],calendar:e.calendar,dfltColor:g,bgColor:p.paper_bgcolor,autotypenumbersDflt:p.autotypenumbers,fullLayout:p};b(n,r,d),r._categories=r._categories||[],!E[t]&&n.type!=="-"&&(E[t]={type:n.type})})}},{"../../plot_api/plot_template":543,"./axis_defaults":694}],690:[function(c,ae,ie){"use strict";var b=c("../../lib").isArrayOrTypedArray;ae.exports=function(P){return k(P,0)};function k(P,E){if(!b(P)||E>=10)return null;for(var e=1/0,p=-1/0,g=P.length,a=0;a<g;a++){var t=P[a];if(b(t)){var i=k(t,E+1);i&&(e=Math.min(i[0],e),p=Math.max(i[1],p))}else e=Math.min(t,e),p=Math.max(t,p)}return[e,p]}},{"../../lib":503}],691:[function(c,ae,ie){"use strict";var b=c("../../plots/font_attributes"),k=c("./axis_attributes"),P=c("../../components/color/attributes"),E=b({editType:"calc"});E.family.dflt='"Open Sans", verdana, arial, sans-serif',E.size.dflt=12,E.color.dflt=P.defaultLine,ae.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:k,baxis:k,font:E,color:{valType:"color",dflt:P.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":365,"../../plots/font_attributes":585,"./axis_attributes":693}],692:[function(c,ae,ie){"use strict";var b=c("../../lib").isArrayOrTypedArray;ae.exports=function(k,P,E,e){var p,g,a,t,i,n,r,d,s,m,x,M,v,_=b(E)?"a":"b",l=_==="a"?k.aaxis:k.baxis,y=l.smoothing,T=_==="a"?k.a2i:k.b2j,w=_==="a"?E:e,A=_==="a"?e:E,f=_==="a"?P.a.length:P.b.length,u=_==="a"?P.b.length:P.a.length,h=Math.floor(_==="a"?k.b2j(A):k.a2i(A)),o=_==="a"?function(se){return k.evalxy([],se,h)}:function(se){return k.evalxy([],h,se)};y&&(a=Math.max(0,Math.min(u-2,h)),t=h-a,g=_==="a"?function(se,q){return k.dxydi([],se,a,q,t)}:function(se,q){return k.dxydj([],a,se,t,q)});var S=T(w[0]),R=T(w[1]),z=S<R?1:-1,O=(R-S)*1e-8,I=z>0?Math.floor:Math.ceil,F=z>0?Math.ceil:Math.floor,D=z>0?Math.min:Math.max,B=z>0?Math.max:Math.min,U=I(S+O),X=F(R-O);r=o(S);var oe=[[r]];for(p=U;p*z<X*z;p+=z)i=[],x=B(S,p),M=D(R,p+z),v=M-x,n=Math.max(0,Math.min(f-2,Math.floor(.5*(x+M)))),d=o(M),y&&(s=g(n,x-n),m=g(n,M-n),i.push([r[0]+s[0]/3*v,r[1]+s[1]/3*v]),i.push([d[0]-m[0]/3*v,d[1]-m[1]/3*v])),i.push(d),oe.push(i),r=d;return oe}},{"../../lib":503}],693:[function(c,ae,ie){"use strict";var b=c("../../plots/font_attributes"),k=c("../../components/color/attributes"),P=c("../../plots/cartesian/layout_attributes"),E=c("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=c("../../plot_api/edit_types").overrideAll;ae.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:b({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:P.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:b({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:E("tick label")},tickformatstops:e(P.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:k.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:k.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:b({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":365,"../../plot_api/edit_types":536,"../../plots/cartesian/axis_format_attributes":557,"../../plots/cartesian/layout_attributes":569,"../../plots/font_attributes":585}],694:[function(c,ae,ie){"use strict";var b=c("./attributes"),k=c("../../components/color").addOpacity,P=c("../../registry"),E=c("../../lib"),e=c("../../plots/cartesian/tick_value_defaults"),p=c("../../plots/cartesian/tick_label_defaults"),g=c("../../plots/cartesian/prefix_suffix_defaults"),a=c("../../plots/cartesian/category_order_defaults"),t=c("../../plots/cartesian/set_convert"),i=c("../../plots/cartesian/axis_autotype");ae.exports=function(d,s,m){var x=m.letter,M=m.font||{},v=b[x+"axis"];function _(B,U){return E.coerce(d,s,v,B,U)}function l(B,U){return E.coerce2(d,s,v,B,U)}m.name&&(s._name=m.name,s._id=m.name),_("autotypenumbers",m.autotypenumbersDflt);var y=_("type");if(y==="-"&&(m.data&&n(s,m.data),s.type==="-"?s.type="linear":y=d.type=s.type),_("smoothing"),_("cheatertype"),_("showticklabels"),_("labelprefix",x+" = "),_("labelsuffix"),_("showtickprefix"),_("showticksuffix"),_("separatethousands"),_("tickformat"),_("exponentformat"),_("minexponent"),_("showexponent"),_("categoryorder"),_("tickmode"),_("tickvals"),_("ticktext"),_("tick0"),_("dtick"),s.tickmode==="array"&&(_("arraytick0"),_("arraydtick")),_("labelpadding"),s._hovertitle=x,y==="date"){var T=P.getComponentMethod("calendars","handleDefaults");T(d,s,"calendar",m.calendar)}t(s,m.fullLayout),s.c2p=E.identity;var w=_("color",m.dfltColor),A=w===d.color?w:M.color,f=_("title.text");f&&(E.coerceFont(_,"title.font",{family:M.family,size:E.bigFont(M.size),color:A}),_("title.offset")),_("tickangle");var u=_("autorange",!s.isValidRange(d.range));u&&_("rangemode"),_("range"),s.cleanRange(),_("fixedrange"),e(d,s,_,y),g(d,s,_,y,m),p(d,s,_,y,m),a(d,s,_,{data:m.data,dataAttr:x});var h=l("gridcolor",k(w,.3)),o=l("gridwidth"),S=_("showgrid");S||(delete s.gridcolor,delete s.gridwidth);var R=l("startlinecolor",w),z=l("startlinewidth",o),O=_("startline",s.showgrid||!!R||!!z);O||(delete s.startlinecolor,delete s.startlinewidth);var I=l("endlinecolor",w),F=l("endlinewidth",o),D=_("endline",s.showgrid||!!I||!!F);return D||(delete s.endlinecolor,delete s.endlinewidth),S?(_("minorgridcount"),_("minorgridwidth",o),_("minorgridcolor",k(h,.06)),s.minorgridcount||(delete s.minorgridwidth,delete s.minorgridcolor)):(delete s.gridcolor,delete s.gridWidth),s.showticklabels==="none"&&(delete s.tickfont,delete s.tickangle,delete s.showexponent,delete s.exponentformat,delete s.minexponent,delete s.tickformat,delete s.showticksuffix,delete s.showtickprefix),s.showticksuffix||delete s.ticksuffix,s.showtickprefix||delete s.tickprefix,_("tickmode"),s};function n(r,d){if(r.type==="-"){var s=r._id,m=s.charAt(0),x=m+"calendar",M=r[x];r.type=i(d,M,{autotypenumbers:r.autotypenumbers})}}},{"../../components/color":366,"../../lib":503,"../../plots/cartesian/axis_autotype":555,"../../plots/cartesian/category_order_defaults":559,"../../plots/cartesian/prefix_suffix_defaults":573,"../../plots/cartesian/set_convert":576,"../../plots/cartesian/tick_label_defaults":578,"../../plots/cartesian/tick_value_defaults":580,"../../registry":638,"./attributes":691}],695:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../lib").isArray1D,P=c("./cheater_basis"),E=c("./array_minmax"),e=c("./calc_gridlines"),p=c("./calc_labels"),g=c("./calc_clippath"),a=c("../heatmap/clean_2d_array"),t=c("./smooth_fill_2d_array"),i=c("../heatmap/convert_column_xyz"),n=c("./set_convert");ae.exports=function(d,s){var m=b.getFromId(d,s.xaxis),x=b.getFromId(d,s.yaxis),M=s.aaxis,v=s.baxis,_=s.x,l=s.y,y=[];_&&k(_)&&y.push("x"),l&&k(l)&&y.push("y"),y.length&&i(s,M,v,"a","b",y);var T=s._a=s._a||s.a,w=s._b=s._b||s.b;_=s._x||s.x,l=s._y||s.y;var A={};if(s._cheater){var f=M.cheatertype==="index"?T.length:T,u=v.cheatertype==="index"?w.length:w;_=P(f,u,s.cheaterslope)}s._x=_=a(_),s._y=l=a(l),t(_,T,w),t(l,T,w),n(s),s.setScale();var h=E(_),o=E(l),S=.5*(h[1]-h[0]),R=.5*(h[1]+h[0]),z=.5*(o[1]-o[0]),O=.5*(o[1]+o[0]),I=1.3;return h=[R-S*I,R+S*I],o=[O-z*I,O+z*I],s._extremes[m._id]=b.findExtremes(m,h,{padded:!0}),s._extremes[x._id]=b.findExtremes(x,o,{padded:!0}),e(s,"a","b"),e(s,"b","a"),p(s,M),p(s,v),A.clipsegments=g(s._xctrl,s._yctrl,M,v),A.x=_,A.y=l,A.a=T,A.b=w,[A]}},{"../../lib":503,"../../plots/cartesian/axes":554,"../heatmap/clean_2d_array":794,"../heatmap/convert_column_xyz":796,"./array_minmax":690,"./calc_clippath":696,"./calc_gridlines":697,"./calc_labels":698,"./cheater_basis":700,"./set_convert":713,"./smooth_fill_2d_array":714}],696:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e){var p,g,a,t=[],i=!!E.smoothing,n=!!e.smoothing,r=k[0].length-1,d=k.length-1;for(p=0,g=[],a=[];p<=r;p++)g[p]=k[0][p],a[p]=P[0][p];for(t.push({x:g,y:a,bicubic:i}),p=0,g=[],a=[];p<=d;p++)g[p]=k[p][r],a[p]=P[p][r];for(t.push({x:g,y:a,bicubic:n}),p=r,g=[],a=[];p>=0;p--)g[r-p]=k[d][p],a[r-p]=P[d][p];for(t.push({x:g,y:a,bicubic:i}),p=d,g=[],a=[];p>=0;p--)g[d-p]=k[p][0],a[d-p]=P[p][0];return t.push({x:g,y:a,bicubic:n}),t}},{}],697:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../lib/extend").extendFlat;ae.exports=function(E,e,p){var g,a,t,i,n,r,d,s,m,x,M,v,_,l,y=E["_"+e],T=E[e+"axis"],w=T._gridlines=[],A=T._minorgridlines=[],f=T._boundarylines=[],u=E["_"+p],h=E[p+"axis"];T.tickmode==="array"&&(T.tickvals=y.slice());var o=E._xctrl,S=E._yctrl,R=o[0].length,z=o.length,O=E._a.length,I=E._b.length;b.prepTicks(T),T.tickmode==="array"&&delete T.tickvals;var F=T.smoothing?3:1;function D(U){var X,oe,se,q,K,G,Q,V,H,ee,J,W,re=[],j=[],Z={};if(e==="b")for(oe=E.b2j(U),se=Math.floor(Math.max(0,Math.min(I-2,oe))),q=oe-se,Z.length=I,Z.crossLength=O,Z.xy=function(ne){return E.evalxy([],ne,oe)},Z.dxy=function(ne,le){return E.dxydi([],ne,se,le,q)},X=0;X<O;X++)G=Math.min(O-2,X),Q=X-G,V=E.evalxy([],X,oe),h.smoothing&&X>0&&(H=E.dxydi([],X-1,se,0,q),re.push(K[0]+H[0]/3),j.push(K[1]+H[1]/3),ee=E.dxydi([],X-1,se,1,q),re.push(V[0]-ee[0]/3),j.push(V[1]-ee[1]/3)),re.push(V[0]),j.push(V[1]),K=V;else for(X=E.a2i(U),G=Math.floor(Math.max(0,Math.min(O-2,X))),Q=X-G,Z.length=O,Z.crossLength=I,Z.xy=function(ne){return E.evalxy([],X,ne)},Z.dxy=function(ne,le){return E.dxydj([],G,ne,Q,le)},oe=0;oe<I;oe++)se=Math.min(I-2,oe),q=oe-se,V=E.evalxy([],X,oe),h.smoothing&&oe>0&&(J=E.dxydj([],G,oe-1,Q,0),re.push(K[0]+J[0]/3),j.push(K[1]+J[1]/3),W=E.dxydj([],G,oe-1,Q,1),re.push(V[0]-W[0]/3),j.push(V[1]-W[1]/3)),re.push(V[0]),j.push(V[1]),K=V;return Z.axisLetter=e,Z.axis=T,Z.crossAxis=h,Z.value=U,Z.constvar=p,Z.index=s,Z.x=re,Z.y=j,Z.smoothing=h.smoothing,Z}function B(U){var X,oe,se,q,K,G=[],Q=[],V={};if(V.length=y.length,V.crossLength=u.length,e==="b")for(se=Math.max(0,Math.min(I-2,U)),K=Math.min(1,Math.max(0,U-se)),V.xy=function(H){return E.evalxy([],H,U)},V.dxy=function(H,ee){return E.dxydi([],H,se,ee,K)},X=0;X<R;X++)G[X]=o[U*F][X],Q[X]=S[U*F][X];else for(oe=Math.max(0,Math.min(O-2,U)),q=Math.min(1,Math.max(0,U-oe)),V.xy=function(H){return E.evalxy([],U,H)},V.dxy=function(H,ee){return E.dxydj([],oe,H,q,ee)},X=0;X<z;X++)G[X]=o[X][U*F],Q[X]=S[X][U*F];return V.axisLetter=e,V.axis=T,V.crossAxis=h,V.value=y[U],V.constvar=p,V.index=U,V.x=G,V.y=Q,V.smoothing=h.smoothing,V}if(T.tickmode==="array"){for(i=5e-15,n=[Math.floor((y.length-1-T.arraytick0)/T.arraydtick*(1+i)),Math.ceil(-T.arraytick0/T.arraydtick/(1+i))].sort(function(U,X){return U-X}),r=n[0]-1,d=n[1]+1,s=r;s<d;s++)a=T.arraytick0+T.arraydtick*s,!(a<0||a>y.length-1)&&w.push(k(B(a),{color:T.gridcolor,width:T.gridwidth}));for(s=r;s<d;s++)if(t=T.arraytick0+T.arraydtick*s,M=Math.min(t+T.arraydtick,y.length-1),!(t<0||t>y.length-1)&&!(M<0||M>y.length-1))for(v=y[t],_=y[M],g=0;g<T.minorgridcount;g++)l=M-t,!(l<=0)&&(x=v+(_-v)*(g+1)/(T.minorgridcount+1)*(T.arraydtick/l),!(x<y[0]||x>y[y.length-1])&&A.push(k(D(x),{color:T.minorgridcolor,width:T.minorgridwidth})));T.startline&&f.push(k(B(0),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&f.push(k(B(y.length-1),{color:T.endlinecolor,width:T.endlinewidth}))}else{for(i=5e-15,n=[Math.floor((y[y.length-1]-T.tick0)/T.dtick*(1+i)),Math.ceil((y[0]-T.tick0)/T.dtick/(1+i))].sort(function(U,X){return U-X}),r=n[0],d=n[1],s=r;s<=d;s++)m=T.tick0+T.dtick*s,w.push(k(D(m),{color:T.gridcolor,width:T.gridwidth}));for(s=r-1;s<d+1;s++)for(m=T.tick0+T.dtick*s,g=0;g<T.minorgridcount;g++)x=m+T.dtick*(g+1)/(T.minorgridcount+1),!(x<y[0]||x>y[y.length-1])&&A.push(k(D(x),{color:T.minorgridcolor,width:T.minorgridwidth}));T.startline&&f.push(k(D(y[0]),{color:T.startlinecolor,width:T.startlinewidth})),T.endline&&f.push(k(D(y[y.length-1]),{color:T.endlinecolor,width:T.endlinewidth}))}}},{"../../lib/extend":493,"../../plots/cartesian/axes":554}],698:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../lib/extend").extendFlat;ae.exports=function(E,e){var p,g,a,t,i,n=e._labels=[],r=e._gridlines;for(p=0;p<r.length;p++)i=r[p],["start","both"].indexOf(e.showticklabels)!==-1&&(g=b.tickText(e,i.value),k(g,{prefix:a,suffix:t,endAnchor:!0,xy:i.xy(0),dxy:i.dxy(0,0),axis:i.axis,length:i.crossAxis.length,font:i.axis.tickfont,isFirst:p===0,isLast:p===r.length-1}),n.push(g)),["end","both"].indexOf(e.showticklabels)!==-1&&(g=b.tickText(e,i.value),k(g,{endAnchor:!1,xy:i.xy(i.crossLength-1),dxy:i.dxy(i.crossLength-2,1),axis:i.axis,length:i.crossAxis.length,font:i.axis.tickfont,isFirst:p===0,isLast:p===r.length-1}),n.push(g))}},{"../../lib/extend":493,"../../plots/cartesian/axes":554}],699:[function(c,ae,ie){"use strict";var b=.5;ae.exports=function(P,E,e,p){var g=P[0]-E[0],a=P[1]-E[1],t=e[0]-E[0],i=e[1]-E[1],n=Math.pow(g*g+a*a,b/2),r=Math.pow(t*t+i*i,b/2),d=(r*r*g-n*n*t)*p,s=(r*r*a-n*n*i)*p,m=r*(n+r)*3,x=n*(n+r)*3;return[[E[0]+(m&&d/m),E[1]+(m&&s/m)],[E[0]-(x&&d/x),E[1]-(x&&s/x)]]}},{}],700:[function(c,ae,ie){"use strict";var b=c("../../lib").isArrayOrTypedArray;ae.exports=function(k,P,E){var e,p,g,a,t,i,n=[],r=b(k)?k.length:k,d=b(P)?P.length:P,s=b(k)?k:null,m=b(P)?P:null;s&&(g=(s.length-1)/(s[s.length-1]-s[0])/(r-1)),m&&(a=(m.length-1)/(m[m.length-1]-m[0])/(d-1));var x,M=1/0,v=-1/0;for(p=0;p<d;p++)for(n[p]=[],i=m?(m[p]-m[0])*a:p/(d-1),e=0;e<r;e++)t=s?(s[e]-s[0])*g:e/(r-1),x=t-i*E,M=Math.min(x,M),v=Math.max(x,v),n[p][e]=x;var _=1/(v-M),l=-M*_;for(p=0;p<d;p++)for(e=0;e<r;e++)n[p][e]=_*n[p][e]+l;return n}},{"../../lib":503}],701:[function(c,ae,ie){"use strict";var b=c("./catmull_rom"),k=c("../../lib").ensureArray;function P(E,e,p){var g=-.5*p[0]+1.5*e[0],a=-.5*p[1]+1.5*e[1];return[(2*g+E[0])/3,(2*a+E[1])/3]}ae.exports=function(e,p,g,a,t,i){var n,r,d,s,m,x,M,v,_,l,y=g[0].length,T=g.length,w=t?3*y-2:y,A=i?3*T-2:T;for(e=k(e,A),p=k(p,A),d=0;d<A;d++)e[d]=k(e[d],w),p[d]=k(p[d],w);for(r=0,s=0;r<T;r++,s+=i?3:1)for(m=e[s],x=p[s],M=g[r],v=a[r],n=0,d=0;n<y;n++,d+=t?3:1)m[d]=M[n],x[d]=v[n];if(t)for(r=0,s=0;r<T;r++,s+=i?3:1){for(n=1,d=3;n<y-1;n++,d+=3)_=b([g[r][n-1],a[r][n-1]],[g[r][n],a[r][n]],[g[r][n+1],a[r][n+1]],t),e[s][d-1]=_[0][0],p[s][d-1]=_[0][1],e[s][d+1]=_[1][0],p[s][d+1]=_[1][1];l=P([e[s][0],p[s][0]],[e[s][2],p[s][2]],[e[s][3],p[s][3]]),e[s][1]=l[0],p[s][1]=l[1],l=P([e[s][w-1],p[s][w-1]],[e[s][w-3],p[s][w-3]],[e[s][w-4],p[s][w-4]]),e[s][w-2]=l[0],p[s][w-2]=l[1]}if(i)for(d=0;d<w;d++){for(s=3;s<A-3;s+=3)_=b([e[s-3][d],p[s-3][d]],[e[s][d],p[s][d]],[e[s+3][d],p[s+3][d]],i),e[s-1][d]=_[0][0],p[s-1][d]=_[0][1],e[s+1][d]=_[1][0],p[s+1][d]=_[1][1];l=P([e[0][d],p[0][d]],[e[2][d],p[2][d]],[e[3][d],p[3][d]]),e[1][d]=l[0],p[1][d]=l[1],l=P([e[A-1][d],p[A-1][d]],[e[A-3][d],p[A-3][d]],[e[A-4][d],p[A-4][d]]),e[A-2][d]=l[0],p[A-2][d]=l[1]}if(t&&i)for(s=1;s<A;s+=(s+1)%3===0?2:1){for(d=3;d<w-3;d+=3)_=b([e[s][d-3],p[s][d-3]],[e[s][d],p[s][d]],[e[s][d+3],p[s][d+3]],t),e[s][d-1]=.5*(e[s][d-1]+_[0][0]),p[s][d-1]=.5*(p[s][d-1]+_[0][1]),e[s][d+1]=.5*(e[s][d+1]+_[1][0]),p[s][d+1]=.5*(p[s][d+1]+_[1][1]);l=P([e[s][0],p[s][0]],[e[s][2],p[s][2]],[e[s][3],p[s][3]]),e[s][1]=.5*(e[s][1]+l[0]),p[s][1]=.5*(p[s][1]+l[1]),l=P([e[s][w-1],p[s][w-1]],[e[s][w-3],p[s][w-3]],[e[s][w-4],p[s][w-4]]),e[s][w-2]=.5*(e[s][w-2]+l[0]),p[s][w-2]=.5*(p[s][w-2]+l[1])}return[e,p]}},{"../../lib":503,"./catmull_rom":699}],702:[function(c,ae,ie){"use strict";ae.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],703:[function(c,ae,ie){"use strict";ae.exports=function(b,k,P){return k&&P?function(E,e,p,g,a){E||(E=[]);var t,i,n,r,d,s;e*=3,p*=3;var m=g*g,x=1-g,M=x*x,v=x*g*2,_=-3*M,l=3*(M-v),y=3*(v-m),T=3*m,w=a*a,A=w*a,f=1-a,u=f*f,h=u*f;for(s=0;s<b.length;s++)d=b[s],t=_*d[p][e]+l*d[p][e+1]+y*d[p][e+2]+T*d[p][e+3],i=_*d[p+1][e]+l*d[p+1][e+1]+y*d[p+1][e+2]+T*d[p+1][e+3],n=_*d[p+2][e]+l*d[p+2][e+1]+y*d[p+2][e+2]+T*d[p+2][e+3],r=_*d[p+3][e]+l*d[p+3][e+1]+y*d[p+3][e+2]+T*d[p+3][e+3],E[s]=h*t+3*(u*a*i+f*w*n)+A*r;return E}:k?function(E,e,p,g,a){E||(E=[]);var t,i,n,r;e*=3;var d=g*g,s=1-g,m=s*s,x=s*g*2,M=-3*m,v=3*(m-x),_=3*(x-d),l=3*d,y=1-a;for(n=0;n<b.length;n++)r=b[n],t=M*r[p][e]+v*r[p][e+1]+_*r[p][e+2]+l*r[p][e+3],i=M*r[p+1][e]+v*r[p+1][e+1]+_*r[p+1][e+2]+l*r[p+1][e+3],E[n]=y*t+a*i;return E}:P?function(E,e,p,g,a){E||(E=[]);var t,i,n,r,d,s;p*=3;var m=a*a,x=m*a,M=1-a,v=M*M,_=v*M;for(d=0;d<b.length;d++)s=b[d],t=s[p][e+1]-s[p][e],i=s[p+1][e+1]-s[p+1][e],n=s[p+2][e+1]-s[p+2][e],r=s[p+3][e+1]-s[p+3][e],E[d]=_*t+3*(v*a*i+M*m*n)+x*r;return E}:function(E,e,p,g,a){E||(E=[]);var t,i,n,r,d=1-a;for(n=0;n<b.length;n++)r=b[n],t=r[p][e+1]-r[p][e],i=r[p+1][e+1]-r[p+1][e],E[n]=d*t+a*i;return E}}},{}],704:[function(c,ae,ie){"use strict";ae.exports=function(b,k,P){return k&&P?function(E,e,p,g,a){E||(E=[]);var t,i,n,r,d,s;e*=3,p*=3;var m=g*g,x=m*g,M=1-g,v=M*M,_=v*M,l=a*a,y=1-a,T=y*y,w=y*a*2,A=-3*T,f=3*(T-w),u=3*(w-l),h=3*l;for(s=0;s<b.length;s++)d=b[s],t=A*d[p][e]+f*d[p+1][e]+u*d[p+2][e]+h*d[p+3][e],i=A*d[p][e+1]+f*d[p+1][e+1]+u*d[p+2][e+1]+h*d[p+3][e+1],n=A*d[p][e+2]+f*d[p+1][e+2]+u*d[p+2][e+2]+h*d[p+3][e+2],r=A*d[p][e+3]+f*d[p+1][e+3]+u*d[p+2][e+3]+h*d[p+3][e+3],E[s]=_*t+3*(v*g*i+M*m*n)+x*r;return E}:k?function(E,e,p,g,a){E||(E=[]);var t,i,n,r,d,s;e*=3;var m=a*a,x=m*a,M=1-a,v=M*M,_=v*M;for(d=0;d<b.length;d++)s=b[d],t=s[p+1][e]-s[p][e],i=s[p+1][e+1]-s[p][e+1],n=s[p+1][e+2]-s[p][e+2],r=s[p+1][e+3]-s[p][e+3],E[d]=_*t+3*(v*a*i+M*m*n)+x*r;return E}:P?function(E,e,p,g,a){E||(E=[]);var t,i,n,r;p*=3;var d=1-g,s=a*a,m=1-a,x=m*m,M=m*a*2,v=-3*x,_=3*(x-M),l=3*(M-s),y=3*s;for(n=0;n<b.length;n++)r=b[n],t=v*r[p][e]+_*r[p+1][e]+l*r[p+2][e]+y*r[p+3][e],i=v*r[p][e+1]+_*r[p+1][e+1]+l*r[p+2][e+1]+y*r[p+3][e+1],E[n]=d*t+g*i;return E}:function(E,e,p,g,a){E||(E=[]);var t,i,n,r,d=1-g;for(n=0;n<b.length;n++)r=b[n],t=r[p+1][e]-r[p][e],i=r[p+1][e+1]-r[p][e+1],E[n]=d*t+g*i;return E}}},{}],705:[function(c,ae,ie){"use strict";ae.exports=function(b,k,P,E,e){var p=k-2,g=P-2;return E&&e?function(a,t,i){a||(a=[]);var n,r,d,s,m,x,M=Math.max(0,Math.min(Math.floor(t),p)),v=Math.max(0,Math.min(Math.floor(i),g)),_=Math.max(0,Math.min(1,t-M)),l=Math.max(0,Math.min(1,i-v));M*=3,v*=3;var y=_*_,T=y*_,w=1-_,A=w*w,f=A*w,u=l*l,h=u*l,o=1-l,S=o*o,R=S*o;for(x=0;x<b.length;x++)m=b[x],n=f*m[v][M]+3*(A*_*m[v][M+1]+w*y*m[v][M+2])+T*m[v][M+3],r=f*m[v+1][M]+3*(A*_*m[v+1][M+1]+w*y*m[v+1][M+2])+T*m[v+1][M+3],d=f*m[v+2][M]+3*(A*_*m[v+2][M+1]+w*y*m[v+2][M+2])+T*m[v+2][M+3],s=f*m[v+3][M]+3*(A*_*m[v+3][M+1]+w*y*m[v+3][M+2])+T*m[v+3][M+3],a[x]=R*n+3*(S*l*r+o*u*d)+h*s;return a}:E?function(a,t,i){a||(a=[]);var n=Math.max(0,Math.min(Math.floor(t),p)),r=Math.max(0,Math.min(Math.floor(i),g)),d=Math.max(0,Math.min(1,t-n)),s=Math.max(0,Math.min(1,i-r)),m,x,M,v,_,l;n*=3;var y=d*d,T=y*d,w=1-d,A=w*w,f=A*w,u=1-s;for(_=0;_<b.length;_++)l=b[_],m=u*l[r][n]+s*l[r+1][n],x=u*l[r][n+1]+s*l[r+1][n+1],M=u*l[r][n+2]+s*l[r+1][n+1],v=u*l[r][n+3]+s*l[r+1][n+1],a[_]=f*m+3*(A*d*x+w*y*M)+T*v;return a}:e?function(a,t,i){a||(a=[]);var n=Math.max(0,Math.min(Math.floor(t),p)),r=Math.max(0,Math.min(Math.floor(i),g)),d=Math.max(0,Math.min(1,t-n)),s=Math.max(0,Math.min(1,i-r)),m,x,M,v,_,l;r*=3;var y=s*s,T=y*s,w=1-s,A=w*w,f=A*w,u=1-d;for(_=0;_<b.length;_++)l=b[_],m=u*l[r][n]+d*l[r][n+1],x=u*l[r+1][n]+d*l[r+1][n+1],M=u*l[r+2][n]+d*l[r+2][n+1],v=u*l[r+3][n]+d*l[r+3][n+1],a[_]=f*m+3*(A*s*x+w*y*M)+T*v;return a}:function(a,t,i){a||(a=[]);var n=Math.max(0,Math.min(Math.floor(t),p)),r=Math.max(0,Math.min(Math.floor(i),g)),d=Math.max(0,Math.min(1,t-n)),s=Math.max(0,Math.min(1,i-r)),m,x,M,v,_=1-s,l=1-d;for(M=0;M<b.length;M++)v=b[M],m=l*v[r][n]+d*v[r][n+1],x=l*v[r+1][n]+d*v[r+1][n+1],a[M]=_*m+s*x;return a}}},{}],706:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./xy_defaults"),P=c("./ab_defaults"),E=c("./attributes"),e=c("../../components/color/attributes");ae.exports=function(g,a,t,i){function n(s,m){return b.coerce(g,a,E,s,m)}a._clipPathId="clip"+a.uid+"carpet";var r=n("color",e.defaultLine);if(b.coerceFont(n,"font"),n("carpet"),P(g,a,i,n,r),!a.a||!a.b){a.visible=!1;return}a.a.length<3&&(a.aaxis.smoothing=0),a.b.length<3&&(a.baxis.smoothing=0);var d=k(g,a,n);d||(a.visible=!1),a._cheater&&n("cheaterslope")}},{"../../components/color/attributes":365,"../../lib":503,"./ab_defaults":689,"./attributes":691,"./xy_defaults":715}],707:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),plot:c("./plot"),calc:c("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":568,"./attributes":691,"./calc":695,"./defaults":706,"./plot":712}],708:[function(c,ae,ie){"use strict";ae.exports=function(b,k){for(var P=b._fullData.length,E,e=0;e<P;e++){var p=b._fullData[e];if(p.index!==k.index&&p.type==="carpet"&&(E||(E=p),p.carpet===k.carpet))return p}return E}},{}],709:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E){if(k.length===0)return"";var e,p=[],g=E?3:1;for(e=0;e<k.length;e+=g)p.push(k[e]+","+P[e]),E&&e<k.length-g&&(p.push("C"),p.push([k[e+1]+","+P[e+1],k[e+2]+","+P[e+2]+" "].join(" ")));return p.join(E?"":"L")}},{}],710:[function(c,ae,ie){"use strict";var b=c("../../lib").isArrayOrTypedArray;ae.exports=function(P,E,e){var p;for(b(P)?P.length>E.length&&(P=P.slice(0,E.length)):P=[],p=0;p<E.length;p++)P[p]=e(E[p]);return P}},{"../../lib":503}],711:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e,p,g){var a=p[0]*k.dpdx(P),t=p[1]*k.dpdy(E),i=1,n=1;if(g){var r=Math.sqrt(p[0]*p[0]+p[1]*p[1]),d=Math.sqrt(g[0]*g[0]+g[1]*g[1]),s=(p[0]*g[0]+p[1]*g[1])/r/d;n=Math.max(0,s)}var m=Math.atan2(t,a)*180/Math.PI;return m<-90?(m+=180,i=-i):m>90&&(m-=180,i=-i),{angle:m,flip:i,p:k.c2p(e,P,E),offsetMultplier:n}}},{}],712:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/drawing"),P=c("./map_1d_array"),E=c("./makepath"),e=c("./orient_text"),p=c("../../lib/svg_text_utils"),g=c("../../lib"),a=g.strRotate,t=g.strTranslate,i=c("../../constants/alignment");ae.exports=function(_,l,y,T){var w=l.xaxis,A=l.yaxis,f=_._fullLayout,u=f._clips;g.makeTraceGroups(T,y,"trace").each(function(h){var o=b.select(this),S=h[0],R=S.trace,z=R.aaxis,O=R.baxis,I=g.ensureSingle(o,"g","minorlayer"),F=g.ensureSingle(o,"g","majorlayer"),D=g.ensureSingle(o,"g","boundarylayer"),B=g.ensureSingle(o,"g","labellayer");o.style("opacity",R.opacity),r(w,A,F,z,"a",z._gridlines,!0),r(w,A,F,O,"b",O._gridlines,!0),r(w,A,I,z,"a",z._minorgridlines,!0),r(w,A,I,O,"b",O._minorgridlines,!0),r(w,A,D,z,"a-boundary",z._boundarylines),r(w,A,D,O,"b-boundary",O._boundarylines);var U=d(_,w,A,R,S,B,z._labels,"a-label"),X=d(_,w,A,R,S,B,O._labels,"b-label");s(_,B,R,S,w,A,U,X),n(R,S,u,w,A)})};function n(v,_,l,y,T){var w,A,f,u,h=l.select("#"+v._clipPathId);h.size()||(h=l.append("clipPath").classed("carpetclip",!0));var o=g.ensureSingle(h,"path","carpetboundary"),S=_.clipsegments,R=[];for(u=0;u<S.length;u++)w=S[u],A=P([],w.x,y.c2p),f=P([],w.y,T.c2p),R.push(E(A,f,w.bicubic));var z="M"+R.join("L")+"Z";h.attr("id",v._clipPathId),o.attr("d",z)}function r(v,_,l,y,T,w){var A="const-"+T+"-lines",f=l.selectAll("."+A).data(w);f.enter().append("path").classed(A,!0).style("vector-effect","non-scaling-stroke"),f.each(function(u){var h=u,o=h.x,S=h.y,R=P([],o,v.c2p),z=P([],S,_.c2p),O="M"+E(R,z,h.smoothing),I=b.select(this);I.attr("d",O).style("stroke-width",h.width).style("stroke",h.color).style("fill","none")}),f.exit().remove()}function d(v,_,l,y,T,w,A,f){var u=w.selectAll("text."+f).data(A);u.enter().append("text").classed(f,!0);var h=0,o={};return u.each(function(S,R){var z;if(S.axis.tickangle==="auto")z=e(y,_,l,S.xy,S.dxy);else{var O=(S.axis.tickangle+180)*Math.PI/180;z=e(y,_,l,S.xy,[Math.cos(O),Math.sin(O)])}R||(o={angle:z.angle,flip:z.flip});var I=(S.endAnchor?-1:1)*z.flip,F=b.select(this).attr({"text-anchor":I>0?"start":"end","data-notex":1}).call(k.font,S.font).text(S.text).call(p.convertToTspans,v),D=k.bBox(this);F.attr("transform",t(z.p[0],z.p[1])+a(z.angle)+t(S.axis.labelpadding*I,D.height*.3)),h=Math.max(h,D.width+S.axis.labelpadding)}),u.exit().remove(),o.maxExtent=h,o}function s(v,_,l,y,T,w,A,f){var u,h,o,S,R=g.aggNums(Math.min,null,l.a),z=g.aggNums(Math.max,null,l.a),O=g.aggNums(Math.min,null,l.b),I=g.aggNums(Math.max,null,l.b);u=.5*(R+z),h=O,o=l.ab2xy(u,h,!0),S=l.dxyda_rough(u,h),A.angle===void 0&&g.extendFlat(A,e(l,T,w,o,l.dxydb_rough(u,h))),M(v,_,l,y,o,S,l.aaxis,T,w,A,"a-title"),u=R,h=.5*(O+I),o=l.ab2xy(u,h,!0),S=l.dxydb_rough(u,h),f.angle===void 0&&g.extendFlat(f,e(l,T,w,o,l.dxyda_rough(u,h))),M(v,_,l,y,o,S,l.baxis,T,w,f,"b-title")}var m=i.LINE_SPACING,x=(1-i.MID_SHIFT)/m+1;function M(v,_,l,y,T,w,A,f,u,h,o){var S=[];A.title.text&&S.push(A.title.text);var R=_.selectAll("text."+o).data(S),z=h.maxExtent;R.enter().append("text").classed(o,!0),R.each(function(){var O=e(l,f,u,T,w);["start","both"].indexOf(A.showticklabels)===-1&&(z=0);var I=A.title.font.size;z+=I+A.title.offset;var F=h.angle+(h.flip<0?180:0),D=(F-O.angle+450)%360,B=D>90&&D<270,U=b.select(this);U.text(A.title.text).call(p.convertToTspans,v),B&&(z=(-p.lineCount(U)+x)*m*I-z),U.attr("transform",t(O.p[0],O.p[1])+a(O.angle)+t(0,z)).attr("text-anchor","middle").call(k.font,A.title.font)}),R.exit().remove()}},{"../../components/drawing":388,"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"./makepath":709,"./map_1d_array":710,"./orient_text":711,"@plotly/d3":58}],713:[function(c,ae,ie){"use strict";var b=c("./constants"),k=c("../../lib/search").findBin,P=c("./compute_control_points"),E=c("./create_spline_evaluator"),e=c("./create_i_derivative_evaluator"),p=c("./create_j_derivative_evaluator");ae.exports=function(a){var t=a._a,i=a._b,n=t.length,r=i.length,d=a.aaxis,s=a.baxis,m=t[0],x=t[n-1],M=i[0],v=i[r-1],_=t[t.length-1]-t[0],l=i[i.length-1]-i[0],y=_*b.RELATIVE_CULL_TOLERANCE,T=l*b.RELATIVE_CULL_TOLERANCE;m-=y,x+=y,M-=T,v+=T,a.isVisible=function(w,A){return w>m&&w<x&&A>M&&A<v},a.isOccluded=function(w,A){return w<m||w>x||A<M||A>v},a.setScale=function(){var w=a._x,A=a._y,f=P(a._xctrl,a._yctrl,w,A,d.smoothing,s.smoothing);a._xctrl=f[0],a._yctrl=f[1],a.evalxy=E([a._xctrl,a._yctrl],n,r,d.smoothing,s.smoothing),a.dxydi=e([a._xctrl,a._yctrl],d.smoothing,s.smoothing),a.dxydj=p([a._xctrl,a._yctrl],d.smoothing,s.smoothing)},a.i2a=function(w){var A=Math.max(0,Math.floor(w[0]),n-2),f=w[0]-A;return(1-f)*t[A]+f*t[A+1]},a.j2b=function(w){var A=Math.max(0,Math.floor(w[1]),n-2),f=w[1]-A;return(1-f)*i[A]+f*i[A+1]},a.ij2ab=function(w){return[a.i2a(w[0]),a.j2b(w[1])]},a.a2i=function(w){var A=Math.max(0,Math.min(k(w,t),n-2)),f=t[A],u=t[A+1];return Math.max(0,Math.min(n-1,A+(w-f)/(u-f)))},a.b2j=function(w){var A=Math.max(0,Math.min(k(w,i),r-2)),f=i[A],u=i[A+1];return Math.max(0,Math.min(r-1,A+(w-f)/(u-f)))},a.ab2ij=function(w){return[a.a2i(w[0]),a.b2j(w[1])]},a.i2c=function(w,A){return a.evalxy([],w,A)},a.ab2xy=function(w,A,f){if(!f&&(w<t[0]||w>t[n-1]|A<i[0]||A>i[r-1]))return[!1,!1];var u=a.a2i(w),h=a.b2j(A),o=a.evalxy([],u,h);if(f){var S=0,R=0,z=[],O,I,F,D;w<t[0]?(O=0,I=0,S=(w-t[0])/(t[1]-t[0])):w>t[n-1]?(O=n-2,I=1,S=(w-t[n-1])/(t[n-1]-t[n-2])):(O=Math.max(0,Math.min(n-2,Math.floor(u))),I=u-O),A<i[0]?(F=0,D=0,R=(A-i[0])/(i[1]-i[0])):A>i[r-1]?(F=r-2,D=1,R=(A-i[r-1])/(i[r-1]-i[r-2])):(F=Math.max(0,Math.min(r-2,Math.floor(h))),D=h-F),S&&(a.dxydi(z,O,F,I,D),o[0]+=z[0]*S,o[1]+=z[1]*S),R&&(a.dxydj(z,O,F,I,D),o[0]+=z[0]*R,o[1]+=z[1]*R)}return o},a.c2p=function(w,A,f){return[A.c2p(w[0]),f.c2p(w[1])]},a.p2x=function(w,A,f){return[A.p2c(w[0]),f.p2c(w[1])]},a.dadi=function(w){var A=Math.max(0,Math.min(t.length-2,w));return t[A+1]-t[A]},a.dbdj=function(w){var A=Math.max(0,Math.min(i.length-2,w));return i[A+1]-i[A]},a.dxyda=function(w,A,f,u){var h=a.dxydi(null,w,A,f,u),o=a.dadi(w,f);return[h[0]/o,h[1]/o]},a.dxydb=function(w,A,f,u){var h=a.dxydj(null,w,A,f,u),o=a.dbdj(A,u);return[h[0]/o,h[1]/o]},a.dxyda_rough=function(w,A,f){var u=_*(f||.1),h=a.ab2xy(w+u,A,!0),o=a.ab2xy(w-u,A,!0);return[(h[0]-o[0])*.5/u,(h[1]-o[1])*.5/u]},a.dxydb_rough=function(w,A,f){var u=l*(f||.1),h=a.ab2xy(w,A+u,!0),o=a.ab2xy(w,A-u,!0);return[(h[0]-o[0])*.5/u,(h[1]-o[1])*.5/u]},a.dpdx=function(w){return w._m},a.dpdy=function(w){return w._m}}},{"../../lib/search":523,"./compute_control_points":701,"./constants":702,"./create_i_derivative_evaluator":703,"./create_j_derivative_evaluator":704,"./create_spline_evaluator":705}],714:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E,e){var p,g,a,t=[],i=[],n=P[0].length,r=P.length;function d(oe,se){var q=0,K,G=0;return oe>0&&(K=P[se][oe-1])!==void 0&&(G++,q+=K),oe<n-1&&(K=P[se][oe+1])!==void 0&&(G++,q+=K),se>0&&(K=P[se-1][oe])!==void 0&&(G++,q+=K),se<r-1&&(K=P[se+1][oe])!==void 0&&(G++,q+=K),q/Math.max(1,G)}var s=0;for(p=0;p<n;p++)for(g=0;g<r;g++)P[g][p]===void 0&&(t.push(p),i.push(g),P[g][p]=d(p,g)),s=Math.max(s,Math.abs(P[g][p]));if(!t.length)return P;var m,x,M,v,_,l,y,T,w,A,f,u=1e-5,h=0,o=100,S=0,R=t.length;do{for(h=0,a=0;a<R;a++){p=t[a],g=i[a];var z=0,O=0,I,F,D,B,U,X;p===0?(U=Math.min(n-1,2),D=E[U],B=E[1],I=P[g][U],F=P[g][1],O+=F+(F-I)*(E[0]-B)/(B-D),z++):p===n-1&&(U=Math.max(0,n-3),D=E[U],B=E[n-2],I=P[g][U],F=P[g][n-2],O+=F+(F-I)*(E[n-1]-B)/(B-D),z++),(p===0||p===n-1)&&g>0&&g<r-1&&(m=e[g+1]-e[g],x=e[g]-e[g-1],O+=(x*P[g+1][p]+m*P[g-1][p])/(x+m),z++),g===0?(X=Math.min(r-1,2),D=e[X],B=e[1],I=P[X][p],F=P[1][p],O+=F+(F-I)*(e[0]-B)/(B-D),z++):g===r-1&&(X=Math.max(0,r-3),D=e[X],B=e[r-2],I=P[X][p],F=P[r-2][p],O+=F+(F-I)*(e[r-1]-B)/(B-D),z++),(g===0||g===r-1)&&p>0&&p<n-1&&(m=E[p+1]-E[p],x=E[p]-E[p-1],O+=(x*P[g][p+1]+m*P[g][p-1])/(x+m),z++),z?O/=z:(M=E[p+1]-E[p],v=E[p]-E[p-1],_=e[g+1]-e[g],l=e[g]-e[g-1],y=M*v*(M+v),T=_*l*(_+l),O=(y*(l*P[g+1][p]+_*P[g-1][p])+T*(v*P[g][p+1]+M*P[g][p-1]))/(T*(v+M)+y*(l+_))),w=O-P[g][p],A=w/s,h+=A*A,f=z?0:.85,P[g][p]+=w*(1+f)}h=Math.sqrt(h)}while(S++<o&&h>u);return b.log("Smoother converged to",h,"after",S,"iterations"),P}},{"../../lib":503}],715:[function(c,ae,ie){"use strict";var b=c("../../lib").isArray1D;ae.exports=function(P,E,e){var p=e("x"),g=p&&p.length,a=e("y"),t=a&&a.length;if(!g&&!t)return!1;if(E._cheater=!p,(!g||b(p))&&(!t||b(a))){var i=g?p.length:1/0;t&&(i=Math.min(i,a.length)),E.a&&E.a.length&&(i=Math.min(i,E.a.length)),E.b&&E.b.length&&(i=Math.min(i,E.b.length)),E._length=i}else E._length=null;return!0}},{"../../lib":503}],716:[function(c,ae,ie){"use strict";var b=c("../../plots/template_attributes").hovertemplateAttrs,k=c("../scattergeo/attributes"),P=c("../../components/colorscale/attributes"),E=c("../../plots/attributes"),e=c("../../components/color/attributes").defaultLine,p=c("../../lib/extend").extendFlat,g=k.marker.line;ae.exports=p({locations:{valType:"data_array",editType:"calc"},locationmode:k.locationmode,z:{valType:"data_array",editType:"calc"},geojson:p({},k.geojson,{}),featureidkey:k.featureidkey,text:p({},k.text,{}),hovertext:p({},k.hovertext,{}),marker:{line:{color:p({},g.color,{dflt:e}),width:p({},g.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:k.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:k.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:p({},E.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:b(),showlegend:p({},E.showlegend,{dflt:!1})},P("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":365,"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scattergeo/attributes":969}],717:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../constants/numerical").BADNUM,P=c("../../components/colorscale/calc"),E=c("../scatter/arrays_to_calcdata"),e=c("../scatter/calc_selection");function p(g){return g&&typeof g=="string"}ae.exports=function(a,t){var i=t._length,n=new Array(i),r;t.geojson?r=function(M){return p(M)||b(M)}:r=p;for(var d=0;d<i;d++){var s=n[d]={},m=t.locations[d],x=t.z[d];r(m)&&b(x)?(s.loc=m,s.z=x):(s.loc=null,s.z=k),s.index=d}return E(n,t),P(a,t,{vals:t.z,containerStr:"",cLetter:"z"}),e(n,t),n}},{"../../components/colorscale/calc":374,"../../constants/numerical":479,"../scatter/arrays_to_calcdata":926,"../scatter/calc_selection":929,"fast-isnumeric":190}],718:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/colorscale/defaults"),P=c("./attributes");ae.exports=function(e,p,g,a){function t(x,M){return b.coerce(e,p,P,x,M)}var i=t("locations"),n=t("z");if(!(i&&i.length&&b.isArrayOrTypedArray(n)&&n.length)){p.visible=!1;return}p._length=Math.min(i.length,n.length);var r=t("geojson"),d;(typeof r=="string"&&r!==""||b.isPlainObject(r))&&(d="geojson-id");var s=t("locationmode",d);s==="geojson-id"&&t("featureidkey"),t("text"),t("hovertext"),t("hovertemplate");var m=t("marker.line.width");m&&t("marker.line.color"),t("marker.opacity"),k(e,p,a,t,{prefix:"",cLetter:"z"}),b.coerceSelectionMarkerOpacity(p,t)}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":716}],719:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e,p){k.location=P.location,k.z=P.z;var g=e[p];return g.fIn&&g.fIn.properties&&(k.properties=g.fIn.properties),k.ct=g.ct,k}},{}],720:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("./attributes"),P=c("../../lib").fillText;ae.exports=function(p,g,a){var t=p.cd,i=t[0].trace,n=p.subplot,r,d,s,m,x=[g,a],M=[g+360,a];for(d=0;d<t.length;d++)if(r=t[d],m=!1,r._polygons){for(s=0;s<r._polygons.length;s++)r._polygons[s].contains(x)&&(m=!m),r._polygons[s].contains(M)&&(m=!m);if(m)break}if(!(!m||!r))return p.x0=p.x1=p.xa.c2p(r.ct),p.y0=p.y1=p.ya.c2p(r.ct),p.index=r.index,p.location=r.loc,p.z=r.z,p.zLabel=b.tickText(n.mockAxis,n.mockAxis.c2l(r.z),"hover").text,p.hovertemplate=r.hovertemplate,E(p,i,r),[p]};function E(e,p,g){if(!p.hovertemplate){var a=g.hi||p.hoverinfo,t=String(g.loc),i=a==="all"?k.hoverinfo.flags:a.split("+"),n=i.indexOf("name")!==-1,r=i.indexOf("location")!==-1,d=i.indexOf("z")!==-1,s=i.indexOf("text")!==-1,m=!n&&r,x=[];m?e.nameOverride=t:(n&&(e.nameOverride=p.name),r&&x.push(t)),d&&x.push(e.zLabel),s&&P(g,p,x),e.extraText=x.join("<br>")}}},{"../../lib":503,"../../plots/cartesian/axes":554,"./attributes":716}],721:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../heatmap/colorbar"),calc:c("./calc"),calcGeoJSON:c("./plot").calcGeoJSON,plot:c("./plot").plot,style:c("./style").style,styleOnSelect:c("./style").styleOnSelect,hoverPoints:c("./hover"),eventData:c("./event_data"),selectPoints:c("./select"),moduleType:"trace",name:"choropleth",basePlotModule:c("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":589,"../heatmap/colorbar":795,"./attributes":716,"./calc":717,"./defaults":718,"./event_data":719,"./hover":720,"./plot":722,"./select":723,"./style":724}],722:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../lib/geo_location_utils"),E=c("../../lib/topojson_utils").getTopojsonFeatures,e=c("../../plots/cartesian/autorange").findExtremes,p=c("./style").style;function g(t,i,n){var r=i.layers.backplot.select(".choroplethlayer");k.makeTraceGroups(r,n,"trace choropleth").each(function(d){var s=b.select(this),m=s.selectAll("path.choroplethlocation").data(k.identity);m.enter().append("path").classed("choroplethlocation",!0),m.exit().remove(),p(t,d)})}function a(t,i){for(var n=t[0].trace,r=i[n.geo],d=r._subplot,s=n.locationmode,m=n._length,x=s==="geojson-id"?P.extractTraceFeature(t):E(n,d.topojson),M=[],v=[],_=0;_<m;_++){var l=t[_],y=s==="geojson-id"?l.fOut:P.locationToFeature(s,l.loc,x);if(y){l.geojson=y,l.ct=y.properties.ct,l._polygons=P.feature2polygons(y);var T=P.computeBbox(y);M.push(T[0],T[2]),v.push(T[1],T[3])}else l.geojson=null}if(r.fitbounds==="geojson"&&s==="geojson-id"){var w=P.computeBbox(P.getTraceGeojson(n));M=[w[0],w[2]],v=[w[1],w[3]]}var A={padded:!0};n._extremes.lon=e(r.lonaxis._ax,M,A),n._extremes.lat=e(r.lataxis._ax,v,A)}ae.exports={calcGeoJSON:a,plot:g}},{"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/topojson_utils":532,"../../plots/cartesian/autorange":553,"./style":724,"@plotly/d3":58}],723:[function(c,ae,ie){"use strict";ae.exports=function(k,P){var E=k.cd,e=k.xaxis,p=k.yaxis,g=[],a,t,i,n,r;if(P===!1)for(a=0;a<E.length;a++)E[a].selected=0;else for(a=0;a<E.length;a++)t=E[a],i=t.ct,i&&(n=e.c2p(i),r=p.c2p(i),P.contains([n,r],null,a,k)?(g.push({pointNumber:a,lon:i[0],lat:i[1]}),t.selected=1):t.selected=0);return g}},{}],724:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/color"),P=c("../../components/drawing"),E=c("../../components/colorscale");function e(a,t){t&&p(a,t)}function p(a,t){var i=t[0].trace,n=t[0].node3,r=n.selectAll(".choroplethlocation"),d=i.marker||{},s=d.line||{},m=E.makeColorScaleFuncFromTrace(i);r.each(function(x){b.select(this).attr("fill",m(x.z)).call(k.stroke,x.mlc||s.color).call(P.dashLine,"",x.mlw||s.width||0).style("opacity",d.opacity)}),P.selectedPointStyle(r,i,a)}function g(a,t){var i=t[0].node3,n=t[0].trace;n.selectedpoints?P.selectedPointStyle(i.selectAll(".choroplethlocation"),n,a):p(a,t)}ae.exports={style:e,styleOnSelect:g}},{"../../components/color":366,"../../components/colorscale":378,"../../components/drawing":388,"@plotly/d3":58}],725:[function(c,ae,ie){"use strict";var b=c("../choropleth/attributes"),k=c("../../components/colorscale/attributes"),P=c("../../plots/template_attributes").hovertemplateAttrs,E=c("../../plots/attributes"),e=c("../../lib/extend").extendFlat;ae.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},b.featureidkey,{}),below:{valType:"string",editType:"plot"},text:b.text,hovertext:b.hovertext,marker:{line:{color:e({},b.marker.line.color,{editType:"plot"}),width:e({},b.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},b.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},b.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},b.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:b.hoverinfo,hovertemplate:P({},{keys:["properties"]}),showlegend:e({},E.showlegend,{dflt:!1})},k("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../choropleth/attributes":716}],726:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../../components/colorscale"),E=c("../../components/drawing"),e=c("../../lib/geojson_utils").makeBlank,p=c("../../lib/geo_location_utils");function g(t){var i=t[0].trace,n=i.visible===!0&&i._length!==0,r={layout:{visibility:"none"},paint:{}},d={layout:{visibility:"none"},paint:{}},s=i._opts={fill:r,line:d,geojson:e()};if(!n)return s;var m=p.extractTraceFeature(t);if(!m)return s;var x=P.makeColorScaleFuncFromTrace(i),M=i.marker,v=M.line||{},_;k.isArrayOrTypedArray(M.opacity)&&(_=function(h){var o=h.mo;return b(o)?+k.constrain(o,0,1):0});var l;k.isArrayOrTypedArray(v.color)&&(l=function(h){return h.mlc});var y;k.isArrayOrTypedArray(v.width)&&(y=function(h){return h.mlw});for(var T=0;T<t.length;T++){var w=t[T],A=w.fOut;if(A){var f=A.properties;f.fc=x(w.z),_&&(f.mo=_(w)),l&&(f.mlc=l(w)),y&&(f.mlw=y(w)),w.ct=f.ct,w._polygons=p.feature2polygons(A)}}var u=_?{type:"identity",property:"mo"}:M.opacity;return k.extendFlat(r.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":u}),k.extendFlat(d.paint,{"line-color":l?{type:"identity",property:"mlc"}:v.color,"line-width":y?{type:"identity",property:"mlw"}:v.width,"line-opacity":u}),r.layout.visibility="visible",d.layout.visibility="visible",s.geojson={type:"FeatureCollection",features:m},a(t),s}function a(t){var i=t[0].trace,n=i._opts,r;if(i.selectedpoints){for(var d=E.makeSelectedPointStyleFns(i),s=0;s<t.length;s++){var m=t[s];m.fOut&&(m.fOut.properties.mo2=d.selectedOpacityFn(m))}r={type:"identity",property:"mo2"}}else r=k.isArrayOrTypedArray(i.marker.opacity)?{type:"identity",property:"mo"}:i.marker.opacity;return k.extendFlat(n.fill.paint,{"fill-opacity":r}),k.extendFlat(n.line.paint,{"line-opacity":r}),n}ae.exports={convert:g,convertOnSelect:a}},{"../../components/colorscale":378,"../../components/drawing":388,"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/geojson_utils":497,"fast-isnumeric":190}],727:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/colorscale/defaults"),P=c("./attributes");ae.exports=function(e,p,g,a){function t(s,m){return b.coerce(e,p,P,s,m)}var i=t("locations"),n=t("z"),r=t("geojson");if(!b.isArrayOrTypedArray(i)||!i.length||!b.isArrayOrTypedArray(n)||!n.length||!(typeof r=="string"&&r!==""||b.isPlainObject(r))){p.visible=!1;return}t("featureidkey"),p._length=Math.min(i.length,n.length),t("below"),t("text"),t("hovertext"),t("hovertemplate");var d=t("marker.line.width");d&&t("marker.line.color"),t("marker.opacity"),k(e,p,a,t,{prefix:"",cLetter:"z"}),b.coerceSelectionMarkerOpacity(p,t)}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":725}],728:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../heatmap/colorbar"),calc:c("../choropleth/calc"),plot:c("./plot"),hoverPoints:c("../choropleth/hover"),eventData:c("../choropleth/event_data"),selectPoints:c("../choropleth/select"),styleOnSelect:function(b,k){if(k){var P=k[0].trace;P._glTrace.updateOnSelect(k)}},getBelow:function(b,k){for(var P=k.getMapLayers(),E=P.length-2;E>=0;E--){var e=P[E].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var p=E+1;p<P.length;p++)if(e=P[p].id,typeof e=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:c("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":613,"../choropleth/calc":717,"../choropleth/event_data":719,"../choropleth/hover":720,"../choropleth/select":723,"../heatmap/colorbar":795,"./attributes":725,"./defaults":727,"./plot":729}],729:[function(c,ae,ie){"use strict";var b=c("./convert").convert,k=c("./convert").convertOnSelect,P=c("../../plots/mapbox/constants").traceLayerPrefix;function E(p,g){this.type="choroplethmapbox",this.subplot=p,this.uid=g,this.sourceId="source-"+g,this.layerList=[["fill",P+g+"-fill"],["line",P+g+"-line"]],this.below=null}var e=E.prototype;e.update=function(p){this._update(b(p))},e.updateOnSelect=function(p){this._update(k(p))},e._update=function(p){var g=this.subplot,a=this.layerList,t=g.belowLookup["trace-"+this.uid];g.map.getSource(this.sourceId).setData(p.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(p,t),this.below=t);for(var i=0;i<a.length;i++){var n=a[i],r=n[0],d=n[1],s=p[r];g.setOptions(d,"setLayoutProperty",s.layout),s.layout.visibility==="visible"&&g.setOptions(d,"setPaintProperty",s.paint)}},e._addLayers=function(p,g){for(var a=this.subplot,t=this.layerList,i=this.sourceId,n=0;n<t.length;n++){var r=t[n],d=r[0],s=p[d];a.addLayer({type:d,id:r[1],source:i,layout:s.layout,paint:s.paint},g)}},e._removeLayers=function(){for(var p=this.subplot.map,g=this.layerList,a=g.length-1;a>=0;a--)p.removeLayer(g[a][1])},e.dispose=function(){var p=this.subplot.map;this._removeLayers(),p.removeSource(this.sourceId)},ae.exports=function(g,a){var t=a[0].trace,i=new E(g,t.uid),n=i.sourceId,r=b(a),d=i.below=g.belowLookup["trace-"+t.uid];return g.map.addSource(n,{type:"geojson",data:r.geojson}),i._addLayers(r,d),a[0].trace._glTrace=i,i}},{"../../plots/mapbox/constants":611,"./convert":726}],730:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/attributes"),k=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,P=c("../../plots/template_attributes").hovertemplateAttrs,E=c("../mesh3d/attributes"),e=c("../../plots/attributes"),p=c("../../lib/extend").extendFlat,g={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:P({editType:"calc"},{keys:["norm"]}),uhoverformat:k("u",1),vhoverformat:k("v",1),whoverformat:k("w",1),xhoverformat:k("x"),yhoverformat:k("y"),zhoverformat:k("z"),showlegend:p({},e.showlegend,{dflt:!1})};p(g,b("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var a=["opacity","lightposition","lighting"];a.forEach(function(t){g[t]=E[t]}),g.hoverinfo=p({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),g.transforms=void 0,ae.exports=g},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../mesh3d/attributes":867}],731:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/calc");ae.exports=function(P,E){for(var e=E.u,p=E.v,g=E.w,a=Math.min(E.x.length,E.y.length,E.z.length,e.length,p.length,g.length),t=-1/0,i=1/0,n=0;n<a;n++){var r=e[n],d=p[n],s=g[n],m=Math.sqrt(r*r+d*d+s*s);t=Math.max(t,m),i=Math.min(i,m)}E._len=a,E._normMax=t,b(P,E,{vals:[i,t],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374}],732:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_cone3d,k=c("../../../stackgl_modules").gl_cone3d.createConeMesh,P=c("../../lib").simpleMap,E=c("../../lib/gl_format_color").parseColorScale,e=c("../../components/colorscale").extractOpts,p=c("../../plots/gl3d/zip3");function g(s,m){this.scene=s,this.uid=m,this.mesh=null,this.data=null}var a=g.prototype;a.handlePick=function(s){if(s.object===this.mesh){var m=s.index=s.data.index,x=this.data.x[m],M=this.data.y[m],v=this.data.z[m],_=this.data.u[m],l=this.data.v[m],y=this.data.w[m];s.traceCoordinate=[x,M,v,_,l,y,Math.sqrt(_*_+l*l+y*y)];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[m]!==void 0?s.textLabel=T[m]:T&&(s.textLabel=T),!0}};var t={xaxis:0,yaxis:1,zaxis:2},i={tip:1,tail:0,cm:.25,center:.5},n={tip:1,tail:1,cm:.75,center:.5};function r(s,m){var x=s.fullSceneLayout,M=s.dataScale,v={};function _(w,A){var f=x[A],u=M[t[A]];return P(w,function(h){return f.d2l(h)*u})}v.vectors=p(_(m.u,"xaxis"),_(m.v,"yaxis"),_(m.w,"zaxis"),m._len),v.positions=p(_(m.x,"xaxis"),_(m.y,"yaxis"),_(m.z,"zaxis"),m._len);var l=e(m);v.colormap=E(m),v.vertexIntensityBounds=[l.min/m._normMax,l.max/m._normMax],v.coneOffset=i[m.anchor],m.sizemode==="scaled"?v.coneSize=m.sizeref||.5:v.coneSize=m.sizeref&&m._normMax?m.sizeref/m._normMax:.5;var y=b(v),T=m.lightposition;return y.lightPosition=[T.x,T.y,T.z],y.ambient=m.lighting.ambient,y.diffuse=m.lighting.diffuse,y.specular=m.lighting.specular,y.roughness=m.lighting.roughness,y.fresnel=m.lighting.fresnel,y.opacity=m.opacity,m._pad=n[m.anchor]*y.vectorScale*y.coneScale*m._normMax,y}a.update=function(s){this.data=s;var m=r(this.scene,s);this.mesh.update(m)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function d(s,m){var x=s.glplot.gl,M=r(s,m),v=k(x,M),_=new g(s,m.uid);return _.mesh=v,_.data=m,v._trace=_,s.glplot.add(v),_}ae.exports=d},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib":503,"../../lib/gl_format_color":499,"../../plots/gl3d/zip3":609}],733:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/colorscale/defaults"),P=c("./attributes");ae.exports=function(e,p,g,a){function t(x,M){return b.coerce(e,p,P,x,M)}var i=t("u"),n=t("v"),r=t("w"),d=t("x"),s=t("y"),m=t("z");if(!i||!i.length||!n||!n.length||!r||!r.length||!d||!d.length||!s||!s.length||!m||!m.length){p.visible=!1;return}t("sizeref"),t("sizemode"),t("anchor"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),k(e,p,a,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),p._length=null}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":730}],734:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"cone",basePlotModule:c("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:c("./calc"),plot:c("./convert"),eventData:function(b,k){return b.norm=k.traceCoordinate[6],b},meta:{}}},{"../../plots/gl3d":598,"./attributes":730,"./calc":731,"./convert":732,"./defaults":733}],735:[function(c,ae,ie){"use strict";var b=c("../heatmap/attributes"),k=c("../scatter/attributes"),P=c("../../plots/cartesian/axis_format_attributes"),E=P.axisHoverFormat,e=P.descriptionOnlyNumbers,p=c("../../components/colorscale/attributes"),g=c("../../components/drawing/attributes").dash,a=c("../../plots/font_attributes"),t=c("../../lib/extend").extendFlat,i=c("../../constants/filter_ops"),n=i.COMPARISON_OPS2,r=i.INTERVAL_OPS,d=k.line;ae.exports=t({z:b.z,x:b.x,x0:b.x0,dx:b.dx,y:b.y,y0:b.y0,dy:b.dy,xperiod:b.xperiod,yperiod:b.yperiod,xperiod0:k.xperiod0,yperiod0:k.yperiod0,xperiodalignment:b.xperiodalignment,yperiodalignment:b.yperiodalignment,text:b.text,hovertext:b.hovertext,transpose:b.transpose,xtype:b.xtype,ytype:b.ytype,xhoverformat:E("x"),yhoverformat:E("y"),zhoverformat:E("z",1),hovertemplate:b.hovertemplate,texttemplate:t({},b.texttemplate,{}),textfont:t({},b.textfont,{}),hoverongaps:b.hoverongaps,connectgaps:t({},b.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:a({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(n).concat(r),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:t({},d.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:g,smoothing:t({},d.smoothing,{}),editType:"plot"}},p("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../constants/filter_ops":475,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../heatmap/attributes":792,"../scatter/attributes":927}],736:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale"),k=c("../heatmap/calc"),P=c("./set_contours"),E=c("./end_plus");ae.exports=function(p,g){var a=k(p,g),t=a[0].z;P(g,t);var i=g.contours,n=b.extractOpts(g),r;if(i.coloring==="heatmap"&&n.auto&&g.autocontour===!1){var d=i.start,s=E(i),m=i.size||1,x=Math.floor((s-d)/m)+1;isFinite(m)||(m=1,x=1);var M=d-m/2,v=M+x*m;r=[M,v]}else r=t;return b.calc(p,g,{vals:r,cLetter:"z"}),a}},{"../../components/colorscale":378,"../heatmap/calc":793,"./end_plus":746,"./set_contours":754}],737:[function(c,ae,ie){"use strict";ae.exports=function(b,k){var P=b[0],E=P.z,e;switch(k.type){case"levels":var p=Math.min(E[0][0],E[0][1]);for(e=0;e<b.length;e++){var g=b[e];g.prefixBoundary=!g.edgepaths.length&&(p>g.level||g.starts.length&&p===g.level)}break;case"constraint":if(P.prefixBoundary=!1,P.edgepaths.length)return;var a=P.x.length,t=P.y.length,i=-1/0,n=1/0;for(e=0;e<t;e++)n=Math.min(n,E[e][0]),n=Math.min(n,E[e][a-1]),i=Math.max(i,E[e][0]),i=Math.max(i,E[e][a-1]);for(e=1;e<a-1;e++)n=Math.min(n,E[0][e]),n=Math.min(n,E[t-1][e]),i=Math.max(i,E[0][e]),i=Math.max(i,E[t-1][e]);var r=k.value,d,s;switch(k._operation){case">":r>i&&(P.prefixBoundary=!0);break;case"<":(r<n||P.starts.length&&r===n)&&(P.prefixBoundary=!0);break;case"[]":d=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]),(s<n||d>i||P.starts.length&&s===n)&&(P.prefixBoundary=!0);break;case"][":d=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]),d<n&&s>i&&(P.prefixBoundary=!0);break}break}}},{}],738:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale"),k=c("./make_color_map"),P=c("./end_plus");function E(e,p,g){var a=p.contours,t=p.line,i=a.size||1,n=a.coloring,r=k(p,{isColorbar:!0});if(n==="heatmap"){var d=b.extractOpts(p);g._fillgradient=d.reversescale?b.flipScale(d.colorscale):d.colorscale,g._zrange=[d.min,d.max]}else n==="fill"&&(g._fillcolor=r);g._line={color:n==="lines"?r:t.color,width:a.showlines!==!1?t.width:0,dash:t.dash},g._levels={start:a.start,end:P(a),size:i}}ae.exports={min:"zmin",max:"zmax",calc:E}},{"../../components/colorscale":378,"./end_plus":746,"./make_color_map":751}],739:[function(c,ae,ie){"use strict";ae.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],740:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("./label_defaults"),P=c("../../components/color"),E=P.addOpacity,e=P.opacity,p=c("../../constants/filter_ops"),g=p.CONSTRAINT_REDUCTION,a=p.COMPARISON_OPS2;ae.exports=function(n,r,d,s,m,x){var M=r.contours,v,_,l,y=d("contours.operation");if(M._operation=g[y],t(d,M),y==="="?v=M.showlines=!0:(v=d("contours.showlines"),l=d("fillcolor",E((n.line||{}).color||m,.5))),v){var T=l&&e(l)?E(r.fillcolor,1):m;_=d("line.color",T),d("line.width",2),d("line.dash")}d("line.smoothing"),k(d,s,_,x)};function t(i,n){var r;a.indexOf(n.operation)===-1?(i("contours.value",[0,1]),Array.isArray(n.value)?n.value.length>2?n.value=n.value.slice(2):n.length===0?n.value=[0,1]:n.length<2?(r=parseFloat(n.value[0]),n.value=[r,r+1]):n.value=[parseFloat(n.value[0]),parseFloat(n.value[1])]:b(n.value)&&(r=parseFloat(n.value),n.value=[r,r+1])):(i("contours.value",0),b(n.value)||(Array.isArray(n.value)?n.value=parseFloat(n.value[0]):n.value=0))}},{"../../components/color":366,"../../constants/filter_ops":475,"./label_defaults":750,"fast-isnumeric":190}],741:[function(c,ae,ie){"use strict";var b=c("../../constants/filter_ops"),k=c("fast-isnumeric");ae.exports={"[]":E("[]"),"][":E("]["),">":e(">"),"<":e("<"),"=":e("=")};function P(p,g){var a=Array.isArray(g),t;function i(n){return k(n)?+n:null}return b.COMPARISON_OPS2.indexOf(p)!==-1?t=i(a?g[0]:g):b.INTERVAL_OPS.indexOf(p)!==-1?t=a?[i(g[0]),i(g[1])]:[i(g),i(g)]:b.SET_OPS.indexOf(p)!==-1&&(t=a?g.map(i):[i(g)]),t}function E(p){return function(g){g=P(p,g);var a=Math.min(g[0],g[1]),t=Math.max(g[0],g[1]);return{start:a,end:t,size:t-a}}}function e(p){return function(g){return g=P(p,g),{start:g,end:1/0,size:1/0}}}},{"../../constants/filter_ops":475,"fast-isnumeric":190}],742:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e){var p=e("contours.start"),g=e("contours.end"),a=p===!1||g===!1,t=E("contours.size"),i;a?i=P.autocontour=!0:i=E("autocontour",!1),(i||!t)&&E("ncontours")}},{}],743:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E){var e,p,g,a=function(n){return n.reverse()},t=function(n){return n};switch(E){case"=":case"<":return P;case">":for(P.length!==1&&b.warn("Contour data invalid for the specified inequality operation."),p=P[0],e=0;e<p.edgepaths.length;e++)p.edgepaths[e]=a(p.edgepaths[e]);for(e=0;e<p.paths.length;e++)p.paths[e]=a(p.paths[e]);for(e=0;e<p.starts.length;e++)p.starts[e]=a(p.starts[e]);return P;case"][":var i=a;a=t,t=i;case"[]":for(P.length!==2&&b.warn("Contour data invalid for the specified inequality range operation."),p=k(P[0]),g=k(P[1]),e=0;e<p.edgepaths.length;e++)p.edgepaths[e]=a(p.edgepaths[e]);for(e=0;e<p.paths.length;e++)p.paths[e]=a(p.paths[e]);for(e=0;e<p.starts.length;e++)p.starts[e]=a(p.starts[e]);for(;g.edgepaths.length;)p.edgepaths.push(t(g.edgepaths.shift()));for(;g.paths.length;)p.paths.push(t(g.paths.shift()));for(;g.starts.length;)p.starts.push(t(g.starts.shift()));return[p]}};function k(P){return b.extendFlat({},P,{edgepaths:b.extendDeep([],P.edgepaths),paths:b.extendDeep([],P.paths),starts:b.extendDeep([],P.starts)})}},{"../../lib":503}],744:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../heatmap/xyz_defaults"),P=c("../scatter/period_defaults"),E=c("./constraint_defaults"),e=c("./contours_defaults"),p=c("./style_defaults"),g=c("../heatmap/label_defaults"),a=c("./attributes");ae.exports=function(i,n,r,d){function s(v,_){return b.coerce(i,n,a,v,_)}function m(v){return b.coerce2(i,n,a,v)}var x=k(i,n,s,d);if(!x){n.visible=!1;return}P(i,n,d,s),s("xhoverformat"),s("yhoverformat"),s("text"),s("hovertext"),s("hoverongaps"),s("hovertemplate");var M=s("contours.type")==="constraint";s("connectgaps",b.isArray1D(n.z)),M?E(i,n,s,d,r):(e(i,n,s,m),p(i,n,s,d)),n.contours&&n.contours.coloring==="heatmap"&&g(s,d)}},{"../../lib":503,"../heatmap/label_defaults":802,"../heatmap/xyz_defaults":807,"../scatter/period_defaults":947,"./attributes":735,"./constraint_defaults":740,"./contours_defaults":742,"./style_defaults":756}],745:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./constraint_mapping"),P=c("./end_plus");ae.exports=function(e,p,g){for(var a=e.type==="constraint"?k[e._operation](e.value):e,t=a.size,i=[],n=P(a),r=g.trace._carpetTrace,d=r?{xaxis:r.aaxis,yaxis:r.baxis,x:g.a,y:g.b}:{xaxis:p.xaxis,yaxis:p.yaxis,x:g.x,y:g.y},s=a.start;s<n;s+=t)if(i.push(b.extendFlat({level:s,crossings:{},starts:[],edgepaths:[],paths:[],z:g.z,smoothing:g.trace.line.smoothing},d)),i.length>1e3){b.warn("Too many contours, clipping at 1000",e);break}return i}},{"../../lib":503,"./constraint_mapping":741,"./end_plus":746}],746:[function(c,ae,ie){"use strict";ae.exports=function(k){return k.end+k.size/1e6}},{}],747:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./constants");ae.exports=function(t,i,n){var r,d,s,m,x;for(i=i||.01,n=n||.01,s=0;s<t.length;s++){for(m=t[s],x=0;x<m.starts.length;x++)d=m.starts[x],e(m,d,"edge",i,n);for(r=0;Object.keys(m.crossings).length&&r<1e4;)r++,d=Object.keys(m.crossings)[0].split(",").map(Number),e(m,d,void 0,i,n);r===1e4&&b.log("Infinite loop in contour?")}};function P(a,t,i,n){return Math.abs(a[0]-t[0])<i&&Math.abs(a[1]-t[1])<n}function E(a,t){var i=a[2]-t[2],n=a[3]-t[3];return Math.sqrt(i*i+n*n)}function e(a,t,i,n,r){var d=t.join(","),s=a.crossings[d],m=p(s,i,t),x=[g(a,t,[-m[0],-m[1]])],M=a.z.length,v=a.z[0].length,_=t.slice(),l=m.slice(),y;for(y=0;y<1e4;y++){if(s>20?(s=k.CHOOSESADDLE[s][(m[0]||m[1])<0?0:1],a.crossings[d]=k.SADDLEREMAINDER[s]):delete a.crossings[d],m=k.NEWDELTA[s],!m){b.log("Found bad marching index:",s,t,a.level);break}x.push(g(a,t,m)),t[0]+=m[0],t[1]+=m[1],d=t.join(","),P(x[x.length-1],x[x.length-2],n,r)&&x.pop();var T=m[0]&&(t[0]<0||t[0]>v-2)||m[1]&&(t[1]<0||t[1]>M-2),w=t[0]===_[0]&&t[1]===_[1]&&m[0]===l[0]&&m[1]===l[1];if(w||i&&T)break;s=a.crossings[d]}y===1e4&&b.log("Infinite loop in contour?");var A=P(x[0],x[x.length-1],n,r),f=0,u=.2*a.smoothing,h=[],o=0,S,R,z,O,I,F,D,B,U,X,oe;for(y=1;y<x.length;y++)D=E(x[y],x[y-1]),f+=D,h.push(D);var se=f/h.length*u;function q(Q){return x[Q%x.length]}for(y=x.length-2;y>=o;y--)if(S=h[y],S<se){for(z=0,R=y-1;R>=o&&S+h[R]<se;R--)S+=h[R];if(A&&y===x.length-2)for(z=0;z<R&&S+h[z]<se;z++)S+=h[z];I=y-R+z+1,F=Math.floor((y+R+z+2)/2),!A&&y===x.length-2?O=x[x.length-1]:!A&&R===-1?O=x[0]:I%2?O=q(F):O=[(q(F)[0]+q(F+1)[0])/2,(q(F)[1]+q(F+1)[1])/2],x.splice(R+1,y-R+1,O),y=R+1,z&&(o=z),A&&(y===x.length-2?x[z]=x[x.length-1]:y===0&&(x[x.length-1]=x[0]))}for(x.splice(0,o),y=0;y<x.length;y++)x[y].length=2;if(!(x.length<2))if(A)x.pop(),a.paths.push(x);else{i||b.log("Unclosed interior contour?",a.level,_.join(","),x.join("L"));var K=!1;for(B=0;B<a.edgepaths.length;B++)if(X=a.edgepaths[B],!K&&P(X[0],x[x.length-1],n,r)){x.pop(),K=!0;var G=!1;for(U=0;U<a.edgepaths.length;U++)if(oe=a.edgepaths[U],P(oe[oe.length-1],x[0],n,r)){G=!0,x.shift(),a.edgepaths.splice(B,1),U===B?a.paths.push(x.concat(oe)):(U>B&&U--,a.edgepaths[U]=oe.concat(x,X));break}G||(a.edgepaths[B]=x.concat(X))}for(B=0;B<a.edgepaths.length&&!K;B++)X=a.edgepaths[B],P(X[X.length-1],x[0],n,r)&&(x.shift(),a.edgepaths[B]=X.concat(x),K=!0);K||a.edgepaths.push(x)}}function p(a,t,i){var n=0,r=0;return a>20&&t?a===208||a===1114?n=i[0]===0?1:-1:r=i[1]===0?1:-1:k.BOTTOMSTART.indexOf(a)!==-1?r=1:k.LEFTSTART.indexOf(a)!==-1?n=1:k.TOPSTART.indexOf(a)!==-1?r=-1:n=-1,[n,r]}function g(a,t,i){var n=t[0]+Math.max(i[0],0),r=t[1]+Math.max(i[1],0),d=a.z[r][n],s=a.xaxis,m=a.yaxis;if(i[1]){var x=(a.level-d)/(a.z[r][n+1]-d),M=(x!==1?(1-x)*s.c2l(a.x[n]):0)+(x!==0?x*s.c2l(a.x[n+1]):0);return[s.c2p(s.l2c(M),!0),m.c2p(a.y[r],!0),n+x,r]}else{var v=(a.level-d)/(a.z[r+1][n]-d),_=(v!==1?(1-v)*m.c2l(a.y[r]):0)+(v!==0?v*m.c2l(a.y[r+1]):0);return[s.c2p(a.x[n],!0),m.c2p(m.l2c(_),!0),n,r+v]}}},{"../../lib":503,"./constants":739}],748:[function(c,ae,ie){"use strict";var b=c("../../components/color"),k=c("../heatmap/hover");ae.exports=function(E,e,p,g,a){a||(a={}),a.isContour=!0;var t=k(E,e,p,g,a);return t&&t.forEach(function(i){var n=i.trace;n.contours.type==="constraint"&&(n.fillcolor&&b.opacity(n.fillcolor)?i.color=b.addOpacity(n.fillcolor,1):n.contours.showlines&&b.opacity(n.line.color)&&(i.color=b.addOpacity(n.line.color,1)))}),t}},{"../../components/color":366,"../heatmap/hover":799}],749:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("./calc"),plot:c("./plot").plot,style:c("./style"),colorbar:c("./colorbar"),hoverPoints:c("./hover"),moduleType:"trace",name:"contour",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":568,"./attributes":735,"./calc":736,"./colorbar":738,"./defaults":744,"./hover":748,"./plot":753,"./style":755}],750:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E,e,p){p||(p={});var g=P("contours.showlabels");if(g){var a=E.font;b.coerceFont(P,"contours.labelfont",{family:a.family,size:a.size,color:e}),P("contours.labelformat")}p.hasHover!==!1&&P("zhoverformat")}},{"../../lib":503}],751:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/colorscale"),P=c("./end_plus");ae.exports=function(e){var p=e.contours,g=p.start,a=P(p),t=p.size||1,i=Math.floor((a-g)/t)+1,n=p.coloring==="lines"?0:1,r=k.extractOpts(e);isFinite(t)||(t=1,i=1);var d=r.reversescale?k.flipScale(r.colorscale):r.colorscale,s=d.length,m=new Array(s),x=new Array(s),M,v;if(p.coloring==="heatmap"){var _=r.min,l=r.max;for(v=0;v<s;v++)M=d[v],m[v]=M[0]*(l-_)+_,x[v]=M[1];var y=b.extent([_,l,p.start,p.start+t*(i-1)]),T=y[_<l?0:1],w=y[_<l?1:0];T!==_&&(m.splice(0,0,T),x.splice(0,0,x[0])),w!==l&&(m.push(w),x.push(x[x.length-1]))}else for(v=0;v<s;v++)M=d[v],m[v]=(M[0]*(i+n-1)-n/2)*t+g,x[v]=M[1];return k.makeColorScaleFunc({domain:m,range:x},{noNumericCheck:!0})}},{"../../components/colorscale":378,"./end_plus":746,"@plotly/d3":58}],752:[function(c,ae,ie){"use strict";var b=c("./constants");ae.exports=function(E){var e=E[0].z,p=e.length,g=e[0].length,a=p===2||g===2,t,i,n,r,d,s,m,x,M;for(i=0;i<p-1;i++)for(r=[],i===0&&(r=r.concat(b.BOTTOMSTART)),i===p-2&&(r=r.concat(b.TOPSTART)),t=0;t<g-1;t++)for(n=r.slice(),t===0&&(n=n.concat(b.LEFTSTART)),t===g-2&&(n=n.concat(b.RIGHTSTART)),d=t+","+i,s=[[e[i][t],e[i][t+1]],[e[i+1][t],e[i+1][t+1]]],M=0;M<E.length;M++)x=E[M],m=k(x.level,s),m&&(x.crossings[d]=m,n.indexOf(m)!==-1&&(x.starts.push([t,i]),a&&n.indexOf(m,n.indexOf(m)+1)!==-1&&x.starts.push([t,i])))};function k(P,E){var e=(E[0][0]>P?0:1)+(E[0][1]>P?0:2)+(E[1][1]>P?0:4)+(E[1][0]>P?0:8);if(e===5||e===10){var p=(E[0][0]+E[0][1]+E[1][0]+E[1][1])/4;return P>p?e===5?713:1114:e===5?104:208}return e===15?0:e}},{"./constants":739}],753:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../components/drawing"),E=c("../../components/colorscale"),e=c("../../lib/svg_text_utils"),p=c("../../plots/cartesian/axes"),g=c("../../plots/cartesian/set_convert"),a=c("../heatmap/plot"),t=c("./make_crossings"),i=c("./find_all_paths"),n=c("./empty_pathinfo"),r=c("./convert_to_constraints"),d=c("./close_boundaries"),s=c("./constants"),m=s.LABELOPTIMIZER;ie.plot=function(A,f,u,h){var o=f.xaxis,S=f.yaxis;k.makeTraceGroups(h,u,"contour").each(function(R){var z=b.select(this),O=R[0],I=O.trace,F=O.x,D=O.y,B=I.contours,U=n(B,f,O),X=k.ensureSingle(z,"g","heatmapcoloring"),oe=[];B.coloring==="heatmap"&&(oe=[R]),a(A,f,oe,X),t(U),i(U);var se=o.c2p(F[0],!0),q=o.c2p(F[F.length-1],!0),K=S.c2p(D[0],!0),G=S.c2p(D[D.length-1],!0),Q=[[se,G],[q,G],[q,K],[se,K]],V=U;B.type==="constraint"&&(V=r(U,B._operation)),x(z,Q,B),M(z,V,Q,B),_(z,U,A,O,B),y(z,f,A,O,Q)})};function x(w,A,f){var u=k.ensureSingle(w,"g","contourbg"),h=u.selectAll("path").data(f.coloring==="fill"?[0]:[]);h.enter().append("path"),h.exit().remove(),h.attr("d","M"+A.join("L")+"Z").style("stroke","none")}function M(w,A,f,u){var h=u.coloring==="fill"||u.type==="constraint"&&u._operation!=="=",o="M"+f.join("L")+"Z";h&&d(A,u);var S=k.ensureSingle(w,"g","contourfill"),R=S.selectAll("path").data(h?A:[]);R.enter().append("path"),R.exit().remove(),R.each(function(z){var O=(z.prefixBoundary?o:"")+v(z,f);O?b.select(this).attr("d",O).style("stroke","none"):b.select(this).remove()})}function v(w,A){var f="",u=0,h=w.edgepaths.map(function(se,q){return q}),o=!0,S,R,z,O,I,F;function D(se){return Math.abs(se[1]-A[0][1])<.01}function B(se){return Math.abs(se[1]-A[2][1])<.01}function U(se){return Math.abs(se[0]-A[0][0])<.01}function X(se){return Math.abs(se[0]-A[2][0])<.01}for(;h.length;){for(F=P.smoothopen(w.edgepaths[u],w.smoothing),f+=o?F:F.replace(/^M/,"L"),h.splice(h.indexOf(u),1),S=w.edgepaths[u][w.edgepaths[u].length-1],O=-1,z=0;z<4;z++){if(!S){k.log("Missing end?",u,w);break}for(D(S)&&!X(S)?R=A[1]:U(S)?R=A[0]:B(S)?R=A[3]:X(S)&&(R=A[2]),I=0;I<w.edgepaths.length;I++){var oe=w.edgepaths[I][0];Math.abs(S[0]-R[0])<.01?Math.abs(S[0]-oe[0])<.01&&(oe[1]-S[1])*(R[1]-oe[1])>=0&&(R=oe,O=I):Math.abs(S[1]-R[1])<.01?Math.abs(S[1]-oe[1])<.01&&(oe[0]-S[0])*(R[0]-oe[0])>=0&&(R=oe,O=I):k.log("endpt to newendpt is not vert. or horz.",S,R,oe)}if(S=R,O>=0)break;f+="L"+R}if(O===w.edgepaths.length){k.log("unclosed perimeter path");break}u=O,o=h.indexOf(u)===-1,o&&(u=h[0],f+="Z")}for(u=0;u<w.paths.length;u++)f+=P.smoothclosed(w.paths[u],w.smoothing);return f}function _(w,A,f,u,h){var o=k.ensureSingle(w,"g","contourlines"),S=h.showlines!==!1,R=h.showlabels,z=S&&R,O=ie.createLines(o,S||R,A),I=ie.createLineClip(o,z,f,u.trace.uid),F=w.selectAll("g.contourlabels").data(R?[0]:[]);if(F.exit().remove(),F.enter().append("g").classed("contourlabels",!0),R){var D=[],B=[];k.clearLocationCache();var U=ie.labelFormatter(f,u),X=P.tester.append("text").attr("data-notex",1).call(P.font,h.labelfont),oe=A[0].xaxis,se=A[0].yaxis,q=oe._length,K=se._length,G=oe.range,Q=se.range,V=k.aggNums(Math.min,null,u.x),H=k.aggNums(Math.max,null,u.x),ee=k.aggNums(Math.min,null,u.y),J=k.aggNums(Math.max,null,u.y),W=Math.max(oe.c2p(V,!0),0),re=Math.min(oe.c2p(H,!0),q),j=Math.max(se.c2p(J,!0),0),Z=Math.min(se.c2p(ee,!0),K),ne={};G[0]<G[1]?(ne.left=W,ne.right=re):(ne.left=re,ne.right=W),Q[0]<Q[1]?(ne.top=j,ne.bottom=Z):(ne.top=Z,ne.bottom=j),ne.middle=(ne.top+ne.bottom)/2,ne.center=(ne.left+ne.right)/2,D.push([[ne.left,ne.top],[ne.right,ne.top],[ne.right,ne.bottom],[ne.left,ne.bottom]]);var le=Math.sqrt(q*q+K*K),ge=s.LABELDISTANCE*le/Math.max(1,A.length/s.LABELINCREASE);O.each(function(pe){var xe=ie.calcTextOpts(pe.level,U,X,f);b.select(this).selectAll("path").each(function(){var Ee=this,Te=k.getVisibleSegment(Ee,ne,xe.height/2);if(!!Te&&!(Te.len<(xe.width+xe.height)*s.LABELMIN))for(var de=Math.min(Math.ceil(Te.len/ge),s.LABELMAX),be=0;be<de;be++){var Le=ie.findBestTextLocation(Ee,Te,xe,B,ne);if(!Le)break;ie.addLabelData(Le,xe,B,D)}})}),X.remove(),ie.drawLabels(F,B,f,I,z?D:null)}R&&!S&&O.remove()}ie.createLines=function(w,A,f){var u=f[0].smoothing,h=w.selectAll("g.contourlevel").data(A?f:[]);if(h.exit().remove(),h.enter().append("g").classed("contourlevel",!0),A){var o=h.selectAll("path.openline").data(function(R){return R.pedgepaths||R.edgepaths});o.exit().remove(),o.enter().append("path").classed("openline",!0),o.attr("d",function(R){return P.smoothopen(R,u)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var S=h.selectAll("path.closedline").data(function(R){return R.ppaths||R.paths});S.exit().remove(),S.enter().append("path").classed("closedline",!0),S.attr("d",function(R){return P.smoothclosed(R,u)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return h},ie.createLineClip=function(w,A,f,u){var h=f._fullLayout._clips,o=A?"clipline"+u:null,S=h.selectAll("#"+o).data(A?[0]:[]);return S.exit().remove(),S.enter().append("clipPath").classed("contourlineclip",!0).attr("id",o),P.setClipUrl(w,o,f),S},ie.labelFormatter=function(w,A){var f=w._fullLayout,u=A.trace,h=u.contours,o={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(h.labelformat)o.tickformat=h.labelformat,g(o,f);else{var S=E.extractOpts(u);if(S&&S.colorbar&&S.colorbar._axis)o=S.colorbar._axis;else{if(h.type==="constraint"){var R=h.value;Array.isArray(R)?o.range=[R[0],R[R.length-1]]:o.range=[R,R]}else o.range=[h.start,h.end],o.nticks=(h.end-h.start)/h.size;o.range[0]===o.range[1]&&(o.range[1]+=o.range[0]||1),o.nticks||(o.nticks=1e3),g(o,f),p.prepTicks(o),o._tmin=null,o._tmax=null}}return function(z){return p.tickText(o,z).text}},ie.calcTextOpts=function(w,A,f,u){var h=A(w);f.text(h).call(e.convertToTspans,u);var o=f.node(),S=P.bBox(o,!0);return{text:h,width:S.width,height:S.height,fontSize:+o.style["font-size"].replace("px",""),level:w,dy:(S.top+S.bottom)/2}},ie.findBestTextLocation=function(w,A,f,u,h){var o=f.width,S,R,z,O,I;A.isClosed?(R=A.len/m.INITIALSEARCHPOINTS,S=A.min+R/2,z=A.max):(R=(A.len-o)/(m.INITIALSEARCHPOINTS+1),S=A.min+R+o/2,z=A.max-(R+o)/2);for(var F=1/0,D=0;D<m.ITERATIONS;D++){for(var B=S;B<z;B+=R){var U=k.getTextLocation(w,A.total,B,o),X=l(U,f,u,h);X<F&&(F=X,I=U,O=B)}if(F>m.MAXCOST*2)break;D&&(R/=2),S=O-R/2,z=S+R*1.5}if(F<=m.MAXCOST)return I};function l(w,A,f,u){var h=A.width/2,o=A.height/2,S=w.x,R=w.y,z=w.theta,O=Math.cos(z)*h,I=Math.sin(z)*h,F=(S>u.center?u.right-S:S-u.left)/(O+Math.abs(Math.sin(z)*o)),D=(R>u.middle?u.bottom-R:R-u.top)/(Math.abs(I)+Math.cos(z)*o);if(F<1||D<1)return 1/0;var B=m.EDGECOST*(1/(F-1)+1/(D-1));B+=m.ANGLECOST*z*z;for(var U=S-O,X=R-I,oe=S+O,se=R+I,q=0;q<f.length;q++){var K=f[q],G=Math.cos(K.theta)*K.width/2,Q=Math.sin(K.theta)*K.width/2,V=k.segmentDistance(U,X,oe,se,K.x-G,K.y-Q,K.x+G,K.y+Q)*2/(A.height+K.height),H=K.level===A.level,ee=H?m.SAMELEVELDISTANCE:1;if(V<=ee)return 1/0;var J=m.NEIGHBORCOST*(H?m.SAMELEVELFACTOR:1);B+=J/(V-ee)}return B}ie.addLabelData=function(w,A,f,u){var h=A.fontSize,o=A.width+h/3,S=Math.max(0,A.height-h/3),R=w.x,z=w.y,O=w.theta,I=Math.sin(O),F=Math.cos(O),D=function(U,X){return[R+U*F-X*I,z+U*I+X*F]},B=[D(-o/2,-S/2),D(-o/2,S/2),D(o/2,S/2),D(o/2,-S/2)];f.push({text:A.text,x:R,y:z,dy:A.dy,theta:O,level:A.level,width:o,height:S}),u.push(B)},ie.drawLabels=function(w,A,f,u,h){var o=w.selectAll("text").data(A,function(O){return O.text+","+O.x+","+O.y+","+O.theta});if(o.exit().remove(),o.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(O){var I=O.x+Math.sin(O.theta)*O.dy,F=O.y-Math.cos(O.theta)*O.dy;b.select(this).text(O.text).attr({x:I,y:F,transform:"rotate("+180*O.theta/Math.PI+" "+I+" "+F+")"}).call(e.convertToTspans,f)}),h){for(var S="",R=0;R<h.length;R++)S+="M"+h[R].join("L")+"Z";var z=k.ensureSingle(u,"path","");z.attr("d",S)}};function y(w,A,f,u,h){var o=u.trace,S=f._fullLayout._clips,R="clip"+o.uid,z=S.selectAll("#"+R).data(o.connectgaps?[]:[0]);if(z.enter().append("clipPath").classed("contourclip",!0).attr("id",R),z.exit().remove(),o.connectgaps===!1){var O={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:A.xaxis,yaxis:A.yaxis,x:u.x,y:u.y,z:T(u),smoothing:0};t([O]),i([O]),d([O],{type:"levels"});var I=k.ensureSingle(z,"path","");I.attr("d",(O.prefixBoundary?"M"+h.join("L")+"Z":"")+v(O,h))}else R=null;P.setClipUrl(w,R,f)}function T(w){var A=w.trace._emptypoints,f=[],u=w.z.length,h=w.z[0].length,o,S=[],R;for(o=0;o<h;o++)S.push(1);for(o=0;o<u;o++)f.push(S.slice());for(o=0;o<A.length;o++)R=A[o],f[R[0]][R[1]]=0;return w.zmask=f,f}},{"../../components/colorscale":378,"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../plots/cartesian/set_convert":576,"../heatmap/plot":804,"./close_boundaries":737,"./constants":739,"./convert_to_constraints":743,"./empty_pathinfo":745,"./find_all_paths":747,"./make_crossings":752,"@plotly/d3":58}],754:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../lib");ae.exports=function(e,p){var g=e.contours;if(e.autocontour){var a=e.zmin,t=e.zmax;(e.zauto||a===void 0)&&(a=k.aggNums(Math.min,null,p)),(e.zauto||t===void 0)&&(t=k.aggNums(Math.max,null,p));var i=P(a,t,e.ncontours);g.size=i.dtick,g.start=b.tickFirst(i),i.range.reverse(),g.end=b.tickFirst(i),g.start===a&&(g.start+=g.size),g.end===t&&(g.end-=g.size),g.start>g.end&&(g.start=g.end=(g.start+g.end)/2),e._input.contours||(e._input.contours={}),k.extendFlat(e._input.contours,{start:g.start,end:g.end,size:g.size}),e._input.autocontour=!0}else if(g.type!=="constraint"){var n=g.start,r=g.end,d=e._input.contours;if(n>r&&(g.start=d.start=r,r=g.end=d.end=n,n=g.start),!(g.size>0)){var s;n===r?s=1:s=P(n,r,e.ncontours).dtick,d.size=g.size=s}}};function P(E,e,p){var g={type:"linear",range:[E,e]};return b.autoTicks(g,(e-E)/(p||15)),g}},{"../../lib":503,"../../plots/cartesian/axes":554}],755:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/drawing"),P=c("../heatmap/style"),E=c("./make_color_map");ae.exports=function(p){var g=b.select(p).selectAll("g.contour");g.style("opacity",function(a){return a[0].trace.opacity}),g.each(function(a){var t=b.select(this),i=a[0].trace,n=i.contours,r=i.line,d=n.size||1,s=n.start,m=n.type==="constraint",x=!m&&n.coloring==="lines",M=!m&&n.coloring==="fill",v=x||M?E(i):null;t.selectAll("g.contourlevel").each(function(y){b.select(this).selectAll("path").call(k.lineGroupStyle,r.width,x?v(y.level):r.color,r.dash)});var _=n.labelfont;if(t.selectAll("g.contourlabels text").each(function(y){k.font(b.select(this),{family:_.family,size:_.size,color:_.color||(x?v(y.level):r.color)})}),m)t.selectAll("g.contourfill path").style("fill",i.fillcolor);else if(M){var l;t.selectAll("g.contourfill path").style("fill",function(y){return l===void 0&&(l=y.level),v(y.level+.5*d)}),l===void 0&&(l=s),t.selectAll("g.contourbg path").style("fill",v(l-.5*d))}}),P(p)}},{"../../components/drawing":388,"../heatmap/style":805,"./make_color_map":751,"@plotly/d3":58}],756:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/defaults"),k=c("./label_defaults");ae.exports=function(E,e,p,g,a){var t=p("contours.coloring"),i,n="";t==="fill"&&(i=p("contours.showlines")),i!==!1&&(t!=="lines"&&(n=p("line.color","#000")),p("line.width",.5),p("line.dash")),t!=="none"&&(E.showlegend!==!0&&(e.showlegend=!1),e._dfltShowLegend=!1,b(E,e,g,p,{prefix:"",cLetter:"z"})),p("line.smoothing"),k(p,g,n,a)}},{"../../components/colorscale/defaults":376,"./label_defaults":750}],757:[function(c,ae,ie){"use strict";var b=c("../heatmap/attributes"),k=c("../contour/attributes"),P=c("../../components/colorscale/attributes"),E=c("../../lib/extend").extendFlat,e=k.contours;ae.exports=E({carpet:{valType:"string",editType:"calc"},z:b.z,a:b.x,a0:b.x0,da:b.dx,b:b.y,b0:b.y0,db:b.dy,text:b.text,hovertext:b.hovertext,transpose:b.transpose,atype:b.xtype,btype:b.ytype,fillcolor:k.fillcolor,autocontour:k.autocontour,ncontours:k.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:k.line.color,width:k.line.width,dash:k.line.dash,smoothing:k.line.smoothing,editType:"plot"},transforms:void 0},P("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../contour/attributes":735,"../heatmap/attributes":792}],758:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/calc"),k=c("../../lib"),P=c("../heatmap/convert_column_xyz"),E=c("../heatmap/clean_2d_array"),e=c("../heatmap/interp2d"),p=c("../heatmap/find_empties"),g=c("../heatmap/make_bound_array"),a=c("./defaults"),t=c("../carpet/lookup_carpetid"),i=c("../contour/set_contours");ae.exports=function(d,s){var m=s._carpetTrace=t(d,s);if(!(!m||!m.visible||m.visible==="legendonly")){if(!s.a||!s.b){var x=d.data[m.index],M=d.data[s.index];M.a||(M.a=x.a),M.b||(M.b=x.b),a(M,s,s._defaultColor,d._fullLayout)}var v=n(d,s);return i(s,s._z),v}};function n(r,d){var s=d._carpetTrace,m=s.aaxis,x=s.baxis,M,v,_,l,y,T,w;m._minDtick=0,x._minDtick=0,k.isArray1D(d.z)&&P(d,m,x,"a","b",["z"]),M=d._a=d._a||d.a,l=d._b=d._b||d.b,M=M?m.makeCalcdata(d,"_a"):[],l=l?x.makeCalcdata(d,"_b"):[],v=d.a0||0,_=d.da||1,y=d.b0||0,T=d.db||1,w=d._z=E(d._z||d.z,d.transpose),d._emptypoints=p(w),e(w,d._emptypoints);var A=k.maxRowLength(w),f=d.xtype==="scaled"?"":M,u=g(d,f,v,_,A,m),h=d.ytype==="scaled"?"":l,o=g(d,h,y,T,w.length,x),S={a:u,b:o,z:w};return d.contours.type==="levels"&&d.contours.coloring!=="none"&&b(r,d,{vals:w,containerStr:"",cLetter:"z"}),[S]}},{"../../components/colorscale/calc":374,"../../lib":503,"../carpet/lookup_carpetid":708,"../contour/set_contours":754,"../heatmap/clean_2d_array":794,"../heatmap/convert_column_xyz":796,"../heatmap/find_empties":798,"../heatmap/interp2d":801,"../heatmap/make_bound_array":803,"./defaults":759}],759:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../heatmap/xyz_defaults"),P=c("./attributes"),E=c("../contour/constraint_defaults"),e=c("../contour/contours_defaults"),p=c("../contour/style_defaults");ae.exports=function(a,t,i,n){function r(x,M){return b.coerce(a,t,P,x,M)}function d(x){return b.coerce2(a,t,P,x)}if(r("carpet"),a.a&&a.b){var s=k(a,t,r,n,"a","b");if(!s){t.visible=!1;return}r("text");var m=r("contours.type")==="constraint";m?E(a,t,r,n,i,{hasHover:!1}):(e(a,t,r,d),p(a,t,r,n,{hasHover:!1}))}else t._defaultColor=i,t._length=null}},{"../../lib":503,"../contour/constraint_defaults":740,"../contour/contours_defaults":742,"../contour/style_defaults":756,"../heatmap/xyz_defaults":807,"./attributes":757}],760:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../contour/colorbar"),calc:c("./calc"),plot:c("./plot"),style:c("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":568,"../contour/colorbar":738,"../contour/style":755,"./attributes":757,"./calc":758,"./defaults":759,"./plot":761}],761:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../carpet/map_1d_array"),P=c("../carpet/makepath"),E=c("../../components/drawing"),e=c("../../lib"),p=c("../contour/make_crossings"),g=c("../contour/find_all_paths"),a=c("../contour/plot"),t=c("../contour/constants"),i=c("../contour/convert_to_constraints"),n=c("../contour/empty_pathinfo"),r=c("../contour/close_boundaries"),d=c("../carpet/lookup_carpetid"),s=c("../carpet/axis_aligned_line");ae.exports=function(f,u,h,o){var S=u.xaxis,R=u.yaxis;e.makeTraceGroups(o,h,"contour").each(function(z){var O=b.select(this),I=z[0],F=I.trace,D=F._carpetTrace=d(f,F),B=f.calcdata[D.index][0];if(!D.visible||D.visible==="legendonly")return;var U=I.a,X=I.b,oe=F.contours,se=n(oe,u,I),q=oe.type==="constraint",K=oe._operation,G=q?K==="="?"lines":"fill":oe.coloring;function Q(ge){var pe=D.ab2xy(ge[0],ge[1],!0);return[S.c2p(pe[0]),R.c2p(pe[1])]}var V=[[U[0],X[X.length-1]],[U[U.length-1],X[X.length-1]],[U[U.length-1],X[0]],[U[0],X[0]]];p(se);var H=(U[U.length-1]-U[0])*1e-8,ee=(X[X.length-1]-X[0])*1e-8;g(se,H,ee);var J=se;oe.type==="constraint"&&(J=i(se,K)),m(se,Q);var W,re,j,Z,ne=[];for(Z=B.clipsegments.length-1;Z>=0;Z--)W=B.clipsegments[Z],re=k([],W.x,S.c2p),j=k([],W.y,R.c2p),re.reverse(),j.reverse(),ne.push(P(re,j,W.bicubic));var le="M"+ne.join("L")+"Z";y(O,B.clipsegments,S,R,q,G),T(F,O,S,R,J,V,Q,D,B,G,le),x(O,se,f,I,oe,u,D),E.setClipUrl(O,D._clipPathId,f)})};function m(A,f){var u,h,o,S,R,z,O,I,F;for(u=0;u<A.length;u++){for(S=A[u],R=S.pedgepaths=[],z=S.ppaths=[],h=0;h<S.edgepaths.length;h++){for(F=S.edgepaths[h],O=[],o=0;o<F.length;o++)O[o]=f(F[o]);R.push(O)}for(h=0;h<S.paths.length;h++){for(F=S.paths[h],I=[],o=0;o<F.length;o++)I[o]=f(F[o]);z.push(I)}}}function x(A,f,u,h,o,S,R){var z=e.ensureSingle(A,"g","contourlines"),O=o.showlines!==!1,I=o.showlabels,F=O&&I,D=a.createLines(z,O||I,f),B=a.createLineClip(z,F,u,h.trace.uid),U=A.selectAll("g.contourlabels").data(I?[0]:[]);if(U.exit().remove(),U.enter().append("g").classed("contourlabels",!0),I){var X=S.xaxis,oe=S.yaxis,se=X._length,q=oe._length,K=[[[0,0],[se,0],[se,q],[0,q]]],G=[];e.clearLocationCache();var Q=a.labelFormatter(u,h),V=E.tester.append("text").attr("data-notex",1).call(E.font,o.labelfont),H={left:0,right:se,center:se/2,top:0,bottom:q,middle:q/2},ee=Math.sqrt(se*se+q*q),J=t.LABELDISTANCE*ee/Math.max(1,f.length/t.LABELINCREASE);D.each(function(W){var re=a.calcTextOpts(W.level,Q,V,u);b.select(this).selectAll("path").each(function(j){var Z=this,ne=e.getVisibleSegment(Z,H,re.height/2);if(!!ne&&(M(Z,j,W,ne,R,re.height),!(ne.len<(re.width+re.height)*t.LABELMIN)))for(var le=Math.min(Math.ceil(ne.len/J),t.LABELMAX),ge=0;ge<le;ge++){var pe=a.findBestTextLocation(Z,ne,re,G,H);if(!pe)break;a.addLabelData(pe,re,G,K)}})}),V.remove(),a.drawLabels(U,G,u,B,F?K:null)}I&&!O&&D.remove()}function M(A,f,u,h,o,S){for(var R,z=0;z<u.pedgepaths.length;z++)f===u.pedgepaths[z]&&(R=u.edgepaths[z]);if(!R)return;var O=o.a[0],I=o.a[o.a.length-1],F=o.b[0],D=o.b[o.b.length-1];function B(q,K){var G=0,Q,V=.1;return(Math.abs(q[0]-O)<V||Math.abs(q[0]-I)<V)&&(Q=_(o.dxydb_rough(q[0],q[1],V)),G=Math.max(G,S*l(K,Q)/2)),(Math.abs(q[1]-F)<V||Math.abs(q[1]-D)<V)&&(Q=_(o.dxyda_rough(q[0],q[1],V)),G=Math.max(G,S*l(K,Q)/2)),G}var U=v(A,0,1),X=v(A,h.total,h.total-1),oe=B(R[0],U),se=h.total-B(R[R.length-1],X);h.min<oe&&(h.min=oe),h.max>se&&(h.max=se),h.len=h.max-h.min}function v(A,f,u){var h=A.getPointAtLength(f),o=A.getPointAtLength(u),S=o.x-h.x,R=o.y-h.y,z=Math.sqrt(S*S+R*R);return[S/z,R/z]}function _(A){var f=Math.sqrt(A[0]*A[0]+A[1]*A[1]);return[A[0]/f,A[1]/f]}function l(A,f){var u=Math.abs(A[0]*f[0]+A[1]*f[1]),h=Math.sqrt(1-u*u);return h/u}function y(A,f,u,h,o,S){var R,z,O,I,F=e.ensureSingle(A,"g","contourbg"),D=F.selectAll("path").data(S==="fill"&&!o?[0]:[]);D.enter().append("path"),D.exit().remove();var B=[];for(I=0;I<f.length;I++)R=f[I],z=k([],R.x,u.c2p),O=k([],R.y,h.c2p),B.push(P(z,O,R.bicubic));D.attr("d","M"+B.join("L")+"Z").style("stroke","none")}function T(A,f,u,h,o,S,R,z,O,I,F){var D=I==="fill";D&&r(o,A.contours);var B=e.ensureSingle(f,"g","contourfill"),U=B.selectAll("path").data(D?o:[]);U.enter().append("path"),U.exit().remove(),U.each(function(X){var oe=(X.prefixBoundary?F:"")+w(A,X,S,R,z,O,u,h);oe?b.select(this).attr("d",oe).style("stroke","none"):b.select(this).remove()})}function w(A,f,u,h,o,S,R,z){var O,I="",F=f.edgepaths.map(function(j,Z){return Z}),D=!0,B,U,X,oe,se,q,K=Math.abs(u[0][0]-u[2][0])*1e-4,G=Math.abs(u[0][1]-u[2][1])*1e-4;function Q(j){return Math.abs(j[1]-u[0][1])<G}function V(j){return Math.abs(j[1]-u[2][1])<G}function H(j){return Math.abs(j[0]-u[0][0])<K}function ee(j){return Math.abs(j[0]-u[2][0])<K}function J(j,Z){var ne,le,ge,pe,xe="";for(Q(j)&&!ee(j)||V(j)&&!H(j)?(pe=o.aaxis,ge=s(o,S,[j[0],Z[0]],.5*(j[1]+Z[1]))):(pe=o.baxis,ge=s(o,S,.5*(j[0]+Z[0]),[j[1],Z[1]])),ne=1;ne<ge.length;ne++)for(xe+=pe.smoothing?"C":"L",le=0;le<ge[ne].length;le++){var Ee=ge[ne][le];xe+=[R.c2p(Ee[0]),z.c2p(Ee[1])]+" "}return xe}for(O=0,B=null;F.length;){var W=f.edgepaths[O][0];for(B&&(I+=J(B,W)),q=E.smoothopen(f.edgepaths[O].map(h),f.smoothing),I+=D?q:q.replace(/^M/,"L"),F.splice(F.indexOf(O),1),B=f.edgepaths[O][f.edgepaths[O].length-1],oe=-1,X=0;X<4;X++){if(!B){e.log("Missing end?",O,f);break}for(Q(B)&&!ee(B)?U=u[1]:H(B)?U=u[0]:V(B)?U=u[3]:ee(B)&&(U=u[2]),se=0;se<f.edgepaths.length;se++){var re=f.edgepaths[se][0];Math.abs(B[0]-U[0])<K?Math.abs(B[0]-re[0])<K&&(re[1]-B[1])*(U[1]-re[1])>=0&&(U=re,oe=se):Math.abs(B[1]-U[1])<G?Math.abs(B[1]-re[1])<G&&(re[0]-B[0])*(U[0]-re[0])>=0&&(U=re,oe=se):e.log("endpt to newendpt is not vert. or horz.",B,U,re)}if(oe>=0)break;I+=J(B,U),B=U}if(oe===f.edgepaths.length){e.log("unclosed perimeter path");break}O=oe,D=F.indexOf(O)===-1,D&&(O=F[0],I+=J(B,U)+"Z",B=null)}for(O=0;O<f.paths.length;O++)I+=E.smoothclosed(f.paths[O].map(h),f.smoothing);return I}},{"../../components/drawing":388,"../../lib":503,"../carpet/axis_aligned_line":692,"../carpet/lookup_carpetid":708,"../carpet/makepath":709,"../carpet/map_1d_array":710,"../contour/close_boundaries":737,"../contour/constants":739,"../contour/convert_to_constraints":743,"../contour/empty_pathinfo":745,"../contour/find_all_paths":747,"../contour/make_crossings":752,"../contour/plot":753,"@plotly/d3":58}],762:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/attributes"),k=c("../../plots/template_attributes").hovertemplateAttrs,P=c("../../plots/attributes"),E=c("../scattermapbox/attributes"),e=c("../../lib/extend").extendFlat;ae.exports=e({lon:E.lon,lat:E.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:E.text,hovertext:E.hovertext,hoverinfo:e({},P.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:k(),showlegend:e({},P.showlegend,{dflt:!1})},b("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scattermapbox/attributes":993}],763:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib").isArrayOrTypedArray,P=c("../../constants/numerical").BADNUM,E=c("../../components/colorscale/calc"),e=c("../../lib")._;ae.exports=function(g,a){for(var t=a._length,i=new Array(t),n=a.z,r=k(n)&&n.length,d=0;d<t;d++){var s=i[d]={},m=a.lon[d],x=a.lat[d];if(s.lonlat=b(m)&&b(x)?[+m,+x]:[P,P],r){var M=n[d];s.z=b(M)?M:P}}return E(g,a,{vals:r?n:[0,1],containerStr:"",cLetter:"z"}),t&&(i[0].t={labels:{lat:e(g,"lat:")+" ",lon:e(g,"lon:")+" "}}),i}},{"../../components/colorscale/calc":374,"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],764:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../../components/color"),E=c("../../components/colorscale"),e=c("../../constants/numerical").BADNUM,p=c("../../lib/geojson_utils").makeBlank;ae.exports=function(a){var t=a[0].trace,i=t.visible===!0&&t._length!==0,n={layout:{visibility:"none"},paint:{}},r=t._opts={heatmap:n,geojson:p()};if(!i)return r;var d=[],s,m=t.z,x=t.radius,M=k.isArrayOrTypedArray(m)&&m.length,v=k.isArrayOrTypedArray(x);for(s=0;s<a.length;s++){var _=a[s],l=_.lonlat;if(l[0]!==e){var y={};if(M){var T=_.z;y.z=T!==e?T:0}v&&(y.r=b(x[s])&&x[s]>0?+x[s]:0),d.push({type:"Feature",geometry:{type:"Point",coordinates:l},properties:y})}}var w=E.extractOpts(t),A=w.reversescale?E.flipScale(w.colorscale):w.colorscale,f=A[0][1],u=P.opacity(f)<1?f:P.addOpacity(f,0),h=["interpolate",["linear"],["heatmap-density"],0,u];for(s=1;s<A.length;s++)h.push(A[s][0],A[s][1]);var o=["interpolate",["linear"],["get","z"],w.min,0,w.max,1];return k.extendFlat(r.heatmap.paint,{"heatmap-weight":M?o:1/(w.max-w.min),"heatmap-color":h,"heatmap-radius":v?{type:"identity",property:"r"}:t.radius,"heatmap-opacity":t.opacity}),r.geojson={type:"FeatureCollection",features:d},r.heatmap.layout.visibility="visible",r}},{"../../components/color":366,"../../components/colorscale":378,"../../constants/numerical":479,"../../lib":503,"../../lib/geojson_utils":497,"fast-isnumeric":190}],765:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/colorscale/defaults"),P=c("./attributes");ae.exports=function(e,p,g,a){function t(d,s){return b.coerce(e,p,P,d,s)}var i=t("lon")||[],n=t("lat")||[],r=Math.min(i.length,n.length);if(!r){p.visible=!1;return}p._length=r,t("z"),t("radius"),t("below"),t("text"),t("hovertext"),t("hovertemplate"),k(e,p,a,t,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":762}],766:[function(c,ae,ie){"use strict";ae.exports=function(k,P){return k.lon=P.lon,k.lat=P.lat,k.z=P.z,k}},{}],767:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../scattermapbox/hover").hoverPoints,P=c("../scattermapbox/hover").getExtraText;ae.exports=function(e,p,g){var a=k(e,p,g);if(!!a){var t=a[0],i=t.cd,n=i[0].trace,r=i[t.index];if(delete t.color,"z"in r){var d=t.subplot.mockAxis;t.z=r.z,t.zLabel=b.tickText(d,d.c2l(r.z),"hover").text}return t.extraText=P(n,r,i[0].t.labels),[t]}}},{"../../plots/cartesian/axes":554,"../scattermapbox/hover":998}],768:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../heatmap/colorbar"),formatLabels:c("../scattermapbox/format_labels"),calc:c("./calc"),plot:c("./plot"),hoverPoints:c("./hover"),eventData:c("./event_data"),getBelow:function(b,k){for(var P=k.getMapLayers(),E=0;E<P.length;E++){var e=P[E],p=e.id;if(e.type==="symbol"&&typeof p=="string"&&p.indexOf("plotly-")===-1)return p}},moduleType:"trace",name:"densitymapbox",basePlotModule:c("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":613,"../heatmap/colorbar":795,"../scattermapbox/format_labels":997,"./attributes":762,"./calc":763,"./defaults":765,"./event_data":766,"./hover":767,"./plot":769}],769:[function(c,ae,ie){"use strict";var b=c("./convert"),k=c("../../plots/mapbox/constants").traceLayerPrefix;function P(e,p){this.type="densitymapbox",this.subplot=e,this.uid=p,this.sourceId="source-"+p,this.layerList=[["heatmap",k+p+"-heatmap"]],this.below=null}var E=P.prototype;E.update=function(e){var p=this.subplot,g=this.layerList,a=b(e),t=p.belowLookup["trace-"+this.uid];p.map.getSource(this.sourceId).setData(a.geojson),t!==this.below&&(this._removeLayers(),this._addLayers(a,t),this.below=t);for(var i=0;i<g.length;i++){var n=g[i],r=n[0],d=n[1],s=a[r];p.setOptions(d,"setLayoutProperty",s.layout),s.layout.visibility==="visible"&&p.setOptions(d,"setPaintProperty",s.paint)}},E._addLayers=function(e,p){for(var g=this.subplot,a=this.layerList,t=this.sourceId,i=0;i<a.length;i++){var n=a[i],r=n[0],d=e[r];g.addLayer({type:r,id:n[1],source:t,layout:d.layout,paint:d.paint},p)}},E._removeLayers=function(){for(var e=this.subplot.map,p=this.layerList,g=p.length-1;g>=0;g--)e.removeLayer(p[g][1])},E.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},ae.exports=function(p,g){var a=g[0].trace,t=new P(p,a.uid),i=t.sourceId,n=b(g),r=t.below=p.belowLookup["trace-"+a.uid];return p.map.addSource(i,{type:"geojson",data:n.geojson}),t._addLayers(n,r),t}},{"../../plots/mapbox/constants":611,"./convert":764}],770:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E){for(var e=0;e<P.length;e++)P[e].i=e;b.mergeArray(E.text,P,"tx"),b.mergeArray(E.hovertext,P,"htx");var p=E.marker;if(p){b.mergeArray(p.opacity,P,"mo"),b.mergeArray(p.color,P,"mc");var g=p.line;g&&(b.mergeArray(g.color,P,"mlc"),b.mergeArrayCastPositive(g.width,P,"mlw"))}}},{"../../lib":503}],771:[function(c,ae,ie){"use strict";var b=c("../bar/attributes"),k=c("../scatter/attributes").line,P=c("../../plots/attributes"),E=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=c("../../plots/template_attributes").hovertemplateAttrs,p=c("../../plots/template_attributes").texttemplateAttrs,g=c("./constants"),a=c("../../lib/extend").extendFlat,t=c("../../components/color");ae.exports={x:b.x,x0:b.x0,dx:b.dx,y:b.y,y0:b.y0,dy:b.dy,xperiod:b.xperiod,yperiod:b.yperiod,xperiod0:b.xperiod0,yperiod0:b.yperiod0,xperiodalignment:b.xperiodalignment,yperiodalignment:b.yperiodalignment,xhoverformat:E("x"),yhoverformat:E("y"),hovertext:b.hovertext,hovertemplate:e({},{keys:g.eventDataKeys}),hoverinfo:a({},P.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:p({editType:"plot"},{keys:g.eventDataKeys.concat(["label","value"])}),text:b.text,textposition:b.textposition,insidetextanchor:a({},b.insidetextanchor,{dflt:"middle"}),textangle:a({},b.textangle,{dflt:0}),textfont:b.textfont,insidetextfont:b.insidetextfont,outsidetextfont:b.outsidetextfont,constraintext:b.constraintext,cliponaxis:b.cliponaxis,orientation:a({},b.orientation,{}),offset:a({},b.offset,{arrayOk:!1}),width:a({},b.width,{arrayOk:!1}),marker:i(),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:a({},k.color,{dflt:t.defaultLine}),width:a({},k.width,{dflt:0,editType:"plot"}),dash:k.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:b.offsetgroup,alignmentgroup:b.alignmentgroup};function i(){var n=a({},b.marker);return delete n.pattern,n}},{"../../components/color":366,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatter/attributes":927,"./constants":773}],772:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../plots/cartesian/align_period"),P=c("./arrays_to_calcdata"),E=c("../scatter/calc_selection"),e=c("../../constants/numerical").BADNUM;ae.exports=function(a,t){var i=b.getFromId(a,t.xaxis||"x"),n=b.getFromId(a,t.yaxis||"y"),r,d,s,m,x,M,v,_;t.orientation==="h"?(r=i.makeCalcdata(t,"x"),s=n.makeCalcdata(t,"y"),m=k(t,n,"y",s),x=!!t.yperiodalignment,M="y"):(r=n.makeCalcdata(t,"y"),s=i.makeCalcdata(t,"x"),m=k(t,i,"x",s),x=!!t.xperiodalignment,M="x"),d=m.vals;var l=Math.min(d.length,r.length),y=new Array(l);for(t._base=[],v=0;v<l;v++){r[v]<0&&(r[v]=e);var T=!1;r[v]!==e&&v+1<l&&r[v+1]!==e&&(T=!0),_=y[v]={p:d[v],s:r[v],cNext:T},t._base[v]=-.5*_.s,x&&(y[v].orig_p=s[v],y[v][M+"End"]=m.ends[v],y[v][M+"Start"]=m.starts[v]),t.ids&&(_.id=String(t.ids[v])),v===0&&(y[0].vTotal=0),y[0].vTotal+=p(_.s),_.begR=p(_.s)/p(y[0].s)}var w;for(v=0;v<l;v++)_=y[v],_.s!==e&&(_.sumR=_.s/y[0].vTotal,_.difR=w!==void 0?_.s/w:1,w=_.s);return P(y,t),E(y,t),y};function p(g){return g===e?0:g}},{"../../constants/numerical":479,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../scatter/calc_selection":929,"./arrays_to_calcdata":770}],773:[function(c,ae,ie){"use strict";ae.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],774:[function(c,ae,ie){"use strict";var b=c("../bar/cross_trace_calc").setGroupPositions;ae.exports=function(P,E){var e=P._fullLayout,p=P._fullData,g=P.calcdata,a=E.xaxis,t=E.yaxis,i=[],n=[],r=[],d,s;for(s=0;s<p.length;s++){var m=p[s],x=m.orientation==="h";m.visible===!0&&m.xaxis===a._id&&m.yaxis===t._id&&m.type==="funnel"&&(d=g[s],x?r.push(d):n.push(d),i.push(d))}var M={mode:e.funnelmode,norm:e.funnelnorm,gap:e.funnelgap,groupgap:e.funnelgroupgap};for(b(P,a,t,n,M),b(P,t,a,r,M),s=0;s<i.length;s++){d=i[s];for(var v=0;v<d.length;v++)v+1<d.length&&(d[v].nextP0=d[v+1].p0,d[v].nextS0=d[v+1].s0,d[v].nextP1=d[v+1].p1,d[v].nextS1=d[v+1].s1)}}},{"../bar/cross_trace_calc":651}],775:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../bar/defaults").handleGroupingDefaults,P=c("../bar/defaults").handleText,E=c("../scatter/xy_defaults"),e=c("../scatter/period_defaults"),p=c("./attributes"),g=c("../../components/color");function a(n,r,d,s){function m(T,w){return b.coerce(n,r,p,T,w)}var x=E(n,r,s,m);if(!x){r.visible=!1;return}e(n,r,s,m),m("xhoverformat"),m("yhoverformat"),m("orientation",r.y&&!r.x?"v":"h"),m("offset"),m("width");var M=m("text");m("hovertext"),m("hovertemplate");var v=m("textposition");P(n,r,s,m,v,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),r.textposition!=="none"&&!r.texttemplate&&m("textinfo",Array.isArray(M)?"text+value":"value");var _=m("marker.color",d);m("marker.line.color",g.defaultLine),m("marker.line.width");var l=m("connector.visible");if(l){m("connector.fillcolor",t(_));var y=m("connector.line.width");y&&(m("connector.line.color"),m("connector.line.dash"))}}function t(n){var r=b.isArrayOrTypedArray(n)?"#000":n;return g.addOpacity(r,.5*g.opacity(r))}function i(n,r){var d,s;function m(M){return b.coerce(s._input,s,p,M)}if(r.funnelmode==="group")for(var x=0;x<n.length;x++)s=n[x],d=s._input,k(d,s,r,m)}ae.exports={supplyDefaults:a,crossTraceDefaults:i}},{"../../components/color":366,"../../lib":503,"../bar/defaults":652,"../scatter/period_defaults":947,"../scatter/xy_defaults":954,"./attributes":771}],776:[function(c,ae,ie){"use strict";ae.exports=function(k,P){return k.x="xVal"in P?P.xVal:P.x,k.y="yVal"in P?P.yVal:P.y,"percentInitial"in P&&(k.percentInitial=P.percentInitial),"percentPrevious"in P&&(k.percentPrevious=P.percentPrevious),"percentTotal"in P&&(k.percentTotal=P.percentTotal),P.xa&&(k.xaxis=P.xa),P.ya&&(k.yaxis=P.ya),k}},{}],777:[function(c,ae,ie){"use strict";var b=c("../../components/color").opacity,k=c("../bar/hover").hoverOnBars,P=c("../../lib").formatPercent;ae.exports=function(p,g,a,t,i){var n=k(p,g,a,t,i);if(!!n){var r=n.cd,d=r[0].trace,s=d.orientation==="h",m=n.index,x=r[m],M=s?"x":"y";n[M+"LabelVal"]=x.s,n.percentInitial=x.begR,n.percentInitialLabel=P(x.begR,1),n.percentPrevious=x.difR,n.percentPreviousLabel=P(x.difR,1),n.percentTotal=x.sumR,n.percentTotalLabel=P(x.sumR,1);var v=x.hi||d.hoverinfo,_=[];if(v&&v!=="none"&&v!=="skip"){var l=v==="all",y=v.split("+"),T=function(w){return l||y.indexOf(w)!==-1};T("percent initial")&&_.push(n.percentInitialLabel+" of initial"),T("percent previous")&&_.push(n.percentPreviousLabel+" of previous"),T("percent total")&&_.push(n.percentTotalLabel+" of total")}return n.extraText=_.join("<br>"),n.color=E(d,x),[n]}};function E(e,p){var g=e.marker,a=p.mc||g.color,t=p.mlc||g.line.color,i=p.mlw||g.line.width;if(b(a))return a;if(b(t)&&i)return t}},{"../../components/color":366,"../../lib":503,"../bar/hover":655}],778:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults").supplyDefaults,crossTraceDefaults:c("./defaults").crossTraceDefaults,supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc"),crossTraceCalc:c("./cross_trace_calc"),plot:c("./plot"),style:c("./style").style,hoverPoints:c("./hover"),eventData:c("./event_data"),selectPoints:c("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:c("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../bar/select":660,"./attributes":771,"./calc":772,"./cross_trace_calc":774,"./defaults":775,"./event_data":776,"./hover":777,"./layout_attributes":779,"./layout_defaults":780,"./plot":781,"./style":782}],779:[function(c,ae,ie){"use strict";ae.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],780:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(P,E,e){var p=!1;function g(i,n){return b.coerce(P,E,k,i,n)}for(var a=0;a<e.length;a++){var t=e[a];if(t.visible&&t.type==="funnel"){p=!0;break}}p&&(g("funnelmode"),g("funnelgap",.2),g("funnelgroupgap"))}},{"../../lib":503,"./layout_attributes":779}],781:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../components/drawing"),E=c("../../constants/numerical").BADNUM,e=c("../bar/plot"),p=c("../bar/uniform_text").clearMinTextSize;ae.exports=function(n,r,d,s){var m=n._fullLayout;p("funnel",m),g(n,r,d,s),a(n,r,d,s),e.plot(n,r,d,s,{mode:m.funnelmode,norm:m.funnelmode,gap:m.funnelgap,groupgap:m.funnelgroupgap})};function g(i,n,r,d){var s=n.xaxis,m=n.yaxis;k.makeTraceGroups(d,r,"trace bars").each(function(x){var M=b.select(this),v=x[0].trace,_=k.ensureSingle(M,"g","regions");if(!v.connector||!v.connector.visible){_.remove();return}var l=v.orientation==="h",y=_.selectAll("g.region").data(k.identity);y.enter().append("g").classed("region",!0),y.exit().remove();var T=y.size();y.each(function(w,A){if(!(A!==T-1&&!w.cNext)){var f=t(w,s,m,l),u=f[0],h=f[1],o="";u[0]!==E&&h[0]!==E&&u[1]!==E&&h[1]!==E&&u[2]!==E&&h[2]!==E&&u[3]!==E&&h[3]!==E&&(l?o+="M"+u[0]+","+h[1]+"L"+u[2]+","+h[2]+"H"+u[3]+"L"+u[1]+","+h[1]+"Z":o+="M"+u[1]+","+h[1]+"L"+u[2]+","+h[3]+"V"+h[2]+"L"+u[1]+","+h[0]+"Z"),o===""&&(o="M0,0Z"),k.ensureSingle(b.select(this),"path").attr("d",o).call(P.setClipUrl,n.layerClipId,i)}})})}function a(i,n,r,d){var s=n.xaxis,m=n.yaxis;k.makeTraceGroups(d,r,"trace bars").each(function(x){var M=b.select(this),v=x[0].trace,_=k.ensureSingle(M,"g","lines");if(!v.connector||!v.connector.visible||!v.connector.line.width){_.remove();return}var l=v.orientation==="h",y=_.selectAll("g.line").data(k.identity);y.enter().append("g").classed("line",!0),y.exit().remove();var T=y.size();y.each(function(w,A){if(!(A!==T-1&&!w.cNext)){var f=t(w,s,m,l),u=f[0],h=f[1],o="";u[3]!==void 0&&h[3]!==void 0&&(l?(o+="M"+u[0]+","+h[1]+"L"+u[2]+","+h[2],o+="M"+u[1]+","+h[1]+"L"+u[3]+","+h[2]):(o+="M"+u[1]+","+h[1]+"L"+u[2]+","+h[3],o+="M"+u[1]+","+h[0]+"L"+u[2]+","+h[2])),o===""&&(o="M0,0Z"),k.ensureSingle(b.select(this),"path").attr("d",o).call(P.setClipUrl,n.layerClipId,i)}})})}function t(i,n,r,d){var s=[],m=[],x=d?n:r,M=d?r:n;return s[0]=x.c2p(i.s0,!0),m[0]=M.c2p(i.p0,!0),s[1]=x.c2p(i.s1,!0),m[1]=M.c2p(i.p1,!0),s[2]=x.c2p(i.nextS0,!0),m[2]=M.c2p(i.nextP0,!0),s[3]=x.c2p(i.nextS1,!0),m[3]=M.c2p(i.nextP1,!0),d?[s,m]:[m,s]}},{"../../components/drawing":388,"../../constants/numerical":479,"../../lib":503,"../bar/plot":659,"../bar/uniform_text":664,"@plotly/d3":58}],782:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/drawing"),P=c("../../components/color"),E=c("../../constants/interactions").DESELECTDIM,e=c("../bar/style"),p=c("../bar/uniform_text").resizeText,g=e.styleTextPoints;function a(t,i,n){var r=n||b.select(t).selectAll("g.funnellayer").selectAll("g.trace");p(t,r,"funnel"),r.style("opacity",function(d){return d[0].trace.opacity}),r.each(function(d){var s=b.select(this),m=d[0].trace;s.selectAll(".point > path").each(function(x){if(!x.isBlank){var M=m.marker;b.select(this).call(P.fill,x.mc||M.color).call(P.stroke,x.mlc||M.line.color).call(k.dashLine,M.line.dash,x.mlw||M.line.width).style("opacity",m.selectedpoints&&!x.selected?E:1)}}),g(s,m,t),s.selectAll(".regions").each(function(){b.select(this).selectAll("path").style("stroke-width",0).call(P.fill,m.connector.fillcolor)}),s.selectAll(".lines").each(function(){var x=m.connector.line;k.lineGroupStyle(b.select(this).selectAll("path"),x.width,x.color,x.dash)})})}ae.exports={style:a}},{"../../components/color":366,"../../components/drawing":388,"../../constants/interactions":478,"../bar/style":662,"../bar/uniform_text":664,"@plotly/d3":58}],783:[function(c,ae,ie){"use strict";var b=c("../pie/attributes"),k=c("../../plots/attributes"),P=c("../../plots/domain").attributes,E=c("../../plots/template_attributes").hovertemplateAttrs,e=c("../../plots/template_attributes").texttemplateAttrs,p=c("../../lib/extend").extendFlat;ae.exports={labels:b.labels,label0:b.label0,dlabel:b.dlabel,values:b.values,marker:{colors:b.marker.colors,line:{color:p({},b.marker.line.color,{dflt:null}),width:p({},b.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:b.text,hovertext:b.hovertext,scalegroup:p({},b.scalegroup,{}),textinfo:p({},b.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:p({},k.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:E({},{keys:["label","color","value","text","percent"]}),textposition:p({},b.textposition,{values:["inside","none"],dflt:"inside"}),textfont:b.textfont,insidetextfont:b.insidetextfont,title:{text:b.title.text,font:b.title.font,position:p({},b.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:P({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":901}],784:[function(c,ae,ie){"use strict";var b=c("../../plots/plots");ie.name="funnelarea",ie.plot=function(k,P,E,e){b.plotBasePlot(ie.name,k,P,E,e)},ie.clean=function(k,P,E,e){b.cleanBasePlot(ie.name,k,P,E,e)}},{"../../plots/plots":619}],785:[function(c,ae,ie){"use strict";var b=c("../pie/calc");function k(E,e){return b.calc(E,e)}function P(E){b.crossTraceCalc(E,{type:"funnelarea"})}ae.exports={calc:k,crossTraceCalc:P}},{"../pie/calc":903}],786:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("../../plots/domain").defaults,E=c("../bar/defaults").handleText,e=c("../pie/defaults").handleLabelsAndValues;ae.exports=function(g,a,t,i){function n(T,w){return b.coerce(g,a,k,T,w)}var r=n("labels"),d=n("values"),s=e(r,d),m=s.len;if(a._hasLabels=s.hasLabels,a._hasValues=s.hasValues,!a._hasLabels&&a._hasValues&&(n("label0"),n("dlabel")),!m){a.visible=!1;return}a._length=m;var x=n("marker.line.width");x&&n("marker.line.color",i.paper_bgcolor),n("marker.colors"),n("scalegroup");var M=n("text"),v=n("texttemplate"),_;if(v||(_=n("textinfo",Array.isArray(M)?"text+percent":"percent")),n("hovertext"),n("hovertemplate"),v||_&&_!=="none"){var l=n("textposition");E(g,a,i,n,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}P(a,i,n);var y=n("title.text");y&&(n("title.position"),b.coerceFont(n,"title.font",i.font)),n("aspectratio"),n("baseratio")}},{"../../lib":503,"../../plots/domain":584,"../bar/defaults":652,"../pie/defaults":904,"./attributes":783}],787:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"funnelarea",basePlotModule:c("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults"),supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc").calc,crossTraceCalc:c("./calc").crossTraceCalc,plot:c("./plot"),style:c("./style"),styleOne:c("../pie/style_one"),meta:{}}},{"../pie/style_one":912,"./attributes":783,"./base_plot":784,"./calc":785,"./defaults":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(c,ae,ie){"use strict";var b=c("../pie/layout_attributes").hiddenlabels;ae.exports={hiddenlabels:b,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":908}],789:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(E,e){function p(g,a){return b.coerce(E,e,k,g,a)}p("hiddenlabels"),p("funnelareacolorway",e.colorway),p("extendfunnelareacolors")}},{"../../lib":503,"./layout_attributes":788}],790:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/drawing"),P=c("../../lib"),E=P.strScale,e=P.strTranslate,p=c("../../lib/svg_text_utils"),g=c("../bar/plot"),a=g.toMoveInsideBar,t=c("../bar/uniform_text"),i=t.recordMinTextSize,n=t.clearMinTextSize,r=c("../pie/helpers"),d=c("../pie/plot"),s=d.attachFxHandlers,m=d.determineInsideTextFont,x=d.layoutAreas,M=d.prerenderTitles,v=d.positionTitleOutside,_=d.formatSliceLabel;ae.exports=function(A,f){var u=A._fullLayout;n("funnelarea",u),M(f,A),x(f,u._size),P.makeTraceGroups(u._funnelarealayer,f,"trace").each(function(h){var o=b.select(this),S=h[0],R=S.trace;T(h),o.each(function(){var z=b.select(this).selectAll("g.slice").data(h);z.enter().append("g").classed("slice",!0),z.exit().remove(),z.each(function(I,F){if(I.hidden){b.select(this).selectAll("path,g").remove();return}I.pointNumber=I.i,I.curveNumber=R.index;var D=S.cx,B=S.cy,U=b.select(this),X=U.selectAll("path.surface").data([I]);X.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),U.call(s,A,h);var oe="M"+(D+I.TR[0])+","+(B+I.TR[1])+l(I.TR,I.BR)+l(I.BR,I.BL)+l(I.BL,I.TL)+"Z";X.attr("d",oe),_(A,I,S);var se=r.castOption(R.textposition,I.pts),q=U.selectAll("g.slicetext").data(I.text&&se!=="none"?[0]:[]);q.enter().append("g").classed("slicetext",!0),q.exit().remove(),q.each(function(){var K=P.ensureSingle(b.select(this),"text","",function(re){re.attr("data-notex",1)}),G=P.ensureUniformFontSize(A,m(R,I,u.font));K.text(I.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(k.font,G).call(p.convertToTspans,A);var Q=k.bBox(K.node()),V,H,ee,J=Math.min(I.BL[1],I.BR[1])+B,W=Math.max(I.TL[1],I.TR[1])+B;H=Math.max(I.TL[0],I.BL[0])+D,ee=Math.min(I.TR[0],I.BR[0])+D,V=a(H,ee,J,W,Q,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"}),V.fontSize=G.size,i(R.type,V,u),h[F].transform=V,K.attr("transform",P.getTextTransform(V))})});var O=b.select(this).selectAll("g.titletext").data(R.title.text?[0]:[]);O.enter().append("g").classed("titletext",!0),O.exit().remove(),O.each(function(){var I=P.ensureSingle(b.select(this),"text","",function(B){B.attr("data-notex",1)}),F=R.title.text;R._meta&&(F=P.templateString(F,R._meta)),I.text(F).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(k.font,R.title.font).call(p.convertToTspans,A);var D=v(S,u._size);I.attr("transform",e(D.x,D.y)+E(Math.min(1,D.scale))+e(D.tx,D.ty))})})})};function l(w,A){var f=A[0]-w[0],u=A[1]-w[1];return"l"+f+","+u}function y(w,A){return[.5*(w[0]+A[0]),.5*(w[1]+A[1])]}function T(w){if(!w.length)return;var A=w[0],f=A.trace,u=f.aspectratio,h=f.baseratio;h>.999&&(h=.999);var o=Math.pow(h,2),S=A.vTotal,R=S*o/(1-o),z=S,O=R/S;function I(){var Z=Math.sqrt(O);return{x:Z,y:-Z}}function F(){var Z=I();return[Z.x,Z.y]}var D,B=[];B.push(F());var U,X;for(U=w.length-1;U>-1;U--)if(X=w[U],!X.hidden){var oe=X.v/z;O+=oe,B.push(F())}var se=1/0,q=-1/0;for(U=0;U<B.length;U++)D=B[U],se=Math.min(se,D[1]),q=Math.max(q,D[1]);for(U=0;U<B.length;U++)B[U][1]-=(q+se)/2;var K=B[B.length-1][0],G=A.r,Q=(q-se)/2,V=G/K,H=G/Q*u;for(A.r=H*Q,U=0;U<B.length;U++)B[U][0]*=V,B[U][1]*=H;D=B[0];var ee=[-D[0],D[1]],J=[D[0],D[1]],W=0;for(U=w.length-1;U>-1;U--)if(X=w[U],!X.hidden){W+=1;var re=B[W][0],j=B[W][1];X.TL=[-re,j],X.TR=[re,j],X.BL=ee,X.BR=J,X.pxmid=y(X.TR,X.BR),ee=X.TL,J=X.TR}}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../bar/plot":659,"../bar/uniform_text":664,"../pie/helpers":906,"../pie/plot":910,"@plotly/d3":58}],791:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../pie/style_one"),P=c("../bar/uniform_text").resizeText;ae.exports=function(e){var p=e._fullLayout._funnelarealayer.selectAll(".trace");P(e,p,"funnelarea"),p.each(function(g){var a=g[0],t=a.trace,i=b.select(this);i.style({opacity:t.opacity}),i.selectAll("path.surface").each(function(n){b.select(this).call(k,n,t)})})}},{"../bar/uniform_text":664,"../pie/style_one":912,"@plotly/d3":58}],792:[function(c,ae,ie){"use strict";var b=c("../scatter/attributes"),k=c("../../plots/attributes"),P=c("../../plots/font_attributes"),E=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=c("../../plots/template_attributes").hovertemplateAttrs,p=c("../../plots/template_attributes").texttemplateAttrs,g=c("../../components/colorscale/attributes"),a=c("../../lib/extend").extendFlat;ae.exports=a({z:{valType:"data_array",editType:"calc"},x:a({},b.x,{impliedEdits:{xtype:"array"}}),x0:a({},b.x0,{impliedEdits:{xtype:"scaled"}}),dx:a({},b.dx,{impliedEdits:{xtype:"scaled"}}),y:a({},b.y,{impliedEdits:{ytype:"array"}}),y0:a({},b.y0,{impliedEdits:{ytype:"scaled"}}),dy:a({},b.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:a({},b.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:a({},b.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:a({},b.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:a({},b.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:a({},b.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:a({},b.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:E("x"),yhoverformat:E("y"),zhoverformat:E("z",1),hovertemplate:e(),texttemplate:p({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:P({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:a({},k.showlegend,{dflt:!1})},{transforms:void 0},g("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"../scatter/attributes":927}],793:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("../../plots/cartesian/axes"),E=c("../../plots/cartesian/align_period"),e=c("../histogram2d/calc"),p=c("../../components/colorscale/calc"),g=c("./convert_column_xyz"),a=c("./clean_2d_array"),t=c("./interp2d"),i=c("./find_empties"),n=c("./make_bound_array"),r=c("../../constants/numerical").BADNUM;ae.exports=function(x,M){var v=P.getFromId(x,M.xaxis||"x"),_=P.getFromId(x,M.yaxis||"y"),l=b.traceIs(M,"contour"),y=b.traceIs(M,"histogram"),T=b.traceIs(M,"gl2d"),w=l?"best":M.zsmooth,A,f,u,h,o,S,R,z,O,I,F;if(v._minDtick=0,_._minDtick=0,y)F=e(x,M),h=F.orig_x,A=F.x,f=F.x0,u=F.dx,z=F.orig_y,o=F.y,S=F.y0,R=F.dy,O=F.z;else{var D=M.z;k.isArray1D(D)?(g(M,v,_,"x","y",["z"]),A=M._x,o=M._y,D=M._z):(h=M.x?v.makeCalcdata(M,"x"):[],z=M.y?_.makeCalcdata(M,"y"):[],A=E(M,v,"x",h).vals,o=E(M,_,"y",z).vals,M._x=A,M._y=o),f=M.x0,u=M.dx,S=M.y0,R=M.dy,O=a(D,M,v,_)}(v.rangebreaks||_.rangebreaks)&&(O=s(A,o,O),y||(A=d(A),o=d(o),M._x=A,M._y=o)),!y&&(l||M.connectgaps)&&(M._emptypoints=i(O),t(O,M._emptypoints));function B(J){w=M._input.zsmooth=M.zsmooth=!1,k.warn('cannot use zsmooth: "fast": '+J)}if(w==="fast"){if(v.type==="log"||_.type==="log")B("log axis found");else if(!y){if(A.length){var U=(A[A.length-1]-A[0])/(A.length-1),X=Math.abs(U/100);for(I=0;I<A.length-1;I++)if(Math.abs(A[I+1]-A[I]-U)>X){B("x scale is not linear");break}}if(o.length&&w==="fast"){var oe=(o[o.length-1]-o[0])/(o.length-1),se=Math.abs(oe/100);for(I=0;I<o.length-1;I++)if(Math.abs(o[I+1]-o[I]-oe)>se){B("y scale is not linear");break}}}}var q=k.maxRowLength(O),K=M.xtype==="scaled"?"":A,G=n(M,K,f,u,q,v),Q=M.ytype==="scaled"?"":o,V=n(M,Q,S,R,O.length,_);T||(M._extremes[v._id]=P.findExtremes(v,G),M._extremes[_._id]=P.findExtremes(_,V));var H={x:G,y:V,z:O,text:M._text||M.text,hovertext:M._hovertext||M.hovertext};if(M.xperiodalignment&&h&&(H.orig_x=h),M.yperiodalignment&&z&&(H.orig_y=z),K&&K.length===G.length-1&&(H.xCenter=K),Q&&Q.length===V.length-1&&(H.yCenter=Q),y&&(H.xRanges=F.xRanges,H.yRanges=F.yRanges,H.pts=F.pts),l||p(x,M,{vals:O,cLetter:"z"}),l&&M.contours&&M.contours.coloring==="heatmap"){var ee={type:M.type==="contour"?"heatmap":"histogram2d",xcalendar:M.xcalendar,ycalendar:M.ycalendar};H.xfill=n(ee,K,f,u,q,v),H.yfill=n(ee,Q,S,R,O.length,_)}return[H]};function d(m){for(var x=[],M=m.length,v=0;v<M;v++){var _=m[v];_!==r&&x.push(_)}return x}function s(m,x,M){for(var v=[],_=-1,l=0;l<M.length;l++)if(x[l]!==r){_++,v[_]=[];for(var y=0;y<M[l].length;y++)m[y]!==r&&v[_].push(M[l][y])}return v}},{"../../components/colorscale/calc":374,"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../../registry":638,"../histogram2d/calc":826,"./clean_2d_array":794,"./convert_column_xyz":796,"./find_empties":798,"./interp2d":801,"./make_bound_array":803}],794:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../../constants/numerical").BADNUM;ae.exports=function(e,p,g,a){var t,i,n,r,d,s;function m(y){if(!!b(y))return+y}if(p&&p.transpose){for(t=0,d=0;d<e.length;d++)t=Math.max(t,e[d].length);if(t===0)return!1;n=function(y){return y.length},r=function(y,T,w){return(y[w]||[])[T]}}else t=e.length,n=function(y,T){return y[T].length},r=function(y,T,w){return(y[T]||[])[w]};var x=function(y,T,w){return T===P||w===P?P:r(y,T,w)};function M(y){if(p&&p.type!=="carpet"&&p.type!=="contourcarpet"&&y&&y.type==="category"&&p["_"+y._id.charAt(0)].length){var T=y._id.charAt(0),w={},A=p["_"+T+"CategoryMap"]||p[T];for(d=0;d<A.length;d++)w[A[d]]=d;return function(f){var u=w[y._categories[f]];return u+1?u:P}}else return k.identity}var v=M(g),_=M(a);a&&a.type==="category"&&(t=a._categories.length);var l=new Array(t);for(d=0;d<t;d++)for(g&&g.type==="category"?i=g._categories.length:i=n(e,d),l[d]=new Array(i),s=0;s<i;s++)l[d][s]=m(x(e,_(d),v(s)));return l}},{"../../constants/numerical":479,"../../lib":503,"fast-isnumeric":190}],795:[function(c,ae,ie){"use strict";ae.exports={min:"zmin",max:"zmax"}},{}],796:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../constants/numerical").BADNUM,P=c("../../plots/cartesian/align_period");ae.exports=function(e,p,g,a,t,i){var n=e._length,r=p.makeCalcdata(e,a),d=g.makeCalcdata(e,t);r=P(e,p,a,r).vals,d=P(e,g,t,d).vals;var s=e.text,m=s!==void 0&&b.isArray1D(s),x=e.hovertext,M=x!==void 0&&b.isArray1D(x),v,_,l=b.distinctVals(r),y=l.vals,T=b.distinctVals(d),w=T.vals,A=[],f,u,h=w.length,o=y.length;for(v=0;v<i.length;v++)A[v]=b.init2dArray(h,o);m&&(f=b.init2dArray(h,o)),M&&(u=b.init2dArray(h,o));var S=b.init2dArray(h,o);for(v=0;v<n;v++)if(r[v]!==k&&d[v]!==k){var R=b.findBin(r[v]+l.minDiff/2,y),z=b.findBin(d[v]+T.minDiff/2,w);for(_=0;_<i.length;_++){var O=i[_],I=e[O],F=A[_];F[z][R]=I[v],S[z][R]=v}m&&(f[z][R]=s[v]),M&&(u[z][R]=x[v])}for(e["_"+a]=y,e["_"+t]=w,_=0;_<i.length;_++)e["_"+i[_]]=A[_];m&&(e._text=f),M&&(e._hovertext=u),p&&p.type==="category"&&(e["_"+a+"CategoryMap"]=y.map(function(D){return p._categories[D]})),g&&g.type==="category"&&(e["_"+t+"CategoryMap"]=w.map(function(D){return g._categories[D]})),e._after2before=S}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551}],797:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./xyz_defaults"),P=c("./label_defaults"),E=c("../scatter/period_defaults"),e=c("./style_defaults"),p=c("../../components/colorscale/defaults"),g=c("./attributes");ae.exports=function(t,i,n,r){function d(m,x){return b.coerce(t,i,g,m,x)}var s=k(t,i,d,r);if(!s){i.visible=!1;return}E(t,i,r,d),d("xhoverformat"),d("yhoverformat"),d("text"),d("hovertext"),d("hovertemplate"),P(d,r),e(t,i,d,r),d("hoverongaps"),d("connectgaps",b.isArray1D(i.z)&&i.zsmooth!==!1),p(t,i,r,d,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":376,"../../lib":503,"../scatter/period_defaults":947,"./attributes":792,"./label_defaults":802,"./style_defaults":806,"./xyz_defaults":807}],798:[function(c,ae,ie){"use strict";var b=c("../../lib").maxRowLength;ae.exports=function(P){var E=[],e={},p=[],g=P[0],a=[],t=[0,0,0],i=b(P),n,r,d,s,m,x,M,v;for(r=0;r<P.length;r++)for(n=a,a=g,g=P[r+1]||[],d=0;d<i;d++)a[d]===void 0&&(x=(a[d-1]!==void 0?1:0)+(a[d+1]!==void 0?1:0)+(n[d]!==void 0?1:0)+(g[d]!==void 0?1:0),x?(r===0&&x++,d===0&&x++,r===P.length-1&&x++,d===a.length-1&&x++,x<4&&(e[[r,d]]=[r,d,x]),E.push([r,d,x])):p.push([r,d]));for(;p.length;){for(M={},v=!1,m=p.length-1;m>=0;m--)s=p[m],r=s[0],d=s[1],x=((e[[r-1,d]]||t)[2]+(e[[r+1,d]]||t)[2]+(e[[r,d-1]]||t)[2]+(e[[r,d+1]]||t)[2])/20,x&&(M[s]=[r,d,x],p.splice(m,1),v=!0);if(!v)throw"findEmpties iterated with no new neighbors";for(s in M)e[s]=M[s],E.push(M[s])}return E.sort(function(_,l){return l[2]-_[2]})}},{"../../lib":503}],799:[function(c,ae,ie){"use strict";var b=c("../../components/fx"),k=c("../../lib"),P=c("../../plots/cartesian/axes"),E=c("../../components/colorscale").extractOpts;ae.exports=function(p,g,a,t,i){i||(i={});var n=i.isContour,r=p.cd[0],d=r.trace,s=p.xa,m=p.ya,x=r.x,M=r.y,v=r.z,_=r.xCenter,l=r.yCenter,y=r.zmask,T=d.zhoverformat,w=x,A=M,f,u,h,o;if(p.index!==!1){try{h=Math.round(p.index[1]),o=Math.round(p.index[0])}catch{k.error("Error hovering on heatmap, pointNumber must be [row,col], found:",p.index);return}if(h<0||h>=v[0].length||o<0||o>v.length)return}else{if(b.inbox(g-x[0],g-x[x.length-1],0)>0||b.inbox(a-M[0],a-M[M.length-1],0)>0)return;if(n){var S;for(w=[2*x[0]-x[1]],S=1;S<x.length;S++)w.push((x[S]+x[S-1])/2);for(w.push([2*x[x.length-1]-x[x.length-2]]),A=[2*M[0]-M[1]],S=1;S<M.length;S++)A.push((M[S]+M[S-1])/2);A.push([2*M[M.length-1]-M[M.length-2]])}h=Math.max(0,Math.min(w.length-2,k.findBin(g,w))),o=Math.max(0,Math.min(A.length-2,k.findBin(a,A)))}var R=s.c2p(x[h]),z=s.c2p(x[h+1]),O=m.c2p(M[o]),I=m.c2p(M[o+1]),F,D;n?(F=r.orig_x||x,D=r.orig_y||M,z=R,f=F[h],I=O,u=D[o]):(F=r.orig_x||_||x,D=r.orig_y||l||M,f=_?F[h]:(F[h]+F[h+1])/2,u=l?D[o]:(D[o]+D[o+1])/2,s&&s.type==="category"&&(f=x[h]),m&&m.type==="category"&&(u=M[o]),d.zsmooth&&(R=z=s.c2p(f),O=I=m.c2p(u)));var B=v[o][h];if(y&&!y[o][h]&&(B=void 0),!(B===void 0&&!d.hoverongaps)){var U;Array.isArray(r.hovertext)&&Array.isArray(r.hovertext[o])?U=r.hovertext[o][h]:Array.isArray(r.text)&&Array.isArray(r.text[o])&&(U=r.text[o][h]);var X=E(d),oe={type:"linear",range:[X.min,X.max],hoverformat:T,_separators:s._separators,_numFormat:s._numFormat},se=P.tickText(oe,B,"hover").text;return[k.extendFlat(p,{index:d._after2before?d._after2before[o][h]:[o,h],distance:p.maxHoverDistance,spikeDistance:p.maxSpikeDistance,x0:R,x1:z,y0:O,y1:I,xLabelVal:f,yLabelVal:u,zLabelVal:B,zLabel:se,text:U})]}}},{"../../components/colorscale":378,"../../components/fx":406,"../../lib":503,"../../plots/cartesian/axes":554}],800:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("./calc"),plot:c("./plot"),colorbar:c("./colorbar"),style:c("./style"),hoverPoints:c("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":568,"./attributes":792,"./calc":793,"./colorbar":795,"./defaults":797,"./hover":799,"./plot":804,"./style":805}],801:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=.01,P=[[-1,0],[1,0],[0,-1],[0,1]];function E(p){return .5-.25*Math.min(1,p*.5)}ae.exports=function(g,a){var t=1,i;for(e(g,a),i=0;i<a.length&&!(a[i][2]<4);i++);for(a=a.slice(i),i=0;i<100&&t>k;i++)t=e(g,a,E(t));return t>k&&b.log("interp2d didn't converge quickly",t),g};function e(p,g,a){var t=0,i,n,r,d,s,m,x,M,v,_,l,y,T;for(d=0;d<g.length;d++){for(i=g[d],n=i[0],r=i[1],l=p[n][r],_=0,v=0,s=0;s<4;s++)m=P[s],x=p[n+m[0]],x&&(M=x[r+m[1]],M!==void 0&&(_===0?y=T=M:(y=Math.min(y,M),T=Math.max(T,M)),v++,_+=M));if(v===0)throw"iterateInterp2d order is wrong: no defined neighbors";p[n][r]=_/v,l===void 0?v<4&&(t=1):(p[n][r]=(1+a)*p[n][r]-a*l,T>y&&(t=Math.max(t,Math.abs(p[n][r]-l)/(T-y))))}return t}},{"../../lib":503}],802:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E){P("texttemplate");var e=b.extendFlat({},E.font,{color:"auto",size:"auto"});b.coerceFont(P,"textfont",e)}},{"../../lib":503}],803:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib").isArrayOrTypedArray;ae.exports=function(E,e,p,g,a,t){var i=[],n=b.traceIs(E,"contour"),r=b.traceIs(E,"histogram"),d=b.traceIs(E,"gl2d"),s,m,x,M=k(e)&&e.length>1;if(M&&!r&&t.type!=="category"){var v=e.length;if(v<=a){if(n||d)i=e.slice(0,a);else if(a===1)i=[e[0]-.5,e[0]+.5];else{for(i=[1.5*e[0]-.5*e[1]],x=1;x<v;x++)i.push((e[x-1]+e[x])*.5);i.push(1.5*e[v-1]-.5*e[v-2])}if(v<a){var _=i[i.length-1],l=_-i[i.length-2];for(x=v;x<a;x++)_+=l,i.push(_)}}else return n?e.slice(0,a):e.slice(0,a+1)}else{var y=E[t._id.charAt(0)+"calendar"];if(r)s=t.r2c(p,0,y);else if(k(e)&&e.length===1)s=e[0];else if(p===void 0)s=0;else{var T=t.type==="log"?t.d2c:t.r2c;s=T(p,0,y)}for(m=g||1,x=n||d?0:-.5;x<a;x++)i.push(s+m*x)}return i}},{"../../lib":503,"../../registry":638}],804:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("tinycolor2"),P=c("../../registry"),E=c("../../components/drawing"),e=c("../../plots/cartesian/axes"),p=c("../../lib"),g=c("../../lib/svg_text_utils"),a=c("../scatter/format_labels"),t=c("../../components/color"),i=c("../../components/colorscale").extractOpts,n=c("../../components/colorscale").makeColorScaleFuncFromTrace,r=c("../../constants/xmlns_namespaces"),d=c("../../constants/alignment"),s=d.LINE_SPACING,m="heatmap-label";function x(y){return y.selectAll("g."+m)}function M(y){x(y).remove()}ae.exports=function(y,T,w,A){var f=T.xaxis,u=T.yaxis;p.makeTraceGroups(A,w,"hm").each(function(h){var o=b.select(this),S=h[0],R=S.trace,z=R.xgap||0,O=R.ygap||0,I=S.z,F=S.x,D=S.y,B=S.xCenter,U=S.yCenter,X=P.traceIs(R,"contour"),oe=X?"best":R.zsmooth,se=I.length,q=p.maxRowLength(I),K=!1,G=!1,Q,V,H,ee,J,W,re,j;for(W=0;Q===void 0&&W<F.length-1;)Q=f.c2p(F[W]),W++;for(W=F.length-1;V===void 0&&W>0;)V=f.c2p(F[W]),W--;for(V<Q&&(H=V,V=Q,Q=H,K=!0),W=0;ee===void 0&&W<D.length-1;)ee=u.c2p(D[W]),W++;for(W=D.length-1;J===void 0&&W>0;)J=u.c2p(D[W]),W--;if(J<ee&&(H=ee,ee=J,J=H,G=!0),X&&(B=F,U=D,F=S.xfill,D=S.yfill),oe!=="fast"){var Z=oe==="best"?0:.5;Q=Math.max(-Z*f._length,Q),V=Math.min((1+Z)*f._length,V),ee=Math.max(-Z*u._length,ee),J=Math.min((1+Z)*u._length,J)}var ne=Math.round(V-Q),le=Math.round(J-ee),ge=ne<=0||le<=0;if(ge){var pe=o.selectAll("image").data([]);pe.exit().remove(),M(o);return}var xe,Ee;oe==="fast"?(xe=q,Ee=se):(xe=ne,Ee=le);var Te=document.createElement("canvas");Te.width=xe,Te.height=Ee;var de=Te.getContext("2d"),be=n(R,{noNumericCheck:!0,returnArray:!0}),Le,De;oe==="fast"?(Le=K?function(Rr){return q-1-Rr}:p.identity,De=G?function(Rr){return se-1-Rr}:p.identity):(Le=function(Rr){return p.constrain(Math.round(f.c2p(F[Rr])-Q),0,ne)},De=function(Rr){return p.constrain(Math.round(u.c2p(D[Rr])-ee),0,le)});var ye=De(0),ke=[ye,ye],Oe=K?0:1,Qe=G?0:1,Ve=0,Ue=0,Ie=0,at=0,pt,Rt,Mt,It,Bt;function St(Rr,Ar){if(Rr!==void 0){var Kr=be(Rr);return Kr[0]=Math.round(Kr[0]),Kr[1]=Math.round(Kr[1]),Kr[2]=Math.round(Kr[2]),Ve+=Ar,Ue+=Kr[0]*Ar,Ie+=Kr[1]*Ar,at+=Kr[2]*Ar,Kr}return[0,0,0,0]}function _t(Rr,Ar,Kr,Dn){var Sn=Rr[Kr.bin0];if(Sn===void 0)return St(void 0,1);var Jn=Rr[Kr.bin1],Bn=Ar[Kr.bin0],Xn=Ar[Kr.bin1],ea=Jn-Sn||0,ka=Bn-Sn||0,Ya;return Jn===void 0?Xn===void 0?Ya=0:Bn===void 0?Ya=2*(Xn-Sn):Ya=(2*Xn-Bn-Sn)*2/3:Xn===void 0?Bn===void 0?Ya=0:Ya=(2*Sn-Jn-Bn)*2/3:Bn===void 0?Ya=(2*Xn-Jn-Sn)*2/3:Ya=Xn+Sn-Jn-Bn,St(Sn+Kr.frac*ea+Dn.frac*(ka+Kr.frac*Ya))}if(oe){var it=0,ct;try{ct=new Uint8Array(ne*le*4)}catch{ct=new Array(ne*le*4)}if(oe==="best"){var et=B||F,Pe=U||D,We=new Array(et.length),je=new Array(Pe.length),nt=new Array(ne),kt=B?_:v,wt=U?_:v,Vt,qt,zt;for(W=0;W<et.length;W++)We[W]=Math.round(f.c2p(et[W])-Q);for(W=0;W<Pe.length;W++)je[W]=Math.round(u.c2p(Pe[W])-ee);for(W=0;W<ne;W++)nt[W]=kt(W,We);for(re=0;re<le;re++)for(Vt=wt(re,je),qt=I[Vt.bin0],zt=I[Vt.bin1],W=0;W<ne;W++,it+=4)Bt=_t(qt,zt,nt[W],Vt),l(ct,it,Bt)}else for(re=0;re<se;re++)for(It=I[re],ke=De(re),W=0;W<ne;W++)Bt=St(It[W],1),it=(ke*ne+Le(W))*4,l(ct,it,Bt);var Ht=de.createImageData(ne,le);try{Ht.data.set(ct)}catch{var $t=Ht.data,Qt=$t.length;for(re=0;re<Qt;re++)$t[re]=ct[re]}de.putImageData(Ht,0,0)}else{var fr=Math.floor(z/2),jr=Math.floor(O/2);for(re=0;re<se;re++)if(It=I[re],ke.reverse(),ke[Qe]=De(re+1),!(ke[0]===ke[1]||ke[0]===void 0||ke[1]===void 0))for(Rt=Le(0),pt=[Rt,Rt],W=0;W<q;W++)pt.reverse(),pt[Oe]=Le(W+1),!(pt[0]===pt[1]||pt[0]===void 0||pt[1]===void 0)&&(Mt=It[W],Bt=St(Mt,(pt[1]-pt[0])*(ke[1]-ke[0])),de.fillStyle="rgba("+Bt.join(",")+")",de.fillRect(pt[0]+fr,ke[0]+jr,pt[1]-pt[0]-z,ke[1]-ke[0]-O))}Ue=Math.round(Ue/Ve),Ie=Math.round(Ie/Ve),at=Math.round(at/Ve);var cn=k("rgb("+Ue+","+Ie+","+at+")");y._hmpixcount=(y._hmpixcount||0)+Ve,y._hmlumcount=(y._hmlumcount||0)+Ve*cn.getLuminance();var Qr=o.selectAll("image").data(h);Qr.enter().append("svg:image").attr({xmlns:r.svg,preserveAspectRatio:"none"}),Qr.attr({height:le,width:ne,x:Q,y:ee,"xlink:href":Te.toDataURL("image/png")}),M(o);var lt=R.texttemplate;if(lt){var Gt=i(R),Kt={type:"linear",range:[Gt.min,Gt.max],_separators:f._separators,_numFormat:f._numFormat},Nt=R.type==="histogram2dcontour",gr=R.type==="contour",tt=gr?1:0,we=gr?se-1:se,Me=gr?1:0,Ne=gr?q-1:q,Xe=[];for(W=tt;W<we;W++){var Ke;if(gr)Ke=S.y[W];else if(Nt){if(W===0||W===se-1)continue;Ke=S.y[W]}else if(S.yCenter)Ke=S.yCenter[W];else{if(W+1===se&&S.y[W+1]===void 0)continue;Ke=(S.y[W]+S.y[W+1])/2}var rt=Math.round(u.c2p(Ke));if(!(0>rt||rt>u._length))for(re=Me;re<Ne;re++){var Je;if(gr)Je=S.x[re];else if(Nt){if(re===0||re===q-1)continue;Je=S.x[re]}else if(S.xCenter)Je=S.xCenter[re];else{if(re+1===q&&S.x[re+1]===void 0)continue;Je=(S.x[re]+S.x[re+1])/2}var vt=Math.round(f.c2p(Je));if(!(0>vt||vt>f._length)){var bt=a({x:Je,y:Ke},R,y._fullLayout);bt.x=Je,bt.y=Ke;var Et=S.z[W][re];Et===void 0?(bt.z="",bt.zLabel=""):(bt.z=Et,bt.zLabel=e.tickText(Kt,Et,"hover").text);var Wt=S.text&&S.text[W]&&S.text[W][re];(Wt===void 0||Wt===!1)&&(Wt=""),bt.text=Wt;var Ot=p.texttemplateString(lt,bt,y._fullLayout._d3locale,bt,R._meta||{});if(!!Ot){var ir=Ot.split("<br>"),vr=ir.length,_r=0;for(j=0;j<vr;j++)_r=Math.max(_r,ir[j].length);Xe.push({l:vr,c:_r,t:Ot,x:vt,y:rt,z:Et})}}}}var ln=R.textfont,Cr=ln.family,Gr=ln.size,sn=y._fullLayout.font.size;if(!Gr||Gr==="auto"){var yr=1/0,mr=1/0,Or=0,zr=0;for(j=0;j<Xe.length;j++){var Sr=Xe[j];if(Or=Math.max(Or,Sr.l),zr=Math.max(zr,Sr.c),j<Xe.length-1){var ot=Xe[j+1],Lt=Math.abs(ot.x-Sr.x),Xt=Math.abs(ot.y-Sr.y);Lt&&(yr=Math.min(yr,Lt)),Xt&&(mr=Math.min(mr,Xt))}}!isFinite(yr)||!isFinite(mr)?Gr=sn:(yr-=z,mr-=O,yr/=zr,mr/=Or,yr/=s/2,mr/=s,Gr=Math.min(Math.floor(yr),Math.floor(mr),sn))}if(Gr<=0||!isFinite(Gr))return;var tr=function(Rr){return Rr.x},Lr=function(Rr){return Rr.y-Gr*(Rr.l*s/2-1)},Nr=x(o).data(Xe);Nr.enter().append("g").classed(m,1).append("text").attr("text-anchor","middle").each(function(Rr){var Ar=b.select(this),Kr=ln.color;(!Kr||Kr==="auto")&&(Kr=t.contrast("rgba("+be(Rr.z).join()+")")),Ar.attr("data-notex",1).call(g.positionText,tr(Rr),Lr(Rr)).call(E.font,Cr,Gr,Kr).text(Rr.t).call(g.convertToTspans,y)})}})};function v(y,T){var w=T.length-2,A=p.constrain(p.findBin(y,T),0,w),f=T[A],u=T[A+1],h=p.constrain(A+(y-f)/(u-f)-.5,0,w),o=Math.round(h),S=Math.abs(h-o);return!h||h===w||!S?{bin0:o,bin1:o,frac:0}:{bin0:o,frac:S,bin1:Math.round(o+S/(h-o))}}function _(y,T){var w=T.length-1,A=p.constrain(p.findBin(y,T),0,w),f=T[A],u=T[A+1],h=(y-f)/(u-f)||0;return h<=0?{bin0:A,bin1:A,frac:0}:h<.5?{bin0:A,bin1:A+1,frac:h}:{bin0:A+1,bin1:A,frac:1-h}}function l(y,T,w){y[T]=w[0],y[T+1]=w[1],y[T+2]=w[2],y[T+3]=Math.round(w[3]*255)}},{"../../components/color":366,"../../components/colorscale":378,"../../components/drawing":388,"../../constants/alignment":471,"../../constants/xmlns_namespaces":480,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../registry":638,"../scatter/format_labels":936,"@plotly/d3":58,tinycolor2:312}],805:[function(c,ae,ie){"use strict";var b=c("@plotly/d3");ae.exports=function(P){b.select(P).selectAll(".hm image").style("opacity",function(E){return E.trace.opacity})}},{"@plotly/d3":58}],806:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E){var e=E("zsmooth");e===!1&&(E("xgap"),E("ygap")),E("zhoverformat")}},{}],807:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../../registry");ae.exports=function(g,a,t,i,n,r){var d=t("z");n=n||"x",r=r||"y";var s,m;if(d===void 0||!d.length)return 0;if(k.isArray1D(g.z)){s=t(n),m=t(r);var x=k.minRowLength(s),M=k.minRowLength(m);if(x===0||M===0)return 0;a._length=Math.min(x,M,d.length)}else{if(s=E(n,t),m=E(r,t),!e(d))return 0;t("transpose"),a._length=null}if(g.type==="heatmapgl")return!0;var v=P.getComponentMethod("calendars","handleTraceDefaults");return v(g,a,[n,r],i),!0};function E(p,g){var a=g(p),t=a?g(p+"type","array"):"scaled";return t==="scaled"&&(g(p+"0"),g("d"+p)),a}function e(p){for(var g=!0,a=!1,t=!1,i,n=0;n<p.length;n++){if(i=p[n],!k.isArrayOrTypedArray(i)){g=!1;break}i.length>0&&(a=!0);for(var r=0;r<i.length;r++)if(b(i[r])){t=!0;break}}return g&&a&&t}},{"../../lib":503,"../../registry":638,"fast-isnumeric":190}],808:[function(c,ae,ie){"use strict";for(var b=c("../heatmap/attributes"),k=c("../../components/colorscale/attributes"),P=c("../../lib/extend").extendFlat,E=c("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],p={},g=0;g<e.length;g++){var a=e[g];p[a]=b[a]}p.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},P(p,k("",{cLetter:"z",autoColorDflt:!1})),ae.exports=E(p,"calc","nested")},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../heatmap/attributes":792}],809:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_heatmap2d,k=c("../../plots/cartesian/axes"),P=c("../../lib/str2rgbarray");function E(a,t){this.scene=a,this.uid=t,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=b(a.glplot,this.options),this.heatmap._trace=this}var e=E.prototype;e.handlePick=function(a){var t=this.options,i=t.shape,n=a.pointId,r=n%i[0],d=Math.floor(n/i[0]),s=n;return{trace:this,dataCoord:a.dataCoord,traceCoord:[t.x[r],t.y[d],t.z[s]],textLabel:this.textLabels[n],name:this.name,pointIndex:[d,r],hoverinfo:this.hoverinfo}},e.update=function(a,t){var i=t[0];this.index=a.index,this.name=a.name,this.hoverinfo=a.hoverinfo;var n=i.z;this.options.z=[].concat.apply([],n);var r=n[0].length,d=n.length;this.options.shape=[r,d],this.options.x=i.x,this.options.y=i.y,this.options.zsmooth=a.zsmooth;var s=p(a);this.options.colorLevels=s.colorLevels,this.options.colorValues=s.colorValues,this.textLabels=[].concat.apply([],a.text),this.heatmap.update(this.options);var m=this.scene.xaxis,x=this.scene.yaxis,M,v;a.zsmooth===!1&&(M={ppad:i.x[1]-i.x[0]},v={ppad:i.y[1]-i.y[0]}),a._extremes[m._id]=k.findExtremes(m,i.x,M),a._extremes[x._id]=k.findExtremes(x,i.y,v)},e.dispose=function(){this.heatmap.dispose()};function p(a){for(var t=a.colorscale,i=a.zmin,n=a.zmax,r=t.length,d=new Array(r),s=new Array(4*r),m=0;m<r;m++){var x=t[m],M=P(x[1]);d[m]=i+x[0]*(n-i);for(var v=0;v<4;v++)s[4*m+v]=M[v]}return{colorLevels:d,colorValues:s}}function g(a,t,i){var n=new E(a,t.uid);return n.update(t,i),n}ae.exports=g},{"../../../stackgl_modules":1124,"../../lib/str2rgbarray":528,"../../plots/cartesian/axes":554}],810:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../heatmap/xyz_defaults"),P=c("../../components/colorscale/defaults"),E=c("./attributes");ae.exports=function(p,g,a,t){function i(r,d){return b.coerce(p,g,E,r,d)}var n=k(p,g,i,t);if(!n){g.visible=!1;return}i("text"),i("zsmooth"),P(p,g,t,i,{prefix:"",cLetter:"z"})}},{"../../components/colorscale/defaults":376,"../../lib":503,"../heatmap/xyz_defaults":807,"./attributes":808}],811:[function(c,ae,ie){"use strict";var b=["*heatmapgl* trace is deprecated!","Please consider switching to the *heatmap* or *image* trace types.","Alternatively you could contribute/sponsor rewriting this trace type","based on cartesian features and using regl framework."].join(" ");ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../heatmap/colorbar"),calc:c("../heatmap/calc"),plot:c("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:c("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":596,"../heatmap/calc":793,"../heatmap/colorbar":795,"./attributes":808,"./convert":809,"./defaults":810}],812:[function(c,ae,ie){"use strict";var b=c("../bar/attributes"),k=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,P=c("../../plots/template_attributes").hovertemplateAttrs,E=c("../../plots/template_attributes").texttemplateAttrs,e=c("../../plots/font_attributes"),p=c("./bin_attributes"),g=c("./constants"),a=c("../../lib/extend").extendFlat;ae.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:k("x"),yhoverformat:k("y"),text:a({},b.text,{}),hovertext:a({},b.hovertext,{}),orientation:b.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:p("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:p("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:P({},{keys:g.eventDataKeys}),texttemplate:E({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:a({},b.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:b.insidetextanchor,textangle:b.textangle,cliponaxis:b.cliponaxis,constraintext:b.constraintext,marker:b.marker,offsetgroup:b.offsetgroup,alignmentgroup:b.alignmentgroup,selected:b.selected,unselected:b.unselected,_deprecated:{bardir:b._deprecated.bardir}}},{"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"../bar/attributes":648,"./bin_attributes":814,"./constants":818}],813:[function(c,ae,ie){"use strict";ae.exports=function(k,P){for(var E=k.length,e=0,p=0;p<E;p++)P[p]?(k[p]/=P[p],e+=k[p]):k[p]=null;return e}},{}],814:[function(c,ae,ie){"use strict";ae.exports=function(k,P){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],815:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric");ae.exports={count:function(k,P,E){return E[k]++,1},sum:function(k,P,E,e){var p=e[P];return b(p)?(p=Number(p),E[k]+=p,p):0},avg:function(k,P,E,e,p){var g=e[P];return b(g)&&(g=Number(g),E[k]+=g,p[k]++),0},min:function(k,P,E,e){var p=e[P];if(b(p))if(p=Number(p),b(E[k])){if(E[k]>p){var g=p-E[k];return E[k]=p,g}}else return E[k]=p,p;return 0},max:function(k,P,E,e){var p=e[P];if(b(p))if(p=Number(p),b(E[k])){if(E[k]<p){var g=p-E[k];return E[k]=p,g}}else return E[k]=p,p;return 0}}},{"fast-isnumeric":190}],816:[function(c,ae,ie){"use strict";var b=c("../../constants/numerical"),k=b.ONEAVGYEAR,P=b.ONEAVGMONTH,E=b.ONEDAY,e=b.ONEHOUR,p=b.ONEMIN,g=b.ONESEC,a=c("../../plots/cartesian/axes").tickIncrement;ae.exports=function(s,m,x,M,v){var _=-1.1*m,l=-.1*m,y=s-l,T=x[0],w=x[1],A=Math.min(t(T+l,T+y,M,v),t(w+l,w+y,M,v)),f=Math.min(t(T+_,T+l,M,v),t(w+_,w+l,M,v)),u,h;if(A>f&&f<Math.abs(w-T)/4e3?(u=A,h=!1):(u=Math.min(A,f),h=!0),M.type==="date"&&u>E){var o=u===k?1:6,S=u===k?"M12":"M1";return function(R,z){var O=M.c2d(R,k,v),I=O.indexOf("-",o);I>0&&(O=O.substr(0,I));var F=M.d2c(O,0,v);if(F<R){var D=a(F,S,!1,v);(F+D)/2<R+s&&(F=D)}return z&&h?a(F,S,!0,v):F}}return function(R,z){var O=u*Math.round(R/u);return O+u/10<R&&O+u*.9<R+s&&(O+=u),z&&h&&(O-=u),O}};function t(d,s,m,x){if(d*s<=0)return 1/0;for(var M=Math.abs(s-d),v=m.type==="date",_=i(M,v),l=0;l<10;l++){var y=i(_*80,v);if(_===y)break;if(n(y,d,s,v,m,x))_=y;else break}return _}function i(d,s){return s&&d>g?d>E?d>k*1.1?k:d>P*1.1?P:E:d>e?e:d>p?p:g:Math.pow(10,Math.floor(Math.log(d)/Math.LN10))}function n(d,s,m,x,M,v){if(x&&d>E){var _=r(s,M,v),l=r(m,M,v),y=d===k?0:1;return _[y]!==l[y]}return Math.floor(m/d)-Math.floor(s/d)>.1}function r(d,s,m){var x=s.c2d(d,k,m).split("-");return x[0]===""&&(x.unshift(),x[0]="-"+x[0]),x}},{"../../constants/numerical":479,"../../plots/cartesian/axes":554}],817:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../../registry"),E=c("../../plots/cartesian/axes"),e=c("../bar/arrays_to_calcdata"),p=c("./bin_functions"),g=c("./norm_functions"),a=c("./average"),t=c("./bin_label_vals");function i(m,x){var M=[],v=[],_=x.orientation==="h",l=E.getFromId(m,_?x.yaxis:x.xaxis),y=_?"y":"x",T={x:"y",y:"x"}[y],w=x[y+"calendar"],A=x.cumulative,f,u=n(m,x,l,y),h=u[0],o=u[1],S=typeof h.size=="string",R=[],z=S?R:h,O=[],I=[],F=[],D=0,B=x.histnorm,U=x.histfunc,X=B.indexOf("density")!==-1,oe,se,q;A.enabled&&X&&(B=B.replace(/ ?density$/,""),X=!1);var K=U==="max"||U==="min",G=K?null:0,Q=p.count,V=g[B],H=!1,ee=function(De){return l.r2c(De,0,w)},J;for(k.isArrayOrTypedArray(x[T])&&U!=="count"&&(J=x[T],H=U==="avg",Q=p[U]),f=ee(h.start),se=ee(h.end)+(f-E.tickIncrement(f,h.size,!1,w))/1e6;f<se&&M.length<1e6&&(oe=E.tickIncrement(f,h.size,!1,w),M.push((f+oe)/2),v.push(G),F.push([]),R.push(f),X&&O.push(1/(oe-f)),H&&I.push(0),!(oe<=f));)f=oe;R.push(f),!S&&l.type==="date"&&(z={start:ee(z.start),end:ee(z.end),size:z.size}),m._fullLayout._roundFnOpts||(m._fullLayout._roundFnOpts={});var W=x["_"+y+"bingroup"],re={leftGap:1/0,rightGap:1/0};W&&(m._fullLayout._roundFnOpts[W]||(m._fullLayout._roundFnOpts[W]=re),re=m._fullLayout._roundFnOpts[W]);var j=v.length,Z=!0,ne=re.leftGap,le=re.rightGap,ge={};for(f=0;f<o.length;f++){var pe=o[f];q=k.findBin(pe,z),q>=0&&q<j&&(D+=Q(q,f,v,J,I),Z&&F[q].length&&pe!==o[F[q][0]]&&(Z=!1),F[q].push(f),ge[f]=q,ne=Math.min(ne,pe-R[q]),le=Math.min(le,R[q+1]-pe))}re.leftGap=ne,re.rightGap=le;var xe;Z||(xe=function(De,ye){return function(){var ke=m._fullLayout._roundFnOpts[W];return t(ke.leftGap,ke.rightGap,R,l,w)(De,ye)}}),H&&(D=a(v,I)),V&&V(v,D,O),A.enabled&&s(v,A.direction,A.currentbin);var Ee=Math.min(M.length,v.length),Te=[],de=0,be=Ee-1;for(f=0;f<Ee;f++)if(v[f]){de=f;break}for(f=Ee-1;f>=de;f--)if(v[f]){be=f;break}for(f=de;f<=be;f++)if(b(M[f])&&b(v[f])){var Le={p:M[f],s:v[f],b:0};A.enabled||(Le.pts=F[f],Z?Le.ph0=Le.ph1=F[f].length?o[F[f][0]]:M[f]:(x._computePh=!0,Le.ph0=xe(R[f]),Le.ph1=xe(R[f+1],!0))),Te.push(Le)}return Te.length===1&&(Te[0].width1=E.tickIncrement(Te[0].p,h.size,!1,w)-Te[0].p),e(Te,x),k.isArrayOrTypedArray(x.selectedpoints)&&k.tagSelected(Te,x,ge),Te}function n(m,x,M,v,_){var l=v+"bins",y=m._fullLayout,T=x["_"+v+"bingroup"],w=y._histogramBinOpts[T],A=y.barmode==="overlay",f,u,h,o,S,R,z,O=function(pe){return M.r2c(pe,0,o)},I=function(pe){return M.c2r(pe,0,o)},F=M.type==="date"?function(pe){return pe||pe===0?k.cleanDate(pe,null,o):null}:function(pe){return b(pe)?Number(pe):null};function D(pe,xe,Ee){xe[pe+"Found"]?(xe[pe]=F(xe[pe]),xe[pe]===null&&(xe[pe]=Ee[pe])):(R[pe]=xe[pe]=Ee[pe],k.nestedProperty(u[0],l+"."+pe).set(Ee[pe]))}if(x["_"+v+"autoBinFinished"])delete x["_"+v+"autoBinFinished"];else{u=w.traces;var B=[],U=!0,X=!1,oe=!1;for(f=0;f<u.length;f++)if(h=u[f],h.visible){var se=w.dirs[f];S=h["_"+se+"pos0"]=M.makeCalcdata(h,se),B=k.concat(B,S),delete h["_"+v+"autoBinFinished"],x.visible===!0&&(U?U=!1:(delete h._autoBin,h["_"+v+"autoBinFinished"]=1),P.traceIs(h,"2dMap")&&(X=!0),h.type==="histogram2dcontour"&&(oe=!0))}o=u[0][v+"calendar"];var q=E.autoBin(B,M,w.nbins,X,o,w.sizeFound&&w.size),K=u[0]._autoBin={};if(R=K[w.dirs[0]]={},oe&&(w.size||(q.start=I(E.tickIncrement(O(q.start),q.size,!0,o))),w.end===void 0&&(q.end=I(E.tickIncrement(O(q.end),q.size,!1,o)))),A&&!P.traceIs(x,"2dMap")&&q._dataSpan===0&&M.type!=="category"&&M.type!=="multicategory"){if(_)return[q,S,!0];q=r(m,x,M,v,l)}z=h.cumulative||{},z.enabled&&z.currentbin!=="include"&&(z.direction==="decreasing"?q.start=I(E.tickIncrement(O(q.start),q.size,!0,o)):q.end=I(E.tickIncrement(O(q.end),q.size,!1,o))),w.size=q.size,w.sizeFound||(R.size=q.size,k.nestedProperty(u[0],l+".size").set(q.size)),D("start",w,q),D("end",w,q)}S=x["_"+v+"pos0"],delete x["_"+v+"pos0"];var G=x._input[l]||{},Q=k.extendFlat({},w),V=w.start,H=M.r2l(G.start),ee=H!==void 0;if((w.startFound||ee)&&H!==M.r2l(V)){var J=ee?H:k.aggNums(Math.min,null,S),W={type:M.type==="category"||M.type==="multicategory"?"linear":M.type,r2l:M.r2l,dtick:w.size,tick0:V,calendar:o,range:[J,E.tickIncrement(J,w.size,!1,o)].map(M.l2r)},re=E.tickFirst(W);re>M.r2l(J)&&(re=E.tickIncrement(re,w.size,!0,o)),Q.start=M.l2r(re),ee||k.nestedProperty(x,l+".start").set(Q.start)}var j=w.end,Z=M.r2l(G.end),ne=Z!==void 0;if((w.endFound||ne)&&Z!==M.r2l(j)){var le=ne?Z:k.aggNums(Math.max,null,S);Q.end=M.l2r(le),ne||k.nestedProperty(x,l+".start").set(Q.end)}var ge="autobin"+v;return x._input[ge]===!1&&(x._input[l]=k.extendFlat({},x[l]||{}),delete x._input[ge],delete x[ge]),[Q,S]}function r(m,x,M,v,_){var l=m._fullLayout,y=d(m,x),T=!1,w=1/0,A=[x],f,u,h;for(f=0;f<y.length;f++)if(u=y[f],u===x)T=!0;else if(!T)h=l._histogramBinOpts[u["_"+v+"bingroup"]],w=Math.min(w,h.size||u[_].size);else{var o=n(m,u,M,v,!0),S=o[0],R=o[2];u["_"+v+"autoBinFinished"]=1,u["_"+v+"pos0"]=o[1],R?A.push(u):w=Math.min(w,S.size)}var z=new Array(A.length);for(f=0;f<A.length;f++)for(var O=A[f]["_"+v+"pos0"],I=0;I<O.length;I++)if(O[I]!==void 0){z[f]=O[I];break}for(isFinite(w)||(w=k.distinctVals(z).minDiff),f=0;f<A.length;f++){u=A[f];var F=u[v+"calendar"],D={start:M.c2r(z[f]-w/2,0,F),end:M.c2r(z[f]+w/2,0,F),size:w};u._input[_]=u[_]=D,h=l._histogramBinOpts[u["_"+v+"bingroup"]],h&&k.extendFlat(h,D)}return x[_]}function d(m,x){for(var M=x.xaxis,v=x.yaxis,_=x.orientation,l=[],y=m._fullData,T=0;T<y.length;T++){var w=y[T];w.type==="histogram"&&w.visible===!0&&w.orientation===_&&w.xaxis===M&&w.yaxis===v&&l.push(w)}return l}function s(m,x,M){var v,_,l;function y(w){l=m[w],m[w]/=2}function T(w){_=m[w],m[w]=l+_/2,l+=_}if(M==="half")if(x==="increasing")for(y(0),v=1;v<m.length;v++)T(v);else for(y(m.length-1),v=m.length-2;v>=0;v--)T(v);else if(x==="increasing"){for(v=1;v<m.length;v++)m[v]+=m[v-1];M==="exclude"&&(m.unshift(0),m.pop())}else{for(v=m.length-2;v>=0;v--)m[v]+=m[v+1];M==="exclude"&&(m.push(0),m.shift())}}ae.exports={calc:i,calcAllAutoBins:n}},{"../../lib":503,"../../plots/cartesian/axes":554,"../../registry":638,"../bar/arrays_to_calcdata":647,"./average":813,"./bin_functions":815,"./bin_label_vals":816,"./norm_functions":824,"fast-isnumeric":190}],818:[function(c,ae,ie){"use strict";ae.exports={eventDataKeys:["binNumber"]}},{}],819:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axis_ids"),P=c("../../registry").traceIs,E=c("../bar/defaults").handleGroupingDefaults,e=b.nestedProperty,p=c("../../plots/cartesian/constraints").getAxisGroup,g=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],a=["x","y"];ae.exports=function(i,n){var r=n._histogramBinOpts={},d=[],s={},m=[],x,M,v,_,l,y,T;function w(oe,se){return b.coerce(x._input,x,x._module.attributes,oe,se)}function A(oe){return oe.orientation==="v"?"x":"y"}function f(oe,se){var q=k.getFromTrace({_fullLayout:n},oe,se);return q.type}function u(oe,se,q){var K=oe.uid+"__"+q;se||(se=K);var G=f(oe,q),Q=oe[q+"calendar"]||"",V=r[se],H=!0;V&&(G===V.axType&&Q===V.calendar?(H=!1,V.traces.push(oe),V.dirs.push(q)):(se=K,G!==V.axType&&b.warn(["Attempted to group the bins of trace",oe.index,"set on a","type:"+G,"axis","with bins on","type:"+V.axType,"axis."].join(" ")),Q!==V.calendar&&b.warn(["Attempted to group the bins of trace",oe.index,"set with a",Q,"calendar","with bins",V.calendar?"on a "+V.calendar+" calendar":"w/o a set calendar"].join(" ")))),H&&(r[se]={traces:[oe],dirs:[q],axType:G,calendar:oe[q+"calendar"]||""}),oe["_"+q+"bingroup"]=se}for(l=0;l<i.length;l++)x=i[l],P(x,"histogram")&&(d.push(x),delete x._xautoBinFinished,delete x._yautoBinFinished,P(x,"2dMap")||E(x._input,x,n,w));var h=n._alignmentOpts||{};for(l=0;l<d.length;l++){if(x=d[l],v="",!P(x,"2dMap")){if(_=A(x),n.barmode==="group"&&x.alignmentgroup){var o=x[_+"axis"],S=p(n,o)+x.orientation;(h[S]||{})[x.alignmentgroup]&&(v=S)}!v&&n.barmode!=="overlay"&&(v=p(n,x.xaxis)+p(n,x.yaxis)+A(x))}v?(s[v]||(s[v]=[]),s[v].push(x)):m.push(x)}for(v in s){if(M=s[v],M.length===1){m.push(M[0]);continue}var R=!1;for(M.length&&(x=M[0],R=w("bingroup")),v=R||v,l=0;l<M.length;l++){x=M[l];var z=x._input.bingroup;z&&z!==v&&b.warn(["Trace",x.index,"must match","within bingroup",v+".","Ignoring its bingroup:",z,"setting."].join(" ")),x.bingroup=v,u(x,v,A(x))}}for(l=0;l<m.length;l++){x=m[l];var O=w("bingroup");if(P(x,"2dMap"))for(T=0;T<2;T++){_=a[T];var I=w(_+"bingroup",O?O+"__"+_:null);u(x,I,_)}else u(x,O,A(x))}for(v in r){var F=r[v];for(M=F.traces,y=0;y<g.length;y++){var D=g[y],B=D.name,U,X;if(!(B==="nbins"&&F.sizeFound)){for(l=0;l<M.length;l++){if(x=M[l],_=F.dirs[l],U=D.aStr[_],e(x._input,U).get()!==void 0){F[B]=w(U),F[B+"Found"]=!0;break}X=(x._autoBin||{})[_]||{},X[B]&&e(x,U).set(X[B])}if(B==="start"||B==="end")for(;l<M.length;l++)x=M[l],x["_"+_+"bingroup"]&&(X=(x._autoBin||{})[_]||{},w(U,X[B]));B==="nbins"&&!F.sizeFound&&!F.nbinsFound&&(x=M[0],F[B]=w(U))}}}}},{"../../lib":503,"../../plots/cartesian/axis_ids":558,"../../plots/cartesian/constraints":562,"../../registry":638,"../bar/defaults":652}],820:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("../../components/color"),E=c("../bar/defaults").handleText,e=c("../bar/style_defaults"),p=c("./attributes");ae.exports=function(a,t,i,n){function r(f,u){return k.coerce(a,t,p,f,u)}var d=r("x"),s=r("y"),m=r("cumulative.enabled");m&&(r("cumulative.direction"),r("cumulative.currentbin")),r("text");var x=r("textposition");E(a,t,n,r,x,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),r("hovertext"),r("hovertemplate"),r("xhoverformat"),r("yhoverformat");var M=r("orientation",s&&!d?"h":"v"),v=M==="v"?"x":"y",_=M==="v"?"y":"x",l=d&&s?Math.min(k.minRowLength(d)&&k.minRowLength(s)):k.minRowLength(t[v]||[]);if(!l){t.visible=!1;return}t._length=l;var y=b.getComponentMethod("calendars","handleTraceDefaults");y(a,t,["x","y"],n);var T=t[_];T&&r("histfunc"),r("histnorm"),r("autobin"+v),e(a,t,r,i,n),k.coerceSelectionMarkerOpacity(t,r);var w=(t.marker.line||{}).color,A=b.getComponentMethod("errorbars","supplyDefaults");A(a,t,w||P.defaultLine,{axis:"y"}),A(a,t,w||P.defaultLine,{axis:"x",inherit:"y"})}},{"../../components/color":366,"../../lib":503,"../../registry":638,"../bar/defaults":652,"../bar/style_defaults":663,"./attributes":812}],821:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e,p){if(k.x="xVal"in P?P.xVal:P.x,k.y="yVal"in P?P.yVal:P.y,"zLabelVal"in P&&(k.z=P.zLabelVal),P.xa&&(k.xaxis=P.xa),P.ya&&(k.yaxis=P.ya),!(E.cumulative||{}).enabled){var g=Array.isArray(p)?e[0].pts[p[0]][p[1]]:e[p].pts;k.pointNumbers=g,k.binNumber=k.pointNumber,delete k.pointNumber,delete k.pointIndex;var a;if(E._indexToPoints){a=[];for(var t=0;t<g.length;t++)a=a.concat(E._indexToPoints[g[t]])}else a=g;k.pointIndices=a}return k}},{}],822:[function(c,ae,ie){"use strict";var b=c("../bar/hover").hoverPoints,k=c("../../plots/cartesian/axes").hoverLabelText;ae.exports=function(E,e,p,g,a){var t=b(E,e,p,g,a);if(!!t){E=t[0];var i=E.cd[E.index],n=E.cd[0].trace;if(!n.cumulative.enabled){var r=n.orientation==="h"?"y":"x";E[r+"Label"]=k(E[r+"a"],[i.ph0,i.ph1],n[r+"hoverformat"])}return t}}},{"../../plots/cartesian/axes":554,"../bar/hover":655}],823:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),layoutAttributes:c("../bar/layout_attributes"),supplyDefaults:c("./defaults"),crossTraceDefaults:c("./cross_trace_defaults"),supplyLayoutDefaults:c("../bar/layout_defaults"),calc:c("./calc").calc,crossTraceCalc:c("../bar/cross_trace_calc").crossTraceCalc,plot:c("../bar/plot").plot,layerName:"barlayer",style:c("../bar/style").style,styleOnSelect:c("../bar/style").styleOnSelect,colorbar:c("../scatter/marker_colorbar"),hoverPoints:c("./hover"),selectPoints:c("../bar/select"),eventData:c("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:c("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":568,"../bar/cross_trace_calc":651,"../bar/layout_attributes":657,"../bar/layout_defaults":658,"../bar/plot":659,"../bar/select":660,"../bar/style":662,"../scatter/marker_colorbar":945,"./attributes":812,"./calc":817,"./cross_trace_defaults":819,"./defaults":820,"./event_data":821,"./hover":822}],824:[function(c,ae,ie){"use strict";ae.exports={percent:function(b,k){for(var P=b.length,E=100/k,e=0;e<P;e++)b[e]*=E},probability:function(b,k){for(var P=b.length,E=0;E<P;E++)b[E]/=k},density:function(b,k,P,E){var e=b.length;E=E||1;for(var p=0;p<e;p++)b[p]*=P[p]*E},"probability density":function(b,k,P,E){var e=b.length;E&&(k/=E);for(var p=0;p<e;p++)b[p]*=P[p]/k}}},{}],825:[function(c,ae,ie){"use strict";var b=c("../histogram/attributes"),k=c("../histogram/bin_attributes"),P=c("../heatmap/attributes"),E=c("../../plots/attributes"),e=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,p=c("../../plots/template_attributes").hovertemplateAttrs,g=c("../../plots/template_attributes").texttemplateAttrs,a=c("../../components/colorscale/attributes"),t=c("../../lib/extend").extendFlat;ae.exports=t({x:b.x,y:b.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:b.histnorm,histfunc:b.histfunc,nbinsx:b.nbinsx,xbins:k("x"),nbinsy:b.nbinsy,ybins:k("y"),autobinx:b.autobinx,autobiny:b.autobiny,bingroup:t({},b.bingroup,{}),xbingroup:t({},b.bingroup,{}),ybingroup:t({},b.bingroup,{}),xgap:P.xgap,ygap:P.ygap,zsmooth:P.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:p({},{keys:"z"}),texttemplate:g({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:P.textfont,showlegend:t({},E.showlegend,{dflt:!1})},a("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../heatmap/attributes":792,"../histogram/attributes":812,"../histogram/bin_attributes":814}],826:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("../histogram/bin_functions"),E=c("../histogram/norm_functions"),e=c("../histogram/average"),p=c("../histogram/bin_label_vals"),g=c("../histogram/calc").calcAllAutoBins;ae.exports=function(r,d){var s=k.getFromId(r,d.xaxis),m=k.getFromId(r,d.yaxis),x=d.xcalendar,M=d.ycalendar,v=function(it){return s.r2c(it,0,x)},_=function(it){return m.r2c(it,0,M)},l=function(it){return s.c2r(it,0,x)},y=function(it){return m.c2r(it,0,M)},T,w,A,f,u=g(r,d,s,"x"),h=u[0],o=u[1],S=g(r,d,m,"y"),R=S[0],z=S[1],O=d._length;o.length>O&&o.splice(O,o.length-O),z.length>O&&z.splice(O,z.length-O);var I=[],F=[],D=[],B=typeof h.size=="string",U=typeof R.size=="string",X=[],oe=[],se=B?X:h,q=U?oe:R,K=0,G=[],Q=[],V=d.histnorm,H=d.histfunc,ee=V.indexOf("density")!==-1,J=H==="max"||H==="min",W=J?null:0,re=P.count,j=E[V],Z=!1,ne=[],le=[],ge="z"in d?d.z:"marker"in d&&Array.isArray(d.marker.color)?d.marker.color:"";ge&&H!=="count"&&(Z=H==="avg",re=P[H]);var pe=h.size,xe=v(h.start),Ee=v(h.end)+(xe-k.tickIncrement(xe,pe,!1,x))/1e6;for(T=xe;T<Ee;T=k.tickIncrement(T,pe,!1,x))F.push(W),X.push(T),Z&&D.push(0);X.push(T);var Te=F.length,de=(T-xe)/Te,be=l(xe+de/2),Le=R.size,De=_(R.start),ye=_(R.end)+(De-k.tickIncrement(De,Le,!1,M))/1e6;for(T=De;T<ye;T=k.tickIncrement(T,Le,!1,M)){I.push(F.slice()),oe.push(T);var ke=new Array(Te);for(w=0;w<Te;w++)ke[w]=[];Q.push(ke),Z&&G.push(D.slice())}oe.push(T);var Oe=I.length,Qe=(T-De)/Oe,Ve=y(De+Qe/2);ee&&(ne=a(F.length,se,de,B),le=a(I.length,q,Qe,U)),!B&&s.type==="date"&&(se=t(v,se)),!U&&m.type==="date"&&(q=t(_,q));var Ue=!0,Ie=!0,at=new Array(Te),pt=new Array(Oe),Rt=1/0,Mt=1/0,It=1/0,Bt=1/0;for(T=0;T<O;T++){var St=o[T],_t=z[T];A=b.findBin(St,se),f=b.findBin(_t,q),A>=0&&A<Te&&f>=0&&f<Oe&&(K+=re(A,T,I[f],ge,G[f]),Q[f][A].push(T),Ue&&(at[A]===void 0?at[A]=St:at[A]!==St&&(Ue=!1)),Ie&&(pt[f]===void 0?pt[f]=_t:pt[f]!==_t&&(Ie=!1)),Rt=Math.min(Rt,St-X[A]),Mt=Math.min(Mt,X[A+1]-St),It=Math.min(It,_t-oe[f]),Bt=Math.min(Bt,oe[f+1]-_t))}if(Z)for(f=0;f<Oe;f++)K+=e(I[f],G[f]);if(j)for(f=0;f<Oe;f++)j(I[f],K,ne,le[f]);return{x:o,xRanges:i(X,Ue&&at,Rt,Mt,s,x),x0:be,dx:de,y:z,yRanges:i(oe,Ie&&pt,It,Bt,m,M),y0:Ve,dy:Qe,z:I,pts:Q}};function a(n,r,d,s){var m=new Array(n),x;if(s)for(x=0;x<n;x++)m[x]=1/(r[x+1]-r[x]);else{var M=1/d;for(x=0;x<n;x++)m[x]=M}return m}function t(n,r){return{start:n(r.start),end:n(r.end),size:r.size}}function i(n,r,d,s,m,x){var M,v=n.length-1,_=new Array(v),l=p(d,s,n,m,x);for(M=0;M<v;M++){var y=(r||[])[M];_[M]=y===void 0?[l(n[M]),l(n[M+1],!0)]:[y,y]}return _}},{"../../lib":503,"../../plots/cartesian/axes":554,"../histogram/average":813,"../histogram/bin_functions":815,"../histogram/bin_label_vals":816,"../histogram/calc":817,"../histogram/norm_functions":824}],827:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./sample_defaults"),P=c("../heatmap/style_defaults"),E=c("../../components/colorscale/defaults"),e=c("../heatmap/label_defaults"),p=c("./attributes");ae.exports=function(a,t,i,n){function r(d,s){return b.coerce(a,t,p,d,s)}k(a,t,r,n),t.visible!==!1&&(P(a,t,r,n),E(a,t,n,r,{prefix:"",cLetter:"z"}),r("hovertemplate"),e(r,n),r("xhoverformat"),r("yhoverformat"))}},{"../../components/colorscale/defaults":376,"../../lib":503,"../heatmap/label_defaults":802,"../heatmap/style_defaults":806,"./attributes":825,"./sample_defaults":830}],828:[function(c,ae,ie){"use strict";var b=c("../heatmap/hover"),k=c("../../plots/cartesian/axes").hoverLabelText;ae.exports=function(E,e,p,g,a){var t=b(E,e,p,g,a);if(!!t){E=t[0];var i=E.index,n=i[0],r=i[1],d=E.cd[0],s=d.trace,m=d.xRanges[r],x=d.yRanges[n];return E.xLabel=k(E.xa,[m[0],m[1]],s.xhoverformat),E.yLabel=k(E.ya,[x[0],x[1]],s.yhoverformat),t}}},{"../../plots/cartesian/axes":554,"../heatmap/hover":799}],829:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),crossTraceDefaults:c("../histogram/cross_trace_defaults"),calc:c("../heatmap/calc"),plot:c("../heatmap/plot"),layerName:"heatmaplayer",colorbar:c("../heatmap/colorbar"),style:c("../heatmap/style"),hoverPoints:c("./hover"),eventData:c("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":568,"../heatmap/calc":793,"../heatmap/colorbar":795,"../heatmap/plot":804,"../heatmap/style":805,"../histogram/cross_trace_defaults":819,"../histogram/event_data":821,"./attributes":825,"./defaults":827,"./hover":828}],830:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib");ae.exports=function(E,e,p,g){var a=p("x"),t=p("y"),i=k.minRowLength(a),n=k.minRowLength(t);if(!i||!n){e.visible=!1;return}e._length=Math.min(i,n);var r=b.getComponentMethod("calendars","handleTraceDefaults");r(E,e,["x","y"],g);var d=p("z")||p("marker.color");d&&p("histfunc"),p("histnorm"),p("autobinx"),p("autobiny")}},{"../../lib":503,"../../registry":638}],831:[function(c,ae,ie){"use strict";var b=c("../histogram2d/attributes"),k=c("../contour/attributes"),P=c("../../components/colorscale/attributes"),E=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=c("../../lib/extend").extendFlat;ae.exports=e({x:b.x,y:b.y,z:b.z,marker:b.marker,histnorm:b.histnorm,histfunc:b.histfunc,nbinsx:b.nbinsx,xbins:b.xbins,nbinsy:b.nbinsy,ybins:b.ybins,autobinx:b.autobinx,autobiny:b.autobiny,bingroup:b.bingroup,xbingroup:b.xbingroup,ybingroup:b.ybingroup,autocontour:k.autocontour,ncontours:k.ncontours,contours:k.contours,line:{color:k.line.color,width:e({},k.line.width,{dflt:.5}),dash:k.line.dash,smoothing:k.line.smoothing,editType:"plot"},xhoverformat:E("x"),yhoverformat:E("y"),zhoverformat:E("z",1),hovertemplate:b.hovertemplate,texttemplate:k.texttemplate,textfont:k.textfont},P("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../contour/attributes":735,"../histogram2d/attributes":825}],832:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../histogram2d/sample_defaults"),P=c("../contour/contours_defaults"),E=c("../contour/style_defaults"),e=c("../heatmap/label_defaults"),p=c("./attributes");ae.exports=function(a,t,i,n){function r(s,m){return b.coerce(a,t,p,s,m)}function d(s){return b.coerce2(a,t,p,s)}k(a,t,r,n),t.visible!==!1&&(P(a,t,r,d),E(a,t,r,n),r("xhoverformat"),r("yhoverformat"),r("hovertemplate"),t.contours&&t.contours.coloring==="heatmap"&&e(r,n))}},{"../../lib":503,"../contour/contours_defaults":742,"../contour/style_defaults":756,"../heatmap/label_defaults":802,"../histogram2d/sample_defaults":830,"./attributes":831}],833:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),crossTraceDefaults:c("../histogram/cross_trace_defaults"),calc:c("../contour/calc"),plot:c("../contour/plot").plot,layerName:"contourlayer",style:c("../contour/style"),colorbar:c("../contour/colorbar"),hoverPoints:c("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":568,"../contour/calc":736,"../contour/colorbar":738,"../contour/hover":748,"../contour/plot":753,"../contour/style":755,"../histogram/cross_trace_defaults":819,"./attributes":831,"./defaults":832}],834:[function(c,ae,ie){"use strict";var b=c("../../plots/template_attributes").hovertemplateAttrs,k=c("../../plots/template_attributes").texttemplateAttrs,P=c("../../components/colorscale/attributes"),E=c("../../plots/domain").attributes,e=c("../pie/attributes"),p=c("../sunburst/attributes"),g=c("../treemap/attributes"),a=c("../treemap/constants"),t=c("../../lib/extend").extendFlat;ae.exports={labels:p.labels,parents:p.parents,values:p.values,branchvalues:p.branchvalues,count:p.count,level:p.level,maxdepth:p.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:g.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:t({colors:p.marker.colors,line:p.marker.line,editType:"calc"},P("marker",{colorAttr:"colors",anim:!1})),leaf:p.leaf,pathbar:g.pathbar,text:e.text,textinfo:p.textinfo,texttemplate:k({editType:"plot"},{keys:a.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:p.hoverinfo,hovertemplate:b({},{keys:a.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:g.outsidetextfont,textposition:g.textposition,sort:e.sort,root:p.root,domain:E({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":901,"../sunburst/attributes":1049,"../treemap/attributes":1075,"../treemap/constants":1078}],835:[function(c,ae,ie){"use strict";var b=c("../../plots/plots");ie.name="icicle",ie.plot=function(k,P,E,e){b.plotBasePlot(ie.name,k,P,E,e)},ie.clean=function(k,P,E,e){b.cleanBasePlot(ie.name,k,P,E,e)}},{"../../plots/plots":619}],836:[function(c,ae,ie){"use strict";var b=c("../sunburst/calc");ie.calc=function(k,P){return b.calc(k,P)},ie.crossTraceCalc=function(k){return b._runCrossTraceCalc("icicle",k)}},{"../sunburst/calc":1051}],837:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("../../components/color"),E=c("../../plots/domain").defaults,e=c("../bar/defaults").handleText,p=c("../bar/constants").TEXTPAD,g=c("../../components/colorscale"),a=g.hasColorscale,t=g.handleDefaults;ae.exports=function(n,r,d,s){function m(A,f){return b.coerce(n,r,k,A,f)}var x=m("labels"),M=m("parents");if(!x||!x.length||!M||!M.length){r.visible=!1;return}var v=m("values");v&&v.length?m("branchvalues"):m("count"),m("level"),m("maxdepth"),m("tiling.orientation"),m("tiling.flip"),m("tiling.pad");var _=m("text");m("texttemplate"),r.texttemplate||m("textinfo",Array.isArray(_)?"text+label":"label"),m("hovertext"),m("hovertemplate");var l=m("pathbar.visible"),y="auto";e(n,r,s,m,y,{hasPathbar:l,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),m("textposition");var T=m("marker.line.width");T&&m("marker.line.color",s.paper_bgcolor),m("marker.colors");var w=r._hasColorscale=a(n,"marker","colors")||(n.marker||{}).coloraxis;w&&t(n,r,s,m,{prefix:"marker.",cLetter:"c"}),m("leaf.opacity",w?1:.7),r._hovered={marker:{line:{width:2,color:P.contrast(s.paper_bgcolor)}}},l&&(m("pathbar.thickness",r.pathbar.textfont.size+2*p),m("pathbar.side"),m("pathbar.edgeshape")),m("sort"),m("root.color"),E(r,s,m),r._length=null}},{"../../components/color":366,"../../components/colorscale":378,"../../lib":503,"../../plots/domain":584,"../bar/constants":650,"../bar/defaults":652,"./attributes":834}],838:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../components/drawing"),E=c("../../lib/svg_text_utils"),e=c("./partition"),p=c("./style").styleOne,g=c("../treemap/constants"),a=c("../sunburst/helpers"),t=c("../sunburst/fx"),i=c("../sunburst/plot").formatSliceLabel,n=!1;ae.exports=function(d,s,m,x,M){var v=M.width,_=M.height,l=M.viewX,y=M.viewY,T=M.pathSlice,w=M.toMoveInsideSlice,A=M.strTransform,f=M.hasTransition,u=M.handleSlicesExit,h=M.makeUpdateSliceInterpolator,o=M.makeUpdateTextInterpolator,S=M.prevEntry,R={},z=d._fullLayout,O=s[0],I=O.trace,F=I.textposition.indexOf("left")!==-1,D=I.textposition.indexOf("right")!==-1,B=I.textposition.indexOf("bottom")!==-1,U=e(m,[v,_],{flipX:I.tiling.flip.indexOf("x")>-1,flipY:I.tiling.flip.indexOf("y")>-1,orientation:I.tiling.orientation,pad:{inner:I.tiling.pad},maxDepth:I._maxDepth}),X=U.descendants(),oe=1/0,se=-1/0;X.forEach(function(V){var H=V.depth;H>=I._maxDepth?(V.x0=V.x1=(V.x0+V.x1)/2,V.y0=V.y1=(V.y0+V.y1)/2):(oe=Math.min(oe,H),se=Math.max(se,H))}),x=x.data(X,a.getPtId),I._maxVisibleLayers=isFinite(se)?se-oe+1:0,x.enter().append("g").classed("slice",!0),u(x,n,R,[v,_],T),x.order();var q=null;if(f&&S){var K=a.getPtId(S);x.each(function(V){q===null&&a.getPtId(V)===K&&(q={x0:V.x0,x1:V.x1,y0:V.y0,y1:V.y1})})}var G=function(){return q||{x0:0,x1:v,y0:0,y1:_}},Q=x;return f&&(Q=Q.transition().each("end",function(){var V=b.select(this);a.setSliceCursor(V,d,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),Q.each(function(V){V._x0=l(V.x0),V._x1=l(V.x1),V._y0=y(V.y0),V._y1=y(V.y1),V._hoverX=l(V.x1-I.tiling.pad),V._hoverY=y(B?V.y1-I.tiling.pad/2:V.y0+I.tiling.pad/2);var H=b.select(this),ee=k.ensureSingle(H,"path","surface",function(j){j.style("pointer-events","all")});f?ee.transition().attrTween("d",function(j){var Z=h(j,n,G(),[v,_],{orientation:I.tiling.orientation,flipX:I.tiling.flip.indexOf("x")>-1,flipY:I.tiling.flip.indexOf("y")>-1});return function(ne){return T(Z(ne))}}):ee.attr("d",T),H.call(t,m,d,s,{styleOne:p,eventDataKeys:g.eventDataKeys,transitionTime:g.CLICK_TRANSITION_TIME,transitionEasing:g.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,d,{isTransitioning:d._transitioning}),ee.call(p,V,I,{hovered:!1}),V.x0===V.x1||V.y0===V.y1?V._text="":V._text=i(V,m,I,s,z)||"";var J=k.ensureSingle(H,"g","slicetext"),W=k.ensureSingle(J,"text","",function(j){j.attr("data-notex",1)}),re=k.ensureUniformFontSize(d,a.determineTextFont(I,V,z.font));W.text(V._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":F?"start":"middle").call(P.font,re).call(E.convertToTspans,d),V.textBB=P.bBox(W.node()),V.transform=w(V,{fontSize:re.size}),V.transform.fontSize=re.size,f?W.transition().attrTween("transform",function(j){var Z=o(j,n,G(),[v,_]);return function(ne){return A(Z(ne))}}):W.attr("transform",A(V))}),q}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../sunburst/fx":1054,"../sunburst/helpers":1055,"../sunburst/plot":1059,"../treemap/constants":1078,"./partition":842,"./style":844,"@plotly/d3":58}],839:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"icicle",basePlotModule:c("./base_plot"),categories:[],animatable:!0,attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults"),supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc").calc,crossTraceCalc:c("./calc").crossTraceCalc,plot:c("./plot"),style:c("./style").style,colorbar:c("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":945,"./attributes":834,"./base_plot":835,"./calc":836,"./defaults":837,"./layout_attributes":840,"./layout_defaults":841,"./plot":843,"./style":844}],840:[function(c,ae,ie){"use strict";ae.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],841:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(E,e){function p(g,a){return b.coerce(E,e,k,g,a)}p("iciclecolorway",e.colorway),p("extendiciclecolors")}},{"../../lib":503,"./layout_attributes":840}],842:[function(c,ae,ie){"use strict";var b=c("d3-hierarchy"),k=c("../treemap/flip_tree");ae.exports=function(E,e,p){var g=p.flipX,a=p.flipY,t=p.orientation==="h",i=p.maxDepth,n=e[0],r=e[1];i&&(n=(E.height+1)*e[0]/Math.min(E.height+1,i),r=(E.height+1)*e[1]/Math.min(E.height+1,i));var d=b.partition().padding(p.pad.inner).size(t?[e[1],n]:[e[0],r])(E);return(t||g||a)&&k(d,e,{swapXY:t,flipX:g,flipY:a}),d}},{"../treemap/flip_tree":1083,"d3-hierarchy":115}],843:[function(c,ae,ie){"use strict";var b=c("../treemap/draw"),k=c("./draw_descendants");ae.exports=function(E,e,p,g){return b(E,e,p,g,{type:"icicle",drawDescendants:k})}},{"../treemap/draw":1080,"./draw_descendants":838}],844:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/color"),P=c("../../lib"),E=c("../bar/uniform_text").resizeText;function e(g){var a=g._fullLayout._iciclelayer.selectAll(".trace");E(g,a,"icicle"),a.each(function(t){var i=b.select(this),n=t[0],r=n.trace;i.style("opacity",r.opacity),i.selectAll("path.surface").each(function(d){b.select(this).call(p,d,r)})})}function p(g,a,t){var i=a.data.data,n=!a.children,r=i.i,d=P.castOption(t,r,"marker.line.color")||k.defaultLine,s=P.castOption(t,r,"marker.line.width")||0;g.style("stroke-width",s).call(k.fill,i.color).call(k.stroke,d).style("opacity",n?t.leaf.opacity:null)}ae.exports={style:e,styleOne:p}},{"../../components/color":366,"../../lib":503,"../bar/uniform_text":664,"@plotly/d3":58}],845:[function(c,ae,ie){"use strict";for(var b=c("../../plots/attributes"),k=c("../../plots/template_attributes").hovertemplateAttrs,P=c("../../lib/extend").extendFlat,E=c("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],p=[],g=[],a=0;a<e.length;a++){var t=E[e[a]];p.push("For the `"+e[a]+"` colormodel, it is ["+(t.zminDflt||t.min).join(", ")+"]."),g.push("For the `"+e[a]+"` colormodel, it is ["+(t.zmaxDflt||t.max).join(", ")+"].")}ae.exports=P({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:P({},b.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:k({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"./constants":847}],846:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./constants"),P=c("fast-isnumeric"),E=c("../../plots/cartesian/axes"),e=c("../../lib").maxRowLength,p=c("./helpers").getImageSize;ae.exports=function(n,r){var d,s;if(r._hasZ)d=r.z.length,s=e(r.z);else if(r._hasSource){var m=p(r.source);d=m.height,s=m.width}var x=E.getFromId(n,r.xaxis||"x"),M=E.getFromId(n,r.yaxis||"y"),v=x.d2c(r.x0)-r.dx/2,_=M.d2c(r.y0)-r.dy/2,l,y=[v,v+s*r.dx],T=[_,_+d*r.dy];if(x&&x.type==="log")for(l=0;l<s;l++)y.push(v+l*r.dx);if(M&&M.type==="log")for(l=0;l<d;l++)T.push(_+l*r.dy);r._extremes[x._id]=E.findExtremes(x,y),r._extremes[M._id]=E.findExtremes(M,T),r._scaler=t(r);var w={x0:v,y0:_,z:r.z,w:s,h:d};return[w]};function g(i,n,r,d){return function(s){return b.constrain((s-i)*n,r,d)}}function a(i,n){return function(r){return b.constrain(r,i,n)}}function t(i){var n=k.colormodel[i.colormodel],r=n.colormodel||i.colormodel,d=r.length;i._sArray=[];for(var s=0;s<d;s++)n.min[s]!==i.zmin[s]||n.max[s]!==i.zmax[s]?i._sArray.push(g(i.zmin[s],(n.max[s]-n.min[s])/(i.zmax[s]-i.zmin[s]),n.min[s],n.max[s])):i._sArray.push(a(n.min[s],n.max[s]));return function(m){for(var x=m.slice(0,d),M=0;M<d;M++){var v=x[M];if(!P(v))return!1;x[M]=i._sArray[M](v)}return x}}},{"../../lib":503,"../../plots/cartesian/axes":554,"./constants":847,"./helpers":850,"fast-isnumeric":190}],847:[function(c,ae,ie){"use strict";ae.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(b){return b.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(b){return b.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(b){return b.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(b){var k=b.slice(0,3);return k[1]=k[1]+"%",k[2]=k[2]+"%",k},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(b){var k=b.slice(0,4);return k[1]=k[1]+"%",k[2]=k[2]+"%",k},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],848:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("./constants"),E=c("../../snapshot/helpers").IMAGE_URL_PREFIX;ae.exports=function(p,g){function a(n,r){return b.coerce(p,g,k,n,r)}a("source"),g.source&&!g.source.match(E)&&delete g.source,g._hasSource=!!g.source;var t=a("z");if(g._hasZ=!(t===void 0||!t.length||!t[0]||!t[0].length),!g._hasZ&&!g._hasSource){g.visible=!1;return}a("x0"),a("y0"),a("dx"),a("dy");var i;g._hasZ?(a("colormodel","rgb"),i=P.colormodel[g.colormodel],a("zmin",i.zminDflt||i.min),a("zmax",i.zmaxDflt||i.max)):g._hasSource&&(g.colormodel="rgba256",i=P.colormodel[g.colormodel],g.zmin=i.zminDflt,g.zmax=i.zmaxDflt),a("zsmooth"),a("text"),a("hovertext"),a("hovertemplate"),g._length=null}},{"../../lib":503,"../../snapshot/helpers":642,"./attributes":845,"./constants":847}],849:[function(c,ae,ie){"use strict";ae.exports=function(k,P){return"xVal"in P&&(k.x=P.xVal),"yVal"in P&&(k.y=P.yVal),P.xa&&(k.xaxis=P.xa),P.ya&&(k.yaxis=P.ya),k.color=P.color,k.colormodel=P.trace.colormodel,k.z||(k.z=P.color),k}},{}],850:[function(c,ae,ie){"use strict";var b=c("probe-image-size/sync"),k=c("../../snapshot/helpers").IMAGE_URL_PREFIX,P=c("buffer/").Buffer;ie.getImageSize=function(E){var e=E.replace(k,""),p=new P(e,"base64");return b(p)}},{"../../snapshot/helpers":642,"buffer/":85,"probe-image-size/sync":276}],851:[function(c,ae,ie){"use strict";var b=c("../../components/fx"),k=c("../../lib"),P=c("./constants");ae.exports=function(e,p,g){var a=e.cd[0],t=a.trace,i=e.xa,n=e.ya;if(!(b.inbox(p-a.x0,p-(a.x0+a.w*t.dx),0)>0||b.inbox(g-a.y0,g-(a.y0+a.h*t.dy),0)>0)){var r=Math.floor((p-a.x0)/t.dx),d=Math.floor(Math.abs(g-a.y0)/t.dy),s;if(t._hasZ?s=a.z[d][r]:t._hasSource&&(s=t._canvas.el.getContext("2d").getImageData(r,d,1,1).data),!!s){var m=a.hi||t.hoverinfo,x;if(m){var M=m.split("+");M.indexOf("all")!==-1&&(M=["color"]),M.indexOf("color")!==-1&&(x=!0)}var v=P.colormodel[t.colormodel],_=v.colormodel||t.colormodel,l=_.length,y=t._scaler(s),T=v.suffix,w=[];(t.hovertemplate||x)&&(w.push("["+[y[0]+T[0],y[1]+T[1],y[2]+T[2]].join(", ")),l===4&&w.push(", "+y[3]+T[3]),w.push("]"),w=w.join(""),e.extraText=_.toUpperCase()+": "+w);var A;Array.isArray(t.hovertext)&&Array.isArray(t.hovertext[d])?A=t.hovertext[d][r]:Array.isArray(t.text)&&Array.isArray(t.text[d])&&(A=t.text[d][r]);var f=n.c2p(a.y0+(d+.5)*t.dy),u=a.x0+(r+.5)*t.dx,h=a.y0+(d+.5)*t.dy,o="["+s.slice(0,t.colormodel.length).join(", ")+"]";return[k.extendFlat(e,{index:[d,r],x0:i.c2p(a.x0+r*t.dx),x1:i.c2p(a.x0+(r+1)*t.dx),y0:f,y1:f,color:y,xVal:u,xLabelVal:u,yVal:h,yLabelVal:h,zLabelVal:o,text:A,hovertemplateLabels:{zLabel:o,colorLabel:w,"color[0]Label":y[0]+T[0],"color[1]Label":y[1]+T[1],"color[2]Label":y[2]+T[2],"color[3]Label":y[3]+T[3]}})]}}}},{"../../components/fx":406,"../../lib":503,"./constants":847}],852:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("./calc"),plot:c("./plot"),style:c("./style"),hoverPoints:c("./hover"),eventData:c("./event_data"),moduleType:"trace",name:"image",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":568,"./attributes":845,"./calc":846,"./defaults":848,"./event_data":849,"./hover":851,"./plot":853,"./style":854}],853:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=k.strTranslate,E=c("../../constants/xmlns_namespaces"),e=c("./constants"),p=k.isIOS()||k.isSafari()||k.isIE();ae.exports=function(a,t,i,n){var r=t.xaxis,d=t.yaxis,s=!(p||a._context._exportedPlot);k.makeTraceGroups(n,i,"im").each(function(m){var x=b.select(this),M=m[0],v=M.trace,_=(v.zsmooth==="fast"||v.zsmooth===!1&&s)&&!v._hasZ&&v._hasSource&&r.type==="linear"&&d.type==="linear";v._realImage=_;var l=M.z,y=M.x0,T=M.y0,w=M.w,A=M.h,f=v.dx,u=v.dy,h,o,S,R,z,O;for(O=0;h===void 0&&O<w;)h=r.c2p(y+O*f),O++;for(O=w;o===void 0&&O>0;)o=r.c2p(y+O*f),O--;for(O=0;R===void 0&&O<A;)R=d.c2p(T+O*u),O++;for(O=A;z===void 0&&O>0;)z=d.c2p(T+O*u),O--;if(o<h&&(S=o,o=h,h=S),z<R&&(S=R,R=z,z=S),!_){var I=.5;h=Math.max(-I*r._length,h),o=Math.min((1+I)*r._length,o),R=Math.max(-I*d._length,R),z=Math.min((1+I)*d._length,z)}var F=Math.round(o-h),D=Math.round(z-R),B=F<=0||D<=0;if(B){var U=x.selectAll("image").data([]);U.exit().remove();return}function X(J){var W=document.createElement("canvas");W.width=F,W.height=D;var re=W.getContext("2d"),j=function(Le){return k.constrain(Math.round(r.c2p(y+Le*f)-h),0,F)},Z=function(Le){return k.constrain(Math.round(d.c2p(T+Le*u)-R),0,D)},ne=e.colormodel[v.colormodel],le=ne.colormodel||v.colormodel,ge=ne.fmt,pe;for(O=0;O<M.w;O++){var xe=j(O),Ee=j(O+1);if(!(Ee===xe||isNaN(Ee)||isNaN(xe)))for(var Te=0;Te<M.h;Te++){var de=Z(Te),be=Z(Te+1);be===de||isNaN(be)||isNaN(de)||!J(O,Te)||(pe=v._scaler(J(O,Te)),pe?re.fillStyle=le+"("+ge(pe).join(",")+")":re.fillStyle="rgba(0,0,0,0)",re.fillRect(xe,de,Ee-xe,be-de))}}return W}var oe=x.selectAll("image").data([m]);oe.enter().append("svg:image").attr({xmlns:E.svg,preserveAspectRatio:"none"}),oe.exit().remove();var se=v.zsmooth===!1?e.pixelatedStyle:"";if(_){var q=k.simpleMap(r.range,r.r2l),K=k.simpleMap(d.range,d.r2l),G=q[1]<q[0],Q=K[1]>K[0];if(G||Q){var V=h+F/2,H=R+D/2;se+="transform:"+P(V+"px",H+"px")+"scale("+(G?-1:1)+","+(Q?-1:1)+")"+P(-V+"px",-H+"px")+";"}}oe.attr("style",se);var ee=new Promise(function(J){if(v._hasZ)J();else if(v._hasSource)if(v._canvas&&v._canvas.el.width===w&&v._canvas.el.height===A&&v._canvas.source===v.source)J();else{var W=document.createElement("canvas");W.width=w,W.height=A;var re=W.getContext("2d");v._image=v._image||new Image;var j=v._image;j.onload=function(){re.drawImage(j,0,0),v._canvas={el:W,source:v.source},J()},j.setAttribute("src",v.source)}}).then(function(){var J,W;if(v._hasZ)W=X(function(Z,ne){return l[ne][Z]}),J=W.toDataURL("image/png");else if(v._hasSource)if(_)J=v.source;else{var re=v._canvas.el.getContext("2d"),j=re.getImageData(0,0,w,A).data;W=X(function(Z,ne){var le=4*(ne*w+Z);return[j[le],j[le+1],j[le+2],j[le+3]]}),J=W.toDataURL("image/png")}oe.attr({"xlink:href":J,height:D,width:F,x:h,y:R})});a._promises.push(ee)})}},{"../../constants/xmlns_namespaces":480,"../../lib":503,"./constants":847,"@plotly/d3":58}],854:[function(c,ae,ie){"use strict";var b=c("@plotly/d3");ae.exports=function(P){b.select(P).selectAll(".im image").style("opacity",function(E){return E[0].trace.opacity})}},{"@plotly/d3":58}],855:[function(c,ae,ie){"use strict";var b=c("../../lib/extend").extendFlat,k=c("../../lib/extend").extendDeep,P=c("../../plot_api/edit_types").overrideAll,E=c("../../plots/font_attributes"),e=c("../../components/color/attributes"),p=c("../../plots/domain").attributes,g=c("../../plots/cartesian/layout_attributes"),a=c("../../plot_api/plot_template").templatedArray,t=c("../../constants/delta.js"),i=c("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,n=E({editType:"plot",colorEditType:"plot"}),r={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},d={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},s=a("step",k({},r,{range:d}));ae.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:p({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:b({},n,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:i("value")},font:b({},n,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:i("value")},increasing:{symbol:{valType:"string",dflt:t.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:t.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:t.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:b({},n,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:k({},r,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:P({range:d,visible:b({},g.visible,{dflt:!0}),tickmode:g.tickmode,nticks:g.nticks,tick0:g.tick0,dtick:g.dtick,tickvals:g.tickvals,ticktext:g.ticktext,ticks:b({},g.ticks,{dflt:"outside"}),ticklen:g.ticklen,tickwidth:g.tickwidth,tickcolor:g.tickcolor,ticklabelstep:g.ticklabelstep,showticklabels:g.showticklabels,tickfont:E({}),tickangle:g.tickangle,tickformat:g.tickformat,tickformatstops:g.tickformatstops,tickprefix:g.tickprefix,showtickprefix:g.showtickprefix,ticksuffix:g.ticksuffix,showticksuffix:g.showticksuffix,separatethousands:g.separatethousands,exponentformat:g.exponentformat,minexponent:g.minexponent,showexponent:g.showexponent,editType:"plot"},"plot"),steps:s,threshold:{line:{color:b({},r.line.color,{}),width:b({},r.line.width,{dflt:1}),editType:"plot"},thickness:b({},r.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":365,"../../constants/delta.js":473,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_format_attributes":557,"../../plots/cartesian/layout_attributes":569,"../../plots/domain":584,"../../plots/font_attributes":585}],856:[function(c,ae,ie){"use strict";var b=c("../../plots/plots");ie.name="indicator",ie.plot=function(k,P,E,e){b.plotBasePlot(ie.name,k,P,E,e)},ie.clean=function(k,P,E,e){b.cleanBasePlot(ie.name,k,P,E,e)}},{"../../plots/plots":619}],857:[function(c,ae,ie){"use strict";function b(k,P){var E=[],e=P.value;typeof P._lastValue!="number"&&(P._lastValue=P.value);var p=P._lastValue,g=p;return P._hasDelta&&typeof P.delta.reference=="number"&&(g=P.delta.reference),E[0]={y:e,lastY:p,delta:e-g,relativeDelta:(e-g)/g},E}ae.exports={calc:b}},{}],858:[function(c,ae,ie){"use strict";ae.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],859:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("../../plots/domain").defaults,E=c("../../plot_api/plot_template"),e=c("../../plots/array_container_defaults"),p=c("./constants.js"),g=c("../../plots/cartesian/tick_value_defaults"),a=c("../../plots/cartesian/tick_mark_defaults"),t=c("../../plots/cartesian/tick_label_defaults"),i=c("../../plots/cartesian/prefix_suffix_defaults");function n(d,s,m,x){function M(O,I){return b.coerce(d,s,k,O,I)}P(s,x,M),M("mode"),s._hasNumber=s.mode.indexOf("number")!==-1,s._hasDelta=s.mode.indexOf("delta")!==-1,s._hasGauge=s.mode.indexOf("gauge")!==-1;var v=M("value");s._range=[0,typeof v=="number"?1.5*v:1];var _=new Array(2),l;s._hasNumber&&(M("number.valueformat"),M("number.font.color",x.font.color),M("number.font.family",x.font.family),M("number.font.size"),s.number.font.size===void 0&&(s.number.font.size=p.defaultNumberFontSize,_[0]=!0),M("number.prefix"),M("number.suffix"),l=s.number.font.size);var y;s._hasDelta&&(M("delta.font.color",x.font.color),M("delta.font.family",x.font.family),M("delta.font.size"),s.delta.font.size===void 0&&(s.delta.font.size=(s._hasNumber?.5:1)*(l||p.defaultNumberFontSize),_[1]=!0),M("delta.reference",s.value),M("delta.relative"),M("delta.valueformat",s.delta.relative?"2%":""),M("delta.increasing.symbol"),M("delta.increasing.color"),M("delta.decreasing.symbol"),M("delta.decreasing.color"),M("delta.position"),y=s.delta.font.size),s._scaleNumbers=(!s._hasNumber||_[0])&&(!s._hasDelta||_[1])||!1,M("title.font.color",x.font.color),M("title.font.family",x.font.family),M("title.font.size",.25*(l||y||p.defaultNumberFontSize)),M("title.text");var T,w,A,f;function u(O,I){return b.coerce(T,w,k.gauge,O,I)}function h(O,I){return b.coerce(A,f,k.gauge.axis,O,I)}if(s._hasGauge){T=d.gauge,T||(T={}),w=E.newContainer(s,"gauge"),u("shape");var o=s._isBullet=s.gauge.shape==="bullet";o||M("title.align","center");var S=s._isAngular=s.gauge.shape==="angular";S||M("align","center"),u("bgcolor",x.paper_bgcolor),u("borderwidth"),u("bordercolor"),u("bar.color"),u("bar.line.color"),u("bar.line.width");var R=p.valueThickness*(s.gauge.shape==="bullet"?.5:1);u("bar.thickness",R),e(T,w,{name:"steps",handleItemDefaults:r}),u("threshold.value"),u("threshold.thickness"),u("threshold.line.width"),u("threshold.line.color"),A={},T&&(A=T.axis||{}),f=E.newContainer(w,"axis"),h("visible"),s._range=h("range",s._range);var z={outerTicks:!0};g(A,f,h,"linear"),i(A,f,h,"linear",z),t(A,f,h,"linear",z),a(A,f,h,z)}else M("title.align","center"),M("align","center"),s._isAngular=s._isBullet=!1;s._length=null}function r(d,s){function m(x,M){return b.coerce(d,s,k.gauge.steps,x,M)}m("color"),m("line.color"),m("line.width"),m("range"),m("thickness")}ae.exports={supplyDefaults:n}},{"../../lib":503,"../../plot_api/plot_template":543,"../../plots/array_container_defaults":549,"../../plots/cartesian/prefix_suffix_defaults":573,"../../plots/cartesian/tick_label_defaults":578,"../../plots/cartesian/tick_mark_defaults":579,"../../plots/cartesian/tick_value_defaults":580,"../../plots/domain":584,"./attributes":855,"./constants.js":858}],860:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"indicator",basePlotModule:c("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:c("./attributes"),supplyDefaults:c("./defaults").supplyDefaults,calc:c("./calc").calc,plot:c("./plot"),meta:{}}},{"./attributes":855,"./base_plot":856,"./calc":857,"./defaults":859,"./plot":861}],861:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("d3-interpolate").interpolate,P=c("d3-interpolate").interpolateNumber,E=c("../../lib"),e=E.strScale,p=E.strTranslate,g=E.rad2deg,a=c("../../constants/alignment").MID_SHIFT,t=c("../../components/drawing"),i=c("./constants"),n=c("../../lib/svg_text_utils"),r=c("../../plots/cartesian/axes"),d=c("../../plots/cartesian/axis_defaults"),s=c("../../plots/cartesian/position_defaults"),m=c("../../plots/cartesian/layout_attributes"),x=c("../../components/color"),M={left:"start",center:"middle",right:"end"},v={left:0,center:.5,right:1},_=/[yzafpnmkMGTPEZY]/;function l(z){return z&&z.duration>0}ae.exports=function(O,I,F,D){var B=O._fullLayout,U;l(F)&&D&&(U=D()),E.makeTraceGroups(B._indicatorlayer,I,"trace").each(function(X){var oe=X[0],se=oe.trace,q=b.select(this),K=se._hasGauge,G=se._isAngular,Q=se._isBullet,V=se.domain,H={w:B._size.w*(V.x[1]-V.x[0]),h:B._size.h*(V.y[1]-V.y[0]),l:B._size.l+B._size.w*V.x[0],r:B._size.r+B._size.w*(1-V.x[1]),t:B._size.t+B._size.h*(1-V.y[1]),b:B._size.b+B._size.h*V.y[0]},ee=H.l+H.w/2,J=H.t+H.h/2,W=Math.min(H.w/2,H.h),re=i.innerRadius*W,j,Z,ne,le=se.align||"center";if(Z=J,!K)j=H.l+v[le]*H.w,ne=function(ye){return h(ye,H.w,H.h)};else if(G&&(j=ee,Z=J+W/2,ne=function(ye){return o(ye,.9*re)}),Q){var ge=i.bulletPadding,pe=1-i.bulletNumberDomainSize+ge;j=H.l+(pe+(1-pe)*v[le])*H.w,ne=function(ye){return h(ye,(i.bulletNumberDomainSize-ge)*H.w,H.h)}}w(O,q,X,{numbersX:j,numbersY:Z,numbersScaler:ne,transitionOpts:F,onComplete:U});var xe,Ee;K&&(xe={range:se.gauge.axis.range,color:se.gauge.bgcolor,line:{color:se.gauge.bordercolor,width:0},thickness:1},Ee={range:se.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:se.gauge.bordercolor,width:se.gauge.borderwidth},thickness:1});var Te=q.selectAll("g.angular").data(G?X:[]);Te.exit().remove();var de=q.selectAll("g.angularaxis").data(G?X:[]);de.exit().remove(),G&&T(O,q,X,{radius:W,innerRadius:re,gauge:Te,layer:de,size:H,gaugeBg:xe,gaugeOutline:Ee,transitionOpts:F,onComplete:U});var be=q.selectAll("g.bullet").data(Q?X:[]);be.exit().remove();var Le=q.selectAll("g.bulletaxis").data(Q?X:[]);Le.exit().remove(),Q&&y(O,q,X,{gauge:be,layer:Le,size:H,gaugeBg:xe,gaugeOutline:Ee,transitionOpts:F,onComplete:U});var De=q.selectAll("text.title").data(X);De.exit().remove(),De.enter().append("text").classed("title",!0),De.attr("text-anchor",function(){return Q?M.right:M[se.title.align]}).text(se.title.text).call(t.font,se.title.font).call(n.convertToTspans,O),De.attr("transform",function(){var ye=H.l+H.w*v[se.title.align],ke,Oe=i.titlePadding,Qe=t.bBox(De.node());if(K){if(G)if(se.gauge.axis.visible){var Ve=t.bBox(de.node());ke=Ve.top-Oe-Qe.bottom}else ke=H.t+H.h/2-W/2-Qe.bottom-Oe;Q&&(ke=Z-(Qe.top+Qe.bottom)/2,ye=H.l-i.bulletPadding*H.w)}else ke=se._numbersTop-Oe-Qe.bottom;return p(ye,ke)})})};function y(z,O,I,F){var D=I[0].trace,B=F.gauge,U=F.layer,X=F.gaugeBg,oe=F.gaugeOutline,se=F.size,q=D.domain,K=F.transitionOpts,G=F.onComplete,Q,V,H,ee,J;B.enter().append("g").classed("bullet",!0),B.attr("transform",p(se.l,se.t)),U.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),U.selectAll("g.xbulletaxistick,path,text").remove();var W=se.h,re=D.gauge.bar.thickness*W,j=q.x[0],Z=q.x[0]+(q.x[1]-q.x[0])*(D._hasNumber||D._hasDelta?1-i.bulletNumberDomainSize:1);Q=u(z,D.gauge.axis),Q._id="xbulletaxis",Q.domain=[j,Z],Q.setScale(),V=r.calcTicks(Q),H=r.makeTransTickFn(Q),ee=r.getTickSigns(Q)[2],J=se.t+se.h,Q.visible&&(r.drawTicks(z,Q,{vals:Q.ticks==="inside"?r.clipEnds(Q,V):V,layer:U,path:r.makeTickPath(Q,J,ee),transFn:H}),r.drawLabels(z,Q,{vals:V,layer:U,transFn:H,labelFns:r.makeLabelFns(Q,J)}));function ne(de){de.attr("width",function(be){return Math.max(0,Q.c2p(be.range[1])-Q.c2p(be.range[0]))}).attr("x",function(be){return Q.c2p(be.range[0])}).attr("y",function(be){return .5*(1-be.thickness)*W}).attr("height",function(be){return be.thickness*W})}var le=[X].concat(D.gauge.steps),ge=B.selectAll("g.bg-bullet").data(le);ge.enter().append("g").classed("bg-bullet",!0).append("rect"),ge.select("rect").call(ne).call(A),ge.exit().remove();var pe=B.selectAll("g.value-bullet").data([D.gauge.bar]);pe.enter().append("g").classed("value-bullet",!0).append("rect"),pe.select("rect").attr("height",re).attr("y",(W-re)/2).call(A),l(K)?pe.select("rect").transition().duration(K.duration).ease(K.easing).each("end",function(){G&&G()}).each("interrupt",function(){G&&G()}).attr("width",Math.max(0,Q.c2p(Math.min(D.gauge.axis.range[1],I[0].y)))):pe.select("rect").attr("width",typeof I[0].y=="number"?Math.max(0,Q.c2p(Math.min(D.gauge.axis.range[1],I[0].y))):0),pe.exit().remove();var xe=I.filter(function(){return D.gauge.threshold.value||D.gauge.threshold.value===0}),Ee=B.selectAll("g.threshold-bullet").data(xe);Ee.enter().append("g").classed("threshold-bullet",!0).append("line"),Ee.select("line").attr("x1",Q.c2p(D.gauge.threshold.value)).attr("x2",Q.c2p(D.gauge.threshold.value)).attr("y1",(1-D.gauge.threshold.thickness)/2*W).attr("y2",(1-(1-D.gauge.threshold.thickness)/2)*W).call(x.stroke,D.gauge.threshold.line.color).style("stroke-width",D.gauge.threshold.line.width),Ee.exit().remove();var Te=B.selectAll("g.gauge-outline").data([oe]);Te.enter().append("g").classed("gauge-outline",!0).append("rect"),Te.select("rect").call(ne).call(A),Te.exit().remove()}function T(z,O,I,F){var D=I[0].trace,B=F.size,U=F.radius,X=F.innerRadius,oe=F.gaugeBg,se=F.gaugeOutline,q=[B.l+B.w/2,B.t+B.h/2+U/2],K=F.gauge,G=F.layer,Q=F.transitionOpts,V=F.onComplete,H=Math.PI/2;function ee(Ue){var Ie=D.gauge.axis.range[0],at=D.gauge.axis.range[1],pt=(Ue-Ie)/(at-Ie)*Math.PI-H;return pt<-H?-H:pt>H?H:pt}function J(Ue){return b.svg.arc().innerRadius((X+U)/2-Ue/2*(U-X)).outerRadius((X+U)/2+Ue/2*(U-X)).startAngle(-H)}function W(Ue){Ue.attr("d",function(Ie){return J(Ie.thickness).startAngle(ee(Ie.range[0])).endAngle(ee(Ie.range[1]))()})}var re,j,Z,ne;K.enter().append("g").classed("angular",!0),K.attr("transform",p(q[0],q[1])),G.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),G.selectAll("g.xangularaxistick,path,text").remove(),re=u(z,D.gauge.axis),re.type="linear",re.range=D.gauge.axis.range,re._id="xangularaxis",re.ticklabeloverflow="allow",re.setScale();var le=function(Ue){return(re.range[0]-Ue.x)/(re.range[1]-re.range[0])*Math.PI+Math.PI},ge={},pe=r.makeLabelFns(re,0),xe=pe.labelStandoff;ge.xFn=function(Ue){var Ie=le(Ue);return Math.cos(Ie)*xe},ge.yFn=function(Ue){var Ie=le(Ue),at=Math.sin(Ie)>0?.2:1;return-Math.sin(Ie)*(xe+Ue.fontSize*at)+Math.abs(Math.cos(Ie))*(Ue.fontSize*a)},ge.anchorFn=function(Ue){var Ie=le(Ue),at=Math.cos(Ie);return Math.abs(at)<.1?"middle":at>0?"start":"end"},ge.heightFn=function(Ue,Ie,at){var pt=le(Ue);return-.5*(1+Math.sin(pt))*at};var Ee=function(Ue){return p(q[0]+U*Math.cos(Ue),q[1]-U*Math.sin(Ue))};Z=function(Ue){return Ee(le(Ue))};var Te=function(Ue){var Ie=le(Ue);return Ee(Ie)+"rotate("+-g(Ie)+")"};if(j=r.calcTicks(re),ne=r.getTickSigns(re)[2],re.visible){ne=re.ticks==="inside"?-1:1;var de=(re.linewidth||1)/2;r.drawTicks(z,re,{vals:j,layer:G,path:"M"+ne*de+",0h"+ne*re.ticklen,transFn:Te}),r.drawLabels(z,re,{vals:j,layer:G,transFn:Z,labelFns:ge})}var be=[oe].concat(D.gauge.steps),Le=K.selectAll("g.bg-arc").data(be);Le.enter().append("g").classed("bg-arc",!0).append("path"),Le.select("path").call(W).call(A),Le.exit().remove();var De=J(D.gauge.bar.thickness),ye=K.selectAll("g.value-arc").data([D.gauge.bar]);ye.enter().append("g").classed("value-arc",!0).append("path");var ke=ye.select("path");l(Q)?(ke.transition().duration(Q.duration).ease(Q.easing).each("end",function(){V&&V()}).each("interrupt",function(){V&&V()}).attrTween("d",f(De,ee(I[0].lastY),ee(I[0].y))),D._lastValue=I[0].y):ke.attr("d",typeof I[0].y=="number"?De.endAngle(ee(I[0].y)):"M0,0Z"),ke.call(A),ye.exit().remove(),be=[];var Oe=D.gauge.threshold.value;(Oe||Oe===0)&&be.push({range:[Oe,Oe],color:D.gauge.threshold.color,line:{color:D.gauge.threshold.line.color,width:D.gauge.threshold.line.width},thickness:D.gauge.threshold.thickness});var Qe=K.selectAll("g.threshold-arc").data(be);Qe.enter().append("g").classed("threshold-arc",!0).append("path"),Qe.select("path").call(W).call(A),Qe.exit().remove();var Ve=K.selectAll("g.gauge-outline").data([se]);Ve.enter().append("g").classed("gauge-outline",!0).append("path"),Ve.select("path").call(W).call(A),Ve.exit().remove()}function w(z,O,I,F){var D=I[0].trace,B=F.numbersX,U=F.numbersY,X=D.align||"center",oe=M[X],se=F.transitionOpts,q=F.onComplete,K=E.ensureSingle(O,"g","numbers"),G,Q,V,H=[];D._hasNumber&&H.push("number"),D._hasDelta&&(H.push("delta"),D.delta.position==="left"&&H.reverse());var ee=K.selectAll("text").data(H);ee.enter().append("text"),ee.attr("text-anchor",function(){return oe}).attr("class",function(Ee){return Ee}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),ee.exit().remove();function J(Ee,Te,de,be){if(Ee.match("s")&&de>=0!=be>=0&&!Te(de).slice(-1).match(_)&&!Te(be).slice(-1).match(_)){var Le=Ee.slice().replace("s","f").replace(/\d+/,function(ye){return parseInt(ye)-1}),De=u(z,{tickformat:Le});return function(ye){return Math.abs(ye)<1?r.tickText(De,ye).text:Te(ye)}}else return Te}function W(){var Ee=u(z,{tickformat:D.number.valueformat},D._range);Ee.setScale(),r.prepTicks(Ee);var Te=function(ye){return r.tickText(Ee,ye).text},de=D.number.suffix,be=D.number.prefix,Le=K.select("text.number");function De(){var ye=typeof I[0].y=="number"?be+Te(I[0].y)+de:"-";Le.text(ye).call(t.font,D.number.font).call(n.convertToTspans,z)}return l(se)?Le.transition().duration(se.duration).ease(se.easing).each("end",function(){De(),q&&q()}).each("interrupt",function(){De(),q&&q()}).attrTween("text",function(){var ye=b.select(this),ke=P(I[0].lastY,I[0].y);D._lastValue=I[0].y;var Oe=J(D.number.valueformat,Te,I[0].lastY,I[0].y);return function(Qe){ye.text(be+Oe(ke(Qe))+de)}}):De(),G=S(be+Te(I[0].y)+de,D.number.font,oe,z),Le}function re(){var Ee=u(z,{tickformat:D.delta.valueformat},D._range);Ee.setScale(),r.prepTicks(Ee);var Te=function(ke){return r.tickText(Ee,ke).text},de=function(ke){var Oe=D.delta.relative?ke.relativeDelta:ke.delta;return Oe},be=function(ke,Oe){return ke===0||typeof ke!="number"||isNaN(ke)?"-":(ke>0?D.delta.increasing.symbol:D.delta.decreasing.symbol)+Oe(ke)},Le=function(ke){return ke.delta>=0?D.delta.increasing.color:D.delta.decreasing.color};D._deltaLastValue===void 0&&(D._deltaLastValue=de(I[0]));var De=K.select("text.delta");De.call(t.font,D.delta.font).call(x.fill,Le({delta:D._deltaLastValue}));function ye(){De.text(be(de(I[0]),Te)).call(x.fill,Le(I[0])).call(n.convertToTspans,z)}return l(se)?De.transition().duration(se.duration).ease(se.easing).tween("text",function(){var ke=b.select(this),Oe=de(I[0]),Qe=D._deltaLastValue,Ve=J(D.delta.valueformat,Te,Qe,Oe),Ue=P(Qe,Oe);return D._deltaLastValue=Oe,function(Ie){ke.text(be(Ue(Ie),Ve)),ke.call(x.fill,Le({delta:Ue(Ie)}))}}).each("end",function(){ye(),q&&q()}).each("interrupt",function(){ye(),q&&q()}):ye(),Q=S(be(de(I[0]),Te),D.delta.font,oe,z),De}var j=D.mode+D.align,Z;if(D._hasDelta&&(Z=re(),j+=D.delta.position+D.delta.font.size+D.delta.font.family+D.delta.valueformat,j+=D.delta.increasing.symbol+D.delta.decreasing.symbol,V=Q),D._hasNumber&&(W(),j+=D.number.font.size+D.number.font.family+D.number.valueformat+D.number.suffix+D.number.prefix,V=G),D._hasDelta&&D._hasNumber){var ne=[(G.left+G.right)/2,(G.top+G.bottom)/2],le=[(Q.left+Q.right)/2,(Q.top+Q.bottom)/2],ge,pe,xe=.75*D.delta.font.size;D.delta.position==="left"&&(ge=R(D,"deltaPos",0,-1*(G.width*v[D.align]+Q.width*(1-v[D.align])+xe),j,Math.min),pe=ne[1]-le[1],V={width:G.width+Q.width+xe,height:Math.max(G.height,Q.height),left:Q.left+ge,right:G.right,top:Math.min(G.top,Q.top+pe),bottom:Math.max(G.bottom,Q.bottom+pe)}),D.delta.position==="right"&&(ge=R(D,"deltaPos",0,G.width*(1-v[D.align])+Q.width*v[D.align]+xe,j,Math.max),pe=ne[1]-le[1],V={width:G.width+Q.width+xe,height:Math.max(G.height,Q.height),left:G.left,right:Q.right+ge,top:Math.min(G.top,Q.top+pe),bottom:Math.max(G.bottom,Q.bottom+pe)}),D.delta.position==="bottom"&&(ge=null,pe=Q.height,V={width:Math.max(G.width,Q.width),height:G.height+Q.height,left:Math.min(G.left,Q.left),right:Math.max(G.right,Q.right),top:G.bottom-G.height,bottom:G.bottom+Q.height}),D.delta.position==="top"&&(ge=null,pe=G.top,V={width:Math.max(G.width,Q.width),height:G.height+Q.height,left:Math.min(G.left,Q.left),right:Math.max(G.right,Q.right),top:G.bottom-G.height-Q.height,bottom:G.bottom}),Z.attr({dx:ge,dy:pe})}(D._hasNumber||D._hasDelta)&&K.attr("transform",function(){var Ee=F.numbersScaler(V);j+=Ee[2];var Te=R(D,"numbersScale",1,Ee[0],j,Math.min),de;D._scaleNumbers||(Te=1),D._isAngular?de=U-Te*V.bottom:de=U-Te*(V.top+V.bottom)/2,D._numbersTop=Te*V.top+de;var be=V[X];X==="center"&&(be=(V.left+V.right)/2);var Le=B-Te*be;return Le=R(D,"numbersTranslate",0,Le,j,Math.max),p(Le,de)+e(Te)})}function A(z){z.each(function(O){x.stroke(b.select(this),O.line.color)}).each(function(O){x.fill(b.select(this),O.color)}).style("stroke-width",function(O){return O.line.width})}function f(z,O,I){return function(){var F=k(O,I);return function(D){return z.endAngle(F(D))()}}}function u(z,O,I){var F=z._fullLayout,D=E.extendFlat({type:"linear",ticks:"outside",range:I,showline:!0},O),B={type:"linear",_id:"x"+O._id},U={letter:"x",font:F.font,noHover:!0,noTickson:!0};function X(oe,se){return E.coerce(D,B,m,oe,se)}return d(D,B,X,U,F),s(D,B,X,U),B}function h(z,O,I){var F=Math.min(O/z.width,I/z.height);return[F,z,O+"x"+I]}function o(z,O){var I=Math.sqrt(z.width/2*(z.width/2)+z.height*z.height),F=O/I;return[F,z,O]}function S(z,O,I,F){var D=document.createElementNS("http://www.w3.org/2000/svg","text"),B=b.select(D);return B.text(z).attr("x",0).attr("y",0).attr("text-anchor",I).attr("data-unformatted",z).call(n.convertToTspans,F).call(t.font,O),t.bBox(B.node())}function R(z,O,I,F,D,B){var U="_cache"+O;z[U]&&z[U].key===D||(z[U]={key:D,value:I});var X=E.aggNums(B,null,[z[U].value,F],2);return z[U].value=X,X}},{"../../components/color":366,"../../components/drawing":388,"../../constants/alignment":471,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_defaults":556,"../../plots/cartesian/layout_attributes":569,"../../plots/cartesian/position_defaults":572,"./constants":858,"@plotly/d3":58,"d3-interpolate":116}],862:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/attributes"),k=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,P=c("../../plots/template_attributes").hovertemplateAttrs,E=c("../mesh3d/attributes"),e=c("../../plots/attributes"),p=c("../../lib/extend").extendFlat,g=c("../../plot_api/edit_types").overrideAll;function a(n){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function t(n){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var i=ae.exports=g(p({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:a("x"),y:a("y"),z:a("z")},caps:{x:t("x"),y:t("y"),z:t("z")},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:P(),xhoverformat:k("x"),yhoverformat:k("y"),zhoverformat:k("z"),valuehoverformat:k("value",1),showlegend:p({},e.showlegend,{dflt:!1})},b("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:E.opacity,lightposition:E.lightposition,lighting:E.lighting,flatshading:E.flatshading,contour:E.contour,hoverinfo:p({},e.hoverinfo)}),"calc","nested");i.flatshading.dflt=!0,i.lighting.facenormalsepsilon.dflt=0,i.x.editType=i.y.editType=i.z.editType=i.value.editType="calc+clearAxisTypes",i.transforms=void 0},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../mesh3d/attributes":867}],863:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/calc"),k=c("../streamtube/calc").processGrid,P=c("../streamtube/calc").filter;ae.exports=function(e,p){p._len=Math.min(p.x.length,p.y.length,p.z.length,p.value.length),p._x=P(p.x,p._len),p._y=P(p.y,p._len),p._z=P(p.z,p._len),p._value=P(p.value,p._len);var g=k(p);p._gridFill=g.fill,p._Xs=g.Xs,p._Ys=g.Ys,p._Zs=g.Zs,p._len=g.len;for(var a=1/0,t=-1/0,i=0;i<p._len;i++){var n=p._value[i];a=Math.min(a,n),t=Math.max(t,n)}p._minValues=a,p._maxValues=t,p._vMin=p.isomin===void 0||p.isomin===null?a:p.isomin,p._vMax=p.isomax===void 0||p.isomin===null?t:p.isomax,b(e,p,{vals:[p._vMin,p._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374,"../streamtube/calc":1045}],864:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_mesh3d,k=c("../../lib/gl_format_color").parseColorScale,P=c("../../lib/str2rgbarray"),E=c("../../components/colorscale").extractOpts,e=c("../../plots/gl3d/zip3"),p=function(r,d){for(var s=d.length-1;s>0;s--){var m=Math.min(d[s],d[s-1]),x=Math.max(d[s],d[s-1]);if(x>m&&m<r&&r<=x)return{id:s,distRatio:(x-r)/(x-m)}}return{id:0,distRatio:0}};function g(r,d,s){this.scene=r,this.uid=s,this.mesh=d,this.name="",this.data=null,this.showContour=!1}var a=g.prototype;a.handlePick=function(r){if(r.object===this.mesh){var d=r.data.index,s=this.data._meshX[d],m=this.data._meshY[d],x=this.data._meshZ[d],M=this.data._Ys.length,v=this.data._Zs.length,_=p(s,this.data._Xs).id,l=p(m,this.data._Ys).id,y=p(x,this.data._Zs).id,T=r.index=y+v*l+v*M*_;r.traceCoordinate=[this.data._meshX[T],this.data._meshY[T],this.data._meshZ[T],this.data._value[T]];var w=this.data.hovertext||this.data.text;return Array.isArray(w)&&w[T]!==void 0?r.textLabel=w[T]:w&&(r.textLabel=w),!0}},a.update=function(r){var d=this.scene,s=d.fullSceneLayout;this.data=i(r);function m(l,y,T,w){return y.map(function(A){return l.d2l(A,0,w)*T})}var x=e(m(s.xaxis,r._meshX,d.dataScale[0],r.xcalendar),m(s.yaxis,r._meshY,d.dataScale[1],r.ycalendar),m(s.zaxis,r._meshZ,d.dataScale[2],r.zcalendar)),M=e(r._meshI,r._meshJ,r._meshK),v={positions:x,cells:M,lightPosition:[r.lightposition.x,r.lightposition.y,r.lightposition.z],ambient:r.lighting.ambient,diffuse:r.lighting.diffuse,specular:r.lighting.specular,roughness:r.lighting.roughness,fresnel:r.lighting.fresnel,vertexNormalsEpsilon:r.lighting.vertexnormalsepsilon,faceNormalsEpsilon:r.lighting.facenormalsepsilon,opacity:r.opacity,contourEnable:r.contour.show,contourColor:P(r.contour.color).slice(0,3),contourWidth:r.contour.width,useFacetNormals:r.flatshading},_=E(r);v.vertexIntensity=r._meshIntensity,v.vertexIntensityBounds=[_.min,_.max],v.colormap=k(r),this.mesh.update(v)},a.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var t=["xyz","xzy","yxz","yzx","zxy","zyx"];function i(r){r._meshI=[],r._meshJ=[],r._meshK=[];var d=r.surface.show,s=r.spaceframe.show,m=r.surface.fill,x=r.spaceframe.fill,M=!1,v=!1,_=0,l,y,T=r._Xs,w=r._Ys,A=r._Zs,f=T.length,u=w.length,h=A.length,o=t.indexOf(r._gridFill.replace(/-/g,"").replace(/\+/g,"")),S=function(St,_t,it){switch(o){case 5:return it+h*_t+h*u*St;case 4:return it+h*St+h*f*_t;case 3:return _t+u*it+u*h*St;case 2:return _t+u*St+u*f*it;case 1:return St+f*it+f*h*_t;default:return St+f*_t+f*u*it}},R=r._minValues,z=r._maxValues,O=r._vMin,I=r._vMax,F,D,B,U;function X(St,_t,it){for(var ct=U.length,et=y;et<ct;et++)if(St===F[et]&&_t===D[et]&&it===B[et])return et;return-1}function oe(){y=l}function se(){F=[],D=[],B=[],U=[],l=0,oe()}function q(St,_t,it,ct){return F.push(St),D.push(_t),B.push(it),U.push(ct),l++,l-1}function K(St,_t,it){return r._meshI.push(St),r._meshJ.push(_t),r._meshK.push(it),_++,_-1}function G(St,_t,it){for(var ct=[],et=0;et<St.length;et++)ct[et]=(St[et]+_t[et]+it[et])/3;return ct}function Q(St,_t,it){for(var ct=[],et=0;et<St.length;et++)ct[et]=St[et]*(1-it)+it*_t[et];return ct}var V;function H(St){V=St}function ee(St,_t){var it=St[0],ct=St[1],et=St[2],Pe=G(it,ct,et),We=Math.sqrt(1-V),je=Q(Pe,it,We),nt=Q(Pe,ct,We),kt=Q(Pe,et,We),wt=_t[0],Vt=_t[1],qt=_t[2];return{xyzv:[[it,ct,nt],[nt,je,it],[ct,et,kt],[kt,nt,ct],[et,it,je],[je,kt,et]],abc:[[wt,Vt,-1],[-1,-1,wt],[Vt,qt,-1],[-1,-1,Vt],[qt,wt,-1],[-1,-1,qt]]}}function J(St,_t){return St==="all"||St===null?!0:St.indexOf(_t)>-1}function W(St,_t){return St===null?_t:St}function re(St,_t,it){oe();var ct=[_t],et=[it];if(V>=1)ct=[_t],et=[it];else if(V>0){var Pe=ee(_t,it);ct=Pe.xyzv,et=Pe.abc}for(var We=0;We<ct.length;We++){_t=ct[We],it=et[We];for(var je=[],nt=0;nt<3;nt++){var kt=_t[nt][0],wt=_t[nt][1],Vt=_t[nt][2],qt=_t[nt][3],zt=it[nt]>-1?it[nt]:X(kt,wt,Vt);zt>-1?je[nt]=zt:je[nt]=q(kt,wt,Vt,W(St,qt))}K(je[0],je[1],je[2])}}function j(St,_t,it){var ct=function(et,Pe,We){re(St,[_t[et],_t[Pe],_t[We]],[it[et],it[Pe],it[We]])};ct(0,1,2),ct(2,3,0)}function Z(St,_t,it){var ct=function(et,Pe,We){re(St,[_t[et],_t[Pe],_t[We]],[it[et],it[Pe],it[We]])};ct(0,1,2),ct(3,0,1),ct(2,3,0),ct(1,2,3)}function ne(St,_t,it,ct){var et=St[3];et<it&&(et=it),et>ct&&(et=ct);for(var Pe=(St[3]-et)/(St[3]-_t[3]+1e-9),We=[],je=0;je<4;je++)We[je]=(1-Pe)*St[je]+Pe*_t[je];return We}function le(St,_t,it){return St>=_t&&St<=it}function ge(St){var _t=.001*(I-O);return St>=O-_t&&St<=I+_t}function pe(St){for(var _t=[],it=0;it<4;it++){var ct=St[it];_t.push([r._x[ct],r._y[ct],r._z[ct],r._value[ct]])}return _t}var xe=3;function Ee(St,_t,it,ct,et,Pe){Pe||(Pe=1),it=[-1,-1,-1];var We=!1,je=[le(_t[0][3],ct,et),le(_t[1][3],ct,et),le(_t[2][3],ct,et)];if(!je[0]&&!je[1]&&!je[2])return!1;var nt=function(wt,Vt,qt){return ge(Vt[0][3])&&ge(Vt[1][3])&&ge(Vt[2][3])?(re(wt,Vt,qt),!0):Pe<xe?Ee(wt,Vt,qt,O,I,++Pe):!1};if(je[0]&&je[1]&&je[2])return nt(St,_t,it)||We;var kt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(wt){if(je[wt[0]]&&je[wt[1]]&&!je[wt[2]]){var Vt=_t[wt[0]],qt=_t[wt[1]],zt=_t[wt[2]],Ht=ne(zt,Vt,ct,et),$t=ne(zt,qt,ct,et);We=nt(St,[$t,Ht,Vt],[-1,-1,it[wt[0]]])||We,We=nt(St,[Vt,qt,$t],[it[wt[0]],it[wt[1]],-1])||We,kt=!0}}),kt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(wt){if(je[wt[0]]&&!je[wt[1]]&&!je[wt[2]]){var Vt=_t[wt[0]],qt=_t[wt[1]],zt=_t[wt[2]],Ht=ne(qt,Vt,ct,et),$t=ne(zt,Vt,ct,et);We=nt(St,[$t,Ht,Vt],[-1,-1,it[wt[0]]])||We,kt=!0}}),We}function Te(St,_t,it,ct){var et=!1,Pe=pe(_t),We=[le(Pe[0][3],it,ct),le(Pe[1][3],it,ct),le(Pe[2][3],it,ct),le(Pe[3][3],it,ct)];if(!We[0]&&!We[1]&&!We[2]&&!We[3])return et;if(We[0]&&We[1]&&We[2]&&We[3])return v&&(et=Z(St,Pe,_t)||et),et;var je=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(nt){if(We[nt[0]]&&We[nt[1]]&&We[nt[2]]&&!We[nt[3]]){var kt=Pe[nt[0]],wt=Pe[nt[1]],Vt=Pe[nt[2]],qt=Pe[nt[3]];if(v)et=re(St,[kt,wt,Vt],[_t[nt[0]],_t[nt[1]],_t[nt[2]]])||et;else{var zt=ne(qt,kt,it,ct),Ht=ne(qt,wt,it,ct),$t=ne(qt,Vt,it,ct);et=re(null,[zt,Ht,$t],[-1,-1,-1])||et}je=!0}}),je||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(nt){if(We[nt[0]]&&We[nt[1]]&&!We[nt[2]]&&!We[nt[3]]){var kt=Pe[nt[0]],wt=Pe[nt[1]],Vt=Pe[nt[2]],qt=Pe[nt[3]],zt=ne(Vt,kt,it,ct),Ht=ne(Vt,wt,it,ct),$t=ne(qt,wt,it,ct),Qt=ne(qt,kt,it,ct);v?(et=re(St,[kt,Qt,zt],[_t[nt[0]],-1,-1])||et,et=re(St,[wt,Ht,$t],[_t[nt[1]],-1,-1])||et):et=j(null,[zt,Ht,$t,Qt],[-1,-1,-1,-1])||et,je=!0}}),je)||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(nt){if(We[nt[0]]&&!We[nt[1]]&&!We[nt[2]]&&!We[nt[3]]){var kt=Pe[nt[0]],wt=Pe[nt[1]],Vt=Pe[nt[2]],qt=Pe[nt[3]],zt=ne(wt,kt,it,ct),Ht=ne(Vt,kt,it,ct),$t=ne(qt,kt,it,ct);v?(et=re(St,[kt,zt,Ht],[_t[nt[0]],-1,-1])||et,et=re(St,[kt,Ht,$t],[_t[nt[0]],-1,-1])||et,et=re(St,[kt,$t,zt],[_t[nt[0]],-1,-1])||et):et=re(null,[zt,Ht,$t],[-1,-1,-1])||et,je=!0}}),et}function de(St,_t,it,ct,et,Pe,We,je,nt,kt,wt){var Vt=!1;return M&&(J(St,"A")&&(Vt=Te(null,[_t,it,ct,Pe],kt,wt)||Vt),J(St,"B")&&(Vt=Te(null,[it,ct,et,nt],kt,wt)||Vt),J(St,"C")&&(Vt=Te(null,[it,Pe,We,nt],kt,wt)||Vt),J(St,"D")&&(Vt=Te(null,[ct,Pe,je,nt],kt,wt)||Vt),J(St,"E")&&(Vt=Te(null,[it,ct,Pe,nt],kt,wt)||Vt)),v&&(Vt=Te(St,[it,ct,Pe,nt],kt,wt)||Vt),Vt}function be(St,_t,it,ct,et,Pe,We,je){return[je[0]===!0?!0:Ee(St,pe([_t,it,ct]),[_t,it,ct],Pe,We),je[1]===!0?!0:Ee(St,pe([ct,et,_t]),[ct,et,_t],Pe,We)]}function Le(St,_t,it,ct,et,Pe,We,je,nt){return je?be(St,_t,it,et,ct,Pe,We,nt):be(St,it,et,ct,_t,Pe,We,nt)}function De(St,_t,it,ct,et,Pe,We){var je=!1,nt,kt,wt,Vt,qt=function(){je=Ee(St,[nt,kt,wt],[-1,-1,-1],et,Pe)||je,je=Ee(St,[wt,Vt,nt],[-1,-1,-1],et,Pe)||je},zt=We[0],Ht=We[1],$t=We[2];return zt&&(nt=Q(pe([S(_t,it-0,ct-0)])[0],pe([S(_t-1,it-0,ct-0)])[0],zt),kt=Q(pe([S(_t,it-0,ct-1)])[0],pe([S(_t-1,it-0,ct-1)])[0],zt),wt=Q(pe([S(_t,it-1,ct-1)])[0],pe([S(_t-1,it-1,ct-1)])[0],zt),Vt=Q(pe([S(_t,it-1,ct-0)])[0],pe([S(_t-1,it-1,ct-0)])[0],zt),qt()),Ht&&(nt=Q(pe([S(_t-0,it,ct-0)])[0],pe([S(_t-0,it-1,ct-0)])[0],Ht),kt=Q(pe([S(_t-0,it,ct-1)])[0],pe([S(_t-0,it-1,ct-1)])[0],Ht),wt=Q(pe([S(_t-1,it,ct-1)])[0],pe([S(_t-1,it-1,ct-1)])[0],Ht),Vt=Q(pe([S(_t-1,it,ct-0)])[0],pe([S(_t-1,it-1,ct-0)])[0],Ht),qt()),$t&&(nt=Q(pe([S(_t-0,it-0,ct)])[0],pe([S(_t-0,it-0,ct-1)])[0],$t),kt=Q(pe([S(_t-0,it-1,ct)])[0],pe([S(_t-0,it-1,ct-1)])[0],$t),wt=Q(pe([S(_t-1,it-1,ct)])[0],pe([S(_t-1,it-1,ct-1)])[0],$t),Vt=Q(pe([S(_t-1,it-0,ct)])[0],pe([S(_t-1,it-0,ct-1)])[0],$t),qt()),je}function ye(St,_t,it,ct,et,Pe,We,je,nt,kt,wt,Vt){var qt=St;return Vt?(M&&St==="even"&&(qt=null),de(qt,_t,it,ct,et,Pe,We,je,nt,kt,wt)):(M&&St==="odd"&&(qt=null),de(qt,nt,je,We,Pe,et,ct,it,_t,kt,wt))}function ke(St,_t,it,ct,et){for(var Pe=[],We=0,je=0;je<_t.length;je++)for(var nt=_t[je],kt=1;kt<h;kt++)for(var wt=1;wt<u;wt++)Pe.push(Le(St,S(nt,wt-1,kt-1),S(nt,wt-1,kt),S(nt,wt,kt-1),S(nt,wt,kt),it,ct,(nt+wt+kt)%2,et&&et[We]?et[We]:[])),We++;return Pe}function Oe(St,_t,it,ct,et){for(var Pe=[],We=0,je=0;je<_t.length;je++)for(var nt=_t[je],kt=1;kt<f;kt++)for(var wt=1;wt<h;wt++)Pe.push(Le(St,S(kt-1,nt,wt-1),S(kt,nt,wt-1),S(kt-1,nt,wt),S(kt,nt,wt),it,ct,(kt+nt+wt)%2,et&&et[We]?et[We]:[])),We++;return Pe}function Qe(St,_t,it,ct,et){for(var Pe=[],We=0,je=0;je<_t.length;je++)for(var nt=_t[je],kt=1;kt<u;kt++)for(var wt=1;wt<f;wt++)Pe.push(Le(St,S(wt-1,kt-1,nt),S(wt-1,kt,nt),S(wt,kt-1,nt),S(wt,kt,nt),it,ct,(wt+kt+nt)%2,et&&et[We]?et[We]:[])),We++;return Pe}function Ve(St,_t,it){for(var ct=1;ct<h;ct++)for(var et=1;et<u;et++)for(var Pe=1;Pe<f;Pe++)ye(St,S(Pe-1,et-1,ct-1),S(Pe-1,et-1,ct),S(Pe-1,et,ct-1),S(Pe-1,et,ct),S(Pe,et-1,ct-1),S(Pe,et-1,ct),S(Pe,et,ct-1),S(Pe,et,ct),_t,it,(Pe+et+ct)%2)}function Ue(St,_t,it){v=!0,Ve(St,_t,it),v=!1}function Ie(St,_t,it){M=!0,Ve(St,_t,it),M=!1}function at(St,_t,it,ct,et,Pe){for(var We=[],je=0,nt=0;nt<_t.length;nt++)for(var kt=_t[nt],wt=1;wt<h;wt++)for(var Vt=1;Vt<u;Vt++)We.push(De(St,kt,Vt,wt,it,ct,et[nt],Pe&&Pe[je]?Pe[je]:[])),je++;return We}function pt(St,_t,it,ct,et,Pe){for(var We=[],je=0,nt=0;nt<_t.length;nt++)for(var kt=_t[nt],wt=1;wt<f;wt++)for(var Vt=1;Vt<h;Vt++)We.push(De(St,wt,kt,Vt,it,ct,et[nt],Pe&&Pe[je]?Pe[je]:[])),je++;return We}function Rt(St,_t,it,ct,et,Pe){for(var We=[],je=0,nt=0;nt<_t.length;nt++)for(var kt=_t[nt],wt=1;wt<u;wt++)for(var Vt=1;Vt<f;Vt++)We.push(De(St,Vt,wt,kt,it,ct,et[nt],Pe&&Pe[je]?Pe[je]:[])),je++;return We}function Mt(St,_t){for(var it=[],ct=St;ct<_t;ct++)it.push(ct);return it}function It(){for(var St=0;St<f;St++)for(var _t=0;_t<u;_t++)for(var it=0;it<h;it++){var ct=S(St,_t,it);q(r._x[ct],r._y[ct],r._z[ct],r._value[ct])}}function Bt(){se(),It();var St=null;if(s&&x&&(H(x),Ue(St,O,I)),d&&m){H(m);for(var _t=r.surface.pattern,it=r.surface.count,ct=0;ct<it;ct++){var et=it===1?.5:ct/(it-1),Pe=(1-et)*O+et*I,We=Math.abs(Pe-R),je=Math.abs(Pe-z),nt=We>je?[R,Pe]:[Pe,z];Ie(_t,nt[0],nt[1])}}var kt=[[Math.min(O,z),Math.max(O,z)],[Math.min(R,I),Math.max(R,I)]];["x","y","z"].forEach(function(wt){for(var Vt=[],qt=0;qt<kt.length;qt++){var zt=0,Ht=kt[qt][0],$t=kt[qt][1],Qt=r.slices[wt];if(Qt.show&&Qt.fill){H(Qt.fill);var fr=[],jr=[],cn=[];if(Qt.locations.length)for(var Qr=0;Qr<Qt.locations.length;Qr++){var lt=p(Qt.locations[Qr],wt==="x"?T:wt==="y"?w:A);lt.distRatio===0?fr.push(lt.id):lt.id>0&&(jr.push(lt.id),wt==="x"?cn.push([lt.distRatio,0,0]):wt==="y"?cn.push([0,lt.distRatio,0]):cn.push([0,0,lt.distRatio]))}else wt==="x"?fr=Mt(1,f-1):wt==="y"?fr=Mt(1,u-1):fr=Mt(1,h-1);jr.length>0&&(wt==="x"?Vt[zt]=at(St,jr,Ht,$t,cn,Vt[zt]):wt==="y"?Vt[zt]=pt(St,jr,Ht,$t,cn,Vt[zt]):Vt[zt]=Rt(St,jr,Ht,$t,cn,Vt[zt]),zt++),fr.length>0&&(wt==="x"?Vt[zt]=ke(St,fr,Ht,$t,Vt[zt]):wt==="y"?Vt[zt]=Oe(St,fr,Ht,$t,Vt[zt]):Vt[zt]=Qe(St,fr,Ht,$t,Vt[zt]),zt++)}var Gt=r.caps[wt];Gt.show&&Gt.fill&&(H(Gt.fill),wt==="x"?Vt[zt]=ke(St,[0,f-1],Ht,$t,Vt[zt]):wt==="y"?Vt[zt]=Oe(St,[0,u-1],Ht,$t,Vt[zt]):Vt[zt]=Qe(St,[0,h-1],Ht,$t,Vt[zt]),zt++)}}),_===0&&se(),r._meshX=F,r._meshY=D,r._meshZ=B,r._meshIntensity=U,r._Xs=T,r._Ys=w,r._Zs=A}return Bt(),r}function n(r,d){var s=r.glplot.gl,m=b({gl:s}),x=new g(r,m,d.uid);return m._trace=x,x.update(d),r.glplot.add(m),x}ae.exports={findNearestOnAxis:p,generateIsoMeshes:i,createIsosurfaceTrace:n}},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/gl3d/zip3":609}],865:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../registry"),P=c("./attributes"),E=c("../../components/colorscale/defaults");function e(g,a,t,i){function n(r,d){return b.coerce(g,a,P,r,d)}p(g,a,t,i,n)}function p(g,a,t,i,n){var r=n("isomin"),d=n("isomax");d!=null&&r!==void 0&&r!==null&&r>d&&(a.isomin=null,a.isomax=null);var s=n("x"),m=n("y"),x=n("z"),M=n("value");if(!s||!s.length||!m||!m.length||!x||!x.length||!M||!M.length){a.visible=!1;return}var v=k.getComponentMethod("calendars","handleTraceDefaults");v(g,a,["x","y","z"],i),n("valuehoverformat"),["x","y","z"].forEach(function(T){n(T+"hoverformat");var w="caps."+T,A=n(w+".show");A&&n(w+".fill");var f="slices."+T,u=n(f+".show");u&&(n(f+".fill"),n(f+".locations"))});var _=n("spaceframe.show");_&&n("spaceframe.fill");var l=n("surface.show");l&&(n("surface.count"),n("surface.fill"),n("surface.pattern"));var y=n("contour.show");y&&(n("contour.color"),n("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(T){n(T)}),E(g,a,i,n,{prefix:"",cLetter:"c"}),a._length=null}ae.exports={supplyDefaults:e,supplyIsoDefaults:p}},{"../../components/colorscale/defaults":376,"../../lib":503,"../../registry":638,"./attributes":862}],866:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults").supplyDefaults,calc:c("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:c("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:c("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":598,"./attributes":862,"./calc":863,"./convert":864,"./defaults":865}],867:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/attributes"),k=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,P=c("../../plots/template_attributes").hovertemplateAttrs,E=c("../surface/attributes"),e=c("../../plots/attributes"),p=c("../../lib/extend").extendFlat;ae.exports=p({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:P({editType:"calc"}),xhoverformat:k("x"),yhoverformat:k("y"),zhoverformat:k("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},b("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:E.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:p({},E.contours.x.show,{}),color:E.contours.x.color,width:E.contours.x.width,editType:"calc"},lightposition:{x:p({},E.lightposition.x,{dflt:1e5}),y:p({},E.lightposition.y,{dflt:1e5}),z:p({},E.lightposition.z,{dflt:0}),editType:"calc"},lighting:p({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},E.lighting),hoverinfo:p({},e.hoverinfo,{editType:"calc"}),showlegend:p({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../surface/attributes":1061}],868:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/calc");ae.exports=function(P,E){E.intensity&&b(P,E,{vals:E.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374}],869:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_mesh3d,k=c("../../../stackgl_modules").delaunay_triangulate,P=c("../../../stackgl_modules").alpha_shape,E=c("../../../stackgl_modules").convex_hull,e=c("../../lib/gl_format_color").parseColorScale,p=c("../../lib/str2rgbarray"),g=c("../../components/colorscale").extractOpts,a=c("../../plots/gl3d/zip3");function t(M,v,_){this.scene=M,this.uid=_,this.mesh=v,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var i=t.prototype;i.handlePick=function(M){if(M.object===this.mesh){var v=M.index=M.data.index;M.data._cellCenter?M.traceCoordinate=M.data.dataCoordinate:M.traceCoordinate=[this.data.x[v],this.data.y[v],this.data.z[v]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[v]!==void 0?M.textLabel=_[v]:_&&(M.textLabel=_),!0}};function n(M){for(var v=[],_=M.length,l=0;l<_;l++)v[l]=p(M[l]);return v}function r(M,v,_,l){for(var y=[],T=v.length,w=0;w<T;w++)y[w]=M.d2l(v[w],0,l)*_;return y}function d(M){for(var v=[],_=M.length,l=0;l<_;l++)v[l]=Math.round(M[l]);return v}function s(M,v){for(var _=["x","y","z"].indexOf(M),l=[],y=v.length,T=0;T<y;T++)l[T]=[v[T][(_+1)%3],v[T][(_+2)%3]];return k(l)}function m(M,v){for(var _=M.length,l=0;l<_;l++)if(M[l]<=-.5||M[l]>=v-.5)return!1;return!0}i.update=function(M){var v=this.scene,_=v.fullSceneLayout;this.data=M;var l=M.x.length,y=a(r(_.xaxis,M.x,v.dataScale[0],M.xcalendar),r(_.yaxis,M.y,v.dataScale[1],M.ycalendar),r(_.zaxis,M.z,v.dataScale[2],M.zcalendar)),T;if(M.i&&M.j&&M.k){if(M.i.length!==M.j.length||M.j.length!==M.k.length||!m(M.i,l)||!m(M.j,l)||!m(M.k,l))return;T=a(d(M.i),d(M.j),d(M.k))}else M.alphahull===0?T=E(y):M.alphahull>0?T=P(M.alphahull,y):T=s(M.delaunayaxis,y);var w={positions:y,cells:T,lightPosition:[M.lightposition.x,M.lightposition.y,M.lightposition.z],ambient:M.lighting.ambient,diffuse:M.lighting.diffuse,specular:M.lighting.specular,roughness:M.lighting.roughness,fresnel:M.lighting.fresnel,vertexNormalsEpsilon:M.lighting.vertexnormalsepsilon,faceNormalsEpsilon:M.lighting.facenormalsepsilon,opacity:M.opacity,contourEnable:M.contour.show,contourColor:p(M.contour.color).slice(0,3),contourWidth:M.contour.width,useFacetNormals:M.flatshading};if(M.intensity){var A=g(M);this.color="#fff";var f=M.intensitymode;w[f+"Intensity"]=M.intensity,w[f+"IntensityBounds"]=[A.min,A.max],w.colormap=e(M)}else M.vertexcolor?(this.color=M.vertexcolor[0],w.vertexColors=n(M.vertexcolor)):M.facecolor?(this.color=M.facecolor[0],w.cellColors=n(M.facecolor)):(this.color=M.color,w.meshColor=p(M.color));this.mesh.update(w)},i.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function x(M,v){var _=M.glplot.gl,l=b({gl:_}),y=new t(M,l,v.uid);return l._trace=y,y.update(v),M.glplot.add(l),y}ae.exports=x},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/gl3d/zip3":609}],870:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("../../components/colorscale/defaults"),E=c("./attributes");ae.exports=function(p,g,a,t){function i(m,x){return k.coerce(p,g,E,m,x)}function n(m){var x=m.map(function(M){var v=i(M);return v&&k.isArrayOrTypedArray(v)?v:null});return x.every(function(M){return M&&M.length===x[0].length})&&x}var r=n(["x","y","z"]);if(!r){g.visible=!1;return}if(n(["i","j","k"]),g.i&&(!g.j||!g.k)||g.j&&(!g.k||!g.i)||g.k&&(!g.i||!g.j)){g.visible=!1;return}var d=b.getComponentMethod("calendars","handleTraceDefaults");d(p,g,["x","y","z"],t),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(m){i(m)});var s=i("contour.show");s&&(i("contour.color"),i("contour.width")),"intensity"in p?(i("intensity"),i("intensitymode"),P(p,g,t,i,{prefix:"",cLetter:"c"})):(g.showscale=!1,"facecolor"in p?i("facecolor"):"vertexcolor"in p?i("vertexcolor"):i("color",a)),i("text"),i("hovertext"),i("hovertemplate"),i("xhoverformat"),i("yhoverformat"),i("zhoverformat"),g._length=null}},{"../../components/colorscale/defaults":376,"../../lib":503,"../../registry":638,"./attributes":867}],871:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:c("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:c("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":598,"./attributes":867,"./calc":868,"./convert":869,"./defaults":870}],872:[function(c,ae,ie){"use strict";var b=c("../../lib").extendFlat,k=c("../scatter/attributes"),P=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,E=c("../../components/drawing/attributes").dash,e=c("../../components/fx/attributes"),p=c("../../constants/delta.js"),g=p.INCREASING.COLOR,a=p.DECREASING.COLOR,t=k.line;function i(n){return{line:{color:b({},t.color,{dflt:n}),width:t.width,dash:E,editType:"style"},editType:"style"}}ae.exports={xperiod:k.xperiod,xperiod0:k.xperiod0,xperiodalignment:k.xperiodalignment,xhoverformat:P("x"),yhoverformat:P("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:b({},t.width,{}),dash:b({},E,{}),editType:"style"},increasing:i(g),decreasing:i(a),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:b({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":387,"../../components/fx/attributes":397,"../../constants/delta.js":473,"../../lib":503,"../../plots/cartesian/axis_format_attributes":557,"../scatter/attributes":927}],873:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=b._,P=c("../../plots/cartesian/axes"),E=c("../../plots/cartesian/align_period"),e=c("../../constants/numerical").BADNUM;function p(i,n){var r=P.getFromId(i,n.xaxis),d=P.getFromId(i,n.yaxis),s=t(i,r,n),m=n._minDiff;n._minDiff=null;var x=n._origX;n._origX=null;var M=n._xcalc;n._xcalc=null;var v=a(i,n,x,M,d,g);return n._extremes[r._id]=P.findExtremes(r,M,{vpad:m/2}),v.length?(b.extendFlat(v[0].t,{wHover:m/2,tickLen:s}),v):[{t:{empty:!0}}]}function g(i,n,r,d){return{o:i,h:n,l:r,c:d}}function a(i,n,r,d,s,m){for(var x=s.makeCalcdata(n,"open"),M=s.makeCalcdata(n,"high"),v=s.makeCalcdata(n,"low"),_=s.makeCalcdata(n,"close"),l=Array.isArray(n.text),y=Array.isArray(n.hovertext),T=!0,w=null,A=!!n.xperiodalignment,f=[],u=0;u<d.length;u++){var h=d[u],o=x[u],S=M[u],R=v[u],z=_[u];if(h!==e&&o!==e&&S!==e&&R!==e&&z!==e){z===o?w!==null&&z!==w&&(T=z>w):T=z>o,w=z;var O=m(o,S,R,z);O.pos=h,O.yc=(o+z)/2,O.i=u,O.dir=T?"increasing":"decreasing",O.x=O.pos,O.y=[R,S],A&&(O.orig_p=r[u]),l&&(O.tx=n.text[u]),y&&(O.htx=n.hovertext[u]),f.push(O)}else f.push({pos:h,empty:!0})}return n._extremes[s._id]=P.findExtremes(s,b.concat(v,M),{padded:!0}),f.length&&(f[0].t={labels:{open:k(i,"open:")+" ",high:k(i,"high:")+" ",low:k(i,"low:")+" ",close:k(i,"close:")+" "}}),f}function t(i,n,r){var d=r._minDiff;if(!d){var s=i._fullData,m=[];d=1/0;var x;for(x=0;x<s.length;x++){var M=s[x];if(M.type==="ohlc"&&M.visible===!0&&M.xaxis===n._id){m.push(M);var v=n.makeCalcdata(M,"x");M._origX=v;var _=E(r,n,"x",v).vals;M._xcalc=_;var l=b.distinctVals(_).minDiff;l&&isFinite(l)&&(d=Math.min(d,l))}}for(d===1/0&&(d=1),x=0;x<m.length;x++)m[x]._minDiff=d}return d*r.tickwidth}ae.exports={calc:p,calcCommon:a}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554}],874:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./ohlc_defaults"),P=c("../scatter/period_defaults"),E=c("./attributes");ae.exports=function(g,a,t,i){function n(d,s){return b.coerce(g,a,E,d,s)}var r=k(g,a,n,i);if(!r){a.visible=!1;return}P(g,a,i,n,{x:!0}),n("xhoverformat"),n("yhoverformat"),n("line.width"),n("line.dash"),e(g,a,n,"increasing"),e(g,a,n,"decreasing"),n("text"),n("hovertext"),n("tickwidth"),i._requestRangeslider[a.xaxis]=!0};function e(p,g,a,t){a(t+".line.color"),a(t+".line.width",g.line.width),a(t+".line.dash",g.line.dash)}},{"../../lib":503,"../scatter/period_defaults":947,"./attributes":872,"./ohlc_defaults":877}],875:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../lib"),P=c("../../components/fx"),E=c("../../components/color"),e=c("../../lib").fillText,p=c("../../constants/delta.js"),g={increasing:p.INCREASING.SYMBOL,decreasing:p.DECREASING.SYMBOL};function a(r,d,s,m){var x=r.cd,M=x[0].trace;return M.hoverlabel.split?i(r,d,s,m):n(r,d,s,m)}function t(r,d,s,m){var x=r.cd,M=r.xa,v=x[0].trace,_=x[0].t,l=v.type,y=l==="ohlc"?"l":"min",T=l==="ohlc"?"h":"max",w,A,f=_.bPos||0,u=function(X){return X.pos+f-d},h=_.bdPos||_.tickLen,o=_.wHover,S=Math.min(1,h/Math.abs(M.r2c(M.range[1])-M.r2c(M.range[0])));w=r.maxHoverDistance-S,A=r.maxSpikeDistance-S;function R(X){var oe=u(X);return P.inbox(oe-o,oe+o,w)}function z(X){var oe=X[y],se=X[T];return oe===se||P.inbox(oe-s,se-s,w)}function O(X){return(R(X)+z(X))/2}var I=P.getDistanceFunction(m,R,z,O);if(P.getClosest(x,I,r),r.index===!1)return null;var F=x[r.index];if(F.empty)return null;var D=F.dir,B=v[D],U=B.line.color;return E.opacity(U)&&B.line.width?r.color=U:r.color=B.fillcolor,r.x0=M.c2p(F.pos+f-h,!0),r.x1=M.c2p(F.pos+f+h,!0),r.xLabelVal=F.orig_p!==void 0?F.orig_p:F.pos,r.spikeDistance=O(F)*A/w,r.xSpike=M.c2p(F.pos,!0),r}function i(r,d,s,m){var x=r.cd,M=r.ya,v=x[0].trace,_=x[0].t,l=[],y=t(r,d,s,m);if(!y)return[];var T=y.index,w=x[T],A=w.hi||v.hoverinfo,f=A.split("+"),u=A==="all",h=u||f.indexOf("y")!==-1;if(!h)return[];for(var o=["high","open","close","low"],S={},R=0;R<o.length;R++){var z=o[R],O=v[z][y.index],I=M.c2p(O,!0),F;O in S?(F=S[O],F.yLabel+="<br>"+_.labels[z]+b.hoverLabelText(M,O,v.yhoverformat)):(F=k.extendFlat({},y),F.y0=F.y1=I,F.yLabelVal=O,F.yLabel=_.labels[z]+b.hoverLabelText(M,O,v.yhoverformat),F.name="",l.push(F),S[O]=F)}return l}function n(r,d,s,m){var x=r.cd,M=r.ya,v=x[0].trace,_=x[0].t,l=t(r,d,s,m);if(!l)return[];var y=l.index,T=x[y],w=l.index=T.i,A=T.dir;function f(O){return _.labels[O]+b.hoverLabelText(M,v[O][w],v.yhoverformat)}var u=T.hi||v.hoverinfo,h=u.split("+"),o=u==="all",S=o||h.indexOf("y")!==-1,R=o||h.indexOf("text")!==-1,z=S?[f("open"),f("high"),f("low"),f("close")+"  "+g[A]]:[];return R&&e(T,v,z),l.extraText=z.join("<br>"),l.y0=l.y1=M.c2p(T.yc,!0),[l]}ae.exports={hoverPoints:a,hoverSplit:i,hoverOnPoints:n}},{"../../components/color":366,"../../components/fx":406,"../../constants/delta.js":473,"../../lib":503,"../../plots/cartesian/axes":554}],876:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"ohlc",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("./calc").calc,plot:c("./plot"),style:c("./style"),hoverPoints:c("./hover").hoverPoints,selectPoints:c("./select")}},{"../../plots/cartesian":568,"./attributes":872,"./calc":873,"./defaults":874,"./hover":875,"./plot":878,"./select":879,"./style":880}],877:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib");ae.exports=function(E,e,p,g){var a=p("x"),t=p("open"),i=p("high"),n=p("low"),r=p("close");p("hoverlabel.split");var d=b.getComponentMethod("calendars","handleTraceDefaults");if(d(E,e,["x"],g),!!(t&&i&&n&&r)){var s=Math.min(t.length,i.length,n.length,r.length);return a&&(s=Math.min(s,k.minRowLength(a))),e._length=s,s}}},{"../../lib":503,"../../registry":638}],878:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib");ae.exports=function(E,e,p,g){var a=e.yaxis,t=e.xaxis,i=!!t.rangebreaks;k.makeTraceGroups(g,p,"trace ohlc").each(function(n){var r=b.select(this),d=n[0],s=d.t,m=d.trace;if(m.visible!==!0||s.empty){r.remove();return}var x=s.tickLen,M=r.selectAll("path").data(k.identity);M.enter().append("path"),M.exit().remove(),M.attr("d",function(v){if(v.empty)return"M0,0Z";var _=t.c2p(v.pos-x,!0),l=t.c2p(v.pos+x,!0),y=i?(_+l)/2:t.c2p(v.pos,!0),T=a.c2p(v.o,!0),w=a.c2p(v.h,!0),A=a.c2p(v.l,!0),f=a.c2p(v.c,!0);return"M"+_+","+T+"H"+y+"M"+y+","+w+"V"+A+"M"+l+","+f+"H"+y})})}},{"../../lib":503,"@plotly/d3":58}],879:[function(c,ae,ie){"use strict";ae.exports=function(k,P){var E=k.cd,e=k.xaxis,p=k.yaxis,g=[],a,t=E[0].t.bPos||0;if(P===!1)for(a=0;a<E.length;a++)E[a].selected=0;else for(a=0;a<E.length;a++){var i=E[a];P.contains([e.c2p(i.pos+t),p.c2p(i.yc)],null,i.i,k)?(g.push({pointNumber:i.i,x:e.c2d(i.pos),y:p.c2d(i.yc)}),i.selected=1):i.selected=0}return g}},{}],880:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/drawing"),P=c("../../components/color");ae.exports=function(e,p,g){var a=g||b.select(e).selectAll("g.ohlclayer").selectAll("g.trace");a.style("opacity",function(t){return t[0].trace.opacity}),a.each(function(t){var i=t[0].trace;b.select(this).selectAll("path").each(function(n){if(!n.empty){var r=i[n.dir].line;b.select(this).style("fill","none").call(P.stroke,r.color).call(k.dashLine,r.dash,r.width).style("opacity",i.selectedpoints&&!n.selected?.3:1)}})})}},{"../../components/color":366,"../../components/drawing":388,"@plotly/d3":58}],881:[function(c,ae,ie){"use strict";var b=c("../../lib/extend").extendFlat,k=c("../../plots/attributes"),P=c("../../plots/font_attributes"),E=c("../../components/colorscale/attributes"),e=c("../../plots/template_attributes").hovertemplateAttrs,p=c("../../plots/domain").attributes,g=b({editType:"calc"},E("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});ae.exports={domain:p({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:b({},k.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:P({editType:"calc"}),tickfont:P({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:g,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/font_attributes":585,"../../plots/template_attributes":633}],882:[function(c,ae,ie){"use strict";var b=c("../../plots/get_data").getModuleCalcData,k=c("./plot"),P="parcats";ie.name=P,ie.plot=function(E,e,p,g){var a=b(E.calcdata,P);if(a.length){var t=a[0];k(E,t,p,g)}},ie.clean=function(E,e,p,g){var a=g._has&&g._has("parcats"),t=e._has&&e._has("parcats");a&&!t&&g._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":593,"./plot":887}],883:[function(c,ae,ie){"use strict";var b=c("../../lib/gup").wrap,k=c("../../components/colorscale/helpers").hasColorscale,P=c("../../components/colorscale/calc"),E=c("../../lib/filter_unique.js"),e=c("../../components/drawing"),p=c("../../lib"),g=c("fast-isnumeric");ae.exports=function(_,l){var y=p.filterVisible(l.dimensions);if(y.length===0)return[];var T=y.map(function(G){var Q;if(G.categoryorder==="trace")Q=null;else if(G.categoryorder==="array")Q=G.categoryarray;else{Q=E(G.values);for(var V=!0,H=0;H<Q.length;H++)if(!g(Q[H])){V=!1;break}Q.sort(V?p.sorterAsc:void 0),G.categoryorder==="category descending"&&(Q=Q.reverse())}return s(G.values,Q)}),w,A,f;p.isArrayOrTypedArray(l.counts)?w=l.counts:w=[l.counts],m(y),y.forEach(function(G,Q){x(G,T[Q])});var u=l.line,h;u?(k(l,"line")&&P(_,l,{vals:l.line.color,containerStr:"line",cLetter:"c"}),h=e.tryColorscale(u)):h=p.identity;function o(G){var Q,V;return p.isArrayOrTypedArray(u.color)?(Q=u.color[G%u.color.length],V=Q):Q=u.color,{color:h(Q),rawColor:V}}var S=y[0].values.length,R={},z=T.map(function(G){return G.inds});f=0;var O,I;for(O=0;O<S;O++){var F=[];for(I=0;I<z.length;I++)F.push(z[I][O]);A=w[O%w.length],f+=A;var D=o(O),B=F+"-"+D.rawColor;R[B]===void 0&&(R[B]=r(F,D.color,D.rawColor)),d(R[B],O,A)}var U=y.map(function(G,Q){return t(Q,G._index,G._displayindex,G.label,f)});for(O=0;O<S;O++)for(A=w[O%w.length],I=0;I<U.length;I++){var X=U[I].containerInd,oe=T[I].inds[O],se=U[I].categories;if(se[oe]===void 0){var q=l.dimensions[X]._categoryarray[oe],K=l.dimensions[X]._ticktext[oe];se[oe]=i(I,oe,q,K)}n(se[oe],O,A)}return b(a(U,R,f))};function a(v,_,l){var y=v.map(function(T){return T.categories.length}).reduce(function(T,w){return Math.max(T,w)});return{dimensions:v,paths:_,trace:void 0,maxCats:y,count:l}}function t(v,_,l,y,T){return{dimensionInd:v,containerInd:_,displayInd:l,dimensionLabel:y,count:T,categories:[],dragX:null}}function i(v,_,l,y){return{dimensionInd:v,categoryInd:_,categoryValue:l,displayInd:_,categoryLabel:y,valueInds:[],count:0,dragY:null}}function n(v,_,l){v.valueInds.push(_),v.count+=l}function r(v,_,l){return{categoryInds:v,color:_,rawColor:l,valueInds:[],count:0}}function d(v,_,l){v.valueInds.push(_),v.count+=l}function s(v,_){_==null?_=[]:_=_.map(function(h){return h});var l={},y={},T=[];_.forEach(function(h,o){l[h]=0,y[h]=o});for(var w=0;w<v.length;w++){var A=v[w],f;l[A]===void 0?(l[A]=1,f=_.push(A)-1,y[A]=f):(l[A]++,f=y[A]),T.push(f)}var u=_.map(function(h){return l[h]});return{uniqueValues:_,uniqueCounts:u,inds:T}}function m(v){var _=v.map(function(y){return y.displayindex}),l;if(M(_))for(l=0;l<v.length;l++)v[l]._displayindex=v[l].displayindex;else for(l=0;l<v.length;l++)v[l]._displayindex=l}function x(v,_){v._categoryarray=_.uniqueValues,v.ticktext===null||v.ticktext===void 0?v._ticktext=[]:v._ticktext=v.ticktext.slice();for(var l=v._ticktext.length;l<_.uniqueValues.length;l++)v._ticktext.push(_.uniqueValues[l])}function M(v){for(var _=new Array(v.length),l=0;l<v.length;l++){if(v[l]<0||v[l]>=v.length||_[v[l]]!==void 0)return!1;_[v[l]]=!0}return!0}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"../../components/drawing":388,"../../lib":503,"../../lib/filter_unique.js":494,"../../lib/gup":500,"fast-isnumeric":190}],884:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/colorscale/helpers").hasColorscale,P=c("../../components/colorscale/defaults"),E=c("../../plots/domain").defaults,e=c("../../plots/array_container_defaults"),p=c("./attributes"),g=c("../parcoords/merge_length");function a(i,n,r,d,s){s("line.shape"),s("line.hovertemplate");var m=s("line.color",d.colorway[0]);if(k(i,"line")&&b.isArrayOrTypedArray(m)){if(m.length)return s("line.colorscale"),P(i,n,d,s,{prefix:"line.",cLetter:"c"}),m.length;n.line.color=r}return 1/0}function t(i,n){function r(_,l){return b.coerce(i,n,p.dimensions,_,l)}var d=r("values"),s=r("visible");if(d&&d.length||(s=n.visible=!1),s){r("label"),r("displayindex",n._index);var m=i.categoryarray,x=Array.isArray(m)&&m.length>0,M;x&&(M="array");var v=r("categoryorder",M);v==="array"?(r("categoryarray"),r("ticktext")):(delete i.categoryarray,delete i.ticktext),!x&&v==="array"&&(n.categoryorder="trace")}}ae.exports=function(n,r,d,s){function m(l,y){return b.coerce(n,r,p,l,y)}var x=e(n,r,{name:"dimensions",handleItemDefaults:t}),M=a(n,r,d,s,m);E(r,s,m),(!Array.isArray(x)||!x.length)&&(r.visible=!1),g(r,x,"values",M),m("hoveron"),m("hovertemplate"),m("arrangement"),m("bundlecolors"),m("sortpaths"),m("counts");var v={family:s.font.family,size:Math.round(s.font.size),color:s.font.color};b.coerceFont(m,"labelfont",v);var _={family:s.font.family,size:Math.round(s.font.size/1.2),color:s.font.color};b.coerceFont(m,"tickfont",_)}},{"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/domain":584,"../parcoords/merge_length":898,"./attributes":881}],885:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("./calc"),plot:c("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:c("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":881,"./base_plot":882,"./calc":883,"./defaults":884,"./plot":887}],886:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("d3-interpolate").interpolateNumber,P=c("../../plot_api/plot_api"),E=c("../../components/fx"),e=c("../../lib"),p=e.strTranslate,g=c("../../components/drawing"),a=c("tinycolor2"),t=c("../../lib/svg_text_utils");function i(H,ee,J,W){var re=H.map(q.bind(0,ee,J)),j=W.selectAll("g.parcatslayer").data([null]);j.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var Z=j.selectAll("g.trace.parcats").data(re,n),ne=Z.enter().append("g").attr("class","trace parcats");Z.attr("transform",function(ye){return p(ye.x,ye.y)}),ne.append("g").attr("class","paths");var le=Z.select("g.paths"),ge=le.selectAll("path.path").data(function(ye){return ye.paths},n);ge.attr("fill",function(ye){return ye.model.color});var pe=ge.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(ye){return ye.model.color}).attr("fill-opacity",0);_(pe),ge.attr("d",function(ye){return ye.svgD}),pe.empty()||ge.sort(d),ge.exit().remove(),ge.on("mouseover",s).on("mouseout",m).on("click",v),ne.append("g").attr("class","dimensions");var xe=Z.select("g.dimensions"),Ee=xe.selectAll("g.dimension").data(function(ye){return ye.dimensions},n);Ee.enter().append("g").attr("class","dimension"),Ee.attr("transform",function(ye){return p(ye.x,0)}),Ee.exit().remove();var Te=Ee.selectAll("g.category").data(function(ye){return ye.categories},n),de=Te.enter().append("g").attr("class","category");Te.attr("transform",function(ye){return p(0,ye.y)}),de.append("rect").attr("class","catrect").attr("pointer-events","none"),Te.select("rect.catrect").attr("fill","none").attr("width",function(ye){return ye.width}).attr("height",function(ye){return ye.height}),T(de);var be=Te.selectAll("rect.bandrect").data(function(ye){return ye.bands},n);be.each(function(){e.raiseToTop(this)}),be.attr("fill",function(ye){return ye.color});var Le=be.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(ye){return ye.color}).attr("fill-opacity",0);be.attr("fill",function(ye){return ye.color}).attr("width",function(ye){return ye.width}).attr("height",function(ye){return ye.height}).attr("y",function(ye){return ye.y}).attr("cursor",function(ye){return ye.parcatsViewModel.arrangement==="fixed"?"default":ye.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),A(Le),be.exit().remove(),de.append("text").attr("class","catlabel").attr("pointer-events","none");var De=ee._fullLayout.paper_bgcolor;Te.select("text.catlabel").attr("text-anchor",function(ye){return r(ye)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",t.makeTextShadow(De)).style("fill","rgb(0, 0, 0)").attr("x",function(ye){return r(ye)?ye.width+5:-5}).attr("y",function(ye){return ye.height/2}).text(function(ye){return ye.model.categoryLabel}).each(function(ye){g.font(b.select(this),ye.parcatsViewModel.categorylabelfont),t.convertToTspans(b.select(this),ee)}),de.append("text").attr("class","dimlabel"),Te.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(ye){return ye.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(ye){return ye.width/2}).attr("y",-5).text(function(ye,ke){return ke===0?ye.parcatsViewModel.model.dimensions[ye.model.dimensionInd].dimensionLabel:null}).each(function(ye){g.font(b.select(this),ye.parcatsViewModel.labelfont)}),Te.selectAll("rect.bandrect").on("mouseover",I).on("mouseout",F),Te.exit().remove(),Ee.call(b.behavior.drag().origin(function(ye){return{x:ye.x,y:0}}).on("dragstart",D).on("drag",B).on("dragend",U)),Z.each(function(ye){ye.traceSelection=b.select(this),ye.pathSelection=b.select(this).selectAll("g.paths").selectAll("path.path"),ye.dimensionSelection=b.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),Z.exit().remove()}ae.exports=function(H,ee,J,W){i(J,H,W,ee)};function n(H){return H.key}function r(H){var ee=H.parcatsViewModel.dimensions.length,J=H.parcatsViewModel.dimensions[ee-1].model.dimensionInd;return H.model.dimensionInd===J}function d(H,ee){return H.model.rawColor>ee.model.rawColor?1:H.model.rawColor<ee.model.rawColor?-1:0}function s(H){if(!H.parcatsViewModel.dragDimension&&H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),l(b.select(this));var ee=x(H),J=M(H);if(H.parcatsViewModel.graphDiv.emit("plotly_hover",{points:ee,event:b.event,constraints:J}),H.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var W=b.mouse(this)[0],re=H.parcatsViewModel.graphDiv,j=H.parcatsViewModel.trace,Z=re._fullLayout,ne=Z._paperdiv.node().getBoundingClientRect(),le=H.parcatsViewModel.graphDiv.getBoundingClientRect(),ge,pe,xe;for(xe=0;xe<H.leftXs.length-1;xe++)if(H.leftXs[xe]+H.dimWidths[xe]-2<=W&&W<=H.leftXs[xe+1]+2){var Ee=H.parcatsViewModel.dimensions[xe],Te=H.parcatsViewModel.dimensions[xe+1];ge=(Ee.x+Ee.width+Te.x)/2,pe=(H.topYs[xe]+H.topYs[xe+1]+H.height)/2;break}var de=H.parcatsViewModel.x+ge,be=H.parcatsViewModel.y+pe,Le=a.mostReadable(H.model.color,["black","white"]),De=H.model.count,ye=De/H.parcatsViewModel.model.count,ke={countLabel:De,probabilityLabel:ye.toFixed(3)},Oe=[];H.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Oe.push(["Count:",ke.countLabel].join(" ")),H.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&Oe.push(["P:",ke.probabilityLabel].join(" "));var Qe=Oe.join("<br>"),Ve=b.mouse(re)[0];E.loneHover({trace:j,x:de-ne.left+le.left,y:be-ne.top+le.top,text:Qe,color:H.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:Le,idealAlign:Ve<de?"right":"left",hovertemplate:(j.line||{}).hovertemplate,hovertemplateLabels:ke,eventData:[{data:j._input,fullData:j,count:De,probability:ye}]},{container:Z._hoverlayer.node(),outerContainer:Z._paper.node(),gd:re})}}}function m(H){if(!H.parcatsViewModel.dragDimension&&(_(b.select(this)),E.loneUnhover(H.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),H.parcatsViewModel.pathSelection.sort(d),H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var ee=x(H),J=M(H);H.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:ee,event:b.event,constraints:J})}}function x(H){for(var ee=[],J=X(H.parcatsViewModel),W=0;W<H.model.valueInds.length;W++){var re=H.model.valueInds[W];ee.push({curveNumber:J,pointNumber:re})}return ee}function M(H){for(var ee={},J=H.parcatsViewModel.model.dimensions,W=0;W<J.length;W++){var re=J[W],j=re.categories[H.model.categoryInds[W]];ee[re.containerInd]=j.categoryValue}return H.model.rawColor!==void 0&&(ee.color=H.model.rawColor),ee}function v(H){if(H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var ee=x(H),J=M(H);H.parcatsViewModel.graphDiv.emit("plotly_click",{points:ee,event:b.event,constraints:J})}}function _(H){H.attr("fill",function(ee){return ee.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function l(H){H.attr("fill-opacity",.8).attr("stroke",function(ee){return a.mostReadable(ee.model.color,["black","white"])}).attr("stroke-width",.3)}function y(H){H.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function T(H){H.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function w(H){H.attr("stroke","black").attr("stroke-width",1.5)}function A(H){H.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function f(H){var ee=H.parcatsViewModel.pathSelection,J=H.categoryViewModel.model.dimensionInd,W=H.categoryViewModel.model.categoryInd;return ee.filter(function(re){return re.model.categoryInds[J]===W&&re.model.color===H.color})}function u(H){var ee=b.select(H.parentNode).selectAll("rect.bandrect");ee.each(function(J){var W=f(J);l(W),W.each(function(){e.raiseToTop(this)})}),y(b.select(H.parentNode))}function h(H){var ee=b.select(H).datum(),J=f(ee);l(J),J.each(function(){e.raiseToTop(this)}),b.select(H.parentNode).selectAll("rect.bandrect").filter(function(W){return W.color===ee.color}).each(function(){e.raiseToTop(this),w(b.select(this))})}function o(H,ee,J){var W=b.select(H).datum(),re=W.categoryViewModel.model,j=W.parcatsViewModel.graphDiv,Z=b.select(H.parentNode).selectAll("rect.bandrect"),ne=[];Z.each(function(ge){var pe=f(ge);pe.each(function(xe){Array.prototype.push.apply(ne,x(xe))})});var le={};le[re.dimensionInd]=re.categoryValue,j.emit(ee,{points:ne,event:J,constraints:le})}function S(H,ee,J){var W=b.select(H).datum(),re=W.categoryViewModel.model,j=W.parcatsViewModel.graphDiv,Z=f(W),ne=[];Z.each(function(ge){Array.prototype.push.apply(ne,x(ge))});var le={};le[re.dimensionInd]=re.categoryValue,W.rawColor!==void 0&&(le.color=W.rawColor),j.emit(ee,{points:ne,event:J,constraints:le})}function R(H,ee,J){H._fullLayout._calcInverseTransform(H);var W=H._fullLayout._invScaleX,re=H._fullLayout._invScaleY,j=b.select(J.parentNode).select("rect.catrect"),Z=j.node().getBoundingClientRect(),ne=j.datum(),le=ne.parcatsViewModel,ge=le.model.dimensions[ne.model.dimensionInd],pe=le.trace,xe=Z.top+Z.height/2,Ee,Te;le.dimensions.length>1&&ge.displayInd===le.dimensions.length-1?(Ee=Z.left,Te="left"):(Ee=Z.left+Z.width,Te="right");var de=ne.model.count,be=ne.model.categoryLabel,Le=de/ne.parcatsViewModel.model.count,De={countLabel:de,categoryLabel:be,probabilityLabel:Le.toFixed(3)},ye=[];ne.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&ye.push(["Count:",De.countLabel].join(" ")),ne.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&ye.push(["P("+De.categoryLabel+"):",De.probabilityLabel].join(" "));var ke=ye.join("<br>");return{trace:pe,x:W*(Ee-ee.left),y:re*(xe-ee.top),text:ke,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:Te,hovertemplate:pe.hovertemplate,hovertemplateLabels:De,eventData:[{data:pe._input,fullData:pe,count:de,category:be,probability:Le}]}}function z(H,ee,J){var W=[];return b.select(J.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){var re=this;W.push(R(H,ee,re))}),W}function O(H,ee,J){H._fullLayout._calcInverseTransform(H);var W=H._fullLayout._invScaleX,re=H._fullLayout._invScaleY,j=J.getBoundingClientRect(),Z=b.select(J).datum(),ne=Z.categoryViewModel,le=ne.parcatsViewModel,ge=le.model.dimensions[ne.model.dimensionInd],pe=le.trace,xe=j.y+j.height/2,Ee,Te;le.dimensions.length>1&&ge.displayInd===le.dimensions.length-1?(Ee=j.left,Te="left"):(Ee=j.left+j.width,Te="right");var de=ne.model.categoryLabel,be=Z.parcatsViewModel.model.count,Le=0;Z.categoryViewModel.bands.forEach(function(pt){pt.color===Z.color&&(Le+=pt.count)});var De=ne.model.count,ye=0;le.pathSelection.each(function(pt){pt.model.color===Z.color&&(ye+=pt.model.count)});var ke=Le/be,Oe=Le/ye,Qe=Le/De,Ve={countLabel:be,categoryLabel:de,probabilityLabel:ke.toFixed(3)},Ue=[];ne.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Ue.push(["Count:",Ve.countLabel].join(" ")),ne.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(Ue.push("P(color \u2229 "+de+"): "+Ve.probabilityLabel),Ue.push("P("+de+" | color): "+Oe.toFixed(3)),Ue.push("P(color | "+de+"): "+Qe.toFixed(3)));var Ie=Ue.join("<br>"),at=a.mostReadable(Z.color,["black","white"]);return{trace:pe,x:W*(Ee-ee.left),y:re*(xe-ee.top),text:Ie,color:Z.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:at,fontSize:10,idealAlign:Te,hovertemplate:pe.hovertemplate,hovertemplateLabels:Ve,eventData:[{data:pe._input,fullData:pe,category:de,count:be,probability:ke,categorycount:De,colorcount:ye,bandcolorcount:Le}]}}function I(H){if(!H.parcatsViewModel.dragDimension&&H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var ee=b.mouse(this)[1];if(ee<-1)return;var J=H.parcatsViewModel.graphDiv,W=J._fullLayout,re=W._paperdiv.node().getBoundingClientRect(),j=H.parcatsViewModel.hoveron,Z=this;if(j==="color"?(h(Z),S(Z,"plotly_hover",b.event)):(u(Z),o(Z,"plotly_hover",b.event)),H.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var ne;j==="category"?ne=R(J,re,Z):j==="color"?ne=O(J,re,Z):j==="dimension"&&(ne=z(J,re,Z)),ne&&E.loneHover(ne,{container:W._hoverlayer.node(),outerContainer:W._paper.node(),gd:J})}}}function F(H){var ee=H.parcatsViewModel;if(!ee.dragDimension&&(_(ee.pathSelection),T(ee.dimensionSelection.selectAll("g.category")),A(ee.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),E.loneUnhover(ee.graphDiv._fullLayout._hoverlayer.node()),ee.pathSelection.sort(d),ee.hoverinfoItems.indexOf("skip")===-1)){var J=H.parcatsViewModel.hoveron,W=this;J==="color"?S(W,"plotly_unhover",b.event):o(W,"plotly_unhover",b.event)}}function D(H){H.parcatsViewModel.arrangement!=="fixed"&&(H.dragDimensionDisplayInd=H.model.displayInd,H.initialDragDimensionDisplayInds=H.parcatsViewModel.model.dimensions.map(function(ee){return ee.displayInd}),H.dragHasMoved=!1,H.dragCategoryDisplayInd=null,b.select(this).selectAll("g.category").select("rect.catrect").each(function(ee){var J=b.mouse(this)[0],W=b.mouse(this)[1];-2<=J&&J<=ee.width+2&&-2<=W&&W<=ee.height+2&&(H.dragCategoryDisplayInd=ee.model.displayInd,H.initialDragCategoryDisplayInds=H.model.categories.map(function(re){return re.displayInd}),ee.model.dragY=ee.y,e.raiseToTop(this.parentNode),b.select(this.parentNode).selectAll("rect.bandrect").each(function(re){re.y<W&&W<=re.y+re.height&&(H.potentialClickBand=this)}))}),H.parcatsViewModel.dragDimension=H,E.loneUnhover(H.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function B(H){if(H.parcatsViewModel.arrangement!=="fixed"&&(H.dragHasMoved=!0,H.dragDimensionDisplayInd!==null)){var ee=H.dragDimensionDisplayInd,J=ee-1,W=ee+1,re=H.parcatsViewModel.dimensions[ee];if(H.dragCategoryDisplayInd!==null){var j=re.categories[H.dragCategoryDisplayInd];j.model.dragY+=b.event.dy;var Z=j.model.dragY,ne=j.model.displayInd,le=re.categories,ge=le[ne-1],pe=le[ne+1];ge!==void 0&&Z<ge.y+ge.height/2&&(j.model.displayInd=ge.model.displayInd,ge.model.displayInd=ne),pe!==void 0&&Z+j.height>pe.y+pe.height/2&&(j.model.displayInd=pe.model.displayInd,pe.model.displayInd=ne),H.dragCategoryDisplayInd=j.model.displayInd}if(H.dragCategoryDisplayInd===null||H.parcatsViewModel.arrangement==="freeform"){re.model.dragX=b.event.x;var xe=H.parcatsViewModel.dimensions[J],Ee=H.parcatsViewModel.dimensions[W];xe!==void 0&&re.model.dragX<xe.x+xe.width&&(re.model.displayInd=xe.model.displayInd,xe.model.displayInd=ee),Ee!==void 0&&re.model.dragX+re.width>Ee.x&&(re.model.displayInd=Ee.model.displayInd,Ee.model.displayInd=H.dragDimensionDisplayInd),H.dragDimensionDisplayInd=re.model.displayInd}Q(H.parcatsViewModel),G(H.parcatsViewModel),se(H.parcatsViewModel),oe(H.parcatsViewModel)}}function U(H){if(H.parcatsViewModel.arrangement!=="fixed"&&H.dragDimensionDisplayInd!==null){b.select(this).selectAll("text").attr("font-weight","normal");var ee={},J=X(H.parcatsViewModel),W=H.parcatsViewModel.model.dimensions.map(function(Ee){return Ee.displayInd}),re=H.initialDragDimensionDisplayInds.some(function(Ee,Te){return Ee!==W[Te]});re&&W.forEach(function(Ee,Te){var de=H.parcatsViewModel.model.dimensions[Te].containerInd;ee["dimensions["+de+"].displayindex"]=Ee});var j=!1;if(H.dragCategoryDisplayInd!==null){var Z=H.model.categories.map(function(Ee){return Ee.displayInd});if(j=H.initialDragCategoryDisplayInds.some(function(Ee,Te){return Ee!==Z[Te]}),j){var ne=H.model.categories.slice().sort(function(Ee,Te){return Ee.displayInd-Te.displayInd}),le=ne.map(function(Ee){return Ee.categoryValue}),ge=ne.map(function(Ee){return Ee.categoryLabel});ee["dimensions["+H.model.containerInd+"].categoryarray"]=[le],ee["dimensions["+H.model.containerInd+"].ticktext"]=[ge],ee["dimensions["+H.model.containerInd+"].categoryorder"]="array"}}if(H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!H.dragHasMoved&&H.potentialClickBand&&(H.parcatsViewModel.hoveron==="color"?S(H.potentialClickBand,"plotly_click",b.event.sourceEvent):o(H.potentialClickBand,"plotly_click",b.event.sourceEvent)),H.model.dragX=null,H.dragCategoryDisplayInd!==null){var pe=H.parcatsViewModel.dimensions[H.dragDimensionDisplayInd].categories[H.dragCategoryDisplayInd];pe.model.dragY=null,H.dragCategoryDisplayInd=null}H.dragDimensionDisplayInd=null,H.parcatsViewModel.dragDimension=null,H.dragHasMoved=null,H.potentialClickBand=null,Q(H.parcatsViewModel),G(H.parcatsViewModel);var xe=b.transition().duration(300).ease("cubic-in-out");xe.each(function(){se(H.parcatsViewModel,!0),oe(H.parcatsViewModel,!0)}).each("end",function(){(re||j)&&P.restyle(H.parcatsViewModel.graphDiv,ee,[J])})}}function X(H){for(var ee,J=H.graphDiv._fullData,W=0;W<J.length;W++)if(H.key===J[W].uid){ee=W;break}return ee}function oe(H,ee){ee===void 0&&(ee=!1);function J(W){return ee?W.transition():W}H.pathSelection.data(function(W){return W.paths},n),J(H.pathSelection).attr("d",function(W){return W.svgD})}function se(H,ee){ee===void 0&&(ee=!1);function J(le){return ee?le.transition():le}H.dimensionSelection.data(function(le){return le.dimensions},n);var W=H.dimensionSelection.selectAll("g.category").data(function(le){return le.categories},n);J(H.dimensionSelection).attr("transform",function(le){return p(le.x,0)}),J(W).attr("transform",function(le){return p(0,le.y)});var re=W.select(".dimlabel");re.text(function(le,ge){return ge===0?le.parcatsViewModel.model.dimensions[le.model.dimensionInd].dimensionLabel:null});var j=W.select(".catlabel");j.attr("text-anchor",function(le){return r(le)?"start":"end"}).attr("x",function(le){return r(le)?le.width+5:-5}).each(function(le){var ge,pe;r(le)?(ge=le.width+5,pe="start"):(ge=-5,pe="end"),b.select(this).selectAll("tspan").attr("x",ge).attr("text-anchor",pe)});var Z=W.selectAll("rect.bandrect").data(function(le){return le.bands},n),ne=Z.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(le){return le.color}).attr("fill-opacity",0);Z.attr("fill",function(le){return le.color}).attr("width",function(le){return le.width}).attr("height",function(le){return le.height}).attr("y",function(le){return le.y}),A(ne),Z.each(function(){e.raiseToTop(this)}),Z.exit().remove()}function q(H,ee,J){var W=J[0],re=ee.margin||{l:80,r:80,t:100,b:80},j=W.trace,Z=j.domain,ne=ee.width,le=ee.height,ge=Math.floor(ne*(Z.x[1]-Z.x[0])),pe=Math.floor(le*(Z.y[1]-Z.y[0])),xe=Z.x[0]*ne+re.l,Ee=ee.height-Z.y[1]*ee.height+re.t,Te=j.line.shape,de;j.hoverinfo==="all"?de=["count","probability"]:de=(j.hoverinfo||"").split("+");var be={trace:j,key:j.uid,model:W,x:xe,y:Ee,width:ge,height:pe,hoveron:j.hoveron,hoverinfoItems:de,arrangement:j.arrangement,bundlecolors:j.bundlecolors,sortpaths:j.sortpaths,labelfont:j.labelfont,categorylabelfont:j.tickfont,pathShape:Te,dragDimension:null,margin:re,paths:[],dimensions:[],graphDiv:H,traceSelection:null,pathSelection:null,dimensionSelection:null};return W.dimensions&&(Q(be),G(be)),be}function K(H,ee,J,W,re){var j=[],Z=[],ne,le;for(le=0;le<J.length-1;le++)ne=k(J[le]+H[le],H[le+1]),j.push(ne(re)),Z.push(ne(1-re));var ge="M "+H[0]+","+ee[0];for(ge+="l"+J[0]+",0 ",le=1;le<J.length;le++)ge+="C"+j[le-1]+","+ee[le-1]+" "+Z[le-1]+","+ee[le]+" "+H[le]+","+ee[le],ge+="l"+J[le]+",0 ";for(ge+="l0,"+W+" ",ge+="l -"+J[J.length-1]+",0 ",le=J.length-2;le>=0;le--)ge+="C"+Z[le]+","+(ee[le+1]+W)+" "+j[le]+","+(ee[le]+W)+" "+(H[le]+J[le])+","+(ee[le]+W),ge+="l-"+J[le]+",0 ";return ge+="Z",ge}function G(H){var ee=H.dimensions,J=H.model,W=ee.map(function(It){return It.categories.map(function(Bt){return Bt.y})}),re=H.model.dimensions.map(function(It){return It.categories.map(function(Bt){return Bt.displayInd})}),j=H.model.dimensions.map(function(It){return It.displayInd}),Z=H.dimensions.map(function(It){return It.model.dimensionInd}),ne=ee.map(function(It){return It.x}),le=ee.map(function(It){return It.width}),ge=[];for(var pe in J.paths)J.paths.hasOwnProperty(pe)&&ge.push(J.paths[pe]);function xe(It){var Bt=It.categoryInds.map(function(_t,it){return re[it][_t]}),St=Z.map(function(_t){return Bt[_t]});return St}ge.sort(function(It,Bt){var St=xe(It),_t=xe(Bt);return H.sortpaths==="backward"&&(St.reverse(),_t.reverse()),St.push(It.valueInds[0]),_t.push(Bt.valueInds[0]),H.bundlecolors&&(St.unshift(It.rawColor),_t.unshift(Bt.rawColor)),St<_t?-1:St>_t?1:0});for(var Ee=new Array(ge.length),Te=ee[0].model.count,de=ee[0].categories.map(function(It){return It.height}).reduce(function(It,Bt){return It+Bt}),be=0;be<ge.length;be++){var Le=ge[be],De;Te>0?De=de*(Le.count/Te):De=0;for(var ye=new Array(W.length),ke=0;ke<Le.categoryInds.length;ke++){var Oe=Le.categoryInds[ke],Qe=re[ke][Oe],Ve=j[ke];ye[Ve]=W[Ve][Qe],W[Ve][Qe]+=De;var Ue=H.dimensions[Ve].categories[Qe],Ie=Ue.bands.length,at=Ue.bands[Ie-1];if(at===void 0||Le.rawColor!==at.rawColor){var pt=at===void 0?0:at.y+at.height;Ue.bands.push({key:pt,color:Le.color,rawColor:Le.rawColor,height:De,width:Ue.width,count:Le.count,y:pt,categoryViewModel:Ue,parcatsViewModel:H})}else{var Rt=Ue.bands[Ie-1];Rt.height+=De,Rt.count+=Le.count}}var Mt;H.pathShape==="hspline"?Mt=K(ne,ye,le,De,.5):Mt=K(ne,ye,le,De,0),Ee[be]={key:Le.valueInds[0],model:Le,height:De,leftXs:ne,topYs:ye,dimWidths:le,svgD:Mt,parcatsViewModel:H}}H.paths=Ee}function Q(H){var ee=H.model.dimensions.map(function(Z){return{displayInd:Z.displayInd,dimensionInd:Z.dimensionInd}});ee.sort(function(Z,ne){return Z.displayInd-ne.displayInd});var J=[];for(var W in ee){var re=ee[W].dimensionInd,j=H.model.dimensions[re];J.push(V(H,j))}H.dimensions=J}function V(H,ee){var J=40,W=16,re=H.model.dimensions.length,j=ee.displayInd,Z,ne,le;re>1?Z=(H.width-2*J-W)/(re-1):Z=0,ne=J,le=ne+Z*j;var ge=[],pe=H.model.maxCats,xe=ee.categories.length,Ee=8,Te=ee.count,de=H.height-Ee*(pe-1),be,Le,De,ye,ke,Oe=(pe-xe)*Ee/2,Qe=ee.categories.map(function(Ve){return{displayInd:Ve.displayInd,categoryInd:Ve.categoryInd}});for(Qe.sort(function(Ve,Ue){return Ve.displayInd-Ue.displayInd}),ke=0;ke<xe;ke++)ye=Qe[ke].categoryInd,Le=ee.categories[ye],Te>0?be=Le.count/Te*de:be=0,De={key:Le.valueInds[0],model:Le,width:W,height:be,y:Le.dragY!==null?Le.dragY:Oe,bands:[],parcatsViewModel:H},Oe=Oe+be+Ee,ge.push(De);return{key:ee.dimensionInd,x:ee.dragX!==null?ee.dragX:le,y:0,width:W,model:ee,categories:ge,parcatsViewModel:H,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}},{"../../components/drawing":388,"../../components/fx":406,"../../lib":503,"../../lib/svg_text_utils":529,"../../plot_api/plot_api":540,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:312}],887:[function(c,ae,ie){"use strict";var b=c("./parcats");ae.exports=function(P,E,e,p){var g=P._fullLayout,a=g._paper,t=g._size;b(P,a,E,{width:t.w,height:t.h,margin:{t:t.t,r:t.r,b:t.b,l:t.l}},e,p)}},{"./parcats":886}],888:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/attributes"),k=c("../../plots/cartesian/layout_attributes"),P=c("../../plots/font_attributes"),E=c("../../plots/domain").attributes,e=c("../../lib/extend").extendFlat,p=c("../../plot_api/plot_template").templatedArray;ae.exports={domain:E({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:P({editType:"plot"}),tickfont:P({editType:"plot"}),rangefont:P({editType:"plot"}),dimensions:p("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},k.tickvals,{editType:"plot"}),ticktext:e({},k.ticktext,{editType:"plot"}),tickformat:e({},k.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},b("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../plots/cartesian/layout_attributes":569,"../../plots/domain":584,"../../plots/font_attributes":585}],889:[function(c,ae,ie){"use strict";var b=c("./constants"),k=c("@plotly/d3"),P=c("../../lib/gup").keyFun,E=c("../../lib/gup").repeat,e=c("../../lib").sorterAsc,p=c("../../lib").strTranslate,g=b.bar.snapRatio;function a(U,X){return U*(1-g)+X*g}var t=b.bar.snapClose;function i(U,X){return U*(1-t)+X*t}function n(U,X,oe,se){if(r(oe,se))return oe;var q=U?-1:1,K=0,G=X.length-1;if(q<0){var Q=K;K=G,G=Q}for(var V=X[K],H=V,ee=K;q*ee<q*G;ee+=q){var J=ee+q,W=X[J];if(q*oe<q*i(V,W))return a(V,H);if(q*oe<q*W||J===G)return a(W,V);H=V,V=W}}function r(U,X){for(var oe=0;oe<X.length;oe++)if(U>=X[oe][0]&&U<=X[oe][1])return!0;return!1}function d(U){U.attr("x",-b.bar.captureWidth/2).attr("width",b.bar.captureWidth)}function s(U){U.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function m(U){if(!U.brush.filterSpecified)return"0,"+U.height;for(var X=x(U.brush.filter.getConsolidated(),U.height),oe=[0],se,q,K,G=X.length?X[0][0]:null,Q=0;Q<X.length;Q++)se=X[Q],q=se[1]-se[0],oe.push(G),oe.push(q),K=Q+1,K<X.length&&(G=X[K][0]-se[1]);return oe.push(U.height),oe}function x(U,X){return U.map(function(oe){return oe.map(function(se){return Math.max(0,se*X)}).sort(e)})}function M(U,X){var oe=b.bar.handleHeight;if(!(X>U[1]+oe||X<U[0]-oe))return X>=.9*U[1]+.1*U[0]?"n":X<=.9*U[0]+.1*U[1]?"s":"ns"}function v(){k.select(document.body).style("cursor",null)}function _(U){U.attr("stroke-dasharray",m)}function l(U,X){var oe=k.select(U).selectAll(".highlight, .highlight-shadow"),se=X?oe.transition().duration(b.bar.snapDuration).each("end",X):oe;_(se)}function y(U,X){var oe=U.brush,se=oe.filterSpecified,q=NaN,K={},G;if(se){var Q=U.height,V=oe.filter.getConsolidated(),H=x(V,Q),ee=NaN,J=NaN,W=NaN;for(G=0;G<=H.length;G++){var re=H[G];if(re&&re[0]<=X&&X<=re[1]){ee=G;break}else if(J=G?G-1:NaN,re&&re[0]>X){W=G;break}}if(q=ee,isNaN(q)&&(isNaN(J)||isNaN(W)?q=isNaN(J)?W:J:q=X-H[J][1]<H[W][0]-X?J:W),!isNaN(q)){var j=H[q],Z=M(j,X);Z&&(K.interval=V[q],K.intervalPix=j,K.region=Z)}}if(U.ordinal&&!K.region){var ne=U.unitTickvals,le=U.unitToPaddedPx.invert(X);for(G=0;G<ne.length;G++){var ge=[ne[Math.max(G-1,0)]*.25+ne[G]*.75,ne[Math.min(G+1,ne.length-1)]*.25+ne[G]*.75];if(le>=ge[0]&&le<=ge[1]){K.clickableOrdinalRange=ge;break}}}return K}function T(U,X){k.event.sourceEvent.stopPropagation();var oe=X.height-k.mouse(U)[1]-2*b.verticalPadding,se=X.unitToPaddedPx.invert(oe),q=X.brush,K=y(X,oe),G=K.interval,Q=q.svgBrush;if(Q.wasDragged=!1,Q.grabbingBar=K.region==="ns",Q.grabbingBar){var V=G.map(X.unitToPaddedPx);Q.grabPoint=oe-V[0]-b.verticalPadding,Q.barLength=V[1]-V[0]}Q.clickableOrdinalRange=K.clickableOrdinalRange,Q.stayingIntervals=X.multiselect&&q.filterSpecified?q.filter.getConsolidated():[],G&&(Q.stayingIntervals=Q.stayingIntervals.filter(function(H){return H[0]!==G[0]&&H[1]!==G[1]})),Q.startExtent=K.region?G[K.region==="s"?1:0]:se,X.parent.inBrushDrag=!0,Q.brushStartCallback()}function w(U,X){k.event.sourceEvent.stopPropagation();var oe=X.height-k.mouse(U)[1]-2*b.verticalPadding,se=X.brush.svgBrush;se.wasDragged=!0,se._dragging=!0,se.grabbingBar?se.newExtent=[oe-se.grabPoint,oe+se.barLength-se.grabPoint].map(X.unitToPaddedPx.invert):se.newExtent=[se.startExtent,X.unitToPaddedPx.invert(oe)].sort(e),X.brush.filterSpecified=!0,se.extent=se.stayingIntervals.concat([se.newExtent]),se.brushCallback(X),l(U.parentNode)}function A(U,X){var oe=X.brush,se=oe.filter,q=oe.svgBrush;q._dragging||(f(U,X),w(U,X),X.brush.svgBrush.wasDragged=!1),q._dragging=!1;var K=k.event;K.sourceEvent.stopPropagation();var G=q.grabbingBar;if(q.grabbingBar=!1,q.grabLocation=void 0,X.parent.inBrushDrag=!1,v(),!q.wasDragged){q.wasDragged=void 0,q.clickableOrdinalRange?oe.filterSpecified&&X.multiselect?q.extent.push(q.clickableOrdinalRange):(q.extent=[q.clickableOrdinalRange],oe.filterSpecified=!0):G?(q.extent=q.stayingIntervals,q.extent.length===0&&z(oe)):z(oe),q.brushCallback(X),l(U.parentNode),q.brushEndCallback(oe.filterSpecified?se.getConsolidated():[]);return}var Q=function(){se.set(se.getConsolidated())};if(X.ordinal){var V=X.unitTickvals;V[V.length-1]<V[0]&&V.reverse(),q.newExtent=[n(0,V,q.newExtent[0],q.stayingIntervals),n(1,V,q.newExtent[1],q.stayingIntervals)];var H=q.newExtent[1]>q.newExtent[0];q.extent=q.stayingIntervals.concat(H?[q.newExtent]:[]),q.extent.length||z(oe),q.brushCallback(X),H?l(U.parentNode,Q):(Q(),l(U.parentNode))}else Q();q.brushEndCallback(oe.filterSpecified?se.getConsolidated():[])}function f(U,X){var oe=X.height-k.mouse(U)[1]-2*b.verticalPadding,se=y(X,oe),q="crosshair";se.clickableOrdinalRange?q="pointer":se.region&&(q=se.region+"-resize"),k.select(document.body).style("cursor",q)}function u(U){U.on("mousemove",function(X){k.event.preventDefault(),X.parent.inBrushDrag||f(this,X)}).on("mouseleave",function(X){X.parent.inBrushDrag||v()}).call(k.behavior.drag().on("dragstart",function(X){T(this,X)}).on("drag",function(X){w(this,X)}).on("dragend",function(X){A(this,X)}))}function h(U,X){return U[0]-X[0]}function o(U,X){var oe=U.selectAll(".background").data(E);oe.enter().append("rect").classed("background",!0).call(d).call(s).style("pointer-events","auto").attr("transform",p(0,b.verticalPadding)),oe.call(u).attr("height",function(K){return K.height-b.verticalPadding});var se=U.selectAll(".highlight-shadow").data(E);se.enter().append("line").classed("highlight-shadow",!0).attr("x",-b.bar.width/2).attr("stroke-width",b.bar.width+b.bar.strokeWidth).attr("stroke",X).attr("opacity",b.bar.strokeOpacity).attr("stroke-linecap","butt"),se.attr("y1",function(K){return K.height}).call(_);var q=U.selectAll(".highlight").data(E);q.enter().append("line").classed("highlight",!0).attr("x",-b.bar.width/2).attr("stroke-width",b.bar.width-b.bar.strokeWidth).attr("stroke",b.bar.fillColor).attr("opacity",b.bar.fillOpacity).attr("stroke-linecap","butt"),q.attr("y1",function(K){return K.height}).call(_)}function S(U,X){var oe=U.selectAll("."+b.cn.axisBrush).data(E,P);oe.enter().append("g").classed(b.cn.axisBrush,!0),o(oe,X)}function R(U){return U.svgBrush.extent.map(function(X){return X.slice()})}function z(U){U.filterSpecified=!1,U.svgBrush.extent=[[-1/0,1/0]]}function O(U){return function(oe){var se=oe.brush,q=R(se),K=q.slice();se.filter.set(K),U()}}function I(U){for(var X=U.slice(),oe=[],se,q=X.shift();q;){for(se=q.slice();(q=X.shift())&&q[0]<=se[1];)se[1]=Math.max(se[1],q[1]);oe.push(se)}return oe.length===1&&oe[0][0]>oe[0][1]&&(oe=[]),oe}function F(){var U=[],X,oe;return{set:function(se){U=se.map(function(q){return q.slice().sort(e)}).sort(h),U.length===1&&U[0][0]===-1/0&&U[0][1]===1/0&&(U=[[0,-1]]),X=I(U),oe=U.reduce(function(q,K){return[Math.min(q[0],K[0]),Math.max(q[1],K[1])]},[1/0,-1/0])},get:function(){return U.slice()},getConsolidated:function(){return X},getBounds:function(){return oe}}}function D(U,X,oe,se,q,K){var G=F();return G.set(oe),{filter:G,filterSpecified:X,svgBrush:{extent:[],brushStartCallback:se,brushCallback:O(q),brushEndCallback:K}}}function B(U,X){if(Array.isArray(U[0])?(U=U.map(function(se){return se.sort(e)}),X.multiselect?U=I(U.sort(h)):U=[U[0]]):U=[U.sort(e)],X.tickvals){var oe=X.tickvals.slice().sort(e);if(U=U.map(function(se){var q=[n(0,oe,se[0],[]),n(1,oe,se[1],[])];if(q[1]>q[0])return q}).filter(function(se){return se}),!U.length)return}return U.length>1?U:U[0]}ae.exports={makeBrush:D,ensureAxisBrush:S,cleanRanges:B}},{"../../lib":503,"../../lib/gup":500,"./constants":893,"@plotly/d3":58}],890:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:c("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":888,"./base_plot":891,"./calc":892,"./defaults":894}],891:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../plots/get_data").getModuleCalcData,P=c("./plot"),E=c("../../constants/xmlns_namespaces");ie.name="parcoords",ie.plot=function(e){var p=k(e.calcdata,"parcoords")[0];p.length&&P(e,p)},ie.clean=function(e,p,g,a){var t=a._has&&a._has("parcoords"),i=p._has&&p._has("parcoords");t&&!i&&(a._paperdiv.selectAll(".parcoords").remove(),a._glimages.selectAll("*").remove())},ie.toSVG=function(e){var p=e._fullLayout._glimages,g=b.select(e).selectAll(".svg-container"),a=g.filter(function(i,n){return n===g.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus");function t(){var i=this,n=i.toDataURL("image/png"),r=p.append("svg:image");r.attr({xmlns:E.svg,"xlink:href":n,preserveAspectRatio:"none",x:0,y:0,width:i.style.width,height:i.style.height})}a.each(t),window.setTimeout(function(){b.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":480,"../../plots/get_data":593,"./plot":900,"@plotly/d3":58}],892:[function(c,ae,ie){"use strict";var b=c("../../lib").isArrayOrTypedArray,k=c("../../components/colorscale"),P=c("../../lib/gup").wrap;ae.exports=function(p,g){var a,t;return k.hasColorscale(g,"line")&&b(g.line.color)?(a=g.line.color,t=k.extractOpts(g.line).colorscale,k.calc(p,g,{vals:a,containerStr:"line",cLetter:"c"})):(a=E(g._length),t=[[0,g.line.color],[1,g.line.color]]),P({lineColor:a,cscale:t})};function E(e){for(var p=new Array(e),g=0;g<e;g++)p[g]=.5;return p}},{"../../components/colorscale":378,"../../lib":503,"../../lib/gup":500}],893:[function(c,ae,ie){"use strict";ae.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],894:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/colorscale/helpers").hasColorscale,P=c("../../components/colorscale/defaults"),E=c("../../plots/domain").defaults,e=c("../../plots/array_container_defaults"),p=c("../../plots/cartesian/axes"),g=c("./attributes"),a=c("./axisbrush"),t=c("./constants").maxDimensionCount,i=c("./merge_length");function n(d,s,m,x,M){var v=M("line.color",m);if(k(d,"line")&&b.isArrayOrTypedArray(v)){if(v.length)return M("line.colorscale"),P(d,s,x,M,{prefix:"line.",cLetter:"c"}),v.length;s.line.color=m}return 1/0}function r(d,s,m,x){function M(T,w){return b.coerce(d,s,g.dimensions,T,w)}var v=M("values"),_=M("visible");if(v&&v.length||(_=s.visible=!1),_){M("label"),M("tickvals"),M("ticktext"),M("tickformat");var l=M("range");s._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:l},p.setConvert(s._ax,x.layout),M("multiselect");var y=M("constraintrange");y&&(s.constraintrange=a.cleanRanges(y,s))}}ae.exports=function(s,m,x,M){function v(w,A){return b.coerce(s,m,g,w,A)}var _=s.dimensions;Array.isArray(_)&&_.length>t&&(b.log("parcoords traces support up to "+t+" dimensions at the moment"),_.splice(t));var l=e(s,m,{name:"dimensions",layout:M,handleItemDefaults:r}),y=n(s,m,x,M,v);E(m,M,v),(!Array.isArray(l)||!l.length)&&(m.visible=!1),i(m,l,"values",y);var T={family:M.font.family,size:Math.round(M.font.size/1.2),color:M.font.color};b.coerceFont(v,"labelfont",T),b.coerceFont(v,"tickfont",T),b.coerceFont(v,"rangefont",T),v("labelangle"),v("labelside")}},{"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503,"../../plots/array_container_defaults":549,"../../plots/cartesian/axes":554,"../../plots/domain":584,"./attributes":888,"./axisbrush":889,"./constants":893,"./merge_length":898}],895:[function(c,ae,ie){"use strict";var b=c("../../lib").isTypedArray;ie.convertTypedArray=function(k){return b(k)?Array.prototype.slice.call(k):k},ie.isOrdinal=function(k){return!!k.tickvals},ie.isVisible=function(k){return k.visible||!("visible"in k)}},{"../../lib":503}],896:[function(c,ae,ie){"use strict";var b=c("./base_index");b.plot=c("./plot"),ae.exports=b},{"./base_index":890,"./plot":900}],897:[function(c,ae,ie){"use strict";var b=c("glslify"),k=b([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),P=b([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),E=c("./constants").maxDimensionCount,e=c("../../lib"),p=1e-6,g=2048,a=new Uint8Array(4),t=new Uint8Array(4),i={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function n(f){f.read({x:0,y:0,width:1,height:1,data:a})}function r(f,u,h,o,S){var R=f._gl;R.enable(R.SCISSOR_TEST),R.scissor(u,h,o,S),f.clear({color:[0,0,0,0],depth:1})}function d(f,u,h,o,S,R){var z=R.key;function O(I){var F=Math.min(o,S-I*o);I===0&&(window.cancelAnimationFrame(h.currentRafs[z]),delete h.currentRafs[z],r(f,R.scissorX,R.scissorY,R.scissorWidth,R.viewBoxSize[1])),!h.clearOnly&&(R.count=2*F,R.offset=2*I*o,u(R),I*o+F<S&&(h.currentRafs[z]=window.requestAnimationFrame(function(){O(I+1)})),h.drawCompleted=!1)}h.drawCompleted||(n(f),h.drawCompleted=!0),O(0)}function s(f){return Math.max(p,Math.min(1-p,f))}function m(f,u){for(var h=new Array(256),o=0;o<256;o++)h[o]=f(o/255).concat(u);return h}function x(f,u){return(f>>>8*u)%256/255}function M(f,u,h){for(var o=new Array(f*(E+4)),S=0,R=0;R<f;R++){for(var z=0;z<E;z++)o[S++]=z<u.length?u[z].paddedUnitValues[R]:.5;o[S++]=x(R,2),o[S++]=x(R,1),o[S++]=x(R,0),o[S++]=s(h[R])}return o}function v(f,u,h){for(var o=new Array(u*8),S=0,R=0;R<u;R++)for(var z=0;z<2;z++)for(var O=0;O<4;O++){var I=f*4+O,F=h[R*64+I];I===63&&z===0&&(F*=-1),o[S++]=F}return o}function _(f){var u="0"+f;return u.substr(u.length-2)}function l(f){return f<E?"p"+_(f+1)+"_"+_(f+4):"colors"}function y(f,u,h){for(var o=0;o<=E;o+=4)f[l(o)](v(o/4,u,h))}function T(f){for(var u={},h=0;h<=E;h+=4)u[l(h)]=f.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return u}function w(f,u,h,o,S,R,z,O,I,F,D,B,U,X){for(var oe=[[],[]],se=0;se<64;se++)oe[0][se]=se===S?1:0,oe[1][se]=se===R?1:0;z*=X,O*=X,I*=X,F*=X;var q=f.lines.canvasOverdrag*X,K=f.domain,G=f.canvasWidth*X,Q=f.canvasHeight*X,V=f.pad.l*X,H=f.pad.b*X,ee=f.layoutHeight*X,J=f.layoutWidth*X,W=f.deselectedLines.color,re=e.extendFlat({key:D,resolution:[G,Q],viewBoxPos:[z+q,O],viewBoxSize:[I,F],i0:S,i1:R,dim0A:oe[0].slice(0,16),dim0B:oe[0].slice(16,32),dim0C:oe[0].slice(32,48),dim0D:oe[0].slice(48,64),dim1A:oe[1].slice(0,16),dim1B:oe[1].slice(16,32),dim1C:oe[1].slice(32,48),dim1D:oe[1].slice(48,64),drwLayer:B,contextColor:[W[0]/255,W[1]/255,W[2]/255,W[3]<1?W[3]:Math.max(1/255,Math.pow(1/f.lines.color.length,1/3))],scissorX:(o===u?0:z+q)+(V-q)+J*K.x[0],scissorWidth:(o===h?G-z+q:I+.5)+(o===u?z+q:0),scissorY:O+H+ee*K.y[0],scissorHeight:F,viewportX:V-q+J*K.x[0],viewportY:H+ee*K.y[0],viewportWidth:G,viewportHeight:Q},U);return re}function A(f){var u=g-1,h=Math.max(0,Math.floor(f[0]*u),0),o=Math.min(u,Math.ceil(f[1]*u),u);return[Math.min(h,o),Math.max(h,o)]}ae.exports=function(f,u){var h=u.context,o=u.pick,S=u.regl,R=S._gl,z=R.getParameter(R.ALIASED_LINE_WIDTH_RANGE),O=Math.max(z[0],Math.min(z[1],u.viewModel.plotGlPixelRatio)),I={currentRafs:{},drawCompleted:!0,clearOnly:!1},F,D,B,U,X=T(S),oe,se=S.texture(i),q=[];G(u);var K=S({profile:!1,blend:{enable:h,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!h,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:S.prop("scissorX"),y:S.prop("scissorY"),width:S.prop("scissorWidth"),height:S.prop("scissorHeight")}},viewport:{x:S.prop("viewportX"),y:S.prop("viewportY"),width:S.prop("viewportWidth"),height:S.prop("viewportHeight")},dither:!1,vert:k,frag:P,primitive:"lines",lineWidth:O,attributes:X,uniforms:{resolution:S.prop("resolution"),viewBoxPos:S.prop("viewBoxPos"),viewBoxSize:S.prop("viewBoxSize"),dim0A:S.prop("dim0A"),dim1A:S.prop("dim1A"),dim0B:S.prop("dim0B"),dim1B:S.prop("dim1B"),dim0C:S.prop("dim0C"),dim1C:S.prop("dim1C"),dim0D:S.prop("dim0D"),dim1D:S.prop("dim1D"),loA:S.prop("loA"),hiA:S.prop("hiA"),loB:S.prop("loB"),hiB:S.prop("hiB"),loC:S.prop("loC"),hiC:S.prop("hiC"),loD:S.prop("loD"),hiD:S.prop("hiD"),palette:se,contextColor:S.prop("contextColor"),maskTexture:S.prop("maskTexture"),drwLayer:S.prop("drwLayer"),maskHeight:S.prop("maskHeight")},offset:S.prop("offset"),count:S.prop("count")});function G(W){F=W.model,D=W.viewModel,B=D.dimensions.slice(),U=B[0]?B[0].values.length:0;var re=F.lines,j=o?re.color.map(function(ne,le){return le/re.color.length}):re.color,Z=M(U,B,j);y(X,U,Z),!h&&!o&&(se=S.texture(e.extendFlat({data:m(F.unitToColor,255)},i)))}function Q(W){var re,j,Z,ne=[[],[]];for(Z=0;Z<64;Z++){var le=!W&&Z<B.length?B[Z].brush.filter.getBounds():[-1/0,1/0];ne[0][Z]=le[0],ne[1][Z]=le[1]}var ge=g*8,pe=new Array(ge);for(re=0;re<ge;re++)pe[re]=255;if(!W)for(re=0;re<B.length;re++){var xe=re%8,Ee=(re-xe)/8,Te=Math.pow(2,xe),de=B[re],be=de.brush.filter.get();if(!(be.length<2)){var Le=A(be[0])[1];for(j=1;j<be.length;j++){var De=A(be[j]);for(Z=Le+1;Z<De[0];Z++)pe[Z*8+Ee]&=~Te;Le=Math.max(Le,De[1])}}}var ye={shape:[8,g],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:pe};return oe?oe(ye):oe=S.texture(ye),{maskTexture:oe,maskHeight:g,loA:ne[0].slice(0,16),loB:ne[0].slice(16,32),loC:ne[0].slice(32,48),loD:ne[0].slice(48,64),hiA:ne[1].slice(0,16),hiB:ne[1].slice(16,32),hiC:ne[1].slice(32,48),hiD:ne[1].slice(48,64)}}function V(W,re,j){var Z=W.length,ne,le,ge,pe=1/0,xe=-1/0;for(ne=0;ne<Z;ne++)W[ne].dim0.canvasX<pe&&(pe=W[ne].dim0.canvasX,le=ne),W[ne].dim1.canvasX>xe&&(xe=W[ne].dim1.canvasX,ge=ne);Z===0&&r(S,0,0,F.canvasWidth,F.canvasHeight);var Ee=Q(h);for(ne=0;ne<Z;ne++){var Te=W[ne],de=Te.dim0.crossfilterDimensionIndex,be=Te.dim1.crossfilterDimensionIndex,Le=Te.canvasX,De=Te.canvasY,ye=Le+Te.panelSizeX,ke=Te.plotGlPixelRatio;if(re||!q[de]||q[de][0]!==Le||q[de][1]!==ye){q[de]=[Le,ye];var Oe=w(F,le,ge,ne,de,be,Le,De,Te.panelSizeX,Te.panelSizeY,Te.dim0.crossfilterDimensionIndex,h?0:o?2:1,Ee,ke);I.clearOnly=j;var Qe=re?F.lines.blockLineCount:U;d(S,K,I,Qe,U,Oe)}}}function H(W,re){return S.read({x:W,y:re,width:1,height:1,data:t}),t}function ee(W,re,j,Z){var ne=new Uint8Array(4*j*Z);return S.read({x:W,y:re,width:j,height:Z,data:ne}),ne}function J(){f.style["pointer-events"]="none",se.destroy(),oe&&oe.destroy();for(var W in X)X[W].destroy()}return{render:V,readPixel:H,readPixels:ee,destroy:J,update:G}}},{"../../lib":503,"./constants":893,glslify:227}],898:[function(c,ae,ie){"use strict";ae.exports=function(b,k,P,E){E||(E=1/0);var e,p;for(e=0;e<k.length;e++)p=k[e],p.visible&&(E=Math.min(E,p[P].length));for(E===1/0&&(E=0),b._length=E,e=0;e<k.length;e++)p=k[e],p.visible&&(p._length=E);return E}},{}],899:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=k.numberFormat,E=c("color-rgba"),e=c("../../plots/cartesian/axes"),p=k.strRotate,g=k.strTranslate,a=c("../../lib/svg_text_utils"),t=c("../../components/drawing"),i=c("../../components/colorscale"),n=c("../../lib/gup"),r=n.keyFun,d=n.repeat,s=n.unwrap,m=c("./helpers"),x=c("./constants"),M=c("./axisbrush"),v=c("./lines");function _(oe,se,q){return k.aggNums(oe,null,se,q)}function l(oe,se){return T(_(Math.min,oe,se),_(Math.max,oe,se))}function y(oe){var se=oe.range;return se?T(se[0],se[1]):l(oe.values,oe._length)}function T(oe,se){return(isNaN(oe)||!isFinite(oe))&&(oe=0),(isNaN(se)||!isFinite(se))&&(se=0),oe===se&&(oe===0?(oe-=1,se+=1):(oe*=.9,se*=1.1)),[oe,se]}function w(oe,se){return se?function(q,K){var G=se[K];return G??oe(q)}:oe}function A(oe,se,q,K,G){var Q=y(q);return K?b.scale.ordinal().domain(K.map(w(P(q.tickformat),G))).range(K.map(function(V){var H=(V-Q[0])/(Q[1]-Q[0]);return oe-se+H*(2*se-oe)})):b.scale.linear().domain(Q).range([oe-se,se])}function f(oe,se){return b.scale.linear().range([se,oe-se])}function u(oe,se){return b.scale.linear().domain(y(oe)).range([se,1-se])}function h(oe){if(!!oe.tickvals){var se=y(oe);return b.scale.ordinal().domain(oe.tickvals).range(oe.tickvals.map(function(q){return(q-se[0])/(se[1]-se[0])}))}}function o(oe){var se=oe.map(function(Q){return Q[0]}),q=oe.map(function(Q){var V=E(Q[1]);return b.rgb("rgb("+V[0]+","+V[1]+","+V[2]+")")}),K=function(Q){return function(V){return V[Q]}},G="rgb".split("").map(function(Q){return b.scale.linear().clamp(!0).domain(se).range(q.map(K(Q)))});return function(Q){return G.map(function(V){return V(Q)})}}function S(oe){return oe.dimensions.some(function(se){return se.brush.filterSpecified})}function R(oe,se,q){var K=s(se),G=K.trace,Q=m.convertTypedArray(K.lineColor),V=G.line,H={color:E(x.deselectedLineColor)},ee=i.extractOpts(V),J=ee.reversescale?i.flipScale(K.cscale):K.cscale,W=G.domain,re=G.dimensions,j=oe.width,Z=G.labelangle,ne=G.labelside,le=G.labelfont,ge=G.tickfont,pe=G.rangefont,xe=k.extendDeepNoArrays({},V,{color:Q.map(b.scale.linear().domain(y({values:Q,range:[ee.min,ee.max],_length:G._length}))),blockLineCount:x.blockLineCount,canvasOverdrag:x.overdrag*x.canvasPixelRatio}),Ee=Math.floor(j*(W.x[1]-W.x[0])),Te=Math.floor(oe.height*(W.y[1]-W.y[0])),de=oe.margin||{l:80,r:80,t:100,b:80},be=Ee,Le=Te;return{key:q,colCount:re.filter(m.isVisible).length,dimensions:re,tickDistance:x.tickDistance,unitToColor:o(J),lines:xe,deselectedLines:H,labelAngle:Z,labelSide:ne,labelFont:le,tickFont:ge,rangeFont:pe,layoutWidth:j,layoutHeight:oe.height,domain:W,translateX:W.x[0]*j,translateY:oe.height-W.y[1]*oe.height,pad:de,canvasWidth:be*x.canvasPixelRatio+2*xe.canvasOverdrag,canvasHeight:Le*x.canvasPixelRatio,width:be,height:Le,canvasPixelRatio:x.canvasPixelRatio}}function z(oe,se,q){var K=q.width,G=q.height,Q=q.dimensions,V=q.canvasPixelRatio,H=function(j){return K*j/Math.max(1,q.colCount-1)},ee=x.verticalPadding/G,J=f(G,x.verticalPadding),W={key:q.key,xScale:H,model:q,inBrushDrag:!1},re={};return W.dimensions=Q.filter(m.isVisible).map(function(j,Z){var ne=u(j,ee),le=re[j.label];re[j.label]=(le||0)+1;var ge=j.label+(le?"__"+le:""),pe=j.constraintrange,xe=pe&&pe.length;xe&&!Array.isArray(pe[0])&&(pe=[pe]);var Ee=xe?pe.map(function(Ve){return Ve.map(ne)}):[[-1/0,1/0]],Te=function(){var Ve=W;Ve.focusLayer&&Ve.focusLayer.render(Ve.panels,!0);var Ue=S(Ve);!oe.contextShown()&&Ue?(Ve.contextLayer&&Ve.contextLayer.render(Ve.panels,!0),oe.contextShown(!0)):oe.contextShown()&&!Ue&&(Ve.contextLayer&&Ve.contextLayer.render(Ve.panels,!0,!0),oe.contextShown(!1))},de=j.values;de.length>j._length&&(de=de.slice(0,j._length));var be=j.tickvals,Le;function De(Ve,Ue){return{val:Ve,text:Le[Ue]}}function ye(Ve,Ue){return Ve.val-Ue.val}if(Array.isArray(be)&&be.length){Le=j.ticktext,!Array.isArray(Le)||!Le.length?Le=be.map(P(j.tickformat)):Le.length>be.length?Le=Le.slice(0,be.length):be.length>Le.length&&(be=be.slice(0,Le.length));for(var ke=1;ke<be.length;ke++)if(be[ke]<be[ke-1]){for(var Oe=be.map(De).sort(ye),Qe=0;Qe<be.length;Qe++)be[Qe]=Oe[Qe].val,Le[Qe]=Oe[Qe].text;break}}else be=void 0;return de=m.convertTypedArray(de),{key:ge,label:j.label,tickFormat:j.tickformat,tickvals:be,ticktext:Le,ordinal:m.isOrdinal(j),multiselect:j.multiselect,xIndex:Z,crossfilterDimensionIndex:Z,visibleIndex:j._index,height:G,values:de,paddedUnitValues:de.map(ne),unitTickvals:be&&be.map(ne),xScale:H,x:H(Z),canvasX:H(Z)*V,unitToPaddedPx:J,domainScale:A(G,x.verticalPadding,j,be,Le),ordinalScale:h(j),parent:W,model:q,brush:M.makeBrush(oe,xe,Ee,function(){oe.linePickActive(!1)},Te,function(Ve){if(W.focusLayer.render(W.panels,!0),W.pickLayer&&W.pickLayer.render(W.panels,!0),oe.linePickActive(!0),se&&se.filterChanged){var Ue=ne.invert,Ie=Ve.map(function(at){return at.map(Ue).sort(k.sorterAsc)}).sort(function(at,pt){return at[0]-pt[0]});se.filterChanged(W.key,j._index,Ie)}})}}),W}function O(oe){oe.classed(x.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function I(){var oe=!0,se=!1;return{linePickActive:function(q){return arguments.length?oe=!!q:oe},contextShown:function(q){return arguments.length?se=!!q:se}}}function F(oe,se){var q=se==="top"?1:-1,K=oe*Math.PI/180,G=Math.sin(K),Q=Math.cos(K);return{dir:q,dx:G,dy:Q,degrees:oe}}function D(oe,se,q){for(var K=se.panels||(se.panels=[]),G=oe.data(),Q=0;Q<G.length-1;Q++){var V=K[Q]||(K[Q]={}),H=G[Q],ee=G[Q+1];V.dim0=H,V.dim1=ee,V.canvasX=H.canvasX,V.panelSizeX=ee.canvasX-H.canvasX,V.panelSizeY=se.model.canvasHeight,V.y=0,V.canvasY=0,V.plotGlPixelRatio=q}}function B(oe){for(var se=0;se<oe.length;se++)for(var q=0;q<oe[se].length;q++)for(var K=oe[se][q].trace,G=K.dimensions,Q=0;Q<G.length;Q++){var V=G[Q].values,H=G[Q]._ax;H&&(H.range?H.range=T(H.range[0],H.range[1]):H.range=l(V,K._length),H.dtick||(H.dtick=.01*(Math.abs(H.range[1]-H.range[0])||1)),H.tickformat=G[Q].tickformat,e.calcTicks(H),H.cleanRange())}}function U(oe,se){return e.tickText(oe._ax,se,!1).text}function X(oe,se){if(oe.ordinal)return"";var q=oe.domainScale.domain(),K=q[se?q.length-1:0];return U(oe.model.dimensions[oe.visibleIndex],K)}ae.exports=function(se,q,K,G){var Q=se._fullLayout,V=Q._toppaper,H=Q._glcontainer,ee=se._context.plotGlPixelRatio,J=se._fullLayout.paper_bgcolor;B(q);var W=I(),re=q.filter(function(Oe){return s(Oe).trace.visible}).map(R.bind(0,K)).map(z.bind(0,W,G));H.each(function(Oe,Qe){return k.extendFlat(Oe,re[Qe])});var j=H.selectAll(".gl-canvas").each(function(Oe){Oe.viewModel=re[0],Oe.viewModel.plotGlPixelRatio=ee,Oe.viewModel.paperColor=J,Oe.model=Oe.viewModel?Oe.viewModel.model:null}),Z=null,ne=j.filter(function(Oe){return Oe.pick});ne.style("pointer-events","auto").on("mousemove",function(Oe){if(W.linePickActive()&&Oe.lineLayer&&G&&G.hover){var Qe=b.event,Ve=this.width,Ue=this.height,Ie=b.mouse(this),at=Ie[0],pt=Ie[1];if(at<0||pt<0||at>=Ve||pt>=Ue)return;var Rt=Oe.lineLayer.readPixel(at,Ue-1-pt),Mt=Rt[3]!==0,It=Mt?Rt[2]+256*(Rt[1]+256*Rt[0]):null,Bt={x:at,y:pt,clientX:Qe.clientX,clientY:Qe.clientY,dataIndex:Oe.model.key,curveNumber:It};It!==Z&&(Mt?G.hover(Bt):G.unhover&&G.unhover(Bt),Z=It)}}),j.style("opacity",function(Oe){return Oe.pick?0:1}),V.style("background","rgba(255, 255, 255, 0)");var le=V.selectAll("."+x.cn.parcoords).data(re,r);le.exit().remove(),le.enter().append("g").classed(x.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),le.attr("transform",function(Oe){return g(Oe.model.translateX,Oe.model.translateY)});var ge=le.selectAll("."+x.cn.parcoordsControlView).data(d,r);ge.enter().append("g").classed(x.cn.parcoordsControlView,!0),ge.attr("transform",function(Oe){return g(Oe.model.pad.l,Oe.model.pad.t)});var pe=ge.selectAll("."+x.cn.yAxis).data(function(Oe){return Oe.dimensions},r);pe.enter().append("g").classed(x.cn.yAxis,!0),ge.each(function(Oe){D(pe,Oe,ee)}),j.each(function(Oe){if(Oe.viewModel){!Oe.lineLayer||G?Oe.lineLayer=v(this,Oe):Oe.lineLayer.update(Oe),(Oe.key||Oe.key===0)&&(Oe.viewModel[Oe.key]=Oe.lineLayer);var Qe=!Oe.context||G;Oe.lineLayer.render(Oe.viewModel.panels,Qe)}}),pe.attr("transform",function(Oe){return g(Oe.xScale(Oe.xIndex),0)}),pe.call(b.behavior.drag().origin(function(Oe){return Oe}).on("drag",function(Oe){var Qe=Oe.parent;W.linePickActive(!1),Oe.x=Math.max(-x.overdrag,Math.min(Oe.model.width+x.overdrag,b.event.x)),Oe.canvasX=Oe.x*Oe.model.canvasPixelRatio,pe.sort(function(Ve,Ue){return Ve.x-Ue.x}).each(function(Ve,Ue){Ve.xIndex=Ue,Ve.x=Oe===Ve?Ve.x:Ve.xScale(Ve.xIndex),Ve.canvasX=Ve.x*Ve.model.canvasPixelRatio}),D(pe,Qe,ee),pe.filter(function(Ve){return Math.abs(Oe.xIndex-Ve.xIndex)!==0}).attr("transform",function(Ve){return g(Ve.xScale(Ve.xIndex),0)}),b.select(this).attr("transform",g(Oe.x,0)),pe.each(function(Ve,Ue,Ie){Ie===Oe.parent.key&&(Qe.dimensions[Ue]=Ve)}),Qe.contextLayer&&Qe.contextLayer.render(Qe.panels,!1,!S(Qe)),Qe.focusLayer.render&&Qe.focusLayer.render(Qe.panels)}).on("dragend",function(Oe){var Qe=Oe.parent;Oe.x=Oe.xScale(Oe.xIndex),Oe.canvasX=Oe.x*Oe.model.canvasPixelRatio,D(pe,Qe,ee),b.select(this).attr("transform",function(Ve){return g(Ve.x,0)}),Qe.contextLayer&&Qe.contextLayer.render(Qe.panels,!1,!S(Qe)),Qe.focusLayer&&Qe.focusLayer.render(Qe.panels),Qe.pickLayer&&Qe.pickLayer.render(Qe.panels,!0),W.linePickActive(!0),G&&G.axesMoved&&G.axesMoved(Qe.key,Qe.dimensions.map(function(Ve){return Ve.crossfilterDimensionIndex}))})),pe.exit().remove();var xe=pe.selectAll("."+x.cn.axisOverlays).data(d,r);xe.enter().append("g").classed(x.cn.axisOverlays,!0),xe.selectAll("."+x.cn.axis).remove();var Ee=xe.selectAll("."+x.cn.axis).data(d,r);Ee.enter().append("g").classed(x.cn.axis,!0),Ee.each(function(Oe){var Qe=Oe.model.height/Oe.model.tickDistance,Ve=Oe.domainScale,Ue=Ve.domain();b.select(this).call(b.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Qe,Oe.tickFormat).tickValues(Oe.ordinal?Ue:null).tickFormat(function(Ie){return m.isOrdinal(Oe)?Ie:U(Oe.model.dimensions[Oe.visibleIndex],Ie)}).scale(Ve)),t.font(Ee.selectAll("text"),Oe.model.tickFont)}),Ee.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),Ee.selectAll("text").style("text-shadow",a.makeTextShadow(J)).style("cursor","default");var Te=xe.selectAll("."+x.cn.axisHeading).data(d,r);Te.enter().append("g").classed(x.cn.axisHeading,!0);var de=Te.selectAll("."+x.cn.axisTitle).data(d,r);de.enter().append("text").classed(x.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),de.text(function(Oe){return Oe.label}).each(function(Oe){var Qe=b.select(this);t.font(Qe,Oe.model.labelFont),a.convertToTspans(Qe,se)}).attr("transform",function(Oe){var Qe=F(Oe.model.labelAngle,Oe.model.labelSide),Ve=x.axisTitleOffset;return(Qe.dir>0?"":g(0,2*Ve+Oe.model.height))+p(Qe.degrees)+g(-Ve*Qe.dx,-Ve*Qe.dy)}).attr("text-anchor",function(Oe){var Qe=F(Oe.model.labelAngle,Oe.model.labelSide),Ve=Math.abs(Qe.dx),Ue=Math.abs(Qe.dy);return 2*Ve>Ue?Qe.dir*Qe.dx<0?"start":"end":"middle"});var be=xe.selectAll("."+x.cn.axisExtent).data(d,r);be.enter().append("g").classed(x.cn.axisExtent,!0);var Le=be.selectAll("."+x.cn.axisExtentTop).data(d,r);Le.enter().append("g").classed(x.cn.axisExtentTop,!0),Le.attr("transform",g(0,-x.axisExtentOffset));var De=Le.selectAll("."+x.cn.axisExtentTopText).data(d,r);De.enter().append("text").classed(x.cn.axisExtentTopText,!0).call(O),De.text(function(Oe){return X(Oe,!0)}).each(function(Oe){t.font(b.select(this),Oe.model.rangeFont)});var ye=be.selectAll("."+x.cn.axisExtentBottom).data(d,r);ye.enter().append("g").classed(x.cn.axisExtentBottom,!0),ye.attr("transform",function(Oe){return g(0,Oe.model.height+x.axisExtentOffset)});var ke=ye.selectAll("."+x.cn.axisExtentBottomText).data(d,r);ke.enter().append("text").classed(x.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(O),ke.text(function(Oe){return X(Oe,!1)}).each(function(Oe){t.font(b.select(this),Oe.model.rangeFont)}),M.ensureAxisBrush(xe,J)}},{"../../components/colorscale":378,"../../components/drawing":388,"../../lib":503,"../../lib/gup":500,"../../lib/svg_text_utils":529,"../../plots/cartesian/axes":554,"./axisbrush":889,"./constants":893,"./helpers":895,"./lines":897,"@plotly/d3":58,"color-rgba":91}],900:[function(c,ae,g){"use strict";var b=c("./parcoords"),k=c("../../lib/prepare_regl"),P=c("./helpers").isVisible,E={};function e(a,t,i){var n=t.indexOf(i),r=a.indexOf(n);return r===-1&&(r+=t.length),r}function p(a,t){return function(n,r){return e(a,t,n)-e(a,t,r)}}var g=ae.exports=function(t,i){var n=t._fullLayout,r=k(t,[],E);if(!!r){var d={},s={},m={},x={},M=n._size;i.forEach(function(T,w){var A=T[0].trace;m[w]=A.index;var f=x[w]=A._fullInput.index;d[w]=t.data[f].dimensions,s[w]=t.data[f].dimensions.slice()});var v=function(T,w,A){var f=s[T][w],u=A.map(function(O){return O.slice()}),h="dimensions["+w+"].constraintrange",o=n._tracePreGUI[t._fullData[m[T]]._fullInput.uid];if(o[h]===void 0){var S=f.constraintrange;o[h]=S||null}var R=t._fullData[m[T]].dimensions[w];u.length?(u.length===1&&(u=u[0]),f.constraintrange=u,R.constraintrange=u.slice(),u=[u]):(delete f.constraintrange,delete R.constraintrange,u=null);var z={};z[h]=u,t.emit("plotly_restyle",[z,[x[T]]])},_=function(T){t.emit("plotly_hover",T)},l=function(T){t.emit("plotly_unhover",T)},y=function(T,w){var A=p(w,s[T].filter(P));d[T].sort(A),s[T].filter(function(f){return!P(f)}).sort(function(f){return s[T].indexOf(f)}).forEach(function(f){d[T].splice(d[T].indexOf(f),1),d[T].splice(s[T].indexOf(f),0,f)}),t.emit("plotly_restyle",[{dimensions:[d[T]]},[x[T]]])};b(t,i,{width:M.w,height:M.h,margin:{t:M.t,r:M.r,b:M.b,l:M.l}},{filterChanged:v,hover:_,unhover:l,axesMoved:y})}};g.reglPrecompiled=E},{"../../lib/prepare_regl":516,"./helpers":895,"./parcoords":899}],901:[function(c,ae,ie){"use strict";var b=c("../../plots/attributes"),k=c("../../plots/domain").attributes,P=c("../../plots/font_attributes"),E=c("../../components/color/attributes"),e=c("../../plots/template_attributes").hovertemplateAttrs,p=c("../../plots/template_attributes").texttemplateAttrs,g=c("../../lib/extend").extendFlat,a=P({editType:"plot",arrayOk:!0,colorEditType:"plot"});ae.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:E.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:g({},b.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:p({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:g({},a,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:g({},a,{}),outsidetextfont:g({},a,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:g({},a,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:k({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:g({},a,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":365,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/font_attributes":585,"../../plots/template_attributes":633}],902:[function(c,ae,ie){"use strict";var b=c("../../plots/plots");ie.name="pie",ie.plot=function(k,P,E,e){b.plotBasePlot(ie.name,k,P,E,e)},ie.clean=function(k,P,E,e){b.cleanBasePlot(ie.name,k,P,E,e)}},{"../../plots/plots":619}],903:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("tinycolor2"),P=c("../../components/color"),E={};function e(t,i){var n=[],r=t._fullLayout,d=r.hiddenlabels||[],s=i.labels,m=i.marker.colors||[],x=i.values,M=i._length,v=i._hasValues&&M,_,l;if(i.dlabel)for(s=new Array(M),_=0;_<M;_++)s[_]=String(i.label0+_*i.dlabel);var y={},T=p(r["_"+i.type+"colormap"]),w=0,A=!1;for(_=0;_<M;_++){var f,u,h;if(v){if(f=x[_],!b(f))continue;f=+f}else f=1;u=s[_],(u===void 0||u==="")&&(u=_),u=String(u);var o=y[u];o===void 0?(y[u]=n.length,h=d.indexOf(u)!==-1,h||(w+=f),n.push({v:f,label:u,color:T(m[_],u),i:_,pts:[_],hidden:h})):(A=!0,l=n[o],l.v+=f,l.pts.push(_),l.hidden||(w+=f),l.color===!1&&m[_]&&(l.color=T(m[_],u)))}n=n.filter(function(R){return R.v>=0});var S=i.type==="funnelarea"?A:i.sort;return S&&n.sort(function(R,z){return z.v-R.v}),n[0]&&(n[0].vTotal=w),n}function p(t){return function(n,r){return!n||(n=k(n),!n.isValid())?!1:(n=P.addOpacity(n,n.getAlpha()),t[r]||(t[r]=n),n)}}function g(t,i){var n=(i||{}).type;n||(n="pie");var r=t._fullLayout,d=t.calcdata,s=r[n+"colorway"],m=r["_"+n+"colormap"];r["extend"+n+"colors"]&&(s=a(s,E));for(var x=0,M=0;M<d.length;M++){var v=d[M],_=v[0].trace.type;if(_===n)for(var l=0;l<v.length;l++){var y=v[l];y.color===!1&&(m[y.label]?y.color=m[y.label]:(m[y.label]=y.color=s[x%s.length],x++))}}}function a(t,i){var n,r=JSON.stringify(t),d=i[r];if(!d){for(d=t.slice(),n=0;n<t.length;n++)d.push(k(t[n]).lighten(20).toHexString());for(n=0;n<t.length;n++)d.push(k(t[n]).darken(20).toHexString());i[r]=d}return d}ae.exports={calc:e,crossTraceCalc:g,makePullColorFn:p,generateExtendedColors:a}},{"../../components/color":366,"fast-isnumeric":190,tinycolor2:312}],904:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("./attributes"),E=c("../../plots/domain").defaults,e=c("../bar/defaults").handleText;function p(a,t){var i=Array.isArray(a),n=k.isArrayOrTypedArray(t),r=Math.min(i?a.length:1/0,n?t.length:1/0);if(isFinite(r)||(r=0),r&&n){for(var d,s=0;s<r;s++){var m=t[s];if(b(m)&&m>0){d=!0;break}}d||(r=0)}return{hasLabels:i,hasValues:n,len:r}}function g(a,t,i,n){function r(h,o){return k.coerce(a,t,P,h,o)}var d=r("labels"),s=r("values"),m=p(d,s),x=m.len;if(t._hasLabels=m.hasLabels,t._hasValues=m.hasValues,!t._hasLabels&&t._hasValues&&(r("label0"),r("dlabel")),!x){t.visible=!1;return}t._length=x;var M=r("marker.line.width");M&&r("marker.line.color"),r("marker.colors"),r("scalegroup");var v=r("text"),_=r("texttemplate"),l;if(_||(l=r("textinfo",Array.isArray(v)?"text+percent":"percent")),r("hovertext"),r("hovertemplate"),_||l&&l!=="none"){var y=r("textposition");e(a,t,n,r,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1});var T=Array.isArray(y)||y==="auto",w=T||y==="outside";w&&r("automargin"),(y==="inside"||y==="auto"||Array.isArray(y))&&r("insidetextorientation")}E(t,n,r);var A=r("hole"),f=r("title.text");if(f){var u=r("title.position",A?"middle center":"top center");!A&&u==="middle center"&&(t.title.position="top center"),k.coerceFont(r,"title.font",n.font)}r("sort"),r("direction"),r("rotation"),r("pull")}ae.exports={handleLabelsAndValues:p,supplyDefaults:g}},{"../../lib":503,"../../plots/domain":584,"../bar/defaults":652,"./attributes":901,"fast-isnumeric":190}],905:[function(c,ae,ie){"use strict";var b=c("../../components/fx/helpers").appendArrayMultiPointValues;ae.exports=function(P,E){var e={curveNumber:E.index,pointNumbers:P.pts,data:E._input,fullData:E,label:P.label,color:P.color,value:P.v,percent:P.percent,text:P.text,bbox:P.bbox,v:P.v};return P.pts.length===1&&(e.pointNumber=e.i=P.pts[0]),b(e,E,P.pts),E.type==="funnelarea"&&(delete e.v,delete e.i),e}},{"../../components/fx/helpers":402}],906:[function(c,ae,ie){"use strict";var b=c("../../lib");function k(P){return P.indexOf("e")!==-1?P.replace(/[.]?0+e/,"e"):P.indexOf(".")!==-1?P.replace(/[.]?0+$/,""):P}ie.formatPiePercent=function(E,e){var p=k((E*100).toPrecision(3));return b.numSeparate(p,e)+"%"},ie.formatPieValue=function(E,e){var p=k(E.toPrecision(10));return b.numSeparate(p,e)},ie.getFirstFilled=function(E,e){if(!!Array.isArray(E))for(var p=0;p<e.length;p++){var g=E[e[p]];if(g||g===0||g==="")return g}},ie.castOption=function(E,e){if(Array.isArray(E))return ie.getFirstFilled(E,e);if(E)return E},ie.getRotationAngle=function(P){return(P==="auto"?0:P)*Math.PI/180}},{"../../lib":503}],907:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults").supplyDefaults,supplyLayoutDefaults:c("./layout_defaults"),layoutAttributes:c("./layout_attributes"),calc:c("./calc").calc,crossTraceCalc:c("./calc").crossTraceCalc,plot:c("./plot").plot,style:c("./style"),styleOne:c("./style_one"),moduleType:"trace",name:"pie",basePlotModule:c("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":901,"./base_plot":902,"./calc":903,"./defaults":904,"./layout_attributes":908,"./layout_defaults":909,"./plot":910,"./style":911,"./style_one":912}],908:[function(c,ae,ie){"use strict";ae.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],909:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(E,e){function p(g,a){return b.coerce(E,e,k,g,a)}p("hiddenlabels"),p("piecolorway",e.colorway),p("extendpiecolors")}},{"../../lib":503,"./layout_attributes":908}],910:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../plots/plots"),P=c("../../components/fx"),E=c("../../components/color"),e=c("../../components/drawing"),p=c("../../lib"),g=p.strScale,a=p.strTranslate,t=c("../../lib/svg_text_utils"),i=c("../bar/uniform_text"),n=i.recordMinTextSize,r=i.clearMinTextSize,d=c("../bar/constants").TEXTPAD,s=c("./helpers"),m=c("./event_data"),x=c("../../lib").isValidTextValue;function M(Q,V){var H=Q._fullLayout,ee=H._size;r("pie",H),T(V,Q),X(V,ee);var J=p.makeTraceGroups(H._pielayer,V,"trace").each(function(W){var re=b.select(this),j=W[0],Z=j.trace;se(W),re.attr("stroke-linejoin","round"),re.each(function(){var ne=b.select(this).selectAll("g.slice").data(W);ne.enter().append("g").classed("slice",!0),ne.exit().remove();var le=[[[],[]],[[],[]]],ge=!1;ne.each(function(De,ye){if(De.hidden){b.select(this).selectAll("path,g").remove();return}De.pointNumber=De.i,De.curveNumber=Z.index,le[De.pxmid[1]<0?0:1][De.pxmid[0]<0?0:1].push(De);var ke=j.cx,Oe=j.cy,Qe=b.select(this),Ve=Qe.selectAll("path.surface").data([De]);if(Ve.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),Qe.call(_,Q,W),Z.pull){var Ue=+s.castOption(Z.pull,De.pts)||0;Ue>0&&(ke+=Ue*De.pxmid[0],Oe+=Ue*De.pxmid[1])}De.cxFinal=ke,De.cyFinal=Oe;function Ie(St,_t,it,ct){var et=ct*(_t[0]-St[0]),Pe=ct*(_t[1]-St[1]);return"a"+ct*j.r+","+ct*j.r+" 0 "+De.largeArc+(it?" 1 ":" 0 ")+et+","+Pe}var at=Z.hole;if(De.v===j.vTotal){var pt="M"+(ke+De.px0[0])+","+(Oe+De.px0[1])+Ie(De.px0,De.pxmid,!0,1)+Ie(De.pxmid,De.px0,!0,1)+"Z";at?Ve.attr("d","M"+(ke+at*De.px0[0])+","+(Oe+at*De.px0[1])+Ie(De.px0,De.pxmid,!1,at)+Ie(De.pxmid,De.px0,!1,at)+"Z"+pt):Ve.attr("d",pt)}else{var Rt=Ie(De.px0,De.px1,!0,1);if(at){var Mt=1-at;Ve.attr("d","M"+(ke+at*De.px1[0])+","+(Oe+at*De.px1[1])+Ie(De.px1,De.px0,!1,at)+"l"+Mt*De.px0[0]+","+Mt*De.px0[1]+Rt+"Z")}else Ve.attr("d","M"+ke+","+Oe+"l"+De.px0[0]+","+De.px0[1]+Rt+"Z")}K(Q,De,j);var It=s.castOption(Z.textposition,De.pts),Bt=Qe.selectAll("g.slicetext").data(De.text&&It!=="none"?[0]:[]);Bt.enter().append("g").classed("slicetext",!0),Bt.exit().remove(),Bt.each(function(){var St=p.ensureSingle(b.select(this),"text","",function(nt){nt.attr("data-notex",1)}),_t=p.ensureUniformFontSize(Q,It==="outside"?l(Z,De,H.font):y(Z,De,H.font));St.text(De.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,_t).call(t.convertToTspans,Q);var it=e.bBox(St.node()),ct;if(It==="outside")ct=z(it,De);else if(ct=w(it,De,j),It==="auto"&&ct.scale<1){var et=p.ensureUniformFontSize(Q,Z.outsidetextfont);St.call(e.font,et),it=e.bBox(St.node()),ct=z(it,De)}var Pe=ct.textPosAngle,We=Pe===void 0?De.pxmid:q(j.r,Pe);if(ct.targetX=ke+We[0]*ct.rCenter+(ct.x||0),ct.targetY=Oe+We[1]*ct.rCenter+(ct.y||0),G(ct,it),ct.outside){var je=ct.targetY;De.yLabelMin=je-it.height/2,De.yLabelMid=je,De.yLabelMax=je+it.height/2,De.labelExtraX=0,De.labelExtraY=0,ge=!0}ct.fontSize=_t.size,n(Z.type,ct,H),W[ye].transform=ct,St.attr("transform",p.getTextTransform(ct))})});var pe=b.select(this).selectAll("g.titletext").data(Z.title.text?[0]:[]);if(pe.enter().append("g").classed("titletext",!0),pe.exit().remove(),pe.each(function(){var De=p.ensureSingle(b.select(this),"text","",function(Oe){Oe.attr("data-notex",1)}),ye=Z.title.text;Z._meta&&(ye=p.templateString(ye,Z._meta)),De.text(ye).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,Z.title.font).call(t.convertToTspans,Q);var ke;Z.title.position==="middle center"?ke=O(j):ke=I(j,ee),De.attr("transform",a(ke.x,ke.y)+g(Math.min(1,ke.scale))+a(ke.tx,ke.ty))}),ge&&U(le,Z),v(ne,Z),ge&&Z.automargin){var xe=e.bBox(re.node()),Ee=Z.domain,Te=ee.w*(Ee.x[1]-Ee.x[0]),de=ee.h*(Ee.y[1]-Ee.y[0]),be=(.5*Te-j.r)/ee.w,Le=(.5*de-j.r)/ee.h;k.autoMargin(Q,"pie."+Z.uid+".automargin",{xl:Ee.x[0]-be,xr:Ee.x[1]+be,yb:Ee.y[0]-Le,yt:Ee.y[1]+Le,l:Math.max(j.cx-j.r-xe.left,0),r:Math.max(xe.right-(j.cx+j.r),0),b:Math.max(xe.bottom-(j.cy+j.r),0),t:Math.max(j.cy-j.r-xe.top,0),pad:5})}})});setTimeout(function(){J.selectAll("tspan").each(function(){var W=b.select(this);W.attr("dy")&&W.attr("dy",W.attr("dy"))})},0)}function v(Q,V){Q.each(function(H){var ee=b.select(this);if(!H.labelExtraX&&!H.labelExtraY){ee.select("path.textline").remove();return}var J=ee.select("g.slicetext text");H.transform.targetX+=H.labelExtraX,H.transform.targetY+=H.labelExtraY,J.attr("transform",p.getTextTransform(H.transform));var W=H.cxFinal+H.pxmid[0],re=H.cyFinal+H.pxmid[1],j="M"+W+","+re,Z=(H.yLabelMax-H.yLabelMin)*(H.pxmid[0]<0?-1:1)/4;if(H.labelExtraX){var ne=H.labelExtraX*H.pxmid[1]/H.pxmid[0],le=H.yLabelMid+H.labelExtraY-(H.cyFinal+H.pxmid[1]);Math.abs(ne)>Math.abs(le)?j+="l"+le*H.pxmid[0]/H.pxmid[1]+","+le+"H"+(W+H.labelExtraX+Z):j+="l"+H.labelExtraX+","+ne+"v"+(le-ne)+"h"+Z}else j+="V"+(H.yLabelMid+H.labelExtraY)+"h"+Z;p.ensureSingle(ee,"path","textline").call(E.stroke,V.outsidetextfont.color).attr({"stroke-width":Math.min(2,V.outsidetextfont.size/8),d:j,fill:"none"})})}function _(Q,V,H){var ee=H[0],J=ee.cx,W=ee.cy,re=ee.trace,j=re.type==="funnelarea";"_hasHoverLabel"in re||(re._hasHoverLabel=!1),"_hasHoverEvent"in re||(re._hasHoverEvent=!1),Q.on("mouseover",function(Z){var ne=V._fullLayout,le=V._fullData[re.index];if(!(V._dragging||ne.hovermode===!1)){var ge=le.hoverinfo;if(Array.isArray(ge)&&(ge=P.castHoverinfo({hoverinfo:[s.castOption(ge,Z.pts)],_module:re._module},ne,0)),ge==="all"&&(ge="label+text+value+percent+name"),le.hovertemplate||ge!=="none"&&ge!=="skip"&&ge){var pe=Z.rInscribed||0,xe=J+Z.pxmid[0]*(1-pe),Ee=W+Z.pxmid[1]*(1-pe),Te=ne.separators,de=[];if(ge&&ge.indexOf("label")!==-1&&de.push(Z.label),Z.text=s.castOption(le.hovertext||le.text,Z.pts),ge&&ge.indexOf("text")!==-1){var be=Z.text;p.isValidTextValue(be)&&de.push(be)}Z.value=Z.v,Z.valueLabel=s.formatPieValue(Z.v,Te),ge&&ge.indexOf("value")!==-1&&de.push(Z.valueLabel),Z.percent=Z.v/ee.vTotal,Z.percentLabel=s.formatPiePercent(Z.percent,Te),ge&&ge.indexOf("percent")!==-1&&de.push(Z.percentLabel);var Le=le.hoverlabel,De=Le.font,ye=[];P.loneHover({trace:re,x0:xe-pe*ee.r,x1:xe+pe*ee.r,y:Ee,_x0:j?J+Z.TL[0]:xe-pe*ee.r,_x1:j?J+Z.TR[0]:xe+pe*ee.r,_y0:j?W+Z.TL[1]:Ee-pe*ee.r,_y1:j?W+Z.BL[1]:Ee+pe*ee.r,text:de.join("<br>"),name:le.hovertemplate||ge.indexOf("name")!==-1?le.name:void 0,idealAlign:Z.pxmid[0]<0?"left":"right",color:s.castOption(Le.bgcolor,Z.pts)||Z.color,borderColor:s.castOption(Le.bordercolor,Z.pts),fontFamily:s.castOption(De.family,Z.pts),fontSize:s.castOption(De.size,Z.pts),fontColor:s.castOption(De.color,Z.pts),nameLength:s.castOption(Le.namelength,Z.pts),textAlign:s.castOption(Le.align,Z.pts),hovertemplate:s.castOption(le.hovertemplate,Z.pts),hovertemplateLabels:Z,eventData:[m(Z,le)]},{container:ne._hoverlayer.node(),outerContainer:ne._paper.node(),gd:V,inOut_bbox:ye}),Z.bbox=ye[0],re._hasHoverLabel=!0}re._hasHoverEvent=!0,V.emit("plotly_hover",{points:[m(Z,le)],event:b.event})}}),Q.on("mouseout",function(Z){var ne=V._fullLayout,le=V._fullData[re.index],ge=b.select(this).datum();re._hasHoverEvent&&(Z.originalEvent=b.event,V.emit("plotly_unhover",{points:[m(ge,le)],event:b.event}),re._hasHoverEvent=!1),re._hasHoverLabel&&(P.loneUnhover(ne._hoverlayer.node()),re._hasHoverLabel=!1)}),Q.on("click",function(Z){var ne=V._fullLayout,le=V._fullData[re.index];V._dragging||ne.hovermode===!1||(V._hoverdata=[m(Z,le)],P.click(V,b.event))})}function l(Q,V,H){var ee=s.castOption(Q.outsidetextfont.color,V.pts)||s.castOption(Q.textfont.color,V.pts)||H.color,J=s.castOption(Q.outsidetextfont.family,V.pts)||s.castOption(Q.textfont.family,V.pts)||H.family,W=s.castOption(Q.outsidetextfont.size,V.pts)||s.castOption(Q.textfont.size,V.pts)||H.size;return{color:ee,family:J,size:W}}function y(Q,V,H){var ee=s.castOption(Q.insidetextfont.color,V.pts);!ee&&Q._input.textfont&&(ee=s.castOption(Q._input.textfont.color,V.pts));var J=s.castOption(Q.insidetextfont.family,V.pts)||s.castOption(Q.textfont.family,V.pts)||H.family,W=s.castOption(Q.insidetextfont.size,V.pts)||s.castOption(Q.textfont.size,V.pts)||H.size;return{color:ee||E.contrast(V.color),family:J,size:W}}function T(Q,V){for(var H,ee,J=0;J<Q.length;J++)if(H=Q[J][0],ee=H.trace,ee.title.text){var W=ee.title.text;ee._meta&&(W=p.templateString(W,ee._meta));var re=e.tester.append("text").attr("data-notex",1).text(W).call(e.font,ee.title.font).call(t.convertToTspans,V),j=e.bBox(re.node(),!0);H.titleBox={width:j.width,height:j.height},re.remove()}}function w(Q,V,H){var ee=H.r||V.rpx1,J=V.rInscribed,W=V.startangle===V.stopangle;if(W)return{rCenter:1-J,scale:0,rotate:0,textPosAngle:0};var re=V.ring,j=re===1&&Math.abs(V.startangle-V.stopangle)===Math.PI*2,Z=V.halfangle,ne=V.midangle,le=H.trace.insidetextorientation,ge=le==="horizontal",pe=le==="tangential",xe=le==="radial",Ee=le==="auto",Te=[],de;if(!Ee){var be=function(Ve,Ue){if(A(V,Ve)){var Ie=Math.abs(Ve-V.startangle),at=Math.abs(Ve-V.stopangle),pt=Ie<at?Ie:at;Ue==="tan"?de=u(Q,ee,re,pt,0):de=f(Q,ee,re,pt,Math.PI/2),de.textPosAngle=Ve,Te.push(de)}},Le;if(ge||pe){for(Le=4;Le>=-4;Le-=2)be(Math.PI*Le,"tan");for(Le=4;Le>=-4;Le-=2)be(Math.PI*(Le+1),"tan")}if(ge||xe){for(Le=4;Le>=-4;Le-=2)be(Math.PI*(Le+1.5),"rad");for(Le=4;Le>=-4;Le-=2)be(Math.PI*(Le+.5),"rad")}}if(j||Ee||ge){var De=Math.sqrt(Q.width*Q.width+Q.height*Q.height);if(de={scale:J*ee*2/De,rCenter:1-J,rotate:0},de.textPosAngle=(V.startangle+V.stopangle)/2,de.scale>=1)return de;Te.push(de)}(Ee||xe)&&(de=f(Q,ee,re,Z,ne),de.textPosAngle=(V.startangle+V.stopangle)/2,Te.push(de)),(Ee||pe)&&(de=u(Q,ee,re,Z,ne),de.textPosAngle=(V.startangle+V.stopangle)/2,Te.push(de));for(var ye=0,ke=0,Oe=0;Oe<Te.length;Oe++){var Qe=Te[Oe].scale;if(ke<Qe&&(ke=Qe,ye=Oe),!Ee&&ke>=1)break}return Te[ye]}function A(Q,V){var H=Q.startangle,ee=Q.stopangle;return H>V&&V>ee||H<V&&V<ee}function f(Q,V,H,ee,J){V=Math.max(0,V-2*d);var W=Q.width/Q.height,re=S(W,ee,V,H);return{scale:re*2/Q.height,rCenter:h(W,re/V),rotate:o(J)}}function u(Q,V,H,ee,J){V=Math.max(0,V-2*d);var W=Q.height/Q.width,re=S(W,ee,V,H);return{scale:re*2/Q.width,rCenter:h(W,re/V),rotate:o(J+Math.PI/2)}}function h(Q,V){return Math.cos(V)-Q*V}function o(Q){return(180/Math.PI*Q+720)%180-90}function S(Q,V,H,ee){var J=Q+1/(2*Math.tan(V));return H*Math.min(1/(Math.sqrt(J*J+.5)+J),ee/(Math.sqrt(Q*Q+ee/2)+Q))}function R(Q,V){return Q.v===V.vTotal&&!V.trace.hole?1:Math.min(1/(1+1/Math.sin(Q.halfangle)),Q.ring/2)}function z(Q,V){var H=V.pxmid[0],ee=V.pxmid[1],J=Q.width/2,W=Q.height/2;return H<0&&(J*=-1),ee<0&&(W*=-1),{scale:1,rCenter:1,rotate:0,x:J+Math.abs(W)*(J>0?1:-1)/2,y:W/(1+H*H/(ee*ee)),outside:!0}}function O(Q){var V=Math.sqrt(Q.titleBox.width*Q.titleBox.width+Q.titleBox.height*Q.titleBox.height);return{x:Q.cx,y:Q.cy,scale:Q.trace.hole*Q.r*2/V,tx:0,ty:-Q.titleBox.height/2+Q.trace.title.font.size}}function I(Q,V){var H=1,ee=1,J,W=Q.trace,re={x:Q.cx,y:Q.cy},j={tx:0,ty:0};j.ty+=W.title.font.size,J=B(W),W.title.position.indexOf("top")!==-1?(re.y-=(1+J)*Q.r,j.ty-=Q.titleBox.height):W.title.position.indexOf("bottom")!==-1&&(re.y+=(1+J)*Q.r);var Z=F(Q.r,Q.trace.aspectratio),ne=V.w*(W.domain.x[1]-W.domain.x[0])/2;return W.title.position.indexOf("left")!==-1?(ne=ne+Z,re.x-=(1+J)*Z,j.tx+=Q.titleBox.width/2):W.title.position.indexOf("center")!==-1?ne*=2:W.title.position.indexOf("right")!==-1&&(ne=ne+Z,re.x+=(1+J)*Z,j.tx-=Q.titleBox.width/2),H=ne/Q.titleBox.width,ee=D(Q,V)/Q.titleBox.height,{x:re.x,y:re.y,scale:Math.min(H,ee),tx:j.tx,ty:j.ty}}function F(Q,V){return Q/(V===void 0?1:V)}function D(Q,V){var H=Q.trace,ee=V.h*(H.domain.y[1]-H.domain.y[0]);return Math.min(Q.titleBox.height,ee/2)}function B(Q){var V=Q.pull;if(!V)return 0;var H;if(Array.isArray(V))for(V=0,H=0;H<Q.pull.length;H++)Q.pull[H]>V&&(V=Q.pull[H]);return V}function U(Q,V){var H,ee,J,W,re,j,Z,ne,le,ge,pe,xe,Ee;function Te(De,ye){return De.pxmid[1]-ye.pxmid[1]}function de(De,ye){return ye.pxmid[1]-De.pxmid[1]}function be(De,ye){ye||(ye={});var ke=ye.labelExtraY+(ee?ye.yLabelMax:ye.yLabelMin),Oe=ee?De.yLabelMin:De.yLabelMax,Qe=ee?De.yLabelMax:De.yLabelMin,Ve=De.cyFinal+re(De.px0[1],De.px1[1]),Ue=ke-Oe,Ie,at,pt,Rt,Mt,It;if(Ue*Z>0&&(De.labelExtraY=Ue),!!Array.isArray(V.pull))for(at=0;at<ge.length;at++)pt=ge[at],!(pt===De||(s.castOption(V.pull,De.pts)||0)>=(s.castOption(V.pull,pt.pts)||0))&&((De.pxmid[1]-pt.pxmid[1])*Z>0?(Rt=pt.cyFinal+re(pt.px0[1],pt.px1[1]),Ue=Rt-Oe-De.labelExtraY,Ue*Z>0&&(De.labelExtraY+=Ue)):(Qe+De.labelExtraY-Ve)*Z>0&&(Ie=3*j*Math.abs(at-ge.indexOf(De)),Mt=pt.cxFinal+W(pt.px0[0],pt.px1[0]),It=Mt+Ie-(De.cxFinal+De.pxmid[0])-De.labelExtraX,It*j>0&&(De.labelExtraX+=It)))}for(ee=0;ee<2;ee++)for(J=ee?Te:de,re=ee?Math.max:Math.min,Z=ee?1:-1,H=0;H<2;H++){for(W=H?Math.max:Math.min,j=H?1:-1,ne=Q[ee][H],ne.sort(J),le=Q[1-ee][H],ge=le.concat(ne),xe=[],pe=0;pe<ne.length;pe++)ne[pe].yLabelMid!==void 0&&xe.push(ne[pe]);for(Ee=!1,pe=0;ee&&pe<le.length;pe++)if(le[pe].yLabelMid!==void 0){Ee=le[pe];break}for(pe=0;pe<xe.length;pe++){var Le=pe&&xe[pe-1];Ee&&!pe&&(Le=Ee),be(xe[pe],Le)}}}function X(Q,V){for(var H=[],ee=0;ee<Q.length;ee++){var J=Q[ee][0],W=J.trace,re=W.domain,j=V.w*(re.x[1]-re.x[0]),Z=V.h*(re.y[1]-re.y[0]);W.title.text&&W.title.position!=="middle center"&&(Z-=D(J,V));var ne=j/2,le=Z/2;W.type==="funnelarea"&&!W.scalegroup&&(le/=W.aspectratio),J.r=Math.min(ne,le)/(1+B(W)),J.cx=V.l+V.w*(W.domain.x[1]+W.domain.x[0])/2,J.cy=V.t+V.h*(1-W.domain.y[0])-Z/2,W.title.text&&W.title.position.indexOf("bottom")!==-1&&(J.cy-=D(J,V)),W.scalegroup&&H.indexOf(W.scalegroup)===-1&&H.push(W.scalegroup)}oe(Q,H)}function oe(Q,V){for(var H,ee,J,W=0;W<V.length;W++){var re=1/0,j=V[W];for(ee=0;ee<Q.length;ee++)if(H=Q[ee][0],J=H.trace,J.scalegroup===j){var Z;if(J.type==="pie")Z=H.r*H.r;else if(J.type==="funnelarea"){var ne,le;J.aspectratio>1?(ne=H.r,le=ne/J.aspectratio):(le=H.r,ne=le*J.aspectratio),ne*=(1+J.baseratio)/2,Z=ne*le}re=Math.min(re,Z/H.vTotal)}for(ee=0;ee<Q.length;ee++)if(H=Q[ee][0],J=H.trace,J.scalegroup===j){var ge=re*H.vTotal;J.type==="funnelarea"&&(ge/=(1+J.baseratio)/2,ge/=J.aspectratio),H.r=Math.sqrt(ge)}}}function se(Q){var V=Q[0],H=V.r,ee=V.trace,J=s.getRotationAngle(ee.rotation),W=2*Math.PI/V.vTotal,re="px0",j="px1",Z,ne,le;if(ee.direction==="counterclockwise"){for(Z=0;Z<Q.length&&Q[Z].hidden;Z++);if(Z===Q.length)return;J+=W*Q[Z].v,W*=-1,re="px1",j="px0"}for(le=q(H,J),Z=0;Z<Q.length;Z++)ne=Q[Z],!ne.hidden&&(ne[re]=le,ne.startangle=J,J+=W*ne.v/2,ne.pxmid=q(H,J),ne.midangle=J,J+=W*ne.v/2,le=q(H,J),ne.stopangle=J,ne[j]=le,ne.largeArc=ne.v>V.vTotal/2?1:0,ne.halfangle=Math.PI*Math.min(ne.v/V.vTotal,.5),ne.ring=1-ee.hole,ne.rInscribed=R(ne,V))}function q(Q,V){return[Q*Math.sin(V),-Q*Math.cos(V)]}function K(Q,V,H){var ee=Q._fullLayout,J=H.trace,W=J.texttemplate,re=J.textinfo;if(!W&&re&&re!=="none"){var j=re.split("+"),Z=function(ye){return j.indexOf(ye)!==-1},ne=Z("label"),le=Z("text"),ge=Z("value"),pe=Z("percent"),xe=ee.separators,Ee;if(Ee=ne?[V.label]:[],le){var Te=s.getFirstFilled(J.text,V.pts);x(Te)&&Ee.push(Te)}ge&&Ee.push(s.formatPieValue(V.v,xe)),pe&&Ee.push(s.formatPiePercent(V.v/H.vTotal,xe)),V.text=Ee.join("<br>")}function de(ye){return{label:ye.label,value:ye.v,valueLabel:s.formatPieValue(ye.v,ee.separators),percent:ye.v/H.vTotal,percentLabel:s.formatPiePercent(ye.v/H.vTotal,ee.separators),color:ye.color,text:ye.text,customdata:p.castOption(J,ye.i,"customdata")}}if(W){var be=p.castOption(J,V.i,"texttemplate");if(!be)V.text="";else{var Le=de(V),De=s.getFirstFilled(J.text,V.pts);(x(De)||De==="")&&(Le.text=De),V.text=p.texttemplateString(be,Le,Q._fullLayout._d3locale,Le,J._meta||{})}}}function G(Q,V){var H=Q.rotate*Math.PI/180,ee=Math.cos(H),J=Math.sin(H),W=(V.left+V.right)/2,re=(V.top+V.bottom)/2;Q.textX=W*ee-re*J,Q.textY=W*J+re*ee,Q.noCenter=!0}ae.exports={plot:M,formatSliceLabel:K,transformInsideText:w,determineInsideTextFont:y,positionTitleOutside:I,prerenderTitles:T,layoutAreas:X,attachFxHandlers:_,computeTransform:G}},{"../../components/color":366,"../../components/drawing":388,"../../components/fx":406,"../../lib":503,"../../lib/svg_text_utils":529,"../../plots/plots":619,"../bar/constants":650,"../bar/uniform_text":664,"./event_data":905,"./helpers":906,"@plotly/d3":58}],911:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("./style_one"),P=c("../bar/uniform_text").resizeText;ae.exports=function(e){var p=e._fullLayout._pielayer.selectAll(".trace");P(e,p,"pie"),p.each(function(g){var a=g[0],t=a.trace,i=b.select(this);i.style({opacity:t.opacity}),i.selectAll("path.surface").each(function(n){b.select(this).call(k,n,t)})})}},{"../bar/uniform_text":664,"./style_one":912,"@plotly/d3":58}],912:[function(c,ae,ie){"use strict";var b=c("../../components/color"),k=c("./helpers").castOption;ae.exports=function(E,e,p){var g=p.marker.line,a=k(g.color,e.pts)||b.defaultLine,t=k(g.width,e.pts)||0;E.style("stroke-width",t).call(b.fill,e.color).call(b.stroke,a)}},{"../../components/color":366,"./helpers":906}],913:[function(c,ae,ie){"use strict";var b=c("../scatter/attributes");ae.exports={x:b.x,y:b.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:b.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":927}],914:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_pointcloud2d,k=c("../../lib/str2rgbarray"),P=c("../../plots/cartesian/autorange").findExtremes,E=c("../scatter/get_trace_color");function e(a,t){this.scene=a,this.uid=t,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=b(a.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var p=e.prototype;p.handlePick=function(a){var t=this.idToIndex[a.pointId];return{trace:this,dataCoord:a.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[t*2],this.pickXYData[t*2+1]]:[this.pickXData[t],this.pickYData[t]],textLabel:Array.isArray(this.textLabels)?this.textLabels[t]:this.textLabels,color:this.color,name:this.name,pointIndex:t,hoverinfo:this.hoverinfo}},p.update=function(a){this.index=a.index,this.textLabels=a.text,this.name=a.name,this.hoverinfo=a.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(a),this.color=E(a,{})},p.updateFast=function(a){var t=this.xData=this.pickXData=a.x,i=this.yData=this.pickYData=a.y,n=this.pickXYData=a.xy,r=a.xbounds&&a.ybounds,d=a.indices,s,m,x,M=this.bounds,v,_,l;if(n){if(x=n,s=n.length>>>1,r)M[0]=a.xbounds[0],M[2]=a.xbounds[1],M[1]=a.ybounds[0],M[3]=a.ybounds[1];else for(l=0;l<s;l++)v=x[l*2],_=x[l*2+1],v<M[0]&&(M[0]=v),v>M[2]&&(M[2]=v),_<M[1]&&(M[1]=_),_>M[3]&&(M[3]=_);if(d)m=d;else for(m=new Int32Array(s),l=0;l<s;l++)m[l]=l}else for(s=t.length,x=new Float32Array(2*s),m=new Int32Array(s),l=0;l<s;l++)v=t[l],_=i[l],m[l]=l,x[l*2]=v,x[l*2+1]=_,v<M[0]&&(M[0]=v),v>M[2]&&(M[2]=v),_<M[1]&&(M[1]=_),_>M[3]&&(M[3]=_);this.idToIndex=m,this.pointcloudOptions.idToIndex=m,this.pointcloudOptions.positions=x;var y=k(a.marker.color),T=k(a.marker.border.color),w=a.opacity*a.marker.opacity;y[3]*=w,this.pointcloudOptions.color=y;var A=a.marker.blend;if(A===null){var f=100;A=t.length<f||i.length<f}this.pointcloudOptions.blend=A,T[3]*=w,this.pointcloudOptions.borderColor=T;var u=a.marker.sizemin,h=Math.max(a.marker.sizemax,a.marker.sizemin);this.pointcloudOptions.sizeMin=u,this.pointcloudOptions.sizeMax=h,this.pointcloudOptions.areaRatio=a.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var o=this.scene.xaxis,S=this.scene.yaxis,R=h/2||.5;a._extremes[o._id]=P(o,[M[0],M[2]],{ppad:R}),a._extremes[S._id]=P(S,[M[1],M[3]],{ppad:R})},p.dispose=function(){this.pointcloud.dispose()};function g(a,t){var i=new e(a,t.uid);return i.update(t),i}ae.exports=g},{"../../../stackgl_modules":1124,"../../lib/str2rgbarray":528,"../../plots/cartesian/autorange":553,"../scatter/get_trace_color":937}],915:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes");ae.exports=function(E,e,p){function g(a,t){return b.coerce(E,e,k,a,t)}g("x"),g("y"),g("xbounds"),g("ybounds"),E.xy&&E.xy instanceof Float32Array&&(e.xy=E.xy),E.indices&&E.indices instanceof Int32Array&&(e.indices=E.indices),g("text"),g("marker.color",p),g("marker.opacity"),g("marker.blend"),g("marker.sizemin"),g("marker.sizemax"),g("marker.border.color",p),g("marker.border.arearatio"),e._length=null}},{"../../lib":503,"./attributes":913}],916:[function(c,ae,ie){"use strict";var b=["*pointcloud* trace is deprecated!","Please consider switching to the *scattergl* trace type."].join(" ");ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("../scatter3d/calc"),plot:c("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:c("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":596,"../scatter3d/calc":956,"./attributes":913,"./convert":914,"./defaults":915}],917:[function(c,ae,ie){"use strict";var b=c("../../plots/font_attributes"),k=c("../../plots/attributes"),P=c("../../components/color/attributes"),E=c("../../components/fx/attributes"),e=c("../../plots/domain").attributes,p=c("../../plots/template_attributes").hovertemplateAttrs,g=c("../../components/colorscale/attributes"),a=c("../../plot_api/plot_template").templatedArray,t=c("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,i=c("../../lib/extend").extendFlat,n=c("../../plot_api/edit_types").overrideAll,r=ae.exports=n({hoverinfo:i({},k.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:E.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:t("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:b({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:P.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:E.hoverlabel,hovertemplate:p({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:P.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:E.hoverlabel,hovertemplate:p({},{keys:["value","label"]}),colorscales:a("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:i(g().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested");r.transforms=void 0},{"../../components/color/attributes":365,"../../components/colorscale/attributes":373,"../../components/fx/attributes":397,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plot_api/plot_template":543,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/domain":584,"../../plots/font_attributes":585,"../../plots/template_attributes":633}],918:[function(c,ae,ie){"use strict";var b=c("../../plot_api/edit_types").overrideAll,k=c("../../plots/get_data").getModuleCalcData,P=c("./plot"),E=c("../../components/fx/layout_attributes"),e=c("../../lib/setcursor"),p=c("../../components/dragelement"),g=c("../../plots/cartesian/select").prepSelect,a=c("../../lib"),t=c("../../registry"),i="sankey";ie.name=i,ie.baseLayoutAttrOverrides=b({hoverlabel:E.hoverlabel},"plot","nested"),ie.plot=function(r){var d=k(r.calcdata,i)[0];P(r,d),ie.updateFx(r)},ie.clean=function(r,d,s,m){var x=m._has&&m._has(i),M=d._has&&d._has(i);x&&!M&&(m._paperdiv.selectAll(".sankey").remove(),m._paperdiv.selectAll(".bgsankey").remove())},ie.updateFx=function(r){for(var d=0;d<r._fullData.length;d++)n(r,d)};function n(r,d){var s=r._fullData[d],m=r._fullLayout,x=m.dragmode,M=m.dragmode==="pan"?"move":"crosshair",v=s._bgRect;if(!(x==="pan"||x==="zoom")){e(v,M);var _={_id:"x",c2p:a.identity,_offset:s._sankey.translateX,_length:s._sankey.width},l={_id:"y",c2p:a.identity,_offset:s._sankey.translateY,_length:s._sankey.height},y={gd:r,element:v.node(),plotinfo:{id:d,xaxis:_,yaxis:l,fillRangeItems:a.noop},subplot:d,xaxes:[_],yaxes:[l],doneFnCompleted:function(T){var w=r._fullData[d],A,f=w.node.groups.slice(),u=[];function h(z){for(var O=w._sankey.graph.nodes,I=0;I<O.length;I++)if(O[I].pointNumber===z)return O[I]}for(var o=0;o<T.length;o++){var S=h(T[o].pointNumber);if(!!S)if(S.group){for(var R=0;R<S.childrenNodes.length;R++)u.push(S.childrenNodes[R].pointNumber);f[S.pointNumber-w.node._count]=!1}else u.push(S.pointNumber)}A=f.filter(Boolean).concat([u]),t.call("_guiRestyle",r,{"node.groups":[A]},d)}};y.prepFn=function(T,w,A){g(T,w,A,y,x)},p.init(y)}}},{"../../components/dragelement":385,"../../components/fx/layout_attributes":407,"../../lib":503,"../../lib/setcursor":524,"../../plot_api/edit_types":536,"../../plots/cartesian/select":575,"../../plots/get_data":593,"../../registry":638,"./plot":923}],919:[function(c,ae,ie){"use strict";var b=c("strongly-connected-components"),k=c("../../lib"),P=c("../../lib/gup").wrap,E=k.isArrayOrTypedArray,e=k.isIndex,p=c("../../components/colorscale");function g(t){var i=t.node,n=t.link,r=[],d=E(n.color),s=E(n.customdata),m={},x={},M=n.colorscales.length,v;for(v=0;v<M;v++){var _=n.colorscales[v],l=p.extractScale(_,{cLetter:"c"}),y=p.makeColorScaleFunc(l);x[_.label]=y}var T=0;for(v=0;v<n.value.length;v++)n.source[v]>T&&(T=n.source[v]),n.target[v]>T&&(T=n.target[v]);var w=T+1;t.node._count=w;var A,f=t.node.groups,u={};for(v=0;v<f.length;v++){var h=f[v];for(A=0;A<h.length;A++){var o=h[A],S=w+v;u.hasOwnProperty(o)?k.warn("Node "+o+" is already part of a group."):u[o]=S}}var R={source:[],target:[]};for(v=0;v<n.value.length;v++){var z=n.value[v],O=n.source[v],I=n.target[v];if(!!(z>0&&e(O,w)&&e(I,w))&&!(u.hasOwnProperty(O)&&u.hasOwnProperty(I)&&u[O]===u[I])){u.hasOwnProperty(I)&&(I=u[I]),u.hasOwnProperty(O)&&(O=u[O]),O=+O,I=+I,m[O]=m[I]=!0;var F="";n.label&&n.label[v]&&(F=n.label[v]);var D=null;F&&x.hasOwnProperty(F)&&(D=x[F]),r.push({pointNumber:v,label:F,color:d?n.color[v]:n.color,customdata:s?n.customdata[v]:n.customdata,concentrationscale:D,source:O,target:I,value:+z}),R.source.push(O),R.target.push(I)}}var B=w+f.length,U=E(i.color),X=E(i.customdata),oe=[];for(v=0;v<B;v++)if(!!m[v]){var se=i.label[v];oe.push({group:v>w-1,childrenNodes:[],pointNumber:v,label:se,color:U?i.color[v]:i.color,customdata:X?i.customdata[v]:i.customdata})}var q=!1;return a(B,R.source,R.target)&&(q=!0),{circular:q,links:r,nodes:oe,groups:f,groupLookup:u}}function a(t,i,n){for(var r=k.init2dArray(t,0),d=0;d<Math.min(i.length,n.length);d++)if(k.isIndex(i[d],t)&&k.isIndex(n[d],t)){if(i[d]===n[d])return!0;r[i[d]].push(n[d])}var s=b(r);return s.components.some(function(m){return m.length>1})}ae.exports=function(i,n){var r=g(n);return P({circular:r.circular,_nodes:r.nodes,_links:r.links,_groups:r.groups,_groupLookup:r.groupLookup})}},{"../../components/colorscale":378,"../../lib":503,"../../lib/gup":500,"strongly-connected-components":306}],920:[function(c,ae,ie){"use strict";ae.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],921:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("../../components/color"),E=c("tinycolor2"),e=c("../../plots/domain").defaults,p=c("../../components/fx/hoverlabel_defaults"),g=c("../../plot_api/plot_template"),a=c("../../plots/array_container_defaults");ae.exports=function(n,r,d,s){function m(h,o){return b.coerce(n,r,k,h,o)}var x=b.extendDeep(s.hoverlabel,n.hoverlabel),M=n.node,v=g.newContainer(r,"node");function _(h,o){return b.coerce(M,v,k.node,h,o)}_("label"),_("groups"),_("x"),_("y"),_("pad"),_("thickness"),_("line.color"),_("line.width"),_("hoverinfo",n.hoverinfo),p(M,v,_,x),_("hovertemplate");var l=s.colorway,y=function(h){return l[h%l.length]};_("color",v.label.map(function(h,o){return P.addOpacity(y(o),.8)})),_("customdata");var T=n.link||{},w=g.newContainer(r,"link");function A(h,o){return b.coerce(T,w,k.link,h,o)}A("label"),A("source"),A("target"),A("value"),A("line.color"),A("line.width"),A("hoverinfo",n.hoverinfo),p(T,w,A,x),A("hovertemplate");var f=E(s.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";A("color",b.repeat(f,w.value.length)),A("customdata"),a(T,w,{name:"colorscales",handleItemDefaults:t}),e(r,s,m),m("orientation"),m("valueformat"),m("valuesuffix");var u;v.x.length&&v.y.length&&(u="freeform"),m("arrangement",u),b.coerceFont(m,"textfont",b.extendFlat({},s.font)),r._length=null};function t(i,n){function r(d,s){return b.coerce(i,n,k.link.colorscales,d,s)}r("label"),r("cmin"),r("cmax"),r("colorscale")}},{"../../components/color":366,"../../components/fx/hoverlabel_defaults":404,"../../lib":503,"../../plot_api/plot_template":543,"../../plots/array_container_defaults":549,"../../plots/domain":584,"./attributes":917,tinycolor2:312}],922:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("./calc"),plot:c("./plot"),moduleType:"trace",name:"sankey",basePlotModule:c("./base_plot"),selectPoints:c("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":917,"./base_plot":918,"./calc":919,"./defaults":921,"./plot":923,"./select.js":925}],923:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=k.numberFormat,E=c("./render"),e=c("../../components/fx"),p=c("../../components/color"),g=c("./constants").cn,a=k._;function t(l){return l!==""}function i(l,y){return l.filter(function(T){return T.key===y.traceId})}function n(l,y){b.select(l).select("path").style("fill-opacity",y),b.select(l).select("rect").style("fill-opacity",y)}function r(l){b.select(l).select("text.name").style("fill","black")}function d(l){return function(y){return l.node.sourceLinks.indexOf(y.link)!==-1||l.node.targetLinks.indexOf(y.link)!==-1}}function s(l){return function(y){return y.node.sourceLinks.indexOf(l.link)!==-1||y.node.targetLinks.indexOf(l.link)!==-1}}function m(l,y,T){y&&T&&i(T,y).selectAll("."+g.sankeyLink).filter(d(y)).call(M.bind(0,y,T,!1))}function x(l,y,T){y&&T&&i(T,y).selectAll("."+g.sankeyLink).filter(d(y)).call(v.bind(0,y,T,!1))}function M(l,y,T,w){var A=w.datum().link.label;w.style("fill-opacity",function(f){if(!f.link.concentrationscale)return .4}),A&&i(y,l).selectAll("."+g.sankeyLink).filter(function(f){return f.link.label===A}).style("fill-opacity",function(f){if(!f.link.concentrationscale)return .4}),T&&i(y,l).selectAll("."+g.sankeyNode).filter(s(l)).call(m)}function v(l,y,T,w){var A=w.datum().link.label;w.style("fill-opacity",function(f){return f.tinyColorAlpha}),A&&i(y,l).selectAll("."+g.sankeyLink).filter(function(f){return f.link.label===A}).style("fill-opacity",function(f){return f.tinyColorAlpha}),T&&i(y,l).selectAll(g.sankeyNode).filter(s(l)).call(x)}function _(l,y){var T=l.hoverlabel||{},w=k.nestedProperty(T,y).get();return Array.isArray(w)?!1:w}ae.exports=function(y,T){for(var w=y._fullLayout,A=w._paper,f=w._size,u=0;u<y._fullData.length;u++)if(!!y._fullData[u].visible&&y._fullData[u].type===g.sankey&&!y._fullData[u]._viewInitial){var h=y._fullData[u].node;y._fullData[u]._viewInitial={node:{groups:h.groups.slice(),x:h.x.slice(),y:h.y.slice()}}}var o=function(q,K){var G=K.link;G.originalEvent=b.event,y._hoverdata=[G],e.click(y,{target:!0})},S=function(q,K,G){y._fullLayout.hovermode!==!1&&(b.select(q).call(M.bind(0,K,G,!0)),K.link.trace.link.hoverinfo!=="skip"&&(K.link.fullData=K.link.trace,y.emit("plotly_hover",{event:b.event,points:[K.link]})))},R=a(y,"source:")+" ",z=a(y,"target:")+" ",O=a(y,"concentration:")+" ",I=a(y,"incoming flow count:")+" ",F=a(y,"outgoing flow count:")+" ",D=function(q,K){if(y._fullLayout.hovermode===!1)return;var G=K.link.trace.link;if(G.hoverinfo==="none"||G.hoverinfo==="skip")return;var Q=[];function V(Z){var ne,le;Z.circular?(ne=(Z.circularPathData.leftInnerExtent+Z.circularPathData.rightInnerExtent)/2,le=Z.circularPathData.verticalFullExtent):(ne=(Z.source.x1+Z.target.x0)/2,le=(Z.y0+Z.y1)/2);var ge=[ne,le];return Z.trace.orientation==="v"&&ge.reverse(),ge[0]+=K.parent.translateX,ge[1]+=K.parent.translateY,ge}for(var H=0,ee=0;ee<K.flow.links.length;ee++){var J=K.flow.links[ee];if(!(y._fullLayout.hovermode==="closest"&&K.link.pointNumber!==J.pointNumber)){K.link.pointNumber===J.pointNumber&&(H=ee),J.fullData=J.trace,G=K.link.trace.link;var W=V(J),re={valueLabel:P(K.valueFormat)(J.value)+K.valueSuffix};Q.push({x:W[0],y:W[1],name:re.valueLabel,text:[J.label||"",R+J.source.label,z+J.target.label,J.concentrationscale?O+P("%0.2f")(J.flow.labelConcentration):""].filter(t).join("<br>"),color:_(G,"bgcolor")||p.addOpacity(J.color,1),borderColor:_(G,"bordercolor"),fontFamily:_(G,"font.family"),fontSize:_(G,"font.size"),fontColor:_(G,"font.color"),nameLength:_(G,"namelength"),textAlign:_(G,"align"),idealAlign:b.event.x<W[0]?"right":"left",hovertemplate:G.hovertemplate,hovertemplateLabels:re,eventData:[J]})}}var j=e.loneHover(Q,{container:w._hoverlayer.node(),outerContainer:w._paper.node(),gd:y,anchorIndex:H});j.each(function(){var Z=this;K.link.concentrationscale||n(Z,.65),r(Z)})},B=function(q,K,G){y._fullLayout.hovermode!==!1&&(b.select(q).call(v.bind(0,K,G,!0)),K.link.trace.link.hoverinfo!=="skip"&&(K.link.fullData=K.link.trace,y.emit("plotly_unhover",{event:b.event,points:[K.link]})),e.loneUnhover(w._hoverlayer.node()))},U=function(q,K,G){var Q=K.node;Q.originalEvent=b.event,y._hoverdata=[Q],b.select(q).call(x,K,G),e.click(y,{target:!0})},X=function(q,K,G){y._fullLayout.hovermode!==!1&&(b.select(q).call(m,K,G),K.node.trace.node.hoverinfo!=="skip"&&(K.node.fullData=K.node.trace,y.emit("plotly_hover",{event:b.event,points:[K.node]})))},oe=function(q,K){if(y._fullLayout.hovermode!==!1){var G=K.node.trace.node;if(!(G.hoverinfo==="none"||G.hoverinfo==="skip")){var Q=b.select(q).select("."+g.nodeRect),V=y._fullLayout._paperdiv.node().getBoundingClientRect(),H=Q.node().getBoundingClientRect(),ee=H.left-2-V.left,J=H.right+2-V.left,W=H.top+H.height/4-V.top,re={valueLabel:P(K.valueFormat)(K.node.value)+K.valueSuffix};K.node.fullData=K.node.trace,y._fullLayout._calcInverseTransform(y);var j=y._fullLayout._invScaleX,Z=y._fullLayout._invScaleY,ne=e.loneHover({x0:j*ee,x1:j*J,y:Z*W,name:P(K.valueFormat)(K.node.value)+K.valueSuffix,text:[K.node.label,I+K.node.targetLinks.length,F+K.node.sourceLinks.length].filter(t).join("<br>"),color:_(G,"bgcolor")||K.tinyColorHue,borderColor:_(G,"bordercolor"),fontFamily:_(G,"font.family"),fontSize:_(G,"font.size"),fontColor:_(G,"font.color"),nameLength:_(G,"namelength"),textAlign:_(G,"align"),idealAlign:"left",hovertemplate:G.hovertemplate,hovertemplateLabels:re,eventData:[K.node]},{container:w._hoverlayer.node(),outerContainer:w._paper.node(),gd:y});n(ne,.85),r(ne)}}},se=function(q,K,G){y._fullLayout.hovermode!==!1&&(b.select(q).call(x,K,G),K.node.trace.node.hoverinfo!=="skip"&&(K.node.fullData=K.node.trace,y.emit("plotly_unhover",{event:b.event,points:[K.node]})),e.loneUnhover(w._hoverlayer.node()))};E(y,A,T,{width:f.w,height:f.h,margin:{t:f.t,r:f.r,b:f.b,l:f.l}},{linkEvents:{hover:S,follow:D,unhover:B,select:o},nodeEvents:{hover:X,follow:oe,unhover:se,select:U}})}},{"../../components/color":366,"../../components/fx":406,"../../lib":503,"./constants":920,"./render":924,"@plotly/d3":58}],924:[function(c,ae,ie){"use strict";var b=c("d3-force"),k=c("d3-interpolate").interpolateNumber,P=c("@plotly/d3"),E=c("@plotly/d3-sankey"),e=c("@plotly/d3-sankey-circular"),p=c("./constants"),g=c("tinycolor2"),a=c("../../components/color"),t=c("../../components/drawing"),i=c("../../lib"),n=i.strTranslate,r=i.strRotate,d=c("../../lib/gup"),s=d.keyFun,m=d.repeat,x=d.unwrap,M=c("../../lib/svg_text_utils"),v=c("../../registry"),_=c("../../constants/alignment"),l=_.CAP_SHIFT,y=_.LINE_SPACING,T=3;function w(V,H,ee){var J=x(H),W=J.trace,re=W.domain,j=W.orientation==="h",Z=W.node.pad,ne=W.node.thickness,le=V.width*(re.x[1]-re.x[0]),ge=V.height*(re.y[1]-re.y[0]),pe=J._nodes,xe=J._links,Ee=J.circular,Te;Ee?Te=e.sankeyCircular().circularLinkGap(0):Te=E.sankey(),Te.iterations(p.sankeyIterations).size(j?[le,ge]:[ge,le]).nodeWidth(ne).nodePadding(Z).nodeId(function(Mt){return Mt.pointNumber}).nodes(pe).links(xe);var de=Te();Te.nodePadding()<Z&&i.warn("node.pad was reduced to ",Te.nodePadding()," to fit within the figure.");var be,Le,De;for(var ye in J._groupLookup){var ke=parseInt(J._groupLookup[ye]),Oe;for(be=0;be<de.nodes.length;be++)if(de.nodes[be].pointNumber===ke){Oe=de.nodes[be];break}if(!!Oe){var Qe={pointNumber:parseInt(ye),x0:Oe.x0,x1:Oe.x1,y0:Oe.y0,y1:Oe.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};de.nodes.unshift(Qe),Oe.childrenNodes.unshift(Qe)}}function Ve(){for(be=0;be<de.nodes.length;be++){var Mt=de.nodes[be],It={},Bt,St;for(Le=0;Le<Mt.targetLinks.length;Le++)St=Mt.targetLinks[Le],Bt=St.source.pointNumber+":"+St.target.pointNumber,It.hasOwnProperty(Bt)||(It[Bt]=[]),It[Bt].push(St);var _t=Object.keys(It);for(Le=0;Le<_t.length;Le++){Bt=_t[Le];var it=It[Bt],ct=0,et={};for(De=0;De<it.length;De++)St=it[De],et[St.label]||(et[St.label]=0),et[St.label]+=St.value,ct+=St.value;for(De=0;De<it.length;De++)St=it[De],St.flow={value:ct,labelConcentration:et[St.label]/ct,concentration:St.value/ct,links:it},St.concentrationscale&&(St.color=g(St.concentrationscale(St.flow.labelConcentration)))}var Pe=0;for(Le=0;Le<Mt.sourceLinks.length;Le++)Pe+=Mt.sourceLinks[Le].value;for(Le=0;Le<Mt.sourceLinks.length;Le++)St=Mt.sourceLinks[Le],St.concentrationOut=St.value/Pe;var We=0;for(Le=0;Le<Mt.targetLinks.length;Le++)We+=Mt.targetLinks[Le].value;for(Le=0;Le<Mt.targetLinks.length;Le++)St=Mt.targetLinks[Le],St.concenrationIn=St.value/We}}Ve();function Ue(Mt){Mt.forEach(function(It){var Bt,St,_t=0,it=It.length,ct;for(It.sort(function(et,Pe){return et.y0-Pe.y0}),ct=0;ct<it;++ct)Bt=It[ct],Bt.y0>=_t||(St=_t-Bt.y0,St>1e-6&&(Bt.y0+=St,Bt.y1+=St)),_t=Bt.y1+Z})}function Ie(Mt){var It=Mt.map(function(Pe,We){return{x0:Pe.x0,index:We}}).sort(function(Pe,We){return Pe.x0-We.x0}),Bt=[],St=-1,_t,it=-1/0,ct;for(be=0;be<It.length;be++){var et=Mt[It[be].index];et.x0>it+ne&&(St+=1,_t=et.x0),it=et.x0,Bt[St]||(Bt[St]=[]),Bt[St].push(et),ct=_t-et.x0,et.x0+=ct,et.x1+=ct}return Bt}if(W.node.x.length&&W.node.y.length){for(be=0;be<Math.min(W.node.x.length,W.node.y.length,de.nodes.length);be++)if(W.node.x[be]&&W.node.y[be]){var at=[W.node.x[be]*le,W.node.y[be]*ge];de.nodes[be].x0=at[0]-ne/2,de.nodes[be].x1=at[0]+ne/2;var pt=de.nodes[be].y1-de.nodes[be].y0;de.nodes[be].y0=at[1]-pt/2,de.nodes[be].y1=at[1]+pt/2}if(W.arrangement==="snap"){pe=de.nodes;var Rt=Ie(pe);Ue(Rt)}Te.update(de)}return{circular:Ee,key:ee,trace:W,guid:i.randstr(),horizontal:j,width:le,height:ge,nodePad:W.node.pad,nodeLineColor:W.node.line.color,nodeLineWidth:W.node.line.width,linkLineColor:W.link.line.color,linkLineWidth:W.link.line.width,valueFormat:W.valueformat,valueSuffix:W.valuesuffix,textFont:W.textfont,translateX:re.x[0]*V.width+V.margin.l,translateY:V.height-re.y[1]*V.height+V.margin.t,dragParallel:j?ge:le,dragPerpendicular:j?le:ge,arrangement:W.arrangement,sankey:Te,graph:de,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function A(V,H,ee){var J=g(H.color),W=H.source.label+"|"+H.target.label,re=W+"__"+ee;return H.trace=V.trace,H.curveNumber=V.trace.index,{circular:V.circular,key:re,traceId:V.key,pointNumber:H.pointNumber,link:H,tinyColorHue:a.tinyRGB(J),tinyColorAlpha:J.getAlpha(),linkPath:u,linkLineColor:V.linkLineColor,linkLineWidth:V.linkLineWidth,valueFormat:V.valueFormat,valueSuffix:V.valueSuffix,sankey:V.sankey,parent:V,interactionState:V.interactionState,flow:H.flow}}function f(V){var H="",ee=V.width/2,J=V.circularPathData;return V.circularLinkType==="top"?H="M "+J.targetX+" "+(J.targetY+ee)+" L"+J.rightInnerExtent+" "+(J.targetY+ee)+"A"+(J.rightLargeArcRadius+ee)+" "+(J.rightSmallArcRadius+ee)+" 0 0 1 "+(J.rightFullExtent-ee)+" "+(J.targetY-J.rightSmallArcRadius)+"L"+(J.rightFullExtent-ee)+" "+J.verticalRightInnerExtent+"A"+(J.rightLargeArcRadius+ee)+" "+(J.rightLargeArcRadius+ee)+" 0 0 1 "+J.rightInnerExtent+" "+(J.verticalFullExtent-ee)+"L"+J.leftInnerExtent+" "+(J.verticalFullExtent-ee)+"A"+(J.leftLargeArcRadius+ee)+" "+(J.leftLargeArcRadius+ee)+" 0 0 1 "+(J.leftFullExtent+ee)+" "+J.verticalLeftInnerExtent+"L"+(J.leftFullExtent+ee)+" "+(J.sourceY-J.leftSmallArcRadius)+"A"+(J.leftLargeArcRadius+ee)+" "+(J.leftSmallArcRadius+ee)+" 0 0 1 "+J.leftInnerExtent+" "+(J.sourceY+ee)+"L"+J.sourceX+" "+(J.sourceY+ee)+"L"+J.sourceX+" "+(J.sourceY-ee)+"L"+J.leftInnerExtent+" "+(J.sourceY-ee)+"A"+(J.leftLargeArcRadius-ee)+" "+(J.leftSmallArcRadius-ee)+" 0 0 0 "+(J.leftFullExtent-ee)+" "+(J.sourceY-J.leftSmallArcRadius)+"L"+(J.leftFullExtent-ee)+" "+J.verticalLeftInnerExtent+"A"+(J.leftLargeArcRadius-ee)+" "+(J.leftLargeArcRadius-ee)+" 0 0 0 "+J.leftInnerExtent+" "+(J.verticalFullExtent+ee)+"L"+J.rightInnerExtent+" "+(J.verticalFullExtent+ee)+"A"+(J.rightLargeArcRadius-ee)+" "+(J.rightLargeArcRadius-ee)+" 0 0 0 "+(J.rightFullExtent+ee)+" "+J.verticalRightInnerExtent+"L"+(J.rightFullExtent+ee)+" "+(J.targetY-J.rightSmallArcRadius)+"A"+(J.rightLargeArcRadius-ee)+" "+(J.rightSmallArcRadius-ee)+" 0 0 0 "+J.rightInnerExtent+" "+(J.targetY-ee)+"L"+J.targetX+" "+(J.targetY-ee)+"Z":H="M "+J.targetX+" "+(J.targetY-ee)+" L"+J.rightInnerExtent+" "+(J.targetY-ee)+"A"+(J.rightLargeArcRadius+ee)+" "+(J.rightSmallArcRadius+ee)+" 0 0 0 "+(J.rightFullExtent-ee)+" "+(J.targetY+J.rightSmallArcRadius)+"L"+(J.rightFullExtent-ee)+" "+J.verticalRightInnerExtent+"A"+(J.rightLargeArcRadius+ee)+" "+(J.rightLargeArcRadius+ee)+" 0 0 0 "+J.rightInnerExtent+" "+(J.verticalFullExtent+ee)+"L"+J.leftInnerExtent+" "+(J.verticalFullExtent+ee)+"A"+(J.leftLargeArcRadius+ee)+" "+(J.leftLargeArcRadius+ee)+" 0 0 0 "+(J.leftFullExtent+ee)+" "+J.verticalLeftInnerExtent+"L"+(J.leftFullExtent+ee)+" "+(J.sourceY+J.leftSmallArcRadius)+"A"+(J.leftLargeArcRadius+ee)+" "+(J.leftSmallArcRadius+ee)+" 0 0 0 "+J.leftInnerExtent+" "+(J.sourceY-ee)+"L"+J.sourceX+" "+(J.sourceY-ee)+"L"+J.sourceX+" "+(J.sourceY+ee)+"L"+J.leftInnerExtent+" "+(J.sourceY+ee)+"A"+(J.leftLargeArcRadius-ee)+" "+(J.leftSmallArcRadius-ee)+" 0 0 1 "+(J.leftFullExtent-ee)+" "+(J.sourceY+J.leftSmallArcRadius)+"L"+(J.leftFullExtent-ee)+" "+J.verticalLeftInnerExtent+"A"+(J.leftLargeArcRadius-ee)+" "+(J.leftLargeArcRadius-ee)+" 0 0 1 "+J.leftInnerExtent+" "+(J.verticalFullExtent-ee)+"L"+J.rightInnerExtent+" "+(J.verticalFullExtent-ee)+"A"+(J.rightLargeArcRadius-ee)+" "+(J.rightLargeArcRadius-ee)+" 0 0 1 "+(J.rightFullExtent+ee)+" "+J.verticalRightInnerExtent+"L"+(J.rightFullExtent+ee)+" "+(J.targetY+J.rightSmallArcRadius)+"A"+(J.rightLargeArcRadius-ee)+" "+(J.rightSmallArcRadius-ee)+" 0 0 1 "+J.rightInnerExtent+" "+(J.targetY+ee)+"L"+J.targetX+" "+(J.targetY+ee)+"Z",H}function u(){var V=.5;function H(ee){if(ee.link.circular)return f(ee.link);var J=ee.link.source.x1,W=ee.link.target.x0,re=k(J,W),j=re(V),Z=re(1-V),ne=ee.link.y0-ee.link.width/2,le=ee.link.y0+ee.link.width/2,ge=ee.link.y1-ee.link.width/2,pe=ee.link.y1+ee.link.width/2;return"M"+J+","+ne+"C"+j+","+ne+" "+Z+","+ge+" "+W+","+ge+"L"+W+","+pe+"C"+Z+","+pe+" "+j+","+le+" "+J+","+le+"Z"}return H}function h(V,H){var ee=g(H.color),J=p.nodePadAcross,W=V.nodePad/2;H.dx=H.x1-H.x0,H.dy=H.y1-H.y0;var re=H.dx,j=Math.max(.5,H.dy),Z="node_"+H.pointNumber;return H.group&&(Z=i.randstr()),H.trace=V.trace,H.curveNumber=V.trace.index,{index:H.pointNumber,key:Z,partOfGroup:H.partOfGroup||!1,group:H.group,traceId:V.key,trace:V.trace,node:H,nodePad:V.nodePad,nodeLineColor:V.nodeLineColor,nodeLineWidth:V.nodeLineWidth,textFont:V.textFont,size:V.horizontal?V.height:V.width,visibleWidth:Math.ceil(re),visibleHeight:j,zoneX:-J,zoneY:-W,zoneWidth:re+2*J,zoneHeight:j+2*W,labelY:V.horizontal?H.dy/2+1:H.dx/2+1,left:H.originalLayer===1,sizeAcross:V.width,forceLayouts:V.forceLayouts,horizontal:V.horizontal,darkBackground:ee.getBrightness()<=128,tinyColorHue:a.tinyRGB(ee),tinyColorAlpha:ee.getAlpha(),valueFormat:V.valueFormat,valueSuffix:V.valueSuffix,sankey:V.sankey,graph:V.graph,arrangement:V.arrangement,uniqueNodeLabelPathId:[V.guid,V.key,Z].join("_"),interactionState:V.interactionState,figure:V}}function o(V){V.attr("transform",function(H){return n(H.node.x0.toFixed(3),H.node.y0.toFixed(3))})}function S(V){V.call(o)}function R(V,H){V.call(S),H.attr("d",u())}function z(V){V.attr("width",function(H){return H.node.x1-H.node.x0}).attr("height",function(H){return H.visibleHeight})}function O(V){return V.link.width>1||V.linkLineWidth>0}function I(V){var H=n(V.translateX,V.translateY);return H+(V.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function F(V,H,ee){V.on(".basic",null).on("mouseover.basic",function(J){!J.interactionState.dragInProgress&&!J.partOfGroup&&(ee.hover(this,J,H),J.interactionState.hovered=[this,J])}).on("mousemove.basic",function(J){!J.interactionState.dragInProgress&&!J.partOfGroup&&(ee.follow(this,J),J.interactionState.hovered=[this,J])}).on("mouseout.basic",function(J){!J.interactionState.dragInProgress&&!J.partOfGroup&&(ee.unhover(this,J,H),J.interactionState.hovered=!1)}).on("click.basic",function(J){J.interactionState.hovered&&(ee.unhover(this,J,H),J.interactionState.hovered=!1),!J.interactionState.dragInProgress&&!J.partOfGroup&&ee.select(this,J,H)})}function D(V,H,ee,J){var W=P.behavior.drag().origin(function(re){return{x:re.node.x0+re.visibleWidth/2,y:re.node.y0+re.visibleHeight/2}}).on("dragstart",function(re){if(re.arrangement!=="fixed"&&(i.ensureSingle(J._fullLayout._infolayer,"g","dragcover",function(Z){J._fullLayout._dragCover=Z}),i.raiseToTop(this),re.interactionState.dragInProgress=re.node,q(re.node),re.interactionState.hovered&&(ee.nodeEvents.unhover.apply(0,re.interactionState.hovered),re.interactionState.hovered=!1),re.arrangement==="snap")){var j=re.traceId+"|"+re.key;re.forceLayouts[j]?re.forceLayouts[j].alpha(1):B(V,j,re,J),U(V,H,re,j,J)}}).on("drag",function(re){if(re.arrangement!=="fixed"){var j=P.event.x,Z=P.event.y;re.arrangement==="snap"?(re.node.x0=j-re.visibleWidth/2,re.node.x1=j+re.visibleWidth/2,re.node.y0=Z-re.visibleHeight/2,re.node.y1=Z+re.visibleHeight/2):(re.arrangement==="freeform"&&(re.node.x0=j-re.visibleWidth/2,re.node.x1=j+re.visibleWidth/2),Z=Math.max(0,Math.min(re.size-re.visibleHeight/2,Z)),re.node.y0=Z-re.visibleHeight/2,re.node.y1=Z+re.visibleHeight/2),q(re.node),re.arrangement!=="snap"&&(re.sankey.update(re.graph),R(V.filter(K(re)),H))}}).on("dragend",function(re){if(re.arrangement!=="fixed"){re.interactionState.dragInProgress=!1;for(var j=0;j<re.node.childrenNodes.length;j++)re.node.childrenNodes[j].x=re.node.x,re.node.childrenNodes[j].y=re.node.y;re.arrangement!=="snap"&&oe(re,J)}});V.on(".drag",null).call(W)}function B(V,H,ee,J){G(ee.graph.nodes);var W=ee.graph.nodes.filter(function(re){return re.originalX===ee.node.originalX}).filter(function(re){return!re.partOfGroup});ee.forceLayouts[H]=b.forceSimulation(W).alphaDecay(0).force("collide",b.forceCollide().radius(function(re){return re.dy/2+ee.nodePad/2}).strength(1).iterations(p.forceIterations)).force("constrain",X(V,H,W,ee,J)).stop()}function U(V,H,ee,J,W){window.requestAnimationFrame(function re(){var j;for(j=0;j<p.forceTicksPerFrame;j++)ee.forceLayouts[J].tick();var Z=ee.graph.nodes;if(Q(Z),ee.sankey.update(ee.graph),R(V.filter(K(ee)),H),ee.forceLayouts[J].alpha()>0)window.requestAnimationFrame(re);else{var ne=ee.node.originalX;ee.node.x0=ne-ee.visibleWidth/2,ee.node.x1=ne+ee.visibleWidth/2,oe(ee,W)}})}function X(V,H,ee,J){return function(){for(var re=0,j=0;j<ee.length;j++){var Z=ee[j];Z===J.interactionState.dragInProgress?(Z.x=Z.lastDraggedX,Z.y=Z.lastDraggedY):(Z.vx=(Z.originalX-Z.x)/p.forceTicksPerFrame,Z.y=Math.min(J.size-Z.dy/2,Math.max(Z.dy/2,Z.y))),re=Math.max(re,Math.abs(Z.vx),Math.abs(Z.vy))}!J.interactionState.dragInProgress&&re<.1&&J.forceLayouts[H].alpha()>0&&J.forceLayouts[H].alpha(0)}}function oe(V,H){for(var ee=[],J=[],W=0;W<V.graph.nodes.length;W++){var re=(V.graph.nodes[W].x0+V.graph.nodes[W].x1)/2,j=(V.graph.nodes[W].y0+V.graph.nodes[W].y1)/2;ee.push(re/V.figure.width),J.push(j/V.figure.height)}v.call("_guiRestyle",H,{"node.x":[ee],"node.y":[J]},V.trace.index).then(function(){H._fullLayout._dragCover&&H._fullLayout._dragCover.remove()})}function se(V){var H=[],ee;for(ee=0;ee<V.length;ee++)V[ee].originalX=(V[ee].x0+V[ee].x1)/2,V[ee].originalY=(V[ee].y0+V[ee].y1)/2,H.indexOf(V[ee].originalX)===-1&&H.push(V[ee].originalX);for(H.sort(function(J,W){return J-W}),ee=0;ee<V.length;ee++)V[ee].originalLayerIndex=H.indexOf(V[ee].originalX),V[ee].originalLayer=V[ee].originalLayerIndex/(H.length-1)}function q(V){V.lastDraggedX=V.x0+V.dx/2,V.lastDraggedY=V.y0+V.dy/2}function K(V){return function(H){return H.node.originalX===V.node.originalX}}function G(V){for(var H=0;H<V.length;H++)V[H].y=(V[H].y0+V[H].y1)/2,V[H].x=(V[H].x0+V[H].x1)/2}function Q(V){for(var H=0;H<V.length;H++)V[H].y0=V[H].y-V[H].dy/2,V[H].y1=V[H].y0+V[H].dy,V[H].x0=V[H].x-V[H].dx/2,V[H].x1=V[H].x0+V[H].dx}ae.exports=function(V,H,ee,J,W){var re=!1;i.ensureSingle(V._fullLayout._infolayer,"g","first-render",function(){re=!0});var j=V._fullLayout._dragCover,Z=ee.filter(function(de){return x(de).trace.visible}).map(w.bind(null,J)),ne=H.selectAll("."+p.cn.sankey).data(Z,s);ne.exit().remove(),ne.enter().append("g").classed(p.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",I),ne.each(function(de,be){V._fullData[be]._sankey=de;var Le="bgsankey-"+de.trace.uid+"-"+be;i.ensureSingle(V._fullLayout._draggers,"rect",Le),V._fullData[be]._bgRect=P.select("."+Le),V._fullData[be]._bgRect.style("pointer-events","all").attr("width",de.width).attr("height",de.height).attr("x",de.translateX).attr("y",de.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),ne.transition().ease(p.ease).duration(p.duration).attr("transform",I);var le=ne.selectAll("."+p.cn.sankeyLinks).data(m,s);le.enter().append("g").classed(p.cn.sankeyLinks,!0).style("fill","none");var ge=le.selectAll("."+p.cn.sankeyLink).data(function(de){var be=de.graph.links;return be.filter(function(Le){return Le.value}).map(A.bind(null,de))},s);ge.enter().append("path").classed(p.cn.sankeyLink,!0).call(F,ne,W.linkEvents),ge.style("stroke",function(de){return O(de)?a.tinyRGB(g(de.linkLineColor)):de.tinyColorHue}).style("stroke-opacity",function(de){return O(de)?a.opacity(de.linkLineColor):de.tinyColorAlpha}).style("fill",function(de){return de.tinyColorHue}).style("fill-opacity",function(de){return de.tinyColorAlpha}).style("stroke-width",function(de){return O(de)?de.linkLineWidth:1}).attr("d",u()),ge.style("opacity",function(){return V._context.staticPlot||re||j?1:0}).transition().ease(p.ease).duration(p.duration).style("opacity",1),ge.exit().transition().ease(p.ease).duration(p.duration).style("opacity",0).remove();var pe=ne.selectAll("."+p.cn.sankeyNodeSet).data(m,s);pe.enter().append("g").classed(p.cn.sankeyNodeSet,!0),pe.style("cursor",function(de){switch(de.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var xe=pe.selectAll("."+p.cn.sankeyNode).data(function(de){var be=de.graph.nodes;return se(be),be.map(h.bind(null,de))},s);xe.enter().append("g").classed(p.cn.sankeyNode,!0).call(o).style("opacity",function(de){return(V._context.staticPlot||re)&&!de.partOfGroup?1:0}),xe.call(F,ne,W.nodeEvents).call(D,ge,W,V),xe.transition().ease(p.ease).duration(p.duration).call(o).style("opacity",function(de){return de.partOfGroup?0:1}),xe.exit().transition().ease(p.ease).duration(p.duration).style("opacity",0).remove();var Ee=xe.selectAll("."+p.cn.nodeRect).data(m);Ee.enter().append("rect").classed(p.cn.nodeRect,!0).call(z),Ee.style("stroke-width",function(de){return de.nodeLineWidth}).style("stroke",function(de){return a.tinyRGB(g(de.nodeLineColor))}).style("stroke-opacity",function(de){return a.opacity(de.nodeLineColor)}).style("fill",function(de){return de.tinyColorHue}).style("fill-opacity",function(de){return de.tinyColorAlpha}),Ee.transition().ease(p.ease).duration(p.duration).call(z);var Te=xe.selectAll("."+p.cn.nodeLabel).data(m);Te.enter().append("text").classed(p.cn.nodeLabel,!0).style("cursor","default"),Te.attr("data-notex",1).text(function(de){return de.node.label}).each(function(de){var be=P.select(this);t.font(be,de.textFont),M.convertToTspans(be,V)}).style("text-shadow",M.makeTextShadow(V._fullLayout.paper_bgcolor)).attr("text-anchor",function(de){return de.horizontal&&de.left?"end":"start"}).attr("transform",function(de){var be=P.select(this),Le=M.lineCount(be),De=de.textFont.size*((Le-1)*y-l),ye=de.nodeLineWidth/2+T,ke=((de.horizontal?de.visibleHeight:de.visibleWidth)-De)/2;de.horizontal&&(de.left?ye=-ye:ye+=de.visibleWidth);var Oe=de.horizontal?"":"scale(-1,1)"+r(90);return n(de.horizontal?ye:ke,de.horizontal?ke:ye)+Oe}),Te.transition().ease(p.ease).duration(p.duration)}},{"../../components/color":366,"../../components/drawing":388,"../../constants/alignment":471,"../../lib":503,"../../lib/gup":500,"../../lib/svg_text_utils":529,"../../registry":638,"./constants":920,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:312}],925:[function(c,ae,ie){"use strict";ae.exports=function(k,P){for(var E=k.cd,e=[],p=E[0].trace,g=p._sankey.graph.nodes,a=0;a<g.length;a++){var t=g[a];if(!t.partOfGroup){var i=[(t.x0+t.x1)/2,(t.y0+t.y1)/2];p.orientation==="v"&&i.reverse(),P&&P.contains(i,!1,a,k)&&e.push({pointNumber:t.pointNumber})}}return e}},{}],926:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E){for(var e=0;e<P.length;e++)P[e].i=e;b.mergeArray(E.text,P,"tx"),b.mergeArray(E.texttemplate,P,"txt"),b.mergeArray(E.hovertext,P,"htx"),b.mergeArray(E.customdata,P,"data"),b.mergeArray(E.textposition,P,"tp"),E.textfont&&(b.mergeArrayCastPositive(E.textfont.size,P,"ts"),b.mergeArray(E.textfont.color,P,"tc"),b.mergeArray(E.textfont.family,P,"tf"));var p=E.marker;if(p){b.mergeArrayCastPositive(p.size,P,"ms"),b.mergeArrayCastPositive(p.opacity,P,"mo"),b.mergeArray(p.symbol,P,"mx"),b.mergeArray(p.color,P,"mc");var g=p.line;p.line&&(b.mergeArray(g.color,P,"mlc"),b.mergeArrayCastPositive(g.width,P,"mlw"));var a=p.gradient;a&&a.type!=="none"&&(b.mergeArray(a.type,P,"mgt"),b.mergeArray(a.color,P,"mgc"))}}},{"../../lib":503}],927:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,k=c("../../plots/template_attributes").texttemplateAttrs,P=c("../../plots/template_attributes").hovertemplateAttrs,E=c("../../components/colorscale/attributes"),e=c("../../plots/font_attributes"),p=c("../../components/drawing/attributes").dash,g=c("../../components/drawing/attributes").pattern,a=c("../../components/drawing"),t=c("./constants"),i=c("../../lib/extend").extendFlat;function n(s){return{valType:"any",dflt:0,editType:"calc"}}function r(s){return{valType:"any",editType:"calc"}}function d(s){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}ae.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:n("x"),yperiod:n("y"),xperiod0:r("x0"),yperiod0:r("y0"),xperiodalignment:d("x"),yperiodalignment:d("y"),xhoverformat:b("x"),yhoverformat:b("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:k({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:P({},{keys:t.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:i({},p,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:g,marker:i({symbol:{valType:"enumerated",values:a.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:i({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},E("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},E("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":373,"../../components/drawing":388,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../../plots/font_attributes":585,"../../plots/template_attributes":633,"./constants":931}],928:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../../plots/cartesian/axes"),E=c("../../plots/cartesian/align_period"),e=c("../../constants/numerical").BADNUM,p=c("./subtypes"),g=c("./colorscale_calc"),a=c("./arrays_to_calcdata"),t=c("./calc_selection");function i(x,M){var v=x._fullLayout,_=P.getFromId(x,M.xaxis||"x"),l=P.getFromId(x,M.yaxis||"y"),y=_.makeCalcdata(M,"x"),T=l.makeCalcdata(M,"y"),w=E(M,_,"x",y),A=E(M,l,"y",T),f=w.vals,u=A.vals,h=M._length,o=new Array(h),S=M.ids,R=m(M,v,_,l),z=!1,O,I,F,D,B,U;d(v,M);var X="x",oe="y",se;if(R)k.pushUnique(R.traceIndices,M._expandedIndex),O=R.orientation==="v",O?(oe="s",se="x"):(X="s",se="y"),B=R.stackgaps==="interpolate";else{var q=r(M,h);n(x,M,_,l,f,u,q)}var K=!!M.xperiodalignment,G=!!M.yperiodalignment;for(I=0;I<h;I++){var Q=o[I]={},V=b(f[I]),H=b(u[I]);V&&H?(Q[X]=f[I],Q[oe]=u[I],K&&(Q.orig_x=y[I],Q.xEnd=w.ends[I],Q.xStart=w.starts[I]),G&&(Q.orig_y=T[I],Q.yEnd=A.ends[I],Q.yStart=A.starts[I])):R&&(O?V:H)?(Q[se]=O?f[I]:u[I],Q.gap=!0,B?(Q.s=e,z=!0):Q.s=0):Q[X]=Q[oe]=e,S&&(Q.id=String(S[I]))}if(a(o,M),g(x,M),t(o,M),R){for(I=0;I<o.length;)o[I][se]===e?o.splice(I,1):I++;if(k.sort(o,function(re,j){return re[se]-j[se]||re.i-j.i}),z){for(I=0;I<o.length-1&&o[I].gap;)I++;for(U=o[I].s,U||(U=o[I].s=0),F=0;F<I;F++)o[F].s=U;for(D=o.length-1;D>I&&o[D].gap;)D--;for(U=o[D].s,F=o.length-1;F>D;F--)o[F].s=U;for(;I<D;)if(I++,o[I].gap){for(F=I+1;o[F].gap;)F++;for(var ee=o[I-1][se],J=o[I-1].s,W=(o[F].s-J)/(o[F][se]-ee);I<F;)o[I].s=J+(o[I][se]-ee)*W,I++}}}return o}function n(x,M,v,_,l,y,T){var w=M._length,A=x._fullLayout,f=v._id,u=_._id,h=A._firstScatter[s(M)]===M.uid,o=(m(M,A,v,_)||{}).orientation,S=M.fill;v._minDtick=0,_._minDtick=0;var R={padded:!0},z={padded:!0};T&&(R.ppad=z.ppad=T);var O=w<2||l[0]!==l[w-1]||y[0]!==y[w-1];O&&(S==="tozerox"||S==="tonextx"&&(h||o==="h"))?R.tozero=!0:!(M.error_y||{}).visible&&(S==="tonexty"||S==="tozeroy"||!p.hasMarkers(M)&&!p.hasText(M))&&(R.padded=!1,R.ppad=0),O&&(S==="tozeroy"||S==="tonexty"&&(h||o==="v"))?z.tozero=!0:(S==="tonextx"||S==="tozerox")&&(z.padded=!1),f&&(M._extremes[f]=P.findExtremes(v,l,R)),u&&(M._extremes[u]=P.findExtremes(_,y,z))}function r(x,M){if(!!p.hasMarkers(x)){var v=x.marker,_=1.6*(x.marker.sizeref||1),l;if(x.marker.sizemode==="area"?l=function(f){return Math.max(Math.sqrt((f||0)/_),3)}:l=function(f){return Math.max((f||0)/_,3)},k.isArrayOrTypedArray(v.size)){var y={type:"linear"};P.setConvert(y);for(var T=y.makeCalcdata(x.marker,"size"),w=new Array(M),A=0;A<M;A++)w[A]=l(T[A]);return w}else return l(v.size)}}function d(x,M){var v=s(M),_=x._firstScatter;_[v]||(_[v]=M.uid)}function s(x){var M=x.stackgroup;return x.xaxis+x.yaxis+x.type+(M?"-"+M:"")}function m(x,M,v,_){var l=x.stackgroup;if(!!l){var y=M._scatterStackOpts[v._id+_._id][l],T=y.orientation==="v"?_:v;if(T.type==="linear"||T.type==="log")return y}}ae.exports={calc:i,calcMarkerSize:r,calcAxisExpansion:n,setFirstScatter:d,getStackOpts:m}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"./arrays_to_calcdata":926,"./calc_selection":929,"./colorscale_calc":930,"./subtypes":952,"fast-isnumeric":190}],929:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E){b.isArrayOrTypedArray(E.selectedpoints)&&b.tagSelected(P,E)}},{"../../lib":503}],930:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/helpers").hasColorscale,k=c("../../components/colorscale/calc"),P=c("./subtypes");ae.exports=function(e,p){P.hasLines(p)&&b(p,"line")&&k(e,p,{vals:p.line.color,containerStr:"line",cLetter:"c"}),P.hasMarkers(p)&&(b(p,"marker")&&k(e,p,{vals:p.marker.color,containerStr:"marker",cLetter:"c"}),b(p,"marker.line")&&k(e,p,{vals:p.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":374,"../../components/colorscale/helpers":377,"./subtypes":952}],931:[function(c,ae,ie){"use strict";ae.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],932:[function(c,ae,ie){"use strict";var b=c("./calc");ae.exports=function(e,p){var g=p.xaxis,a=p.yaxis,t=g._id+a._id,i=e._fullLayout._scatterStackOpts[t];if(!!i){var n=e.calcdata,r,d,s,m,x,M,v,_,l,y,T,w,A,f,u;for(var h in i){y=i[h];var o=y.traceIndices;if(!!o.length){for(T=y.stackgaps==="interpolate",w=y.groupnorm,y.orientation==="v"?(A="x",f="y"):(A="y",f="x"),u=new Array(o.length),r=0;r<u.length;r++)u[r]=!1;M=n[o[0]];var S=new Array(M.length);for(r=0;r<M.length;r++)S[r]=M[r][A];for(r=1;r<o.length;r++){for(x=n[o[r]],d=s=0;d<x.length;d++){for(v=x[d][A];v>S[s]&&s<S.length;s++)k(x,d,S[s],r,u,T,A),d++;if(v!==S[s]){for(m=0;m<r;m++)k(n[o[m]],s,v,m,u,T,A);S.splice(s,0,v)}s++}for(;s<S.length;s++)k(x,d,S[s],r,u,T,A),d++}var R=S.length;for(d=0;d<M.length;d++){for(_=M[d][f]=M[d].s,r=1;r<o.length;r++)x=n[o[r]],x[0].trace._rawLength=x[0].trace._length,x[0].trace._length=R,_+=x[d].s,x[d][f]=_;if(w)for(l=(w==="fraction"?_:_/100)||1,r=0;r<o.length;r++){var z=n[o[r]][d];z[f]/=l,z.sNorm=z.s/l}}for(r=0;r<o.length;r++){x=n[o[r]];var O=x[0].trace,I=b.calcMarkerSize(O,O._rawLength),F=Array.isArray(I);if(I&&u[r]||F){var D=I;for(I=new Array(R),d=0;d<R;d++)I[d]=x[d].gap?0:F?D[x[d].i]:D}var B=new Array(R),U=new Array(R);for(d=0;d<R;d++)B[d]=x[d].x,U[d]=x[d].y;b.calcAxisExpansion(e,O,g,a,B,U,I),x[0].t.orientation=y.orientation}}}}};function k(E,e,p,g,a,t,i){a[g]=!0;var n={i:null,gap:!0,s:0};if(n[i]=p,E.splice(e,0,n),e&&p===E[e-1][i]){var r=E[e-1];n.s=r.s,n.i=r.i,n.gap=r.gap}else t&&(n.s=P(E,e,p,i));e||(E[0].t=E[1].t,E[0].trace=E[1].trace,delete E[1].t,delete E[1].trace)}function P(E,e,p,g){var a=E[e-1],t=E[e+1];return t?a?a.s+(t.s-a.s)*(p-a[g])/(t[g]-a[g]):t.s:a.s}},{"./calc":928}],933:[function(c,ae,ie){"use strict";ae.exports=function(k){for(var P=0;P<k.length;P++){var E=k[P];if(E.type==="scatter"){var e=E.fill;if(!(e==="none"||e==="toself")&&(E.opacity=void 0,e==="tonexty"||e==="tonextx"))for(var p=P-1;p>=0;p--){var g=k[p];if(g.type==="scatter"&&g.xaxis===E.xaxis&&g.yaxis===E.yaxis){g.opacity=void 0;break}}}}}},{}],934:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../registry"),P=c("./attributes"),E=c("./constants"),e=c("./subtypes"),p=c("./xy_defaults"),g=c("./period_defaults"),a=c("./stack_defaults"),t=c("./marker_defaults"),i=c("./line_defaults"),n=c("./line_shape_defaults"),r=c("./text_defaults"),d=c("./fillcolor_defaults"),s=c("../../lib").coercePattern;ae.exports=function(x,M,v,_){function l(o,S){return b.coerce(x,M,P,o,S)}var y=p(x,M,_,l);if(y||(M.visible=!1),!!M.visible){g(x,M,_,l),l("xhoverformat"),l("yhoverformat");var T=a(x,M,_,l),w=!T&&y<E.PTS_LINESONLY?"lines+markers":"lines";l("text"),l("hovertext"),l("mode",w),e.hasLines(M)&&(i(x,M,v,_,l),n(x,M,l),l("connectgaps"),l("line.simplify")),e.hasMarkers(M)&&t(x,M,v,_,l,{gradient:!0}),e.hasText(M)&&(l("texttemplate"),r(x,M,_,l));var A=[];(e.hasMarkers(M)||e.hasText(M))&&(l("cliponaxis"),l("marker.maxdisplayed"),A.push("points")),l("fill",T?T.fillDflt:"none"),M.fill!=="none"&&(d(x,M,v,l),e.hasLines(M)||n(x,M,l),s(l,"fillpattern",M.fillcolor,!1));var f=(M.line||{}).color,u=(M.marker||{}).color;(M.fill==="tonext"||M.fill==="toself")&&A.push("fills"),l("hoveron",A.join("+")||"points"),M.hoveron!=="fills"&&l("hovertemplate");var h=k.getComponentMethod("errorbars","supplyDefaults");h(x,M,f||u||v,{axis:"y"}),h(x,M,f||u||v,{axis:"x",inherit:"y"}),b.coerceSelectionMarkerOpacity(M,l)}}},{"../../lib":503,"../../registry":638,"./attributes":927,"./constants":931,"./fillcolor_defaults":935,"./line_defaults":940,"./line_shape_defaults":942,"./marker_defaults":946,"./period_defaults":947,"./stack_defaults":950,"./subtypes":952,"./text_defaults":953,"./xy_defaults":954}],935:[function(c,ae,ie){"use strict";var b=c("../../components/color"),k=c("../../lib").isArrayOrTypedArray;ae.exports=function(E,e,p,g){var a=!1;if(e.marker){var t=e.marker.color,i=(e.marker.line||{}).color;t&&!k(t)?a=t:i&&!k(i)&&(a=i)}g("fillcolor",b.addOpacity((e.line||{}).color||a||p,.5))}},{"../../components/color":366,"../../lib":503}],936:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes");ae.exports=function(P,E,e){var p={},g={_fullLayout:e},a=b.getFromTrace(g,E,"x"),t=b.getFromTrace(g,E,"y");return p.xLabel=b.tickText(a,a.c2l(P.x),!0).text,p.yLabel=b.tickText(t,t.c2l(P.y),!0).text,p}},{"../../plots/cartesian/axes":554}],937:[function(c,ae,ie){"use strict";var b=c("../../components/color"),k=c("./subtypes");ae.exports=function(E,e){var p,g;if(E.mode==="lines")return p=E.line.color,p&&b.opacity(p)?p:E.fillcolor;if(E.mode==="none")return E.fill?E.fillcolor:"";var a=e.mcc||(E.marker||{}).color,t=e.mlcc||((E.marker||{}).line||{}).color;return g=a&&b.opacity(a)?a:t&&b.opacity(t)&&(e.mlw||((E.marker||{}).line||{}).width)?t:"",g?b.opacity(g)<.3?b.addOpacity(g,.3):g:(p=(E.line||{}).color,p&&b.opacity(p)&&k.hasLines(E)&&E.line.width?p:E.fillcolor)}},{"../../components/color":366,"./subtypes":952}],938:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/fx"),P=c("../../registry"),E=c("./get_trace_color"),e=c("../../components/color"),p=b.fillText;ae.exports=function(a,t,i,n){var r=a.cd,d=r[0].trace,s=a.xa,m=a.ya,x=s.c2p(t),M=m.c2p(i),v=[x,M],_=d.hoveron||"",l=d.mode.indexOf("markers")!==-1?3:.5,y=!!d.xperiodalignment,T=!!d.yperiodalignment;if(_.indexOf("points")!==-1){var w=function(ne){if(y){var le=s.c2p(ne.xStart),ge=s.c2p(ne.xEnd);return x>=Math.min(le,ge)&&x<=Math.max(le,ge)?0:1/0}var pe=Math.max(3,ne.mrc||0),xe=1-1/pe,Ee=Math.abs(s.c2p(ne.x)-x);return Ee<pe?xe*Ee/pe:Ee-pe+xe},A=function(ne){if(T){var le=m.c2p(ne.yStart),ge=m.c2p(ne.yEnd);return M>=Math.min(le,ge)&&M<=Math.max(le,ge)?0:1/0}var pe=Math.max(3,ne.mrc||0),xe=1-1/pe,Ee=Math.abs(m.c2p(ne.y)-M);return Ee<pe?xe*Ee/pe:Ee-pe+xe},f=function(ne){var le=Math.max(l,ne.mrc||0),ge=s.c2p(ne.x)-x,pe=m.c2p(ne.y)-M;return Math.max(Math.sqrt(ge*ge+pe*pe)-le,1-l/le)},u=k.getDistanceFunction(n,w,A,f);if(k.getClosest(r,u,a),a.index!==!1){var h=r[a.index],o=s.c2p(h.x,!0),S=m.c2p(h.y,!0),R=h.mrc||1;a.index=h.i;var z=r[0].t.orientation,O=z&&(h.sNorm||h.s),I=z==="h"?O:h.orig_x!==void 0?h.orig_x:h.x,F=z==="v"?O:h.orig_y!==void 0?h.orig_y:h.y;return b.extendFlat(a,{color:E(d,h),x0:o-R,x1:o+R,xLabelVal:I,y0:S-R,y1:S+R,yLabelVal:F,spikeDistance:f(h),hovertemplate:d.hovertemplate}),p(h,d,a),P.getComponentMethod("errorbars","hoverInfo")(h,d,a),[a]}}if(_.indexOf("fills")!==-1&&d._polygons){var D=d._polygons,B=[],U=!1,X=1/0,oe=-1/0,se=1/0,q=-1/0,K,G,Q,V,H,ee,J,W,re;for(K=0;K<D.length;K++)Q=D[K],Q.contains(v)&&(U=!U,B.push(Q),se=Math.min(se,Q.ymin),q=Math.max(q,Q.ymax));if(U){se=Math.max(se,0),q=Math.min(q,m._length);var j=(se+q)/2;for(K=0;K<B.length;K++)for(V=B[K].pts,G=1;G<V.length;G++)W=V[G-1][1],re=V[G][1],W>j!=re>=j&&(ee=V[G-1][0],J=V[G][0],re-W&&(H=ee+(J-ee)*(j-W)/(re-W),X=Math.min(X,H),oe=Math.max(oe,H)));X=Math.max(X,0),oe=Math.min(oe,s._length);var Z=e.defaultLine;return e.opacity(d.fillcolor)?Z=d.fillcolor:e.opacity((d.line||{}).color)&&(Z=d.line.color),b.extendFlat(a,{distance:a.maxHoverDistance,x0:X,x1:oe,y0:j,y1:j,color:Z,hovertemplate:!1}),delete a.index,d.text&&!Array.isArray(d.text)?a.text=String(d.text):a.text=d.name,[a]}}}},{"../../components/color":366,"../../components/fx":406,"../../lib":503,"../../registry":638,"./get_trace_color":937}],939:[function(c,ae,ie){"use strict";var b=c("./subtypes");ae.exports={hasLines:b.hasLines,hasMarkers:b.hasMarkers,hasText:b.hasText,isBubble:b.isBubble,attributes:c("./attributes"),supplyDefaults:c("./defaults"),crossTraceDefaults:c("./cross_trace_defaults"),calc:c("./calc").calc,crossTraceCalc:c("./cross_trace_calc"),arraysToCalcdata:c("./arrays_to_calcdata"),plot:c("./plot"),colorbar:c("./marker_colorbar"),formatLabels:c("./format_labels"),style:c("./style").style,styleOnSelect:c("./style").styleOnSelect,hoverPoints:c("./hover"),selectPoints:c("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"./arrays_to_calcdata":926,"./attributes":927,"./calc":928,"./cross_trace_calc":932,"./cross_trace_defaults":933,"./defaults":934,"./format_labels":936,"./hover":938,"./marker_colorbar":945,"./plot":948,"./select":949,"./style":951,"./subtypes":952}],940:[function(c,ae,ie){"use strict";var b=c("../../lib").isArrayOrTypedArray,k=c("../../components/colorscale/helpers").hasColorscale,P=c("../../components/colorscale/defaults");ae.exports=function(e,p,g,a,t,i){var n=(e.marker||{}).color;if(t("line.color",g),k(e,"line"))P(e,p,a,t,{prefix:"line.",cLetter:"c"});else{var r=(b(n)?!1:n)||g;t("line.color",r)}t("line.width"),(i||{}).noDash||t("line.dash")}},{"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"../../lib":503}],941:[function(c,ae,ie){"use strict";var b=c("../../constants/numerical"),k=b.BADNUM,P=b.LOG_CLIP,E=P+.5,e=P-.5,p=c("../../lib"),g=p.segmentsIntersect,a=p.constrain,t=c("./constants");ae.exports=function(n,r){var d=r.xaxis,s=r.yaxis,m=d.type==="log",x=s.type==="log",M=d._length,v=s._length,_=r.connectGaps,l=r.baseTolerance,y=r.shape,T=y==="linear",w=r.fill&&r.fill!=="none",A=[],f=t.minTolerance,u=n.length,h=new Array(u),o=0,S,R,z,O,I,F,D,B,U,X,oe,se,q,K,G,Q;function V(Mt){var It=n[Mt];if(!It)return!1;var Bt=r.linearized?d.l2p(It.x):d.c2p(It.x),St=r.linearized?s.l2p(It.y):s.c2p(It.y);if(Bt===k){if(m&&(Bt=d.c2p(It.x,!0)),Bt===k)return!1;x&&St===k&&(Bt*=Math.abs(d._m*v*(d._m>0?E:e)/(s._m*M*(s._m>0?E:e)))),Bt*=1e3}if(St===k){if(x&&(St=s.c2p(It.y,!0)),St===k)return!1;St*=1e3}return[Bt,St]}function H(Mt,It,Bt,St){var _t=Bt-Mt,it=St-It,ct=.5-Mt,et=.5-It,Pe=_t*_t+it*it,We=_t*ct+it*et;if(We>0&&We<Pe){var je=ct*it-et*_t;if(je*je<Pe)return!0}}var ee,J;function W(Mt,It){var Bt=Mt[0]/M,St=Mt[1]/v,_t=Math.max(0,-Bt,Bt-1,-St,St-1);return _t&&ee!==void 0&&H(Bt,St,ee,J)&&(_t=0),_t&&It&&H(Bt,St,It[0]/M,It[1]/v)&&(_t=0),(1+t.toleranceGrowth*_t)*l}function re(Mt,It){var Bt=Mt[0]-It[0],St=Mt[1]-It[1];return Math.sqrt(Bt*Bt+St*St)}var j=t.maxScreensAway,Z=-M*j,ne=M*(1+j),le=-v*j,ge=v*(1+j),pe=[[Z,le,ne,le],[ne,le,ne,ge],[ne,ge,Z,ge],[Z,ge,Z,le]],xe,Ee,Te,de,be,Le;function De(Mt,It){for(var Bt=[],St=0,_t=0;_t<4;_t++){var it=pe[_t],ct=g(Mt[0],Mt[1],It[0],It[1],it[0],it[1],it[2],it[3]);ct&&(!St||Math.abs(ct.x-Bt[0][0])>1||Math.abs(ct.y-Bt[0][1])>1)&&(ct=[ct.x,ct.y],St&&re(ct,Mt)<re(Bt[0],Mt)?Bt.unshift(ct):Bt.push(ct),St++)}return Bt}function ye(Mt){if(Mt[0]<Z||Mt[0]>ne||Mt[1]<le||Mt[1]>ge)return[a(Mt[0],Z,ne),a(Mt[1],le,ge)]}function ke(Mt,It){if(Mt[0]===It[0]&&(Mt[0]===Z||Mt[0]===ne)||Mt[1]===It[1]&&(Mt[1]===le||Mt[1]===ge))return!0}function Oe(Mt,It){var Bt=[],St=ye(Mt),_t=ye(It);return St&&_t&&ke(St,_t)||(St&&Bt.push(St),_t&&Bt.push(_t)),Bt}function Qe(Mt,It,Bt){return function(St,_t){var it=ye(St),ct=ye(_t),et=[];if(it&&ct&&ke(it,ct))return et;it&&et.push(it),ct&&et.push(ct);var Pe=2*p.constrain((St[Mt]+_t[Mt])/2,It,Bt)-((it||St)[Mt]+(ct||_t)[Mt]);if(Pe){var We;it&&ct?We=Pe>0==it[Mt]>ct[Mt]?it:ct:We=it||ct,We[Mt]+=Pe}return et}}var Ve;y==="linear"||y==="spline"?Ve=De:y==="hv"||y==="vh"?Ve=Oe:y==="hvh"?Ve=Qe(0,Z,ne):y==="vhv"&&(Ve=Qe(1,le,ge));function Ue(Mt,It){var Bt=It[0]-Mt[0],St=(It[1]-Mt[1])/Bt,_t=(Mt[1]*It[0]-It[1]*Mt[0])/Bt;return _t>0?[St>0?Z:ne,ge]:[St>0?ne:Z,le]}function Ie(Mt){var It=Mt[0],Bt=Mt[1],St=It===h[o-1][0],_t=Bt===h[o-1][1];if(!(St&&_t))if(o>1){var it=It===h[o-2][0],ct=Bt===h[o-2][1];St&&(It===Z||It===ne)&&it?ct?o--:h[o-1]=Mt:_t&&(Bt===le||Bt===ge)&&ct?it?o--:h[o-1]=Mt:h[o++]=Mt}else h[o++]=Mt}function at(Mt){h[o-1][0]!==Mt[0]&&h[o-1][1]!==Mt[1]&&Ie([Te,de]),Ie(Mt),be=null,Te=de=0}function pt(Mt){if(ee=Mt[0]/M,J=Mt[1]/v,xe=Mt[0]<Z?Z:Mt[0]>ne?ne:0,Ee=Mt[1]<le?le:Mt[1]>ge?ge:0,xe||Ee){if(!o)h[o++]=[xe||Mt[0],Ee||Mt[1]];else if(be){var It=Ve(be,Mt);It.length>1&&(at(It[0]),h[o++]=It[1])}else Le=Ve(h[o-1],Mt)[0],h[o++]=Le;var Bt=h[o-1];xe&&Ee&&(Bt[0]!==xe||Bt[1]!==Ee)?(be&&(Te!==xe&&de!==Ee?Ie(Te&&de?Ue(be,Mt):[Te||xe,de||Ee]):Te&&de&&Ie([Te,de])),Ie([xe,Ee])):Te-xe&&de-Ee&&Ie([xe||Te,Ee||de]),be=Mt,Te=xe,de=Ee}else be&&at(Ve(be,Mt)[0]),h[o++]=Mt}for(S=0;S<u;S++)if(R=V(S),!!R){for(o=0,be=null,pt(R),S++;S<u;S++){if(O=V(S),!O){if(_)continue;break}if(!T||!r.simplify){pt(O);continue}var Rt=V(S+1);if(X=re(O,R),!(!(w&&(o===0||o===u-1))&&X<W(O,Rt)*f)){for(B=[(O[0]-R[0])/X,(O[1]-R[1])/X],I=R,oe=X,se=K=G=0,D=!1,z=O,S++;S<n.length;S++){if(F=Rt,Rt=V(S+1),!F){if(_)continue;break}if(U=[F[0]-R[0],F[1]-R[1]],Q=U[0]*B[1]-U[1]*B[0],K=Math.min(K,Q),G=Math.max(G,Q),G-K>W(F,Rt))break;z=F,q=U[0]*B[0]+U[1]*B[1],q>oe?(oe=q,O=F,D=!1):q<se&&(se=q,I=F,D=!0)}if(D?(pt(O),z!==I&&pt(I)):(I!==R&&pt(I),z!==O&&pt(O)),pt(z),S>=n.length||!F)break;pt(F),R=F}}be&&Ie([Te||be[0],de||be[1]]),A.push(h.slice(0,o))}return A}},{"../../constants/numerical":479,"../../lib":503,"./constants":931}],942:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E){var e=E("line.shape");e==="spline"&&E("line.smoothing")}},{}],943:[function(c,ae,ie){"use strict";var b={tonextx:1,tonexty:1,tonext:1};ae.exports=function(P,E,e){var p,g,a,t,i,n={},r=!1,d=-1,s=0,m=-1;for(g=0;g<e.length;g++)p=e[g][0].trace,a=p.stackgroup||"",a?a in n?i=n[a]:(i=n[a]=s,s++):p.fill in b&&m>=0?i=m:(i=m=s,s++),i<d&&(r=!0),p._groupIndex=d=i;var x=e.slice();r&&x.sort(function(v,_){var l=v[0].trace,y=_[0].trace;return l._groupIndex-y._groupIndex||l.index-y.index});var M={};for(g=0;g<x.length;g++)p=x[g][0].trace,a=p.stackgroup||"",p.visible===!0?(p._nexttrace=null,p.fill in b&&(t=M[a],p._prevtrace=t||null,t&&(t._nexttrace=p)),p._ownfill=p.fill&&(p.fill.substr(0,6)==="tozero"||p.fill==="toself"||p.fill.substr(0,2)==="to"&&!p._prevtrace),M[a]=p):p._prevtrace=p._nexttrace=p._ownfill=null;return x}},{}],944:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric");ae.exports=function(P,E){E||(E=2);var e=P.marker,p=e.sizeref||1,g=e.sizemin||0,a=e.sizemode==="area"?function(t){return Math.sqrt(t/p)}:function(t){return t/p};return function(t){var i=a(t/E);return b(i)&&i>0?Math.max(i,g):0}}},{"fast-isnumeric":190}],945:[function(c,ae,ie){"use strict";ae.exports={container:"marker",min:"cmin",max:"cmax"}},{}],946:[function(c,ae,ie){"use strict";var b=c("../../components/color"),k=c("../../components/colorscale/helpers").hasColorscale,P=c("../../components/colorscale/defaults"),E=c("./subtypes");ae.exports=function(p,g,a,t,i,n){var r=E.isBubble(p),d=(p.line||{}).color,s;if(n=n||{},d&&(a=d),i("marker.symbol"),i("marker.opacity",r?.7:1),i("marker.size"),i("marker.color",a),k(p,"marker")&&P(p,g,t,i,{prefix:"marker.",cLetter:"c"}),n.noSelect||(i("selected.marker.color"),i("unselected.marker.color"),i("selected.marker.size"),i("unselected.marker.size")),n.noLine||(d&&!Array.isArray(d)&&g.marker.color!==d?s=d:r?s=b.background:s=b.defaultLine,i("marker.line.color",s),k(p,"marker.line")&&P(p,g,t,i,{prefix:"marker.line.",cLetter:"c"}),i("marker.line.width",r?1:0)),r&&(i("marker.sizeref"),i("marker.sizemin"),i("marker.sizemode")),n.gradient){var m=i("marker.gradient.type");m!=="none"&&i("marker.gradient.color")}}},{"../../components/color":366,"../../components/colorscale/defaults":376,"../../components/colorscale/helpers":377,"./subtypes":952}],947:[function(c,ae,ie){"use strict";var b=c("../../lib").dateTick0,k=c("../../constants/numerical"),P=k.ONEWEEK;function E(e,p){return e%P===0?b(p,1):b(p,0)}ae.exports=function(p,g,a,t,i){if(i||(i={x:!0,y:!0}),i.x){var n=t("xperiod");n&&(t("xperiod0",E(n,g.xcalendar)),t("xperiodalignment"))}if(i.y){var r=t("yperiod");r&&(t("yperiod0",E(r,g.ycalendar)),t("yperiodalignment"))}}},{"../../constants/numerical":479,"../../lib":503}],948:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../registry"),P=c("../../lib"),E=P.ensureSingle,e=P.identity,p=c("../../components/drawing"),g=c("./subtypes"),a=c("./line_points"),t=c("./link_traces"),i=c("../../lib/polygon").tester;ae.exports=function(m,x,M,v,_,l){var y,T,w=!_,A=!!_&&_.duration>0,f=t(m,x,M);if(y=v.selectAll("g.trace").data(f,function(h){return h[0].trace.uid}),y.enter().append("g").attr("class",function(h){return"trace scatter trace"+h[0].trace.uid}).style("stroke-miterlimit",2),y.order(),n(m,y,x),A){l&&(T=l());var u=b.transition().duration(_.duration).ease(_.easing).each("end",function(){T&&T()}).each("interrupt",function(){T&&T()});u.each(function(){v.selectAll("g.trace").each(function(h,o){r(m,o,x,h,f,this,_)})})}else y.each(function(h,o){r(m,o,x,h,f,this,_)});w&&y.exit().remove(),v.selectAll("path:not([d])").remove()};function n(s,m,x){m.each(function(M){var v=E(b.select(this),"g","fills");p.setClipUrl(v,x.layerClipId,s);var _=M[0].trace,l=[];_._ownfill&&l.push("_ownFill"),_._nexttrace&&l.push("_nextFill");var y=v.selectAll("g").data(l,e);y.enter().append("g"),y.exit().each(function(T){_[T]=null}).remove(),y.order().each(function(T){_[T]=E(b.select(this),"path","js-fill")})})}function r(s,m,x,M,v,_,l){var y;d(s,m,x,M,v);var T=!!l&&l.duration>0;function w(De){return T?De.transition():De}var A=x.xaxis,f=x.yaxis,u=M[0].trace,h=u.line,o=b.select(_),S=E(o,"g","errorbars"),R=E(o,"g","lines"),z=E(o,"g","points"),O=E(o,"g","text");if(k.getComponentMethod("errorbars","plot")(s,S,x,l),u.visible!==!0)return;w(o).style("opacity",u.opacity);var I,F,D=u.fill.charAt(u.fill.length-1);D!=="x"&&D!=="y"&&(D=""),M[0][x.isRangePlot?"nodeRangePlot3":"node3"]=o;var B="",U=[],X=u._prevtrace;X&&(B=X._prevRevpath||"",F=X._nextFill,U=X._polygons);var oe,se,q="",K="",G,Q,V,H,ee,J,W,re=[],j=P.noop;if(I=u._ownFill,g.hasLines(u)||u.fill!=="none"){for(F&&F.datum(M),["hv","vh","hvh","vhv"].indexOf(h.shape)!==-1?(G=p.steps(h.shape),Q=p.steps(h.shape.split("").reverse().join(""))):h.shape==="spline"?G=Q=function(De){var ye=De[De.length-1];return De.length>1&&De[0][0]===ye[0]&&De[0][1]===ye[1]?p.smoothclosed(De.slice(1),h.smoothing):p.smoothopen(De,h.smoothing)}:G=Q=function(De){return"M"+De.join("L")},V=function(De){return Q(De.reverse())},re=a(M,{xaxis:A,yaxis:f,connectGaps:u.connectgaps,baseTolerance:Math.max(h.width||1,3)/4,shape:h.shape,simplify:h.simplify,fill:u.fill}),W=u._polygons=new Array(re.length),y=0;y<re.length;y++)u._polygons[y]=i(re[y]);re.length&&(H=re[0][0],ee=re[re.length-1],J=ee[ee.length-1]),j=function(De){return function(ye){if(oe=G(ye),se=V(ye),q?D?(q+="L"+oe.substr(1),K=se+("L"+K.substr(1))):(q+="Z"+oe,K=se+"Z"+K):(q=oe,K=se),g.hasLines(u)&&ye.length>1){var ke=b.select(this);if(ke.datum(M),De)w(ke.style("opacity",0).attr("d",oe).call(p.lineGroupStyle)).style("opacity",1);else{var Oe=w(ke);Oe.attr("d",oe),p.singleLineStyle(M,Oe)}}}}}var Z=R.selectAll(".js-line").data(re);w(Z.exit()).style("opacity",0).remove(),Z.each(j(!1)),Z.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(p.lineGroupStyle).each(j(!0)),p.setClipUrl(Z,x.layerClipId,s);function ne(De){w(De).attr("d","M0,0Z")}re.length?(I?(I.datum(M),H&&J&&(D?(D==="y"?H[1]=J[1]=f.c2p(0,!0):D==="x"&&(H[0]=J[0]=A.c2p(0,!0)),w(I).attr("d","M"+J+"L"+H+"L"+q.substr(1)).call(p.singleFillStyle,s)):w(I).attr("d",q+"Z").call(p.singleFillStyle,s))):F&&(u.fill.substr(0,6)==="tonext"&&q&&B?(u.fill==="tonext"?w(F).attr("d",q+"Z"+B+"Z").call(p.singleFillStyle,s):w(F).attr("d",q+"L"+B.substr(1)+"Z").call(p.singleFillStyle,s),u._polygons=u._polygons.concat(U)):(ne(F),u._polygons=null)),u._prevRevpath=K,u._prevPolygons=W):(I?ne(I):F&&ne(F),u._polygons=u._prevRevpath=u._prevPolygons=null);function le(De){return De.filter(function(ye){return!ye.gap&&ye.vis})}function ge(De){return De.filter(function(ye){return ye.vis})}function pe(De){return De.filter(function(ye){return!ye.gap})}function xe(De){return De.id}function Ee(De){if(De.ids)return xe}function Te(){return!1}function de(De,ye,ke){var Oe,Qe,Ve,Ue=ke[0].trace,Ie=g.hasMarkers(Ue),at=g.hasText(Ue),pt=Ee(Ue),Rt=Te,Mt=Te;if(Ie||at){var It=e,Bt=Ue.stackgroup,St=Bt&&s._fullLayout._scatterStackOpts[A._id+f._id][Bt].stackgaps==="infer zero";Ue.marker.maxdisplayed||Ue._needsCull?It=St?ge:le:Bt&&!St&&(It=pe),Ie&&(Rt=It),at&&(Mt=It)}Qe=De.selectAll("path.point"),Oe=Qe.data(Rt,pt);var _t=Oe.enter().append("path").classed("point",!0);T&&_t.call(p.pointStyle,Ue,s).call(p.translatePoints,A,f).style("opacity",0).transition().style("opacity",1),Oe.order();var it;Ie&&(it=p.makePointStyleFns(Ue)),Oe.each(function(ct){var et=b.select(this),Pe=w(et);Ve=p.translatePoint(ct,Pe,A,f),Ve?(p.singlePointStyle(ct,Pe,Ue,it,s),x.layerClipId&&p.hideOutsideRangePoint(ct,Pe,A,f,Ue.xcalendar,Ue.ycalendar),Ue.customdata&&et.classed("plotly-customdata",ct.data!==null&&ct.data!==void 0)):Pe.remove()}),T?Oe.exit().transition().style("opacity",0).remove():Oe.exit().remove(),Qe=ye.selectAll("g"),Oe=Qe.data(Mt,pt),Oe.enter().append("g").classed("textpoint",!0).append("text"),Oe.order(),Oe.each(function(ct){var et=b.select(this),Pe=w(et.select("text"));Ve=p.translatePoint(ct,Pe,A,f),Ve?x.layerClipId&&p.hideOutsideRangePoint(ct,et,A,f,Ue.xcalendar,Ue.ycalendar):et.remove()}),Oe.selectAll("text").call(p.textPointStyle,Ue,s).each(function(ct){var et=A.c2p(ct.x),Pe=f.c2p(ct.y);b.select(this).selectAll("tspan.line").each(function(){w(b.select(this)).attr({x:et,y:Pe})})}),Oe.exit().remove()}z.datum(M),O.datum(M),de(z,O,M);var be=u.cliponaxis===!1,Le=be?null:x.layerClipId;p.setClipUrl(z,Le,s),p.setClipUrl(O,Le,s)}function d(s,m,x,M,v){var _=x.xaxis,l=x.yaxis,y=b.extent(P.simpleMap(_.range,_.r2c)),T=b.extent(P.simpleMap(l.range,l.r2c)),w=M[0].trace;if(!!g.hasMarkers(w)){var A=w.marker.maxdisplayed;if(A!==0){var f=M.filter(function(S){return S.x>=y[0]&&S.x<=y[1]&&S.y>=T[0]&&S.y<=T[1]}),u=Math.ceil(f.length/A),h=0;v.forEach(function(S,R){var z=S[0].trace;g.hasMarkers(z)&&z.marker.maxdisplayed>0&&R<m&&h++});var o=Math.round(h*u/3+Math.floor(h/3)*u/7.1);M.forEach(function(S){delete S.vis}),f.forEach(function(S,R){Math.round((R+o)%u)===0&&(S.vis=!0)})}}}},{"../../components/drawing":388,"../../lib":503,"../../lib/polygon":515,"../../registry":638,"./line_points":941,"./link_traces":943,"./subtypes":952,"@plotly/d3":58}],949:[function(c,ae,ie){"use strict";var b=c("./subtypes");ae.exports=function(P,E){var e=P.cd,p=P.xaxis,g=P.yaxis,a=[],t=e[0].trace,i,n,r,d,s=!b.hasMarkers(t)&&!b.hasText(t);if(s)return[];if(E===!1)for(i=0;i<e.length;i++)e[i].selected=0;else for(i=0;i<e.length;i++)n=e[i],r=p.c2p(n.x),d=g.c2p(n.y),n.i!==null&&E.contains([r,d],!1,i,P)?(a.push({pointNumber:n.i,x:p.c2d(n.x),y:g.c2d(n.y)}),n.selected=1):n.selected=0;return a}},{"./subtypes":952}],950:[function(c,ae,ie){"use strict";var b=["orientation","groupnorm","stackgaps"];ae.exports=function(P,E,e,p){var g=e._scatterStackOpts,a=p("stackgroup");if(a){var t=E.xaxis+E.yaxis,i=g[t];i||(i=g[t]={});var n=i[a],r=!1;n?n.traces.push(E):(n=i[a]={traceIndices:[],traces:[E]},r=!0);for(var d={orientation:E.x&&!E.y?"h":"v"},s=0;s<b.length;s++){var m=b[s],x=m+"Found";if(!n[x]){var M=P[m]!==void 0,v=m==="orientation";if((M||r)&&(n[m]=p(m,d[m]),v&&(n.fillDflt=n[m]==="h"?"tonextx":"tonexty"),M&&(n[x]=!0,!r&&(delete n.traces[0][m],v))))for(var _=0;_<n.traces.length-1;_++){var l=n.traces[_];l._input.fill!==l.fill&&(l.fill=n.fillDflt)}}}return n}}},{}],951:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/drawing"),P=c("../../registry");function E(a){var t=b.select(a).selectAll("g.trace.scatter");t.style("opacity",function(i){return i[0].trace.opacity}),t.selectAll("g.points").each(function(i){var n=b.select(this),r=i.trace||i[0].trace;e(n,r,a)}),t.selectAll("g.text").each(function(i){var n=b.select(this),r=i.trace||i[0].trace;p(n,r,a)}),t.selectAll("g.trace path.js-line").call(k.lineGroupStyle),t.selectAll("g.trace path.js-fill").call(k.fillGroupStyle,a),P.getComponentMethod("errorbars","style")(t)}function e(a,t,i){k.pointStyle(a.selectAll("path.point"),t,i)}function p(a,t,i){k.textPointStyle(a.selectAll("text"),t,i)}function g(a,t,i){var n=t[0].trace;n.selectedpoints?(k.selectedPointStyle(i.selectAll("path.point"),n),k.selectedTextStyle(i.selectAll("text"),n)):(e(i,n,a),p(i,n,a))}ae.exports={style:E,stylePoints:e,styleText:p,styleOnSelect:g}},{"../../components/drawing":388,"../../registry":638,"@plotly/d3":58}],952:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports={hasLines:function(k){return k.visible&&k.mode&&k.mode.indexOf("lines")!==-1},hasMarkers:function(k){return k.visible&&(k.mode&&k.mode.indexOf("markers")!==-1||k.type==="splom")},hasText:function(k){return k.visible&&k.mode&&k.mode.indexOf("text")!==-1},isBubble:function(k){return b.isPlainObject(k.marker)&&b.isArrayOrTypedArray(k.marker.size)}}},{"../../lib":503}],953:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(k,P,E,e,p){p=p||{},e("textposition"),b.coerceFont(e,"textfont",E.font),p.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":503}],954:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../registry");ae.exports=function(E,e,p,g){var a=g("x"),t=g("y"),i,n=k.getComponentMethod("calendars","handleTraceDefaults");if(n(E,e,["x","y"],p),a){var r=b.minRowLength(a);t?i=Math.min(r,b.minRowLength(t)):(i=r,g("y0"),g("dy"))}else{if(!t)return 0;i=b.minRowLength(t),g("x0"),g("dx")}return e._length=i,i}},{"../../lib":503,"../../registry":638}],955:[function(c,ae,ie){"use strict";var b=c("../scatter/attributes"),k=c("../../components/colorscale/attributes"),P=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,E=c("../../plots/template_attributes").hovertemplateAttrs,e=c("../../plots/template_attributes").texttemplateAttrs,p=c("../../plots/attributes"),g=c("../../constants/gl3d_dashes"),a=c("../../constants/gl3d_markers"),t=c("../../lib/extend").extendFlat,i=c("../../plot_api/edit_types").overrideAll,n=c("../../lib/sort_object_keys"),r=b.line,d=b.marker,s=d.line,m=t({width:r.width,dash:{valType:"enumerated",values:n(g),dflt:"solid"}},k("line"));function x(v){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var M=ae.exports=i({x:b.x,y:b.y,z:{valType:"data_array"},text:t({},b.text,{}),texttemplate:e({},{}),hovertext:t({},b.hovertext,{}),hovertemplate:E(),xhoverformat:P("x"),yhoverformat:P("y"),zhoverformat:P("z"),mode:t({},b.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:x("x"),y:x("y"),z:x("z")},connectgaps:b.connectgaps,line:m,marker:t({symbol:{valType:"enumerated",values:n(a),dflt:"circle",arrayOk:!0},size:t({},d.size,{dflt:8}),sizeref:d.sizeref,sizemin:d.sizemin,sizemode:d.sizemode,opacity:t({},d.opacity,{arrayOk:!1}),colorbar:d.colorbar,line:t({width:t({},s.width,{arrayOk:!1})},k("marker.line"))},k("marker")),textposition:t({},b.textposition,{dflt:"top center"}),textfont:{color:b.textfont.color,size:b.textfont.size,family:t({},b.textfont.family,{arrayOk:!1})},opacity:p.opacity,hoverinfo:t({},p.hoverinfo)},"calc","nested");M.x.editType=M.y.editType=M.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":373,"../../constants/gl3d_dashes":476,"../../constants/gl3d_markers":477,"../../lib/extend":493,"../../lib/sort_object_keys":526,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../scatter/attributes":927}],956:[function(c,ae,ie){"use strict";var b=c("../scatter/arrays_to_calcdata"),k=c("../scatter/colorscale_calc");ae.exports=function(E,e){var p=[{x:!1,y:!1,trace:e,t:{}}];return b(p,e),k(E,e),p}},{"../scatter/arrays_to_calcdata":926,"../scatter/colorscale_calc":930}],957:[function(c,ae,ie){"use strict";var b=c("../../registry");function k(e,p,g,a){if(!p||!p.visible)return null;for(var t=b.getComponentMethod("errorbars","makeComputeError")(p),i=new Array(e.length),n=0;n<e.length;n++){var r=t(+e[n],n);if(a.type==="log"){var d=a.c2l(e[n]),s=e[n]-r[0],m=e[n]+r[1];if(i[n]=[(a.c2l(s,!0)-d)*g,(a.c2l(m,!0)-d)*g],s>0){var x=a.c2l(s);a._lowerLogErrorBound||(a._lowerLogErrorBound=x),a._lowerErrorBound=Math.min(a._lowerLogErrorBound,x)}}else i[n]=[-r[0]*g,r[1]*g]}return i}function P(e){for(var p=0;p<e.length;p++)if(e[p])return e[p].length;return 0}function E(e,p,g){var a=[k(e.x,e.error_x,p[0],g.xaxis),k(e.y,e.error_y,p[1],g.yaxis),k(e.z,e.error_z,p[2],g.zaxis)],t=P(a);if(t===0)return null;for(var i=new Array(t),n=0;n<t;n++){for(var r=[[0,0,0],[0,0,0]],d=0;d<3;d++)if(a[d])for(var s=0;s<2;s++)r[s][d]=a[d][n][s];i[n]=r}return i}ae.exports=E},{"../../registry":638}],958:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_line3d,k=c("../../../stackgl_modules").gl_scatter3d,P=c("../../../stackgl_modules").gl_error3d,E=c("../../../stackgl_modules").gl_mesh3d,e=c("../../../stackgl_modules").delaunay_triangulate,p=c("../../lib"),g=c("../../lib/str2rgbarray"),a=c("../../lib/gl_format_color").formatColor,t=c("../scatter/make_bubble_size_func"),i=c("../../constants/gl3d_dashes"),n=c("../../constants/gl3d_markers"),r=c("../../plots/cartesian/axes"),d=c("../../components/fx/helpers").appendArrayPointValue,s=c("./calc_errors");function m(S,R){this.scene=S,this.uid=R,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var x=m.prototype;x.handlePick=function(S){if(S.object&&(S.object===this.linePlot||S.object===this.delaunayMesh||S.object===this.textMarkers||S.object===this.scatterPlot)){var R=S.index=S.data.index;return S.object.highlight&&S.object.highlight(null),this.scatterPlot&&(S.object=this.scatterPlot,this.scatterPlot.highlight(S.data)),S.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[R]||this.textLabels[R]===0)&&(S.textLabel=this.textLabels[R]):S.textLabel=this.textLabels),S.traceCoordinate=[this.data.x[R],this.data.y[R],this.data.z[R]],!0}};function M(S,R,z){var O=(z+1)%3,I=(z+2)%3,F=[],D=[],B;for(B=0;B<S.length;++B){var U=S[B];isNaN(U[O])||!isFinite(U[O])||isNaN(U[I])||!isFinite(U[I])||(F.push([U[O],U[I]]),D.push(B))}var X=e(F);for(B=0;B<X.length;++B)for(var oe=X[B],se=0;se<oe.length;++se)oe[se]=D[oe[se]];return{positions:S,cells:X,meshColor:R}}function v(S){for(var R=[0,0,0],z=[[0,0,0],[0,0,0],[0,0,0]],O=[1,1,1],I=0;I<3;I++){var F=S[I];F&&F.copy_zstyle!==!1&&S[2].visible!==!1&&(F=S[2]),!(!F||!F.visible)&&(R[I]=F.width/2,z[I]=g(F.color),O[I]=F.thickness)}return{capSize:R,color:z,lineWidth:O}}function _(S){return S==null?0:S.indexOf("left")>-1?-1:S.indexOf("right")>-1?1:0}function l(S){return S==null?0:S.indexOf("top")>-1?-1:S.indexOf("bottom")>-1?1:0}function y(S){var R=0,z=0,O=[R,z];if(Array.isArray(S))for(var I=0;I<S.length;I++)O[I]=[R,z],S[I]&&(O[I][0]=_(S[I]),O[I][1]=l(S[I]));else O[0]=_(S),O[1]=l(S);return O}function T(S,R){return R(S*4)}function w(S){return n[S]}function A(S,R,z,O,I){var F=null;if(p.isArrayOrTypedArray(S)){F=[];for(var D=0;D<R;D++)S[D]===void 0?F[D]=O:F[D]=z(S[D],I)}else F=z(S,p.identity);return F}function f(S,R){var z=[],O=S.fullSceneLayout,I=S.dataScale,F=O.xaxis,D=O.yaxis,B=O.zaxis,U=R.marker,X=R.line,oe=R.x||[],se=R.y||[],q=R.z||[],K=oe.length,G=R.xcalendar,Q=R.ycalendar,V=R.zcalendar,H,ee,J,W,re,j;for(re=0;re<K;re++)H=F.d2l(oe[re],0,G)*I[0],ee=D.d2l(se[re],0,Q)*I[1],J=B.d2l(q[re],0,V)*I[2],z[re]=[H,ee,J];if(Array.isArray(R.text))j=R.text;else if(R.text!==void 0)for(j=new Array(K),re=0;re<K;re++)j[re]=R.text;function Z(Qe,Ve){var Ue=O[Qe];return r.tickText(Ue,Ue.d2l(Ve),!0).text}var ne=R.texttemplate;if(ne){var le=S.fullLayout,ge=le._d3locale,pe=Array.isArray(ne),xe=pe?Math.min(ne.length,K):K,Ee=pe?function(Qe){return ne[Qe]}:function(){return ne};for(j=new Array(xe),re=0;re<xe;re++){var Te={x:oe[re],y:se[re],z:q[re]},de={xLabel:Z("xaxis",oe[re]),yLabel:Z("yaxis",se[re]),zLabel:Z("zaxis",q[re])},be={};d(be,R,re);var Le=R._meta||{};j[re]=p.texttemplateString(Ee(re),de,ge,be,Te,Le)}}if(W={position:z,mode:R.mode,text:j},"line"in R&&(W.lineColor=a(X,1,K),W.lineWidth=X.width,W.lineDashes=X.dash),"marker"in R){var De=t(R);W.scatterColor=a(U,1,K),W.scatterSize=A(U.size,K,T,20,De),W.scatterMarker=A(U.symbol,K,w,"\u25CF"),W.scatterLineWidth=U.line.width,W.scatterLineColor=a(U.line,1,K),W.scatterAngle=0}"textposition"in R&&(W.textOffset=y(R.textposition),W.textColor=a(R.textfont,1,K),W.textSize=A(R.textfont.size,K,p.identity,12),W.textFont=R.textfont.family,W.textAngle=0);var ye=["x","y","z"];for(W.project=[!1,!1,!1],W.projectScale=[1,1,1],W.projectOpacity=[1,1,1],re=0;re<3;++re){var ke=R.projection[ye[re]];(W.project[re]=ke.show)&&(W.projectOpacity[re]=ke.opacity,W.projectScale[re]=ke.scale)}W.errorBounds=s(R,I,O);var Oe=v([R.error_x,R.error_y,R.error_z]);return W.errorColor=Oe.color,W.errorLineWidth=Oe.lineWidth,W.errorCapSize=Oe.capSize,W.delaunayAxis=R.surfaceaxis,W.delaunayColor=g(R.surfacecolor),W}function u(S){if(p.isArrayOrTypedArray(S)){var R=S[0];return p.isArrayOrTypedArray(R)&&(S=R),"rgb("+S.slice(0,3).map(function(z){return Math.round(z*255)})+")"}return null}function h(S){return p.isArrayOrTypedArray(S)?S.length===4&&typeof S[0]=="number"?u(S):S.map(u):null}x.update=function(S){var R=this.scene.glplot.gl,z,O,I,F,D=i.solid;this.data=S;var B=f(this.scene,S);"mode"in B&&(this.mode=B.mode),"lineDashes"in B&&B.lineDashes in i&&(D=i[B.lineDashes]),this.color=h(B.scatterColor)||h(B.lineColor),this.dataPoints=B.position,z={gl:this.scene.glplot.gl,position:B.position,color:B.lineColor,lineWidth:B.lineWidth||1,dashes:D[0],dashScale:D[1],opacity:S.opacity,connectGaps:S.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(z):(this.linePlot=b(z),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var U=S.opacity;if(S.marker&&S.marker.opacity&&(U*=S.marker.opacity),O={gl:this.scene.glplot.gl,position:B.position,color:B.scatterColor,size:B.scatterSize,glyph:B.scatterMarker,opacity:U,orthographic:!0,lineWidth:B.scatterLineWidth,lineColor:B.scatterLineColor,project:B.project,projectScale:B.projectScale,projectOpacity:B.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(O):(this.scatterPlot=k(O),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),F={gl:this.scene.glplot.gl,position:B.position,glyph:B.text,color:B.textColor,size:B.textSize,angle:B.textAngle,alignment:B.textOffset,font:B.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:S.opacity},this.textLabels=S.hovertext||S.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(F):(this.textMarkers=k(F),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),I={gl:this.scene.glplot.gl,position:B.position,color:B.errorColor,error:B.errorBounds,lineWidth:B.errorLineWidth,capSize:B.errorCapSize,opacity:S.opacity},this.errorBars?B.errorBounds?this.errorBars.update(I):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):B.errorBounds&&(this.errorBars=P(I),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),B.delaunayAxis>=0){var X=M(B.position,B.delaunayColor,B.delaunayAxis);X.opacity=S.opacity,this.delaunayMesh?this.delaunayMesh.update(X):(X.gl=R,this.delaunayMesh=E(X),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},x.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())};function o(S,R){var z=new m(S,R.uid);return z.update(R),z}ae.exports=o},{"../../../stackgl_modules":1124,"../../components/fx/helpers":402,"../../constants/gl3d_dashes":476,"../../constants/gl3d_markers":477,"../../lib":503,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/cartesian/axes":554,"../scatter/make_bubble_size_func":944,"./calc_errors":957}],959:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("../scatter/subtypes"),E=c("../scatter/marker_defaults"),e=c("../scatter/line_defaults"),p=c("../scatter/text_defaults"),g=c("./attributes");ae.exports=function(i,n,r,d){function s(T,w){return k.coerce(i,n,g,T,w)}var m=a(i,n,s,d);if(!m){n.visible=!1;return}s("text"),s("hovertext"),s("hovertemplate"),s("xhoverformat"),s("yhoverformat"),s("zhoverformat"),s("mode"),P.hasLines(n)&&(s("connectgaps"),e(i,n,r,d,s)),P.hasMarkers(n)&&E(i,n,r,d,s,{noSelect:!0}),P.hasText(n)&&(s("texttemplate"),p(i,n,d,s,{noSelect:!0}));var x=(n.line||{}).color,M=(n.marker||{}).color;s("surfaceaxis")>=0&&s("surfacecolor",x||M);for(var v=["x","y","z"],_=0;_<3;++_){var l="projection."+v[_];s(l+".show")&&(s(l+".opacity"),s(l+".scale"))}var y=b.getComponentMethod("errorbars","supplyDefaults");y(i,n,x||M||r,{axis:"z"}),y(i,n,x||M||r,{axis:"y",inherit:"z"}),y(i,n,x||M||r,{axis:"x",inherit:"z"})};function a(t,i,n,r){var d=0,s=n("x"),m=n("y"),x=n("z"),M=b.getComponentMethod("calendars","handleTraceDefaults");return M(t,i,["x","y","z"],r),s&&m&&x&&(d=Math.min(s.length,m.length,x.length),i._length=i._xlength=i._ylength=i._zlength=d),d}},{"../../lib":503,"../../registry":638,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":955}],960:[function(c,ae,ie){"use strict";ae.exports={plot:c("./convert"),attributes:c("./attributes"),markerSymbols:c("../../constants/gl3d_markers"),supplyDefaults:c("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:c("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:c("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":477,"../../plots/gl3d":598,"./attributes":955,"./calc":956,"./convert":958,"./defaults":959}],961:[function(c,ae,ie){"use strict";var b=c("../scatter/attributes"),k=c("../../plots/attributes"),P=c("../../plots/template_attributes").hovertemplateAttrs,E=c("../../plots/template_attributes").texttemplateAttrs,e=c("../../components/colorscale/attributes"),p=c("../../lib/extend").extendFlat,g=b.marker,a=b.line,t=g.line;ae.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:p({},b.mode,{dflt:"markers"}),text:p({},b.text,{}),texttemplate:E({editType:"plot"},{keys:["a","b","text"]}),hovertext:p({},b.hovertext,{}),line:{color:a.color,width:a.width,dash:a.dash,shape:p({},a.shape,{values:["linear","spline"]}),smoothing:a.smoothing,editType:"calc"},connectgaps:b.connectgaps,fill:p({},b.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:b.fillcolor,marker:p({symbol:g.symbol,opacity:g.opacity,maxdisplayed:g.maxdisplayed,size:g.size,sizeref:g.sizeref,sizemin:g.sizemin,sizemode:g.sizemode,line:p({width:t.width,editType:"calc"},e("marker.line")),gradient:g.gradient,editType:"calc"},e("marker")),textfont:b.textfont,textposition:b.textposition,selected:b.selected,unselected:b.unselected,hoverinfo:p({},k.hoverinfo,{flags:["a","b","text","name"]}),hoveron:b.hoveron,hovertemplate:P()}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],962:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../scatter/colorscale_calc"),P=c("../scatter/arrays_to_calcdata"),E=c("../scatter/calc_selection"),e=c("../scatter/calc").calcMarkerSize,p=c("../carpet/lookup_carpetid");ae.exports=function(a,t){var i=t._carpetTrace=p(a,t);if(!(!i||!i.visible||i.visible==="legendonly")){var n;t.xaxis=i.xaxis,t.yaxis=i.yaxis;var r=t._length,d=new Array(r),s,m,x=!1;for(n=0;n<r;n++)if(s=t.a[n],m=t.b[n],b(s)&&b(m)){var M=i.ab2xy(+s,+m,!0),v=i.isVisible(+s,+m);v||(x=!0),d[n]={x:M[0],y:M[1],a:s,b:m,vis:v}}else d[n]={x:!1,y:!1};return t._needsCull=x,d[0].carpet=i,d[0].trace=t,e(t,r),k(a,t),P(d,t),E(d,t),d}}},{"../carpet/lookup_carpetid":708,"../scatter/arrays_to_calcdata":926,"../scatter/calc":928,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],963:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/constants"),P=c("../scatter/subtypes"),E=c("../scatter/marker_defaults"),e=c("../scatter/line_defaults"),p=c("../scatter/line_shape_defaults"),g=c("../scatter/text_defaults"),a=c("../scatter/fillcolor_defaults"),t=c("./attributes");ae.exports=function(n,r,d,s){function m(T,w){return b.coerce(n,r,t,T,w)}m("carpet"),r.xaxis="x",r.yaxis="y";var x=m("a"),M=m("b"),v=Math.min(x.length,M.length);if(!v){r.visible=!1;return}r._length=v,m("text"),m("texttemplate"),m("hovertext");var _=v<k.PTS_LINESONLY?"lines+markers":"lines";m("mode",_),P.hasLines(r)&&(e(n,r,d,s,m),p(n,r,m),m("connectgaps")),P.hasMarkers(r)&&E(n,r,d,s,m,{gradient:!0}),P.hasText(r)&&g(n,r,s,m);var l=[];(P.hasMarkers(r)||P.hasText(r))&&(m("marker.maxdisplayed"),l.push("points")),m("fill"),r.fill!=="none"&&(a(n,r,d,m),P.hasLines(r)||p(n,r,m)),(r.fill==="tonext"||r.fill==="toself")&&l.push("fills");var y=m("hoveron",l.join("+")||"points");y!=="fills"&&m("hovertemplate"),b.coerceSelectionMarkerOpacity(r,m)}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/line_shape_defaults":942,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":961}],964:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e,p){var g=e[p];return k.a=g.a,k.b=g.b,k.y=g.y,k}},{}],965:[function(c,ae,ie){"use strict";ae.exports=function(k,P){var E={},e=P._carpet,p=e.ab2ij([k.a,k.b]),g=Math.floor(p[0]),a=p[0]-g,t=Math.floor(p[1]),i=p[1]-t,n=e.evalxy([],g,t,a,i);return E.yLabel=n[1].toFixed(3),E}},{}],966:[function(c,ae,ie){"use strict";var b=c("../scatter/hover"),k=c("../../lib").fillText;ae.exports=function(E,e,p,g){var a=b(E,e,p,g);if(!a||a[0].index===!1)return;var t=a[0];if(t.index===void 0){var i=1-t.y0/E.ya._length,n=E.xa._length,r=n*i/2,d=n-r;return t.x0=Math.max(Math.min(t.x0,d),r),t.x1=Math.max(Math.min(t.x1,d),r),a}var s=t.cd[t.index];t.a=s.a,t.b=s.b,t.xLabelVal=void 0,t.yLabelVal=void 0;var m=t.trace,x=m._carpet,M=m._module.formatLabels(s,m);t.yLabel=M.yLabel,delete t.text;var v=[];function _(T,w){var A;T.labelprefix&&T.labelprefix.length>0?A=T.labelprefix.replace(/ = $/,""):A=T._hovertitle,v.push(A+": "+w.toFixed(3)+T.labelsuffix)}if(!m.hovertemplate){var l=s.hi||m.hoverinfo,y=l.split("+");y.indexOf("all")!==-1&&(y=["a","b","text"]),y.indexOf("a")!==-1&&_(x.aaxis,s.a),y.indexOf("b")!==-1&&_(x.baxis,s.b),v.push("y: "+t.yLabel),y.indexOf("text")!==-1&&k(s,m,v),t.extraText=v.join("<br>")}return a}},{"../../lib":503,"../scatter/hover":938}],967:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../scatter/marker_colorbar"),formatLabels:c("./format_labels"),calc:c("./calc"),plot:c("./plot"),style:c("../scatter/style").style,styleOnSelect:c("../scatter/style").styleOnSelect,hoverPoints:c("./hover"),selectPoints:c("../scatter/select"),eventData:c("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:c("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../scatter/marker_colorbar":945,"../scatter/select":949,"../scatter/style":951,"./attributes":961,"./calc":962,"./defaults":963,"./event_data":964,"./format_labels":965,"./hover":966,"./plot":968}],968:[function(c,ae,ie){"use strict";var b=c("../scatter/plot"),k=c("../../plots/cartesian/axes"),P=c("../../components/drawing");ae.exports=function(e,p,g,a){var t,i,n,r=g[0][0].carpet,d={xaxis:k.getFromId(e,r.xaxis||"x"),yaxis:k.getFromId(e,r.yaxis||"y"),plot:p.plot};for(b(e,d,g,a),t=0;t<g.length;t++)i=g[t][0].trace,n=a.selectAll("g.trace"+i.uid+" .js-line"),P.setClipUrl(n,g[t][0].carpet._clipPathId,e)}},{"../../components/drawing":388,"../../plots/cartesian/axes":554,"../scatter/plot":948}],969:[function(c,ae,ie){"use strict";var b=c("../../plots/template_attributes").hovertemplateAttrs,k=c("../../plots/template_attributes").texttemplateAttrs,P=c("../scatter/attributes"),E=c("../../plots/attributes"),e=c("../../components/colorscale/attributes"),p=c("../../components/drawing/attributes").dash,g=c("../../lib/extend").extendFlat,a=c("../../plot_api/edit_types").overrideAll,t=P.marker,i=P.line,n=t.line;ae.exports=a({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:g({},P.mode,{dflt:"markers"}),text:g({},P.text,{}),texttemplate:k({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:g({},P.hovertext,{}),textfont:P.textfont,textposition:P.textposition,line:{color:i.color,width:i.width,dash:p},connectgaps:P.connectgaps,marker:g({symbol:t.symbol,opacity:t.opacity,size:t.size,sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,colorbar:t.colorbar,line:g({width:n.width},e("marker.line")),gradient:t.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:P.fillcolor,selected:P.selected,unselected:P.unselected,hoverinfo:g({},E.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:b()},"calc","nested")},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],970:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../constants/numerical").BADNUM,P=c("../scatter/colorscale_calc"),E=c("../scatter/arrays_to_calcdata"),e=c("../scatter/calc_selection"),p=c("../../lib")._;function g(a){return a&&typeof a=="string"}ae.exports=function(t,i){var n=Array.isArray(i.locations),r=n?i.locations.length:i._length,d=new Array(r),s;i.geojson?s=function(l){return g(l)||b(l)}:s=g;for(var m=0;m<r;m++){var x=d[m]={};if(n){var M=i.locations[m];x.loc=s(M)?M:null}else{var v=i.lon[m],_=i.lat[m];b(v)&&b(_)?x.lonlat=[+v,+_]:x.lonlat=[k,k]}}return E(d,i),P(t,i),e(d,i),r&&(d[0].t={labels:{lat:p(t,"lat:")+" ",lon:p(t,"lon:")+" "}}),d}},{"../../constants/numerical":479,"../../lib":503,"../scatter/arrays_to_calcdata":926,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],971:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/subtypes"),P=c("../scatter/marker_defaults"),E=c("../scatter/line_defaults"),e=c("../scatter/text_defaults"),p=c("../scatter/fillcolor_defaults"),g=c("./attributes");ae.exports=function(t,i,n,r){function d(y,T){return b.coerce(t,i,g,y,T)}var s=d("locations"),m;if(s&&s.length){var x=d("geojson"),M;(typeof x=="string"&&x!==""||b.isPlainObject(x))&&(M="geojson-id");var v=d("locationmode",M);v==="geojson-id"&&d("featureidkey"),m=s.length}else{var _=d("lon")||[],l=d("lat")||[];m=Math.min(_.length,l.length)}if(!m){i.visible=!1;return}i._length=m,d("text"),d("hovertext"),d("hovertemplate"),d("mode"),k.hasLines(i)&&(E(t,i,n,r,d),d("connectgaps")),k.hasMarkers(i)&&P(t,i,n,r,d,{gradient:!0}),k.hasText(i)&&(d("texttemplate"),e(t,i,r,d)),d("fill"),i.fill!=="none"&&p(t,i,n,d),b.coerceSelectionMarkerOpacity(i,d)}},{"../../lib":503,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":969}],972:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e,p){k.lon=P.lon,k.lat=P.lat,k.location=P.loc?P.loc:null;var g=e[p];return g.fIn&&g.fIn.properties&&(k.properties=g.fIn.properties),k}},{}],973:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes");ae.exports=function(P,E,e){var p={},g=e[E.geo]._subplot,a=g.mockAxis,t=P.lonlat;return p.lonLabel=b.tickText(a,a.c2l(t[0]),!0).text,p.latLabel=b.tickText(a,a.c2l(t[1]),!0).text,p}},{"../../plots/cartesian/axes":554}],974:[function(c,ae,ie){"use strict";var b=c("../../components/fx"),k=c("../../constants/numerical").BADNUM,P=c("../scatter/get_trace_color"),E=c("../../lib").fillText,e=c("./attributes");ae.exports=function(a,t,i){var n=a.cd,r=n[0].trace,d=a.xa,s=a.ya,m=a.subplot,x=m.projection.isLonLatOverEdges,M=m.project;function v(f){var u=f.lonlat;if(u[0]===k||x(u))return 1/0;var h=M(u),o=M([t,i]),S=Math.abs(h[0]-o[0]),R=Math.abs(h[1]-o[1]),z=Math.max(3,f.mrc||0);return Math.max(Math.sqrt(S*S+R*R)-z,1-3/z)}if(b.getClosest(n,v,a),a.index!==!1){var _=n[a.index],l=_.lonlat,y=[d.c2p(l),s.c2p(l)],T=_.mrc||1;a.x0=y[0]-T,a.x1=y[0]+T,a.y0=y[1]-T,a.y1=y[1]+T,a.loc=_.loc,a.lon=l[0],a.lat=l[1];var w={};w[r.geo]={_subplot:m};var A=r._module.formatLabels(_,r,w);return a.lonLabel=A.lonLabel,a.latLabel=A.latLabel,a.color=P(r,_),a.extraText=p(r,_,a,n[0].t.labels),a.hovertemplate=r.hovertemplate,[a]}};function p(g,a,t,i){if(g.hovertemplate)return;var n=a.hi||g.hoverinfo,r=n==="all"?e.hoverinfo.flags:n.split("+"),d=r.indexOf("location")!==-1&&Array.isArray(g.locations),s=r.indexOf("lon")!==-1,m=r.indexOf("lat")!==-1,x=r.indexOf("text")!==-1,M=[];function v(_){return _+"\xB0"}return d?M.push(a.loc):s&&m?M.push("("+v(t.latLabel)+", "+v(t.lonLabel)+")"):s?M.push(i.lon+v(t.lonLabel)):m&&M.push(i.lat+v(t.latLabel)),x&&E(a,g,M),M.join("<br>")}},{"../../components/fx":406,"../../constants/numerical":479,"../../lib":503,"../scatter/get_trace_color":937,"./attributes":969}],975:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../scatter/marker_colorbar"),formatLabels:c("./format_labels"),calc:c("./calc"),calcGeoJSON:c("./plot").calcGeoJSON,plot:c("./plot").plot,style:c("./style"),styleOnSelect:c("../scatter/style").styleOnSelect,hoverPoints:c("./hover"),eventData:c("./event_data"),selectPoints:c("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:c("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":589,"../scatter/marker_colorbar":945,"../scatter/style":951,"./attributes":969,"./calc":970,"./defaults":971,"./event_data":972,"./format_labels":973,"./hover":974,"./plot":976,"./select":977,"./style":978}],976:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../lib/topojson_utils").getTopojsonFeatures,E=c("../../lib/geojson_utils"),e=c("../../lib/geo_location_utils"),p=c("../../plots/cartesian/autorange").findExtremes,g=c("../../constants/numerical").BADNUM,a=c("../scatter/calc").calcMarkerSize,t=c("../scatter/subtypes"),i=c("./style");function n(d,s,m){var x=s.layers.frontplot.select(".scatterlayer"),M=k.makeTraceGroups(x,m,"trace scattergeo");function v(_,l){_.lonlat[0]===g&&b.select(l).remove()}M.selectAll("*").remove(),M.each(function(_){var l=b.select(this),y=_[0].trace;if(t.hasLines(y)||y.fill!=="none"){var T=E.calcTraceToLineCoords(_),w=y.fill!=="none"?E.makePolygon(T):E.makeLine(T);l.selectAll("path.js-line").data([{geojson:w,trace:y}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}t.hasMarkers(y)&&l.selectAll("path.point").data(k.identity).enter().append("path").classed("point",!0).each(function(A){v(A,this)}),t.hasText(y)&&l.selectAll("g").data(k.identity).enter().append("g").append("text").each(function(A){v(A,this)}),i(d,_)})}function r(d,s){var m=d[0].trace,x=s[m.geo],M=x._subplot,v=m._length,_,l;if(Array.isArray(m.locations)){var y=m.locationmode,T=y==="geojson-id"?e.extractTraceFeature(d):P(m,M.topojson);for(_=0;_<v;_++){l=d[_];var w=y==="geojson-id"?l.fOut:e.locationToFeature(y,l.loc,T);l.lonlat=w?w.properties.ct:[g,g]}}var A={padded:!0},f,u;if(x.fitbounds==="geojson"&&m.locationmode==="geojson-id"){var h=e.computeBbox(e.getTraceGeojson(m));f=[h[0],h[2]],u=[h[1],h[3]]}else{for(f=new Array(v),u=new Array(v),_=0;_<v;_++)l=d[_],f[_]=l.lonlat[0],u[_]=l.lonlat[1];A.ppad=a(m,v)}m._extremes.lon=p(x.lonaxis._ax,f,A),m._extremes.lat=p(x.lataxis._ax,u,A)}ae.exports={calcGeoJSON:r,plot:n}},{"../../constants/numerical":479,"../../lib":503,"../../lib/geo_location_utils":496,"../../lib/geojson_utils":497,"../../lib/topojson_utils":532,"../../plots/cartesian/autorange":553,"../scatter/calc":928,"../scatter/subtypes":952,"./style":978,"@plotly/d3":58}],977:[function(c,ae,ie){"use strict";var b=c("../scatter/subtypes"),k=c("../../constants/numerical").BADNUM;ae.exports=function(E,e){var p=E.cd,g=E.xaxis,a=E.yaxis,t=[],i=p[0].trace,n,r,d,s,m,x=!b.hasMarkers(i)&&!b.hasText(i);if(x)return[];if(e===!1)for(m=0;m<p.length;m++)p[m].selected=0;else for(m=0;m<p.length;m++)n=p[m],r=n.lonlat,r[0]!==k&&(d=g.c2p(r),s=a.c2p(r),e.contains([d,s],null,m,E)?(t.push({pointNumber:m,lon:r[0],lat:r[1]}),n.selected=1):n.selected=0);return t}},{"../../constants/numerical":479,"../scatter/subtypes":952}],978:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/drawing"),P=c("../../components/color"),E=c("../scatter/style"),e=E.stylePoints,p=E.styleText;ae.exports=function(t,i){i&&g(t,i)};function g(a,t){var i=t[0].trace,n=t[0].node3;n.style("opacity",t[0].trace.opacity),e(n,i,a),p(n,i,a),n.selectAll("path.js-line").style("fill","none").each(function(r){var d=b.select(this),s=r.trace,m=s.line||{};d.call(P.stroke,m.color).call(k.dashLine,m.dash||"",m.width||0),s.fill!=="none"&&d.call(P.fill,s.fillcolor)})}},{"../../components/color":366,"../../components/drawing":388,"../scatter/style":951,"@plotly/d3":58}],979:[function(c,ae,ie){"use strict";var b=c("../../plots/attributes"),k=c("../scatter/attributes"),P=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,E=c("../../components/colorscale/attributes"),e=c("../../lib/sort_object_keys"),p=c("../../lib/extend").extendFlat,g=c("../../plot_api/edit_types").overrideAll,a=c("./constants").DASHES,t=k.line,i=k.marker,n=i.line,r=ae.exports=g({x:k.x,x0:k.x0,dx:k.dx,y:k.y,y0:k.y0,dy:k.dy,xperiod:k.xperiod,yperiod:k.yperiod,xperiod0:k.xperiod0,yperiod0:k.yperiod0,xperiodalignment:k.xperiodalignment,yperiodalignment:k.yperiodalignment,xhoverformat:P("x"),yhoverformat:P("y"),text:k.text,hovertext:k.hovertext,textposition:k.textposition,textfont:k.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:t.color,width:t.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(a),dflt:"solid"}},marker:p({},E("marker"),{symbol:i.symbol,size:i.size,sizeref:i.sizeref,sizemin:i.sizemin,sizemode:i.sizemode,opacity:i.opacity,colorbar:i.colorbar,line:p({},E("marker.line"),{width:n.width})}),connectgaps:k.connectgaps,fill:p({},k.fill,{dflt:"none"}),fillcolor:k.fillcolor,selected:{marker:k.selected.marker,textfont:k.selected.textfont},unselected:{marker:k.unselected.marker,textfont:k.unselected.textfont},opacity:b.opacity},"calc","nested");r.x.editType=r.y.editType=r.x0.editType=r.y0.editType="calc+clearAxisTypes",r.hovertemplate=k.hovertemplate,r.texttemplate=k.texttemplate},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../lib/sort_object_keys":526,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../scatter/attributes":927,"./constants":982}],980:[function(c,ae,ie){"use strict";var b=c("./hover");ae.exports={moduleType:"trace",name:"scattergl",basePlotModule:c("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:c("./attributes"),supplyDefaults:c("./defaults"),crossTraceDefaults:c("../scatter/cross_trace_defaults"),colorbar:c("../scatter/marker_colorbar"),formatLabels:c("./format_labels"),calc:c("./calc"),hoverPoints:b.hoverPoints,selectPoints:c("./select"),meta:{}}},{"../../plots/cartesian":568,"../scatter/cross_trace_defaults":933,"../scatter/marker_colorbar":945,"./attributes":979,"./calc":981,"./defaults":984,"./format_labels":986,"./hover":988,"./select":992}],981:[function(c,ae,ie){"use strict";var b=c("@plotly/point-cluster"),k=c("../../lib"),P=c("../../plots/cartesian/axis_ids"),E=c("../../plots/cartesian/autorange").findExtremes,e=c("../../plots/cartesian/align_period"),p=c("../scatter/calc"),g=p.calcMarkerSize,a=p.calcAxisExpansion,t=p.setFirstScatter,i=c("../scatter/colorscale_calc"),n=c("./convert"),r=c("./scene_update"),d=c("../../constants/numerical").BADNUM,s=c("./constants").TOO_MANY_POINTS;ae.exports=function(v,_){var l=v._fullLayout,y=P.getFromId(v,_.xaxis),T=P.getFromId(v,_.yaxis),w=l._plots[_.xaxis+_.yaxis],A=_._length,f=A>=s,u=A*2,h={},o,S=y.makeCalcdata(_,"x"),R=T.makeCalcdata(_,"y"),z=e(_,y,"x",S),O=e(_,T,"y",R),I=z.vals,F=O.vals;_._x=I,_._y=F,_.xperiodalignment&&(_._origX=S,_._xStarts=z.starts,_._xEnds=z.ends),_.yperiodalignment&&(_._origY=R,_._yStarts=O.starts,_._yEnds=O.ends);var D=new Array(u),B=new Array(A);for(o=0;o<A;o++)D[o*2]=I[o]===d?NaN:I[o],D[o*2+1]=F[o]===d?NaN:F[o],B[o]=o;if(y.type==="log")for(o=0;o<u;o+=2)D[o]=y.c2l(D[o]);if(T.type==="log")for(o=1;o<u;o+=2)D[o]=T.c2l(D[o]);f&&y.type!=="log"&&T.type!=="log"?h.tree=b(D):h.ids=B,i(v,_);var U=x(v,w,_,D,I,F),X=r(v,w);t(l,_);var oe;return f?U.marker&&(oe=U.marker.sizeAvg||Math.max(U.marker.size,3)):oe=g(_,A),a(v,_,y,T,I,F,oe),U.errorX&&m(_,y,U.errorX),U.errorY&&m(_,T,U.errorY),U.fill&&!X.fill2d&&(X.fill2d=!0),U.marker&&!X.scatter2d&&(X.scatter2d=!0),U.line&&!X.line2d&&(X.line2d=!0),(U.errorX||U.errorY)&&!X.error2d&&(X.error2d=!0),U.text&&!X.glText&&(X.glText=!0),U.marker&&(U.marker.snap=A),X.lineOptions.push(U.line),X.errorXOptions.push(U.errorX),X.errorYOptions.push(U.errorY),X.fillOptions.push(U.fill),X.markerOptions.push(U.marker),X.markerSelectedOptions.push(U.markerSel),X.markerUnselectedOptions.push(U.markerUnsel),X.textOptions.push(U.text),X.textSelectedOptions.push(U.textSel),X.textUnselectedOptions.push(U.textUnsel),X.selectBatch.push([]),X.unselectBatch.push([]),h._scene=X,h.index=X.count,h.x=I,h.y=F,h.positions=D,X.count++,[{x:!1,y:!1,t:h,trace:_}]};function m(M,v,_){var l=M._extremes[v._id],y=E(v,_._bnds,{padded:!0});l.min=l.min.concat(y.min),l.max=l.max.concat(y.max)}function x(M,v,_,l,y,T){var w=n.style(M,_);if(w.marker&&(w.marker.positions=l),w.line&&l.length>1&&k.extendFlat(w.line,n.linePositions(M,_,l)),w.errorX||w.errorY){var A=n.errorBarPositions(M,_,l,y,T);w.errorX&&k.extendFlat(w.errorX,A.x),w.errorY&&k.extendFlat(w.errorY,A.y)}return w.text&&(k.extendFlat(w.text,{positions:l},n.textPosition(M,_,w.text,w.marker)),k.extendFlat(w.textSel,{positions:l},n.textPosition(M,_,w.text,w.markerSel)),k.extendFlat(w.textUnsel,{positions:l},n.textPosition(M,_,w.text,w.markerUnsel))),w}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/autorange":553,"../../plots/cartesian/axis_ids":558,"../scatter/calc":928,"../scatter/colorscale_calc":930,"./constants":982,"./convert":983,"./scene_update":991,"@plotly/point-cluster":59}],982:[function(c,ae,ie){"use strict";var b=20;ae.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:b,SYMBOL_STROKE:b/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],983:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("svg-path-sdf"),P=c("color-normalize"),E=c("../../registry"),e=c("../../lib"),p=c("../../components/drawing"),g=c("../../plots/cartesian/axis_ids"),a=c("../../lib/gl_format_color").formatColor,t=c("../scatter/subtypes"),i=c("../scatter/make_bubble_size_func"),n=c("./helpers"),r=c("./constants"),d=c("../../constants/interactions").DESELECTDIM,s={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},m=c("../../components/fx/helpers").appendArrayPointValue;function x(z,O){var I,F={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},D=z._context.plotGlPixelRatio;if(O.visible!==!0)return F;if(t.hasText(O)&&(F.text=M(z,O),F.textSel=l(z,O,O.selected),F.textUnsel=l(z,O,O.unselected)),t.hasMarkers(O)&&(F.marker=v(O),F.markerSel=_(O,O.selected),F.markerUnsel=_(O,O.unselected),!O.unselected&&e.isArrayOrTypedArray(O.marker.opacity))){var B=O.marker.opacity;for(F.markerUnsel.opacity=new Array(B.length),I=0;I<B.length;I++)F.markerUnsel.opacity[I]=d*B[I]}if(t.hasLines(O)){F.line={overlay:!0,thickness:O.line.width*D,color:O.line.color,opacity:O.opacity};var U=(r.DASHES[O.line.dash]||[1]).slice();for(I=0;I<U.length;++I)U[I]*=O.line.width*D;F.line.dashes=U}return O.error_x&&O.error_x.visible&&(F.errorX=y(O,O.error_x,D)),O.error_y&&O.error_y.visible&&(F.errorY=y(O,O.error_y,D)),!!O.fill&&O.fill!=="none"&&(F.fill={closed:!0,fill:O.fillcolor,thickness:0}),F}function M(z,O){var I=z._fullLayout,F=O._length,D=O.textfont,B=O.textposition,U=Array.isArray(B)?B:[B],X=D.color,oe=D.size,se=D.family,q={},K,G=z._context.plotGlPixelRatio,Q=O.texttemplate;if(Q){q.text=[];var V=I._d3locale,H=Array.isArray(Q),ee=H?Math.min(Q.length,F):F,J=H?function(ge){return Q[ge]}:function(){return Q};for(K=0;K<ee;K++){var W={i:K},re=O._module.formatLabels(W,O,I),j={};m(j,O,K);var Z=O._meta||{};q.text.push(e.texttemplateString(J(K),re,V,j,W,Z))}}else Array.isArray(O.text)&&O.text.length<F?q.text=O.text.slice():q.text=O.text;if(Array.isArray(q.text))for(K=q.text.length;K<F;K++)q.text[K]="";for(q.opacity=O.opacity,q.font={},q.align=[],q.baseline=[],K=0;K<U.length;K++){var ne=U[K].split(/\s+/);switch(ne[1]){case"left":q.align.push("right");break;case"right":q.align.push("left");break;default:q.align.push(ne[1])}switch(ne[0]){case"top":q.baseline.push("bottom");break;case"bottom":q.baseline.push("top");break;default:q.baseline.push(ne[0])}}if(Array.isArray(X))for(q.color=new Array(F),K=0;K<F;K++)q.color[K]=X[K];else q.color=X;if(e.isArrayOrTypedArray(oe)||Array.isArray(se))for(q.font=new Array(F),K=0;K<F;K++){var le=q.font[K]={};le.size=(e.isTypedArray(oe)?oe[K]:Array.isArray(oe)?b(oe[K])?oe[K]:0:oe)*G,le.family=Array.isArray(se)?se[K]:se}else q.font={size:oe*G,family:se};return q}function v(z){var O=z._length,I=z.marker,F={},D,B=e.isArrayOrTypedArray(I.symbol),U=e.isArrayOrTypedArray(I.color),X=e.isArrayOrTypedArray(I.line.color),oe=e.isArrayOrTypedArray(I.opacity),se=e.isArrayOrTypedArray(I.size),q=e.isArrayOrTypedArray(I.line.width),K;if(B||(K=n.isOpenSymbol(I.symbol)),B||U||X||oe){F.colors=new Array(O),F.borderColors=new Array(O);var G=a(I,I.opacity,O),Q=a(I.line,I.opacity,O);if(!Array.isArray(Q[0])){var V=Q;for(Q=Array(O),D=0;D<O;D++)Q[D]=V}if(!Array.isArray(G[0])){var H=G;for(G=Array(O),D=0;D<O;D++)G[D]=H}for(F.colors=G,F.borderColors=Q,D=0;D<O;D++){if(B){var ee=I.symbol[D];K=n.isOpenSymbol(ee)}K&&(Q[D]=G[D].slice(),G[D]=G[D].slice(),G[D][3]=0)}F.opacity=z.opacity}else K?(F.color=P(I.color,"uint8"),F.color[3]=0,F.borderColor=P(I.color,"uint8")):(F.color=P(I.color,"uint8"),F.borderColor=P(I.line.color,"uint8")),F.opacity=z.opacity*I.opacity;if(B)for(F.markers=new Array(O),D=0;D<O;D++)F.markers[D]=h(I.symbol[D]);else F.marker=h(I.symbol);var J=1,W=i(z,J),re;if(se||q){var j=F.sizes=new Array(O),Z=F.borderSizes=new Array(O),ne=0,le;if(se){for(D=0;D<O;D++)j[D]=W(I.size[D]),ne+=j[D];le=ne/O}else for(re=W(I.size),D=0;D<O;D++)j[D]=re;if(q)for(D=0;D<O;D++)Z[D]=I.line.width[D];else for(re=I.line.width,D=0;D<O;D++)Z[D]=re;F.sizeAvg=le}else F.size=W(I&&I.size||10),F.borderSizes=W(I.line.width);return F}function _(z,O){var I=z.marker,F={};return O&&(O.marker&&O.marker.symbol?F=v(e.extendFlat({},I,O.marker)):O.marker&&(O.marker.size&&(F.size=O.marker.size),O.marker.color&&(F.colors=O.marker.color),O.marker.opacity!==void 0&&(F.opacity=O.marker.opacity))),F}function l(z,O,I){var F={};if(!I)return F;if(I.textfont){var D={opacity:1,text:O.text,texttemplate:O.texttemplate,textposition:O.textposition,textfont:e.extendFlat({},O.textfont)};I.textfont&&e.extendFlat(D.textfont,I.textfont),F=M(z,D)}return F}function y(z,O,I){var F={capSize:O.width*2*I,lineWidth:O.thickness*I,color:O.color};return O.copy_ystyle&&(F=z.error_y),F}var T=r.SYMBOL_SDF_SIZE,w=r.SYMBOL_SIZE,A=r.SYMBOL_STROKE,f={},u=p.symbolFuncs[0](w*.05);function h(z){if(z==="circle")return null;var O,I,F=p.symbolNumber(z),D=p.symbolFuncs[F%100],B=!!p.symbolNoDot[F%100],U=!!p.symbolNoFill[F%100],X=n.isDotSymbol(z);return f[z]?f[z]:(X&&!B?O=D(w*1.1)+u:O=D(w),I=k(O,{w:T,h:T,viewBox:[-w,-w,w,w],stroke:U?A:-A}),f[z]=I,I||null)}function o(z,O,I){var F=I.length,D=F/2,B,U;if(t.hasLines(O)&&D)if(O.line.shape==="hv"){for(B=[],U=0;U<D-1;U++)isNaN(I[U*2])||isNaN(I[U*2+1])?B.push(NaN,NaN,NaN,NaN):(B.push(I[U*2],I[U*2+1]),!isNaN(I[U*2+2])&&!isNaN(I[U*2+3])?B.push(I[U*2+2],I[U*2+1]):B.push(NaN,NaN));B.push(I[F-2],I[F-1])}else if(O.line.shape==="hvh"){for(B=[],U=0;U<D-1;U++)if(isNaN(I[U*2])||isNaN(I[U*2+1])||isNaN(I[U*2+2])||isNaN(I[U*2+3]))!isNaN(I[U*2])&&!isNaN(I[U*2+1])?B.push(I[U*2],I[U*2+1]):B.push(NaN,NaN),B.push(NaN,NaN);else{var X=(I[U*2]+I[U*2+2])/2;B.push(I[U*2],I[U*2+1],X,I[U*2+1],X,I[U*2+3])}B.push(I[F-2],I[F-1])}else if(O.line.shape==="vhv"){for(B=[],U=0;U<D-1;U++)if(isNaN(I[U*2])||isNaN(I[U*2+1])||isNaN(I[U*2+2])||isNaN(I[U*2+3]))!isNaN(I[U*2])&&!isNaN(I[U*2+1])?B.push(I[U*2],I[U*2+1]):B.push(NaN,NaN),B.push(NaN,NaN);else{var oe=(I[U*2+1]+I[U*2+3])/2;B.push(I[U*2],I[U*2+1],I[U*2],oe,I[U*2+2],oe)}B.push(I[F-2],I[F-1])}else if(O.line.shape==="vh"){for(B=[],U=0;U<D-1;U++)isNaN(I[U*2])||isNaN(I[U*2+1])?B.push(NaN,NaN,NaN,NaN):(B.push(I[U*2],I[U*2+1]),!isNaN(I[U*2+2])&&!isNaN(I[U*2+3])?B.push(I[U*2],I[U*2+3]):B.push(NaN,NaN));B.push(I[F-2],I[F-1])}else B=I;var se=!1;for(U=0;U<B.length;U++)if(isNaN(B[U])){se=!0;break}var q=se||B.length>r.TOO_MANY_POINTS||t.hasMarkers(O)?"rect":"round";if(se&&O.connectgaps){var K=B[0],G=B[1];for(U=0;U<B.length;U+=2)isNaN(B[U])||isNaN(B[U+1])?(B[U]=K,B[U+1]=G):(K=B[U],G=B[U+1])}return{join:q,positions:B}}function S(z,O,I,F,D){var B=E.getComponentMethod("errorbars","makeComputeError"),U=g.getFromId(z,O.xaxis),X=g.getFromId(z,O.yaxis),oe=I.length/2,se={};function q(K,G){var Q=G._id.charAt(0),V=O["error_"+Q];if(V&&V.visible&&(G.type==="linear"||G.type==="log")){for(var H=B(V),ee={x:0,y:1}[Q],J={x:[0,1,2,3],y:[2,3,0,1]}[Q],W=new Float64Array(4*oe),re=1/0,j=-1/0,Z=0,ne=0;Z<oe;Z++,ne+=4){var le=K[Z];if(b(le)){var ge=I[Z*2+ee],pe=H(le,Z),xe=pe[0],Ee=pe[1];if(b(xe)&&b(Ee)){var Te=le-xe,de=le+Ee;W[ne+J[0]]=ge-G.c2l(Te),W[ne+J[1]]=G.c2l(de)-ge,W[ne+J[2]]=0,W[ne+J[3]]=0,re=Math.min(re,le-xe),j=Math.max(j,le+Ee)}}}se[Q]={positions:I,errors:W,_bnds:[re,j]}}}return q(F,U),q(D,X),se}function R(z,O,I,F){var D=O._length,B={},U;if(t.hasMarkers(O)){var X=I.font,oe=I.align,se=I.baseline;for(B.offset=new Array(D),U=0;U<D;U++){var q=F.sizes?F.sizes[U]:F.size,K=Array.isArray(X)?X[U].size:X.size,G=Array.isArray(oe)?oe.length>1?oe[U]:oe[0]:oe,Q=Array.isArray(se)?se.length>1?se[U]:se[0]:se,V=s[G],H=s[Q],ee=q?q/.8+1:0,J=-H*ee-H*.5;B.offset[U]=[V*ee/K,J/K]}}return B}ae.exports={style:x,markerStyle:v,markerSelection:_,linePositions:o,errorBarPositions:S,textPosition:R}},{"../../components/drawing":388,"../../components/fx/helpers":402,"../../constants/interactions":478,"../../lib":503,"../../lib/gl_format_color":499,"../../plots/cartesian/axis_ids":558,"../../registry":638,"../scatter/make_bubble_size_func":944,"../scatter/subtypes":952,"./constants":982,"./helpers":987,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":310}],984:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../registry"),P=c("./helpers"),E=c("./attributes"),e=c("../scatter/constants"),p=c("../scatter/subtypes"),g=c("../scatter/xy_defaults"),a=c("../scatter/period_defaults"),t=c("../scatter/marker_defaults"),i=c("../scatter/line_defaults"),n=c("../scatter/fillcolor_defaults"),r=c("../scatter/text_defaults");ae.exports=function(s,m,x,M){function v(u,h){return b.coerce(s,m,E,u,h)}var _=s.marker?P.isOpenSymbol(s.marker.symbol):!1,l=p.isBubble(s),y=g(s,m,M,v);if(!y){m.visible=!1;return}a(s,m,M,v),v("xhoverformat"),v("yhoverformat");var T=y<e.PTS_LINESONLY?"lines+markers":"lines";v("text"),v("hovertext"),v("hovertemplate"),v("mode",T),p.hasLines(m)&&(v("connectgaps"),i(s,m,x,M,v),v("line.shape")),p.hasMarkers(m)&&(t(s,m,x,M,v),v("marker.line.width",_||l?1:0)),p.hasText(m)&&(v("texttemplate"),r(s,m,M,v));var w=(m.line||{}).color,A=(m.marker||{}).color;v("fill"),m.fill!=="none"&&n(s,m,x,v);var f=k.getComponentMethod("errorbars","supplyDefaults");f(s,m,w||A||x,{axis:"y"}),f(s,m,w||A||x,{axis:"x",inherit:"y"}),b.coerceSelectionMarkerOpacity(m,v)}},{"../../lib":503,"../../registry":638,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/period_defaults":947,"../scatter/subtypes":952,"../scatter/text_defaults":953,"../scatter/xy_defaults":954,"./attributes":979,"./helpers":987}],985:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color"),P=c("../../constants/interactions").DESELECTDIM;function E(e){var p=e[0],g=p.trace,a=p.t,t=a._scene,i=a.index,n=t.selectBatch[i],r=t.unselectBatch[i],d=t.textOptions[i],s=t.textSelectedOptions[i]||{},m=t.textUnselectedOptions[i]||{},x=b.extendFlat({},d),M,v;if(n.length||r.length){var _=s.color,l=m.color,y=d.color,T=Array.isArray(y);for(x.color=new Array(g._length),M=0;M<n.length;M++)v=n[M],x.color[v]=_||(T?y[v]:y);for(M=0;M<r.length;M++){v=r[M];var w=T?y[v]:y;x.color[v]=l||(_?w:k.addOpacity(w,P))}}t.glText[i].update(x)}ae.exports={styleTextSelection:E}},{"../../components/color":366,"../../constants/interactions":478,"../../lib":503}],986:[function(c,ae,ie){"use strict";var b=c("../scatter/format_labels");ae.exports=function(P,E,e){var p=P.i;return"x"in P||(P.x=E._x[p]),"y"in P||(P.y=E._y[p]),b(P,E,e)}},{"../scatter/format_labels":936}],987:[function(c,ae,ie){"use strict";var b=c("./constants");ie.isOpenSymbol=function(k){return typeof k=="string"?b.OPEN_RE.test(k):k%200>100},ie.isDotSymbol=function(k){return typeof k=="string"?b.DOT_RE.test(k):k>200}},{"./constants":982}],988:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("../scatter/get_trace_color");function E(p,g,a,t){var i=p.cd,n=i[0].t,r=i[0].trace,d=p.xa,s=p.ya,m=n.x,x=n.y,M=d.c2p(g),v=s.c2p(a),_=p.distance,l;if(n.tree){var y=d.p2c(M-_),T=d.p2c(M+_),w=s.p2c(v-_),A=s.p2c(v+_);t==="x"?l=n.tree.range(Math.min(y,T),Math.min(s._rl[0],s._rl[1]),Math.max(y,T),Math.max(s._rl[0],s._rl[1])):l=n.tree.range(Math.min(y,T),Math.min(w,A),Math.max(y,T),Math.max(w,A))}else l=n.ids;var f,u,h,o,S,R,z,O,I,F=_;if(t==="x"){var D=!!r.xperiodalignment,B=!!r.yperiodalignment;for(S=0;S<l.length;S++){if(f=l[S],h=m[f],R=Math.abs(d.c2p(h)-M),D){var U=d.c2p(r._xStarts[f]),X=d.c2p(r._xEnds[f]);R=M>=Math.min(U,X)&&M<=Math.max(U,X)?0:1/0}if(R<F){if(F=R,o=x[f],z=s.c2p(o)-v,B){var oe=s.c2p(r._yStarts[f]),se=s.c2p(r._yEnds[f]);z=v>=Math.min(oe,se)&&v<=Math.max(oe,se)?0:1/0}I=Math.sqrt(R*R+z*z),u=l[S]}}}else for(S=l.length-1;S>-1;S--)f=l[S],h=m[f],o=x[f],R=d.c2p(h)-M,z=s.c2p(o)-v,O=Math.sqrt(R*R+z*z),O<F&&(F=I=O,u=f);return p.index=u,p.distance=F,p.dxy=I,u===void 0?[p]:[e(p,m,x,r)]}function e(p,g,a,t){var i=p.xa,n=p.ya,r=p.distance,d=p.dxy,s=p.index,m={pointNumber:s,x:g[s],y:a[s]};m.tx=Array.isArray(t.text)?t.text[s]:t.text,m.htx=Array.isArray(t.hovertext)?t.hovertext[s]:t.hovertext,m.data=Array.isArray(t.customdata)?t.customdata[s]:t.customdata,m.tp=Array.isArray(t.textposition)?t.textposition[s]:t.textposition;var x=t.textfont;x&&(m.ts=k.isArrayOrTypedArray(x.size)?x.size[s]:x.size,m.tc=Array.isArray(x.color)?x.color[s]:x.color,m.tf=Array.isArray(x.family)?x.family[s]:x.family);var M=t.marker;M&&(m.ms=k.isArrayOrTypedArray(M.size)?M.size[s]:M.size,m.mo=k.isArrayOrTypedArray(M.opacity)?M.opacity[s]:M.opacity,m.mx=k.isArrayOrTypedArray(M.symbol)?M.symbol[s]:M.symbol,m.mc=k.isArrayOrTypedArray(M.color)?M.color[s]:M.color);var v=M&&M.line;v&&(m.mlc=Array.isArray(v.color)?v.color[s]:v.color,m.mlw=k.isArrayOrTypedArray(v.width)?v.width[s]:v.width);var _=M&&M.gradient;_&&_.type!=="none"&&(m.mgt=Array.isArray(_.type)?_.type[s]:_.type,m.mgc=Array.isArray(_.color)?_.color[s]:_.color);var l=i.c2p(m.x,!0),y=n.c2p(m.y,!0),T=m.mrc||1,w=t.hoverlabel;w&&(m.hbg=Array.isArray(w.bgcolor)?w.bgcolor[s]:w.bgcolor,m.hbc=Array.isArray(w.bordercolor)?w.bordercolor[s]:w.bordercolor,m.hts=k.isArrayOrTypedArray(w.font.size)?w.font.size[s]:w.font.size,m.htc=Array.isArray(w.font.color)?w.font.color[s]:w.font.color,m.htf=Array.isArray(w.font.family)?w.font.family[s]:w.font.family,m.hnl=k.isArrayOrTypedArray(w.namelength)?w.namelength[s]:w.namelength);var A=t.hoverinfo;A&&(m.hi=Array.isArray(A)?A[s]:A);var f=t.hovertemplate;f&&(m.ht=Array.isArray(f)?f[s]:f);var u={};u[p.index]=m;var h=t._origX,o=t._origY,S=k.extendFlat({},p,{color:P(t,m),x0:l-T,x1:l+T,xLabelVal:h?h[s]:m.x,y0:y-T,y1:y+T,yLabelVal:o?o[s]:m.y,cd:u,distance:r,spikeDistance:d,hovertemplate:m.ht});return m.htx?S.text=m.htx:m.tx?S.text=m.tx:t.text&&(S.text=t.text),k.fillText(m,t,S),b.getComponentMethod("errorbars","hoverInfo")(m,t,S),S}ae.exports={hoverPoints:E,calcHover:e}},{"../../lib":503,"../../registry":638,"../scatter/get_trace_color":937}],989:[function(c,ae,ie){arguments[4][896][0].apply(ie,arguments)},{"./base_index":980,"./plot":990,dup:896}],990:[function(c,ae,d){"use strict";var b=c("regl-scatter2d"),k=c("regl-line2d"),P=c("regl-error2d"),E=c("gl-text"),e=c("../../lib"),p=c("../../components/dragelement/helpers").selectMode,g=c("../../lib/prepare_regl"),a=c("../scatter/subtypes"),t=c("../scatter/link_traces"),i=c("./edit_style").styleTextSelection,n={};function r(s,m,x,M){var v=s._size,_=s.width*M,l=s.height*M,y=v.l*M,T=v.b*M,w=v.r*M,A=v.t*M,f=v.w*M,u=v.h*M;return[y+m.domain[0]*f,T+x.domain[0]*u,_-w-(1-m.domain[1])*f,l-A-(1-x.domain[1])*u]}var d=ae.exports=function(m,x,M){if(!!M.length){var v=m._fullLayout,_=x._scene,l=x.xaxis,y=x.yaxis,T,w;if(!!_){var A=g(m,["ANGLE_instanced_arrays","OES_element_index_uint"],n);if(!A){_.init();return}var f=_.count,u=v._glcanvas.data()[0].regl;if(t(m,x,M),_.dirty){if(_.error2d===!0&&(_.error2d=P(u)),_.line2d===!0&&(_.line2d=k(u)),_.scatter2d===!0&&(_.scatter2d=b(u)),_.fill2d===!0&&(_.fill2d=k(u)),_.glText===!0)for(_.glText=new Array(f),T=0;T<f;T++)_.glText[T]=new E(u);if(_.glText){if(f>_.glText.length){var h=f-_.glText.length;for(T=0;T<h;T++)_.glText.push(new E(u))}else if(f<_.glText.length){var o=_.glText.length-f,S=_.glText.splice(f,o);S.forEach(function(W){W.destroy()})}for(T=0;T<f;T++)_.glText[T].update(_.textOptions[T])}if(_.line2d&&(_.line2d.update(_.lineOptions),_.lineOptions=_.lineOptions.map(function(W){if(W&&W.positions){for(var re=W.positions,j=0;j<re.length&&(isNaN(re[j])||isNaN(re[j+1]));)j+=2;for(var Z=re.length-2;Z>j&&(isNaN(re[Z])||isNaN(re[Z+1]));)Z-=2;W.positions=re.slice(j,Z+2)}return W}),_.line2d.update(_.lineOptions)),_.error2d){var R=(_.errorXOptions||[]).concat(_.errorYOptions||[]);_.error2d.update(R)}_.scatter2d&&_.scatter2d.update(_.markerOptions),_.fillOrder=e.repeat(null,f),_.fill2d&&(_.fillOptions=_.fillOptions.map(function(W,re){var j=M[re];if(!(!W||!j||!j[0]||!j[0].trace)){var Z=j[0],ne=Z.trace,le=Z.t,ge=_.lineOptions[re],pe,xe,Ee=[];ne._ownfill&&Ee.push(re),ne._nexttrace&&Ee.push(re+1),Ee.length&&(_.fillOrder[re]=Ee);var Te=[],de=ge&&ge.positions||le.positions,be,Le;if(ne.fill==="tozeroy"){for(be=0;be<de.length&&isNaN(de[be+1]);)be+=2;for(Le=de.length-2;Le>be&&isNaN(de[Le+1]);)Le-=2;de[be+1]!==0&&(Te=[de[be],0]),Te=Te.concat(de.slice(be,Le+2)),de[Le+1]!==0&&(Te=Te.concat([de[Le],0]))}else if(ne.fill==="tozerox"){for(be=0;be<de.length&&isNaN(de[be]);)be+=2;for(Le=de.length-2;Le>be&&isNaN(de[Le]);)Le-=2;de[be]!==0&&(Te=[0,de[be+1]]),Te=Te.concat(de.slice(be,Le+2)),de[Le]!==0&&(Te=Te.concat([0,de[Le+1]]))}else if(ne.fill==="toself"||ne.fill==="tonext"){for(Te=[],pe=0,W.splitNull=!0,xe=0;xe<de.length;xe+=2)(isNaN(de[xe])||isNaN(de[xe+1]))&&(Te=Te.concat(de.slice(pe,xe)),Te.push(de[pe],de[pe+1]),Te.push(null,null),pe=xe+2);Te=Te.concat(de.slice(pe)),pe&&Te.push(de[pe],de[pe+1])}else{var De=ne._nexttrace;if(De){var ye=_.lineOptions[re+1];if(ye){var ke=ye.positions;if(ne.fill==="tonexty"){for(Te=de.slice(),re=Math.floor(ke.length/2);re--;){var Oe=ke[re*2],Qe=ke[re*2+1];isNaN(Oe)||isNaN(Qe)||Te.push(Oe,Qe)}W.fill=De.fillcolor}}}}if(ne._prevtrace&&ne._prevtrace.fill==="tonext"){var Ve=_.lineOptions[re-1].positions,Ue=Te.length/2;pe=Ue;var Ie=[pe];for(xe=0;xe<Ve.length;xe+=2)(isNaN(Ve[xe])||isNaN(Ve[xe+1]))&&(Ie.push(xe/2+Ue+1),pe=xe+2);Te=Te.concat(Ve),W.hole=Ie}return W.fillmode=ne.fill,W.opacity=ne.opacity,W.positions=Te,W}}),_.fill2d.update(_.fillOptions))}var z=v.dragmode,O=p(z),I=v.clickmode.indexOf("select")>-1;for(T=0;T<f;T++){var F=M[T][0],D=F.trace,B=F.t,U=B.index,X=D._length,oe=B.x,se=B.y;if(D.selectedpoints||O||I){if(O||(O=!0),D.selectedpoints){var q=_.selectBatch[U]=e.selIndices2selPoints(D),K={};for(w=0;w<q.length;w++)K[q[w]]=1;var G=[];for(w=0;w<X;w++)K[w]||G.push(w);_.unselectBatch[U]=G}var Q=B.xpx=new Array(X),V=B.ypx=new Array(X);for(w=0;w<X;w++)Q[w]=l.c2p(oe[w]),V[w]=y.c2p(se[w])}else B.xpx=B.ypx=null}if(O){if(_.select2d||(_.select2d=b(v._glcanvas.data()[1].regl)),_.scatter2d){var H=new Array(f);for(T=0;T<f;T++)H[T]=_.selectBatch[T].length||_.unselectBatch[T].length?_.markerUnselectedOptions[T]:{};_.scatter2d.update(H)}_.select2d&&(_.select2d.update(_.markerOptions),_.select2d.update(_.markerSelectedOptions)),_.glText&&M.forEach(function(W){var re=((W||[])[0]||{}).trace||{};a.hasText(re)&&i(W)})}else _.scatter2d&&_.scatter2d.update(_.markerOptions);var ee={viewport:r(v,l,y,m._context.plotGlPixelRatio),range:[(l._rl||l.range)[0],(y._rl||y.range)[0],(l._rl||l.range)[1],(y._rl||y.range)[1]]},J=e.repeat(ee,_.count);_.fill2d&&_.fill2d.update(J),_.line2d&&_.line2d.update(J),_.error2d&&_.error2d.update(J.concat(J)),_.scatter2d&&_.scatter2d.update(J),_.select2d&&_.select2d.update(J),_.glText&&_.glText.forEach(function(W){W.update(ee)})}}};d.reglPrecompiled=n},{"../../components/dragelement/helpers":384,"../../lib":503,"../../lib/prepare_regl":516,"../scatter/link_traces":943,"../scatter/subtypes":952,"./edit_style":985,"gl-text":225,"regl-error2d":279,"regl-line2d":280,"regl-scatter2d":281}],991:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E){var e=E._scene,p={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},g={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return E._scene||(e=E._scene={},e.init=function(){b.extendFlat(e,g,p)},e.init(),e.update=function(t){var i=b.repeat(t,e.count);if(e.fill2d&&e.fill2d.update(i),e.scatter2d&&e.scatter2d.update(i),e.line2d&&e.line2d.update(i),e.error2d&&e.error2d.update(i.concat(i)),e.select2d&&e.select2d.update(i),e.glText)for(var n=0;n<e.count;n++)e.glText[n].update(t)},e.draw=function(){for(var t=e.count,i=e.fill2d,n=e.error2d,r=e.line2d,d=e.scatter2d,s=e.glText,m=e.select2d,x=e.selectBatch,M=e.unselectBatch,v=0;v<t;v++){if(i&&e.fillOrder[v]&&i.draw(e.fillOrder[v]),r&&e.lineOptions[v]&&r.draw(v),n&&(e.errorXOptions[v]&&n.draw(v),e.errorYOptions[v]&&n.draw(v+t)),d&&e.markerOptions[v])if(M[v].length){var _=b.repeat([],e.count);_[v]=M[v],d.draw(_)}else x[v].length||d.draw(v);s[v]&&e.textOptions[v]&&s[v].render()}m&&m.draw(x),e.dirty=!1},e.destroy=function(){e.fill2d&&e.fill2d.destroy&&e.fill2d.destroy(),e.scatter2d&&e.scatter2d.destroy&&e.scatter2d.destroy(),e.error2d&&e.error2d.destroy&&e.error2d.destroy(),e.line2d&&e.line2d.destroy&&e.line2d.destroy(),e.select2d&&e.select2d.destroy&&e.select2d.destroy(),e.glText&&e.glText.forEach(function(t){t.destroy&&t.destroy()}),e.lineOptions=null,e.fillOptions=null,e.markerOptions=null,e.markerSelectedOptions=null,e.markerUnselectedOptions=null,e.errorXOptions=null,e.errorYOptions=null,e.textOptions=null,e.textSelectedOptions=null,e.textUnselectedOptions=null,e.selectBatch=null,e.unselectBatch=null,E._scene=null}),e.dirty||b.extendFlat(e,p),e}},{"../../lib":503}],992:[function(c,ae,ie){"use strict";var b=c("../scatter/subtypes"),k=c("./edit_style").styleTextSelection;ae.exports=function(E,e){var p=E.cd,g=E.xaxis,a=E.yaxis,t=[],i=p[0].trace,n=p[0].t,r=i._length,d=n.x,s=n.y,m=n._scene,x=n.index;if(!m)return t;var M=b.hasText(i),v=b.hasMarkers(i),_=!v&&!M;if(i.visible!==!0||_)return t;var l=[],y=[];if(e!==!1&&!e.degenerate)for(var T=0;T<r;T++)e.contains([n.xpx[T],n.ypx[T]],!1,T,E)?(l.push(T),t.push({pointNumber:T,x:g.c2d(d[T]),y:a.c2d(s[T])})):y.push(T);if(v){var w=m.scatter2d;if(!l.length&&!y.length){var A=new Array(m.count);A[x]=m.markerOptions[x],w.update.apply(w,A)}else if(!m.selectBatch[x].length&&!m.unselectBatch[x].length){var f=new Array(m.count);f[x]=m.markerUnselectedOptions[x],w.update.apply(w,f)}}return m.selectBatch[x]=l,m.unselectBatch[x]=y,M&&k(p),t}},{"../scatter/subtypes":952,"./edit_style":985}],993:[function(c,ae,ie){"use strict";var b=c("../../plots/template_attributes").hovertemplateAttrs,k=c("../../plots/template_attributes").texttemplateAttrs,P=c("../scattergeo/attributes"),E=c("../scatter/attributes"),e=c("../../plots/mapbox/layout_attributes"),p=c("../../plots/attributes"),g=c("../../components/colorscale/attributes"),a=c("../../lib/extend").extendFlat,t=c("../../plot_api/edit_types").overrideAll,i=P.line,n=P.marker;ae.exports=t({lon:P.lon,lat:P.lat,mode:a({},E.mode,{dflt:"markers"}),text:a({},E.text,{}),texttemplate:k({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:a({},E.hovertext,{}),line:{color:i.color,width:i.width},connectgaps:E.connectgaps,marker:a({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:n.opacity,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode},g("marker")),fill:P.fill,fillcolor:E.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:E.selected.marker},unselected:{marker:E.unselected.marker},hoverinfo:a({},p.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:b()},"calc","nested")},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/mapbox/layout_attributes":615,"../../plots/template_attributes":633,"../scatter/attributes":927,"../scattergeo/attributes":969}],994:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../lib"),P=c("../../constants/numerical").BADNUM,E=c("../../lib/geojson_utils"),e=c("../../components/colorscale"),p=c("../../components/drawing"),g=c("../scatter/make_bubble_size_func"),a=c("../scatter/subtypes"),t=c("../../plots/mapbox/convert_text_opts"),i=c("../../components/fx/helpers").appendArrayPointValue,n=c("../../lib/svg_text_utils").NEWLINES,r=c("../../lib/svg_text_utils").BR_TAG_ALL;ae.exports=function(l,y){var T=y[0].trace,w=T.visible===!0&&T._length!==0,A=T.fill!=="none",f=a.hasLines(T),u=a.hasMarkers(T),h=a.hasText(T),o=u&&T.marker.symbol==="circle",S=u&&T.marker.symbol!=="circle",R=d(),z=d(),O=d(),I=d(),F={fill:R,line:z,circle:O,symbol:I};if(!w)return F;var D;if((A||f)&&(D=E.calcTraceToLineCoords(y)),A&&(R.geojson=E.makePolygon(D),R.layout.visibility="visible",k.extendFlat(R.paint,{"fill-color":T.fillcolor})),f&&(z.geojson=E.makeLine(D),z.layout.visibility="visible",k.extendFlat(z.paint,{"line-width":T.line.width,"line-color":T.line.color,"line-opacity":T.opacity})),o){var B=s(y);O.geojson=B.geojson,O.layout.visibility="visible",k.extendFlat(O.paint,{"circle-color":B.mcc,"circle-radius":B.mrc,"circle-opacity":B.mo})}if((S||h)&&(I.geojson=m(y,l),k.extendFlat(I.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),S&&(k.extendFlat(I.layout,{"icon-size":T.marker.size/10}),"angle"in T.marker&&T.marker.angle!=="auto"&&k.extendFlat(I.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),I.layout["icon-allow-overlap"]=T.marker.allowoverlap,k.extendFlat(I.paint,{"icon-opacity":T.opacity*T.marker.opacity,"icon-color":T.marker.color})),h)){var U=(T.marker||{}).size,X=t(T.textposition,U);k.extendFlat(I.layout,{"text-size":T.textfont.size,"text-anchor":X.anchor,"text-offset":X.offset}),k.extendFlat(I.paint,{"text-color":T.textfont.color,"text-opacity":T.opacity})}return F};function d(){return{geojson:E.makeBlank(),layout:{visibility:"none"},paint:{}}}function s(_){var l=_[0].trace,y=l.marker,T=l.selectedpoints,w=k.isArrayOrTypedArray(y.color),A=k.isArrayOrTypedArray(y.size),f=k.isArrayOrTypedArray(y.opacity),u;function h(X){return l.opacity*X}function o(X){return X/2}var S;w&&(e.hasColorscale(l,"marker")?S=e.makeColorScaleFuncFromTrace(y):S=k.identity);var R;A&&(R=g(l));var z;f&&(z=function(X){var oe=b(X)?+k.constrain(X,0,1):0;return h(oe)});var O=[];for(u=0;u<_.length;u++){var I=_[u],F=I.lonlat;if(!v(F)){var D={};S&&(D.mcc=I.mcc=S(I.mc)),R&&(D.mrc=I.mrc=R(I.ms)),z&&(D.mo=z(I.mo)),T&&(D.selected=I.selected||0),O.push({type:"Feature",geometry:{type:"Point",coordinates:F},properties:D})}}var B;if(T)for(B=p.makeSelectedPointStyleFns(l),u=0;u<O.length;u++){var U=O[u].properties;B.selectedOpacityFn&&(U.mo=h(B.selectedOpacityFn(U))),B.selectedColorFn&&(U.mcc=B.selectedColorFn(U)),B.selectedSizeFn&&(U.mrc=B.selectedSizeFn(U))}return{geojson:{type:"FeatureCollection",features:O},mcc:w||B&&B.selectedColorFn?{type:"identity",property:"mcc"}:y.color,mrc:A||B&&B.selectedSizeFn?{type:"identity",property:"mrc"}:o(y.size),mo:f||B&&B.selectedOpacityFn?{type:"identity",property:"mo"}:h(y.opacity)}}function m(_,l){for(var y=l._fullLayout,T=_[0].trace,w=T.marker||{},A=w.symbol,f=w.angle,u=A!=="circle"?x(A):M,h=f!=="auto"?x(f,!0):M,o=a.hasText(T)?x(T.text):M,S=[],R=0;R<_.length;R++){var z=_[R];if(!v(z.lonlat)){var O=T.texttemplate,I;if(O){var F=Array.isArray(O)?O[R]||"":O,D=T._module.formatLabels(z,T,y),B={};i(B,T,z.i);var U=T._meta||{};I=k.texttemplateString(F,D,y._d3locale,B,z,U)}else I=o(R);I&&(I=I.replace(n,"").replace(r,`
`)),S.push({type:"Feature",geometry:{type:"Point",coordinates:z.lonlat},properties:{symbol:u(R),angle:h(R),text:I}})}}return{type:"FeatureCollection",features:S}}function x(_,l){return k.isArrayOrTypedArray(_)?l?function(y){return b(_[y])?+_[y]:0}:function(y){return _[y]}:_?function(){return _}:M}function M(){return""}function v(_){return _[0]===P}},{"../../components/colorscale":378,"../../components/drawing":388,"../../components/fx/helpers":402,"../../constants/numerical":479,"../../lib":503,"../../lib/geojson_utils":497,"../../lib/svg_text_utils":529,"../../plots/mapbox/convert_text_opts":612,"../scatter/make_bubble_size_func":944,"../scatter/subtypes":952,"fast-isnumeric":190}],995:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/subtypes"),P=c("../scatter/marker_defaults"),E=c("../scatter/line_defaults"),e=c("../scatter/text_defaults"),p=c("../scatter/fillcolor_defaults"),g=c("./attributes");ae.exports=function(i,n,r,d){function s(M,v){return b.coerce(i,n,g,M,v)}var m=a(i,n,s);if(!m){n.visible=!1;return}if(s("text"),s("texttemplate"),s("hovertext"),s("hovertemplate"),s("mode"),s("below"),k.hasLines(n)&&(E(i,n,r,d,s,{noDash:!0}),s("connectgaps")),k.hasMarkers(n)){P(i,n,r,d,s,{noLine:!0}),s("marker.allowoverlap"),s("marker.angle");var x=n.marker;x.symbol!=="circle"&&(b.isArrayOrTypedArray(x.size)&&(x.size=x.size[0]),b.isArrayOrTypedArray(x.color)&&(x.color=x.color[0]))}k.hasText(n)&&e(i,n,d,s,{noSelect:!0}),s("fill"),n.fill!=="none"&&p(i,n,r,s),b.coerceSelectionMarkerOpacity(n,s)};function a(t,i,n){var r=n("lon")||[],d=n("lat")||[],s=Math.min(r.length,d.length);return i._length=s,s}},{"../../lib":503,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":993}],996:[function(c,ae,ie){"use strict";ae.exports=function(k,P){return k.lon=P.lon,k.lat=P.lat,k}},{}],997:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes");ae.exports=function(P,E,e){var p={},g=e[E.subplot]._subplot,a=g.mockAxis,t=P.lonlat;return p.lonLabel=b.tickText(a,a.c2l(t[0]),!0).text,p.latLabel=b.tickText(a,a.c2l(t[1]),!0).text,p}},{"../../plots/cartesian/axes":554}],998:[function(c,ae,ie){"use strict";var b=c("../../components/fx"),k=c("../../lib"),P=c("../scatter/get_trace_color"),E=k.fillText,e=c("../../constants/numerical").BADNUM;function p(a,t,i){var n=a.cd,r=n[0].trace,d=a.xa,s=a.ya,m=a.subplot,x=t>=0?Math.floor((t+180)/360):Math.ceil((t-180)/360),M=x*360,v=t-M;function _(o){var S=o.lonlat;if(S[0]===e)return 1/0;var R=k.modHalf(S[0],360),z=S[1],O=m.project([R,z]),I=O.x-d.c2p([v,z]),F=O.y-s.c2p([R,i]),D=Math.max(3,o.mrc||0);return Math.max(Math.sqrt(I*I+F*F)-D,1-3/D)}if(b.getClosest(n,_,a),a.index!==!1){var l=n[a.index],y=l.lonlat,T=[k.modHalf(y[0],360)+M,y[1]],w=d.c2p(T),A=s.c2p(T),f=l.mrc||1;a.x0=w-f,a.x1=w+f,a.y0=A-f,a.y1=A+f;var u={};u[r.subplot]={_subplot:m};var h=r._module.formatLabels(l,r,u);return a.lonLabel=h.lonLabel,a.latLabel=h.latLabel,a.color=P(r,l),a.extraText=g(r,l,n[0].t.labels),a.hovertemplate=r.hovertemplate,[a]}}function g(a,t,i){if(a.hovertemplate)return;var n=t.hi||a.hoverinfo,r=n.split("+"),d=r.indexOf("all")!==-1,s=r.indexOf("lon")!==-1,m=r.indexOf("lat")!==-1,x=t.lonlat,M=[];function v(_){return _+"\xB0"}return d||s&&m?M.push("("+v(x[1])+", "+v(x[0])+")"):s?M.push(i.lon+v(x[0])):m&&M.push(i.lat+v(x[1])),(d||r.indexOf("text")!==-1)&&E(t,a,M),M.join("<br>")}ae.exports={hoverPoints:p,getExtraText:g}},{"../../components/fx":406,"../../constants/numerical":479,"../../lib":503,"../scatter/get_trace_color":937}],999:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../scatter/marker_colorbar"),formatLabels:c("./format_labels"),calc:c("../scattergeo/calc"),plot:c("./plot"),hoverPoints:c("./hover").hoverPoints,eventData:c("./event_data"),selectPoints:c("./select"),styleOnSelect:function(b,k){if(k){var P=k[0].trace;P._glTrace.update(k)}},moduleType:"trace",name:"scattermapbox",basePlotModule:c("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":613,"../scatter/marker_colorbar":945,"../scattergeo/calc":970,"./attributes":993,"./defaults":995,"./event_data":996,"./format_labels":997,"./hover":998,"./plot":1e3,"./select":1001}],1e3:[function(c,ae,ie){"use strict";var b=c("./convert"),k=c("../../plots/mapbox/constants").traceLayerPrefix,P=["fill","line","circle","symbol"];function E(p,g){this.type="scattermapbox",this.subplot=p,this.uid=g,this.sourceIds={fill:"source-"+g+"-fill",line:"source-"+g+"-line",circle:"source-"+g+"-circle",symbol:"source-"+g+"-symbol"},this.layerIds={fill:k+g+"-fill",line:k+g+"-line",circle:k+g+"-circle",symbol:k+g+"-symbol"},this.below=null}var e=E.prototype;e.addSource=function(p,g){this.subplot.map.addSource(this.sourceIds[p],{type:"geojson",data:g.geojson})},e.setSourceData=function(p,g){this.subplot.map.getSource(this.sourceIds[p]).setData(g.geojson)},e.addLayer=function(p,g,a){this.subplot.addLayer({type:p,id:this.layerIds[p],source:this.sourceIds[p],layout:g.layout,paint:g.paint},a)},e.update=function(g){var a=this.subplot,t=a.map,i=b(a.gd,g),n=a.belowLookup["trace-"+this.uid],r,d,s;if(n!==this.below){for(r=P.length-1;r>=0;r--)d=P[r],t.removeLayer(this.layerIds[d]);for(r=0;r<P.length;r++)d=P[r],s=i[d],this.addLayer(d,s,n);this.below=n}for(r=0;r<P.length;r++)d=P[r],s=i[d],a.setOptions(this.layerIds[d],"setLayoutProperty",s.layout),s.layout.visibility==="visible"&&(this.setSourceData(d,s),a.setOptions(this.layerIds[d],"setPaintProperty",s.paint));g[0].trace._glTrace=this},e.dispose=function(){for(var g=this.subplot.map,a=P.length-1;a>=0;a--){var t=P[a];g.removeLayer(this.layerIds[t]),g.removeSource(this.sourceIds[t])}},ae.exports=function(g,a){for(var t=a[0].trace,i=new E(g,t.uid),n=b(g.gd,a),r=i.below=g.belowLookup["trace-"+t.uid],d=0;d<P.length;d++){var s=P[d],m=n[s];i.addSource(s,m),i.addLayer(s,m,r)}return a[0].trace._glTrace=i,i}},{"../../plots/mapbox/constants":611,"./convert":994}],1001:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/subtypes"),P=c("../../constants/numerical").BADNUM;ae.exports=function(e,p){var g=e.cd,a=e.xaxis,t=e.yaxis,i=[],n=g[0].trace,r;if(!k.hasMarkers(n))return[];if(p===!1)for(r=0;r<g.length;r++)g[r].selected=0;else for(r=0;r<g.length;r++){var d=g[r],s=d.lonlat;if(s[0]!==P){var m=[b.modHalf(s[0],360),s[1]],x=[a.c2p(m),t.c2p(m)];p.contains(x,null,r,e)?(i.push({pointNumber:r,lon:s[0],lat:s[1]}),d.selected=1):d.selected=0}}return i}},{"../../constants/numerical":479,"../../lib":503,"../scatter/subtypes":952}],1002:[function(c,ae,ie){"use strict";var b=c("../../plots/template_attributes").hovertemplateAttrs,k=c("../../plots/template_attributes").texttemplateAttrs,P=c("../../lib/extend").extendFlat,E=c("../scatter/attributes"),e=c("../../plots/attributes"),p=E.line;ae.exports={mode:E.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:E.text,texttemplate:k({editType:"plot"},{keys:["r","theta","text"]}),hovertext:E.hovertext,line:{color:p.color,width:p.width,dash:p.dash,shape:P({},p.shape,{values:["linear","spline"]}),smoothing:p.smoothing,editType:"calc"},connectgaps:E.connectgaps,marker:E.marker,cliponaxis:P({},E.cliponaxis,{dflt:!1}),textposition:E.textposition,textfont:E.textfont,fill:P({},E.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:E.fillcolor,hoverinfo:P({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:E.hoveron,hovertemplate:b(),selected:E.selected,unselected:E.unselected}},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],1003:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../constants/numerical").BADNUM,P=c("../../plots/cartesian/axes"),E=c("../scatter/colorscale_calc"),e=c("../scatter/arrays_to_calcdata"),p=c("../scatter/calc_selection"),g=c("../scatter/calc").calcMarkerSize;ae.exports=function(t,i){for(var n=t._fullLayout,r=i.subplot,d=n[r].radialaxis,s=n[r].angularaxis,m=d.makeCalcdata(i,"r"),x=s.makeCalcdata(i,"theta"),M=i._length,v=new Array(M),_=0;_<M;_++){var l=m[_],y=x[_],T=v[_]={};b(l)&&b(y)?(T.r=l,T.theta=y):T.r=k}var w=g(i,M);return i._extremes.x=P.findExtremes(d,m,{ppad:w}),E(t,i),e(v,i),p(v,i),v}},{"../../constants/numerical":479,"../../plots/cartesian/axes":554,"../scatter/arrays_to_calcdata":926,"../scatter/calc":928,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],1004:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/subtypes"),P=c("../scatter/marker_defaults"),E=c("../scatter/line_defaults"),e=c("../scatter/line_shape_defaults"),p=c("../scatter/text_defaults"),g=c("../scatter/fillcolor_defaults"),a=c("../scatter/constants").PTS_LINESONLY,t=c("./attributes");function i(r,d,s,m){function x(_,l){return b.coerce(r,d,t,_,l)}var M=n(r,d,m,x);if(!M){d.visible=!1;return}x("thetaunit"),x("mode",M<a?"lines+markers":"lines"),x("text"),x("hovertext"),d.hoveron!=="fills"&&x("hovertemplate"),k.hasLines(d)&&(E(r,d,s,m,x),e(r,d,x),x("connectgaps")),k.hasMarkers(d)&&P(r,d,s,m,x,{gradient:!0}),k.hasText(d)&&(x("texttemplate"),p(r,d,m,x));var v=[];(k.hasMarkers(d)||k.hasText(d))&&(x("cliponaxis"),x("marker.maxdisplayed"),v.push("points")),x("fill"),d.fill!=="none"&&(g(r,d,s,x),k.hasLines(d)||e(r,d,x)),(d.fill==="tonext"||d.fill==="toself")&&v.push("fills"),x("hoveron",v.join("+")||"points"),b.coerceSelectionMarkerOpacity(d,x)}function n(r,d,s,m){var x=m("r"),M=m("theta"),v;if(x)M?v=Math.min(x.length,M.length):(v=x.length,m("theta0"),m("dtheta"));else{if(!M)return 0;v=d.theta.length,m("r0"),m("dr")}return d._length=v,v}ae.exports={handleRThetaDefaults:n,supplyDefaults:i}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/line_shape_defaults":942,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":1002}],1005:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes");ae.exports=function(E,e,p){var g={},a=p[e.subplot]._subplot,t,i;a?(t=a.radialAxis,i=a.angularAxis):(a=p[e.subplot],t=a.radialaxis,i=a.angularaxis);var n=t.c2l(E.r);g.rLabel=k.tickText(t,n,!0).text;var r=i.thetaunit==="degrees"?b.rad2deg(E.theta):E.theta;return g.thetaLabel=k.tickText(i,r,!0).text,g}},{"../../lib":503,"../../plots/cartesian/axes":554}],1006:[function(c,ae,ie){"use strict";var b=c("../scatter/hover");function k(E,e,p,g){var a=b(E,e,p,g);if(!(!a||a[0].index===!1)){var t=a[0];if(t.index===void 0)return a;var i=E.subplot,n=t.cd[t.index],r=t.trace;if(!!i.isPtInside(n))return t.xLabelVal=void 0,t.yLabelVal=void 0,P(n,r,i,t),t.hovertemplate=r.hovertemplate,a}}function P(E,e,p,g){var a=p.radialAxis,t=p.angularAxis;a._hovertitle="r",t._hovertitle="\u03B8";var i={};i[e.subplot]={_subplot:p};var n=e._module.formatLabels(E,e,i);g.rLabel=n.rLabel,g.thetaLabel=n.thetaLabel;var r=E.hi||e.hoverinfo,d=[];function s(x,M){d.push(x._hovertitle+": "+M)}if(!e.hovertemplate){var m=r.split("+");m.indexOf("all")!==-1&&(m=["r","theta","text"]),m.indexOf("r")!==-1&&s(a,g.rLabel),m.indexOf("theta")!==-1&&s(t,g.thetaLabel),m.indexOf("text")!==-1&&g.text&&(d.push(g.text),delete g.text),g.extraText=d.join("<br>")}}ae.exports={hoverPoints:k,makeHoverPointText:P}},{"../scatter/hover":938}],1007:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:c("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:c("./attributes"),supplyDefaults:c("./defaults").supplyDefaults,colorbar:c("../scatter/marker_colorbar"),formatLabels:c("./format_labels"),calc:c("./calc"),plot:c("./plot"),style:c("../scatter/style").style,styleOnSelect:c("../scatter/style").styleOnSelect,hoverPoints:c("./hover").hoverPoints,selectPoints:c("../scatter/select"),meta:{}}},{"../../plots/polar":622,"../scatter/marker_colorbar":945,"../scatter/select":949,"../scatter/style":951,"./attributes":1002,"./calc":1003,"./defaults":1004,"./format_labels":1005,"./hover":1006,"./plot":1008}],1008:[function(c,ae,ie){"use strict";var b=c("../scatter/plot"),k=c("../../constants/numerical").BADNUM;ae.exports=function(E,e,p){for(var g=e.layers.frontplot.select("g.scatterlayer"),a={xaxis:e.xaxis,yaxis:e.yaxis,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},t=e.radialAxis,i=e.angularAxis,n=0;n<p.length;n++)for(var r=p[n],d=0;d<r.length;d++){var s=r[d],m=s.r;if(m===k)s.x=s.y=k;else{var x=t.c2g(m),M=i.c2g(s.theta);s.x=x*Math.cos(M),s.y=x*Math.sin(M)}}b(E,a,p,g)}},{"../../constants/numerical":479,"../scatter/plot":948}],1009:[function(c,ae,ie){"use strict";var b=c("../scatterpolar/attributes"),k=c("../scattergl/attributes"),P=c("../../plots/template_attributes").texttemplateAttrs;ae.exports={mode:b.mode,r:b.r,theta:b.theta,r0:b.r0,dr:b.dr,theta0:b.theta0,dtheta:b.dtheta,thetaunit:b.thetaunit,text:b.text,texttemplate:P({editType:"plot"},{keys:["r","theta","text"]}),hovertext:b.hovertext,hovertemplate:b.hovertemplate,line:k.line,connectgaps:k.connectgaps,marker:k.marker,fill:k.fill,fillcolor:k.fillcolor,textposition:k.textposition,textfont:k.textfont,hoverinfo:b.hoverinfo,selected:b.selected,unselected:b.unselected}},{"../../plots/template_attributes":633,"../scattergl/attributes":979,"../scatterpolar/attributes":1002}],1010:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:c("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../scatter/marker_colorbar"),formatLabels:c("./format_labels"),calc:c("./calc"),hoverPoints:c("./hover").hoverPoints,selectPoints:c("../scattergl/select"),meta:{}}},{"../../plots/polar":622,"../scatter/marker_colorbar":945,"../scattergl/select":992,"./attributes":1009,"./calc":1011,"./defaults":1012,"./format_labels":1013,"./hover":1014}],1011:[function(c,ae,ie){"use strict";var b=c("../scatter/colorscale_calc"),k=c("../scatter/calc").calcMarkerSize,P=c("../scattergl/convert"),E=c("../../plots/cartesian/axes"),e=c("../scattergl/constants").TOO_MANY_POINTS;ae.exports=function(g,a){var t=g._fullLayout,i=a.subplot,n=t[i].radialaxis,r=t[i].angularaxis,d=a._r=n.makeCalcdata(a,"r"),s=a._theta=r.makeCalcdata(a,"theta"),m=a._length,x={};m<d.length&&(d=d.slice(0,m)),m<s.length&&(s=s.slice(0,m)),x.r=d,x.theta=s,b(g,a);var M=x.opts=P.style(g,a),v;return m<e?v=k(a,m):M.marker&&(v=2*(M.marker.sizeAvg||Math.max(M.marker.size,3))),a._extremes.x=E.findExtremes(n,d,{ppad:v}),[{x:!1,y:!1,t:x,trace:a}]}},{"../../plots/cartesian/axes":554,"../scatter/calc":928,"../scatter/colorscale_calc":930,"../scattergl/constants":982,"../scattergl/convert":983}],1012:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/subtypes"),P=c("../scatterpolar/defaults").handleRThetaDefaults,E=c("../scatter/marker_defaults"),e=c("../scatter/line_defaults"),p=c("../scatter/text_defaults"),g=c("../scatter/fillcolor_defaults"),a=c("../scatter/constants").PTS_LINESONLY,t=c("./attributes");ae.exports=function(n,r,d,s){function m(M,v){return b.coerce(n,r,t,M,v)}var x=P(n,r,s,m);if(!x){r.visible=!1;return}m("thetaunit"),m("mode",x<a?"lines+markers":"lines"),m("text"),m("hovertext"),r.hoveron!=="fills"&&m("hovertemplate"),k.hasLines(r)&&(e(n,r,d,s,m),m("connectgaps")),k.hasMarkers(r)&&E(n,r,d,s,m),k.hasText(r)&&(m("texttemplate"),p(n,r,s,m)),m("fill"),r.fill!=="none"&&g(n,r,d,m),b.coerceSelectionMarkerOpacity(r,m)}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"../scatterpolar/defaults":1004,"./attributes":1009}],1013:[function(c,ae,ie){"use strict";var b=c("../scatterpolar/format_labels");ae.exports=function(P,E,e){var p=P.i;return"r"in P||(P.r=E._r[p]),"theta"in P||(P.theta=E._theta[p]),b(P,E,e)}},{"../scatterpolar/format_labels":1005}],1014:[function(c,ae,ie){"use strict";var b=c("../scattergl/hover"),k=c("../scatterpolar/hover").makeHoverPointText;function P(E,e,p,g){var a=E.cd,t=a[0].t,i=t.r,n=t.theta,r=b.hoverPoints(E,e,p,g);if(!(!r||r[0].index===!1)){var d=r[0];if(d.index===void 0)return r;var s=E.subplot,m=d.cd[d.index],x=d.trace;if(m.r=i[d.index],m.theta=n[d.index],!!s.isPtInside(m))return d.xLabelVal=void 0,d.yLabelVal=void 0,k(m,x,s,d),r}}ae.exports={hoverPoints:P}},{"../scattergl/hover":988,"../scatterpolar/hover":1006}],1015:[function(c,ae,ie){arguments[4][896][0].apply(ie,arguments)},{"./base_index":1010,"./plot":1016,dup:896}],1016:[function(c,ae,ie){"use strict";var b=c("@plotly/point-cluster"),k=c("fast-isnumeric"),P=c("../scattergl/plot"),E=c("../scattergl/scene_update"),e=c("../scattergl/convert"),p=c("../../lib"),g=c("../scattergl/constants").TOO_MANY_POINTS,a={};ae.exports=function(i,n,r){if(!!r.length){var d=n.radialAxis,s=n.angularAxis,m=E(i,n);return r.forEach(function(x){if(!(!x||!x[0]||!x[0].trace)){var M=x[0],v=M.trace,_=M.t,l=v._length,y=_.r,T=_.theta,w=_.opts,A,f=y.slice(),u=T.slice();for(A=0;A<y.length;A++)n.isPtInside({r:y[A],theta:T[A]})||(f[A]=NaN,u[A]=NaN);var h=new Array(l*2),o=Array(l),S=Array(l);for(A=0;A<l;A++){var R=f[A],z,O;if(k(R)){var I=d.c2g(R),F=s.c2g(u[A],v.thetaunit);z=I*Math.cos(F),O=I*Math.sin(F)}else z=O=NaN;o[A]=h[A*2]=z,S[A]=h[A*2+1]=O}_.tree=b(h),w.marker&&l>=g&&(w.marker.cluster=_.tree),w.marker&&(w.markerSel.positions=w.markerUnsel.positions=w.marker.positions=h),w.line&&h.length>1&&p.extendFlat(w.line,e.linePositions(i,v,h)),w.text&&(p.extendFlat(w.text,{positions:h},e.textPosition(i,v,w.text,w.marker)),p.extendFlat(w.textSel,{positions:h},e.textPosition(i,v,w.text,w.markerSel)),p.extendFlat(w.textUnsel,{positions:h},e.textPosition(i,v,w.text,w.markerUnsel))),w.fill&&!m.fill2d&&(m.fill2d=!0),w.marker&&!m.scatter2d&&(m.scatter2d=!0),w.line&&!m.line2d&&(m.line2d=!0),w.text&&!m.glText&&(m.glText=!0),m.lineOptions.push(w.line),m.fillOptions.push(w.fill),m.markerOptions.push(w.marker),m.markerSelectedOptions.push(w.markerSel),m.markerUnselectedOptions.push(w.markerUnsel),m.textOptions.push(w.text),m.textSelectedOptions.push(w.textSel),m.textUnselectedOptions.push(w.textUnsel),m.selectBatch.push([]),m.unselectBatch.push([]),_.x=o,_.y=S,_.rawx=o,_.rawy=S,_.r=y,_.theta=T,_.positions=h,_._scene=m,_.index=m.count,m.count++}}),P(i,n,r)}},ae.exports.reglPrecompiled=a},{"../../lib":503,"../scattergl/constants":982,"../scattergl/convert":983,"../scattergl/plot":990,"../scattergl/scene_update":991,"@plotly/point-cluster":59,"fast-isnumeric":190}],1017:[function(c,ae,ie){"use strict";var b=c("../../plots/template_attributes").hovertemplateAttrs,k=c("../../plots/template_attributes").texttemplateAttrs,P=c("../../lib/extend").extendFlat,E=c("../scatter/attributes"),e=c("../../plots/attributes"),p=E.line;ae.exports={mode:E.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:E.text,texttemplate:k({editType:"plot"},{keys:["real","imag","text"]}),hovertext:E.hovertext,line:{color:p.color,width:p.width,dash:p.dash,shape:P({},p.shape,{values:["linear","spline"]}),smoothing:p.smoothing,editType:"calc"},connectgaps:E.connectgaps,marker:E.marker,cliponaxis:P({},E.cliponaxis,{dflt:!1}),textposition:E.textposition,textfont:E.textfont,fill:P({},E.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:E.fillcolor,hoverinfo:P({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:E.hoveron,hovertemplate:b(),selected:E.selected,unselected:E.unselected}},{"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],1018:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../../constants/numerical").BADNUM,P=c("../scatter/colorscale_calc"),E=c("../scatter/arrays_to_calcdata"),e=c("../scatter/calc_selection"),p=c("../scatter/calc").calcMarkerSize;ae.exports=function(a,t){for(var i=a._fullLayout,n=t.subplot,r=i[n].realaxis,d=i[n].imaginaryaxis,s=r.makeCalcdata(t,"real"),m=d.makeCalcdata(t,"imag"),x=t._length,M=new Array(x),v=0;v<x;v++){var _=s[v],l=m[v],y=M[v]={};b(_)&&b(l)?(y.real=_,y.imag=l):y.real=k}return p(t,x),P(a,t),E(M,t),e(M,t),M}},{"../../constants/numerical":479,"../scatter/arrays_to_calcdata":926,"../scatter/calc":928,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],1019:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/subtypes"),P=c("../scatter/marker_defaults"),E=c("../scatter/line_defaults"),e=c("../scatter/line_shape_defaults"),p=c("../scatter/text_defaults"),g=c("../scatter/fillcolor_defaults"),a=c("../scatter/constants").PTS_LINESONLY,t=c("./attributes");ae.exports=function(r,d,s,m){function x(_,l){return b.coerce(r,d,t,_,l)}var M=i(r,d,m,x);if(!M){d.visible=!1;return}x("mode",M<a?"lines+markers":"lines"),x("text"),x("hovertext"),d.hoveron!=="fills"&&x("hovertemplate"),k.hasLines(d)&&(E(r,d,s,m,x),e(r,d,x),x("connectgaps")),k.hasMarkers(d)&&P(r,d,s,m,x,{gradient:!0}),k.hasText(d)&&(x("texttemplate"),p(r,d,m,x));var v=[];(k.hasMarkers(d)||k.hasText(d))&&(x("cliponaxis"),x("marker.maxdisplayed"),v.push("points")),x("fill"),d.fill!=="none"&&(g(r,d,s,x),k.hasLines(d)||e(r,d,x)),(d.fill==="tonext"||d.fill==="toself")&&v.push("fills"),x("hoveron",v.join("+")||"points"),b.coerceSelectionMarkerOpacity(d,x)};function i(n,r,d,s){var m=s("real"),x=s("imag"),M;return m&&x&&(M=Math.min(m.length,x.length)),r._length=M,M}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/line_shape_defaults":942,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":1017}],1020:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes");ae.exports=function(P,E,e){var p={},g=e[E.subplot]._subplot;return p.realLabel=b.tickText(g.radialAxis,P.real,!0).text,p.imagLabel=b.tickText(g.angularAxis,P.imag,!0).text,p}},{"../../plots/cartesian/axes":554}],1021:[function(c,ae,ie){"use strict";var b=c("../scatter/hover");function k(E,e,p,g){var a=b(E,e,p,g);if(!(!a||a[0].index===!1)){var t=a[0];if(t.index===void 0)return a;var i=E.subplot,n=t.cd[t.index],r=t.trace;if(!!i.isPtInside(n))return t.xLabelVal=void 0,t.yLabelVal=void 0,P(n,r,i,t),t.hovertemplate=r.hovertemplate,a}}function P(E,e,p,g){var a=p.radialAxis,t=p.angularAxis;a._hovertitle="real",t._hovertitle="imag";var i={};i[e.subplot]={_subplot:p};var n=e._module.formatLabels(E,e,i);g.realLabel=n.realLabel,g.imagLabel=n.imagLabel;var r=E.hi||e.hoverinfo,d=[];function s(x,M){d.push(x._hovertitle+": "+M)}if(!e.hovertemplate){var m=r.split("+");m.indexOf("all")!==-1&&(m=["real","imag","text"]),m.indexOf("real")!==-1&&s(a,g.realLabel),m.indexOf("imag")!==-1&&s(t,g.imagLabel),m.indexOf("text")!==-1&&g.text&&(d.push(g.text),delete g.text),g.extraText=d.join("<br>")}}ae.exports={hoverPoints:k,makeHoverPointText:P}},{"../scatter/hover":938}],1022:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"scattersmith",basePlotModule:c("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../scatter/marker_colorbar"),formatLabels:c("./format_labels"),calc:c("./calc"),plot:c("./plot"),style:c("../scatter/style").style,styleOnSelect:c("../scatter/style").styleOnSelect,hoverPoints:c("./hover").hoverPoints,selectPoints:c("../scatter/select"),meta:{}}},{"../../plots/smith":629,"../scatter/marker_colorbar":945,"../scatter/select":949,"../scatter/style":951,"./attributes":1017,"./calc":1018,"./defaults":1019,"./format_labels":1020,"./hover":1021,"./plot":1023}],1023:[function(c,ae,ie){"use strict";var b=c("../scatter/plot"),k=c("../../constants/numerical").BADNUM,P=c("../../plots/smith/helpers"),E=P.smith;ae.exports=function(p,g,a){for(var t=g.layers.frontplot.select("g.scatterlayer"),i={xaxis:g.xaxis,yaxis:g.yaxis,plot:g.framework,layerClipId:g._hasClipOnAxisFalse?g.clipIds.forTraces:null},n=0;n<a.length;n++)for(var r=a[n],d=0;d<r.length;d++){var s=r[d],m=s.real;if(m===k)s.x=s.y=k;else{var x=E([m,s.imag]);s.x=x[0],s.y=x[1]}}b(p,i,a,t)}},{"../../constants/numerical":479,"../../plots/smith/helpers":628,"../scatter/plot":948}],1024:[function(c,ae,ie){"use strict";var b=c("../../plots/template_attributes").hovertemplateAttrs,k=c("../../plots/template_attributes").texttemplateAttrs,P=c("../scatter/attributes"),E=c("../../plots/attributes"),e=c("../../components/colorscale/attributes"),p=c("../../components/drawing/attributes").dash,g=c("../../lib/extend").extendFlat,a=P.marker,t=P.line,i=a.line;ae.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:g({},P.mode,{dflt:"markers"}),text:g({},P.text,{}),texttemplate:k({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:g({},P.hovertext,{}),line:{color:t.color,width:t.width,dash:p,shape:g({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:P.connectgaps,cliponaxis:P.cliponaxis,fill:g({},P.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:P.fillcolor,marker:g({symbol:a.symbol,opacity:a.opacity,maxdisplayed:a.maxdisplayed,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode,line:g({width:i.width,editType:"calc"},e("marker.line")),gradient:a.gradient,editType:"calc"},e("marker")),textfont:P.textfont,textposition:P.textposition,selected:P.selected,unselected:P.unselected,hoverinfo:g({},E.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:P.hoveron,hovertemplate:b()}},{"../../components/colorscale/attributes":373,"../../components/drawing/attributes":387,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/template_attributes":633,"../scatter/attributes":927}],1025:[function(c,ae,ie){"use strict";var b=c("fast-isnumeric"),k=c("../scatter/colorscale_calc"),P=c("../scatter/arrays_to_calcdata"),E=c("../scatter/calc_selection"),e=c("../scatter/calc").calcMarkerSize,p=["a","b","c"],g={a:["b","c"],b:["a","c"],c:["a","b"]};ae.exports=function(t,i){var n=t._fullLayout[i.subplot],r=n.sum,d=i.sum||r,s={a:i.a,b:i.b,c:i.c},m,x,M,v,_,l;for(m=0;m<p.length;m++)if(M=p[m],!s[M]){for(_=s[g[M][0]],l=s[g[M][1]],v=new Array(_.length),x=0;x<_.length;x++)v[x]=d-_[x]-l[x];s[M]=v}var y=i._length,T=new Array(y),w,A,f,u,h,o;for(m=0;m<y;m++)w=s.a[m],A=s.b[m],f=s.c[m],b(w)&&b(A)&&b(f)?(w=+w,A=+A,f=+f,u=r/(w+A+f),u!==1&&(w*=u,A*=u,f*=u),o=w,h=f-A,T[m]={x:h,y:o,a:w,b:A,c:f}):T[m]={x:!1,y:!1};return e(i,y),k(t,i),P(T,i),E(T,i),T}},{"../scatter/arrays_to_calcdata":926,"../scatter/calc":928,"../scatter/calc_selection":929,"../scatter/colorscale_calc":930,"fast-isnumeric":190}],1026:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/constants"),P=c("../scatter/subtypes"),E=c("../scatter/marker_defaults"),e=c("../scatter/line_defaults"),p=c("../scatter/line_shape_defaults"),g=c("../scatter/text_defaults"),a=c("../scatter/fillcolor_defaults"),t=c("./attributes");ae.exports=function(n,r,d,s){function m(T,w){return b.coerce(n,r,t,T,w)}var x=m("a"),M=m("b"),v=m("c"),_;if(x?(_=x.length,M?(_=Math.min(_,M.length),v&&(_=Math.min(_,v.length))):v?_=Math.min(_,v.length):_=0):M&&v&&(_=Math.min(M.length,v.length)),!_){r.visible=!1;return}r._length=_,m("sum"),m("text"),m("hovertext"),r.hoveron!=="fills"&&m("hovertemplate");var l=_<k.PTS_LINESONLY?"lines+markers":"lines";m("mode",l),P.hasLines(r)&&(e(n,r,d,s,m),p(n,r,m),m("connectgaps")),P.hasMarkers(r)&&E(n,r,d,s,m,{gradient:!0}),P.hasText(r)&&(m("texttemplate"),g(n,r,s,m));var y=[];(P.hasMarkers(r)||P.hasText(r))&&(m("cliponaxis"),m("marker.maxdisplayed"),y.push("points")),m("fill"),r.fill!=="none"&&(a(n,r,d,m),P.hasLines(r)||p(n,r,m)),(r.fill==="tonext"||r.fill==="toself")&&y.push("fills"),m("hoveron",y.join("+")||"points"),b.coerceSelectionMarkerOpacity(r,m)}},{"../../lib":503,"../scatter/constants":931,"../scatter/fillcolor_defaults":935,"../scatter/line_defaults":940,"../scatter/line_shape_defaults":942,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scatter/text_defaults":953,"./attributes":1024}],1027:[function(c,ae,ie){"use strict";ae.exports=function(k,P,E,e,p){if(P.xa&&(k.xaxis=P.xa),P.ya&&(k.yaxis=P.ya),e[p]){var g=e[p];k.a=g.a,k.b=g.b,k.c=g.c}else k.a=P.a,k.b=P.b,k.c=P.c;return k}},{}],1028:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes");ae.exports=function(P,E,e){var p={},g=e[E.subplot]._subplot;return p.aLabel=b.tickText(g.aaxis,P.a,!0).text,p.bLabel=b.tickText(g.baxis,P.b,!0).text,p.cLabel=b.tickText(g.caxis,P.c,!0).text,p}},{"../../plots/cartesian/axes":554}],1029:[function(c,ae,ie){"use strict";var b=c("../scatter/hover");ae.exports=function(P,E,e,p){var g=b(P,E,e,p);if(!g||g[0].index===!1)return;var a=g[0];if(a.index===void 0){var t=1-a.y0/P.ya._length,i=P.xa._length,n=i*t/2,r=i-n;return a.x0=Math.max(Math.min(a.x0,r),n),a.x1=Math.max(Math.min(a.x1,r),n),g}var d=a.cd[a.index],s=a.trace,m=a.subplot;a.a=d.a,a.b=d.b,a.c=d.c,a.xLabelVal=void 0,a.yLabelVal=void 0;var x={};x[s.subplot]={_subplot:m};var M=s._module.formatLabels(d,s,x);a.aLabel=M.aLabel,a.bLabel=M.bLabel,a.cLabel=M.cLabel;var v=d.hi||s.hoverinfo,_=[];function l(T,w){_.push(T._hovertitle+": "+w)}if(!s.hovertemplate){var y=v.split("+");y.indexOf("all")!==-1&&(y=["a","b","c"]),y.indexOf("a")!==-1&&l(m.aaxis,a.aLabel),y.indexOf("b")!==-1&&l(m.baxis,a.bLabel),y.indexOf("c")!==-1&&l(m.caxis,a.cLabel)}return a.extraText=_.join("<br>"),a.hovertemplate=s.hovertemplate,g}},{"../scatter/hover":938}],1030:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../scatter/marker_colorbar"),formatLabels:c("./format_labels"),calc:c("./calc"),plot:c("./plot"),style:c("../scatter/style").style,styleOnSelect:c("../scatter/style").styleOnSelect,hoverPoints:c("./hover"),selectPoints:c("../scatter/select"),eventData:c("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:c("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":634,"../scatter/marker_colorbar":945,"../scatter/select":949,"../scatter/style":951,"./attributes":1024,"./calc":1025,"./defaults":1026,"./event_data":1027,"./format_labels":1028,"./hover":1029,"./plot":1031}],1031:[function(c,ae,ie){"use strict";var b=c("../scatter/plot");ae.exports=function(P,E,e){var p=E.plotContainer;p.select(".scatterlayer").selectAll("*").remove();var g={xaxis:E.xaxis,yaxis:E.yaxis,plot:p,layerClipId:E._hasClipOnAxisFalse?E.clipIdRelative:null},a=E.layers.frontplot.select("g.scatterlayer");b(P,g,e,a)}},{"../scatter/plot":948}],1032:[function(c,ae,ie){"use strict";var b=c("../scatter/attributes"),k=c("../../components/colorscale/attributes"),P=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,E=c("../../plots/template_attributes").hovertemplateAttrs,e=c("../scattergl/attributes"),p=c("../../plots/cartesian/constants").idRegex,g=c("../../plot_api/plot_template").templatedArray,a=c("../../lib/extend").extendFlat,t=b.marker,i=t.line,n=a(k("marker.line",{editTypeOverride:"calc"}),{width:a({},i.width,{editType:"calc"}),editType:"calc"}),r=a(k("marker"),{symbol:t.symbol,size:a({},t.size,{editType:"markerSize"}),sizeref:t.sizeref,sizemin:t.sizemin,sizemode:t.sizemode,opacity:t.opacity,colorbar:t.colorbar,line:n,editType:"calc"});r.color.editType=r.cmin.editType=r.cmax.editType="style";function d(s){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:p[s],editType:"plot"}}}ae.exports={dimensions:g("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:a({},e.text,{}),hovertext:a({},e.hovertext,{}),hovertemplate:E(),xhoverformat:P("x"),yhoverformat:P("y"),marker:r,xaxes:d("x"),yaxes:d("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/plot_template":543,"../../plots/cartesian/axis_format_attributes":557,"../../plots/cartesian/constants":561,"../../plots/template_attributes":633,"../scatter/attributes":927,"../scattergl/attributes":979}],1033:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../components/grid");ae.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:c("../scatter/marker_colorbar"),calc:c("./calc"),plot:c("./plot"),hoverPoints:c("./hover").hoverPoints,selectPoints:c("./select"),editStyle:c("./edit_style"),meta:{}},b.register(k)},{"../../components/grid":410,"../../registry":638,"../scatter/marker_colorbar":945,"./attributes":1032,"./calc":1035,"./defaults":1036,"./edit_style":1037,"./hover":1039,"./plot":1041,"./select":1043}],1034:[function(c,ae,ie){"use strict";var b=c("regl-line2d"),k=c("../../registry"),P=c("../../lib/prepare_regl"),E=c("../../plots/get_data").getModuleCalcData,e=c("../../plots/cartesian"),p=c("../../plots/cartesian/axis_ids").getFromId,g=c("../../plots/cartesian/axes").shouldShowZeroLine,a="splom",t={};function i(x){var M=x._fullLayout,v=k.getModule(a),_=E(x.calcdata,v)[0],l=P(x,["ANGLE_instanced_arrays","OES_element_index_uint"],t);!l||(M._hasOnlyLargeSploms&&d(x),v.plot(x,{},_))}function n(x){var M=x.calcdata,v=x._fullLayout;v._hasOnlyLargeSploms&&d(x);for(var _=0;_<M.length;_++){var l=M[_][0],y=l.trace,T=v._splomScenes[y.uid];y.type==="splom"&&T&&T.matrix&&r(x,y,T)}}function r(x,M,v){for(var _=v.matrixOptions.data.length,l=M._visibleDims,y=v.viewOpts.ranges=new Array(_),T=0;T<l.length;T++){var w=l[T],A=y[T]=new Array(4),f=p(x,M._diag[w][0]);f&&(A[0]=f.r2l(f.range[0]),A[2]=f.r2l(f.range[1]));var u=p(x,M._diag[w][1]);u&&(A[1]=u.r2l(u.range[0]),A[3]=u.r2l(u.range[1]))}v.selectBatch.length||v.unselectBatch.length?v.matrix.update({ranges:y},{ranges:y}):v.matrix.update({ranges:y})}function d(x){var M=x._fullLayout,v=M._glcanvas.data()[0].regl,_=M._splomGrid;_||(_=M._splomGrid=b(v)),_.update(s(x))}function s(x){var M=x._context.plotGlPixelRatio,v=x._fullLayout,_=v._size,l=[0,0,v.width*M,v.height*M],y={},T;function w(X,oe,se,q,K,G){se*=M,q*=M,K*=M,G*=M;var Q=oe[X+"color"],V=oe[X+"width"],H=String(Q+V);H in y?y[H].data.push(NaN,NaN,se,q,K,G):y[H]={data:[se,q,K,G],join:"rect",thickness:V*M,color:Q,viewport:l,range:l,overlay:!1}}for(T in v._splomSubplots){var A=v._plots[T],f=A.xaxis,u=A.yaxis,h=f._gridVals,o=u._gridVals,S=f._offset,R=f._length,z=u._length,O=_.b+u.domain[0]*_.h,I=-u._m,F=-I*u.r2l(u.range[0],u.calendar),D,B;if(f.showgrid)for(T=0;T<h.length;T++)D=S+f.l2p(h[T].x),w("grid",f,D,O,D,O+z);if(u.showgrid)for(T=0;T<o.length;T++)B=O+F+I*o[T].x,w("grid",u,S,B,S+R,B);g(x,f,u)&&(D=S+f.l2p(0),w("zeroline",f,D,O,D,O+z)),g(x,u,f)&&(B=O+F+0,w("zeroline",u,S,B,S+R,B))}var U=[];for(T in y)U.push(y[T]);return U}function m(x,M,v,_){var l={},y;if(_._splomScenes){for(y=0;y<x.length;y++){var T=x[y];T.type==="splom"&&(l[T.uid]=1)}for(y=0;y<v.length;y++){var w=v[y];if(!l[w.uid]){var A=_._splomScenes[w.uid];A&&A.destroy&&A.destroy(),_._splomScenes[w.uid]=null,delete _._splomScenes[w.uid]}}}Object.keys(_._splomScenes||{}).length===0&&delete _._splomScenes,_._splomGrid&&!M._hasOnlyLargeSploms&&_._hasOnlyLargeSploms&&(_._splomGrid.destroy(),_._splomGrid=null,delete _._splomGrid),e.clean(x,M,v,_)}ae.exports={name:a,attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:i,drag:n,updateGrid:d,clean:m,updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:t}},{"../../lib/prepare_regl":516,"../../plots/cartesian":568,"../../plots/cartesian/axes":554,"../../plots/cartesian/axis_ids":558,"../../plots/get_data":593,"../../registry":638,"regl-line2d":280}],1035:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axis_ids"),P=c("../scatter/calc").calcMarkerSize,E=c("../scatter/calc").calcAxisExpansion,e=c("../scatter/colorscale_calc"),p=c("../scattergl/convert").markerSelection,g=c("../scattergl/convert").markerStyle,a=c("./scene_update"),t=c("../../constants/numerical").BADNUM,i=c("../scattergl/constants").TOO_MANY_POINTS;ae.exports=function(r,d){var s=d.dimensions,m=d._length,x={},M=x.cdata=[],v=x.data=[],_=d._visibleDims=[],l,y,T,w,A;function f(R,z){for(var O=R.makeCalcdata({v:z.values,vcalendar:d.calendar},"v"),I=0;I<O.length;I++)O[I]=O[I]===t?NaN:O[I];M.push(O),v.push(R.type==="log"?b.simpleMap(O,R.c2l):O)}for(l=0;l<s.length;l++)if(T=s[l],T.visible){if(w=k.getFromId(r,d._diag[l][0]),A=k.getFromId(r,d._diag[l][1]),w&&A&&w.type!==A.type){b.log("Skipping splom dimension "+l+" with conflicting axis types");continue}w?(f(w,T),A&&A.type==="category"&&(A._categories=w._categories.slice())):f(A,T),_.push(l)}e(r,d),b.extendFlat(x,g(d));var u=M.length,h=u*m>i,o;for(h?o=x.sizeAvg||Math.max(x.size,3):o=P(d,m),y=0;y<_.length;y++)l=_[y],T=s[l],w=k.getFromId(r,d._diag[l][0])||{},A=k.getFromId(r,d._diag[l][1])||{},E(r,d,w,A,M[y],M[y],o);var S=a(r,d);return S.matrix||(S.matrix=!0),S.matrixOptions=x,S.selectedOptions=p(d,d.selected),S.unselectedOptions=p(d,d.unselected),[{x:!1,y:!1,t:{},trace:d}]}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axis_ids":558,"../scatter/calc":928,"../scatter/colorscale_calc":930,"../scattergl/constants":982,"../scattergl/convert":983,"./scene_update":1042}],1036:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/array_container_defaults"),P=c("./attributes"),E=c("../scatter/subtypes"),e=c("../scatter/marker_defaults"),p=c("../parcoords/merge_length"),g=c("../scattergl/helpers").isOpenSymbol;ae.exports=function(n,r,d,s){function m(w,A){return b.coerce(n,r,P,w,A)}var x=k(n,r,{name:"dimensions",handleItemDefaults:a}),M=m("diagonal.visible"),v=m("showupperhalf"),_=m("showlowerhalf"),l=p(r,x,"values");if(!l||!M&&!v&&!_){r.visible=!1;return}m("text"),m("hovertext"),m("hovertemplate"),m("xhoverformat"),m("yhoverformat"),e(n,r,d,s,m);var y=g(r.marker.symbol),T=E.isBubble(r);m("marker.line.width",y||T?1:0),t(n,r,s,m),b.coerceSelectionMarkerOpacity(r,m)};function a(i,n){function r(s,m){return b.coerce(i,n,P.dimensions,s,m)}r("label");var d=r("values");d&&d.length?r("visible"):n.visible=!1,r("axis.type"),r("axis.matches")}function t(i,n,r,d){var s=n.dimensions,m=s.length,x=n.showupperhalf,M=n.showlowerhalf,v=n.diagonal.visible,_,l,y=new Array(m),T=new Array(m);for(_=0;_<m;_++){var w=_?_+1:"";y[_]="x"+w,T[_]="y"+w}var A=d("xaxes",y),f=d("yaxes",T),u=n._diag=new Array(m);n._xaxes={},n._yaxes={};var h=[],o=[];function S(X,oe,se,q){if(!!X){var K=X.charAt(0),G=r._splomAxes[K];if(n["_"+K+"axes"][X]=1,q.push(X),!(X in G)){var Q=G[X]={};se&&(Q.label=se.label||"",se.visible&&se.axis&&(se.axis.type&&(Q.type=se.axis.type),se.axis.matches&&(Q.matches=oe)))}}}var R=!v&&!M,z=!v&&!x;for(n._axesDim={},_=0;_<m;_++){var O=s[_],I=_===0,F=_===m-1,D=I&&R||F&&z?void 0:A[_],B=I&&z||F&&R?void 0:f[_];S(D,B,O,h),S(B,D,O,o),u[_]=[D,B],n._axesDim[D]=_,n._axesDim[B]=_}for(_=0;_<h.length;_++)for(l=0;l<o.length;l++){var U=h[_]+o[l];(_>l&&x||_<l&&M||_===l&&(v||!M||!x))&&(r._splomSubplots[U]=1)}(!M||!v&&x&&M)&&(r._splomGridDflt.xside="bottom",r._splomGridDflt.yside="left")}},{"../../lib":503,"../../plots/array_container_defaults":549,"../parcoords/merge_length":898,"../scatter/marker_defaults":946,"../scatter/subtypes":952,"../scattergl/helpers":987,"./attributes":1032}],1037:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/colorscale_calc"),P=c("../scattergl/convert").markerStyle;ae.exports=function(e,p){var g=p.trace,a=e._fullLayout._splomScenes[g.uid];if(a){k(e,g),b.extendFlat(a.matrixOptions,P(g));var t=b.extendFlat({},a.matrixOptions,a.viewOpts);a.matrix.update(t,null)}}},{"../../lib":503,"../scatter/colorscale_calc":930,"../scattergl/convert":983}],1038:[function(c,ae,ie){"use strict";ie.getDimIndex=function(k,P){for(var E=P._id,e=E.charAt(0),p={x:0,y:1}[e],g=k._visibleDims,a=0;a<g.length;a++){var t=g[a];if(k._diag[t][p]===E)return a}return!1}},{}],1039:[function(c,ae,ie){"use strict";var b=c("./helpers"),k=c("../scattergl/hover").calcHover;function P(E,e,p){var g=E.cd,a=g[0].trace,t=E.scene,i=t.matrixOptions.cdata,n=E.xa,r=E.ya,d=n.c2p(e),s=r.c2p(p),m=E.distance,x=b.getDimIndex(a,n),M=b.getDimIndex(a,r);if(x===!1||M===!1)return[E];for(var v=i[x],_=i[M],l,y,T=m,w=0;w<v.length;w++){var A=v[w],f=_[w],u=n.c2p(A)-d,h=r.c2p(f)-s,o=Math.sqrt(u*u+h*h);o<T&&(T=y=o,l=w)}return E.index=l,E.distance=T,E.dxy=y,l===void 0?[E]:[k(E,v,_,a)]}ae.exports={hoverPoints:P}},{"../scattergl/hover":988,"./helpers":1038}],1040:[function(c,ae,ie){"use strict";var b=c("./base_index");b.basePlotModule=c("./base_plot"),ae.exports=b},{"./base_index":1033,"./base_plot":1034}],1041:[function(c,ae,ie){"use strict";var b=c("regl-splom"),k=c("../../lib"),P=c("../../plots/cartesian/axis_ids"),E=c("../../components/dragelement/helpers").selectMode;ae.exports=function(g,a,t){if(!!t.length)for(var i=0;i<t.length;i++)e(g,t[i][0])};function e(p,g){var a=p._fullLayout,t=a._size,i=g.trace,n=g.t,r=a._splomScenes[i.uid],d=r.matrixOptions,s=d.cdata,m=a._glcanvas.data()[0].regl,x=a.dragmode,M,v,_,l,y;if(s.length!==0){d.lower=i.showupperhalf,d.upper=i.showlowerhalf,d.diagonal=i.diagonal.visible;var T=i._visibleDims,w=s.length,A=r.viewOpts={};for(A.ranges=new Array(w),A.domains=new Array(w),y=0;y<T.length;y++){_=T[y];var f=A.ranges[y]=new Array(4),u=A.domains[y]=new Array(4);M=P.getFromId(p,i._diag[_][0]),M&&(f[0]=M._rl[0],f[2]=M._rl[1],u[0]=M.domain[0],u[2]=M.domain[1]),v=P.getFromId(p,i._diag[_][1]),v&&(f[1]=v._rl[0],f[3]=v._rl[1],u[1]=v.domain[0],u[3]=v.domain[1])}var h=p._context.plotGlPixelRatio,o=t.l*h,S=t.b*h,R=t.w*h,z=t.h*h;A.viewport=[o,S,R+o,z+S],r.matrix===!0&&(r.matrix=b(m));var O=a.clickmode.indexOf("select")>-1,I=E(x)||!!i.selectedpoints||O,F=!0;if(I){var D=i._length;if(i.selectedpoints){r.selectBatch=i.selectedpoints;var B=i.selectedpoints,U={};for(_=0;_<B.length;_++)U[B[_]]=!0;var X=[];for(_=0;_<D;_++)U[_]||X.push(_);r.unselectBatch=X}var oe=n.xpx=new Array(w),se=n.ypx=new Array(w);for(y=0;y<T.length;y++){if(_=T[y],M=P.getFromId(p,i._diag[_][0]),M)for(oe[y]=new Array(D),l=0;l<D;l++)oe[y][l]=M.c2p(s[y][l]);if(v=P.getFromId(p,i._diag[_][1]),v)for(se[y]=new Array(D),l=0;l<D;l++)se[y][l]=v.c2p(s[y][l])}if(r.selectBatch.length||r.unselectBatch.length){var q=k.extendFlat({},d,r.unselectedOptions,A),K=k.extendFlat({},d,r.selectedOptions,A);r.matrix.update(q,K),F=!1}}else n.xpx=n.ypx=null;if(F){var G=k.extendFlat({},d,A);r.matrix.update(G,null)}}}},{"../../components/dragelement/helpers":384,"../../lib":503,"../../plots/cartesian/axis_ids":558,"regl-splom":282}],1042:[function(c,ae,ie){"use strict";var b=c("../../lib");ae.exports=function(P,E){var e=P._fullLayout,p=E.uid,g=e._splomScenes;g||(g=e._splomScenes={});var a={dirty:!0,selectBatch:[],unselectBatch:[]},t={matrix:!1,selectBatch:[],unselectBatch:[]},i=g[E.uid];return i||(i=g[p]=b.extendFlat({},a,t),i.draw=function(){i.matrix&&i.matrix.draw&&(i.selectBatch.length||i.unselectBatch.length?i.matrix.draw(i.unselectBatch,i.selectBatch):i.matrix.draw()),i.dirty=!1},i.destroy=function(){i.matrix&&i.matrix.destroy&&i.matrix.destroy(),i.matrixOptions=null,i.selectBatch=null,i.unselectBatch=null,i=null}),i.dirty||b.extendFlat(i,a),i}},{"../../lib":503}],1043:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../scatter/subtypes"),P=c("./helpers");ae.exports=function(e,p){var g=e.cd,a=g[0].trace,t=g[0].t,i=e.scene,n=i.matrixOptions.cdata,r=e.xaxis,d=e.yaxis,s=[];if(!i)return s;var m=!k.hasMarkers(a)&&!k.hasText(a);if(a.visible!==!0||m)return s;var x=P.getDimIndex(a,r),M=P.getDimIndex(a,d);if(x===!1||M===!1)return s;var v=t.xpx[x],_=t.ypx[M],l=n[x],y=n[M],T=[],w=[];if(p!==!1&&!p.degenerate)for(var A=0;A<l.length;A++)p.contains([v[A],_[A]],null,A,e)?(T.push(A),s.push({pointNumber:A,x:l[A],y:y[A]})):w.push(A);var f=i.matrixOptions;return!T.length&&!w.length?i.matrix.update(f,null):!i.selectBatch.length&&!i.unselectBatch.length&&i.matrix.update(i.unselectedOptions,b.extendFlat({},f,i.selectedOptions,i.viewOpts)),i.selectBatch=T,i.unselectBatch=w,s}},{"../../lib":503,"../scatter/subtypes":952,"./helpers":1038}],1044:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/attributes"),k=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,P=c("../../plots/template_attributes").hovertemplateAttrs,E=c("../mesh3d/attributes"),e=c("../../plots/attributes"),p=c("../../lib/extend").extendFlat,g={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:P({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:k("u",1),vhoverformat:k("v",1),whoverformat:k("w",1),xhoverformat:k("x"),yhoverformat:k("y"),zhoverformat:k("z"),showlegend:p({},e.showlegend,{dflt:!1})};p(g,b("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"}));var a=["opacity","lightposition","lighting"];a.forEach(function(t){g[t]=E[t]}),g.hoverinfo=p({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),g.transforms=void 0,ae.exports=g},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../mesh3d/attributes":867}],1045:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/colorscale/calc");function P(g,a){a._len=Math.min(a.u.length,a.v.length,a.w.length,a.x.length,a.y.length,a.z.length),a._u=p(a.u,a._len),a._v=p(a.v,a._len),a._w=p(a.w,a._len),a._x=p(a.x,a._len),a._y=p(a.y,a._len),a._z=p(a.z,a._len);var t=E(a);a._gridFill=t.fill,a._Xs=t.Xs,a._Ys=t.Ys,a._Zs=t.Zs,a._len=t.len;var i=0,n,r,d;a.starts&&(n=p(a.starts.x||[]),r=p(a.starts.y||[]),d=p(a.starts.z||[]),i=Math.min(n.length,r.length,d.length)),a._startsX=n||[],a._startsY=r||[],a._startsZ=d||[];var s=0,m=1/0,x;for(x=0;x<a._len;x++){var M=a._u[x],v=a._v[x],_=a._w[x],l=Math.sqrt(M*M+v*v+_*_);s=Math.max(s,l),m=Math.min(m,l)}for(k(g,a,{vals:[m,s],containerStr:"",cLetter:"c"}),x=0;x<i;x++){var y=n[x];t.xMax=Math.max(t.xMax,y),t.xMin=Math.min(t.xMin,y);var T=r[x];t.yMax=Math.max(t.yMax,T),t.yMin=Math.min(t.yMin,T);var w=d[x];t.zMax=Math.max(t.zMax,w),t.zMin=Math.min(t.zMin,w)}a._slen=i,a._normMax=s,a._xbnds=[t.xMin,t.xMax],a._ybnds=[t.yMin,t.yMax],a._zbnds=[t.zMin,t.zMax]}function E(g){var a=g._x,t=g._y,i=g._z,n=g._len,r,d,s,m=-1/0,x=1/0,M=-1/0,v=1/0,_=-1/0,l=1/0,y="",T,w,A,f,u,h,o,S,R;for(n&&(f=a[0],h=t[0],S=i[0]),n>1&&(u=a[n-1],o=t[n-1],R=i[n-1]),r=0;r<n;r++)m=Math.max(m,a[r]),x=Math.min(x,a[r]),M=Math.max(M,t[r]),v=Math.min(v,t[r]),_=Math.max(_,i[r]),l=Math.min(l,i[r]),!T&&a[r]!==f&&(T=!0,y+="x"),!w&&t[r]!==h&&(w=!0,y+="y"),!A&&i[r]!==S&&(A=!0,y+="z");T||(y+="x"),w||(y+="y"),A||(y+="z");var z=e(g._x),O=e(g._y),I=e(g._z);y=y.replace("x",(f>u?"-":"+")+"x"),y=y.replace("y",(h>o?"-":"+")+"y"),y=y.replace("z",(S>R?"-":"+")+"z");var F=function(){n=0,z=[],O=[],I=[]};(!n||n<z.length*O.length*I.length)&&F();var D=function(ne){return ne==="x"?a:ne==="y"?t:i},B=function(ne){return ne==="x"?z:ne==="y"?O:I},U=function(ne){return ne[n-1]<ne[0]?-1:1},X=D(y[1]),oe=D(y[3]),se=D(y[5]),q=B(y[1]).length,K=B(y[3]).length,G=B(y[5]).length,Q=!1,V=function(ne,le,ge){return q*(K*ne+le)+ge},H=U(D(y[1])),ee=U(D(y[3])),J=U(D(y[5]));for(r=0;r<G-1;r++){for(d=0;d<K-1;d++){for(s=0;s<q-1;s++){var W=V(r,d,s),re=V(r,d,s+1),j=V(r,d+1,s),Z=V(r+1,d,s);if((!(X[W]*H<X[re]*H)||!(oe[W]*ee<oe[j]*ee)||!(se[W]*J<se[Z]*J))&&(Q=!0),Q)break}if(Q)break}if(Q)break}return Q&&(b.warn("Encountered arbitrary coordinates! Unable to input data grid."),F()),{xMin:x,yMin:v,zMin:l,xMax:m,yMax:M,zMax:_,Xs:z,Ys:O,Zs:I,len:n,fill:y}}function e(g){return b.distinctVals(g).vals}function p(g,a){if(a===void 0&&(a=g.length),b.isTypedArray(g))return g.subarray(0,a);for(var t=[],i=0;i<a;i++)t[i]=+g[i];return t}ae.exports={calc:P,filter:p,processGrid:E}},{"../../components/colorscale/calc":374,"../../lib":503}],1046:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_streamtube3d,k=b.createTubeMesh,P=c("../../lib"),E=c("../../lib/gl_format_color").parseColorScale,e=c("../../components/colorscale").extractOpts,p=c("../../plots/gl3d/zip3"),g={xaxis:0,yaxis:1,zaxis:2};function a(s,m){this.scene=s,this.uid=m,this.mesh=null,this.data=null}var t=a.prototype;t.handlePick=function(s){var m=this.scene.fullSceneLayout,x=this.scene.dataScale;function M(l,y){var T=m[y],w=x[g[y]];return T.l2c(l)/w}if(s.object===this.mesh){var v=s.data.position,_=s.data.velocity;return s.traceCoordinate=[M(v[0],"xaxis"),M(v[1],"yaxis"),M(v[2],"zaxis"),M(_[0],"xaxis"),M(_[1],"yaxis"),M(_[2],"zaxis"),s.data.intensity*this.data._normMax,s.data.divergence],s.textLabel=this.data.hovertext||this.data.text,!0}};function i(s){var m=s.length,x;return m>2?x=s.slice(1,m-1):m===2?x=[(s[0]+s[1])/2]:x=s,x}function n(s){var m=s.length;return m===1?[.5,.5]:[s[1]-s[0],s[m-1]-s[m-2]]}function r(s,m){var x=s.fullSceneLayout,M=s.dataScale,v=m._len,_={};function l(K,G){var Q=x[G],V=M[g[G]];return P.simpleMap(K,function(H){return Q.d2l(H)*V})}if(_.vectors=p(l(m._u,"xaxis"),l(m._v,"yaxis"),l(m._w,"zaxis"),v),!v)return{positions:[],cells:[]};var y=l(m._Xs,"xaxis"),T=l(m._Ys,"yaxis"),w=l(m._Zs,"zaxis");_.meshgrid=[y,T,w],_.gridFill=m._gridFill;var A=m._slen;if(A)_.startingPositions=p(l(m._startsX,"xaxis"),l(m._startsY,"yaxis"),l(m._startsZ,"zaxis"));else{for(var f=T[0],u=i(y),h=i(w),o=new Array(u.length*h.length),S=0,R=0;R<u.length;R++)for(var z=0;z<h.length;z++)o[S++]=[u[R],f,h[z]];_.startingPositions=o}_.colormap=E(m),_.tubeSize=m.sizeref,_.maxLength=m.maxdisplayed;var O=l(m._xbnds,"xaxis"),I=l(m._ybnds,"yaxis"),F=l(m._zbnds,"zaxis"),D=n(y),B=n(T),U=n(w),X=[[O[0]-D[0],I[0]-B[0],F[0]-U[0]],[O[1]+D[1],I[1]+B[1],F[1]+U[1]]],oe=b(_,X),se=e(m);oe.vertexIntensityBounds=[se.min/m._normMax,se.max/m._normMax];var q=m.lightposition;return oe.lightPosition=[q.x,q.y,q.z],oe.ambient=m.lighting.ambient,oe.diffuse=m.lighting.diffuse,oe.specular=m.lighting.specular,oe.roughness=m.lighting.roughness,oe.fresnel=m.lighting.fresnel,oe.opacity=m.opacity,m._pad=oe.tubeScale*m.sizeref*2,oe}t.update=function(s){this.data=s;var m=r(this.scene,s);this.mesh.update(m)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function d(s,m){var x=s.glplot.gl,M=r(s,m),v=k(x,M),_=new a(s,m.uid);return _.mesh=v,_.data=m,v._trace=_,s.glplot.add(v),_}ae.exports=d},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib":503,"../../lib/gl_format_color":499,"../../plots/gl3d/zip3":609}],1047:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/colorscale/defaults"),P=c("./attributes");ae.exports=function(e,p,g,a){function t(x,M){return b.coerce(e,p,P,x,M)}var i=t("u"),n=t("v"),r=t("w"),d=t("x"),s=t("y"),m=t("z");if(!i||!i.length||!n||!n.length||!r||!r.length||!d||!d.length||!s||!s.length||!m||!m.length){p.visible=!1;return}t("starts.x"),t("starts.y"),t("starts.z"),t("maxdisplayed"),t("sizeref"),t("lighting.ambient"),t("lighting.diffuse"),t("lighting.specular"),t("lighting.roughness"),t("lighting.fresnel"),t("lightposition.x"),t("lightposition.y"),t("lightposition.z"),k(e,p,a,t,{prefix:"",cLetter:"c"}),t("text"),t("hovertext"),t("hovertemplate"),t("uhoverformat"),t("vhoverformat"),t("whoverformat"),t("xhoverformat"),t("yhoverformat"),t("zhoverformat"),p._length=null}},{"../../components/colorscale/defaults":376,"../../lib":503,"./attributes":1044}],1048:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"streamtube",basePlotModule:c("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:c("./attributes"),supplyDefaults:c("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:c("./calc").calc,plot:c("./convert"),eventData:function(b,k){return b.tubex=b.x,b.tubey=b.y,b.tubez=b.z,b.tubeu=k.traceCoordinate[3],b.tubev=k.traceCoordinate[4],b.tubew=k.traceCoordinate[5],b.norm=k.traceCoordinate[6],b.divergence=k.traceCoordinate[7],delete b.x,delete b.y,delete b.z,b},meta:{}}},{"../../plots/gl3d":598,"./attributes":1044,"./calc":1045,"./convert":1046,"./defaults":1047}],1049:[function(c,ae,ie){"use strict";var b=c("../../plots/attributes"),k=c("../../plots/template_attributes").hovertemplateAttrs,P=c("../../plots/template_attributes").texttemplateAttrs,E=c("../../components/colorscale/attributes"),e=c("../../plots/domain").attributes,p=c("../pie/attributes"),g=c("./constants"),a=c("../../lib/extend").extendFlat;ae.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:a({colors:{valType:"data_array",editType:"calc"},line:{color:a({},p.marker.line.color,{dflt:null}),width:a({},p.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},E("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:p.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:P({editType:"plot"},{keys:g.eventDataKeys.concat(["label","value"])}),hovertext:p.hovertext,hoverinfo:a({},b.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:k({},{keys:g.eventDataKeys}),textfont:p.textfont,insidetextorientation:p.insidetextorientation,insidetextfont:p.insidetextfont,outsidetextfont:a({},p.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:p.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":901,"./constants":1052}],1050:[function(c,ae,ie){"use strict";var b=c("../../plots/plots");ie.name="sunburst",ie.plot=function(k,P,E,e){b.plotBasePlot(ie.name,k,P,E,e)},ie.clean=function(k,P,E,e){b.cleanBasePlot(ie.name,k,P,E,e)}},{"../../plots/plots":619}],1051:[function(c,ae,ie){"use strict";var b=c("d3-hierarchy"),k=c("fast-isnumeric"),P=c("../../lib"),E=c("../../components/colorscale").makeColorScaleFuncFromTrace,e=c("../pie/calc").makePullColorFn,p=c("../pie/calc").generateExtendedColors,g=c("../../components/colorscale").calc,a=c("../../constants/numerical").ALMOST_EQUAL,t={},i={},n={};ie.calc=function(d,s){var m=d._fullLayout,x=s.ids,M=P.isArrayOrTypedArray(x),v=s.labels,_=s.parents,l=s.values,y=P.isArrayOrTypedArray(l),T=[],w={},A={},f=function(H,ee){w[H]?w[H].push(ee):w[H]=[ee],A[ee]=1},u=function(H){return H||typeof H=="number"},h=function(H){return!y||k(l[H])&&l[H]>=0},o,S,R;M?(o=Math.min(x.length,_.length),S=function(H){return u(x[H])&&h(H)},R=function(H){return String(x[H])}):(o=Math.min(v.length,_.length),S=function(H){return u(v[H])&&h(H)},R=function(H){return String(v[H])}),y&&(o=Math.min(o,l.length));for(var z=0;z<o;z++)if(S(z)){var O=R(z),I=u(_[z])?String(_[z]):"",F={i:z,id:O,pid:I,label:u(v[z])?String(v[z]):""};y&&(F.v=+l[z]),T.push(F),f(I,O)}if(w[""]){if(w[""].length>1){for(var U=P.randstr(),X=0;X<T.length;X++)T[X].pid===""&&(T[X].pid=U);T.unshift({hasMultipleRoots:!0,id:U,pid:"",label:""})}}else{var D=[],B;for(B in w)A[B]||D.push(B);if(D.length===1)B=D[0],T.unshift({hasImpliedRoot:!0,id:B,pid:"",label:B});else return P.warn(["Multiple implied roots, cannot build",s.type,"hierarchy of",s.name+".","These roots include:",D.join(", ")].join(" "))}var oe;try{oe=b.stratify().id(function(H){return H.id}).parentId(function(H){return H.pid})(T)}catch(H){return P.warn(["Failed to build",s.type,"hierarchy of",s.name+".","Error:",H.message].join(" "))}var se=b.hierarchy(oe),q=!1;if(y)switch(s.branchvalues){case"remainder":se.sum(function(H){return H.data.v});break;case"total":se.each(function(H){var ee=H.data.data,J=ee.v;if(H.children){var W=H.children.reduce(function(re,j){return re+j.data.data.v},0);if((ee.hasImpliedRoot||ee.hasMultipleRoots)&&(J=W),J<W*a)return q=!0,P.warn(["Total value for node",H.data.data.id,"of",s.name,"is smaller than the sum of its children.",`
parent value =`,J,`
children sum =`,W].join(" "))}H.value=J});break}else r(se,s,{branches:s.count.indexOf("branches")!==-1,leaves:s.count.indexOf("leaves")!==-1});if(!q){s.sort&&se.sort(function(H,ee){return ee.value-H.value});var K,G,Q=s.marker.colors||[],V=!!Q.length;return s._hasColorscale?(V||(Q=y?s.values:s._values),g(d,s,{vals:Q,containerStr:"marker",cLetter:"c"}),G=E(s.marker)):K=e(m["_"+s.type+"colormap"]),se.each(function(H){var ee=H.data.data;ee.color=s._hasColorscale?G(Q[ee.i]):K(Q[ee.i],ee.id)}),T[0].hierarchy=se,T}},ie._runCrossTraceCalc=function(d,s){var m=s._fullLayout,x=s.calcdata,M=m[d+"colorway"],v=m["_"+d+"colormap"];m["extend"+d+"colors"]&&(M=p(M,d==="icicle"?n:d==="treemap"?i:t));var _=0,l;function y(f){var u=f.data.data,h=u.id;u.color===!1&&(v[h]?u.color=v[h]:f.parent?f.parent.parent?u.color=f.parent.data.data.color:(v[h]=u.color=M[_%M.length],_++):u.color=l)}for(var T=0;T<x.length;T++){var w=x[T],A=w[0];A.trace.type===d&&A.hierarchy&&(l=A.trace.root.color,A.hierarchy.each(y))}},ie.crossTraceCalc=function(d){return ie._runCrossTraceCalc("sunburst",d)};function r(d,s,m){var x=0,M=d.children;if(M){for(var v=M.length,_=0;_<v;_++)x+=r(M[_],s,m);m.branches&&x++}else m.leaves&&x++;return d.value=d.data.data.value=x,s._values||(s._values=[]),s._values[d.data.data.i]=x,x}},{"../../components/colorscale":378,"../../constants/numerical":479,"../../lib":503,"../pie/calc":903,"d3-hierarchy":115,"fast-isnumeric":190}],1052:[function(c,ae,ie){"use strict";ae.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1053:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("../../plots/domain").defaults,E=c("../bar/defaults").handleText,e=c("../../components/colorscale"),p=e.hasColorscale,g=e.handleDefaults;ae.exports=function(t,i,n,r){function d(y,T){return b.coerce(t,i,k,y,T)}var s=d("labels"),m=d("parents");if(!s||!s.length||!m||!m.length){i.visible=!1;return}var x=d("values");x&&x.length?d("branchvalues"):d("count"),d("level"),d("maxdepth");var M=d("marker.line.width");M&&d("marker.line.color",r.paper_bgcolor),d("marker.colors");var v=i._hasColorscale=p(t,"marker","colors")||(t.marker||{}).coloraxis;v&&g(t,i,r,d,{prefix:"marker.",cLetter:"c"}),d("leaf.opacity",v?1:.7);var _=d("text");d("texttemplate"),i.texttemplate||d("textinfo",Array.isArray(_)?"text+label":"label"),d("hovertext"),d("hovertemplate");var l="auto";E(t,i,r,d,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),d("insidetextorientation"),d("sort"),d("rotation"),d("root.color"),P(i,r,d),i._length=null}},{"../../components/colorscale":378,"../../lib":503,"../../plots/domain":584,"../bar/defaults":652,"./attributes":1049}],1054:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../registry"),P=c("../../components/fx/helpers").appendArrayPointValue,E=c("../../components/fx"),e=c("../../lib"),p=c("../../lib/events"),g=c("./helpers"),a=c("../pie/helpers"),t=a.formatPieValue;ae.exports=function(r,d,s,m,x){var M=m[0],v=M.trace,_=M.hierarchy,l=v.type==="sunburst",y=v.type==="treemap"||v.type==="icicle";"_hasHoverLabel"in v||(v._hasHoverLabel=!1),"_hasHoverEvent"in v||(v._hasHoverEvent=!1);var T=function(f){var u=s._fullLayout;if(!(s._dragging||u.hovermode===!1)){var h=s._fullData[v.index],o=f.data.data,S=o.i,R=g.isHierarchyRoot(f),z=g.getParent(_,f),O=g.getValue(f),I=function(re){return e.castOption(h,S,re)},F=I("hovertemplate"),D=E.castHoverinfo(h,u,S),B=u.separators,U;if(F||D&&D!=="none"&&D!=="skip"){var X,oe;l&&(X=M.cx+f.pxmid[0]*(1-f.rInscribed),oe=M.cy+f.pxmid[1]*(1-f.rInscribed)),y&&(X=f._hoverX,oe=f._hoverY);var se={},q=[],K=[],G=function(re){return q.indexOf(re)!==-1};D&&(q=D==="all"?h._module.attributes.hoverinfo.flags:D.split("+")),se.label=o.label,G("label")&&se.label&&K.push(se.label),o.hasOwnProperty("v")&&(se.value=o.v,se.valueLabel=t(se.value,B),G("value")&&K.push(se.valueLabel)),se.currentPath=f.currentPath=g.getPath(f.data),G("current path")&&!R&&K.push(se.currentPath);var Q,V=[],H=function(){V.indexOf(Q)===-1&&(K.push(Q),V.push(Q))};se.percentParent=f.percentParent=O/g.getValue(z),se.parent=f.parentString=g.getPtLabel(z),G("percent parent")&&(Q=g.formatPercent(se.percentParent,B)+" of "+se.parent,H()),se.percentEntry=f.percentEntry=O/g.getValue(d),se.entry=f.entry=g.getPtLabel(d),G("percent entry")&&!R&&!f.onPathbar&&(Q=g.formatPercent(se.percentEntry,B)+" of "+se.entry,H()),se.percentRoot=f.percentRoot=O/g.getValue(_),se.root=f.root=g.getPtLabel(_),G("percent root")&&!R&&(Q=g.formatPercent(se.percentRoot,B)+" of "+se.root,H()),se.text=I("hovertext")||I("text"),G("text")&&(Q=se.text,e.isValidTextValue(Q)&&K.push(Q)),U=[i(f,h,x.eventDataKeys)];var ee={trace:h,y:oe,_x0:f._x0,_x1:f._x1,_y0:f._y0,_y1:f._y1,text:K.join("<br>"),name:F||G("name")?h.name:void 0,color:I("hoverlabel.bgcolor")||o.color,borderColor:I("hoverlabel.bordercolor"),fontFamily:I("hoverlabel.font.family"),fontSize:I("hoverlabel.font.size"),fontColor:I("hoverlabel.font.color"),nameLength:I("hoverlabel.namelength"),textAlign:I("hoverlabel.align"),hovertemplate:F,hovertemplateLabels:se,eventData:U};l&&(ee.x0=X-f.rInscribed*f.rpx1,ee.x1=X+f.rInscribed*f.rpx1,ee.idealAlign=f.pxmid[0]<0?"left":"right"),y&&(ee.x=X,ee.idealAlign=X<0?"left":"right");var J=[];E.loneHover(ee,{container:u._hoverlayer.node(),outerContainer:u._paper.node(),gd:s,inOut_bbox:J}),U[0].bbox=J[0],v._hasHoverLabel=!0}if(y){var W=r.select("path.surface");x.styleOne(W,f,h,{hovered:!0})}v._hasHoverEvent=!0,s.emit("plotly_hover",{points:U||[i(f,h,x.eventDataKeys)],event:b.event})}},w=function(f){var u=s._fullLayout,h=s._fullData[v.index],o=b.select(this).datum();if(v._hasHoverEvent&&(f.originalEvent=b.event,s.emit("plotly_unhover",{points:[i(o,h,x.eventDataKeys)],event:b.event}),v._hasHoverEvent=!1),v._hasHoverLabel&&(E.loneUnhover(u._hoverlayer.node()),v._hasHoverLabel=!1),y){var S=r.select("path.surface");x.styleOne(S,o,h,{hovered:!1})}},A=function(f){var u=s._fullLayout,h=s._fullData[v.index],o=l&&(g.isHierarchyRoot(f)||g.isLeaf(f)),S=g.getPtId(f),R=g.isEntry(f)?g.findEntryWithChild(_,S):g.findEntryWithLevel(_,S),z=g.getPtId(R),O={points:[i(f,h,x.eventDataKeys)],event:b.event};o||(O.nextLevel=z);var I=p.triggerHandler(s,"plotly_"+v.type+"click",O);if(I!==!1&&u.hovermode&&(s._hoverdata=[i(f,h,x.eventDataKeys)],E.click(s,b.event)),!o&&I!==!1&&!s._dragging&&!s._transitioning){k.call("_storeDirectGUIEdit",h,u._tracePreGUI[h.uid],{level:h.level});var F={data:[{level:z}],traces:[v.index]},D={frame:{redraw:!1,duration:x.transitionTime},transition:{duration:x.transitionTime,easing:x.transitionEasing},mode:"immediate",fromcurrent:!0};E.loneUnhover(u._hoverlayer.node()),k.call("animate",s,F,D)}};r.on("mouseover",T),r.on("mouseout",w),r.on("click",A)};function i(n,r,d){for(var s=n.data.data,m={curveNumber:r.index,pointNumber:s.i,data:r._input,fullData:r},x=0;x<d.length;x++){var M=d[x];M in n&&(m[M]=n[M])}return"parentString"in n&&!g.isHierarchyRoot(n)&&(m.parent=n.parentString),P(m,r,s.i),m}},{"../../components/fx":406,"../../components/fx/helpers":402,"../../lib":503,"../../lib/events":492,"../../registry":638,"../pie/helpers":906,"./helpers":1055,"@plotly/d3":58}],1055:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color"),P=c("../../lib/setcursor"),E=c("../pie/helpers");ie.findEntryWithLevel=function(a,t){var i;return t&&a.eachAfter(function(n){if(ie.getPtId(n)===t)return i=n.copy()}),i||a},ie.findEntryWithChild=function(a,t){var i;return a.eachAfter(function(n){for(var r=n.children||[],d=0;d<r.length;d++){var s=r[d];if(ie.getPtId(s)===t)return i=n.copy()}}),i||a},ie.isEntry=function(a){return!a.parent},ie.isLeaf=function(a){return!a.children},ie.getPtId=function(a){return a.data.data.id},ie.getPtLabel=function(a){return a.data.data.label},ie.getValue=function(a){return a.value},ie.isHierarchyRoot=function(a){return g(a)===""},ie.setSliceCursor=function(a,t,i){var n=i.isTransitioning;if(!n){var r=a.datum();n=i.hideOnRoot&&ie.isHierarchyRoot(r)||i.hideOnLeaves&&ie.isLeaf(r)}P(a,n?null:"pointer")};function e(a,t,i){return{color:ie.getOutsideTextFontKey("color",a,t,i),family:ie.getOutsideTextFontKey("family",a,t,i),size:ie.getOutsideTextFontKey("size",a,t,i)}}function p(a,t,i,n){var r=(n||{}).onPathbar,d=t.data.data,s=d.i,m=b.castOption(a,s,(r?"pathbar.textfont":"insidetextfont")+".color");return!m&&a._input.textfont&&(m=b.castOption(a._input,s,"textfont.color")),{color:m||k.contrast(d.color),family:ie.getInsideTextFontKey("family",a,t,i,n),size:ie.getInsideTextFontKey("size",a,t,i,n)}}ie.getInsideTextFontKey=function(a,t,i,n,r){var d=(r||{}).onPathbar,s=d?"pathbar.textfont":"insidetextfont",m=i.data.data.i;return b.castOption(t,m,s+"."+a)||b.castOption(t,m,"textfont."+a)||n.size},ie.getOutsideTextFontKey=function(a,t,i,n){var r=i.data.data.i;return b.castOption(t,r,"outsidetextfont."+a)||b.castOption(t,r,"textfont."+a)||n.size},ie.isOutsideText=function(a,t){return!a._hasColorscale&&ie.isHierarchyRoot(t)},ie.determineTextFont=function(a,t,i,n){return ie.isOutsideText(a,t)?e(a,t,i):p(a,t,i,n)},ie.hasTransition=function(a){return!!(a&&a.duration>0)},ie.getMaxDepth=function(a){return a.maxdepth>=0?a.maxdepth:1/0},ie.isHeader=function(a,t){return!(ie.isLeaf(a)||a.depth===t._maxDepth-1)};function g(a){return a.data.data.pid}ie.getParent=function(a,t){return ie.findEntryWithLevel(a,g(t))},ie.listPath=function(a,t){var i=a.parent;if(!i)return[];var n=t?[i.data[t]]:[i];return ie.listPath(i,t).concat(n)},ie.getPath=function(a){return ie.listPath(a,"label").join("/")+"/"},ie.formatValue=E.formatPieValue,ie.formatPercent=function(a,t){var i=b.formatPercent(a,0);return i==="0%"&&(i=E.formatPiePercent(a,t)),i}},{"../../components/color":366,"../../lib":503,"../../lib/setcursor":524,"../pie/helpers":906}],1056:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"sunburst",basePlotModule:c("./base_plot"),categories:[],animatable:!0,attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults"),supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc").calc,crossTraceCalc:c("./calc").crossTraceCalc,plot:c("./plot").plot,style:c("./style").style,colorbar:c("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":945,"./attributes":1049,"./base_plot":1050,"./calc":1051,"./defaults":1053,"./layout_attributes":1057,"./layout_defaults":1058,"./plot":1059,"./style":1060}],1057:[function(c,ae,ie){"use strict";ae.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1058:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(E,e){function p(g,a){return b.coerce(E,e,k,g,a)}p("sunburstcolorway",e.colorway),p("extendsunburstcolors")}},{"../../lib":503,"./layout_attributes":1057}],1059:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("d3-hierarchy"),P=c("d3-interpolate").interpolate,E=c("../../components/drawing"),e=c("../../lib"),p=c("../../lib/svg_text_utils"),g=c("../bar/uniform_text"),a=g.recordMinTextSize,t=g.clearMinTextSize,i=c("../pie/plot"),n=c("../pie/helpers").getRotationAngle,r=i.computeTransform,d=i.transformInsideText,s=c("./style").styleOne,m=c("../bar/style").resizeText,x=c("./fx"),M=c("./constants"),v=c("./helpers");ie.plot=function(A,f,u,h){var o=A._fullLayout,S=o._sunburstlayer,R,z,O=!u,I=!o.uniformtext.mode&&v.hasTransition(u);if(t("sunburst",o),R=S.selectAll("g.trace.sunburst").data(f,function(D){return D[0].trace.uid}),R.enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),R.order(),I){h&&(z=h());var F=b.transition().duration(u.duration).ease(u.easing).each("end",function(){z&&z()}).each("interrupt",function(){z&&z()});F.each(function(){S.selectAll("g.trace").each(function(D){_(A,D,this,u)})})}else R.each(function(D){_(A,D,this,u)}),o.uniformtext.mode&&m(A,o._sunburstlayer.selectAll(".trace"),"sunburst");O&&R.exit().remove()};function _(A,f,u,h){var o=A._fullLayout,S=!o.uniformtext.mode&&v.hasTransition(h),R=b.select(u),z=R.selectAll("g.slice"),O=f[0],I=O.trace,F=O.hierarchy,D=v.findEntryWithLevel(F,I.level),B=v.getMaxDepth(I),U=o._size,X=I.domain,oe=U.w*(X.x[1]-X.x[0]),se=U.h*(X.y[1]-X.y[0]),q=.5*Math.min(oe,se),K=O.cx=U.l+U.w*(X.x[1]+X.x[0])/2,G=O.cy=U.t+U.h*(1-X.y[0])-se/2;if(!D)return z.remove();var Q=null,V={};S&&z.each(function(ye){V[v.getPtId(ye)]={rpx0:ye.rpx0,rpx1:ye.rpx1,x0:ye.x0,x1:ye.x1,transform:ye.transform},!Q&&v.isEntry(ye)&&(Q=ye)});var H=l(D).descendants(),ee=D.height+1,J=0,W=B;O.hasMultipleRoots&&v.isHierarchyRoot(D)&&(H=H.slice(1),ee-=1,J=1,W+=1),H=H.filter(function(ye){return ye.y1<=W});var re=n(I.rotation);re&&H.forEach(function(ye){ye.x0+=re,ye.x1+=re});var j=Math.min(ee,B),Z=function(ye){return(ye-J)/j*q},ne=function(ye,ke){return[ye*Math.cos(ke),-ye*Math.sin(ke)]},le=function(ye){return e.pathAnnulus(ye.rpx0,ye.rpx1,ye.x0,ye.x1,K,G)},ge=function(ye){return K+T(ye)[0]*(ye.transform.rCenter||0)+(ye.transform.x||0)},pe=function(ye){return G+T(ye)[1]*(ye.transform.rCenter||0)+(ye.transform.y||0)};z=z.data(H,v.getPtId),z.enter().append("g").classed("slice",!0),S?z.exit().transition().each(function(){var ye=b.select(this),ke=ye.select("path.surface");ke.transition().attrTween("d",function(Qe){var Ve=de(Qe);return function(Ue){return le(Ve(Ue))}});var Oe=ye.select("g.slicetext");Oe.attr("opacity",0)}).remove():z.exit().remove(),z.order();var xe=null;if(S&&Q){var Ee=v.getPtId(Q);z.each(function(ye){xe===null&&v.getPtId(ye)===Ee&&(xe=ye.x1)})}var Te=z;S&&(Te=Te.transition().each("end",function(){var ye=b.select(this);v.setSliceCursor(ye,A,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),Te.each(function(ye){var ke=b.select(this),Oe=e.ensureSingle(ke,"path","surface",function(pt){pt.style("pointer-events","all")});ye.rpx0=Z(ye.y0),ye.rpx1=Z(ye.y1),ye.xmid=(ye.x0+ye.x1)/2,ye.pxmid=ne(ye.rpx1,ye.xmid),ye.midangle=-(ye.xmid-Math.PI/2),ye.startangle=-(ye.x0-Math.PI/2),ye.stopangle=-(ye.x1-Math.PI/2),ye.halfangle=.5*Math.min(e.angleDelta(ye.x0,ye.x1)||Math.PI,Math.PI),ye.ring=1-ye.rpx0/ye.rpx1,ye.rInscribed=y(ye,I),S?Oe.transition().attrTween("d",function(pt){var Rt=be(pt);return function(Mt){return le(Rt(Mt))}}):Oe.attr("d",le),ke.call(x,D,A,f,{eventDataKeys:M.eventDataKeys,transitionTime:M.CLICK_TRANSITION_TIME,transitionEasing:M.CLICK_TRANSITION_EASING}).call(v.setSliceCursor,A,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:A._transitioning}),Oe.call(s,ye,I);var Qe=e.ensureSingle(ke,"g","slicetext"),Ve=e.ensureSingle(Qe,"text","",function(pt){pt.attr("data-notex",1)}),Ue=e.ensureUniformFontSize(A,v.determineTextFont(I,ye,o.font));Ve.text(ie.formatSliceLabel(ye,D,I,f,o)).classed("slicetext",!0).attr("text-anchor","middle").call(E.font,Ue).call(p.convertToTspans,A);var Ie=E.bBox(Ve.node());ye.transform=d(Ie,ye,O),ye.transform.targetX=ge(ye),ye.transform.targetY=pe(ye);var at=function(pt,Rt){var Mt=pt.transform;return r(Mt,Rt),Mt.fontSize=Ue.size,a(I.type,Mt,o),e.getTextTransform(Mt)};S?Ve.transition().attrTween("transform",function(pt){var Rt=Le(pt);return function(Mt){return at(Rt(Mt),Ie)}}):Ve.attr("transform",at(ye,Ie))});function de(ye){var ke=v.getPtId(ye),Oe=V[ke],Qe=V[v.getPtId(D)],Ve;if(Qe){var Ue=(ye.x1>Qe.x1?2*Math.PI:0)+re;Ve=ye.rpx1<Qe.rpx1?{x0:ye.x0,x1:ye.x1,rpx0:0,rpx1:0}:{x0:Ue,x1:Ue,rpx0:ye.rpx0,rpx1:ye.rpx1}}else{var Ie,at=v.getPtId(ye.parent);z.each(function(Bt){if(v.getPtId(Bt)===at)return Ie=Bt});var pt=Ie.children,Rt;pt.forEach(function(Bt,St){if(v.getPtId(Bt)===ke)return Rt=St});var Mt=pt.length,It=P(Ie.x0,Ie.x1);Ve={rpx0:q,rpx1:q,x0:It(Rt/Mt),x1:It((Rt+1)/Mt)}}return P(Oe,Ve)}function be(ye){var ke=V[v.getPtId(ye)],Oe,Qe={x0:ye.x0,x1:ye.x1,rpx0:ye.rpx0,rpx1:ye.rpx1};if(ke)Oe=ke;else if(Q)if(ye.parent)if(xe){var Ve=(ye.x1>xe?2*Math.PI:0)+re;Oe={x0:Ve,x1:Ve}}else Oe={rpx0:q,rpx1:q},e.extendFlat(Oe,De(ye));else Oe={rpx0:0,rpx1:0};else Oe={x0:re,x1:re};return P(Oe,Qe)}function Le(ye){var ke=V[v.getPtId(ye)],Oe,Qe=ye.transform;if(ke)Oe=ke;else if(Oe={rpx1:ye.rpx1,transform:{textPosAngle:Qe.textPosAngle,scale:0,rotate:Qe.rotate,rCenter:Qe.rCenter,x:Qe.x,y:Qe.y}},Q)if(ye.parent)if(xe){var Ve=ye.x1>xe?2*Math.PI:0;Oe.x0=Oe.x1=Ve}else e.extendFlat(Oe,De(ye));else Oe.x0=Oe.x1=re;else Oe.x0=Oe.x1=re;var Ue=P(Oe.transform.textPosAngle,ye.transform.textPosAngle),Ie=P(Oe.rpx1,ye.rpx1),at=P(Oe.x0,ye.x0),pt=P(Oe.x1,ye.x1),Rt=P(Oe.transform.scale,Qe.scale),Mt=P(Oe.transform.rotate,Qe.rotate),It=Qe.rCenter===0?3:Oe.transform.rCenter===0?1/3:1,Bt=P(Oe.transform.rCenter,Qe.rCenter),St=function(_t){return Bt(Math.pow(_t,It))};return function(_t){var it=Ie(_t),ct=at(_t),et=pt(_t),Pe=St(_t),We=ne(it,(ct+et)/2),je=Ue(_t),nt={pxmid:We,rpx1:it,transform:{textPosAngle:je,rCenter:Pe,x:Qe.x,y:Qe.y}};return a(I.type,Qe,o),{transform:{targetX:ge(nt),targetY:pe(nt),scale:Rt(_t),rotate:Mt(_t),rCenter:Pe}}}}function De(ye){var ke=ye.parent,Oe=V[v.getPtId(ke)],Qe={};if(Oe){var Ve=ke.children,Ue=Ve.indexOf(ye),Ie=Ve.length,at=P(Oe.x0,Oe.x1);Qe.x0=at(Ue/Ie),Qe.x1=at(Ue/Ie)}else Qe.x0=Qe.x1=0;return Qe}}function l(A){return k.partition().size([2*Math.PI,A.height+1])(A)}ie.formatSliceLabel=function(A,f,u,h,o){var S=u.texttemplate,R=u.textinfo;if(!S&&(!R||R==="none"))return"";var z=o.separators,O=h[0],I=A.data.data,F=O.hierarchy,D=v.isHierarchyRoot(A),B=v.getParent(F,A),U=v.getValue(A);if(!S){var X=R.split("+"),oe=function(W){return X.indexOf(W)!==-1},se=[],q;if(oe("label")&&I.label&&se.push(I.label),I.hasOwnProperty("v")&&oe("value")&&se.push(v.formatValue(I.v,z)),!D){oe("current path")&&se.push(v.getPath(A.data));var K=0;oe("percent parent")&&K++,oe("percent entry")&&K++,oe("percent root")&&K++;var G=K>1;if(K){var Q,V=function(W){q=v.formatPercent(Q,z),G&&(q+=" of "+W),se.push(q)};oe("percent parent")&&!D&&(Q=U/v.getValue(B),V("parent")),oe("percent entry")&&(Q=U/v.getValue(f),V("entry")),oe("percent root")&&(Q=U/v.getValue(F),V("root"))}}return oe("text")&&(q=e.castOption(u,I.i,"text"),e.isValidTextValue(q)&&se.push(q)),se.join("<br>")}var H=e.castOption(u,I.i,"texttemplate");if(!H)return"";var ee={};I.label&&(ee.label=I.label),I.hasOwnProperty("v")&&(ee.value=I.v,ee.valueLabel=v.formatValue(I.v,z)),ee.currentPath=v.getPath(A.data),D||(ee.percentParent=U/v.getValue(B),ee.percentParentLabel=v.formatPercent(ee.percentParent,z),ee.parent=v.getPtLabel(B)),ee.percentEntry=U/v.getValue(f),ee.percentEntryLabel=v.formatPercent(ee.percentEntry,z),ee.entry=v.getPtLabel(f),ee.percentRoot=U/v.getValue(F),ee.percentRootLabel=v.formatPercent(ee.percentRoot,z),ee.root=v.getPtLabel(F),I.hasOwnProperty("color")&&(ee.color=I.color);var J=e.castOption(u,I.i,"text");return(e.isValidTextValue(J)||J==="")&&(ee.text=J),ee.customdata=e.castOption(u,I.i,"customdata"),e.texttemplateString(H,ee,o._d3locale,ee,u._meta||{})};function y(A){return A.rpx0===0&&e.isFullCircle([A.x0,A.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(A.halfangle)),A.ring/2))}function T(A){return w(A.rpx1,A.transform.textPosAngle)}function w(A,f){return[A*Math.sin(f),-A*Math.cos(f)]}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../bar/style":662,"../bar/uniform_text":664,"../pie/helpers":906,"../pie/plot":910,"./constants":1052,"./fx":1054,"./helpers":1055,"./style":1060,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1060:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/color"),P=c("../../lib"),E=c("../bar/uniform_text").resizeText;function e(g){var a=g._fullLayout._sunburstlayer.selectAll(".trace");E(g,a,"sunburst"),a.each(function(t){var i=b.select(this),n=t[0],r=n.trace;i.style("opacity",r.opacity),i.selectAll("path.surface").each(function(d){b.select(this).call(p,d,r)})})}function p(g,a,t){var i=a.data.data,n=!a.children,r=i.i,d=P.castOption(t,r,"marker.line.color")||k.defaultLine,s=P.castOption(t,r,"marker.line.width")||0;g.style("stroke-width",s).call(k.fill,i.color).call(k.stroke,d).style("opacity",n?t.leaf.opacity:null)}ae.exports={style:e,styleOne:p}},{"../../components/color":366,"../../lib":503,"../bar/uniform_text":664,"@plotly/d3":58}],1061:[function(c,ae,ie){"use strict";var b=c("../../components/color"),k=c("../../components/colorscale/attributes"),P=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,E=c("../../plots/template_attributes").hovertemplateAttrs,e=c("../../plots/attributes"),p=c("../../lib/extend").extendFlat,g=c("../../plot_api/edit_types").overrideAll;function a(n){return{valType:"boolean",dflt:!1}}function t(n){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:a("x"),y:a("y"),z:a("z")},color:{valType:"color",dflt:b.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:b.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var i=ae.exports=g(p({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:E(),xhoverformat:P("x"),yhoverformat:P("y"),zhoverformat:P("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},k("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:t("x"),y:t("y"),z:t("z")},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:p({},k.zauto,{}),zmin:p({},k.zmin,{}),zmax:p({},k.zmax,{})},hoverinfo:p({},e.hoverinfo),showlegend:p({},e.showlegend,{dflt:!1})}),"calc","nested");i.x.editType=i.y.editType=i.z.editType="calc+clearAxisTypes",i.transforms=void 0},{"../../components/color":366,"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633}],1062:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/calc");ae.exports=function(P,E){E.surfacecolor?b(P,E,{vals:E.surfacecolor,containerStr:"",cLetter:"c"}):b(P,E,{vals:E.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":374}],1063:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_surface3d,k=c("../../../stackgl_modules").ndarray,P=c("../../../stackgl_modules").ndarray_linear_interpolate.d2,E=c("../heatmap/interp2d"),e=c("../heatmap/find_empties"),p=c("../../lib").isArrayOrTypedArray,g=c("../../lib/gl_format_color").parseColorScale,a=c("../../lib/str2rgbarray"),t=c("../../components/colorscale").extractOpts;function i(h,o,S){this.scene=h,this.uid=S,this.surface=o,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var n=i.prototype;n.getXat=function(h,o,S,R){var z=p(this.data.x)?p(this.data.x[0])?this.data.x[o][h]:this.data.x[h]:h;return S===void 0?z:R.d2l(z,0,S)},n.getYat=function(h,o,S,R){var z=p(this.data.y)?p(this.data.y[0])?this.data.y[o][h]:this.data.y[o]:o;return S===void 0?z:R.d2l(z,0,S)},n.getZat=function(h,o,S,R){var z=this.data.z[o][h];return z===null&&this.data.connectgaps&&this.data._interpolatedZ&&(z=this.data._interpolatedZ[o][h]),S===void 0?z:R.d2l(z,0,S)},n.handlePick=function(h){if(h.object===this.surface){var o=(h.data.index[0]-1)/this.dataScaleX-1,S=(h.data.index[1]-1)/this.dataScaleY-1,R=Math.max(Math.min(Math.round(o),this.data.z[0].length-1),0),z=Math.max(Math.min(Math.round(S),this.data._ylength-1),0);h.index=[R,z],h.traceCoordinate=[this.getXat(R,z),this.getYat(R,z),this.getZat(R,z)],h.dataCoordinate=[this.getXat(R,z,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(R,z,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(R,z,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var O=0;O<3;O++){var I=h.dataCoordinate[O];I!=null&&(h.dataCoordinate[O]*=this.scene.dataScale[O])}var F=this.data.hovertext||this.data.text;return Array.isArray(F)&&F[z]&&F[z][R]!==void 0?h.textLabel=F[z][R]:F?h.textLabel=F:h.textLabel="",h.data.dataCoordinate=h.dataCoordinate.slice(),this.surface.highlight(h.data),this.scene.glplot.spikes.position=h.dataCoordinate,!0}};function r(h){var o=h[0].rgb,S=h[h.length-1].rgb;return o[0]===S[0]&&o[1]===S[1]&&o[2]===S[2]&&o[3]===S[3]}var d=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function s(h,o){if(h<o)return 0;for(var S=0;Math.floor(h%o)===0;)h/=o,S++;return S}function m(h){for(var o=[],S=0;S<d.length;S++){var R=d[S];o.push(s(h,R))}return o}function x(h){for(var o=m(h),S=h,R=0;R<d.length;R++)if(o[R]>0){S=d[R];break}return S}function M(h,o){if(!(h<1||o<1)){for(var S=m(h),R=m(o),z=1,O=0;O<d.length;O++)z*=Math.pow(d[O],Math.max(S[O],R[O]));return z}}function v(h){if(h.length!==0){for(var o=1,S=0;S<h.length;S++)o=M(o,h[S]);return o}}n.calcXnums=function(h){var o,S=[];for(o=1;o<h;o++){var R=this.getXat(o-1,0),z=this.getXat(o,0);z!==R&&R!==void 0&&R!==null&&z!==void 0&&z!==null?S[o-1]=Math.abs(z-R):S[o-1]=0}var O=0;for(o=1;o<h;o++)O+=S[o-1];for(o=1;o<h;o++)S[o-1]===0?S[o-1]=1:S[o-1]=Math.round(O/S[o-1]);return S},n.calcYnums=function(h){var o,S=[];for(o=1;o<h;o++){var R=this.getYat(0,o-1),z=this.getYat(0,o);z!==R&&R!==void 0&&R!==null&&z!==void 0&&z!==null?S[o-1]=Math.abs(z-R):S[o-1]=0}var O=0;for(o=1;o<h;o++)O+=S[o-1];for(o=1;o<h;o++)S[o-1]===0?S[o-1]=1:S[o-1]=Math.round(O/S[o-1]);return S};var _=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],l=_[9],y=_[13];n.estimateScale=function(h,o){for(var S=o===0?this.calcXnums(h):this.calcYnums(h),R=1+v(S);R<l;)R*=2;for(;R>y;)R--,R/=x(R),R++,R<l&&(R=y);var z=Math.round(R/h);return z>1?z:1};function T(h,o,S){var R=S[8]+S[2]*o[0]+S[5]*o[1];return h[0]=(S[6]+S[0]*o[0]+S[3]*o[1])/R,h[1]=(S[7]+S[1]*o[0]+S[4]*o[1])/R,h}function w(h,o,S){return A(h,o,T,S),h}function A(h,o,S,R){for(var z=[0,0],O=h.shape[0],I=h.shape[1],F=0;F<O;F++)for(var D=0;D<I;D++)S(z,[F,D],R),h.set(F,D,P(o,z[0],z[1]));return h}n.refineCoords=function(h){for(var o=this.dataScaleX,S=this.dataScaleY,R=h[0].shape[0],z=h[0].shape[1],O=Math.floor(h[0].shape[0]*o+1)|0,I=Math.floor(h[0].shape[1]*S+1)|0,F=1+R+1,D=1+z+1,B=k(new Float32Array(F*D),[F,D]),U=[1/o,0,0,0,1/S,0,0,0,1],X=0;X<h.length;++X){this.surface.padField(B,h[X]);var oe=k(new Float32Array(O*I),[O,I]);w(oe,B,U),h[X]=oe}};function f(h,o){for(var S=!1,R=0;R<h.length;R++)if(o===h[R]){S=!0;break}S===!1&&h.push(o)}n.setContourLevels=function(){var h=[[],[],[]],o=[!1,!1,!1],S=!1,R,z,O;for(R=0;R<3;++R)if(this.showContour[R]&&(S=!0,this.contourSize[R]>0&&this.contourStart[R]!==null&&this.contourEnd[R]!==null&&this.contourEnd[R]>this.contourStart[R]))for(o[R]=!0,z=this.contourStart[R];z<this.contourEnd[R];z+=this.contourSize[R])O=z*this.scene.dataScale[R],f(h[R],O);if(S){var I=[[],[],[]];for(R=0;R<3;++R)this.showContour[R]&&(I[R]=o[R]?h[R]:this.scene.contourLevels[R]);this.surface.update({levels:I})}},n.update=function(h){var o=this.scene,S=o.fullSceneLayout,R=this.surface,z=g(h),O=o.dataScale,I=h.z[0].length,F=h._ylength,D=o.contourLevels;this.data=h;var B,U,X,oe,se=[];for(B=0;B<3;B++)for(se[B]=[],U=0;U<I;U++)se[B][U]=[];for(U=0;U<I;U++)for(X=0;X<F;X++)se[0][U][X]=this.getXat(U,X,h.xcalendar,S.xaxis),se[1][U][X]=this.getYat(U,X,h.ycalendar,S.yaxis),se[2][U][X]=this.getZat(U,X,h.zcalendar,S.zaxis);if(h.connectgaps)for(h._emptypoints=e(se[2]),E(se[2],h._emptypoints),h._interpolatedZ=[],U=0;U<I;U++)for(h._interpolatedZ[U]=[],X=0;X<F;X++)h._interpolatedZ[U][X]=se[2][U][X];for(B=0;B<3;B++)for(U=0;U<I;U++)for(X=0;X<F;X++)oe=se[B][U][X],oe==null?se[B][U][X]=NaN:oe=se[B][U][X]*=O[B];for(B=0;B<3;B++)for(U=0;U<I;U++)for(X=0;X<F;X++)oe=se[B][U][X],oe!=null&&(this.minValues[B]>oe&&(this.minValues[B]=oe),this.maxValues[B]<oe&&(this.maxValues[B]=oe));for(B=0;B<3;B++)this.objectOffset[B]=.5*(this.minValues[B]+this.maxValues[B]);for(B=0;B<3;B++)for(U=0;U<I;U++)for(X=0;X<F;X++)oe=se[B][U][X],oe!=null&&(se[B][U][X]-=this.objectOffset[B]);var q=[k(new Float32Array(I*F),[I,F]),k(new Float32Array(I*F),[I,F]),k(new Float32Array(I*F),[I,F])];for(B=0;B<3;B++)for(U=0;U<I;U++)for(X=0;X<F;X++)q[B].set(U,X,se[B][U][X]);se=[];var K={colormap:z,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!h.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:h.opacityscale,opacity:h.opacity},G=t(h);if(K.intensityBounds=[G.min,G.max],h.surfacecolor){var Q=k(new Float32Array(I*F),[I,F]);for(U=0;U<I;U++)for(X=0;X<F;X++)Q.set(U,X,h.surfacecolor[X][U]);q.push(Q)}else K.intensityBounds[0]*=O[2],K.intensityBounds[1]*=O[2];(y<q[0].shape[0]||y<q[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(q[0].shape[0],0),this.dataScaleY=this.estimateScale(q[0].shape[1],1),(this.dataScaleX!==1||this.dataScaleY!==1)&&this.refineCoords(q)),h.surfacecolor&&(K.intensity=q.pop());var V=[!0,!0,!0],H=["x","y","z"];for(B=0;B<3;++B){var ee=h.contours[H[B]];V[B]=ee.highlight,K.showContour[B]=ee.show||ee.highlight,K.showContour[B]&&(K.contourProject[B]=[ee.project.x,ee.project.y,ee.project.z],ee.show?(this.showContour[B]=!0,K.levels[B]=D[B],R.highlightColor[B]=K.contourColor[B]=a(ee.color),ee.usecolormap?R.highlightTint[B]=K.contourTint[B]=0:R.highlightTint[B]=K.contourTint[B]=1,K.contourWidth[B]=ee.width,this.contourStart[B]=ee.start,this.contourEnd[B]=ee.end,this.contourSize[B]=ee.size):(this.showContour[B]=!1,this.contourStart[B]=null,this.contourEnd[B]=null,this.contourSize[B]=0),ee.highlight&&(K.dynamicColor[B]=a(ee.highlightcolor),K.dynamicWidth[B]=ee.highlightwidth))}r(z)&&(K.vertexColor=!0),K.objectOffset=this.objectOffset,K.coords=q,R.update(K),R.visible=h.visible,R.enableDynamic=V,R.enableHighlight=V,R.snapToData=!0,"lighting"in h&&(R.ambientLight=h.lighting.ambient,R.diffuseLight=h.lighting.diffuse,R.specularLight=h.lighting.specular,R.roughness=h.lighting.roughness,R.fresnel=h.lighting.fresnel),"lightposition"in h&&(R.lightPosition=[h.lightposition.x,h.lightposition.y,h.lightposition.z])},n.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()};function u(h,o){var S=h.glplot.gl,R=b({gl:S}),z=new i(h,R,o.uid);return R._trace=z,z.update(o),h.glplot.add(R),z}ae.exports=u},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib":503,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../heatmap/find_empties":798,"../heatmap/interp2d":801}],1064:[function(c,ae,ie){"use strict";var b=c("../../registry"),k=c("../../lib"),P=c("../../components/colorscale/defaults"),E=c("./attributes"),e=.1;function p(n,r){for(var d=[],s=32,m=0;m<s;m++){var x=m/(s-1),M=r+(1-r)*(1-Math.pow(Math.sin(n*x*Math.PI),2));d.push([x,Math.max(0,Math.min(1,M))])}return d}function g(n){var r=0;if(!Array.isArray(n)||n.length<2||!n[0]||!n[n.length-1]||+n[0][0]!=0||+n[n.length-1][0]!=1)return!1;for(var d=0;d<n.length;d++){var s=n[d];if(s.length!==2||+s[0]<r)return!1;r=+s[0]}return!0}function a(n,r,d,s){var m,x;function M(h,o){return k.coerce(n,r,E,h,o)}var v=M("x"),_=M("y"),l=M("z");if(!l||!l.length||(v?v.length<1:!1)||(_?_.length<1:!1)){r.visible=!1;return}r._xlength=Array.isArray(v)&&k.isArrayOrTypedArray(v[0])?l.length:l[0].length,r._ylength=l.length;var y=b.getComponentMethod("calendars","handleTraceDefaults");y(n,r,["x","y","z"],s),M("text"),M("hovertext"),M("hovertemplate"),M("xhoverformat"),M("yhoverformat"),M("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(h){M(h)});var T=M("surfacecolor"),w=["x","y","z"];for(m=0;m<3;++m){var A="contours."+w[m],f=M(A+".show"),u=M(A+".highlight");if(f||u)for(x=0;x<3;++x)M(A+".project."+w[x]);f&&(M(A+".color"),M(A+".width"),M(A+".usecolormap")),u&&(M(A+".highlightcolor"),M(A+".highlightwidth")),M(A+".start"),M(A+".end"),M(A+".size")}T||(i(n,"zmin","cmin"),i(n,"zmax","cmax"),i(n,"zauto","cauto")),P(n,r,s,M,{prefix:"",cLetter:"c"}),t(n,r,s,M),r._length=null}function t(n,r,d,s){var m=s("opacityscale");m==="max"?r.opacityscale=[[0,e],[1,1]]:m==="min"?r.opacityscale=[[0,1],[1,e]]:m==="extremes"?r.opacityscale=p(1,e):g(m)||(r.opacityscale=void 0)}function i(n,r,d){r in n&&!(d in n)&&(n[d]=n[r])}ae.exports={supplyDefaults:a,opacityscaleDefaults:t}},{"../../components/colorscale/defaults":376,"../../lib":503,"../../registry":638,"./attributes":1061}],1065:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:c("./calc"),plot:c("./convert"),moduleType:"trace",name:"surface",basePlotModule:c("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":598,"./attributes":1061,"./calc":1062,"./convert":1063,"./defaults":1064}],1066:[function(c,ae,ie){"use strict";var b=c("../../components/annotations/attributes"),k=c("../../lib/extend").extendFlat,P=c("../../plot_api/edit_types").overrideAll,E=c("../../plots/font_attributes"),e=c("../../plots/domain").attributes,p=c("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,g=ae.exports=P({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:p("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:k({},b.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:k({},E({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:p("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:k({},b.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:k({},E({arrayOk:!0}))}},"calc","from-root");g.transforms=void 0},{"../../components/annotations/attributes":349,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/cartesian/axis_format_attributes":557,"../../plots/domain":584,"../../plots/font_attributes":585}],1067:[function(c,ae,ie){"use strict";var b=c("../../plots/get_data").getModuleCalcData,k=c("./plot"),P="table";ie.name=P,ie.plot=function(E){var e=b(E.calcdata,P)[0];e.length&&k(E,e)},ie.clean=function(E,e,p,g){var a=g._has&&g._has(P),t=e._has&&e._has(P);a&&!t&&g._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":593,"./plot":1074}],1068:[function(c,ae,ie){"use strict";var b=c("../../lib/gup").wrap;ae.exports=function(){return b({})}},{"../../lib/gup":500}],1069:[function(c,ae,ie){"use strict";ae.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1070:[function(c,ae,ie){"use strict";var b=c("./constants"),k=c("../../lib/extend").extendFlat,P=c("fast-isnumeric");ae.exports=function(d,s){var m=p(s.cells.values),x=function(U){return U.slice(s.header.values.length,U.length)},M=p(s.header.values);M.length&&!M[0].length&&(M[0]=[""],M=p(M));var v=M.concat(x(m).map(function(){return g((M[0]||[""]).length)})),_=s.domain,l=Math.floor(d._fullLayout._size.w*(_.x[1]-_.x[0])),y=Math.floor(d._fullLayout._size.h*(_.y[1]-_.y[0])),T=s.header.values.length?v[0].map(function(){return s.header.height}):[b.emptyHeaderHeight],w=m.length?m[0].map(function(){return s.cells.height}):[],A=T.reduce(e,0),f=y-A,u=f+b.uplift,h=i(w,u),o=i(T,A),S=t(o,[]),R=t(h,S),z={},O=s._fullInput.columnorder.concat(x(m.map(function(U,X){return X}))),I=v.map(function(U,X){var oe=Array.isArray(s.columnwidth)?s.columnwidth[Math.min(X,s.columnwidth.length-1)]:s.columnwidth;return P(oe)?Number(oe):1}),F=I.reduce(e,0);I=I.map(function(U){return U/F*l});var D=Math.max(E(s.header.line.width),E(s.cells.line.width)),B={key:s.uid+d._context.staticPlot,translateX:_.x[0]*d._fullLayout._size.w,translateY:d._fullLayout._size.h*(1-_.y[1]),size:d._fullLayout._size,width:l,maxLineWidth:D,height:y,columnOrder:O,groupHeight:y,rowBlocks:R,headerRowBlocks:S,scrollY:0,cells:k({},s.cells,{values:m}),headerCells:k({},s.header,{values:v}),gdColumns:v.map(function(U){return U[0]}),gdColumnsOriginalOrder:v.map(function(U){return U[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:v.map(function(U,X){var oe=z[U];z[U]=(oe||0)+1;var se=U+"__"+z[U];return{key:se,label:U,specIndex:X,xIndex:O[X],xScale:a,x:void 0,calcdata:void 0,columnWidth:I[X]}})};return B.columns.forEach(function(U){U.calcdata=B,U.x=a(U)}),B};function E(r){if(Array.isArray(r)){for(var d=0,s=0;s<r.length;s++)d=Math.max(d,E(r[s]));return d}return r}function e(r,d){return r+d}function p(r){var d=r.slice(),s=1/0,m=0,x;for(x=0;x<d.length;x++)Array.isArray(d[x])||(d[x]=[d[x]]),s=Math.min(s,d[x].length),m=Math.max(m,d[x].length);if(s!==m)for(x=0;x<d.length;x++){var M=m-d[x].length;M&&(d[x]=d[x].concat(g(M)))}return d}function g(r){for(var d=new Array(r),s=0;s<r;s++)d[s]="";return d}function a(r){return r.calcdata.columns.reduce(function(d,s){return s.xIndex<r.xIndex?d+s.columnWidth:d},0)}function t(r,d){var s=Object.keys(r);return s.map(function(m){return k({},r[m],{auxiliaryBlocks:d})})}function i(r,d){for(var s={},m,x=0,M=0,v=n(),_=0,l=0,y=0;y<r.length;y++)m=r[y],v.rows.push({rowIndex:y,rowHeight:m}),M+=m,(M>=d||y===r.length-1)&&(s[x]=v,v.key=l++,v.firstRowIndex=_,v.lastRowIndex=y,v=n(),x+=M,_=y+1,M=0);return s}function n(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}},{"../../lib/extend":493,"./constants":1069,"fast-isnumeric":190}],1071:[function(c,ae,ie){"use strict";var b=c("../../lib/extend").extendFlat;ie.splitToPanels=function(P){var E=[0,0],e=b({},P,{key:"header",type:"header",page:0,prevPages:E,currentRepaint:[null,null],dragHandle:!0,values:P.calcdata.headerCells.values[P.specIndex],rowBlocks:P.calcdata.headerRowBlocks,calcdata:b({},P.calcdata,{cells:P.calcdata.headerCells})}),p=b({},P,{key:"cells1",type:"cells",page:0,prevPages:E,currentRepaint:[null,null],dragHandle:!1,values:P.calcdata.cells.values[P.specIndex],rowBlocks:P.calcdata.rowBlocks}),g=b({},P,{key:"cells2",type:"cells",page:1,prevPages:E,currentRepaint:[null,null],dragHandle:!1,values:P.calcdata.cells.values[P.specIndex],rowBlocks:P.calcdata.rowBlocks});return[p,g,e]},ie.splitToCells=function(P){var E=k(P);return(P.values||[]).slice(E[0],E[1]).map(function(e,p){var g=typeof e=="string"&&e.match(/[<$&> ]/)?"_keybuster_"+Math.random():"";return{keyWithinBlock:p+g,key:E[0]+p,column:P,calcdata:P.calcdata,page:P.page,rowBlocks:P.rowBlocks,value:e}})};function k(P){var E=P.rowBlocks[P.page],e=E?E.rows[0].rowIndex:0,p=E?e+E.rows.length:0;return[e,p]}},{"../../lib/extend":493}],1072:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("../../plots/domain").defaults;function E(e,p){for(var g=e.columnorder||[],a=e.header.values.length,t=g.slice(0,a),i=t.slice().sort(function(d,s){return d-s}),n=t.map(function(d){return i.indexOf(d)}),r=n.length;r<a;r++)n.push(r);p("columnorder",n)}ae.exports=function(p,g,a,t){function i(n,r){return b.coerce(p,g,k,n,r)}P(g,t,i),i("columnwidth"),i("header.values"),i("header.format"),i("header.align"),i("header.prefix"),i("header.suffix"),i("header.height"),i("header.line.width"),i("header.line.color"),i("header.fill.color"),b.coerceFont(i,"header.font",b.extendFlat({},t.font)),E(g,i),i("cells.values"),i("cells.format"),i("cells.align"),i("cells.prefix"),i("cells.suffix"),i("cells.height"),i("cells.line.width"),i("cells.line.color"),i("cells.fill.color"),b.coerceFont(i,"cells.font",b.extendFlat({},t.font)),g._length=null}},{"../../lib":503,"../../plots/domain":584,"./attributes":1066}],1073:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("./calc"),plot:c("./plot"),moduleType:"trace",name:"table",basePlotModule:c("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1066,"./base_plot":1067,"./calc":1068,"./defaults":1072,"./plot":1074}],1074:[function(c,ae,ie){"use strict";var b=c("./constants"),k=c("@plotly/d3"),P=c("../../lib"),E=P.numberFormat,e=c("../../lib/gup"),p=c("../../components/drawing"),g=c("../../lib/svg_text_utils"),a=c("../../lib").raiseToTop,t=c("../../lib").strTranslate,i=c("../../lib").cancelTransition,n=c("./data_preparation_helper"),r=c("./data_split_helpers"),d=c("../../components/color");ae.exports=function(j,Z){var ne=!j._context.staticPlot,le=j._fullLayout._paper.selectAll("."+b.cn.table).data(Z.map(function(Ve){var Ue=e.unwrap(Ve),Ie=Ue.trace;return n(j,Ie)}),e.keyFun);le.exit().remove(),le.enter().append("g").classed(b.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),le.attr("width",function(Ve){return Ve.width+Ve.size.l+Ve.size.r}).attr("height",function(Ve){return Ve.height+Ve.size.t+Ve.size.b}).attr("transform",function(Ve){return t(Ve.translateX,Ve.translateY)});var ge=le.selectAll("."+b.cn.tableControlView).data(e.repeat,e.keyFun),pe=ge.enter().append("g").classed(b.cn.tableControlView,!0).style("box-sizing","content-box");if(ne){var xe="onwheel"in document?"wheel":"mousewheel";pe.on("mousemove",function(Ve){ge.filter(function(Ue){return Ve===Ue}).call(v,j)}).on(xe,function(Ve){if(!Ve.scrollbarState.wheeling){Ve.scrollbarState.wheeling=!0;var Ue=Ve.scrollY+k.event.deltaY,Ie=oe(j,ge,null,Ue)(Ve);Ie||(k.event.stopPropagation(),k.event.preventDefault()),Ve.scrollbarState.wheeling=!1}}).call(v,j,!0)}ge.attr("transform",function(Ve){return t(Ve.size.l,Ve.size.t)});var Ee=ge.selectAll("."+b.cn.scrollBackground).data(e.repeat,e.keyFun);Ee.enter().append("rect").classed(b.cn.scrollBackground,!0).attr("fill","none"),Ee.attr("width",function(Ve){return Ve.width}).attr("height",function(Ve){return Ve.height}),ge.each(function(Ve){p.setClipUrl(k.select(this),m(j,Ve),j)});var Te=ge.selectAll("."+b.cn.yColumn).data(function(Ve){return Ve.columns},e.keyFun);Te.enter().append("g").classed(b.cn.yColumn,!0),Te.exit().remove(),Te.attr("transform",function(Ve){return t(Ve.x,0)}),ne&&Te.call(k.behavior.drag().origin(function(Ve){var Ue=k.select(this);return I(Ue,Ve,-b.uplift),a(this),Ve.calcdata.columnDragInProgress=!0,v(ge.filter(function(Ie){return Ve.calcdata.key===Ie.key}),j),Ve}).on("drag",function(Ve){var Ue=k.select(this),Ie=function(Rt){return(Ve===Rt?k.event.x:Rt.x)+Rt.columnWidth/2};Ve.x=Math.max(-b.overdrag,Math.min(Ve.calcdata.width+b.overdrag-Ve.columnWidth,k.event.x));var at=M(Te).filter(function(Rt){return Rt.calcdata.key===Ve.calcdata.key}),pt=at.sort(function(Rt,Mt){return Ie(Rt)-Ie(Mt)});pt.forEach(function(Rt,Mt){Rt.xIndex=Mt,Rt.x=Ve===Rt?Rt.x:Rt.xScale(Rt)}),Te.filter(function(Rt){return Ve!==Rt}).transition().ease(b.transitionEase).duration(b.transitionDuration).attr("transform",function(Rt){return t(Rt.x,0)}),Ue.call(i).attr("transform",t(Ve.x,-b.uplift))}).on("dragend",function(Ve){var Ue=k.select(this),Ie=Ve.calcdata;Ve.x=Ve.xScale(Ve),Ve.calcdata.columnDragInProgress=!1,I(Ue,Ve,0),z(j,Ie,Ie.columns.map(function(at){return at.xIndex}))})),Te.each(function(Ve){p.setClipUrl(k.select(this),x(j,Ve),j)});var de=Te.selectAll("."+b.cn.columnBlock).data(r.splitToPanels,e.keyFun);de.enter().append("g").classed(b.cn.columnBlock,!0).attr("id",function(Ve){return Ve.key}),de.style("cursor",function(Ve){return Ve.dragHandle?"ew-resize":Ve.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var be=de.filter(D),Le=de.filter(F);ne&&Le.call(k.behavior.drag().origin(function(Ve){return k.event.stopPropagation(),Ve}).on("drag",oe(j,ge,-1)).on("dragend",function(){})),_(j,ge,be,de),_(j,ge,Le,de);var De=ge.selectAll("."+b.cn.scrollAreaClip).data(e.repeat,e.keyFun);De.enter().append("clipPath").classed(b.cn.scrollAreaClip,!0).attr("id",function(Ve){return m(j,Ve)});var ye=De.selectAll("."+b.cn.scrollAreaClipRect).data(e.repeat,e.keyFun);ye.enter().append("rect").classed(b.cn.scrollAreaClipRect,!0).attr("x",-b.overdrag).attr("y",-b.uplift).attr("fill","none"),ye.attr("width",function(Ve){return Ve.width+2*b.overdrag}).attr("height",function(Ve){return Ve.height+b.uplift});var ke=Te.selectAll("."+b.cn.columnBoundary).data(e.repeat,e.keyFun);ke.enter().append("g").classed(b.cn.columnBoundary,!0);var Oe=Te.selectAll("."+b.cn.columnBoundaryClippath).data(e.repeat,e.keyFun);Oe.enter().append("clipPath").classed(b.cn.columnBoundaryClippath,!0),Oe.attr("id",function(Ve){return x(j,Ve)});var Qe=Oe.selectAll("."+b.cn.columnBoundaryRect).data(e.repeat,e.keyFun);Qe.enter().append("rect").classed(b.cn.columnBoundaryRect,!0).attr("fill","none"),Qe.attr("width",function(Ve){return Ve.columnWidth+2*s(Ve)}).attr("height",function(Ve){return Ve.calcdata.height+2*s(Ve)+b.uplift}).attr("x",function(Ve){return-s(Ve)}).attr("y",function(Ve){return-s(Ve)}),X(null,Le,ge)};function s(re){return Math.ceil(re.calcdata.maxLineWidth/2)}function m(re,j){return"clip"+re._fullLayout._uid+"_scrollAreaBottomClip_"+j.key}function x(re,j){return"clip"+re._fullLayout._uid+"_columnBoundaryClippath_"+j.calcdata.key+"_"+j.specIndex}function M(re){return[].concat.apply([],re.map(function(j){return j})).map(function(j){return j.__data__})}function v(re,j,Z){function ne(Te){var de=Te.rowBlocks;return V(de,de.length-1)+(de.length?H(de[de.length-1],1/0):1)}var le=re.selectAll("."+b.cn.scrollbarKit).data(e.repeat,e.keyFun);le.enter().append("g").classed(b.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),le.each(function(Te){var de=Te.scrollbarState;de.totalHeight=ne(Te),de.scrollableAreaHeight=Te.groupHeight-B(Te),de.currentlyVisibleHeight=Math.min(de.totalHeight,de.scrollableAreaHeight),de.ratio=de.currentlyVisibleHeight/de.totalHeight,de.barLength=Math.max(de.ratio*de.currentlyVisibleHeight,b.goldenRatio*b.scrollbarWidth),de.barWiggleRoom=de.currentlyVisibleHeight-de.barLength,de.wiggleRoom=Math.max(0,de.totalHeight-de.scrollableAreaHeight),de.topY=de.barWiggleRoom===0?0:Te.scrollY/de.wiggleRoom*de.barWiggleRoom,de.bottomY=de.topY+de.barLength,de.dragMultiplier=de.wiggleRoom/de.barWiggleRoom}).attr("transform",function(Te){var de=Te.width+b.scrollbarWidth/2+b.scrollbarOffset;return t(de,B(Te))});var ge=le.selectAll("."+b.cn.scrollbar).data(e.repeat,e.keyFun);ge.enter().append("g").classed(b.cn.scrollbar,!0);var pe=ge.selectAll("."+b.cn.scrollbarSlider).data(e.repeat,e.keyFun);pe.enter().append("g").classed(b.cn.scrollbarSlider,!0),pe.attr("transform",function(Te){return t(0,Te.scrollbarState.topY||0)});var xe=pe.selectAll("."+b.cn.scrollbarGlyph).data(e.repeat,e.keyFun);xe.enter().append("line").classed(b.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",b.scrollbarWidth).attr("stroke-linecap","round").attr("y1",b.scrollbarWidth/2),xe.attr("y2",function(Te){return Te.scrollbarState.barLength-b.scrollbarWidth/2}).attr("stroke-opacity",function(Te){return Te.columnDragInProgress||!Te.scrollbarState.barWiggleRoom||Z?0:.4}),xe.transition().delay(0).duration(0),xe.transition().delay(b.scrollbarHideDelay).duration(b.scrollbarHideDuration).attr("stroke-opacity",0);var Ee=ge.selectAll("."+b.cn.scrollbarCaptureZone).data(e.repeat,e.keyFun);Ee.enter().append("line").classed(b.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",b.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(Te){var de=k.event.y,be=this.getBoundingClientRect(),Le=Te.scrollbarState,De=de-be.top,ye=k.scale.linear().domain([0,Le.scrollableAreaHeight]).range([0,Le.totalHeight]).clamp(!0);Le.topY<=De&&De<=Le.bottomY||oe(j,re,null,ye(De-Le.barLength/2))(Te)}).call(k.behavior.drag().origin(function(Te){return k.event.stopPropagation(),Te.scrollbarState.scrollbarScrollInProgress=!0,Te}).on("drag",oe(j,re)).on("dragend",function(){})),Ee.attr("y2",function(Te){return Te.scrollbarState.scrollableAreaHeight}),j._context.staticPlot&&(xe.remove(),Ee.remove())}function _(re,j,Z,ne){var le=l(Z),ge=y(le);f(ge);var pe=T(ge);h(pe);var xe=A(ge),Ee=w(xe);u(Ee),o(Ee,j,ne,re),Q(ge)}function l(re){var j=re.selectAll("."+b.cn.columnCells).data(e.repeat,e.keyFun);return j.enter().append("g").classed(b.cn.columnCells,!0),j.exit().remove(),j}function y(re){var j=re.selectAll("."+b.cn.columnCell).data(r.splitToCells,function(Z){return Z.keyWithinBlock});return j.enter().append("g").classed(b.cn.columnCell,!0),j.exit().remove(),j}function T(re){var j=re.selectAll("."+b.cn.cellRect).data(e.repeat,function(Z){return Z.keyWithinBlock});return j.enter().append("rect").classed(b.cn.cellRect,!0),j}function w(re){var j=re.selectAll("."+b.cn.cellText).data(e.repeat,function(Z){return Z.keyWithinBlock});return j.enter().append("text").classed(b.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){k.event.stopPropagation()}),j}function A(re){var j=re.selectAll("."+b.cn.cellTextHolder).data(e.repeat,function(Z){return Z.keyWithinBlock});return j.enter().append("g").classed(b.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),j}function f(re){re.each(function(j,Z){var ne=j.calcdata.cells.font,le=j.column.specIndex,ge={size:O(ne.size,le,Z),color:O(ne.color,le,Z),family:O(ne.family,le,Z)};j.rowNumber=j.key,j.align=O(j.calcdata.cells.align,le,Z),j.cellBorderWidth=O(j.calcdata.cells.line.width,le,Z),j.font=ge})}function u(re){re.each(function(j){p.font(k.select(this),j.font)})}function h(re){re.attr("width",function(j){return j.column.columnWidth}).attr("stroke-width",function(j){return j.cellBorderWidth}).each(function(j){var Z=k.select(this);d.stroke(Z,O(j.calcdata.cells.line.color,j.column.specIndex,j.rowNumber)),d.fill(Z,O(j.calcdata.cells.fill.color,j.column.specIndex,j.rowNumber))})}function o(re,j,Z,ne){re.text(function(le){var ge=le.column.specIndex,pe=le.rowNumber,xe=le.value,Ee=typeof xe=="string",Te=Ee&&xe.match(/<br>/i),de=!Ee||Te;le.mayHaveMarkup=Ee&&xe.match(/[<&>]/);var be=S(xe);le.latex=be;var Le=be?"":O(le.calcdata.cells.prefix,ge,pe)||"",De=be?"":O(le.calcdata.cells.suffix,ge,pe)||"",ye=be?null:O(le.calcdata.cells.format,ge,pe)||null,ke=Le+(ye?E(ye)(le.value):le.value)+De,Oe;le.wrappingNeeded=!le.wrapped&&!de&&!be&&(Oe=R(ke)),le.cellHeightMayIncrease=Te||be||le.mayHaveMarkup||(Oe===void 0?R(ke):Oe),le.needsConvertToTspans=le.mayHaveMarkup||le.wrappingNeeded||le.latex;var Qe;if(le.wrappingNeeded){var Ve=b.wrapSplitCharacter===" "?ke.replace(/<a href=/ig,"<a_href="):ke,Ue=Ve.split(b.wrapSplitCharacter),Ie=b.wrapSplitCharacter===" "?Ue.map(function(at){return at.replace(/<a_href=/ig,"<a href=")}):Ue;le.fragments=Ie.map(function(at){return{text:at,width:null}}),le.fragments.push({fragment:b.wrapSpacer,width:null}),Qe=Ie.join(b.lineBreaker)+b.lineBreaker+b.wrapSpacer}else delete le.fragments,Qe=ke;return Qe}).attr("dy",function(le){return le.needsConvertToTspans?0:"0.75em"}).each(function(le){var ge=this,pe=k.select(ge),xe=le.wrappingNeeded?q:K;le.needsConvertToTspans?g.convertToTspans(pe,ne,xe(Z,ge,j,ne,le)):k.select(ge.parentNode).attr("transform",function(Ee){return t(G(Ee),b.cellPad)}).attr("text-anchor",function(Ee){return{left:"start",center:"middle",right:"end"}[Ee.align]})})}function S(re){return typeof re=="string"&&re.match(b.latexCheck)}function R(re){return re.indexOf(b.wrapSplitCharacter)!==-1}function z(re,j,Z){var ne=j.gdColumnsOriginalOrder;j.gdColumns.sort(function(le,ge){return Z[ne.indexOf(le)]-Z[ne.indexOf(ge)]}),j.columnorder=Z,re.emit("plotly_restyle")}function O(re,j,Z){if(Array.isArray(re)){var ne=re[Math.min(j,re.length-1)];return Array.isArray(ne)?ne[Math.min(Z,ne.length-1)]:ne}else return re}function I(re,j,Z){re.transition().ease(b.releaseTransitionEase).duration(b.releaseTransitionDuration).attr("transform",t(j.x,Z))}function F(re){return re.type==="cells"}function D(re){return re.type==="header"}function B(re){var j=re.rowBlocks.length?re.rowBlocks[0].auxiliaryBlocks:[];return j.reduce(function(Z,ne){return Z+H(ne,1/0)},0)}function U(re,j,Z){for(var ne=[],le=0,ge=0;ge<re.length;ge++){for(var pe=re[ge],xe=pe.rows,Ee=0,Te=0;Te<xe.length;Te++)Ee+=xe[Te].rowHeight;pe.allRowsHeight=Ee;var de=le+Ee,be=j,Le=be+Z;be<de&&Le>le&&ne.push(ge),le+=Ee}return ne}function X(re,j,Z){var ne=M(j)[0];if(ne!==void 0){var le=ne.rowBlocks,ge=ne.calcdata,pe=V(le,le.length),xe=ne.calcdata.groupHeight-B(ne),Ee=ge.scrollY=Math.max(0,Math.min(pe-xe,ge.scrollY)),Te=U(le,Ee,xe);Te.length===1&&(Te[0]===le.length-1?Te.unshift(Te[0]-1):Te.push(Te[0]+1)),Te[0]%2&&Te.reverse(),j.each(function(de,be){de.page=Te[be],de.scrollY=Ee}),j.attr("transform",function(de){var be=V(de.rowBlocks,de.page)-de.scrollY;return t(0,be)}),re&&(se(re,Z,j,Te,ne.prevPages,ne,0),se(re,Z,j,Te,ne.prevPages,ne,1),v(Z,re))}}function oe(re,j,Z,ne){return function(ge){var pe=ge.calcdata?ge.calcdata:ge,xe=j.filter(function(be){return pe.key===be.key}),Ee=Z||pe.scrollbarState.dragMultiplier,Te=pe.scrollY;pe.scrollY=ne===void 0?pe.scrollY+Ee*k.event.dy:ne;var de=xe.selectAll("."+b.cn.yColumn).selectAll("."+b.cn.columnBlock).filter(F);return X(re,de,xe),pe.scrollY===Te}}function se(re,j,Z,ne,le,ge,pe){var xe=ne[pe]!==le[pe];xe&&(clearTimeout(ge.currentRepaint[pe]),ge.currentRepaint[pe]=setTimeout(function(){var Ee=Z.filter(function(Te,de){return de===pe&&ne[de]!==le[de]});_(re,j,Ee,Z),le[pe]=ne[pe]}))}function q(re,j,Z,ne){return function(){var ge=k.select(j.parentNode);ge.each(function(pe){var xe=pe.fragments;ge.selectAll("tspan.line").each(function(ke,Oe){xe[Oe].width=this.getComputedTextLength()});var Ee=xe[xe.length-1].width,Te=xe.slice(0,-1),de=[],be,Le,De=0,ye=pe.column.columnWidth-2*b.cellPad;for(pe.value="";Te.length;)be=Te.shift(),Le=be.width+Ee,De+Le>ye&&(pe.value+=de.join(b.wrapSpacer)+b.lineBreaker,de=[],De=0),de.push(be.text),De+=Le;De&&(pe.value+=de.join(b.wrapSpacer)),pe.wrapped=!0}),ge.selectAll("tspan.line").remove(),o(ge.select("."+b.cn.cellText),Z,re,ne),k.select(j.parentNode.parentNode).call(Q)}}function K(re,j,Z,ne,le){return function(){if(!le.settledY){var pe=k.select(j.parentNode),xe=J(le),Ee=le.key-xe.firstRowIndex,Te=xe.rows[Ee].rowHeight,de=le.cellHeightMayIncrease?j.parentNode.getBoundingClientRect().height+2*b.cellPad:Te,be=Math.max(de,Te),Le=be-xe.rows[Ee].rowHeight;Le&&(xe.rows[Ee].rowHeight=be,re.selectAll("."+b.cn.columnCell).call(Q),X(null,re.filter(F),0),v(Z,ne,!0)),pe.attr("transform",function(){var De=this,ye=De.parentNode,ke=ye.getBoundingClientRect(),Oe=k.select(De.parentNode).select("."+b.cn.cellRect).node().getBoundingClientRect(),Qe=De.transform.baseVal.consolidate(),Ve=Oe.top-ke.top+(Qe?Qe.matrix.f:b.cellPad);return t(G(le,k.select(De.parentNode).select("."+b.cn.cellTextHolder).node().getBoundingClientRect().width),Ve)}),le.settledY=!0}}}function G(re,j){switch(re.align){case"left":return b.cellPad;case"right":return re.column.columnWidth-(j||0)-b.cellPad;case"center":return(re.column.columnWidth-(j||0))/2;default:return b.cellPad}}function Q(re){re.attr("transform",function(j){var Z=j.rowBlocks[0].auxiliaryBlocks.reduce(function(pe,xe){return pe+H(xe,1/0)},0),ne=J(j),le=H(ne,j.key),ge=le+Z;return t(0,ge)}).selectAll("."+b.cn.cellRect).attr("height",function(j){return W(J(j),j.key).rowHeight})}function V(re,j){for(var Z=0,ne=j-1;ne>=0;ne--)Z+=ee(re[ne]);return Z}function H(re,j){for(var Z=0,ne=0;ne<re.rows.length&&re.rows[ne].rowIndex<j;ne++)Z+=re.rows[ne].rowHeight;return Z}function ee(re){var j=re.allRowsHeight;if(j!==void 0)return j;for(var Z=0,ne=0;ne<re.rows.length;ne++)Z+=re.rows[ne].rowHeight;return re.allRowsHeight=Z,Z}function J(re){return re.rowBlocks[re.page]}function W(re,j){return re.rows[j-re.firstRowIndex]}},{"../../components/color":366,"../../components/drawing":388,"../../lib":503,"../../lib/gup":500,"../../lib/svg_text_utils":529,"./constants":1069,"./data_preparation_helper":1070,"./data_split_helpers":1071,"@plotly/d3":58}],1075:[function(c,ae,ie){"use strict";var b=c("../../plots/template_attributes").hovertemplateAttrs,k=c("../../plots/template_attributes").texttemplateAttrs,P=c("../../components/colorscale/attributes"),E=c("../../plots/domain").attributes,e=c("../pie/attributes"),p=c("../sunburst/attributes"),g=c("./constants"),a=c("../../lib/extend").extendFlat;ae.exports={labels:p.labels,parents:p.parents,values:p.values,branchvalues:p.branchvalues,count:p.count,level:p.level,maxdepth:p.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:a({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:p.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:p.marker.line,editType:"calc"},P("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:a({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:p.textinfo,texttemplate:k({editType:"plot"},{keys:g.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:p.hoverinfo,hovertemplate:b({},{keys:g.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:a({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:p.root,domain:E({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plots/domain":584,"../../plots/template_attributes":633,"../pie/attributes":901,"../sunburst/attributes":1049,"./constants":1078}],1076:[function(c,ae,ie){"use strict";var b=c("../../plots/plots");ie.name="treemap",ie.plot=function(k,P,E,e){b.plotBasePlot(ie.name,k,P,E,e)},ie.clean=function(k,P,E,e){b.cleanBasePlot(ie.name,k,P,E,e)}},{"../../plots/plots":619}],1077:[function(c,ae,ie){"use strict";var b=c("../sunburst/calc");ie.calc=function(k,P){return b.calc(k,P)},ie.crossTraceCalc=function(k){return b._runCrossTraceCalc("treemap",k)}},{"../sunburst/calc":1051}],1078:[function(c,ae,ie){"use strict";ae.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1079:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("../../components/color"),E=c("../../plots/domain").defaults,e=c("../bar/defaults").handleText,p=c("../bar/constants").TEXTPAD,g=c("../../components/colorscale"),a=g.hasColorscale,t=g.handleDefaults;ae.exports=function(n,r,d,s){function m(o,S){return b.coerce(n,r,k,o,S)}var x=m("labels"),M=m("parents");if(!x||!x.length||!M||!M.length){r.visible=!1;return}var v=m("values");v&&v.length?m("branchvalues"):m("count"),m("level"),m("maxdepth");var _=m("tiling.packing");_==="squarify"&&m("tiling.squarifyratio"),m("tiling.flip"),m("tiling.pad");var l=m("text");m("texttemplate"),r.texttemplate||m("textinfo",Array.isArray(l)?"text+label":"label"),m("hovertext"),m("hovertemplate");var y=m("pathbar.visible"),T="auto";e(n,r,s,m,T,{hasPathbar:y,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),m("textposition");var w=r.textposition.indexOf("bottom")!==-1,A=m("marker.line.width");A&&m("marker.line.color",s.paper_bgcolor);var f=m("marker.colors"),u=r._hasColorscale=a(n,"marker","colors")||(n.marker||{}).coloraxis;u?t(n,r,s,m,{prefix:"marker.",cLetter:"c"}):m("marker.depthfade",!(f||[]).length);var h=r.textfont.size*2;m("marker.pad.t",w?h/4:h),m("marker.pad.l",h/4),m("marker.pad.r",h/4),m("marker.pad.b",w?h:h/4),r._hovered={marker:{line:{width:2,color:P.contrast(s.paper_bgcolor)}}},y&&(m("pathbar.thickness",r.pathbar.textfont.size+2*p),m("pathbar.side"),m("pathbar.edgeshape")),m("sort"),m("root.color"),E(r,s,m),r._length=null}},{"../../components/color":366,"../../components/colorscale":378,"../../lib":503,"../../plots/domain":584,"../bar/constants":650,"../bar/defaults":652,"./attributes":1075}],1080:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../sunburst/helpers"),P=c("../bar/uniform_text"),E=P.clearMinTextSize,e=c("../bar/style").resizeText,p=c("./plot_one");ae.exports=function(a,t,i,n,r){var d=r.type,s=r.drawDescendants,m=a._fullLayout,x=m["_"+d+"layer"],M,v,_=!i;if(E(d,m),M=x.selectAll("g.trace."+d).data(t,function(y){return y[0].trace.uid}),M.enter().append("g").classed("trace",!0).classed(d,!0),M.order(),!m.uniformtext.mode&&k.hasTransition(i)){n&&(v=n());var l=b.transition().duration(i.duration).ease(i.easing).each("end",function(){v&&v()}).each("interrupt",function(){v&&v()});l.each(function(){x.selectAll("g.trace").each(function(y){p(a,y,this,i,s)})})}else M.each(function(y){p(a,y,this,i,s)}),m.uniformtext.mode&&e(a,x.selectAll(".trace"),d);_&&M.exit().remove()}},{"../bar/style":662,"../bar/uniform_text":664,"../sunburst/helpers":1055,"./plot_one":1089,"@plotly/d3":58}],1081:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../components/drawing"),E=c("../../lib/svg_text_utils"),e=c("./partition"),p=c("./style").styleOne,g=c("./constants"),a=c("../sunburst/helpers"),t=c("../sunburst/fx"),i=!0;ae.exports=function(r,d,s,m,x){var M=x.barDifY,v=x.width,_=x.height,l=x.viewX,y=x.viewY,T=x.pathSlice,w=x.toMoveInsideSlice,A=x.strTransform,f=x.hasTransition,u=x.handleSlicesExit,h=x.makeUpdateSliceInterpolator,o=x.makeUpdateTextInterpolator,S={},R=r._fullLayout,z=d[0],O=z.trace,I=z.hierarchy,F=v/O._entryDepth,D=a.listPath(s.data,"id"),B=e(I.copy(),[v,_],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();B=B.filter(function(X){var oe=D.indexOf(X.data.id);return oe===-1?!1:(X.x0=F*oe,X.x1=F*(oe+1),X.y0=M,X.y1=M+_,X.onPathbar=!0,!0)}),B.reverse(),m=m.data(B,a.getPtId),m.enter().append("g").classed("pathbar",!0),u(m,i,S,[v,_],T),m.order();var U=m;f&&(U=U.transition().each("end",function(){var X=b.select(this);a.setSliceCursor(X,r,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),U.each(function(X){X._x0=l(X.x0),X._x1=l(X.x1),X._y0=y(X.y0),X._y1=y(X.y1),X._hoverX=l(X.x1-Math.min(v,_)/2),X._hoverY=y(X.y1-_/2);var oe=b.select(this),se=k.ensureSingle(oe,"path","surface",function(Q){Q.style("pointer-events","all")});f?se.transition().attrTween("d",function(Q){var V=h(Q,i,S,[v,_]);return function(H){return T(V(H))}}):se.attr("d",T),oe.call(t,s,r,d,{styleOne:p,eventDataKeys:g.eventDataKeys,transitionTime:g.CLICK_TRANSITION_TIME,transitionEasing:g.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,r,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:r._transitioning}),se.call(p,X,O,{hovered:!1}),X._text=(a.getPtLabel(X)||"").split("<br>").join(" ")||"";var q=k.ensureSingle(oe,"g","slicetext"),K=k.ensureSingle(q,"text","",function(Q){Q.attr("data-notex",1)}),G=k.ensureUniformFontSize(r,a.determineTextFont(O,X,R.font,{onPathbar:!0}));K.text(X._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(P.font,G).call(E.convertToTspans,r),X.textBB=P.bBox(K.node()),X.transform=w(X,{fontSize:G.size,onPathbar:!0}),X.transform.fontSize=G.size,f?K.transition().attrTween("transform",function(Q){var V=o(Q,i,S,[v,_]);return function(H){return A(V(H))}}):K.attr("transform",A(X))})}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../sunburst/fx":1054,"../sunburst/helpers":1055,"./constants":1078,"./partition":1087,"./style":1090,"@plotly/d3":58}],1082:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../components/drawing"),E=c("../../lib/svg_text_utils"),e=c("./partition"),p=c("./style").styleOne,g=c("./constants"),a=c("../sunburst/helpers"),t=c("../sunburst/fx"),i=c("../sunburst/plot").formatSliceLabel,n=!1;ae.exports=function(d,s,m,x,M){var v=M.width,_=M.height,l=M.viewX,y=M.viewY,T=M.pathSlice,w=M.toMoveInsideSlice,A=M.strTransform,f=M.hasTransition,u=M.handleSlicesExit,h=M.makeUpdateSliceInterpolator,o=M.makeUpdateTextInterpolator,S=M.prevEntry,R={},z=d._fullLayout,O=s[0],I=O.trace,F=I.textposition.indexOf("left")!==-1,D=I.textposition.indexOf("right")!==-1,B=I.textposition.indexOf("bottom")!==-1,U=!B&&!I.marker.pad.t||B&&!I.marker.pad.b,X=e(m,[v,_],{packing:I.tiling.packing,squarifyratio:I.tiling.squarifyratio,flipX:I.tiling.flip.indexOf("x")>-1,flipY:I.tiling.flip.indexOf("y")>-1,pad:{inner:I.tiling.pad,top:I.marker.pad.t,left:I.marker.pad.l,right:I.marker.pad.r,bottom:I.marker.pad.b}}),oe=X.descendants(),se=1/0,q=-1/0;oe.forEach(function(H){var ee=H.depth;ee>=I._maxDepth?(H.x0=H.x1=(H.x0+H.x1)/2,H.y0=H.y1=(H.y0+H.y1)/2):(se=Math.min(se,ee),q=Math.max(q,ee))}),x=x.data(oe,a.getPtId),I._maxVisibleLayers=isFinite(q)?q-se+1:0,x.enter().append("g").classed("slice",!0),u(x,n,R,[v,_],T),x.order();var K=null;if(f&&S){var G=a.getPtId(S);x.each(function(H){K===null&&a.getPtId(H)===G&&(K={x0:H.x0,x1:H.x1,y0:H.y0,y1:H.y1})})}var Q=function(){return K||{x0:0,x1:v,y0:0,y1:_}},V=x;return f&&(V=V.transition().each("end",function(){var H=b.select(this);a.setSliceCursor(H,d,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),V.each(function(H){var ee=a.isHeader(H,I);H._x0=l(H.x0),H._x1=l(H.x1),H._y0=y(H.y0),H._y1=y(H.y1),H._hoverX=l(H.x1-I.marker.pad.r),H._hoverY=y(B?H.y1-I.marker.pad.b/2:H.y0+I.marker.pad.t/2);var J=b.select(this),W=k.ensureSingle(J,"path","surface",function(ne){ne.style("pointer-events","all")});f?W.transition().attrTween("d",function(ne){var le=h(ne,n,Q(),[v,_]);return function(ge){return T(le(ge))}}):W.attr("d",T),J.call(t,m,d,s,{styleOne:p,eventDataKeys:g.eventDataKeys,transitionTime:g.CLICK_TRANSITION_TIME,transitionEasing:g.CLICK_TRANSITION_EASING}).call(a.setSliceCursor,d,{isTransitioning:d._transitioning}),W.call(p,H,I,{hovered:!1}),H.x0===H.x1||H.y0===H.y1?H._text="":ee?H._text=U?"":a.getPtLabel(H)||"":H._text=i(H,m,I,s,z)||"";var re=k.ensureSingle(J,"g","slicetext"),j=k.ensureSingle(re,"text","",function(ne){ne.attr("data-notex",1)}),Z=k.ensureUniformFontSize(d,a.determineTextFont(I,H,z.font));j.text(H._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":F||ee?"start":"middle").call(P.font,Z).call(E.convertToTspans,d),H.textBB=P.bBox(j.node()),H.transform=w(H,{fontSize:Z.size,isHeader:ee}),H.transform.fontSize=Z.size,f?j.transition().attrTween("transform",function(ne){var le=o(ne,n,Q(),[v,_]);return function(ge){return A(le(ge))}}):j.attr("transform",A(H))}),K}},{"../../components/drawing":388,"../../lib":503,"../../lib/svg_text_utils":529,"../sunburst/fx":1054,"../sunburst/helpers":1055,"../sunburst/plot":1059,"./constants":1078,"./partition":1087,"./style":1090,"@plotly/d3":58}],1083:[function(c,ae,ie){"use strict";ae.exports=function b(k,P,E){var e;E.swapXY&&(e=k.x0,k.x0=k.y0,k.y0=e,e=k.x1,k.x1=k.y1,k.y1=e),E.flipX&&(e=k.x0,k.x0=P[0]-k.x1,k.x1=P[0]-e),E.flipY&&(e=k.y0,k.y0=P[1]-k.y1,k.y1=P[1]-e);var p=k.children;if(p)for(var g=0;g<p.length;g++)b(p[g],P,E)}},{}],1084:[function(c,ae,ie){"use strict";ae.exports={moduleType:"trace",name:"treemap",basePlotModule:c("./base_plot"),categories:[],animatable:!0,attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults"),supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc").calc,crossTraceCalc:c("./calc").crossTraceCalc,plot:c("./plot"),style:c("./style").style,colorbar:c("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":945,"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1079,"./layout_attributes":1085,"./layout_defaults":1086,"./plot":1088,"./style":1090}],1085:[function(c,ae,ie){"use strict";ae.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1086:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(E,e){function p(g,a){return b.coerce(E,e,k,g,a)}p("treemapcolorway",e.colorway),p("extendtreemapcolors")}},{"../../lib":503,"./layout_attributes":1085}],1087:[function(c,ae,ie){"use strict";var b=c("d3-hierarchy"),k=c("./flip_tree");ae.exports=function(e,p,g){var a=g.flipX,t=g.flipY,i=g.packing==="dice-slice",n=g.pad[t?"bottom":"top"],r=g.pad[a?"right":"left"],d=g.pad[a?"left":"right"],s=g.pad[t?"top":"bottom"],m;i&&(m=r,r=n,n=m,m=d,d=s,s=m);var x=b.treemap().tile(P(g.packing,g.squarifyratio)).paddingInner(g.pad.inner).paddingLeft(r).paddingRight(d).paddingTop(n).paddingBottom(s).size(i?[p[1],p[0]]:p)(e);return(i||a||t)&&k(x,p,{swapXY:i,flipX:a,flipY:t}),x};function P(E,e){switch(E){case"squarify":return b.treemapSquarify.ratio(e);case"binary":return b.treemapBinary;case"dice":return b.treemapDice;case"slice":return b.treemapSlice;default:return b.treemapSliceDice}}},{"./flip_tree":1083,"d3-hierarchy":115}],1088:[function(c,ae,ie){"use strict";var b=c("./draw"),k=c("./draw_descendants");ae.exports=function(E,e,p,g){return b(E,e,p,g,{type:"treemap",drawDescendants:k})}},{"./draw":1080,"./draw_descendants":1082}],1089:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("d3-interpolate").interpolate,P=c("../sunburst/helpers"),E=c("../../lib"),e=c("../bar/constants").TEXTPAD,p=c("../bar/plot"),g=p.toMoveInsideBar,a=c("../bar/uniform_text"),t=a.recordMinTextSize,i=c("./constants"),n=c("./draw_ancestors");function r(d){return P.isHierarchyRoot(d)?"":P.getPtId(d)}ae.exports=function(s,m,x,M,v){var _=s._fullLayout,l=m[0],y=l.trace,T=y.type,w=T==="icicle",A=l.hierarchy,f=P.findEntryWithLevel(A,y.level),u=b.select(x),h=u.selectAll("g.pathbar"),o=u.selectAll("g.slice");if(!f){h.remove(),o.remove();return}var S=P.isHierarchyRoot(f),R=!_.uniformtext.mode&&P.hasTransition(M),z=P.getMaxDepth(y),O=function(Ie){return Ie.data.depth-f.data.depth<z},I=_._size,F=y.domain,D=I.w*(F.x[1]-F.x[0]),B=I.h*(F.y[1]-F.y[0]),U=D,X=y.pathbar.thickness,oe=y.marker.line.width+i.gapWithPathbar,se=y.pathbar.visible?y.pathbar.side.indexOf("bottom")>-1?B+oe:-(X+oe):0,q={x0:U,x1:U,y0:se,y1:se+X},K=function(Ie,at,pt){var Rt=y.tiling.pad,Mt=function(_t){return _t-Rt<=at.x0},It=function(_t){return _t+Rt>=at.x1},Bt=function(_t){return _t-Rt<=at.y0},St=function(_t){return _t+Rt>=at.y1};return Ie.x0===at.x0&&Ie.x1===at.x1&&Ie.y0===at.y0&&Ie.y1===at.y1?{x0:Ie.x0,x1:Ie.x1,y0:Ie.y0,y1:Ie.y1}:{x0:Mt(Ie.x0-Rt)?0:It(Ie.x0-Rt)?pt[0]:Ie.x0,x1:Mt(Ie.x1+Rt)?0:It(Ie.x1+Rt)?pt[0]:Ie.x1,y0:Bt(Ie.y0-Rt)?0:St(Ie.y0-Rt)?pt[1]:Ie.y0,y1:Bt(Ie.y1+Rt)?0:St(Ie.y1+Rt)?pt[1]:Ie.y1}},G=null,Q={},V={},H=null,ee=function(Ie,at){return at?Q[r(Ie)]:V[r(Ie)]},J=function(Ie,at,pt,Rt){if(at)return Q[r(A)]||q;var Mt=V[y.level]||pt;return O(Ie)?K(Ie,Mt,Rt):{}};l.hasMultipleRoots&&S&&z++,y._maxDepth=z,y._backgroundColor=_.paper_bgcolor,y._entryDepth=f.data.depth,y._atRootLevel=S;var W=-D/2+I.l+I.w*(F.x[1]+F.x[0])/2,re=-B/2+I.t+I.h*(1-(F.y[1]+F.y[0])/2),j=function(Ie){return W+Ie},Z=function(Ie){return re+Ie},ne=Z(0),le=j(0),ge=function(Ie){return le+Ie},pe=function(Ie){return ne+Ie};function xe(Ie,at){return Ie+","+at}var Ee=ge(0),Te=function(Ie){Ie.x=Math.max(Ee,Ie.x)},de=y.pathbar.edgeshape,be=function(Ie){var at=ge(Math.max(Math.min(Ie.x0,Ie.x0),0)),pt=ge(Math.min(Math.max(Ie.x1,Ie.x1),U)),Rt=pe(Ie.y0),Mt=pe(Ie.y1),It=X/2,Bt={},St={};Bt.x=at,St.x=pt,Bt.y=St.y=(Rt+Mt)/2;var _t={x:at,y:Rt},it={x:pt,y:Rt},ct={x:pt,y:Mt},et={x:at,y:Mt};return de===">"?(_t.x-=It,it.x-=It,ct.x-=It,et.x-=It):de==="/"?(ct.x-=It,et.x-=It,Bt.x-=It/2,St.x-=It/2):de==="\\"?(_t.x-=It,it.x-=It,Bt.x-=It/2,St.x-=It/2):de==="<"&&(Bt.x-=It,St.x-=It),Te(_t),Te(et),Te(Bt),Te(it),Te(ct),Te(St),"M"+xe(_t.x,_t.y)+"L"+xe(it.x,it.y)+"L"+xe(St.x,St.y)+"L"+xe(ct.x,ct.y)+"L"+xe(et.x,et.y)+"L"+xe(Bt.x,Bt.y)+"Z"},Le=function(Ie){var at=j(Ie.x0),pt=j(Ie.x1),Rt=Z(Ie.y0),Mt=Z(Ie.y1),It=pt-at,Bt=Mt-Rt;if(!It||!Bt)return"";var St=0,_t=It>2*St&&Bt>2*St?St:0,it=function(ct,et){return _t?"a"+xe(_t,_t)+" 0 0 1 "+xe(ct,et):""};return"M"+xe(at,Rt+_t)+it(_t,-_t)+"L"+xe(pt-_t,Rt)+it(_t,_t)+"L"+xe(pt,Mt-_t)+it(-_t,_t)+"L"+xe(at+_t,Mt)+it(-_t,-_t)+"Z"},De=function(Ie,at){var pt=Ie.x0,Rt=Ie.x1,Mt=Ie.y0,It=Ie.y1,Bt=Ie.textBB,St=function(Vt){return y.textposition.indexOf(Vt)!==-1},_t=St("bottom"),it=St("top")||at.isHeader&&!_t,ct=it?"start":_t?"end":"middle",et=St("right"),Pe=St("left")||at.onPathbar,We=Pe?-1:et?1:0,je=y[w?"tiling":"marker"].pad;if(at.isHeader){if(pt+=(w?je:je.l)-e,Rt-=(w?je:je.r)-e,pt>=Rt){var nt=(pt+Rt)/2;pt=nt,Rt=nt}var kt;_t?(kt=It-(w?je:je.b),Mt<kt&&kt<It&&(Mt=kt)):(kt=Mt+(w?je:je.t),Mt<kt&&kt<It&&(It=kt))}var wt=g(pt,Rt,Mt,It,Bt,{isHorizontal:!1,constrained:!0,angle:0,anchor:ct,leftToRight:We});return wt.fontSize=at.fontSize,wt.targetX=j(wt.targetX),wt.targetY=Z(wt.targetY),isNaN(wt.targetX)||isNaN(wt.targetY)?{}:(pt!==Rt&&Mt!==It&&t(y.type,wt,_),{scale:wt.scale,rotate:wt.rotate,textX:wt.textX,textY:wt.textY,anchorX:wt.anchorX,anchorY:wt.anchorY,targetX:wt.targetX,targetY:wt.targetY})},ye=function(Ie,at){for(var pt,Rt=0,Mt=Ie;!pt&&Rt<z;)Rt++,Mt=Mt.parent,Mt?pt=ee(Mt,at):Rt=z;return pt||{}},ke=function(Ie,at,pt,Rt){var Mt=ee(Ie,at),It;if(at)It=q;else{var Bt=ee(f,at);Bt?It=K(Ie,Bt,Rt):It={}}return k(Mt,It)},Oe=function(Ie,at,pt,Rt,Mt){var It=ee(Ie,at),Bt;if(It)Bt=It;else if(at)Bt=q;else if(G)if(Ie.parent){var St=H||pt;St&&!at?Bt=K(Ie,St,Rt):(Bt={},E.extendFlat(Bt,ye(Ie,at)))}else Bt=E.extendFlat({},Ie),w&&(Mt.orientation==="h"?Mt.flipX?Bt.x0=Ie.x1:Bt.x1=0:Mt.flipY?Bt.y0=Ie.y1:Bt.y1=0);else Bt={};return k(Bt,{x0:Ie.x0,x1:Ie.x1,y0:Ie.y0,y1:Ie.y1})},Qe=function(Ie,at,pt,Rt){var Mt=ee(Ie,at),It={},Bt=J(Ie,at,pt,Rt);E.extendFlat(It,{transform:De({x0:Bt.x0,x1:Bt.x1,y0:Bt.y0,y1:Bt.y1,textBB:Ie.textBB,_text:Ie._text},{isHeader:P.isHeader(Ie,y)})}),Mt?It=Mt:Ie.parent&&E.extendFlat(It,ye(Ie,at));var St=Ie.transform;return Ie.x0!==Ie.x1&&Ie.y0!==Ie.y1&&t(y.type,St,_),k(It,{transform:{scale:St.scale,rotate:St.rotate,textX:St.textX,textY:St.textY,anchorX:St.anchorX,anchorY:St.anchorY,targetX:St.targetX,targetY:St.targetY}})},Ve=function(Ie,at,pt,Rt,Mt){var It=Rt[0],Bt=Rt[1];R?Ie.exit().transition().each(function(){var St=b.select(this),_t=St.select("path.surface");_t.transition().attrTween("d",function(ct){var et=ke(ct,at,pt,[It,Bt]);return function(Pe){return Mt(et(Pe))}});var it=St.select("g.slicetext");it.attr("opacity",0)}).remove():Ie.exit().remove()},Ue=function(Ie){var at=Ie.transform;return Ie.x0!==Ie.x1&&Ie.y0!==Ie.y1&&t(y.type,at,_),E.getTextTransform({textX:at.textX,textY:at.textY,anchorX:at.anchorX,anchorY:at.anchorY,targetX:at.targetX,targetY:at.targetY,scale:at.scale,rotate:at.rotate})};R&&(h.each(function(Ie){Q[r(Ie)]={x0:Ie.x0,x1:Ie.x1,y0:Ie.y0,y1:Ie.y1},Ie.transform&&(Q[r(Ie)].transform={textX:Ie.transform.textX,textY:Ie.transform.textY,anchorX:Ie.transform.anchorX,anchorY:Ie.transform.anchorY,targetX:Ie.transform.targetX,targetY:Ie.transform.targetY,scale:Ie.transform.scale,rotate:Ie.transform.rotate})}),o.each(function(Ie){V[r(Ie)]={x0:Ie.x0,x1:Ie.x1,y0:Ie.y0,y1:Ie.y1},Ie.transform&&(V[r(Ie)].transform={textX:Ie.transform.textX,textY:Ie.transform.textY,anchorX:Ie.transform.anchorX,anchorY:Ie.transform.anchorY,targetX:Ie.transform.targetX,targetY:Ie.transform.targetY,scale:Ie.transform.scale,rotate:Ie.transform.rotate}),!G&&P.isEntry(Ie)&&(G=Ie)})),H=v(s,m,f,o,{width:D,height:B,viewX:j,viewY:Z,pathSlice:Le,toMoveInsideSlice:De,prevEntry:G,makeUpdateSliceInterpolator:Oe,makeUpdateTextInterpolator:Qe,handleSlicesExit:Ve,hasTransition:R,strTransform:Ue}),y.pathbar.visible?n(s,m,f,h,{barDifY:se,width:U,height:X,viewX:ge,viewY:pe,pathSlice:be,toMoveInsideSlice:De,makeUpdateSliceInterpolator:Oe,makeUpdateTextInterpolator:Qe,handleSlicesExit:Ve,hasTransition:R,strTransform:Ue}):h.remove()}},{"../../lib":503,"../bar/constants":650,"../bar/plot":659,"../bar/uniform_text":664,"../sunburst/helpers":1055,"./constants":1078,"./draw_ancestors":1081,"@plotly/d3":58,"d3-interpolate":116}],1090:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/color"),P=c("../../lib"),E=c("../sunburst/helpers"),e=c("../bar/uniform_text").resizeText;function p(a){var t=a._fullLayout._treemaplayer.selectAll(".trace");e(a,t,"treemap"),t.each(function(i){var n=b.select(this),r=i[0],d=r.trace;n.style("opacity",d.opacity),n.selectAll("path.surface").each(function(s){b.select(this).call(g,s,d,{hovered:!1})})})}function g(a,t,i,n){var r=(n||{}).hovered,d=t.data.data,s=d.i,m,x,M=d.color,v=E.isHierarchyRoot(t),_=1;if(r)m=i._hovered.marker.line.color,x=i._hovered.marker.line.width;else if(v&&M===i.root.color)_=100,m="rgba(0,0,0,0)",x=0;else if(m=P.castOption(i,s,"marker.line.color")||k.defaultLine,x=P.castOption(i,s,"marker.line.width")||0,!i._hasColorscale&&!t.onPathbar){var l=i.marker.depthfade;if(l){var y=k.combine(k.addOpacity(i._backgroundColor,.75),M),T;if(l===!0){var w=E.getMaxDepth(i);isFinite(w)?E.isLeaf(t)?T=0:T=i._maxVisibleLayers-(t.data.depth-i._entryDepth):T=t.data.height+1}else T=t.data.depth-i._entryDepth,i._atRootLevel||T++;if(T>0)for(var A=0;A<T;A++){var f=.5*A/T;M=k.combine(k.addOpacity(y,f),M)}}}a.style("stroke-width",x).call(k.fill,M).call(k.stroke,m).style("opacity",_)}ae.exports={style:p,styleOne:g}},{"../../components/color":366,"../../lib":503,"../bar/uniform_text":664,"../sunburst/helpers":1055,"@plotly/d3":58}],1091:[function(c,ae,ie){"use strict";var b=c("../box/attributes"),k=c("../../lib/extend").extendFlat,P=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat;ae.exports={y:b.y,x:b.x,x0:b.x0,y0:b.y0,xhoverformat:P("x"),yhoverformat:P("y"),name:k({},b.name,{}),orientation:k({},b.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:b.fillcolor,points:k({},b.boxpoints,{}),jitter:k({},b.jitter,{}),pointpos:k({},b.pointpos,{}),width:k({},b.width,{}),marker:b.marker,text:b.text,hovertext:b.hovertext,hovertemplate:b.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:b.offsetgroup,alignmentgroup:b.alignmentgroup,selected:b.selected,unselected:b.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":493,"../../plots/cartesian/axis_format_attributes":557,"../box/attributes":673}],1092:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("../box/calc"),E=c("./helpers"),e=c("../../constants/numerical").BADNUM;ae.exports=function(i,n){var r=P(i,n);if(r[0].t.empty)return r;for(var d=i._fullLayout,s=k.getFromId(i,n[n.orientation==="h"?"xaxis":"yaxis"]),m=1/0,x=-1/0,M=0,v=0,_=0;_<r.length;_++){var l=r[_],y=l.pts.map(E.extractVal),T=l.bandwidth=g(n,l,y),w=l.span=a(n,l,s,T);if(l.min===l.max&&T===0)w=l.span=[l.min,l.max],l.density=[{v:1,t:w[0]}],l.bandwidth=T,M=Math.max(M,1);else{var A=w[1]-w[0],f=Math.ceil(A/(T/3)),u=A/f;if(!isFinite(u)||!isFinite(f))return b.error("Something went wrong with computing the violin span"),r[0].t.empty=!0,r;var h=E.makeKDE(l,n,y);l.density=new Array(f);for(var o=0,S=w[0];S<w[1]+u/2;o++,S+=u){var R=h(S);l.density[o]={v:R,t:S},M=Math.max(M,R)}}v=Math.max(v,y.length),m=Math.min(m,w[0]),x=Math.max(x,w[1])}var z=k.findExtremes(s,[m,x],{padded:!0});if(n._extremes[s._id]=z,n.width)r[0].t.maxKDE=M;else{var O=d._violinScaleGroupStats,I=n.scalegroup,F=O[I];F?(F.maxKDE=Math.max(F.maxKDE,M),F.maxCount=Math.max(F.maxCount,v)):O[I]={maxKDE:M,maxCount:v}}return r[0].t.labels.kde=b._(i,"kde:"),r};function p(t,i,n){var r=Math.min(i,n/1.349);return 1.059*r*Math.pow(t,-.2)}function g(t,i,n){var r=i.max-i.min;if(!r)return t.bandwidth?t.bandwidth:0;if(t.bandwidth)return Math.max(t.bandwidth,r/1e4);var d=n.length,s=b.stdev(n,d-1,i.mean);return Math.max(p(d,s,i.q3-i.q1),r/100)}function a(t,i,n,r){var d=t.spanmode,s=t.span||[],m=[i.min,i.max],x=[i.min-2*r,i.max+2*r],M;function v(l){var y=s[l],T=n.type==="multicategory"?n.r2c(y):n.d2c(y,0,t[i.valLetter+"calendar"]);return T===e?x[l]:T}d==="soft"?M=x:d==="hard"?M=m:M=[v(0),v(1)];var _={type:"linear",range:M};return k.setConvert(_),_.cleanRange(),M}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/axes":554,"../box/calc":674,"./helpers":1095}],1093:[function(c,ae,ie){"use strict";var b=c("../box/cross_trace_calc").setPositionOffset,k=["v","h"];ae.exports=function(E,e){for(var p=E.calcdata,g=e.xaxis,a=e.yaxis,t=0;t<k.length;t++){for(var i=k[t],n=i==="h"?a:g,r=[],d=0;d<p.length;d++){var s=p[d],m=s[0].t,x=s[0].trace;x.visible===!0&&x.type==="violin"&&!m.empty&&x.orientation===i&&x.xaxis===g._id&&x.yaxis===a._id&&r.push(d)}b("violin",E,r,n)}}},{"../box/cross_trace_calc":675}],1094:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../components/color"),P=c("../box/defaults"),E=c("./attributes");ae.exports=function(p,g,a,t){function i(u,h){return b.coerce(p,g,E,u,h)}function n(u,h){return b.coerce2(p,g,E,u,h)}if(P.handleSampleDefaults(p,g,i,t),g.visible!==!1){i("bandwidth"),i("side");var r=i("width");r||(i("scalegroup",g.name),i("scalemode"));var d=i("span"),s;Array.isArray(d)&&(s="manual"),i("spanmode",s);var m=i("line.color",(p.marker||{}).color||a),x=i("line.width"),M=i("fillcolor",k.addOpacity(g.line.color,.5));P.handlePointsDefaults(p,g,i,{prefix:""});var v=n("box.width"),_=n("box.fillcolor",M),l=n("box.line.color",m),y=n("box.line.width",x),T=i("box.visible",Boolean(v||_||l||y));T||(g.box={visible:!1});var w=n("meanline.color",m),A=n("meanline.width",x),f=i("meanline.visible",Boolean(w||A));f||(g.meanline={visible:!1})}}},{"../../components/color":366,"../../lib":503,"../box/defaults":676,"./attributes":1091}],1095:[function(c,ae,ie){"use strict";var b=c("../../lib"),k={gaussian:function(P){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*P*P)}};ie.makeKDE=function(P,E,e){var p=e.length,g=k.gaussian,a=P.bandwidth,t=1/(p*a);return function(i){for(var n=0,r=0;r<p;r++)n+=g((i-e[r])/a);return t*n}},ie.getPositionOnKdePath=function(P,E,e){var p,g;E.orientation==="h"?(p="y",g="x"):(p="x",g="y");var a=b.findPointOnPath(P.path,e,g,{pathLength:P.pathLength}),t=P.posCenterPx,i=a[p],n=E.side==="both"?2*t-i:t;return[i,n]},ie.getKdeValue=function(P,E,e){var p=P.pts.map(ie.extractVal),g=ie.makeKDE(P,E,p);return g(e)/P.posDensityScale},ie.extractVal=function(P){return P.v}},{"../../lib":503}],1096:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../../plots/cartesian/axes"),P=c("../box/hover"),E=c("./helpers");ae.exports=function(p,g,a,t,i){i||(i={});var n=i.hoverLayer,r=p.cd,d=r[0].trace,s=d.hoveron,m=s.indexOf("violins")!==-1,x=s.indexOf("kde")!==-1,M=[],v,_;if(m||x){var l=P.hoverOnBoxes(p,g,a,t);if(x&&l.length>0){var y=p.xa,T=p.ya,w,A,f,u,h;d.orientation==="h"?(h=g,w="y",f=T,A="x",u=y):(h=a,w="x",f=y,A="y",u=T);var o=r[p.index];if(h>=o.span[0]&&h<=o.span[1]){var S=b.extendFlat({},p),R=u.c2p(h,!0),z=E.getKdeValue(o,d,h),O=E.getPositionOnKdePath(o,d,R),I=f._offset,F=f._length;S[w+"0"]=O[0],S[w+"1"]=O[1],S[A+"0"]=S[A+"1"]=R,S[A+"Label"]=A+": "+k.hoverLabelText(u,h,d[A+"hoverformat"])+", "+r[0].t.labels.kde+" "+z.toFixed(3),S.spikeDistance=l[0].spikeDistance;var D=w+"Spike";S[D]=l[0][D],l[0].spikeDistance=void 0,l[0][D]=void 0,S.hovertemplate=!1,M.push(S),_={stroke:p.color},_[w+"1"]=b.constrain(I+O[0],I,I+F),_[w+"2"]=b.constrain(I+O[1],I,I+F),_[A+"1"]=_[A+"2"]=u._offset+R}}m&&(M=M.concat(l))}s.indexOf("points")!==-1&&(v=P.hoverOnPoints(p,g,a));var B=n.selectAll(".violinline-"+d.uid).data(_?[0]:[]);return B.enter().append("line").classed("violinline-"+d.uid,!0).attr("stroke-width",1.5),B.exit().remove(),B.attr(_),t==="closest"?v?[v]:M:(v&&M.push(v),M)}},{"../../lib":503,"../../plots/cartesian/axes":554,"../box/hover":678,"./helpers":1095}],1097:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults"),crossTraceDefaults:c("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc"),crossTraceCalc:c("./cross_trace_calc"),plot:c("./plot"),style:c("./style"),styleOnSelect:c("../scatter/style").styleOnSelect,hoverPoints:c("./hover"),selectPoints:c("../box/select"),moduleType:"trace",name:"violin",basePlotModule:c("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../box/defaults":676,"../box/select":683,"../scatter/style":951,"./attributes":1091,"./calc":1092,"./cross_trace_calc":1093,"./defaults":1094,"./hover":1096,"./layout_attributes":1098,"./layout_defaults":1099,"./plot":1100,"./style":1101}],1098:[function(c,ae,ie){"use strict";var b=c("../box/layout_attributes"),k=c("../../lib").extendFlat;ae.exports={violinmode:k({},b.boxmode,{}),violingap:k({},b.boxgap,{}),violingroupgap:k({},b.boxgroupgap,{})}},{"../../lib":503,"../box/layout_attributes":680}],1099:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes"),P=c("../box/layout_defaults");ae.exports=function(e,p,g){function a(t,i){return b.coerce(e,p,k,t,i)}P._supply(e,p,g,a,"violin")}},{"../../lib":503,"../box/layout_defaults":681,"./layout_attributes":1098}],1100:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../components/drawing"),E=c("../box/plot"),e=c("../scatter/line_points"),p=c("./helpers");ae.exports=function(a,t,i,n){var r=a._fullLayout,d=t.xaxis,s=t.yaxis;function m(x){var M=e(x,{xaxis:d,yaxis:s,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return P.smoothopen(M[0],1)}k.makeTraceGroups(n,i,"trace violins").each(function(x){var M=b.select(this),v=x[0],_=v.t,l=v.trace;if(l.visible!==!0||_.empty){M.remove();return}var y=_.bPos,T=_.bdPos,w=t[_.valLetter+"axis"],A=t[_.posLetter+"axis"],f=l.side==="both",u=f||l.side==="positive",h=f||l.side==="negative",o=M.selectAll("path.violin").data(k.identity);o.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),o.exit().remove(),o.each(function(B){var U=b.select(this),X=B.density,oe=X.length,se=A.c2l(B.pos+y,!0),q=A.l2p(se),K;if(l.width)K=_.maxKDE/T;else{var G=r._violinScaleGroupStats[l.scalegroup];K=l.scalemode==="count"?G.maxKDE/T*(G.maxCount/B.pts.length):G.maxKDE/T}var Q,V,H,ee,J,W,re;if(u){for(W=new Array(oe),ee=0;ee<oe;ee++)re=W[ee]={},re[_.posLetter]=se+X[ee].v/K,re[_.valLetter]=w.c2l(X[ee].t,!0);Q=m(W)}if(h){for(W=new Array(oe),J=0,ee=oe-1;J<oe;J++,ee--)re=W[J]={},re[_.posLetter]=se-X[ee].v/K,re[_.valLetter]=w.c2l(X[ee].t,!0);V=m(W)}if(f)H=Q+"L"+V.substr(1)+"Z";else{var j=[q,w.c2p(X[0].t)],Z=[q,w.c2p(X[oe-1].t)];l.orientation==="h"&&(j.reverse(),Z.reverse()),u?H="M"+j+"L"+Q.substr(1)+"L"+Z:H="M"+Z+"L"+V.substr(1)+"L"+j}U.attr("d",H),B.posCenterPx=q,B.posDensityScale=K*T,B.path=U.node(),B.pathLength=B.path.getTotalLength()/(f?2:1)});var S=l.box,R=S.width,z=(S.line||{}).width,O,I;f?(O=T*R,I=0):u?(O=[0,T*R/2],I=z*{x:1,y:-1}[_.posLetter]):(O=[T*R/2,0],I=z*{x:-1,y:1}[_.posLetter]),E.plotBoxAndWhiskers(M,{pos:A,val:w},l,{bPos:y,bdPos:O,bPosPxOffset:I}),E.plotBoxMean(M,{pos:A,val:w},l,{bPos:y,bdPos:O,bPosPxOffset:I});var F;!l.box.visible&&l.meanline.visible&&(F=k.identity);var D=M.selectAll("path.meanline").data(F||[]);D.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),D.exit().remove(),D.each(function(B){var U=w.c2p(B.mean,!0),X=p.getPositionOnKdePath(B,l,U);b.select(this).attr("d",l.orientation==="h"?"M"+U+","+X[0]+"V"+X[1]:"M"+X[0]+","+U+"H"+X[1])}),E.plotPoints(M,{x:d,y:s},l,_)})}},{"../../components/drawing":388,"../../lib":503,"../box/plot":682,"../scatter/line_points":941,"./helpers":1095,"@plotly/d3":58}],1101:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/color"),P=c("../scatter/style").stylePoints;ae.exports=function(e){var p=b.select(e).selectAll("g.trace.violins");p.style("opacity",function(g){return g[0].trace.opacity}),p.each(function(g){var a=g[0].trace,t=b.select(this),i=a.box||{},n=i.line||{},r=a.meanline||{},d=r.width;t.selectAll("path.violin").style("stroke-width",a.line.width+"px").call(k.stroke,a.line.color).call(k.fill,a.fillcolor),t.selectAll("path.box").style("stroke-width",n.width+"px").call(k.stroke,n.color).call(k.fill,i.fillcolor);var s={"stroke-width":d+"px","stroke-dasharray":2*d+"px,"+d+"px"};t.selectAll("path.mean").style(s).call(k.stroke,r.color),t.selectAll("path.meanline").style(s).call(k.stroke,r.color),P(t,a,e)})}},{"../../components/color":366,"../scatter/style":951,"@plotly/d3":58}],1102:[function(c,ae,ie){"use strict";var b=c("../../components/colorscale/attributes"),k=c("../isosurface/attributes"),P=c("../surface/attributes"),E=c("../../plots/attributes"),e=c("../../lib/extend").extendFlat,p=c("../../plot_api/edit_types").overrideAll,g=ae.exports=p(e({x:k.x,y:k.y,z:k.z,value:k.value,isomin:k.isomin,isomax:k.isomax,surface:k.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:k.slices,caps:k.caps,text:k.text,hovertext:k.hovertext,xhoverformat:k.xhoverformat,yhoverformat:k.yhoverformat,zhoverformat:k.zhoverformat,valuehoverformat:k.valuehoverformat,hovertemplate:k.hovertemplate},b("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:k.colorbar,opacity:k.opacity,opacityscale:P.opacityscale,lightposition:k.lightposition,lighting:k.lighting,flatshading:k.flatshading,contour:k.contour,hoverinfo:e({},E.hoverinfo),showlegend:e({},E.showlegend,{dflt:!1})}),"calc","nested");g.x.editType=g.y.editType=g.z.editType=g.value.editType="calc+clearAxisTypes",g.transforms=void 0},{"../../components/colorscale/attributes":373,"../../lib/extend":493,"../../plot_api/edit_types":536,"../../plots/attributes":550,"../isosurface/attributes":862,"../surface/attributes":1061}],1103:[function(c,ae,ie){"use strict";var b=c("../../../stackgl_modules").gl_mesh3d,k=c("../../lib/gl_format_color").parseColorScale,P=c("../../lib/str2rgbarray"),E=c("../../components/colorscale").extractOpts,e=c("../../plots/gl3d/zip3"),p=c("../isosurface/convert").findNearestOnAxis,g=c("../isosurface/convert").generateIsoMeshes;function a(n,r,d){this.scene=n,this.uid=d,this.mesh=r,this.name="",this.data=null,this.showContour=!1}var t=a.prototype;t.handlePick=function(n){if(n.object===this.mesh){var r=n.data.index,d=this.data._meshX[r],s=this.data._meshY[r],m=this.data._meshZ[r],x=this.data._Ys.length,M=this.data._Zs.length,v=p(d,this.data._Xs).id,_=p(s,this.data._Ys).id,l=p(m,this.data._Zs).id,y=n.index=l+M*_+M*x*v;n.traceCoordinate=[this.data._meshX[y],this.data._meshY[y],this.data._meshZ[y],this.data._value[y]];var T=this.data.hovertext||this.data.text;return Array.isArray(T)&&T[y]!==void 0?n.textLabel=T[y]:T&&(n.textLabel=T),!0}},t.update=function(n){var r=this.scene,d=r.fullSceneLayout;this.data=g(n);function s(_,l,y,T){return l.map(function(w){return _.d2l(w,0,T)*y})}var m=e(s(d.xaxis,n._meshX,r.dataScale[0],n.xcalendar),s(d.yaxis,n._meshY,r.dataScale[1],n.ycalendar),s(d.zaxis,n._meshZ,r.dataScale[2],n.zcalendar)),x=e(n._meshI,n._meshJ,n._meshK),M={positions:m,cells:x,lightPosition:[n.lightposition.x,n.lightposition.y,n.lightposition.z],ambient:n.lighting.ambient,diffuse:n.lighting.diffuse,specular:n.lighting.specular,roughness:n.lighting.roughness,fresnel:n.lighting.fresnel,vertexNormalsEpsilon:n.lighting.vertexnormalsepsilon,faceNormalsEpsilon:n.lighting.facenormalsepsilon,opacity:n.opacity,opacityscale:n.opacityscale,contourEnable:n.contour.show,contourColor:P(n.contour.color).slice(0,3),contourWidth:n.contour.width,useFacetNormals:n.flatshading},v=E(n);M.vertexIntensity=n._meshIntensity,M.vertexIntensityBounds=[v.min,v.max],M.colormap=k(n),this.mesh.update(M)},t.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};function i(n,r){var d=n.glplot.gl,s=b({gl:d}),m=new a(n,s,r.uid);return s._trace=m,m.update(r),n.glplot.add(s),m}ae.exports=i},{"../../../stackgl_modules":1124,"../../components/colorscale":378,"../../lib/gl_format_color":499,"../../lib/str2rgbarray":528,"../../plots/gl3d/zip3":609,"../isosurface/convert":864}],1104:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./attributes"),P=c("../isosurface/defaults").supplyIsoDefaults,E=c("../surface/defaults").opacityscaleDefaults;ae.exports=function(p,g,a,t){function i(n,r){return b.coerce(p,g,k,n,r)}P(p,g,a,t,i),E(p,g,t,i)}},{"../../lib":503,"../isosurface/defaults":865,"../surface/defaults":1064,"./attributes":1102}],1105:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),supplyDefaults:c("./defaults"),calc:c("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:c("./convert"),moduleType:"trace",name:"volume",basePlotModule:c("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":598,"../isosurface/calc":863,"./attributes":1102,"./convert":1103,"./defaults":1104}],1106:[function(c,ae,ie){"use strict";var b=c("../bar/attributes"),k=c("../scatter/attributes").line,P=c("../../plots/attributes"),E=c("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=c("../../plots/template_attributes").hovertemplateAttrs,p=c("../../plots/template_attributes").texttemplateAttrs,g=c("./constants"),a=c("../../lib/extend").extendFlat,t=c("../../components/color");function i(n){return{marker:{color:a({},b.marker.color,{arrayOk:!1,editType:"style"}),line:{color:a({},b.marker.line.color,{arrayOk:!1,editType:"style"}),width:a({},b.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}ae.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:b.x,x0:b.x0,dx:b.dx,y:b.y,y0:b.y0,dy:b.dy,xperiod:b.xperiod,yperiod:b.yperiod,xperiod0:b.xperiod0,yperiod0:b.yperiod0,xperiodalignment:b.xperiodalignment,yperiodalignment:b.yperiodalignment,xhoverformat:E("x"),yhoverformat:E("y"),hovertext:b.hovertext,hovertemplate:e({},{keys:g.eventDataKeys}),hoverinfo:a({},P.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:p({editType:"plot"},{keys:g.eventDataKeys.concat(["label"])}),text:b.text,textposition:b.textposition,insidetextanchor:b.insidetextanchor,textangle:b.textangle,textfont:b.textfont,insidetextfont:b.insidetextfont,outsidetextfont:b.outsidetextfont,constraintext:b.constraintext,cliponaxis:b.cliponaxis,orientation:b.orientation,offset:b.offset,width:b.width,increasing:i("increasing"),decreasing:i("decreasing"),totals:i("intermediate sums and total"),connector:{line:{color:a({},k.color,{dflt:t.defaultLine}),width:a({},k.width,{editType:"plot"}),dash:k.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:b.offsetgroup,alignmentgroup:b.alignmentgroup}},{"../../components/color":366,"../../lib/extend":493,"../../plots/attributes":550,"../../plots/cartesian/axis_format_attributes":557,"../../plots/template_attributes":633,"../bar/attributes":648,"../scatter/attributes":927,"./constants":1108}],1107:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes"),k=c("../../plots/cartesian/align_period"),P=c("../../lib").mergeArray,E=c("../scatter/calc_selection"),e=c("../../constants/numerical").BADNUM;function p(a){return a==="a"||a==="absolute"}function g(a){return a==="t"||a==="total"}ae.exports=function(t,i){var n=b.getFromId(t,i.xaxis||"x"),r=b.getFromId(t,i.yaxis||"y"),d,s,m,x,M,v;i.orientation==="h"?(d=n.makeCalcdata(i,"x"),m=r.makeCalcdata(i,"y"),x=k(i,r,"y",m),M=!!i.yperiodalignment,v="y"):(d=r.makeCalcdata(i,"y"),m=n.makeCalcdata(i,"x"),x=k(i,n,"x",m),M=!!i.xperiodalignment,v="x"),s=x.vals;for(var _=Math.min(s.length,d.length),l=new Array(_),y=0,T,w=!1,A=0;A<_;A++){var f=d[A]||0,u=!1;(d[A]!==e||g(i.measure[A])||p(i.measure[A]))&&A+1<_&&(d[A+1]!==e||g(i.measure[A+1])||p(i.measure[A+1]))&&(u=!0);var h=l[A]={i:A,p:s[A],s:f,rawS:f,cNext:u};p(i.measure[A])?(y=h.s,h.isSum=!0,h.dir="totals",h.s=y):g(i.measure[A])?(h.isSum=!0,h.dir="totals",h.s=y):(h.isSum=!1,h.dir=h.rawS<0?"decreasing":"increasing",T=h.s,h.s=y+T,y+=T),h.dir==="totals"&&(w=!0),M&&(l[A].orig_p=m[A],l[A][v+"End"]=x.ends[A],l[A][v+"Start"]=x.starts[A]),i.ids&&(h.id=String(i.ids[A])),h.v=(i.base||0)+y}return l.length&&(l[0].hasTotals=w),P(i.text,l,"tx"),P(i.hovertext,l,"htx"),E(l,i),l}},{"../../constants/numerical":479,"../../lib":503,"../../plots/cartesian/align_period":551,"../../plots/cartesian/axes":554,"../scatter/calc_selection":929}],1108:[function(c,ae,ie){"use strict";ae.exports={eventDataKeys:["initial","delta","final"]}},{}],1109:[function(c,ae,ie){"use strict";var b=c("../bar/cross_trace_calc").setGroupPositions;ae.exports=function(P,E){var e=P._fullLayout,p=P._fullData,g=P.calcdata,a=E.xaxis,t=E.yaxis,i=[],n=[],r=[],d,s;for(s=0;s<p.length;s++){var m=p[s];m.visible===!0&&m.xaxis===a._id&&m.yaxis===t._id&&m.type==="waterfall"&&(d=g[s],m.orientation==="h"?r.push(d):n.push(d),i.push(d))}var x={mode:e.waterfallmode,norm:e.waterfallnorm,gap:e.waterfallgap,groupgap:e.waterfallgroupgap};for(b(P,a,t,n,x),b(P,t,a,r,x),s=0;s<i.length;s++){d=i[s];for(var M=0;M<d.length;M++){var v=d[M];v.isSum===!1&&(v.s0+=M===0?0:d[M-1].s),M+1<d.length&&(d[M].nextP0=d[M+1].p0,d[M].nextS0=d[M+1].s0)}}}},{"../bar/cross_trace_calc":651}],1110:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("../bar/defaults").handleGroupingDefaults,P=c("../bar/defaults").handleText,E=c("../scatter/xy_defaults"),e=c("../scatter/period_defaults"),p=c("./attributes"),g=c("../../components/color"),a=c("../../constants/delta.js"),t=a.INCREASING.COLOR,i=a.DECREASING.COLOR,n="#4499FF";function r(m,x,M){m(x+".marker.color",M),m(x+".marker.line.color",g.defaultLine),m(x+".marker.line.width")}function d(m,x,M,v){function _(A,f){return b.coerce(m,x,p,A,f)}var l=E(m,x,v,_);if(!l){x.visible=!1;return}e(m,x,v,_),_("xhoverformat"),_("yhoverformat"),_("measure"),_("orientation",x.x&&!x.y?"h":"v"),_("base"),_("offset"),_("width"),_("text"),_("hovertext"),_("hovertemplate");var y=_("textposition");P(m,x,v,_,y,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),x.textposition!=="none"&&(_("texttemplate"),x.texttemplate||_("textinfo")),r(_,"increasing",t),r(_,"decreasing",i),r(_,"totals",n);var T=_("connector.visible");if(T){_("connector.mode");var w=_("connector.line.width");w&&(_("connector.line.color"),_("connector.line.dash"))}}function s(m,x){var M,v;function _(y){return b.coerce(v._input,v,p,y)}if(x.waterfallmode==="group")for(var l=0;l<m.length;l++)v=m[l],M=v._input,k(M,v,x,_)}ae.exports={supplyDefaults:d,crossTraceDefaults:s}},{"../../components/color":366,"../../constants/delta.js":473,"../../lib":503,"../bar/defaults":652,"../scatter/period_defaults":947,"../scatter/xy_defaults":954,"./attributes":1106}],1111:[function(c,ae,ie){"use strict";ae.exports=function(k,P){return k.x="xVal"in P?P.xVal:P.x,k.y="yVal"in P?P.yVal:P.y,"initial"in P&&(k.initial=P.initial),"delta"in P&&(k.delta=P.delta),"final"in P&&(k.final=P.final),P.xa&&(k.xaxis=P.xa),P.ya&&(k.yaxis=P.ya),k}},{}],1112:[function(c,ae,ie){"use strict";var b=c("../../plots/cartesian/axes").hoverLabelText,k=c("../../components/color").opacity,P=c("../bar/hover").hoverOnBars,E=c("../../constants/delta.js"),e={increasing:E.INCREASING.SYMBOL,decreasing:E.DECREASING.SYMBOL};ae.exports=function(a,t,i,n,r){var d=P(a,t,i,n,r);if(!d)return;var s=d.cd,m=s[0].trace,x=m.orientation==="h",M=x?"x":"y",v=x?a.xa:a.ya;function _(S){return b(v,S,m[M+"hoverformat"])}var l=d.index,y=s[l],T=y.isSum?y.b+y.s:y.rawS;if(!y.isSum){d.initial=y.b+y.s-T,d.delta=T,d.final=d.initial+d.delta;var w=_(Math.abs(d.delta));d.deltaLabel=T<0?"("+w+")":w,d.finalLabel=_(d.final),d.initialLabel=_(d.initial)}var A=y.hi||m.hoverinfo,f=[];if(A&&A!=="none"&&A!=="skip"){var u=A==="all",h=A.split("+"),o=function(S){return u||h.indexOf(S)!==-1};y.isSum||(o("final")&&(x?!o("x"):!o("y"))&&f.push(d.finalLabel),o("delta")&&(T<0?f.push(d.deltaLabel+" "+e.decreasing):f.push(d.deltaLabel+" "+e.increasing)),o("initial")&&f.push("Initial: "+d.initialLabel))}return f.length&&(d.extraText=f.join("<br>")),d.color=p(m,y),[d]};function p(g,a){var t=g[a.dir].marker,i=t.color,n=t.line.color,r=t.line.width;if(k(i))return i;if(k(n)&&r)return n}},{"../../components/color":366,"../../constants/delta.js":473,"../../plots/cartesian/axes":554,"../bar/hover":655}],1113:[function(c,ae,ie){"use strict";ae.exports={attributes:c("./attributes"),layoutAttributes:c("./layout_attributes"),supplyDefaults:c("./defaults").supplyDefaults,crossTraceDefaults:c("./defaults").crossTraceDefaults,supplyLayoutDefaults:c("./layout_defaults"),calc:c("./calc"),crossTraceCalc:c("./cross_trace_calc"),plot:c("./plot"),style:c("./style").style,hoverPoints:c("./hover"),eventData:c("./event_data"),selectPoints:c("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:c("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":568,"../bar/select":660,"./attributes":1106,"./calc":1107,"./cross_trace_calc":1109,"./defaults":1110,"./event_data":1111,"./hover":1112,"./layout_attributes":1114,"./layout_defaults":1115,"./plot":1116,"./style":1117}],1114:[function(c,ae,ie){"use strict";ae.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1115:[function(c,ae,ie){"use strict";var b=c("../../lib"),k=c("./layout_attributes");ae.exports=function(P,E,e){var p=!1;function g(i,n){return b.coerce(P,E,k,i,n)}for(var a=0;a<e.length;a++){var t=e[a];if(t.visible&&t.type==="waterfall"){p=!0;break}}p&&(g("waterfallmode"),g("waterfallgap",.2),g("waterfallgroupgap"))}},{"../../lib":503,"./layout_attributes":1114}],1116:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../lib"),P=c("../../components/drawing"),E=c("../../constants/numerical").BADNUM,e=c("../bar/plot"),p=c("../bar/uniform_text").clearMinTextSize;ae.exports=function(i,n,r,d){var s=i._fullLayout;p("waterfall",s),e.plot(i,n,r,d,{mode:s.waterfallmode,norm:s.waterfallmode,gap:s.waterfallgap,groupgap:s.waterfallgroupgap}),g(i,n,r,d)};function g(t,i,n,r){var d=i.xaxis,s=i.yaxis;k.makeTraceGroups(r,n,"trace bars").each(function(m){var x=b.select(this),M=m[0].trace,v=k.ensureSingle(x,"g","lines");if(!M.connector||!M.connector.visible){v.remove();return}var _=M.orientation==="h",l=M.connector.mode,y=v.selectAll("g.line").data(k.identity);y.enter().append("g").classed("line",!0),y.exit().remove();var T=y.size();y.each(function(w,A){if(!(A!==T-1&&!w.cNext)){var f=a(w,d,s,_),u=f[0],h=f[1],o="";u[0]!==E&&h[0]!==E&&u[1]!==E&&h[1]!==E&&(l==="spanning"&&!w.isSum&&A>0&&(_?o+="M"+u[0]+","+h[1]+"V"+h[0]:o+="M"+u[1]+","+h[0]+"H"+u[0]),l!=="between"&&(w.isSum||A<T-1)&&(_?o+="M"+u[1]+","+h[0]+"V"+h[1]:o+="M"+u[0]+","+h[1]+"H"+u[1]),u[2]!==E&&h[2]!==E&&(_?o+="M"+u[1]+","+h[1]+"V"+h[2]:o+="M"+u[1]+","+h[1]+"H"+u[2])),o===""&&(o="M0,0Z"),k.ensureSingle(b.select(this),"path").attr("d",o).call(P.setClipUrl,i.layerClipId,t)}})})}function a(t,i,n,r){var d=[],s=[],m=r?i:n,x=r?n:i;return d[0]=m.c2p(t.s0,!0),s[0]=x.c2p(t.p0,!0),d[1]=m.c2p(t.s1,!0),s[1]=x.c2p(t.p1,!0),d[2]=m.c2p(t.nextS0,!0),s[2]=x.c2p(t.nextP0,!0),r?[d,s]:[s,d]}},{"../../components/drawing":388,"../../constants/numerical":479,"../../lib":503,"../bar/plot":659,"../bar/uniform_text":664,"@plotly/d3":58}],1117:[function(c,ae,ie){"use strict";var b=c("@plotly/d3"),k=c("../../components/drawing"),P=c("../../components/color"),E=c("../../constants/interactions").DESELECTDIM,e=c("../bar/style"),p=c("../bar/uniform_text").resizeText,g=e.styleTextPoints;function a(t,i,n){var r=n||b.select(t).selectAll("g.waterfalllayer").selectAll("g.trace");p(t,r,"waterfall"),r.style("opacity",function(d){return d[0].trace.opacity}),r.each(function(d){var s=b.select(this),m=d[0].trace;s.selectAll(".point > path").each(function(x){if(!x.isBlank){var M=m[x.dir].marker;b.select(this).call(P.fill,M.color).call(P.stroke,M.line.color).call(k.dashLine,M.line.dash,M.line.width).style("opacity",m.selectedpoints&&!x.selected?E:1)}}),g(s,m,t),s.selectAll(".lines").each(function(){var x=m.connector.line;k.lineGroupStyle(b.select(this).selectAll("path"),x.width,x.color,x.dash)})})}ae.exports={style:a}},{"../../components/color":366,"../../components/drawing":388,"../../constants/interactions":478,"../bar/style":662,"../bar/uniform_text":664,"@plotly/d3":58}],1118:[function(c,ae,ie){"use strict";var b=c("../plots/cartesian/axes"),k=c("../lib"),P=c("../plot_api/plot_schema"),E=c("./helpers").pointsAccessorFunction,e=c("../constants/numerical").BADNUM;ie.moduleType="transform",ie.name="aggregate";var p=ie.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},g=p.aggregations;ie.supplyDefaults=function(d,s){var m={},x;function M(S,R){return k.coerce(d,m,p,S,R)}var v=M("enabled");if(!v)return m;var _=P.findArrayAttributes(s),l={};for(x=0;x<_.length;x++)l[_[x]]=1;var y=M("groups");if(!Array.isArray(y)){if(!l[y])return m.enabled=!1,m;l[y]=0}var T=d.aggregations||[],w=m.aggregations=new Array(T.length),A;function f(S,R){return k.coerce(T[x],A,g,S,R)}for(x=0;x<T.length;x++){A={_index:x};var u=f("target"),h=f("func"),o=f("enabled");o&&u&&(l[u]||h==="count"&&l[u]===void 0)?(h==="stddev"&&f("funcmode"),l[u]=0,w[x]=A):w[x]={enabled:!1,_index:x}}for(x=0;x<_.length;x++)l[_[x]]&&w.push({target:_[x],func:g.func.dflt,enabled:!0,_index:-1});return m},ie.calcTransform=function(d,s,m){if(!!m.enabled){var x=m.groups,M=k.getTargetArray(s,{target:x});if(!!M){var v,_,l,y,T={},w={},A=[],f=E(s.transforms,m),u=M.length;for(s._length&&(u=Math.min(u,s._length)),v=0;v<u;v++)_=M[v],l=T[_],l===void 0?(T[_]=A.length,y=[v],A.push(y),w[T[_]]=f(v)):(A[l].push(v),w[T[_]]=(w[T[_]]||[]).concat(f(v)));m._indexToPoints=w;var h=m.aggregations;for(v=0;v<h.length;v++)a(d,s,A,h[v]);typeof x=="string"&&a(d,s,A,{target:x,func:"first",enabled:!0}),s._length=A.length}}};function a(d,s,m,x){if(!!x.enabled){for(var M=x.target,v=k.nestedProperty(s,M),_=v.get(),l=b.getDataConversions(d,s,M,_),y=t(x,l),T=new Array(m.length),w=0;w<m.length;w++)T[w]=y(_,m[w]);v.set(T),x.func==="count"&&k.pushUnique(s._arrayAttrs,M)}}function t(d,s){var m=d.func,x=s.d2c,M=s.c2d;switch(m){case"count":return i;case"first":return n;case"last":return r;case"sum":return function(v,_){for(var l=0,y=0;y<_.length;y++){var T=x(v[_[y]]);T!==e&&(l+=T)}return M(l)};case"avg":return function(v,_){for(var l=0,y=0,T=0;T<_.length;T++){var w=x(v[_[T]]);w!==e&&(l+=w,y++)}return y?M(l/y):e};case"min":return function(v,_){for(var l=1/0,y=0;y<_.length;y++){var T=x(v[_[y]]);T!==e&&(l=Math.min(l,T))}return l===1/0?e:M(l)};case"max":return function(v,_){for(var l=-1/0,y=0;y<_.length;y++){var T=x(v[_[y]]);T!==e&&(l=Math.max(l,T))}return l===-1/0?e:M(l)};case"range":return function(v,_){for(var l=1/0,y=-1/0,T=0;T<_.length;T++){var w=x(v[_[T]]);w!==e&&(l=Math.min(l,w),y=Math.max(y,w))}return y===-1/0||l===1/0?e:M(y-l)};case"change":return function(v,_){var l=x(v[_[0]]),y=x(v[_[_.length-1]]);return l===e||y===e?e:M(y-l)};case"median":return function(v,_){for(var l=[],y=0;y<_.length;y++){var T=x(v[_[y]]);T!==e&&l.push(T)}if(!l.length)return e;l.sort(k.sorterAsc);var w=(l.length-1)/2;return M((l[Math.floor(w)]+l[Math.ceil(w)])/2)};case"mode":return function(v,_){for(var l={},y=0,T=e,w=0;w<_.length;w++){var A=x(v[_[w]]);if(A!==e){var f=l[A]=(l[A]||0)+1;f>y&&(y=f,T=A)}}return y?M(T):e};case"rms":return function(v,_){for(var l=0,y=0,T=0;T<_.length;T++){var w=x(v[_[T]]);w!==e&&(l+=w*w,y++)}return y?M(Math.sqrt(l/y)):e};case"stddev":return function(v,_){var l=0,y=0,T=1,w=e,A;for(A=0;A<_.length&&w===e;A++)w=x(v[_[A]]);if(w===e)return e;for(;A<_.length;A++){var f=x(v[_[A]]);if(f!==e){var u=f-w;l+=u,y+=u*u,T++}}var h=d.funcmode==="sample"?T-1:T;return h?Math.sqrt((y-l*l/T)/h):0}}}function i(d,s){return s.length}function n(d,s){return d[s[0]]}function r(d,s){return d[s[s.length-1]]}},{"../constants/numerical":479,"../lib":503,"../plot_api/plot_schema":542,"../plots/cartesian/axes":554,"./helpers":1121}],1119:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("../registry"),P=c("../plots/cartesian/axes"),E=c("./helpers").pointsAccessorFunction,e=c("../constants/filter_ops"),p=e.COMPARISON_OPS,g=e.INTERVAL_OPS,a=e.SET_OPS;ie.moduleType="transform",ie.name="filter",ie.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(p).concat(g).concat(a),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},ie.supplyDefaults=function(i){var n={};function r(x,M){return b.coerce(i,n,ie.attributes,x,M)}var d=r("enabled");if(d){var s=r("target");if(b.isArrayOrTypedArray(s)&&s.length===0)return n.enabled=!1,n;r("preservegaps"),r("operation"),r("value");var m=k.getComponentMethod("calendars","handleDefaults");m(i,n,"valuecalendar",null),m(i,n,"targetcalendar",null)}return n},ie.calcTransform=function(i,n,r){if(!r.enabled)return;var d=b.getTargetArray(n,r);if(!d)return;var s=r.target,m=d.length;n._length&&(m=Math.min(m,n._length));var x=r.targetcalendar,M=n._arrayAttrs,v=r.preservegaps;if(typeof s=="string"){var _=b.nestedProperty(n,s+"calendar").get();_&&(x=_)}var l=P.getDataToCoordFunc(i,n,s,d),y=t(r,l,x),T={},w={},A=0;function f(z,O){for(var I=0;I<M.length;I++){var F=b.nestedProperty(n,M[I]);z(F,O)}}var u,h;v?(u=function(z){T[z.astr]=b.extendDeep([],z.get()),z.set(new Array(m))},h=function(z,O){var I=T[z.astr][O];z.get()[O]=I}):(u=function(z){T[z.astr]=b.extendDeep([],z.get()),z.set([])},h=function(z,O){var I=T[z.astr][O];z.get().push(I)}),f(u);for(var o=E(n.transforms,r),S=0;S<m;S++){var R=y(d[S]);R?(f(h,S),w[A++]=o(S)):v&&A++}r._indexToPoints=w,n._length=A};function t(i,n,r){var d=i.operation,s=i.value,m=Array.isArray(s);function x(l){return l.indexOf(d)!==-1}var M=function(l){return n(l,0,i.valuecalendar)},v=function(l){return n(l,0,r)},_;switch(x(p)?_=M(m?s[0]:s):x(g)?_=m?[M(s[0]),M(s[1])]:[M(s),M(s)]:x(a)&&(_=m?s.map(M):[M(s)]),d){case"=":return function(l){return v(l)===_};case"!=":return function(l){return v(l)!==_};case"<":return function(l){return v(l)<_};case"<=":return function(l){return v(l)<=_};case">":return function(l){return v(l)>_};case">=":return function(l){return v(l)>=_};case"[]":return function(l){var y=v(l);return y>=_[0]&&y<=_[1]};case"()":return function(l){var y=v(l);return y>_[0]&&y<_[1]};case"[)":return function(l){var y=v(l);return y>=_[0]&&y<_[1]};case"(]":return function(l){var y=v(l);return y>_[0]&&y<=_[1]};case"][":return function(l){var y=v(l);return y<=_[0]||y>=_[1]};case")(":return function(l){var y=v(l);return y<_[0]||y>_[1]};case"](":return function(l){var y=v(l);return y<=_[0]||y>_[1]};case")[":return function(l){var y=v(l);return y<_[0]||y>=_[1]};case"{}":return function(l){return _.indexOf(v(l))!==-1};case"}{":return function(l){return _.indexOf(v(l))===-1}}}},{"../constants/filter_ops":475,"../lib":503,"../plots/cartesian/axes":554,"../registry":638,"./helpers":1121}],1120:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("../plot_api/plot_schema"),P=c("../plots/plots"),E=c("./helpers").pointsAccessorFunction;ie.moduleType="transform",ie.name="groupby",ie.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},ie.supplyDefaults=function(p,g,a){var t,i={};function n(M,v){return b.coerce(p,i,ie.attributes,M,v)}var r=n("enabled");if(!r)return i;n("groups"),n("nameformat",a._dataLength>1?"%{group} (%{trace})":"%{group}");var d=p.styles,s=i.styles=[];if(d)for(t=0;t<d.length;t++){var m=s[t]={};b.coerce(d[t],s[t],ie.attributes.styles,"target");var x=b.coerce(d[t],s[t],ie.attributes.styles,"value");b.isPlainObject(x)?m.value=b.extendDeep({},x):x&&delete m.value}return i},ie.transform=function(p,g){var a,t,i,n=[];for(t=0;t<p.length;t++)for(a=e(p[t],g),i=0;i<a.length;i++)n.push(a[i]);return n};function e(p,g){var a,t,i,n,r,d,s,m,x,M,v=g.transform,_=g.transformIndex,l=p.transforms[_].groups,y=E(p.transforms,v);if(!b.isArrayOrTypedArray(l)||l.length===0)return[p];var T=b.filterUnique(l),w=new Array(T.length),A=l.length,f=k.findArrayAttributes(p),u=v.styles||[],h={};for(a=0;a<u.length;a++)h[u[a].target]=u[a].value;v.styles&&(M=b.keyedContainer(v,"styles","target","value.name"));var o={},S={};for(a=0;a<T.length;a++){d=T[a],o[d]=a,S[d]=0,s=w[a]=b.extendDeepNoArrays({},p),s._group=d,s.transforms[_]._indexToPoints={};var R=null;for(M&&(R=M.get(d)),R||R===""?s.name=R:s.name=b.templateString(v.nameformat,{trace:p.name,group:d}),m=s.transforms,s.transforms=[],t=0;t<m.length;t++)s.transforms[t]=b.extendDeepNoArrays({},m[t]);for(t=0;t<f.length;t++)b.nestedProperty(s,f[t]).set([])}for(i=0;i<f.length;i++){for(n=f[i],t=0,x=[];t<T.length;t++)x[t]=b.nestedProperty(w[t],n).get();for(r=b.nestedProperty(p,n).get(),t=0;t<A;t++)x[o[l[t]]].push(r[t])}for(t=0;t<A;t++){s=w[o[l[t]]];var z=s.transforms[_]._indexToPoints;z[S[l[t]]]=y(t),S[l[t]]++}for(a=0;a<T.length;a++)d=T[a],s=w[a],P.clearExpandedTraceDefaultColors(s),s=b.extendDeepNoArrays(s,h[d]||{});return w}},{"../lib":503,"../plot_api/plot_schema":542,"../plots/plots":619,"./helpers":1121}],1121:[function(c,ae,ie){"use strict";ie.pointsAccessorFunction=function(b,k){for(var P,E,e=0;e<b.length&&(P=b[e],P!==k);e++)!P._indexToPoints||P.enabled===!1||(E=P._indexToPoints);var p=E?function(g){return E[g]}:function(g){return[g]};return p}},{}],1122:[function(c,ae,ie){"use strict";var b=c("../lib"),k=c("../plots/cartesian/axes"),P=c("./helpers").pointsAccessorFunction,E=c("../constants/numerical").BADNUM;ie.moduleType="transform",ie.name="sort",ie.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},ie.supplyDefaults=function(g){var a={};function t(n,r){return b.coerce(g,a,ie.attributes,n,r)}var i=t("enabled");return i&&(t("target"),t("order")),a},ie.calcTransform=function(g,a,t){if(!!t.enabled){var i=b.getTargetArray(a,t);if(!!i){var n=t.target,r=i.length;a._length&&(r=Math.min(r,a._length));var d=a._arrayAttrs,s=k.getDataToCoordFunc(g,a,n,i),m=e(t,i,s,r),x=P(a.transforms,t),M={},v,_;for(v=0;v<d.length;v++){var l=b.nestedProperty(a,d[v]),y=l.get(),T=new Array(r);for(_=0;_<r;_++)T[_]=y[m[_]];l.set(T)}for(_=0;_<r;_++)M[_]=x(m[_]);t._indexToPoints=M,a._length=r}}};function e(g,a,t,i){var n=new Array(i),r=new Array(i),d;for(d=0;d<i;d++)n[d]={v:a[d],i:d};for(n.sort(p(g,t)),d=0;d<i;d++)r[d]=n[d].i;return r}function p(g,a){switch(g.order){case"ascending":return function(t,i){var n=a(t.v),r=a(i.v);return n===E?1:r===E?-1:n-r};case"descending":return function(t,i){var n=a(t.v),r=a(i.v);return n===E?1:r===E?-1:r-n}}}},{"../constants/numerical":479,"../lib":503,"../plots/cartesian/axes":554,"./helpers":1121}],1123:[function(c,ae,ie){"use strict";ie.version="2.11.0"},{}],1124:[function(c,ae,ie){(function(b){(function(){(function(k){if(typeof ie=="object"&&typeof ae<"u")ae.exports=k();else if(typeof Vr=="function"&&Vr.amd)Vr([],k);else{var P;typeof window<"u"?P=window:typeof b<"u"?P=b:typeof self<"u"?P=self:P=this,P.stackgl=k()}})(function(){var k,P,E;return function(){function e(p,g,a){function t(r,d){if(!g[r]){if(!p[r]){var s=typeof c=="function"&&c;if(!d&&s)return s(r,!0);if(i)return i(r,!0);var m=new Error("Cannot find module '"+r+"'");throw m.code="MODULE_NOT_FOUND",m}var x=g[r]={exports:{}};p[r][0].call(x.exports,function(M){var v=p[r][1][M];return t(v||M)},x,x.exports,e,p,g,a)}return g[r].exports}for(var i=typeof c=="function"&&c,n=0;n<a.length;n++)t(a[n]);return t}return e}()({1:[function(e,p,g){"use strict";g.byteLength=m,g.toByteArray=M,g.fromByteArray=l;for(var a=[],t=[],i=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,d=n.length;r<d;++r)a[r]=n[r],t[n.charCodeAt(r)]=r;t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63;function s(y){var T=y.length;if(T%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var w=y.indexOf("=");w===-1&&(w=T);var A=w===T?0:4-w%4;return[w,A]}function m(y){var T=s(y),w=T[0],A=T[1];return(w+A)*3/4-A}function x(y,T,w){return(T+w)*3/4-w}function M(y){var T,w=s(y),A=w[0],f=w[1],u=new i(x(y,A,f)),h=0,o=f>0?A-4:A,S;for(S=0;S<o;S+=4)T=t[y.charCodeAt(S)]<<18|t[y.charCodeAt(S+1)]<<12|t[y.charCodeAt(S+2)]<<6|t[y.charCodeAt(S+3)],u[h++]=T>>16&255,u[h++]=T>>8&255,u[h++]=T&255;return f===2&&(T=t[y.charCodeAt(S)]<<2|t[y.charCodeAt(S+1)]>>4,u[h++]=T&255),f===1&&(T=t[y.charCodeAt(S)]<<10|t[y.charCodeAt(S+1)]<<4|t[y.charCodeAt(S+2)]>>2,u[h++]=T>>8&255,u[h++]=T&255),u}function v(y){return a[y>>18&63]+a[y>>12&63]+a[y>>6&63]+a[y&63]}function _(y,T,w){for(var A,f=[],u=T;u<w;u+=3)A=(y[u]<<16&16711680)+(y[u+1]<<8&65280)+(y[u+2]&255),f.push(v(A));return f.join("")}function l(y){for(var T,w=y.length,A=w%3,f=[],u=16383,h=0,o=w-A;h<o;h+=u)f.push(_(y,h,h+u>o?o:h+u));return A===1?(T=y[w-1],f.push(a[T>>2]+a[T<<4&63]+"==")):A===2&&(T=(y[w-2]<<8)+y[w-1],f.push(a[T>>10]+a[T>>4&63]+a[T<<2&63]+"=")),f.join("")}},{}],2:[function(e,p,g){},{}],3:[function(e,p,g){(function(a){(function(){"use strict";var t=e("base64-js"),i=e("ieee754");g.Buffer=s,g.SlowBuffer=A,g.INSPECT_MAX_BYTES=50;var n=2147483647;g.kMaxLength=n,s.TYPED_ARRAY_SUPPORT=r(),!s.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function r(){try{var Te=new Uint8Array(1);return Te.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},Te.foo()===42}catch{return!1}}Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(!!s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(!!s.isBuffer(this))return this.byteOffset}});function d(Te){if(Te>n)throw new RangeError('The value "'+Te+'" is invalid for option "size"');var de=new Uint8Array(Te);return de.__proto__=s.prototype,de}function s(Te,de,be){if(typeof Te=="number"){if(typeof de=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(Te)}return m(Te,de,be)}typeof Symbol<"u"&&Symbol.species!=null&&s[Symbol.species]===s&&Object.defineProperty(s,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),s.poolSize=8192;function m(Te,de,be){if(typeof Te=="string")return _(Te,de);if(ArrayBuffer.isView(Te))return l(Te);if(Te==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Te);if(xe(Te,ArrayBuffer)||Te&&xe(Te.buffer,ArrayBuffer))return y(Te,de,be);if(typeof Te=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var Le=Te.valueOf&&Te.valueOf();if(Le!=null&&Le!==Te)return s.from(Le,de,be);var De=T(Te);if(De)return De;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Te[Symbol.toPrimitive]=="function")return s.from(Te[Symbol.toPrimitive]("string"),de,be);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Te)}s.from=function(Te,de,be){return m(Te,de,be)},s.prototype.__proto__=Uint8Array.prototype,s.__proto__=Uint8Array;function x(Te){if(typeof Te!="number")throw new TypeError('"size" argument must be of type number');if(Te<0)throw new RangeError('The value "'+Te+'" is invalid for option "size"')}function M(Te,de,be){return x(Te),Te<=0?d(Te):de!==void 0?typeof be=="string"?d(Te).fill(de,be):d(Te).fill(de):d(Te)}s.alloc=function(Te,de,be){return M(Te,de,be)};function v(Te){return x(Te),d(Te<0?0:w(Te)|0)}s.allocUnsafe=function(Te){return v(Te)},s.allocUnsafeSlow=function(Te){return v(Te)};function _(Te,de){if((typeof de!="string"||de==="")&&(de="utf8"),!s.isEncoding(de))throw new TypeError("Unknown encoding: "+de);var be=f(Te,de)|0,Le=d(be),De=Le.write(Te,de);return De!==be&&(Le=Le.slice(0,De)),Le}function l(Te){for(var de=Te.length<0?0:w(Te.length)|0,be=d(de),Le=0;Le<de;Le+=1)be[Le]=Te[Le]&255;return be}function y(Te,de,be){if(de<0||Te.byteLength<de)throw new RangeError('"offset" is outside of buffer bounds');if(Te.byteLength<de+(be||0))throw new RangeError('"length" is outside of buffer bounds');var Le;return de===void 0&&be===void 0?Le=new Uint8Array(Te):be===void 0?Le=new Uint8Array(Te,de):Le=new Uint8Array(Te,de,be),Le.__proto__=s.prototype,Le}function T(Te){if(s.isBuffer(Te)){var de=w(Te.length)|0,be=d(de);return be.length===0||Te.copy(be,0,0,de),be}if(Te.length!==void 0)return typeof Te.length!="number"||Ee(Te.length)?d(0):l(Te);if(Te.type==="Buffer"&&Array.isArray(Te.data))return l(Te.data)}function w(Te){if(Te>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return Te|0}function A(Te){return+Te!=Te&&(Te=0),s.alloc(+Te)}s.isBuffer=function(de){return de!=null&&de._isBuffer===!0&&de!==s.prototype},s.compare=function(de,be){if(xe(de,Uint8Array)&&(de=s.from(de,de.offset,de.byteLength)),xe(be,Uint8Array)&&(be=s.from(be,be.offset,be.byteLength)),!s.isBuffer(de)||!s.isBuffer(be))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(de===be)return 0;for(var Le=de.length,De=be.length,ye=0,ke=Math.min(Le,De);ye<ke;++ye)if(de[ye]!==be[ye]){Le=de[ye],De=be[ye];break}return Le<De?-1:De<Le?1:0},s.isEncoding=function(de){switch(String(de).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(de,be){if(!Array.isArray(de))throw new TypeError('"list" argument must be an Array of Buffers');if(de.length===0)return s.alloc(0);var Le;if(be===void 0)for(be=0,Le=0;Le<de.length;++Le)be+=de[Le].length;var De=s.allocUnsafe(be),ye=0;for(Le=0;Le<de.length;++Le){var ke=de[Le];if(xe(ke,Uint8Array)&&(ke=s.from(ke)),!s.isBuffer(ke))throw new TypeError('"list" argument must be an Array of Buffers');ke.copy(De,ye),ye+=ke.length}return De};function f(Te,de){if(s.isBuffer(Te))return Te.length;if(ArrayBuffer.isView(Te)||xe(Te,ArrayBuffer))return Te.byteLength;if(typeof Te!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Te);var be=Te.length,Le=arguments.length>2&&arguments[2]===!0;if(!Le&&be===0)return 0;for(var De=!1;;)switch(de){case"ascii":case"latin1":case"binary":return be;case"utf8":case"utf-8":return Z(Te).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return be*2;case"hex":return be>>>1;case"base64":return ge(Te).length;default:if(De)return Le?-1:Z(Te).length;de=(""+de).toLowerCase(),De=!0}}s.byteLength=f;function u(Te,de,be){var Le=!1;if((de===void 0||de<0)&&(de=0),de>this.length||((be===void 0||be>this.length)&&(be=this.length),be<=0)||(be>>>=0,de>>>=0,be<=de))return"";for(Te||(Te="utf8");;)switch(Te){case"hex":return K(this,de,be);case"utf8":case"utf-8":return U(this,de,be);case"ascii":return se(this,de,be);case"latin1":case"binary":return q(this,de,be);case"base64":return B(this,de,be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,de,be);default:if(Le)throw new TypeError("Unknown encoding: "+Te);Te=(Te+"").toLowerCase(),Le=!0}}s.prototype._isBuffer=!0;function h(Te,de,be){var Le=Te[de];Te[de]=Te[be],Te[be]=Le}s.prototype.swap16=function(){var de=this.length;if(de%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var be=0;be<de;be+=2)h(this,be,be+1);return this},s.prototype.swap32=function(){var de=this.length;if(de%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var be=0;be<de;be+=4)h(this,be,be+3),h(this,be+1,be+2);return this},s.prototype.swap64=function(){var de=this.length;if(de%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var be=0;be<de;be+=8)h(this,be,be+7),h(this,be+1,be+6),h(this,be+2,be+5),h(this,be+3,be+4);return this},s.prototype.toString=function(){var de=this.length;return de===0?"":arguments.length===0?U(this,0,de):u.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(de){if(!s.isBuffer(de))throw new TypeError("Argument must be a Buffer");return this===de?!0:s.compare(this,de)===0},s.prototype.inspect=function(){var de="",be=g.INSPECT_MAX_BYTES;return de=this.toString("hex",0,be).replace(/(.{2})/g,"$1 ").trim(),this.length>be&&(de+=" ... "),"<Buffer "+de+">"},s.prototype.compare=function(de,be,Le,De,ye){if(xe(de,Uint8Array)&&(de=s.from(de,de.offset,de.byteLength)),!s.isBuffer(de))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof de);if(be===void 0&&(be=0),Le===void 0&&(Le=de?de.length:0),De===void 0&&(De=0),ye===void 0&&(ye=this.length),be<0||Le>de.length||De<0||ye>this.length)throw new RangeError("out of range index");if(De>=ye&&be>=Le)return 0;if(De>=ye)return-1;if(be>=Le)return 1;if(be>>>=0,Le>>>=0,De>>>=0,ye>>>=0,this===de)return 0;for(var ke=ye-De,Oe=Le-be,Qe=Math.min(ke,Oe),Ve=this.slice(De,ye),Ue=de.slice(be,Le),Ie=0;Ie<Qe;++Ie)if(Ve[Ie]!==Ue[Ie]){ke=Ve[Ie],Oe=Ue[Ie];break}return ke<Oe?-1:Oe<ke?1:0};function o(Te,de,be,Le,De){if(Te.length===0)return-1;if(typeof be=="string"?(Le=be,be=0):be>2147483647?be=2147483647:be<-2147483648&&(be=-2147483648),be=+be,Ee(be)&&(be=De?0:Te.length-1),be<0&&(be=Te.length+be),be>=Te.length){if(De)return-1;be=Te.length-1}else if(be<0)if(De)be=0;else return-1;if(typeof de=="string"&&(de=s.from(de,Le)),s.isBuffer(de))return de.length===0?-1:S(Te,de,be,Le,De);if(typeof de=="number")return de=de&255,typeof Uint8Array.prototype.indexOf=="function"?De?Uint8Array.prototype.indexOf.call(Te,de,be):Uint8Array.prototype.lastIndexOf.call(Te,de,be):S(Te,[de],be,Le,De);throw new TypeError("val must be string, number or Buffer")}function S(Te,de,be,Le,De){var ye=1,ke=Te.length,Oe=de.length;if(Le!==void 0&&(Le=String(Le).toLowerCase(),Le==="ucs2"||Le==="ucs-2"||Le==="utf16le"||Le==="utf-16le")){if(Te.length<2||de.length<2)return-1;ye=2,ke/=2,Oe/=2,be/=2}function Qe(pt,Rt){return ye===1?pt[Rt]:pt.readUInt16BE(Rt*ye)}var Ve;if(De){var Ue=-1;for(Ve=be;Ve<ke;Ve++)if(Qe(Te,Ve)===Qe(de,Ue===-1?0:Ve-Ue)){if(Ue===-1&&(Ue=Ve),Ve-Ue+1===Oe)return Ue*ye}else Ue!==-1&&(Ve-=Ve-Ue),Ue=-1}else for(be+Oe>ke&&(be=ke-Oe),Ve=be;Ve>=0;Ve--){for(var Ie=!0,at=0;at<Oe;at++)if(Qe(Te,Ve+at)!==Qe(de,at)){Ie=!1;break}if(Ie)return Ve}return-1}s.prototype.includes=function(de,be,Le){return this.indexOf(de,be,Le)!==-1},s.prototype.indexOf=function(de,be,Le){return o(this,de,be,Le,!0)},s.prototype.lastIndexOf=function(de,be,Le){return o(this,de,be,Le,!1)};function R(Te,de,be,Le){be=Number(be)||0;var De=Te.length-be;Le?(Le=Number(Le),Le>De&&(Le=De)):Le=De;var ye=de.length;Le>ye/2&&(Le=ye/2);for(var ke=0;ke<Le;++ke){var Oe=parseInt(de.substr(ke*2,2),16);if(Ee(Oe))return ke;Te[be+ke]=Oe}return ke}function z(Te,de,be,Le){return pe(Z(de,Te.length-be),Te,be,Le)}function O(Te,de,be,Le){return pe(ne(de),Te,be,Le)}function I(Te,de,be,Le){return O(Te,de,be,Le)}function F(Te,de,be,Le){return pe(ge(de),Te,be,Le)}function D(Te,de,be,Le){return pe(le(de,Te.length-be),Te,be,Le)}s.prototype.write=function(de,be,Le,De){if(be===void 0)De="utf8",Le=this.length,be=0;else if(Le===void 0&&typeof be=="string")De=be,Le=this.length,be=0;else if(isFinite(be))be=be>>>0,isFinite(Le)?(Le=Le>>>0,De===void 0&&(De="utf8")):(De=Le,Le=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ye=this.length-be;if((Le===void 0||Le>ye)&&(Le=ye),de.length>0&&(Le<0||be<0)||be>this.length)throw new RangeError("Attempt to write outside buffer bounds");De||(De="utf8");for(var ke=!1;;)switch(De){case"hex":return R(this,de,be,Le);case"utf8":case"utf-8":return z(this,de,be,Le);case"ascii":return O(this,de,be,Le);case"latin1":case"binary":return I(this,de,be,Le);case"base64":return F(this,de,be,Le);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,de,be,Le);default:if(ke)throw new TypeError("Unknown encoding: "+De);De=(""+De).toLowerCase(),ke=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function B(Te,de,be){return de===0&&be===Te.length?t.fromByteArray(Te):t.fromByteArray(Te.slice(de,be))}function U(Te,de,be){be=Math.min(Te.length,be);for(var Le=[],De=de;De<be;){var ye=Te[De],ke=null,Oe=ye>239?4:ye>223?3:ye>191?2:1;if(De+Oe<=be){var Qe,Ve,Ue,Ie;switch(Oe){case 1:ye<128&&(ke=ye);break;case 2:Qe=Te[De+1],(Qe&192)===128&&(Ie=(ye&31)<<6|Qe&63,Ie>127&&(ke=Ie));break;case 3:Qe=Te[De+1],Ve=Te[De+2],(Qe&192)===128&&(Ve&192)===128&&(Ie=(ye&15)<<12|(Qe&63)<<6|Ve&63,Ie>2047&&(Ie<55296||Ie>57343)&&(ke=Ie));break;case 4:Qe=Te[De+1],Ve=Te[De+2],Ue=Te[De+3],(Qe&192)===128&&(Ve&192)===128&&(Ue&192)===128&&(Ie=(ye&15)<<18|(Qe&63)<<12|(Ve&63)<<6|Ue&63,Ie>65535&&Ie<1114112&&(ke=Ie))}}ke===null?(ke=65533,Oe=1):ke>65535&&(ke-=65536,Le.push(ke>>>10&1023|55296),ke=56320|ke&1023),Le.push(ke),De+=Oe}return oe(Le)}var X=4096;function oe(Te){var de=Te.length;if(de<=X)return String.fromCharCode.apply(String,Te);for(var be="",Le=0;Le<de;)be+=String.fromCharCode.apply(String,Te.slice(Le,Le+=X));return be}function se(Te,de,be){var Le="";be=Math.min(Te.length,be);for(var De=de;De<be;++De)Le+=String.fromCharCode(Te[De]&127);return Le}function q(Te,de,be){var Le="";be=Math.min(Te.length,be);for(var De=de;De<be;++De)Le+=String.fromCharCode(Te[De]);return Le}function K(Te,de,be){var Le=Te.length;(!de||de<0)&&(de=0),(!be||be<0||be>Le)&&(be=Le);for(var De="",ye=de;ye<be;++ye)De+=j(Te[ye]);return De}function G(Te,de,be){for(var Le=Te.slice(de,be),De="",ye=0;ye<Le.length;ye+=2)De+=String.fromCharCode(Le[ye]+Le[ye+1]*256);return De}s.prototype.slice=function(de,be){var Le=this.length;de=~~de,be=be===void 0?Le:~~be,de<0?(de+=Le,de<0&&(de=0)):de>Le&&(de=Le),be<0?(be+=Le,be<0&&(be=0)):be>Le&&(be=Le),be<de&&(be=de);var De=this.subarray(de,be);return De.__proto__=s.prototype,De};function Q(Te,de,be){if(Te%1!==0||Te<0)throw new RangeError("offset is not uint");if(Te+de>be)throw new RangeError("Trying to access beyond buffer length")}s.prototype.readUIntLE=function(de,be,Le){de=de>>>0,be=be>>>0,Le||Q(de,be,this.length);for(var De=this[de],ye=1,ke=0;++ke<be&&(ye*=256);)De+=this[de+ke]*ye;return De},s.prototype.readUIntBE=function(de,be,Le){de=de>>>0,be=be>>>0,Le||Q(de,be,this.length);for(var De=this[de+--be],ye=1;be>0&&(ye*=256);)De+=this[de+--be]*ye;return De},s.prototype.readUInt8=function(de,be){return de=de>>>0,be||Q(de,1,this.length),this[de]},s.prototype.readUInt16LE=function(de,be){return de=de>>>0,be||Q(de,2,this.length),this[de]|this[de+1]<<8},s.prototype.readUInt16BE=function(de,be){return de=de>>>0,be||Q(de,2,this.length),this[de]<<8|this[de+1]},s.prototype.readUInt32LE=function(de,be){return de=de>>>0,be||Q(de,4,this.length),(this[de]|this[de+1]<<8|this[de+2]<<16)+this[de+3]*16777216},s.prototype.readUInt32BE=function(de,be){return de=de>>>0,be||Q(de,4,this.length),this[de]*16777216+(this[de+1]<<16|this[de+2]<<8|this[de+3])},s.prototype.readIntLE=function(de,be,Le){de=de>>>0,be=be>>>0,Le||Q(de,be,this.length);for(var De=this[de],ye=1,ke=0;++ke<be&&(ye*=256);)De+=this[de+ke]*ye;return ye*=128,De>=ye&&(De-=Math.pow(2,8*be)),De},s.prototype.readIntBE=function(de,be,Le){de=de>>>0,be=be>>>0,Le||Q(de,be,this.length);for(var De=be,ye=1,ke=this[de+--De];De>0&&(ye*=256);)ke+=this[de+--De]*ye;return ye*=128,ke>=ye&&(ke-=Math.pow(2,8*be)),ke},s.prototype.readInt8=function(de,be){return de=de>>>0,be||Q(de,1,this.length),this[de]&128?(255-this[de]+1)*-1:this[de]},s.prototype.readInt16LE=function(de,be){de=de>>>0,be||Q(de,2,this.length);var Le=this[de]|this[de+1]<<8;return Le&32768?Le|4294901760:Le},s.prototype.readInt16BE=function(de,be){de=de>>>0,be||Q(de,2,this.length);var Le=this[de+1]|this[de]<<8;return Le&32768?Le|4294901760:Le},s.prototype.readInt32LE=function(de,be){return de=de>>>0,be||Q(de,4,this.length),this[de]|this[de+1]<<8|this[de+2]<<16|this[de+3]<<24},s.prototype.readInt32BE=function(de,be){return de=de>>>0,be||Q(de,4,this.length),this[de]<<24|this[de+1]<<16|this[de+2]<<8|this[de+3]},s.prototype.readFloatLE=function(de,be){return de=de>>>0,be||Q(de,4,this.length),i.read(this,de,!0,23,4)},s.prototype.readFloatBE=function(de,be){return de=de>>>0,be||Q(de,4,this.length),i.read(this,de,!1,23,4)},s.prototype.readDoubleLE=function(de,be){return de=de>>>0,be||Q(de,8,this.length),i.read(this,de,!0,52,8)},s.prototype.readDoubleBE=function(de,be){return de=de>>>0,be||Q(de,8,this.length),i.read(this,de,!1,52,8)};function V(Te,de,be,Le,De,ye){if(!s.isBuffer(Te))throw new TypeError('"buffer" argument must be a Buffer instance');if(de>De||de<ye)throw new RangeError('"value" argument is out of bounds');if(be+Le>Te.length)throw new RangeError("Index out of range")}s.prototype.writeUIntLE=function(de,be,Le,De){if(de=+de,be=be>>>0,Le=Le>>>0,!De){var ye=Math.pow(2,8*Le)-1;V(this,de,be,Le,ye,0)}var ke=1,Oe=0;for(this[be]=de&255;++Oe<Le&&(ke*=256);)this[be+Oe]=de/ke&255;return be+Le},s.prototype.writeUIntBE=function(de,be,Le,De){if(de=+de,be=be>>>0,Le=Le>>>0,!De){var ye=Math.pow(2,8*Le)-1;V(this,de,be,Le,ye,0)}var ke=Le-1,Oe=1;for(this[be+ke]=de&255;--ke>=0&&(Oe*=256);)this[be+ke]=de/Oe&255;return be+Le},s.prototype.writeUInt8=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,1,255,0),this[be]=de&255,be+1},s.prototype.writeUInt16LE=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,2,65535,0),this[be]=de&255,this[be+1]=de>>>8,be+2},s.prototype.writeUInt16BE=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,2,65535,0),this[be]=de>>>8,this[be+1]=de&255,be+2},s.prototype.writeUInt32LE=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,4,4294967295,0),this[be+3]=de>>>24,this[be+2]=de>>>16,this[be+1]=de>>>8,this[be]=de&255,be+4},s.prototype.writeUInt32BE=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,4,4294967295,0),this[be]=de>>>24,this[be+1]=de>>>16,this[be+2]=de>>>8,this[be+3]=de&255,be+4},s.prototype.writeIntLE=function(de,be,Le,De){if(de=+de,be=be>>>0,!De){var ye=Math.pow(2,8*Le-1);V(this,de,be,Le,ye-1,-ye)}var ke=0,Oe=1,Qe=0;for(this[be]=de&255;++ke<Le&&(Oe*=256);)de<0&&Qe===0&&this[be+ke-1]!==0&&(Qe=1),this[be+ke]=(de/Oe>>0)-Qe&255;return be+Le},s.prototype.writeIntBE=function(de,be,Le,De){if(de=+de,be=be>>>0,!De){var ye=Math.pow(2,8*Le-1);V(this,de,be,Le,ye-1,-ye)}var ke=Le-1,Oe=1,Qe=0;for(this[be+ke]=de&255;--ke>=0&&(Oe*=256);)de<0&&Qe===0&&this[be+ke+1]!==0&&(Qe=1),this[be+ke]=(de/Oe>>0)-Qe&255;return be+Le},s.prototype.writeInt8=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,1,127,-128),de<0&&(de=255+de+1),this[be]=de&255,be+1},s.prototype.writeInt16LE=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,2,32767,-32768),this[be]=de&255,this[be+1]=de>>>8,be+2},s.prototype.writeInt16BE=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,2,32767,-32768),this[be]=de>>>8,this[be+1]=de&255,be+2},s.prototype.writeInt32LE=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,4,2147483647,-2147483648),this[be]=de&255,this[be+1]=de>>>8,this[be+2]=de>>>16,this[be+3]=de>>>24,be+4},s.prototype.writeInt32BE=function(de,be,Le){return de=+de,be=be>>>0,Le||V(this,de,be,4,2147483647,-2147483648),de<0&&(de=4294967295+de+1),this[be]=de>>>24,this[be+1]=de>>>16,this[be+2]=de>>>8,this[be+3]=de&255,be+4};function H(Te,de,be,Le,De,ye){if(be+Le>Te.length)throw new RangeError("Index out of range");if(be<0)throw new RangeError("Index out of range")}function ee(Te,de,be,Le,De){return de=+de,be=be>>>0,De||H(Te,de,be,4,34028234663852886e22,-34028234663852886e22),i.write(Te,de,be,Le,23,4),be+4}s.prototype.writeFloatLE=function(de,be,Le){return ee(this,de,be,!0,Le)},s.prototype.writeFloatBE=function(de,be,Le){return ee(this,de,be,!1,Le)};function J(Te,de,be,Le,De){return de=+de,be=be>>>0,De||H(Te,de,be,8,17976931348623157e292,-17976931348623157e292),i.write(Te,de,be,Le,52,8),be+8}s.prototype.writeDoubleLE=function(de,be,Le){return J(this,de,be,!0,Le)},s.prototype.writeDoubleBE=function(de,be,Le){return J(this,de,be,!1,Le)},s.prototype.copy=function(de,be,Le,De){if(!s.isBuffer(de))throw new TypeError("argument should be a Buffer");if(Le||(Le=0),!De&&De!==0&&(De=this.length),be>=de.length&&(be=de.length),be||(be=0),De>0&&De<Le&&(De=Le),De===Le||de.length===0||this.length===0)return 0;if(be<0)throw new RangeError("targetStart out of bounds");if(Le<0||Le>=this.length)throw new RangeError("Index out of range");if(De<0)throw new RangeError("sourceEnd out of bounds");De>this.length&&(De=this.length),de.length-be<De-Le&&(De=de.length-be+Le);var ye=De-Le;if(this===de&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(be,Le,De);else if(this===de&&Le<be&&be<De)for(var ke=ye-1;ke>=0;--ke)de[ke+be]=this[ke+Le];else Uint8Array.prototype.set.call(de,this.subarray(Le,De),be);return ye},s.prototype.fill=function(de,be,Le,De){if(typeof de=="string"){if(typeof be=="string"?(De=be,be=0,Le=this.length):typeof Le=="string"&&(De=Le,Le=this.length),De!==void 0&&typeof De!="string")throw new TypeError("encoding must be a string");if(typeof De=="string"&&!s.isEncoding(De))throw new TypeError("Unknown encoding: "+De);if(de.length===1){var ye=de.charCodeAt(0);(De==="utf8"&&ye<128||De==="latin1")&&(de=ye)}}else typeof de=="number"&&(de=de&255);if(be<0||this.length<be||this.length<Le)throw new RangeError("Out of range index");if(Le<=be)return this;be=be>>>0,Le=Le===void 0?this.length:Le>>>0,de||(de=0);var ke;if(typeof de=="number")for(ke=be;ke<Le;++ke)this[ke]=de;else{var Oe=s.isBuffer(de)?de:s.from(de,De),Qe=Oe.length;if(Qe===0)throw new TypeError('The value "'+de+'" is invalid for argument "value"');for(ke=0;ke<Le-be;++ke)this[ke+be]=Oe[ke%Qe]}return this};var W=/[^+/0-9A-Za-z-_]/g;function re(Te){if(Te=Te.split("=")[0],Te=Te.trim().replace(W,""),Te.length<2)return"";for(;Te.length%4!==0;)Te=Te+"=";return Te}function j(Te){return Te<16?"0"+Te.toString(16):Te.toString(16)}function Z(Te,de){de=de||1/0;for(var be,Le=Te.length,De=null,ye=[],ke=0;ke<Le;++ke){if(be=Te.charCodeAt(ke),be>55295&&be<57344){if(!De){if(be>56319){(de-=3)>-1&&ye.push(239,191,189);continue}else if(ke+1===Le){(de-=3)>-1&&ye.push(239,191,189);continue}De=be;continue}if(be<56320){(de-=3)>-1&&ye.push(239,191,189),De=be;continue}be=(De-55296<<10|be-56320)+65536}else De&&(de-=3)>-1&&ye.push(239,191,189);if(De=null,be<128){if((de-=1)<0)break;ye.push(be)}else if(be<2048){if((de-=2)<0)break;ye.push(be>>6|192,be&63|128)}else if(be<65536){if((de-=3)<0)break;ye.push(be>>12|224,be>>6&63|128,be&63|128)}else if(be<1114112){if((de-=4)<0)break;ye.push(be>>18|240,be>>12&63|128,be>>6&63|128,be&63|128)}else throw new Error("Invalid code point")}return ye}function ne(Te){for(var de=[],be=0;be<Te.length;++be)de.push(Te.charCodeAt(be)&255);return de}function le(Te,de){for(var be,Le,De,ye=[],ke=0;ke<Te.length&&!((de-=2)<0);++ke)be=Te.charCodeAt(ke),Le=be>>8,De=be%256,ye.push(De),ye.push(Le);return ye}function ge(Te){return t.toByteArray(re(Te))}function pe(Te,de,be,Le){for(var De=0;De<Le&&!(De+be>=de.length||De>=Te.length);++De)de[De+be]=Te[De];return De}function xe(Te,de){return Te instanceof de||Te!=null&&Te.constructor!=null&&Te.constructor.name!=null&&Te.constructor.name===de.name}function Ee(Te){return Te!==Te}}).call(this)}).call(this,e("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(e,p,g){g.read=function(a,t,i,n,r){var d,s,m=r*8-n-1,x=(1<<m)-1,M=x>>1,v=-7,_=i?r-1:0,l=i?-1:1,y=a[t+_];for(_+=l,d=y&(1<<-v)-1,y>>=-v,v+=m;v>0;d=d*256+a[t+_],_+=l,v-=8);for(s=d&(1<<-v)-1,d>>=-v,v+=n;v>0;s=s*256+a[t+_],_+=l,v-=8);if(d===0)d=1-M;else{if(d===x)return s?NaN:(y?-1:1)*(1/0);s=s+Math.pow(2,n),d=d-M}return(y?-1:1)*s*Math.pow(2,d-n)},g.write=function(a,t,i,n,r,d){var s,m,x,M=d*8-r-1,v=(1<<M)-1,_=v>>1,l=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:d-1,T=n?1:-1,w=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(m=isNaN(t)?1:0,s=v):(s=Math.floor(Math.log(t)/Math.LN2),t*(x=Math.pow(2,-s))<1&&(s--,x*=2),s+_>=1?t+=l/x:t+=l*Math.pow(2,1-_),t*x>=2&&(s++,x/=2),s+_>=v?(m=0,s=v):s+_>=1?(m=(t*x-1)*Math.pow(2,r),s=s+_):(m=t*Math.pow(2,_-1)*Math.pow(2,r),s=0));r>=8;a[i+y]=m&255,y+=T,m/=256,r-=8);for(s=s<<r|m,M+=r;M>0;a[i+y]=s&255,y+=T,s/=256,M-=8);a[i+y-T]|=w*128}},{}],5:[function(e,p,g){var a=p.exports={},t,i;function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?t=setTimeout:t=n}catch{t=n}try{typeof clearTimeout=="function"?i=clearTimeout:i=r}catch{i=r}})();function d(w){if(t===setTimeout)return setTimeout(w,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(w,0);try{return t(w,0)}catch{try{return t.call(null,w,0)}catch{return t.call(this,w,0)}}}function s(w){if(i===clearTimeout)return clearTimeout(w);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(w);try{return i(w)}catch{try{return i.call(null,w)}catch{return i.call(this,w)}}}var m=[],x=!1,M,v=-1;function _(){!x||!M||(x=!1,M.length?m=M.concat(m):v=-1,m.length&&l())}function l(){if(!x){var w=d(_);x=!0;for(var A=m.length;A;){for(M=m,m=[];++v<A;)M&&M[v].run();v=-1,A=m.length}M=null,x=!1,s(w)}}a.nextTick=function(w){var A=new Array(arguments.length-1);if(arguments.length>1)for(var f=1;f<arguments.length;f++)A[f-1]=arguments[f];m.push(new y(w,A)),m.length===1&&!x&&d(l)};function y(w,A){this.fun=w,this.array=A}y.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={};function T(){}a.on=T,a.addListener=T,a.once=T,a.off=T,a.removeListener=T,a.removeAllListeners=T,a.emit=T,a.prependListener=T,a.prependOnceListener=T,a.listeners=function(w){return[]},a.binding=function(w){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(w){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],6:[function(e,p,g){p.exports={alpha_shape:e("alpha-shape"),convex_hull:e("convex-hull"),delaunay_triangulate:e("delaunay-triangulate"),gl_cone3d:e("gl-cone3d"),gl_error3d:e("gl-error3d"),gl_heatmap2d:e("gl-heatmap2d"),gl_line3d:e("gl-line3d"),gl_mesh3d:e("gl-mesh3d"),gl_plot2d:e("gl-plot2d"),gl_plot3d:e("gl-plot3d"),gl_pointcloud2d:e("gl-pointcloud2d"),gl_scatter3d:e("gl-scatter3d"),gl_select_box:e("gl-select-box"),gl_spikes2d:e("gl-spikes2d"),gl_streamtube3d:e("gl-streamtube3d"),gl_surface3d:e("gl-surface3d"),ndarray:e("ndarray"),ndarray_linear_interpolate:e("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(e,p,g){"use strict";p.exports=d;var a=e("turntable-camera-controller"),t=e("orbit-camera-controller"),i=e("matrix-camera-controller");function n(s,m){this._controllerNames=Object.keys(s),this._controllerList=this._controllerNames.map(function(x){return s[x]}),this._mode=m,this._active=s[m],this._active||(this._mode="turntable",this._active=s.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var r=n.prototype;r.flush=function(s){for(var m=this._controllerList,x=0;x<m.length;++x)m[x].flush(s)},r.idle=function(s){for(var m=this._controllerList,x=0;x<m.length;++x)m[x].idle(s)},r.lookAt=function(s,m,x,M){for(var v=this._controllerList,_=0;_<v.length;++_)v[_].lookAt(s,m,x,M)},r.rotate=function(s,m,x,M){for(var v=this._controllerList,_=0;_<v.length;++_)v[_].rotate(s,m,x,M)},r.pan=function(s,m,x,M){for(var v=this._controllerList,_=0;_<v.length;++_)v[_].pan(s,m,x,M)},r.translate=function(s,m,x,M){for(var v=this._controllerList,_=0;_<v.length;++_)v[_].translate(s,m,x,M)},r.setMatrix=function(s,m){for(var x=this._controllerList,M=0;M<x.length;++M)x[M].setMatrix(s,m)},r.setDistanceLimits=function(s,m){for(var x=this._controllerList,M=0;M<x.length;++M)x[M].setDistanceLimits(s,m)},r.setDistance=function(s,m){for(var x=this._controllerList,M=0;M<x.length;++M)x[M].setDistance(s,m)},r.recalcMatrix=function(s){this._active.recalcMatrix(s)},r.getDistance=function(s){return this._active.getDistance(s)},r.getDistanceLimits=function(s){return this._active.getDistanceLimits(s)},r.lastT=function(){return this._active.lastT()},r.setMode=function(s){if(s!==this._mode){var m=this._controllerNames.indexOf(s);if(!(m<0)){var x=this._active,M=this._controllerList[m],v=Math.max(x.lastT(),M.lastT());x.recalcMatrix(v),M.setMatrix(v,x.computedMatrix),this._active=M,this._mode=s,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},r.getMode=function(){return this._mode};function d(s){s=s||{};var m=s.eye||[0,0,1],x=s.center||[0,0,0],M=s.up||[0,1,0],v=s.distanceLimits||[0,1/0],_=s.mode||"turntable",l=a(),y=t(),T=i();return l.setDistanceLimits(v[0],v[1]),l.lookAt(0,m,x,M),y.setDistanceLimits(v[0],v[1]),y.lookAt(0,m,x,M),T.setDistanceLimits(v[0],v[1]),T.lookAt(0,m,x,M),new n({turntable:l,orbit:y,matrix:T},_)}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(e,p,g){"use strict";var a=typeof WeakMap>"u"?e("weak-map"):WeakMap,t=e("gl-buffer"),i=e("gl-vao"),n=new a;function r(d){var s=n.get(d),m=s&&(s._triangleBuffer.handle||s._triangleBuffer.buffer);if(!m||!d.isBuffer(m)){var x=t(d,new Float32Array([-1,-1,-1,4,4,-1]));s=i(d,[{buffer:x,type:d.FLOAT,size:2}]),s._triangleBuffer=x,n.set(d,s)}s.bind(),d.drawArrays(d.TRIANGLES,0,3),s.unbind()}p.exports=r},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(e,p,g){var a=e("pad-left");p.exports=t;function t(i,n,r){n=typeof n=="number"?n:1,r=r||": ";var d=i.split(/\r?\n/),s=String(d.length+n-1).length;return d.map(function(m,x){var M=x+n,v=String(M).length,_=a(M,s-v);return _+r+m}).join(`
`)}},{"pad-left":264}],10:[function(e,p,g){"use strict";p.exports=i;var a=e("robust-orientation");function t(n,r){for(var d=new Array(r+1),s=0;s<n.length;++s)d[s]=n[s];for(var s=0;s<=n.length;++s){for(var m=n.length;m<=r;++m){for(var x=new Array(r),M=0;M<r;++M)x[M]=Math.pow(m+1-s,M);d[m]=x}var v=a.apply(void 0,d);if(v)return!0}return!1}function i(n){var r=n.length;if(r===0)return[];if(r===1)return[0];for(var d=n[0].length,s=[n[0]],m=[0],x=1;x<r;++x){if(s.push(n[x]),!t(s,d)){s.pop();continue}if(m.push(x),m.length===d+1)return m}return m}},{"robust-orientation":284}],11:[function(e,p,g){"use strict";p.exports=i;var a=e("delaunay-triangulate"),t=e("circumradius");function i(n,r){return a(r).filter(function(d){for(var s=new Array(d.length),m=0;m<d.length;++m)s[m]=r[d[m]];return t(s)*n<1})}},{circumradius:49,"delaunay-triangulate":63}],12:[function(e,p,g){p.exports=i;var a=e("alpha-complex"),t=e("simplicial-complex-boundary");function i(n,r){return t(a(n,r))}},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(e,p,g){p.exports=function(t){return atob(t)}},{}],14:[function(e,p,g){"use strict";p.exports=i;var a=e("robust-linear-solve");function t(n){for(var r=0,d=0;d<n.length;++d)r+=n[d];return r}function i(n,r){for(var d=r.length,s=new Array(d+1),m=0;m<d;++m){for(var x=new Array(d+1),M=0;M<=d;++M)x[M]=n[M][m];s[m]=x}s[d]=new Array(d+1);for(var m=0;m<=d;++m)s[d][m]=1;for(var v=new Array(d+1),m=0;m<d;++m)v[m]=r[m];v[d]=1;var _=a(s,v),l=t(_[d+1]);l===0&&(l=1);for(var y=new Array(d+1),m=0;m<=d;++m)y[m]=t(_[m])/l;return y}},{"robust-linear-solve":283}],15:[function(e,p,g){"use strict";var a=e("./lib/rationalize");p.exports=t;function t(i,n){return a(i[0].mul(n[1]).add(n[0].mul(i[1])),i[1].mul(n[1]))}},{"./lib/rationalize":25}],16:[function(e,p,g){"use strict";p.exports=a;function a(t,i){return t[0].mul(i[1]).cmp(i[0].mul(t[1]))}},{}],17:[function(e,p,g){"use strict";var a=e("./lib/rationalize");p.exports=t;function t(i,n){return a(i[0].mul(n[1]),i[1].mul(n[0]))}},{"./lib/rationalize":25}],18:[function(e,p,g){"use strict";var a=e("./is-rat"),t=e("./lib/is-bn"),i=e("./lib/num-to-bn"),n=e("./lib/str-to-bn"),r=e("./lib/rationalize"),d=e("./div");p.exports=s;function s(m,x){if(a(m))return x?d(m,s(x)):[m[0].clone(),m[1].clone()];var M=0,v,_;if(t(m))v=m.clone();else if(typeof m=="string")v=n(m);else{if(m===0)return[i(0),i(1)];if(m===Math.floor(m))v=i(m);else{for(;m!==Math.floor(m);)m=m*Math.pow(2,256),M-=256;v=i(m)}}if(a(x))v.mul(x[1]),_=x[0].clone();else if(t(x))_=x.clone();else if(typeof x=="string")_=n(x);else if(!x)_=i(1);else if(x===Math.floor(x))_=i(x);else{for(;x!==Math.floor(x);)x=x*Math.pow(2,256),M+=256;_=i(x)}return M>0?v=v.ushln(M):M<0&&(_=_.ushln(-M)),r(v,_)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(e,p,g){"use strict";var a=e("./lib/is-bn");p.exports=t;function t(i){return Array.isArray(i)&&i.length===2&&a(i[0])&&a(i[1])}},{"./lib/is-bn":23}],20:[function(e,p,g){"use strict";var a=e("bn.js");p.exports=t;function t(i){return i.cmp(new a(0))}},{"bn.js":33}],21:[function(e,p,g){"use strict";var a=e("./bn-sign");p.exports=t;function t(i){var n=i.length,r=i.words,d=0;if(n===1)d=r[0];else if(n===2)d=r[0]+r[1]*67108864;else for(var s=0;s<n;s++){var m=r[s];d+=m*Math.pow(67108864,s)}return a(i)*d}},{"./bn-sign":20}],22:[function(e,p,g){"use strict";var a=e("double-bits"),t=e("bit-twiddle").countTrailingZeros;p.exports=i;function i(n){var r=t(a.lo(n));if(r<32)return r;var d=t(a.hi(n));return d>20?52:d+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(e,p,g){"use strict";var a=e("bn.js");p.exports=t;function t(i){return i&&typeof i=="object"&&Boolean(i.words)}},{"bn.js":33}],24:[function(e,p,g){"use strict";var a=e("bn.js"),t=e("double-bits");p.exports=i;function i(n){var r=t.exponent(n);return r<52?new a(n):new a(n*Math.pow(2,52-r)).ushln(r-52)}},{"bn.js":33,"double-bits":64}],25:[function(e,p,g){"use strict";var a=e("./num-to-bn"),t=e("./bn-sign");p.exports=i;function i(n,r){var d=t(n),s=t(r);if(d===0)return[a(0),a(1)];if(s===0)return[a(0),a(0)];s<0&&(n=n.neg(),r=r.neg());var m=n.gcd(r);return m.cmpn(1)?[n.div(m),r.div(m)]:[n,r]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(e,p,g){"use strict";var a=e("bn.js");p.exports=t;function t(i){return new a(i)}},{"bn.js":33}],27:[function(e,p,g){"use strict";var a=e("./lib/rationalize");p.exports=t;function t(i,n){return a(i[0].mul(n[0]),i[1].mul(n[1]))}},{"./lib/rationalize":25}],28:[function(e,p,g){"use strict";var a=e("./lib/bn-sign");p.exports=t;function t(i){return a(i[0])*a(i[1])}},{"./lib/bn-sign":20}],29:[function(e,p,g){"use strict";var a=e("./lib/rationalize");p.exports=t;function t(i,n){return a(i[0].mul(n[1]).sub(i[1].mul(n[0])),i[1].mul(n[1]))}},{"./lib/rationalize":25}],30:[function(e,p,g){"use strict";var a=e("./lib/bn-to-num"),t=e("./lib/ctz");p.exports=i;function i(n){var r=n[0],d=n[1];if(r.cmpn(0)===0)return 0;var s=r.abs().divmod(d.abs()),m=s.div,x=a(m),M=s.mod,v=r.negative!==d.negative?-1:1;if(M.cmpn(0)===0)return v*x;if(x){var _=t(x)+4,l=a(M.ushln(_).divRound(d));return v*(x+l*Math.pow(2,-_))}else{var y=d.bitLength()-M.bitLength()+53,l=a(M.ushln(y).divRound(d));return y<1023?v*l*Math.pow(2,-y):(l*=Math.pow(2,-1023),v*l*Math.pow(2,1023-y))}}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(e,p,g){"use strict";function a(s,m,x,M,v){for(var _=v+1;M<=v;){var l=M+v>>>1,y=s[l],T=x!==void 0?x(y,m):y-m;T>=0?(_=l,v=l-1):M=l+1}return _}function t(s,m,x,M,v){for(var _=v+1;M<=v;){var l=M+v>>>1,y=s[l],T=x!==void 0?x(y,m):y-m;T>0?(_=l,v=l-1):M=l+1}return _}function i(s,m,x,M,v){for(var _=M-1;M<=v;){var l=M+v>>>1,y=s[l],T=x!==void 0?x(y,m):y-m;T<0?(_=l,M=l+1):v=l-1}return _}function n(s,m,x,M,v){for(var _=M-1;M<=v;){var l=M+v>>>1,y=s[l],T=x!==void 0?x(y,m):y-m;T<=0?(_=l,M=l+1):v=l-1}return _}function r(s,m,x,M,v){for(;M<=v;){var _=M+v>>>1,l=s[_],y=x!==void 0?x(l,m):l-m;if(y===0)return _;y<=0?M=_+1:v=_-1}return-1}function d(s,m,x,M,v,_){return typeof x=="function"?_(s,m,x,M===void 0?0:M|0,v===void 0?s.length-1:v|0):_(s,m,void 0,x===void 0?0:x|0,M===void 0?s.length-1:M|0)}p.exports={ge:function(s,m,x,M,v){return d(s,m,x,M,v,a)},gt:function(s,m,x,M,v){return d(s,m,x,M,v,t)},lt:function(s,m,x,M,v){return d(s,m,x,M,v,i)},le:function(s,m,x,M,v){return d(s,m,x,M,v,n)},eq:function(s,m,x,M,v){return d(s,m,x,M,v,r)}}},{}],32:[function(e,p,g){"use strict";var a=32;g.INT_BITS=a,g.INT_MAX=2147483647,g.INT_MIN=-1<<a-1,g.sign=function(n){return(n>0)-(n<0)},g.abs=function(n){var r=n>>a-1;return(n^r)-r},g.min=function(n,r){return r^(n^r)&-(n<r)},g.max=function(n,r){return n^(n^r)&-(n<r)},g.isPow2=function(n){return!(n&n-1)&&!!n},g.log2=function(n){var r,d;return r=(n>65535)<<4,n>>>=r,d=(n>255)<<3,n>>>=d,r|=d,d=(n>15)<<2,n>>>=d,r|=d,d=(n>3)<<1,n>>>=d,r|=d,r|n>>1},g.log10=function(n){return n>=1e9?9:n>=1e8?8:n>=1e7?7:n>=1e6?6:n>=1e5?5:n>=1e4?4:n>=1e3?3:n>=100?2:n>=10?1:0},g.popCount=function(n){return n=n-(n>>>1&1431655765),n=(n&858993459)+(n>>>2&858993459),(n+(n>>>4)&252645135)*16843009>>>24};function t(n){var r=32;return n&=-n,n&&r--,n&65535&&(r-=16),n&16711935&&(r-=8),n&252645135&&(r-=4),n&858993459&&(r-=2),n&1431655765&&(r-=1),r}g.countTrailingZeros=t,g.nextPow2=function(n){return n+=n===0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n+1},g.prevPow2=function(n){return n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n-(n>>>1)},g.parity=function(n){return n^=n>>>16,n^=n>>>8,n^=n>>>4,n&=15,27030>>>n&1};var i=new Array(256);(function(n){for(var r=0;r<256;++r){var d=r,s=r,m=7;for(d>>>=1;d;d>>>=1)s<<=1,s|=d&1,--m;n[r]=s<<m&255}})(i),g.reverse=function(n){return i[n&255]<<24|i[n>>>8&255]<<16|i[n>>>16&255]<<8|i[n>>>24&255]},g.interleave2=function(n,r){return n&=65535,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,r&=65535,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,n|r<<1},g.deinterleave2=function(n,r){return n=n>>>r&1431655765,n=(n|n>>>1)&858993459,n=(n|n>>>2)&252645135,n=(n|n>>>4)&16711935,n=(n|n>>>16)&65535,n<<16>>16},g.interleave3=function(n,r,d){return n&=1023,n=(n|n<<16)&4278190335,n=(n|n<<8)&251719695,n=(n|n<<4)&3272356035,n=(n|n<<2)&1227133513,r&=1023,r=(r|r<<16)&4278190335,r=(r|r<<8)&251719695,r=(r|r<<4)&3272356035,r=(r|r<<2)&1227133513,n|=r<<1,d&=1023,d=(d|d<<16)&4278190335,d=(d|d<<8)&251719695,d=(d|d<<4)&3272356035,d=(d|d<<2)&1227133513,n|d<<2},g.deinterleave3=function(n,r){return n=n>>>r&1227133513,n=(n|n>>>2)&3272356035,n=(n|n>>>4)&251719695,n=(n|n>>>8)&4278190335,n=(n|n>>>16)&1023,n<<22>>22},g.nextCombination=function(n){var r=n|n-1;return r+1|(~r&-~r)-1>>>t(n)+1}},{}],33:[function(e,p,g){(function(a,t){"use strict";function i(F,D){if(!F)throw new Error(D||"Assertion failed")}function n(F,D){F.super_=D;var B=function(){};B.prototype=D.prototype,F.prototype=new B,F.prototype.constructor=F}function r(F,D,B){if(r.isBN(F))return F;this.negative=0,this.words=null,this.length=0,this.red=null,F!==null&&((D==="le"||D==="be")&&(B=D,D=10),this._init(F||0,D||10,B||"be"))}typeof a=="object"?a.exports=r:t.BN=r,r.BN=r,r.wordSize=26;var d;try{typeof window<"u"&&typeof window.Buffer<"u"?d=window.Buffer:d=e("buffer").Buffer}catch{}r.isBN=function(D){return D instanceof r?!0:D!==null&&typeof D=="object"&&D.constructor.wordSize===r.wordSize&&Array.isArray(D.words)},r.max=function(D,B){return D.cmp(B)>0?D:B},r.min=function(D,B){return D.cmp(B)<0?D:B},r.prototype._init=function(D,B,U){if(typeof D=="number")return this._initNumber(D,B,U);if(typeof D=="object")return this._initArray(D,B,U);B==="hex"&&(B=16),i(B===(B|0)&&B>=2&&B<=36),D=D.toString().replace(/\s+/g,"");var X=0;D[0]==="-"&&(X++,this.negative=1),X<D.length&&(B===16?this._parseHex(D,X,U):(this._parseBase(D,B,X),U==="le"&&this._initArray(this.toArray(),B,U)))},r.prototype._initNumber=function(D,B,U){D<0&&(this.negative=1,D=-D),D<67108864?(this.words=[D&67108863],this.length=1):D<4503599627370496?(this.words=[D&67108863,D/67108864&67108863],this.length=2):(i(D<9007199254740992),this.words=[D&67108863,D/67108864&67108863,1],this.length=3),U==="le"&&this._initArray(this.toArray(),B,U)},r.prototype._initArray=function(D,B,U){if(i(typeof D.length=="number"),D.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(D.length/3),this.words=new Array(this.length);for(var X=0;X<this.length;X++)this.words[X]=0;var oe,se,q=0;if(U==="be")for(X=D.length-1,oe=0;X>=0;X-=3)se=D[X]|D[X-1]<<8|D[X-2]<<16,this.words[oe]|=se<<q&67108863,this.words[oe+1]=se>>>26-q&67108863,q+=24,q>=26&&(q-=26,oe++);else if(U==="le")for(X=0,oe=0;X<D.length;X+=3)se=D[X]|D[X+1]<<8|D[X+2]<<16,this.words[oe]|=se<<q&67108863,this.words[oe+1]=se>>>26-q&67108863,q+=24,q>=26&&(q-=26,oe++);return this.strip()};function s(F,D){var B=F.charCodeAt(D);return B>=65&&B<=70?B-55:B>=97&&B<=102?B-87:B-48&15}function m(F,D,B){var U=s(F,B);return B-1>=D&&(U|=s(F,B-1)<<4),U}r.prototype._parseHex=function(D,B,U){this.length=Math.ceil((D.length-B)/6),this.words=new Array(this.length);for(var X=0;X<this.length;X++)this.words[X]=0;var oe=0,se=0,q;if(U==="be")for(X=D.length-1;X>=B;X-=2)q=m(D,B,X)<<oe,this.words[se]|=q&67108863,oe>=18?(oe-=18,se+=1,this.words[se]|=q>>>26):oe+=8;else{var K=D.length-B;for(X=K%2===0?B+1:B;X<D.length;X+=2)q=m(D,B,X)<<oe,this.words[se]|=q&67108863,oe>=18?(oe-=18,se+=1,this.words[se]|=q>>>26):oe+=8}this.strip()};function x(F,D,B,U){for(var X=0,oe=Math.min(F.length,B),se=D;se<oe;se++){var q=F.charCodeAt(se)-48;X*=U,q>=49?X+=q-49+10:q>=17?X+=q-17+10:X+=q}return X}r.prototype._parseBase=function(D,B,U){this.words=[0],this.length=1;for(var X=0,oe=1;oe<=67108863;oe*=B)X++;X--,oe=oe/B|0;for(var se=D.length-U,q=se%X,K=Math.min(se,se-q)+U,G=0,Q=U;Q<K;Q+=X)G=x(D,Q,Q+X,B),this.imuln(oe),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G);if(q!==0){var V=1;for(G=x(D,Q,D.length,B),Q=0;Q<q;Q++)V*=B;this.imuln(V),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G)}this.strip()},r.prototype.copy=function(D){D.words=new Array(this.length);for(var B=0;B<this.length;B++)D.words[B]=this.words[B];D.length=this.length,D.negative=this.negative,D.red=this.red},r.prototype.clone=function(){var D=new r(null);return this.copy(D),D},r.prototype._expand=function(D){for(;this.length<D;)this.words[this.length++]=0;return this},r.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},r.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},r.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var M=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],_=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];r.prototype.toString=function(D,B){D=D||10,B=B|0||1;var U;if(D===16||D==="hex"){U="";for(var X=0,oe=0,se=0;se<this.length;se++){var q=this.words[se],K=((q<<X|oe)&16777215).toString(16);oe=q>>>24-X&16777215,oe!==0||se!==this.length-1?U=M[6-K.length]+K+U:U=K+U,X+=2,X>=26&&(X-=26,se--)}for(oe!==0&&(U=oe.toString(16)+U);U.length%B!==0;)U="0"+U;return this.negative!==0&&(U="-"+U),U}if(D===(D|0)&&D>=2&&D<=36){var G=v[D],Q=_[D];U="";var V=this.clone();for(V.negative=0;!V.isZero();){var H=V.modn(Q).toString(D);V=V.idivn(Q),V.isZero()?U=H+U:U=M[G-H.length]+H+U}for(this.isZero()&&(U="0"+U);U.length%B!==0;)U="0"+U;return this.negative!==0&&(U="-"+U),U}i(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var D=this.words[0];return this.length===2?D+=this.words[1]*67108864:this.length===3&&this.words[2]===1?D+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-D:D},r.prototype.toJSON=function(){return this.toString(16)},r.prototype.toBuffer=function(D,B){return i(typeof d<"u"),this.toArrayLike(d,D,B)},r.prototype.toArray=function(D,B){return this.toArrayLike(Array,D,B)},r.prototype.toArrayLike=function(D,B,U){var X=this.byteLength(),oe=U||Math.max(1,X);i(X<=oe,"byte array longer than desired length"),i(oe>0,"Requested array length <= 0"),this.strip();var se=B==="le",q=new D(oe),K,G,Q=this.clone();if(se){for(G=0;!Q.isZero();G++)K=Q.andln(255),Q.iushrn(8),q[G]=K;for(;G<oe;G++)q[G]=0}else{for(G=0;G<oe-X;G++)q[G]=0;for(G=0;!Q.isZero();G++)K=Q.andln(255),Q.iushrn(8),q[oe-G-1]=K}return q},Math.clz32?r.prototype._countBits=function(D){return 32-Math.clz32(D)}:r.prototype._countBits=function(D){var B=D,U=0;return B>=4096&&(U+=13,B>>>=13),B>=64&&(U+=7,B>>>=7),B>=8&&(U+=4,B>>>=4),B>=2&&(U+=2,B>>>=2),U+B},r.prototype._zeroBits=function(D){if(D===0)return 26;var B=D,U=0;return(B&8191)===0&&(U+=13,B>>>=13),(B&127)===0&&(U+=7,B>>>=7),(B&15)===0&&(U+=4,B>>>=4),(B&3)===0&&(U+=2,B>>>=2),(B&1)===0&&U++,U},r.prototype.bitLength=function(){var D=this.words[this.length-1],B=this._countBits(D);return(this.length-1)*26+B};function l(F){for(var D=new Array(F.bitLength()),B=0;B<D.length;B++){var U=B/26|0,X=B%26;D[B]=(F.words[U]&1<<X)>>>X}return D}r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var D=0,B=0;B<this.length;B++){var U=this._zeroBits(this.words[B]);if(D+=U,U!==26)break}return D},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(D){return this.negative!==0?this.abs().inotn(D).iaddn(1):this.clone()},r.prototype.fromTwos=function(D){return this.testn(D-1)?this.notn(D).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return this.negative!==0},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(D){for(;this.length<D.length;)this.words[this.length++]=0;for(var B=0;B<D.length;B++)this.words[B]=this.words[B]|D.words[B];return this.strip()},r.prototype.ior=function(D){return i((this.negative|D.negative)===0),this.iuor(D)},r.prototype.or=function(D){return this.length>D.length?this.clone().ior(D):D.clone().ior(this)},r.prototype.uor=function(D){return this.length>D.length?this.clone().iuor(D):D.clone().iuor(this)},r.prototype.iuand=function(D){var B;this.length>D.length?B=D:B=this;for(var U=0;U<B.length;U++)this.words[U]=this.words[U]&D.words[U];return this.length=B.length,this.strip()},r.prototype.iand=function(D){return i((this.negative|D.negative)===0),this.iuand(D)},r.prototype.and=function(D){return this.length>D.length?this.clone().iand(D):D.clone().iand(this)},r.prototype.uand=function(D){return this.length>D.length?this.clone().iuand(D):D.clone().iuand(this)},r.prototype.iuxor=function(D){var B,U;this.length>D.length?(B=this,U=D):(B=D,U=this);for(var X=0;X<U.length;X++)this.words[X]=B.words[X]^U.words[X];if(this!==B)for(;X<B.length;X++)this.words[X]=B.words[X];return this.length=B.length,this.strip()},r.prototype.ixor=function(D){return i((this.negative|D.negative)===0),this.iuxor(D)},r.prototype.xor=function(D){return this.length>D.length?this.clone().ixor(D):D.clone().ixor(this)},r.prototype.uxor=function(D){return this.length>D.length?this.clone().iuxor(D):D.clone().iuxor(this)},r.prototype.inotn=function(D){i(typeof D=="number"&&D>=0);var B=Math.ceil(D/26)|0,U=D%26;this._expand(B),U>0&&B--;for(var X=0;X<B;X++)this.words[X]=~this.words[X]&67108863;return U>0&&(this.words[X]=~this.words[X]&67108863>>26-U),this.strip()},r.prototype.notn=function(D){return this.clone().inotn(D)},r.prototype.setn=function(D,B){i(typeof D=="number"&&D>=0);var U=D/26|0,X=D%26;return this._expand(U+1),B?this.words[U]=this.words[U]|1<<X:this.words[U]=this.words[U]&~(1<<X),this.strip()},r.prototype.iadd=function(D){var B;if(this.negative!==0&&D.negative===0)return this.negative=0,B=this.isub(D),this.negative^=1,this._normSign();if(this.negative===0&&D.negative!==0)return D.negative=0,B=this.isub(D),D.negative=1,B._normSign();var U,X;this.length>D.length?(U=this,X=D):(U=D,X=this);for(var oe=0,se=0;se<X.length;se++)B=(U.words[se]|0)+(X.words[se]|0)+oe,this.words[se]=B&67108863,oe=B>>>26;for(;oe!==0&&se<U.length;se++)B=(U.words[se]|0)+oe,this.words[se]=B&67108863,oe=B>>>26;if(this.length=U.length,oe!==0)this.words[this.length]=oe,this.length++;else if(U!==this)for(;se<U.length;se++)this.words[se]=U.words[se];return this},r.prototype.add=function(D){var B;return D.negative!==0&&this.negative===0?(D.negative=0,B=this.sub(D),D.negative^=1,B):D.negative===0&&this.negative!==0?(this.negative=0,B=D.sub(this),this.negative=1,B):this.length>D.length?this.clone().iadd(D):D.clone().iadd(this)},r.prototype.isub=function(D){if(D.negative!==0){D.negative=0;var B=this.iadd(D);return D.negative=1,B._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(D),this.negative=1,this._normSign();var U=this.cmp(D);if(U===0)return this.negative=0,this.length=1,this.words[0]=0,this;var X,oe;U>0?(X=this,oe=D):(X=D,oe=this);for(var se=0,q=0;q<oe.length;q++)B=(X.words[q]|0)-(oe.words[q]|0)+se,se=B>>26,this.words[q]=B&67108863;for(;se!==0&&q<X.length;q++)B=(X.words[q]|0)+se,se=B>>26,this.words[q]=B&67108863;if(se===0&&q<X.length&&X!==this)for(;q<X.length;q++)this.words[q]=X.words[q];return this.length=Math.max(this.length,q),X!==this&&(this.negative=1),this.strip()},r.prototype.sub=function(D){return this.clone().isub(D)};function y(F,D,B){B.negative=D.negative^F.negative;var U=F.length+D.length|0;B.length=U,U=U-1|0;var X=F.words[0]|0,oe=D.words[0]|0,se=X*oe,q=se&67108863,K=se/67108864|0;B.words[0]=q;for(var G=1;G<U;G++){for(var Q=K>>>26,V=K&67108863,H=Math.min(G,D.length-1),ee=Math.max(0,G-F.length+1);ee<=H;ee++){var J=G-ee|0;X=F.words[J]|0,oe=D.words[ee]|0,se=X*oe+V,Q+=se/67108864|0,V=se&67108863}B.words[G]=V|0,K=Q|0}return K!==0?B.words[G]=K|0:B.length--,B.strip()}var T=function(D,B,U){var X=D.words,oe=B.words,se=U.words,q=0,K,G,Q,V=X[0]|0,H=V&8191,ee=V>>>13,J=X[1]|0,W=J&8191,re=J>>>13,j=X[2]|0,Z=j&8191,ne=j>>>13,le=X[3]|0,ge=le&8191,pe=le>>>13,xe=X[4]|0,Ee=xe&8191,Te=xe>>>13,de=X[5]|0,be=de&8191,Le=de>>>13,De=X[6]|0,ye=De&8191,ke=De>>>13,Oe=X[7]|0,Qe=Oe&8191,Ve=Oe>>>13,Ue=X[8]|0,Ie=Ue&8191,at=Ue>>>13,pt=X[9]|0,Rt=pt&8191,Mt=pt>>>13,It=oe[0]|0,Bt=It&8191,St=It>>>13,_t=oe[1]|0,it=_t&8191,ct=_t>>>13,et=oe[2]|0,Pe=et&8191,We=et>>>13,je=oe[3]|0,nt=je&8191,kt=je>>>13,wt=oe[4]|0,Vt=wt&8191,qt=wt>>>13,zt=oe[5]|0,Ht=zt&8191,$t=zt>>>13,Qt=oe[6]|0,fr=Qt&8191,jr=Qt>>>13,cn=oe[7]|0,Qr=cn&8191,lt=cn>>>13,Gt=oe[8]|0,Kt=Gt&8191,Nt=Gt>>>13,gr=oe[9]|0,tt=gr&8191,we=gr>>>13;U.negative=D.negative^B.negative,U.length=19,K=Math.imul(H,Bt),G=Math.imul(H,St),G=G+Math.imul(ee,Bt)|0,Q=Math.imul(ee,St);var Me=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Me>>>26)|0,Me&=67108863,K=Math.imul(W,Bt),G=Math.imul(W,St),G=G+Math.imul(re,Bt)|0,Q=Math.imul(re,St),K=K+Math.imul(H,it)|0,G=G+Math.imul(H,ct)|0,G=G+Math.imul(ee,it)|0,Q=Q+Math.imul(ee,ct)|0;var Ne=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,K=Math.imul(Z,Bt),G=Math.imul(Z,St),G=G+Math.imul(ne,Bt)|0,Q=Math.imul(ne,St),K=K+Math.imul(W,it)|0,G=G+Math.imul(W,ct)|0,G=G+Math.imul(re,it)|0,Q=Q+Math.imul(re,ct)|0,K=K+Math.imul(H,Pe)|0,G=G+Math.imul(H,We)|0,G=G+Math.imul(ee,Pe)|0,Q=Q+Math.imul(ee,We)|0;var Xe=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,K=Math.imul(ge,Bt),G=Math.imul(ge,St),G=G+Math.imul(pe,Bt)|0,Q=Math.imul(pe,St),K=K+Math.imul(Z,it)|0,G=G+Math.imul(Z,ct)|0,G=G+Math.imul(ne,it)|0,Q=Q+Math.imul(ne,ct)|0,K=K+Math.imul(W,Pe)|0,G=G+Math.imul(W,We)|0,G=G+Math.imul(re,Pe)|0,Q=Q+Math.imul(re,We)|0,K=K+Math.imul(H,nt)|0,G=G+Math.imul(H,kt)|0,G=G+Math.imul(ee,nt)|0,Q=Q+Math.imul(ee,kt)|0;var Ke=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Ke>>>26)|0,Ke&=67108863,K=Math.imul(Ee,Bt),G=Math.imul(Ee,St),G=G+Math.imul(Te,Bt)|0,Q=Math.imul(Te,St),K=K+Math.imul(ge,it)|0,G=G+Math.imul(ge,ct)|0,G=G+Math.imul(pe,it)|0,Q=Q+Math.imul(pe,ct)|0,K=K+Math.imul(Z,Pe)|0,G=G+Math.imul(Z,We)|0,G=G+Math.imul(ne,Pe)|0,Q=Q+Math.imul(ne,We)|0,K=K+Math.imul(W,nt)|0,G=G+Math.imul(W,kt)|0,G=G+Math.imul(re,nt)|0,Q=Q+Math.imul(re,kt)|0,K=K+Math.imul(H,Vt)|0,G=G+Math.imul(H,qt)|0,G=G+Math.imul(ee,Vt)|0,Q=Q+Math.imul(ee,qt)|0;var rt=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(rt>>>26)|0,rt&=67108863,K=Math.imul(be,Bt),G=Math.imul(be,St),G=G+Math.imul(Le,Bt)|0,Q=Math.imul(Le,St),K=K+Math.imul(Ee,it)|0,G=G+Math.imul(Ee,ct)|0,G=G+Math.imul(Te,it)|0,Q=Q+Math.imul(Te,ct)|0,K=K+Math.imul(ge,Pe)|0,G=G+Math.imul(ge,We)|0,G=G+Math.imul(pe,Pe)|0,Q=Q+Math.imul(pe,We)|0,K=K+Math.imul(Z,nt)|0,G=G+Math.imul(Z,kt)|0,G=G+Math.imul(ne,nt)|0,Q=Q+Math.imul(ne,kt)|0,K=K+Math.imul(W,Vt)|0,G=G+Math.imul(W,qt)|0,G=G+Math.imul(re,Vt)|0,Q=Q+Math.imul(re,qt)|0,K=K+Math.imul(H,Ht)|0,G=G+Math.imul(H,$t)|0,G=G+Math.imul(ee,Ht)|0,Q=Q+Math.imul(ee,$t)|0;var Je=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Je>>>26)|0,Je&=67108863,K=Math.imul(ye,Bt),G=Math.imul(ye,St),G=G+Math.imul(ke,Bt)|0,Q=Math.imul(ke,St),K=K+Math.imul(be,it)|0,G=G+Math.imul(be,ct)|0,G=G+Math.imul(Le,it)|0,Q=Q+Math.imul(Le,ct)|0,K=K+Math.imul(Ee,Pe)|0,G=G+Math.imul(Ee,We)|0,G=G+Math.imul(Te,Pe)|0,Q=Q+Math.imul(Te,We)|0,K=K+Math.imul(ge,nt)|0,G=G+Math.imul(ge,kt)|0,G=G+Math.imul(pe,nt)|0,Q=Q+Math.imul(pe,kt)|0,K=K+Math.imul(Z,Vt)|0,G=G+Math.imul(Z,qt)|0,G=G+Math.imul(ne,Vt)|0,Q=Q+Math.imul(ne,qt)|0,K=K+Math.imul(W,Ht)|0,G=G+Math.imul(W,$t)|0,G=G+Math.imul(re,Ht)|0,Q=Q+Math.imul(re,$t)|0,K=K+Math.imul(H,fr)|0,G=G+Math.imul(H,jr)|0,G=G+Math.imul(ee,fr)|0,Q=Q+Math.imul(ee,jr)|0;var vt=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(vt>>>26)|0,vt&=67108863,K=Math.imul(Qe,Bt),G=Math.imul(Qe,St),G=G+Math.imul(Ve,Bt)|0,Q=Math.imul(Ve,St),K=K+Math.imul(ye,it)|0,G=G+Math.imul(ye,ct)|0,G=G+Math.imul(ke,it)|0,Q=Q+Math.imul(ke,ct)|0,K=K+Math.imul(be,Pe)|0,G=G+Math.imul(be,We)|0,G=G+Math.imul(Le,Pe)|0,Q=Q+Math.imul(Le,We)|0,K=K+Math.imul(Ee,nt)|0,G=G+Math.imul(Ee,kt)|0,G=G+Math.imul(Te,nt)|0,Q=Q+Math.imul(Te,kt)|0,K=K+Math.imul(ge,Vt)|0,G=G+Math.imul(ge,qt)|0,G=G+Math.imul(pe,Vt)|0,Q=Q+Math.imul(pe,qt)|0,K=K+Math.imul(Z,Ht)|0,G=G+Math.imul(Z,$t)|0,G=G+Math.imul(ne,Ht)|0,Q=Q+Math.imul(ne,$t)|0,K=K+Math.imul(W,fr)|0,G=G+Math.imul(W,jr)|0,G=G+Math.imul(re,fr)|0,Q=Q+Math.imul(re,jr)|0,K=K+Math.imul(H,Qr)|0,G=G+Math.imul(H,lt)|0,G=G+Math.imul(ee,Qr)|0,Q=Q+Math.imul(ee,lt)|0;var bt=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(bt>>>26)|0,bt&=67108863,K=Math.imul(Ie,Bt),G=Math.imul(Ie,St),G=G+Math.imul(at,Bt)|0,Q=Math.imul(at,St),K=K+Math.imul(Qe,it)|0,G=G+Math.imul(Qe,ct)|0,G=G+Math.imul(Ve,it)|0,Q=Q+Math.imul(Ve,ct)|0,K=K+Math.imul(ye,Pe)|0,G=G+Math.imul(ye,We)|0,G=G+Math.imul(ke,Pe)|0,Q=Q+Math.imul(ke,We)|0,K=K+Math.imul(be,nt)|0,G=G+Math.imul(be,kt)|0,G=G+Math.imul(Le,nt)|0,Q=Q+Math.imul(Le,kt)|0,K=K+Math.imul(Ee,Vt)|0,G=G+Math.imul(Ee,qt)|0,G=G+Math.imul(Te,Vt)|0,Q=Q+Math.imul(Te,qt)|0,K=K+Math.imul(ge,Ht)|0,G=G+Math.imul(ge,$t)|0,G=G+Math.imul(pe,Ht)|0,Q=Q+Math.imul(pe,$t)|0,K=K+Math.imul(Z,fr)|0,G=G+Math.imul(Z,jr)|0,G=G+Math.imul(ne,fr)|0,Q=Q+Math.imul(ne,jr)|0,K=K+Math.imul(W,Qr)|0,G=G+Math.imul(W,lt)|0,G=G+Math.imul(re,Qr)|0,Q=Q+Math.imul(re,lt)|0,K=K+Math.imul(H,Kt)|0,G=G+Math.imul(H,Nt)|0,G=G+Math.imul(ee,Kt)|0,Q=Q+Math.imul(ee,Nt)|0;var Et=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Et>>>26)|0,Et&=67108863,K=Math.imul(Rt,Bt),G=Math.imul(Rt,St),G=G+Math.imul(Mt,Bt)|0,Q=Math.imul(Mt,St),K=K+Math.imul(Ie,it)|0,G=G+Math.imul(Ie,ct)|0,G=G+Math.imul(at,it)|0,Q=Q+Math.imul(at,ct)|0,K=K+Math.imul(Qe,Pe)|0,G=G+Math.imul(Qe,We)|0,G=G+Math.imul(Ve,Pe)|0,Q=Q+Math.imul(Ve,We)|0,K=K+Math.imul(ye,nt)|0,G=G+Math.imul(ye,kt)|0,G=G+Math.imul(ke,nt)|0,Q=Q+Math.imul(ke,kt)|0,K=K+Math.imul(be,Vt)|0,G=G+Math.imul(be,qt)|0,G=G+Math.imul(Le,Vt)|0,Q=Q+Math.imul(Le,qt)|0,K=K+Math.imul(Ee,Ht)|0,G=G+Math.imul(Ee,$t)|0,G=G+Math.imul(Te,Ht)|0,Q=Q+Math.imul(Te,$t)|0,K=K+Math.imul(ge,fr)|0,G=G+Math.imul(ge,jr)|0,G=G+Math.imul(pe,fr)|0,Q=Q+Math.imul(pe,jr)|0,K=K+Math.imul(Z,Qr)|0,G=G+Math.imul(Z,lt)|0,G=G+Math.imul(ne,Qr)|0,Q=Q+Math.imul(ne,lt)|0,K=K+Math.imul(W,Kt)|0,G=G+Math.imul(W,Nt)|0,G=G+Math.imul(re,Kt)|0,Q=Q+Math.imul(re,Nt)|0,K=K+Math.imul(H,tt)|0,G=G+Math.imul(H,we)|0,G=G+Math.imul(ee,tt)|0,Q=Q+Math.imul(ee,we)|0;var Wt=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,K=Math.imul(Rt,it),G=Math.imul(Rt,ct),G=G+Math.imul(Mt,it)|0,Q=Math.imul(Mt,ct),K=K+Math.imul(Ie,Pe)|0,G=G+Math.imul(Ie,We)|0,G=G+Math.imul(at,Pe)|0,Q=Q+Math.imul(at,We)|0,K=K+Math.imul(Qe,nt)|0,G=G+Math.imul(Qe,kt)|0,G=G+Math.imul(Ve,nt)|0,Q=Q+Math.imul(Ve,kt)|0,K=K+Math.imul(ye,Vt)|0,G=G+Math.imul(ye,qt)|0,G=G+Math.imul(ke,Vt)|0,Q=Q+Math.imul(ke,qt)|0,K=K+Math.imul(be,Ht)|0,G=G+Math.imul(be,$t)|0,G=G+Math.imul(Le,Ht)|0,Q=Q+Math.imul(Le,$t)|0,K=K+Math.imul(Ee,fr)|0,G=G+Math.imul(Ee,jr)|0,G=G+Math.imul(Te,fr)|0,Q=Q+Math.imul(Te,jr)|0,K=K+Math.imul(ge,Qr)|0,G=G+Math.imul(ge,lt)|0,G=G+Math.imul(pe,Qr)|0,Q=Q+Math.imul(pe,lt)|0,K=K+Math.imul(Z,Kt)|0,G=G+Math.imul(Z,Nt)|0,G=G+Math.imul(ne,Kt)|0,Q=Q+Math.imul(ne,Nt)|0,K=K+Math.imul(W,tt)|0,G=G+Math.imul(W,we)|0,G=G+Math.imul(re,tt)|0,Q=Q+Math.imul(re,we)|0;var Ot=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,K=Math.imul(Rt,Pe),G=Math.imul(Rt,We),G=G+Math.imul(Mt,Pe)|0,Q=Math.imul(Mt,We),K=K+Math.imul(Ie,nt)|0,G=G+Math.imul(Ie,kt)|0,G=G+Math.imul(at,nt)|0,Q=Q+Math.imul(at,kt)|0,K=K+Math.imul(Qe,Vt)|0,G=G+Math.imul(Qe,qt)|0,G=G+Math.imul(Ve,Vt)|0,Q=Q+Math.imul(Ve,qt)|0,K=K+Math.imul(ye,Ht)|0,G=G+Math.imul(ye,$t)|0,G=G+Math.imul(ke,Ht)|0,Q=Q+Math.imul(ke,$t)|0,K=K+Math.imul(be,fr)|0,G=G+Math.imul(be,jr)|0,G=G+Math.imul(Le,fr)|0,Q=Q+Math.imul(Le,jr)|0,K=K+Math.imul(Ee,Qr)|0,G=G+Math.imul(Ee,lt)|0,G=G+Math.imul(Te,Qr)|0,Q=Q+Math.imul(Te,lt)|0,K=K+Math.imul(ge,Kt)|0,G=G+Math.imul(ge,Nt)|0,G=G+Math.imul(pe,Kt)|0,Q=Q+Math.imul(pe,Nt)|0,K=K+Math.imul(Z,tt)|0,G=G+Math.imul(Z,we)|0,G=G+Math.imul(ne,tt)|0,Q=Q+Math.imul(ne,we)|0;var ir=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(ir>>>26)|0,ir&=67108863,K=Math.imul(Rt,nt),G=Math.imul(Rt,kt),G=G+Math.imul(Mt,nt)|0,Q=Math.imul(Mt,kt),K=K+Math.imul(Ie,Vt)|0,G=G+Math.imul(Ie,qt)|0,G=G+Math.imul(at,Vt)|0,Q=Q+Math.imul(at,qt)|0,K=K+Math.imul(Qe,Ht)|0,G=G+Math.imul(Qe,$t)|0,G=G+Math.imul(Ve,Ht)|0,Q=Q+Math.imul(Ve,$t)|0,K=K+Math.imul(ye,fr)|0,G=G+Math.imul(ye,jr)|0,G=G+Math.imul(ke,fr)|0,Q=Q+Math.imul(ke,jr)|0,K=K+Math.imul(be,Qr)|0,G=G+Math.imul(be,lt)|0,G=G+Math.imul(Le,Qr)|0,Q=Q+Math.imul(Le,lt)|0,K=K+Math.imul(Ee,Kt)|0,G=G+Math.imul(Ee,Nt)|0,G=G+Math.imul(Te,Kt)|0,Q=Q+Math.imul(Te,Nt)|0,K=K+Math.imul(ge,tt)|0,G=G+Math.imul(ge,we)|0,G=G+Math.imul(pe,tt)|0,Q=Q+Math.imul(pe,we)|0;var vr=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(vr>>>26)|0,vr&=67108863,K=Math.imul(Rt,Vt),G=Math.imul(Rt,qt),G=G+Math.imul(Mt,Vt)|0,Q=Math.imul(Mt,qt),K=K+Math.imul(Ie,Ht)|0,G=G+Math.imul(Ie,$t)|0,G=G+Math.imul(at,Ht)|0,Q=Q+Math.imul(at,$t)|0,K=K+Math.imul(Qe,fr)|0,G=G+Math.imul(Qe,jr)|0,G=G+Math.imul(Ve,fr)|0,Q=Q+Math.imul(Ve,jr)|0,K=K+Math.imul(ye,Qr)|0,G=G+Math.imul(ye,lt)|0,G=G+Math.imul(ke,Qr)|0,Q=Q+Math.imul(ke,lt)|0,K=K+Math.imul(be,Kt)|0,G=G+Math.imul(be,Nt)|0,G=G+Math.imul(Le,Kt)|0,Q=Q+Math.imul(Le,Nt)|0,K=K+Math.imul(Ee,tt)|0,G=G+Math.imul(Ee,we)|0,G=G+Math.imul(Te,tt)|0,Q=Q+Math.imul(Te,we)|0;var _r=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(_r>>>26)|0,_r&=67108863,K=Math.imul(Rt,Ht),G=Math.imul(Rt,$t),G=G+Math.imul(Mt,Ht)|0,Q=Math.imul(Mt,$t),K=K+Math.imul(Ie,fr)|0,G=G+Math.imul(Ie,jr)|0,G=G+Math.imul(at,fr)|0,Q=Q+Math.imul(at,jr)|0,K=K+Math.imul(Qe,Qr)|0,G=G+Math.imul(Qe,lt)|0,G=G+Math.imul(Ve,Qr)|0,Q=Q+Math.imul(Ve,lt)|0,K=K+Math.imul(ye,Kt)|0,G=G+Math.imul(ye,Nt)|0,G=G+Math.imul(ke,Kt)|0,Q=Q+Math.imul(ke,Nt)|0,K=K+Math.imul(be,tt)|0,G=G+Math.imul(be,we)|0,G=G+Math.imul(Le,tt)|0,Q=Q+Math.imul(Le,we)|0;var ln=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(ln>>>26)|0,ln&=67108863,K=Math.imul(Rt,fr),G=Math.imul(Rt,jr),G=G+Math.imul(Mt,fr)|0,Q=Math.imul(Mt,jr),K=K+Math.imul(Ie,Qr)|0,G=G+Math.imul(Ie,lt)|0,G=G+Math.imul(at,Qr)|0,Q=Q+Math.imul(at,lt)|0,K=K+Math.imul(Qe,Kt)|0,G=G+Math.imul(Qe,Nt)|0,G=G+Math.imul(Ve,Kt)|0,Q=Q+Math.imul(Ve,Nt)|0,K=K+Math.imul(ye,tt)|0,G=G+Math.imul(ye,we)|0,G=G+Math.imul(ke,tt)|0,Q=Q+Math.imul(ke,we)|0;var Cr=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Cr>>>26)|0,Cr&=67108863,K=Math.imul(Rt,Qr),G=Math.imul(Rt,lt),G=G+Math.imul(Mt,Qr)|0,Q=Math.imul(Mt,lt),K=K+Math.imul(Ie,Kt)|0,G=G+Math.imul(Ie,Nt)|0,G=G+Math.imul(at,Kt)|0,Q=Q+Math.imul(at,Nt)|0,K=K+Math.imul(Qe,tt)|0,G=G+Math.imul(Qe,we)|0,G=G+Math.imul(Ve,tt)|0,Q=Q+Math.imul(Ve,we)|0;var Gr=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(Gr>>>26)|0,Gr&=67108863,K=Math.imul(Rt,Kt),G=Math.imul(Rt,Nt),G=G+Math.imul(Mt,Kt)|0,Q=Math.imul(Mt,Nt),K=K+Math.imul(Ie,tt)|0,G=G+Math.imul(Ie,we)|0,G=G+Math.imul(at,tt)|0,Q=Q+Math.imul(at,we)|0;var sn=(q+K|0)+((G&8191)<<13)|0;q=(Q+(G>>>13)|0)+(sn>>>26)|0,sn&=67108863,K=Math.imul(Rt,tt),G=Math.imul(Rt,we),G=G+Math.imul(Mt,tt)|0,Q=Math.imul(Mt,we);var yr=(q+K|0)+((G&8191)<<13)|0;return q=(Q+(G>>>13)|0)+(yr>>>26)|0,yr&=67108863,se[0]=Me,se[1]=Ne,se[2]=Xe,se[3]=Ke,se[4]=rt,se[5]=Je,se[6]=vt,se[7]=bt,se[8]=Et,se[9]=Wt,se[10]=Ot,se[11]=ir,se[12]=vr,se[13]=_r,se[14]=ln,se[15]=Cr,se[16]=Gr,se[17]=sn,se[18]=yr,q!==0&&(se[19]=q,U.length++),U};Math.imul||(T=y);function w(F,D,B){B.negative=D.negative^F.negative,B.length=F.length+D.length;for(var U=0,X=0,oe=0;oe<B.length-1;oe++){var se=X;X=0;for(var q=U&67108863,K=Math.min(oe,D.length-1),G=Math.max(0,oe-F.length+1);G<=K;G++){var Q=oe-G,V=F.words[Q]|0,H=D.words[G]|0,ee=V*H,J=ee&67108863;se=se+(ee/67108864|0)|0,J=J+q|0,q=J&67108863,se=se+(J>>>26)|0,X+=se>>>26,se&=67108863}B.words[oe]=q,U=se,se=X}return U!==0?B.words[oe]=U:B.length--,B.strip()}function A(F,D,B){var U=new f;return U.mulp(F,D,B)}r.prototype.mulTo=function(D,B){var U,X=this.length+D.length;return this.length===10&&D.length===10?U=T(this,D,B):X<63?U=y(this,D,B):X<1024?U=w(this,D,B):U=A(this,D,B),U};function f(F,D){this.x=F,this.y=D}f.prototype.makeRBT=function(D){for(var B=new Array(D),U=r.prototype._countBits(D)-1,X=0;X<D;X++)B[X]=this.revBin(X,U,D);return B},f.prototype.revBin=function(D,B,U){if(D===0||D===U-1)return D;for(var X=0,oe=0;oe<B;oe++)X|=(D&1)<<B-oe-1,D>>=1;return X},f.prototype.permute=function(D,B,U,X,oe,se){for(var q=0;q<se;q++)X[q]=B[D[q]],oe[q]=U[D[q]]},f.prototype.transform=function(D,B,U,X,oe,se){this.permute(se,D,B,U,X,oe);for(var q=1;q<oe;q<<=1)for(var K=q<<1,G=Math.cos(2*Math.PI/K),Q=Math.sin(2*Math.PI/K),V=0;V<oe;V+=K)for(var H=G,ee=Q,J=0;J<q;J++){var W=U[V+J],re=X[V+J],j=U[V+J+q],Z=X[V+J+q],ne=H*j-ee*Z;Z=H*Z+ee*j,j=ne,U[V+J]=W+j,X[V+J]=re+Z,U[V+J+q]=W-j,X[V+J+q]=re-Z,J!==K&&(ne=G*H-Q*ee,ee=G*ee+Q*H,H=ne)}},f.prototype.guessLen13b=function(D,B){var U=Math.max(B,D)|1,X=U&1,oe=0;for(U=U/2|0;U;U=U>>>1)oe++;return 1<<oe+1+X},f.prototype.conjugate=function(D,B,U){if(!(U<=1))for(var X=0;X<U/2;X++){var oe=D[X];D[X]=D[U-X-1],D[U-X-1]=oe,oe=B[X],B[X]=-B[U-X-1],B[U-X-1]=-oe}},f.prototype.normalize13b=function(D,B){for(var U=0,X=0;X<B/2;X++){var oe=Math.round(D[2*X+1]/B)*8192+Math.round(D[2*X]/B)+U;D[X]=oe&67108863,oe<67108864?U=0:U=oe/67108864|0}return D},f.prototype.convert13b=function(D,B,U,X){for(var oe=0,se=0;se<B;se++)oe=oe+(D[se]|0),U[2*se]=oe&8191,oe=oe>>>13,U[2*se+1]=oe&8191,oe=oe>>>13;for(se=2*B;se<X;++se)U[se]=0;i(oe===0),i((oe&-8192)===0)},f.prototype.stub=function(D){for(var B=new Array(D),U=0;U<D;U++)B[U]=0;return B},f.prototype.mulp=function(D,B,U){var X=2*this.guessLen13b(D.length,B.length),oe=this.makeRBT(X),se=this.stub(X),q=new Array(X),K=new Array(X),G=new Array(X),Q=new Array(X),V=new Array(X),H=new Array(X),ee=U.words;ee.length=X,this.convert13b(D.words,D.length,q,X),this.convert13b(B.words,B.length,Q,X),this.transform(q,se,K,G,X,oe),this.transform(Q,se,V,H,X,oe);for(var J=0;J<X;J++){var W=K[J]*V[J]-G[J]*H[J];G[J]=K[J]*H[J]+G[J]*V[J],K[J]=W}return this.conjugate(K,G,X),this.transform(K,G,ee,se,X,oe),this.conjugate(ee,se,X),this.normalize13b(ee,X),U.negative=D.negative^B.negative,U.length=D.length+B.length,U.strip()},r.prototype.mul=function(D){var B=new r(null);return B.words=new Array(this.length+D.length),this.mulTo(D,B)},r.prototype.mulf=function(D){var B=new r(null);return B.words=new Array(this.length+D.length),A(this,D,B)},r.prototype.imul=function(D){return this.clone().mulTo(D,this)},r.prototype.imuln=function(D){i(typeof D=="number"),i(D<67108864);for(var B=0,U=0;U<this.length;U++){var X=(this.words[U]|0)*D,oe=(X&67108863)+(B&67108863);B>>=26,B+=X/67108864|0,B+=oe>>>26,this.words[U]=oe&67108863}return B!==0&&(this.words[U]=B,this.length++),this},r.prototype.muln=function(D){return this.clone().imuln(D)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(D){var B=l(D);if(B.length===0)return new r(1);for(var U=this,X=0;X<B.length&&B[X]===0;X++,U=U.sqr());if(++X<B.length)for(var oe=U.sqr();X<B.length;X++,oe=oe.sqr())B[X]!==0&&(U=U.mul(oe));return U},r.prototype.iushln=function(D){i(typeof D=="number"&&D>=0);var B=D%26,U=(D-B)/26,X=67108863>>>26-B<<26-B,oe;if(B!==0){var se=0;for(oe=0;oe<this.length;oe++){var q=this.words[oe]&X,K=(this.words[oe]|0)-q<<B;this.words[oe]=K|se,se=q>>>26-B}se&&(this.words[oe]=se,this.length++)}if(U!==0){for(oe=this.length-1;oe>=0;oe--)this.words[oe+U]=this.words[oe];for(oe=0;oe<U;oe++)this.words[oe]=0;this.length+=U}return this.strip()},r.prototype.ishln=function(D){return i(this.negative===0),this.iushln(D)},r.prototype.iushrn=function(D,B,U){i(typeof D=="number"&&D>=0);var X;B?X=(B-B%26)/26:X=0;var oe=D%26,se=Math.min((D-oe)/26,this.length),q=67108863^67108863>>>oe<<oe,K=U;if(X-=se,X=Math.max(0,X),K){for(var G=0;G<se;G++)K.words[G]=this.words[G];K.length=se}if(se!==0)if(this.length>se)for(this.length-=se,G=0;G<this.length;G++)this.words[G]=this.words[G+se];else this.words[0]=0,this.length=1;var Q=0;for(G=this.length-1;G>=0&&(Q!==0||G>=X);G--){var V=this.words[G]|0;this.words[G]=Q<<26-oe|V>>>oe,Q=V&q}return K&&Q!==0&&(K.words[K.length++]=Q),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},r.prototype.ishrn=function(D,B,U){return i(this.negative===0),this.iushrn(D,B,U)},r.prototype.shln=function(D){return this.clone().ishln(D)},r.prototype.ushln=function(D){return this.clone().iushln(D)},r.prototype.shrn=function(D){return this.clone().ishrn(D)},r.prototype.ushrn=function(D){return this.clone().iushrn(D)},r.prototype.testn=function(D){i(typeof D=="number"&&D>=0);var B=D%26,U=(D-B)/26,X=1<<B;if(this.length<=U)return!1;var oe=this.words[U];return!!(oe&X)},r.prototype.imaskn=function(D){i(typeof D=="number"&&D>=0);var B=D%26,U=(D-B)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=U)return this;if(B!==0&&U++,this.length=Math.min(U,this.length),B!==0){var X=67108863^67108863>>>B<<B;this.words[this.length-1]&=X}return this.strip()},r.prototype.maskn=function(D){return this.clone().imaskn(D)},r.prototype.iaddn=function(D){return i(typeof D=="number"),i(D<67108864),D<0?this.isubn(-D):this.negative!==0?this.length===1&&(this.words[0]|0)<D?(this.words[0]=D-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(D),this.negative=1,this):this._iaddn(D)},r.prototype._iaddn=function(D){this.words[0]+=D;for(var B=0;B<this.length&&this.words[B]>=67108864;B++)this.words[B]-=67108864,B===this.length-1?this.words[B+1]=1:this.words[B+1]++;return this.length=Math.max(this.length,B+1),this},r.prototype.isubn=function(D){if(i(typeof D=="number"),i(D<67108864),D<0)return this.iaddn(-D);if(this.negative!==0)return this.negative=0,this.iaddn(D),this.negative=1,this;if(this.words[0]-=D,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var B=0;B<this.length&&this.words[B]<0;B++)this.words[B]+=67108864,this.words[B+1]-=1;return this.strip()},r.prototype.addn=function(D){return this.clone().iaddn(D)},r.prototype.subn=function(D){return this.clone().isubn(D)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(D,B,U){var X=D.length+U,oe;this._expand(X);var se,q=0;for(oe=0;oe<D.length;oe++){se=(this.words[oe+U]|0)+q;var K=(D.words[oe]|0)*B;se-=K&67108863,q=(se>>26)-(K/67108864|0),this.words[oe+U]=se&67108863}for(;oe<this.length-U;oe++)se=(this.words[oe+U]|0)+q,q=se>>26,this.words[oe+U]=se&67108863;if(q===0)return this.strip();for(i(q===-1),q=0,oe=0;oe<this.length;oe++)se=-(this.words[oe]|0)+q,q=se>>26,this.words[oe]=se&67108863;return this.negative=1,this.strip()},r.prototype._wordDiv=function(D,B){var U=this.length-D.length,X=this.clone(),oe=D,se=oe.words[oe.length-1]|0,q=this._countBits(se);U=26-q,U!==0&&(oe=oe.ushln(U),X.iushln(U),se=oe.words[oe.length-1]|0);var K=X.length-oe.length,G;if(B!=="mod"){G=new r(null),G.length=K+1,G.words=new Array(G.length);for(var Q=0;Q<G.length;Q++)G.words[Q]=0}var V=X.clone()._ishlnsubmul(oe,1,K);V.negative===0&&(X=V,G&&(G.words[K]=1));for(var H=K-1;H>=0;H--){var ee=(X.words[oe.length+H]|0)*67108864+(X.words[oe.length+H-1]|0);for(ee=Math.min(ee/se|0,67108863),X._ishlnsubmul(oe,ee,H);X.negative!==0;)ee--,X.negative=0,X._ishlnsubmul(oe,1,H),X.isZero()||(X.negative^=1);G&&(G.words[H]=ee)}return G&&G.strip(),X.strip(),B!=="div"&&U!==0&&X.iushrn(U),{div:G||null,mod:X}},r.prototype.divmod=function(D,B,U){if(i(!D.isZero()),this.isZero())return{div:new r(0),mod:new r(0)};var X,oe,se;return this.negative!==0&&D.negative===0?(se=this.neg().divmod(D,B),B!=="mod"&&(X=se.div.neg()),B!=="div"&&(oe=se.mod.neg(),U&&oe.negative!==0&&oe.iadd(D)),{div:X,mod:oe}):this.negative===0&&D.negative!==0?(se=this.divmod(D.neg(),B),B!=="mod"&&(X=se.div.neg()),{div:X,mod:se.mod}):(this.negative&D.negative)!==0?(se=this.neg().divmod(D.neg(),B),B!=="div"&&(oe=se.mod.neg(),U&&oe.negative!==0&&oe.isub(D)),{div:se.div,mod:oe}):D.length>this.length||this.cmp(D)<0?{div:new r(0),mod:this}:D.length===1?B==="div"?{div:this.divn(D.words[0]),mod:null}:B==="mod"?{div:null,mod:new r(this.modn(D.words[0]))}:{div:this.divn(D.words[0]),mod:new r(this.modn(D.words[0]))}:this._wordDiv(D,B)},r.prototype.div=function(D){return this.divmod(D,"div",!1).div},r.prototype.mod=function(D){return this.divmod(D,"mod",!1).mod},r.prototype.umod=function(D){return this.divmod(D,"mod",!0).mod},r.prototype.divRound=function(D){var B=this.divmod(D);if(B.mod.isZero())return B.div;var U=B.div.negative!==0?B.mod.isub(D):B.mod,X=D.ushrn(1),oe=D.andln(1),se=U.cmp(X);return se<0||oe===1&&se===0?B.div:B.div.negative!==0?B.div.isubn(1):B.div.iaddn(1)},r.prototype.modn=function(D){i(D<=67108863);for(var B=(1<<26)%D,U=0,X=this.length-1;X>=0;X--)U=(B*U+(this.words[X]|0))%D;return U},r.prototype.idivn=function(D){i(D<=67108863);for(var B=0,U=this.length-1;U>=0;U--){var X=(this.words[U]|0)+B*67108864;this.words[U]=X/D|0,B=X%D}return this.strip()},r.prototype.divn=function(D){return this.clone().idivn(D)},r.prototype.egcd=function(D){i(D.negative===0),i(!D.isZero());var B=this,U=D.clone();B.negative!==0?B=B.umod(D):B=B.clone();for(var X=new r(1),oe=new r(0),se=new r(0),q=new r(1),K=0;B.isEven()&&U.isEven();)B.iushrn(1),U.iushrn(1),++K;for(var G=U.clone(),Q=B.clone();!B.isZero();){for(var V=0,H=1;(B.words[0]&H)===0&&V<26;++V,H<<=1);if(V>0)for(B.iushrn(V);V-- >0;)(X.isOdd()||oe.isOdd())&&(X.iadd(G),oe.isub(Q)),X.iushrn(1),oe.iushrn(1);for(var ee=0,J=1;(U.words[0]&J)===0&&ee<26;++ee,J<<=1);if(ee>0)for(U.iushrn(ee);ee-- >0;)(se.isOdd()||q.isOdd())&&(se.iadd(G),q.isub(Q)),se.iushrn(1),q.iushrn(1);B.cmp(U)>=0?(B.isub(U),X.isub(se),oe.isub(q)):(U.isub(B),se.isub(X),q.isub(oe))}return{a:se,b:q,gcd:U.iushln(K)}},r.prototype._invmp=function(D){i(D.negative===0),i(!D.isZero());var B=this,U=D.clone();B.negative!==0?B=B.umod(D):B=B.clone();for(var X=new r(1),oe=new r(0),se=U.clone();B.cmpn(1)>0&&U.cmpn(1)>0;){for(var q=0,K=1;(B.words[0]&K)===0&&q<26;++q,K<<=1);if(q>0)for(B.iushrn(q);q-- >0;)X.isOdd()&&X.iadd(se),X.iushrn(1);for(var G=0,Q=1;(U.words[0]&Q)===0&&G<26;++G,Q<<=1);if(G>0)for(U.iushrn(G);G-- >0;)oe.isOdd()&&oe.iadd(se),oe.iushrn(1);B.cmp(U)>=0?(B.isub(U),X.isub(oe)):(U.isub(B),oe.isub(X))}var V;return B.cmpn(1)===0?V=X:V=oe,V.cmpn(0)<0&&V.iadd(D),V},r.prototype.gcd=function(D){if(this.isZero())return D.abs();if(D.isZero())return this.abs();var B=this.clone(),U=D.clone();B.negative=0,U.negative=0;for(var X=0;B.isEven()&&U.isEven();X++)B.iushrn(1),U.iushrn(1);do{for(;B.isEven();)B.iushrn(1);for(;U.isEven();)U.iushrn(1);var oe=B.cmp(U);if(oe<0){var se=B;B=U,U=se}else if(oe===0||U.cmpn(1)===0)break;B.isub(U)}while(!0);return U.iushln(X)},r.prototype.invm=function(D){return this.egcd(D).a.umod(D)},r.prototype.isEven=function(){return(this.words[0]&1)===0},r.prototype.isOdd=function(){return(this.words[0]&1)===1},r.prototype.andln=function(D){return this.words[0]&D},r.prototype.bincn=function(D){i(typeof D=="number");var B=D%26,U=(D-B)/26,X=1<<B;if(this.length<=U)return this._expand(U+1),this.words[U]|=X,this;for(var oe=X,se=U;oe!==0&&se<this.length;se++){var q=this.words[se]|0;q+=oe,oe=q>>>26,q&=67108863,this.words[se]=q}return oe!==0&&(this.words[se]=oe,this.length++),this},r.prototype.isZero=function(){return this.length===1&&this.words[0]===0},r.prototype.cmpn=function(D){var B=D<0;if(this.negative!==0&&!B)return-1;if(this.negative===0&&B)return 1;this.strip();var U;if(this.length>1)U=1;else{B&&(D=-D),i(D<=67108863,"Number is too big");var X=this.words[0]|0;U=X===D?0:X<D?-1:1}return this.negative!==0?-U|0:U},r.prototype.cmp=function(D){if(this.negative!==0&&D.negative===0)return-1;if(this.negative===0&&D.negative!==0)return 1;var B=this.ucmp(D);return this.negative!==0?-B|0:B},r.prototype.ucmp=function(D){if(this.length>D.length)return 1;if(this.length<D.length)return-1;for(var B=0,U=this.length-1;U>=0;U--){var X=this.words[U]|0,oe=D.words[U]|0;if(X!==oe){X<oe?B=-1:X>oe&&(B=1);break}}return B},r.prototype.gtn=function(D){return this.cmpn(D)===1},r.prototype.gt=function(D){return this.cmp(D)===1},r.prototype.gten=function(D){return this.cmpn(D)>=0},r.prototype.gte=function(D){return this.cmp(D)>=0},r.prototype.ltn=function(D){return this.cmpn(D)===-1},r.prototype.lt=function(D){return this.cmp(D)===-1},r.prototype.lten=function(D){return this.cmpn(D)<=0},r.prototype.lte=function(D){return this.cmp(D)<=0},r.prototype.eqn=function(D){return this.cmpn(D)===0},r.prototype.eq=function(D){return this.cmp(D)===0},r.red=function(D){return new O(D)},r.prototype.toRed=function(D){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),D.convertTo(this)._forceRed(D)},r.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(D){return this.red=D,this},r.prototype.forceRed=function(D){return i(!this.red,"Already a number in reduction context"),this._forceRed(D)},r.prototype.redAdd=function(D){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,D)},r.prototype.redIAdd=function(D){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,D)},r.prototype.redSub=function(D){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,D)},r.prototype.redISub=function(D){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,D)},r.prototype.redShl=function(D){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,D)},r.prototype.redMul=function(D){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.mul(this,D)},r.prototype.redIMul=function(D){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,D),this.red.imul(this,D)},r.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(D){return i(this.red&&!D.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,D)};var u={k256:null,p224:null,p192:null,p25519:null};function h(F,D){this.name=F,this.p=new r(D,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}h.prototype._tmp=function(){var D=new r(null);return D.words=new Array(Math.ceil(this.n/13)),D},h.prototype.ireduce=function(D){var B=D,U;do this.split(B,this.tmp),B=this.imulK(B),B=B.iadd(this.tmp),U=B.bitLength();while(U>this.n);var X=U<this.n?-1:B.ucmp(this.p);return X===0?(B.words[0]=0,B.length=1):X>0?B.isub(this.p):B.strip!==void 0?B.strip():B._strip(),B},h.prototype.split=function(D,B){D.iushrn(this.n,0,B)},h.prototype.imulK=function(D){return D.imul(this.k)};function o(){h.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(o,h),o.prototype.split=function(D,B){for(var U=4194303,X=Math.min(D.length,9),oe=0;oe<X;oe++)B.words[oe]=D.words[oe];if(B.length=X,D.length<=9){D.words[0]=0,D.length=1;return}var se=D.words[9];for(B.words[B.length++]=se&U,oe=10;oe<D.length;oe++){var q=D.words[oe]|0;D.words[oe-10]=(q&U)<<4|se>>>22,se=q}se>>>=22,D.words[oe-10]=se,se===0&&D.length>10?D.length-=10:D.length-=9},o.prototype.imulK=function(D){D.words[D.length]=0,D.words[D.length+1]=0,D.length+=2;for(var B=0,U=0;U<D.length;U++){var X=D.words[U]|0;B+=X*977,D.words[U]=B&67108863,B=X*64+(B/67108864|0)}return D.words[D.length-1]===0&&(D.length--,D.words[D.length-1]===0&&D.length--),D};function S(){h.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(S,h);function R(){h.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(R,h);function z(){h.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(z,h),z.prototype.imulK=function(D){for(var B=0,U=0;U<D.length;U++){var X=(D.words[U]|0)*19+B,oe=X&67108863;X>>>=26,D.words[U]=oe,B=X}return B!==0&&(D.words[D.length++]=B),D},r._prime=function(D){if(u[D])return u[D];var B;if(D==="k256")B=new o;else if(D==="p224")B=new S;else if(D==="p192")B=new R;else if(D==="p25519")B=new z;else throw new Error("Unknown prime "+D);return u[D]=B,B};function O(F){if(typeof F=="string"){var D=r._prime(F);this.m=D.p,this.prime=D}else i(F.gtn(1),"modulus must be greater than 1"),this.m=F,this.prime=null}O.prototype._verify1=function(D){i(D.negative===0,"red works only with positives"),i(D.red,"red works only with red numbers")},O.prototype._verify2=function(D,B){i((D.negative|B.negative)===0,"red works only with positives"),i(D.red&&D.red===B.red,"red works only with red numbers")},O.prototype.imod=function(D){return this.prime?this.prime.ireduce(D)._forceRed(this):D.umod(this.m)._forceRed(this)},O.prototype.neg=function(D){return D.isZero()?D.clone():this.m.sub(D)._forceRed(this)},O.prototype.add=function(D,B){this._verify2(D,B);var U=D.add(B);return U.cmp(this.m)>=0&&U.isub(this.m),U._forceRed(this)},O.prototype.iadd=function(D,B){this._verify2(D,B);var U=D.iadd(B);return U.cmp(this.m)>=0&&U.isub(this.m),U},O.prototype.sub=function(D,B){this._verify2(D,B);var U=D.sub(B);return U.cmpn(0)<0&&U.iadd(this.m),U._forceRed(this)},O.prototype.isub=function(D,B){this._verify2(D,B);var U=D.isub(B);return U.cmpn(0)<0&&U.iadd(this.m),U},O.prototype.shl=function(D,B){return this._verify1(D),this.imod(D.ushln(B))},O.prototype.imul=function(D,B){return this._verify2(D,B),this.imod(D.imul(B))},O.prototype.mul=function(D,B){return this._verify2(D,B),this.imod(D.mul(B))},O.prototype.isqr=function(D){return this.imul(D,D.clone())},O.prototype.sqr=function(D){return this.mul(D,D)},O.prototype.sqrt=function(D){if(D.isZero())return D.clone();var B=this.m.andln(3);if(i(B%2===1),B===3){var U=this.m.add(new r(1)).iushrn(2);return this.pow(D,U)}for(var X=this.m.subn(1),oe=0;!X.isZero()&&X.andln(1)===0;)oe++,X.iushrn(1);i(!X.isZero());var se=new r(1).toRed(this),q=se.redNeg(),K=this.m.subn(1).iushrn(1),G=this.m.bitLength();for(G=new r(2*G*G).toRed(this);this.pow(G,K).cmp(q)!==0;)G.redIAdd(q);for(var Q=this.pow(G,X),V=this.pow(D,X.addn(1).iushrn(1)),H=this.pow(D,X),ee=oe;H.cmp(se)!==0;){for(var J=H,W=0;J.cmp(se)!==0;W++)J=J.redSqr();i(W<ee);var re=this.pow(Q,new r(1).iushln(ee-W-1));V=V.redMul(re),Q=re.redSqr(),H=H.redMul(Q),ee=W}return V},O.prototype.invm=function(D){var B=D._invmp(this.m);return B.negative!==0?(B.negative=0,this.imod(B).redNeg()):this.imod(B)},O.prototype.pow=function(D,B){if(B.isZero())return new r(1).toRed(this);if(B.cmpn(1)===0)return D.clone();var U=4,X=new Array(1<<U);X[0]=new r(1).toRed(this),X[1]=D;for(var oe=2;oe<X.length;oe++)X[oe]=this.mul(X[oe-1],D);var se=X[0],q=0,K=0,G=B.bitLength()%26;for(G===0&&(G=26),oe=B.length-1;oe>=0;oe--){for(var Q=B.words[oe],V=G-1;V>=0;V--){var H=Q>>V&1;if(se!==X[0]&&(se=this.sqr(se)),H===0&&q===0){K=0;continue}q<<=1,q|=H,K++,!(K!==U&&(oe!==0||V!==0))&&(se=this.mul(se,X[q]),K=0,q=0)}G=26}return se},O.prototype.convertTo=function(D){var B=D.umod(this.m);return B===D?B.clone():B},O.prototype.convertFrom=function(D){var B=D.clone();return B.red=null,B},r.mont=function(D){return new I(D)};function I(F){O.call(this,F),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(I,O),I.prototype.convertTo=function(D){return this.imod(D.ushln(this.shift))},I.prototype.convertFrom=function(D){var B=this.imod(D.mul(this.rinv));return B.red=null,B},I.prototype.imul=function(D,B){if(D.isZero()||B.isZero())return D.words[0]=0,D.length=1,D;var U=D.imul(B),X=U.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),oe=U.isub(X).iushrn(this.shift),se=oe;return oe.cmp(this.m)>=0?se=oe.isub(this.m):oe.cmpn(0)<0&&(se=oe.iadd(this.m)),se._forceRed(this)},I.prototype.mul=function(D,B){if(D.isZero()||B.isZero())return new r(0)._forceRed(this);var U=D.mul(B),X=U.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),oe=U.isub(X).iushrn(this.shift),se=oe;return oe.cmp(this.m)>=0?se=oe.isub(this.m):oe.cmpn(0)<0&&(se=oe.iadd(this.m)),se._forceRed(this)},I.prototype.invm=function(D){var B=this.imod(D._invmp(this.m).mul(this.r2));return B._forceRed(this)}})(typeof p>"u"||p,this)},{buffer:2}],34:[function(e,p,g){"use strict";p.exports=a;function a(t){var i,n,r,d=t.length,s=0;for(i=0;i<d;++i)s+=t[i].length;var m=new Array(s),x=0;for(i=0;i<d;++i){var M=t[i],v=M.length;for(n=0;n<v;++n){var _=m[x++]=new Array(v-1),l=0;for(r=0;r<v;++r)r!==n&&(_[l++]=M[r]);if(n&1){var y=_[1];_[1]=_[0],_[0]=y}}}return m}},{}],35:[function(e,p,g){"use strict";p.exports=v;var a=e("typedarray-pool"),t=e("./lib/sweep"),i=e("./lib/intersect");function n(_,l){for(var y=0;y<_;++y)if(!(l[y]<=l[y+_]))return!0;return!1}function r(_,l,y,T){for(var w=0,A=0,f=0,u=_.length;f<u;++f){var h=_[f];if(!n(l,h)){for(var o=0;o<2*l;++o)y[w++]=h[o];T[A++]=f}}return A}function d(_,l,y,T){var w=_.length,A=l.length;if(!(w<=0||A<=0)){var f=_[0].length>>>1;if(!(f<=0)){var u,h=a.mallocDouble(2*f*w),o=a.mallocInt32(w);if(w=r(_,f,h,o),w>0){if(f===1&&T)t.init(w),u=t.sweepComplete(f,y,0,w,h,o,0,w,h,o);else{var S=a.mallocDouble(2*f*A),R=a.mallocInt32(A);A=r(l,f,S,R),A>0&&(t.init(w+A),f===1?u=t.sweepBipartite(f,y,0,w,h,o,0,A,S,R):u=i(f,y,T,w,h,o,A,S,R),a.free(S),a.free(R))}a.free(h),a.free(o)}return u}}}var s;function m(_,l){s.push([_,l])}function x(_){return s=[],d(_,_,m,!0),s}function M(_,l){return s=[],d(_,l,m,!1),s}function v(_,l,y){switch(arguments.length){case 1:return x(_);case 2:return typeof l=="function"?d(_,_,l,!0):M(_,l);case 3:return d(_,l,y,!1);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(e,p,g){"use strict";function a(){function n(s,m,x,M,v,_,l,y,T,w,A){for(var f=2*s,u=M,h=f*M;u<v;++u,h+=f){var o=_[m+h],S=_[m+h+s],R=l[u];e:for(var z=y,O=f*y;z<T;++z,O+=f){var I=w[m+O],F=w[m+O+s],D=A[z];if(!(F<o||S<I)){for(var B=m+1;B<s;++B){var U=_[B+h],X=_[B+s+h],oe=w[B+O],se=w[B+s+O];if(X<oe||se<U)continue e}var q=x(R,D);if(q!==void 0)return q}}}}function r(s,m,x,M,v,_,l,y,T,w,A){for(var f=2*s,u=y,h=f*y;u<T;++u,h+=f){var o=w[m+h],S=w[m+h+s],R=A[u];e:for(var z=M,O=f*M;z<v;++z,O+=f){var I=_[m+O],F=_[m+O+s],D=l[z];if(!(S<I||F<o)){for(var B=m+1;B<s;++B){var U=_[B+O],X=_[B+s+O],oe=w[B+h],se=w[B+s+h];if(X<oe||se<U)continue e}var q=x(D,R);if(q!==void 0)return q}}}}function d(s,m,x,M,v,_,l,y,T,w,A){return v-M>T-y?n(s,m,x,M,v,_,l,y,T,w,A):r(s,m,x,M,v,_,l,y,T,w,A)}return d}function t(){function n(x,M,v,_,l,y,T,w,A,f,u){for(var h=2*x,o=_,S=h*_;o<l;++o,S+=h){var R=y[M+S],z=y[M+S+x],O=T[o];e:for(var I=w,F=h*w;I<A;++I,F+=h){var D=f[M+F],B=u[I];if(!(D<=R||z<D)){for(var U=M+1;U<x;++U){var X=y[U+S],oe=y[U+x+S],se=f[U+F],q=f[U+x+F];if(oe<se||q<X)continue e}var K=v(B,O);if(K!==void 0)return K}}}}function r(x,M,v,_,l,y,T,w,A,f,u){for(var h=2*x,o=_,S=h*_;o<l;++o,S+=h){var R=y[M+S],z=y[M+S+x],O=T[o];e:for(var I=w,F=h*w;I<A;++I,F+=h){var D=f[M+F],B=u[I];if(!(D<R||z<D)){for(var U=M+1;U<x;++U){var X=y[U+S],oe=y[U+x+S],se=f[U+F],q=f[U+x+F];if(oe<se||q<X)continue e}var K=v(O,B);if(K!==void 0)return K}}}}function d(x,M,v,_,l,y,T,w,A,f,u){for(var h=2*x,o=w,S=h*w;o<A;++o,S+=h){var R=f[M+S],z=u[o];e:for(var O=_,I=h*_;O<l;++O,I+=h){var F=y[M+I],D=y[M+I+x],B=T[O];if(!(R<=F||D<R)){for(var U=M+1;U<x;++U){var X=y[U+I],oe=y[U+x+I],se=f[U+S],q=f[U+x+S];if(oe<se||q<X)continue e}var K=v(z,B);if(K!==void 0)return K}}}}function s(x,M,v,_,l,y,T,w,A,f,u){for(var h=2*x,o=w,S=h*w;o<A;++o,S+=h){var R=f[M+S],z=u[o];e:for(var O=_,I=h*_;O<l;++O,I+=h){var F=y[M+I],D=y[M+I+x],B=T[O];if(!(R<F||D<R)){for(var U=M+1;U<x;++U){var X=y[U+I],oe=y[U+x+I],se=f[U+S],q=f[U+x+S];if(oe<se||q<X)continue e}var K=v(B,z);if(K!==void 0)return K}}}}function m(x,M,v,_,l,y,T,w,A,f,u,h){return y-l>f-A?_?n(x,M,v,l,y,T,w,A,f,u,h):r(x,M,v,l,y,T,w,A,f,u,h):_?d(x,M,v,l,y,T,w,A,f,u,h):s(x,M,v,l,y,T,w,A,f,u,h)}return m}function i(n){return n?a():t()}g.partial=i(!1),g.full=i(!0)},{}],37:[function(e,p,g){"use strict";p.exports=F;var a=e("typedarray-pool"),t=e("bit-twiddle"),i=e("./brute"),n=i.partial,r=i.full,d=e("./sweep"),s=e("./median"),m=e("./partition"),x=128,M=1<<22,v=1<<22,_=m("!(lo>=p0)&&!(p1>=hi)"),l=m("lo===p0"),y=m("lo<p0"),T=m("hi<=p0"),w=m("lo<=p0&&p0<=hi"),A=m("lo<p0&&p0<=hi"),f=6,u=2,h=1024,o=a.mallocInt32(h),S=a.mallocDouble(h);function R(D,B){var U=8*t.log2(B+1)*(D+1)|0,X=t.nextPow2(f*U);o.length<X&&(a.free(o),o=a.mallocInt32(X));var oe=t.nextPow2(u*U);S.length<oe&&(a.free(S),S=a.mallocDouble(oe))}function z(D,B,U,X,oe,se,q,K,G){var Q=f*D;o[Q]=B,o[Q+1]=U,o[Q+2]=X,o[Q+3]=oe,o[Q+4]=se,o[Q+5]=q;var V=u*D;S[V]=K,S[V+1]=G}function O(D,B,U,X,oe,se,q,K,G,Q,V){var H=2*D,ee=G*H,J=Q[ee+B];e:for(var W=oe,re=oe*H;W<se;++W,re+=H){var j=q[re+B],Z=q[re+B+D];if(!(J<j||Z<J)&&!(X&&J===j)){for(var ne=K[W],le=B+1;le<D;++le){var j=q[re+le],Z=q[re+le+D],ge=Q[ee+le],pe=Q[ee+le+D];if(Z<ge||pe<j)continue e}var xe;if(X?xe=U(V,ne):xe=U(ne,V),xe!==void 0)return xe}}}function I(D,B,U,X,oe,se,q,K,G,Q){var V=2*D,H=K*V,ee=G[H+B];e:for(var J=X,W=X*V;J<oe;++J,W+=V){var re=q[J];if(re!==Q){var j=se[W+B],Z=se[W+B+D];if(!(ee<j||Z<ee)){for(var ne=B+1;ne<D;++ne){var j=se[W+ne],Z=se[W+ne+D],le=G[H+ne],ge=G[H+ne+D];if(Z<le||ge<j)continue e}var pe=U(re,Q);if(pe!==void 0)return pe}}}}function F(D,B,U,X,oe,se,q,K,G){R(D,X+q);var Q=0,V=2*D,H;for(z(Q++,0,0,X,0,q,U?16:0,-1/0,1/0),U||z(Q++,0,0,q,0,X,1,-1/0,1/0);Q>0;){Q-=1;var ee=Q*f,J=o[ee],W=o[ee+1],re=o[ee+2],j=o[ee+3],Z=o[ee+4],ne=o[ee+5],le=Q*u,ge=S[le],pe=S[le+1],xe=ne&1,Ee=!!(ne&16),Te=oe,de=se,be=K,Le=G;if(xe&&(Te=K,de=G,be=oe,Le=se),!(ne&2&&(re=y(D,J,W,re,Te,de,pe),W>=re))&&!(ne&4&&(W=T(D,J,W,re,Te,de,ge),W>=re))){var De=re-W,ye=Z-j;if(Ee){if(D*De*(De+ye)<v){if(H=d.scanComplete(D,J,B,W,re,Te,de,j,Z,be,Le),H!==void 0)return H;continue}}else if(D*Math.min(De,ye)<x){if(H=n(D,J,B,xe,W,re,Te,de,j,Z,be,Le),H!==void 0)return H;continue}else if(D*De*ye<M){if(H=d.scanBipartite(D,J,B,xe,W,re,Te,de,j,Z,be,Le),H!==void 0)return H;continue}var ke=_(D,J,W,re,Te,de,ge,pe);if(W<ke)if(D*(ke-W)<x){if(H=r(D,J+1,B,W,ke,Te,de,j,Z,be,Le),H!==void 0)return H}else if(J===D-2){if(xe?H=d.sweepBipartite(D,B,j,Z,be,Le,W,ke,Te,de):H=d.sweepBipartite(D,B,W,ke,Te,de,j,Z,be,Le),H!==void 0)return H}else z(Q++,J+1,W,ke,j,Z,xe,-1/0,1/0),z(Q++,J+1,j,Z,W,ke,xe^1,-1/0,1/0);if(ke<re){var Oe=s(D,J,j,Z,be,Le),Qe=be[V*Oe+J],Ve=l(D,J,Oe,Z,be,Le,Qe);if(Ve<Z&&z(Q++,J,ke,re,Ve,Z,(xe|4)+(Ee?16:0),Qe,pe),j<Oe&&z(Q++,J,ke,re,j,Oe,(xe|2)+(Ee?16:0),ge,Qe),Oe+1===Ve){if(Ee?H=I(D,J,B,ke,re,Te,de,Oe,be,Le[Oe]):H=O(D,J,B,xe,ke,re,Te,de,Oe,be,Le[Oe]),H!==void 0)return H}else if(Oe<Ve){var Ue;if(Ee){if(Ue=w(D,J,ke,re,Te,de,Qe),ke<Ue){var Ie=l(D,J,ke,Ue,Te,de,Qe);if(J===D-2){if(ke<Ie&&(H=d.sweepComplete(D,B,ke,Ie,Te,de,Oe,Ve,be,Le),H!==void 0)||Ie<Ue&&(H=d.sweepBipartite(D,B,Ie,Ue,Te,de,Oe,Ve,be,Le),H!==void 0))return H}else ke<Ie&&z(Q++,J+1,ke,Ie,Oe,Ve,16,-1/0,1/0),Ie<Ue&&(z(Q++,J+1,Ie,Ue,Oe,Ve,0,-1/0,1/0),z(Q++,J+1,Oe,Ve,Ie,Ue,1,-1/0,1/0))}}else xe?Ue=A(D,J,ke,re,Te,de,Qe):Ue=w(D,J,ke,re,Te,de,Qe),ke<Ue&&(J===D-2?xe?H=d.sweepBipartite(D,B,Oe,Ve,be,Le,ke,Ue,Te,de):H=d.sweepBipartite(D,B,ke,Ue,Te,de,Oe,Ve,be,Le):(z(Q++,J+1,ke,Ue,Oe,Ve,xe,-1/0,1/0),z(Q++,J+1,Oe,Ve,ke,Ue,xe^1,-1/0,1/0)))}}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(e,p,g){"use strict";p.exports=r;var a=e("./partition"),t=a("lo<p0"),i=8;function n(d,s,m,x,M,v){for(var _=2*d,l=_*(m+1)+s,y=m+1;y<x;++y,l+=_)for(var T=M[l],w=y,A=_*(y-1);w>m&&M[A+s]>T;--w,A-=_){for(var f=A,u=A+_,h=0;h<_;++h,++f,++u){var o=M[f];M[f]=M[u],M[u]=o}var S=v[w];v[w]=v[w-1],v[w-1]=S}}function r(d,s,m,x,M,v){if(x<=m+1)return m;for(var _=m,l=x,y=x+m>>>1,T=2*d,w=y,A=M[T*y+s];_<l;){if(l-_<i){n(d,s,_,l,M,v),A=M[T*y+s];break}var f=l-_,u=Math.random()*f+_|0,h=M[T*u+s],o=Math.random()*f+_|0,S=M[T*o+s],R=Math.random()*f+_|0,z=M[T*R+s];h<=S?z>=S?(w=o,A=S):h>=z?(w=u,A=h):(w=R,A=z):S>=z?(w=o,A=S):z>=h?(w=u,A=h):(w=R,A=z);for(var F=T*(l-1),D=T*w,O=0;O<T;++O,++F,++D){var I=M[F];M[F]=M[D],M[D]=I}var B=v[l-1];v[l-1]=v[w],v[w]=B,w=t(d,s,_,l-1,M,v,A);for(var F=T*(l-1),D=T*w,O=0;O<T;++O,++F,++D){var I=M[F];M[F]=M[D],M[D]=I}var B=v[l-1];if(v[l-1]=v[w],v[w]=B,y<w){for(l=w-1;_<l&&M[T*(l-1)+s]===A;)l-=1;l+=1}else if(w<y)for(_=w+1;_<l&&M[T*_+s]===A;)_+=1;else break}return t(d,s,m,y,M,v,M[T*y+s])}},{"./partition":39}],39:[function(e,p,g){"use strict";p.exports=t;var a={"lo===p0":i,"lo<p0":n,"lo<=p0":r,"hi<=p0":d,"lo<p0&&p0<=hi":m,"lo<=p0&&p0<=hi":s,"!(lo>=p0)&&!(p1>=hi)":x};function t(M){return a[M]}function i(M,v,_,l,y,T,w){for(var A=2*M,f=A*_,u=f,h=_,o=v,S=M+v,R=_;l>R;++R,f+=A){var z=y[f+o];if(z===w)if(h===R)h+=1,u+=A;else{for(var O=0;A>O;++O){var I=y[f+O];y[f+O]=y[u],y[u++]=I}var F=T[R];T[R]=T[h],T[h++]=F}}return h}function n(M,v,_,l,y,T,w){for(var A=2*M,f=A*_,u=f,h=_,o=v,S=M+v,R=_;l>R;++R,f+=A){var z=y[f+o];if(z<w)if(h===R)h+=1,u+=A;else{for(var O=0;A>O;++O){var I=y[f+O];y[f+O]=y[u],y[u++]=I}var F=T[R];T[R]=T[h],T[h++]=F}}return h}function r(M,v,_,l,y,T,w){for(var A=2*M,f=A*_,u=f,h=_,o=v,S=M+v,R=_;l>R;++R,f+=A){var z=y[f+S];if(z<=w)if(h===R)h+=1,u+=A;else{for(var O=0;A>O;++O){var I=y[f+O];y[f+O]=y[u],y[u++]=I}var F=T[R];T[R]=T[h],T[h++]=F}}return h}function d(M,v,_,l,y,T,w){for(var A=2*M,f=A*_,u=f,h=_,o=v,S=M+v,R=_;l>R;++R,f+=A){var z=y[f+S];if(z<=w)if(h===R)h+=1,u+=A;else{for(var O=0;A>O;++O){var I=y[f+O];y[f+O]=y[u],y[u++]=I}var F=T[R];T[R]=T[h],T[h++]=F}}return h}function s(M,v,_,l,y,T,w){for(var A=2*M,f=A*_,u=f,h=_,o=v,S=M+v,R=_;l>R;++R,f+=A){var z=y[f+o],O=y[f+S];if(z<=w&&w<=O)if(h===R)h+=1,u+=A;else{for(var I=0;A>I;++I){var F=y[f+I];y[f+I]=y[u],y[u++]=F}var D=T[R];T[R]=T[h],T[h++]=D}}return h}function m(M,v,_,l,y,T,w){for(var A=2*M,f=A*_,u=f,h=_,o=v,S=M+v,R=_;l>R;++R,f+=A){var z=y[f+o],O=y[f+S];if(z<w&&w<=O)if(h===R)h+=1,u+=A;else{for(var I=0;A>I;++I){var F=y[f+I];y[f+I]=y[u],y[u++]=F}var D=T[R];T[R]=T[h],T[h++]=D}}return h}function x(M,v,_,l,y,T,w,A){for(var f=2*M,u=f*_,h=u,o=_,S=v,R=M+v,z=_;l>z;++z,u+=f){var O=y[u+S],I=y[u+R];if(!(O>=w)&&!(A>=I))if(o===z)o+=1,h+=f;else{for(var F=0;f>F;++F){var D=y[u+F];y[u+F]=y[h],y[h++]=D}var B=T[z];T[z]=T[o],T[o++]=B}}return o}},{}],40:[function(e,p,g){"use strict";p.exports=t;var a=32;function t(v,_){_<=4*a?i(0,_-1,v):M(0,_-1,v)}function i(v,_,l){for(var y=2*(v+1),T=v+1;T<=_;++T){for(var w=l[y++],A=l[y++],f=T,u=y-2;f-- >v;){var h=l[u-2],o=l[u-1];if(h<w)break;if(h===w&&o<A)break;l[u]=h,l[u+1]=o,u-=2}l[u]=w,l[u+1]=A}}function n(v,_,l){v*=2,_*=2;var y=l[v],T=l[v+1];l[v]=l[_],l[v+1]=l[_+1],l[_]=y,l[_+1]=T}function r(v,_,l){v*=2,_*=2,l[v]=l[_],l[v+1]=l[_+1]}function d(v,_,l,y){v*=2,_*=2,l*=2;var T=y[v],w=y[v+1];y[v]=y[_],y[v+1]=y[_+1],y[_]=y[l],y[_+1]=y[l+1],y[l]=T,y[l+1]=w}function s(v,_,l,y,T){v*=2,_*=2,T[v]=T[_],T[_]=l,T[v+1]=T[_+1],T[_+1]=y}function m(v,_,l){v*=2,_*=2;var y=l[v],T=l[_];return y<T?!1:y===T?l[v+1]>l[_+1]:!0}function x(v,_,l,y){v*=2;var T=y[v];return T<_?!0:T===_?y[v+1]<l:!1}function M(v,_,l){var y=(_-v+1)/6|0,T=v+y,w=_-y,A=v+_>>1,f=A-y,u=A+y,h=T,o=f,S=A,R=u,z=w,O=v+1,I=_-1,F=0;m(h,o,l)&&(F=h,h=o,o=F),m(R,z,l)&&(F=R,R=z,z=F),m(h,S,l)&&(F=h,h=S,S=F),m(o,S,l)&&(F=o,o=S,S=F),m(h,R,l)&&(F=h,h=R,R=F),m(S,R,l)&&(F=S,S=R,R=F),m(o,z,l)&&(F=o,o=z,z=F),m(o,S,l)&&(F=o,o=S,S=F),m(R,z,l)&&(F=R,R=z,z=F);for(var D=l[2*o],B=l[2*o+1],U=l[2*R],X=l[2*R+1],oe=2*h,se=2*S,q=2*z,K=2*T,G=2*A,Q=2*w,V=0;V<2;++V){var H=l[oe+V],ee=l[se+V],J=l[q+V];l[K+V]=H,l[G+V]=ee,l[Q+V]=J}r(f,v,l),r(u,_,l);for(var W=O;W<=I;++W)if(x(W,D,B,l))W!==O&&n(W,O,l),++O;else if(!x(W,U,X,l))for(;;)if(x(I,U,X,l)){x(I,D,B,l)?(d(W,O,I,l),++O,--I):(n(W,I,l),--I);break}else{if(--I<W)break;continue}s(v,O-1,D,B,l),s(_,I+1,U,X,l),O-2-v<=a?i(v,O-2,l):M(v,O-2,l),_-(I+2)<=a?i(I+2,_,l):M(I+2,_,l),I-O<=a?i(O,I,l):M(O,I,l)}},{}],41:[function(e,p,g){"use strict";p.exports={init:l,sweepBipartite:w,sweepComplete:A,scanBipartite:f,scanComplete:u};var a=e("typedarray-pool"),t=e("bit-twiddle"),i=e("./sort"),n=1<<28,r=1024,d=a.mallocInt32(r),s=a.mallocInt32(r),m=a.mallocInt32(r),x=a.mallocInt32(r),M=a.mallocInt32(r),v=a.mallocInt32(r),_=a.mallocDouble(r*8);function l(h){var o=t.nextPow2(h);d.length<o&&(a.free(d),d=a.mallocInt32(o)),s.length<o&&(a.free(s),s=a.mallocInt32(o)),m.length<o&&(a.free(m),m=a.mallocInt32(o)),x.length<o&&(a.free(x),x=a.mallocInt32(o)),M.length<o&&(a.free(M),M=a.mallocInt32(o)),v.length<o&&(a.free(v),v=a.mallocInt32(o));var S=8*o;_.length<S&&(a.free(_),_=a.mallocDouble(S))}function y(h,o,S,R){var z=o[R],O=h[S-1];h[z]=O,o[O]=z}function T(h,o,S,R){h[S]=R,o[R]=S}function w(h,o,S,R,z,O,I,F,D,B){for(var U=0,X=2*h,oe=h-1,se=X-1,q=S;q<R;++q){var K=O[q],G=X*q;_[U++]=z[G+oe],_[U++]=-(K+1),_[U++]=z[G+se],_[U++]=K}for(var q=I;q<F;++q){var K=B[q]+n,Q=X*q;_[U++]=D[Q+oe],_[U++]=-K,_[U++]=D[Q+se],_[U++]=K}var V=U>>>1;i(_,V);for(var H=0,ee=0,q=0;q<V;++q){var J=_[2*q+1]|0;if(J>=n)J=J-n|0,y(m,x,ee--,J);else if(J>=0)y(d,s,H--,J);else if(J<=-n){J=-J-n|0;for(var W=0;W<H;++W){var re=o(d[W],J);if(re!==void 0)return re}T(m,x,ee++,J)}else{J=-J-1|0;for(var W=0;W<ee;++W){var re=o(J,m[W]);if(re!==void 0)return re}T(d,s,H++,J)}}}function A(h,o,S,R,z,O,I,F,D,B){for(var U=0,X=2*h,oe=h-1,se=X-1,q=S;q<R;++q){var K=O[q]+1<<1,G=X*q;_[U++]=z[G+oe],_[U++]=-K,_[U++]=z[G+se],_[U++]=K}for(var q=I;q<F;++q){var K=B[q]+1<<1,Q=X*q;_[U++]=D[Q+oe],_[U++]=-K|1,_[U++]=D[Q+se],_[U++]=K|1}var V=U>>>1;i(_,V);for(var H=0,ee=0,J=0,q=0;q<V;++q){var W=_[2*q+1]|0,re=W&1;if(q<V-1&&W>>1===_[2*q+3]>>1&&(re=2,q+=1),W<0){for(var j=-(W>>1)-1,Z=0;Z<J;++Z){var ne=o(M[Z],j);if(ne!==void 0)return ne}if(re!==0)for(var Z=0;Z<H;++Z){var ne=o(d[Z],j);if(ne!==void 0)return ne}if(re!==1)for(var Z=0;Z<ee;++Z){var ne=o(m[Z],j);if(ne!==void 0)return ne}re===0?T(d,s,H++,j):re===1?T(m,x,ee++,j):re===2&&T(M,v,J++,j)}else{var j=(W>>1)-1;re===0?y(d,s,H--,j):re===1?y(m,x,ee--,j):re===2&&y(M,v,J--,j)}}}function f(h,o,S,R,z,O,I,F,D,B,U,X){var oe=0,se=2*h,q=o,K=o+h,G=1,Q=1;R?Q=n:G=n;for(var V=z;V<O;++V){var H=V+G,ee=se*V;_[oe++]=I[ee+q],_[oe++]=-H,_[oe++]=I[ee+K],_[oe++]=H}for(var V=D;V<B;++V){var H=V+Q,J=se*V;_[oe++]=U[J+q],_[oe++]=-H}var W=oe>>>1;i(_,W);for(var re=0,V=0;V<W;++V){var j=_[2*V+1]|0;if(j<0){var H=-j,Z=!1;if(H>=n?(Z=!R,H-=n):(Z=!!R,H-=1),Z)T(d,s,re++,H);else{var ne=X[H],le=se*H,ge=U[le+o+1],pe=U[le+o+1+h];e:for(var xe=0;xe<re;++xe){var Ee=d[xe],Te=se*Ee;if(!(pe<I[Te+o+1]||I[Te+o+1+h]<ge)){for(var de=o+2;de<h;++de)if(U[le+de+h]<I[Te+de]||I[Te+de+h]<U[le+de])continue e;var be=F[Ee],Le;if(R?Le=S(ne,be):Le=S(be,ne),Le!==void 0)return Le}}}}else y(d,s,re--,j-G)}}function u(h,o,S,R,z,O,I,F,D,B,U){for(var X=0,oe=2*h,se=o,q=o+h,K=R;K<z;++K){var G=K+n,Q=oe*K;_[X++]=O[Q+se],_[X++]=-G,_[X++]=O[Q+q],_[X++]=G}for(var K=F;K<D;++K){var G=K+1,V=oe*K;_[X++]=B[V+se],_[X++]=-G}var H=X>>>1;i(_,H);for(var ee=0,K=0;K<H;++K){var J=_[2*K+1]|0;if(J<0){var G=-J;if(G>=n)d[ee++]=G-n;else{G-=1;var W=U[G],re=oe*G,j=B[re+o+1],Z=B[re+o+1+h];e:for(var ne=0;ne<ee;++ne){var le=d[ne],ge=I[le];if(ge===W)break;var pe=oe*le;if(!(Z<O[pe+o+1]||O[pe+o+1+h]<j)){for(var xe=o+2;xe<h;++xe)if(B[re+xe+h]<O[pe+xe]||O[pe+xe+h]<B[re+xe])continue e;var Ee=S(ge,W);if(Ee!==void 0)return Ee}}}}else{for(var G=J-n,ne=ee-1;ne>=0;--ne)if(d[ne]===G){for(var xe=ne+1;xe<ee;++xe)d[xe-1]=d[xe];break}--ee}}}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(e,p,g){"use strict";var a=e("./lib/monotone"),t=e("./lib/triangulation"),i=e("./lib/delaunay"),n=e("./lib/filter");p.exports=x;function r(M){return[Math.min(M[0],M[1]),Math.max(M[0],M[1])]}function d(M,v){return M[0]-v[0]||M[1]-v[1]}function s(M){return M.map(r).sort(d)}function m(M,v,_){return v in M?M[v]:_}function x(M,v,_){Array.isArray(v)?(_=_||{},v=v||[]):(_=v||{},v=[]);var l=!!m(_,"delaunay",!0),y=!!m(_,"interior",!0),T=!!m(_,"exterior",!0),w=!!m(_,"infinity",!1);if(!y&&!T||M.length===0)return[];var A=a(M,v);if(l||y!==T||w){for(var f=t(M.length,s(v)),u=0;u<A.length;++u){var h=A[u];f.addTriangle(h[0],h[1],h[2])}return l&&i(M,f),T?y?w?n(f,0,w):f.cells():n(f,1,w):n(f,-1)}else return A}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(e,p,g){"use strict";var a=e("robust-in-sphere")[4],t=e("binary-search-bounds");p.exports=n;function i(r,d,s,m,x,M){var v=d.opposite(m,x);if(!(v<0)){if(x<m){var _=m;m=x,x=_,_=M,M=v,v=_}d.isConstraint(m,x)||a(r[m],r[x],r[M],r[v])<0&&s.push(m,x)}}function n(r,d){for(var s=[],m=r.length,x=d.stars,M=0;M<m;++M)for(var v=x[M],_=1;_<v.length;_+=2){var l=v[_];if(!(l<M)&&!d.isConstraint(M,l)){for(var y=v[_-1],T=-1,w=1;w<v.length;w+=2)if(v[w-1]===l){T=v[w];break}T<0||a(r[M],r[l],r[y],r[T])<0&&s.push(M,l)}}for(;s.length>0;){for(var l=s.pop(),M=s.pop(),y=-1,T=-1,v=x[M],A=1;A<v.length;A+=2){var f=v[A-1],u=v[A];f===l?T=u:u===l&&(y=f)}y<0||T<0||a(r[M],r[l],r[y],r[T])>=0||(d.flip(M,l),i(r,d,s,y,M,T),i(r,d,s,M,T,y),i(r,d,s,T,l,y),i(r,d,s,l,y,T))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(e,p,g){"use strict";var a=e("binary-search-bounds");p.exports=s;function t(m,x,M,v,_,l,y){this.cells=m,this.neighbor=x,this.flags=v,this.constraint=M,this.active=_,this.next=l,this.boundary=y}var i=t.prototype;function n(m,x){return m[0]-x[0]||m[1]-x[1]||m[2]-x[2]}i.locate=function(){var m=[0,0,0];return function(x,M,v){var _=x,l=M,y=v;return M<v?M<x&&(_=M,l=v,y=x):v<x&&(_=v,l=x,y=M),_<0?-1:(m[0]=_,m[1]=l,m[2]=y,a.eq(this.cells,m,n))}}();function r(m,x){for(var M=m.cells(),v=M.length,_=0;_<v;++_){var l=M[_],y=l[0],T=l[1],w=l[2];T<w?T<y&&(l[0]=T,l[1]=w,l[2]=y):w<y&&(l[0]=w,l[1]=y,l[2]=T)}M.sort(n);for(var A=new Array(v),_=0;_<A.length;++_)A[_]=0;var f=[],u=[],h=new Array(3*v),o=new Array(3*v),S=null;x&&(S=[]);for(var R=new t(M,h,o,A,f,u,S),_=0;_<v;++_)for(var l=M[_],z=0;z<3;++z){var y=l[z],T=l[(z+1)%3],O=h[3*_+z]=R.locate(T,y,m.opposite(T,y)),I=o[3*_+z]=m.isConstraint(y,T);O<0&&(I?u.push(_):(f.push(_),A[_]=1),x&&S.push([T,y,-1]))}return R}function d(m,x,M){for(var v=0,_=0;_<m.length;++_)x[_]===M&&(m[v++]=m[_]);return m.length=v,m}function s(m,x,M){var v=r(m,M);if(x===0)return M?v.cells.concat(v.boundary):v.cells;for(var _=1,l=v.active,y=v.next,T=v.flags,w=v.cells,A=v.constraint,f=v.neighbor;l.length>0||y.length>0;){for(;l.length>0;){var u=l.pop();if(T[u]!==-_){T[u]=_;for(var h=w[u],o=0;o<3;++o){var S=f[3*u+o];S>=0&&T[S]===0&&(A[3*u+o]?y.push(S):(l.push(S),T[S]=_))}}}var R=y;y=l,l=R,y.length=0,_=-_}var z=d(w,T,x);return M?z.concat(v.boundary):z}},{"binary-search-bounds":31}],45:[function(e,p,g){"use strict";var a=e("binary-search-bounds"),t=e("robust-orientation")[3],i=0,n=1,r=2;p.exports=y;function d(T,w,A,f,u){this.a=T,this.b=w,this.idx=A,this.lowerIds=f,this.upperIds=u}function s(T,w,A,f){this.a=T,this.b=w,this.type=A,this.idx=f}function m(T,w){var A=T.a[0]-w.a[0]||T.a[1]-w.a[1]||T.type-w.type;return A||T.type!==i&&(A=t(T.a,T.b,w.b),A)?A:T.idx-w.idx}function x(T,w){return t(T.a,T.b,w)}function M(T,w,A,f,u){for(var h=a.lt(w,f,x),o=a.gt(w,f,x),S=h;S<o;++S){for(var R=w[S],z=R.lowerIds,I=z.length;I>1&&t(A[z[I-2]],A[z[I-1]],f)>0;)T.push([z[I-1],z[I-2],u]),I-=1;z.length=I,z.push(u);for(var O=R.upperIds,I=O.length;I>1&&t(A[O[I-2]],A[O[I-1]],f)<0;)T.push([O[I-2],O[I-1],u]),I-=1;O.length=I,O.push(u)}}function v(T,w){var A;return T.a[0]<w.a[0]?A=t(T.a,T.b,w.a):A=t(w.b,w.a,T.a),A||(w.b[0]<T.b[0]?A=t(T.a,T.b,w.b):A=t(w.b,w.a,T.b),A||T.idx-w.idx)}function _(T,w,A){var f=a.le(T,A,v),u=T[f],h=u.upperIds,o=h[h.length-1];u.upperIds=[o],T.splice(f+1,0,new d(A.a,A.b,A.idx,[o],h))}function l(T,w,A){var f=A.a;A.a=A.b,A.b=f;var u=a.eq(T,A,v),h=T[u],o=T[u-1];o.upperIds=h.upperIds,T.splice(u,1)}function y(T,w){for(var A=T.length,f=w.length,u=[],h=0;h<A;++h)u.push(new s(T[h],null,i,h));for(var h=0;h<f;++h){var o=w[h],S=T[o[0]],R=T[o[1]];S[0]<R[0]?u.push(new s(S,R,r,h),new s(R,S,n,h)):S[0]>R[0]&&u.push(new s(R,S,r,h),new s(S,R,n,h))}u.sort(m);for(var z=u[0].a[0]-(1+Math.abs(u[0].a[0]))*Math.pow(2,-52),O=[new d([z,1],[z,0],-1,[],[],[],[])],I=[],h=0,F=u.length;h<F;++h){var D=u[h],B=D.type;B===i?M(I,O,T,D.a,D.idx):B===r?_(O,T,D):l(O,T,D)}return I}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(e,p,g){"use strict";var a=e("binary-search-bounds");p.exports=r;function t(d,s){this.stars=d,this.edges=s}var i=t.prototype;function n(d,s,m){for(var x=1,M=d.length;x<M;x+=2)if(d[x-1]===s&&d[x]===m){d[x-1]=d[M-2],d[x]=d[M-1],d.length=M-2;return}}i.isConstraint=function(){var d=[0,0];function s(m,x){return m[0]-x[0]||m[1]-x[1]}return function(m,x){return d[0]=Math.min(m,x),d[1]=Math.max(m,x),a.eq(this.edges,d,s)>=0}}(),i.removeTriangle=function(d,s,m){var x=this.stars;n(x[d],s,m),n(x[s],m,d),n(x[m],d,s)},i.addTriangle=function(d,s,m){var x=this.stars;x[d].push(s,m),x[s].push(m,d),x[m].push(d,s)},i.opposite=function(d,s){for(var m=this.stars[s],x=1,M=m.length;x<M;x+=2)if(m[x]===d)return m[x-1];return-1},i.flip=function(d,s){var m=this.opposite(d,s),x=this.opposite(s,d);this.removeTriangle(d,s,m),this.removeTriangle(s,d,x),this.addTriangle(d,x,m),this.addTriangle(s,m,x)},i.edges=function(){for(var d=this.stars,s=[],m=0,x=d.length;m<x;++m)for(var M=d[m],v=0,_=M.length;v<_;v+=2)s.push([M[v],M[v+1]]);return s},i.cells=function(){for(var d=this.stars,s=[],m=0,x=d.length;m<x;++m)for(var M=d[m],v=0,_=M.length;v<_;v+=2){var l=M[v],y=M[v+1];m<Math.min(l,y)&&s.push([m,l,y])}return s};function r(d,s){for(var m=new Array(d),x=0;x<d;++x)m[x]=[];return new t(m,s)}},{"binary-search-bounds":31}],47:[function(e,p,g){"use strict";p.exports=a;function a(t){for(var i=1,n=1;n<t.length;++n)for(var r=0;r<n;++r)if(t[n]<t[r])i=-i;else if(t[r]===t[n])return 0;return i}},{}],48:[function(e,p,g){"use strict";var a=e("dup"),t=e("robust-linear-solve");function i(d,s){for(var m=0,x=d.length,M=0;M<x;++M)m+=d[M]*s[M];return m}function n(d){var s=d.length;if(s===0)return[];var m=d[0].length,x=a([d.length+1,d.length+1],1),M=a([d.length+1],1);x[s][s]=0;for(var v=0;v<s;++v){for(var _=0;_<=v;++_)x[_][v]=x[v][_]=2*i(d[v],d[_]);M[v]=i(d[v],d[v])}for(var l=t(x,M),y=0,T=l[s+1],v=0;v<T.length;++v)y+=T[v];for(var w=new Array(s),v=0;v<s;++v){for(var T=l[v],A=0,_=0;_<T.length;++_)A+=T[_];w[v]=A/y}return w}function r(d){if(d.length===0)return[];for(var s=d[0].length,m=a([s]),x=n(d),M=0;M<d.length;++M)for(var v=0;v<s;++v)m[v]+=d[M][v]*x[M];return m}r.barycenetric=n,p.exports=r},{dup:65,"robust-linear-solve":283}],49:[function(e,p,g){p.exports=t;var a=e("circumcenter");function t(i){for(var n=a(i),r=0,d=0;d<i.length;++d)for(var s=i[d],m=0;m<n.length;++m)r+=Math.pow(s[m]-n[m],2);return Math.sqrt(r/i.length)}},{circumcenter:48}],50:[function(e,p,g){"use strict";p.exports=S;var a=e("union-find"),t=e("box-intersect"),i=e("robust-segment-intersect"),n=e("big-rat"),r=e("big-rat/cmp"),d=e("big-rat/to-float"),s=e("rat-vec"),m=e("nextafter"),x=e("./lib/rat-seg-intersect");function M(R){var z=d(R);return[m(z,-1/0),m(z,1/0)]}function v(R,z){for(var O=new Array(z.length),I=0;I<z.length;++I){var F=z[I],D=R[F[0]],B=R[F[1]];O[I]=[m(Math.min(D[0],B[0]),-1/0),m(Math.min(D[1],B[1]),-1/0),m(Math.max(D[0],B[0]),1/0),m(Math.max(D[1],B[1]),1/0)]}return O}function _(R){for(var z=new Array(R.length),O=0;O<R.length;++O){var I=R[O];z[O]=[m(I[0],-1/0),m(I[1],-1/0),m(I[0],1/0),m(I[1],1/0)]}return z}function l(R,z,O){var I=[];return t(O,function(F,D){var B=z[F],U=z[D];if(!(B[0]===U[0]||B[0]===U[1]||B[1]===U[0]||B[1]===U[1])){var X=R[B[0]],oe=R[B[1]],se=R[U[0]],q=R[U[1]];i(X,oe,se,q)&&I.push([F,D])}}),I}function y(R,z,O,I){var F=[];return t(O,I,function(D,B){var U=z[D];if(!(U[0]===B||U[1]===B)){var X=R[B],oe=R[U[0]],se=R[U[1]];i(oe,se,X,X)&&F.push([D,B])}}),F}function T(R,z,O,I,F){var D,B,U=R.map(function(le){return[n(le[0]),n(le[1])]});for(D=0;D<O.length;++D){var X=O[D];B=X[0];var oe=X[1],se=z[B],q=z[oe],K=x(s(R[se[0]]),s(R[se[1]]),s(R[q[0]]),s(R[q[1]]));if(!!K){var G=R.length;R.push([d(K[0]),d(K[1])]),U.push(K),I.push([B,G],[oe,G])}}for(I.sort(function(le,ge){if(le[0]!==ge[0])return le[0]-ge[0];var pe=U[le[1]],xe=U[ge[1]];return r(pe[0],xe[0])||r(pe[1],xe[1])}),D=I.length-1;D>=0;--D){var Q=I[D];B=Q[0];var V=z[B],H=V[0],ee=V[1],J=R[H],W=R[ee];if((J[0]-W[0]||J[1]-W[1])<0){var re=H;H=ee,ee=re}V[0]=H;var j=V[1]=Q[1],Z;for(F&&(Z=V[2]);D>0&&I[D-1][0]===B;){var Q=I[--D],ne=Q[1];F?z.push([j,ne,Z]):z.push([j,ne]),j=ne}F?z.push([j,ee,Z]):z.push([j,ee])}return U}function w(R,z,O){for(var I=z.length,F=new a(I),D=[],B=0;B<z.length;++B){var U=z[B],X=M(U[0]),oe=M(U[1]);D.push([m(X[0],-1/0),m(oe[0],-1/0),m(X[1],1/0),m(oe[1],1/0)])}t(D,function(Q,V){F.link(Q,V)});for(var se=!0,q=new Array(I),B=0;B<I;++B){var K=F.find(B);K!==B&&(se=!1,R[K]=[Math.min(R[B][0],R[K][0]),Math.min(R[B][1],R[K][1])])}if(se)return null;for(var G=0,B=0;B<I;++B){var K=F.find(B);K===B?(q[B]=G,R[G++]=R[B]):q[B]=-1}R.length=G;for(var B=0;B<I;++B)q[B]<0&&(q[B]=q[F.find(B)]);return q}function A(R,z){return R[0]-z[0]||R[1]-z[1]}function f(R,z){var O=R[0]-z[0]||R[1]-z[1];return O||(R[2]<z[2]?-1:R[2]>z[2]?1:0)}function u(R,z,O){if(R.length!==0){if(z)for(var I=0;I<R.length;++I){var F=R[I],D=z[F[0]],B=z[F[1]];F[0]=Math.min(D,B),F[1]=Math.max(D,B)}else for(var I=0;I<R.length;++I){var F=R[I],D=F[0],B=F[1];F[0]=Math.min(D,B),F[1]=Math.max(D,B)}O?R.sort(f):R.sort(A);for(var U=1,I=1;I<R.length;++I){var X=R[I-1],oe=R[I];oe[0]===X[0]&&oe[1]===X[1]&&(!O||oe[2]===X[2])||(R[U++]=oe)}R.length=U}}function h(R,z,O){var I=w(R,[],_(R));return u(z,I,O),!!I}function o(R,z,O){var I=v(R,z),F=l(R,z,I),D=_(R),B=y(R,z,I,D),U=T(R,z,F,B,O),X=w(R,U,D);return u(z,X,O),X?!0:F.length>0||B.length>0}function S(R,z,O){var I;if(O){I=z;for(var F=new Array(z.length),D=0;D<z.length;++D){var B=z[D];F[D]=[B[0],B[1],O[D]]}z=F}for(var U=h(R,z,!!O);o(R,z,!!O);)U=!0;if(!!O&&U){I.length=0,O.length=0;for(var D=0;D<z.length;++D){var B=z[D];I.push([B[0],B[1]]),O.push(B[2])}}return U}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(e,p,g){"use strict";p.exports=x;var a=e("big-rat/mul"),t=e("big-rat/div"),i=e("big-rat/sub"),n=e("big-rat/sign"),r=e("rat-vec/sub"),d=e("rat-vec/add"),s=e("rat-vec/muls");function m(M,v){return i(a(M[0],v[1]),a(M[1],v[0]))}function x(M,v,_,l){var y=r(v,M),T=r(l,_),w=m(y,T);if(n(w)===0)return null;var A=r(M,_),f=m(T,A),u=t(f,w),h=s(y,u),o=d(M,h);return o}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(e,p,g){p.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(e,p,g){"use strict";var a=e("./colorScale"),t=e("lerp");p.exports=i;function i(s){var m,x,M,v,_,l,y,T,u,w,A;if(s||(s={}),T=(s.nshades||72)-1,y=s.format||"hex",l=s.colormap,l||(l="jet"),typeof l=="string"){if(l=l.toLowerCase(),!a[l])throw Error(l+" not a supported colorscale");_=a[l]}else if(Array.isArray(l))_=l.slice();else throw Error("unsupported colormap option",l);if(_.length>T+1)throw new Error(l+" map requires nshades to be at least size "+_.length);Array.isArray(s.alpha)?s.alpha.length!==2?w=[1,1]:w=s.alpha.slice():typeof s.alpha=="number"?w=[s.alpha,s.alpha]:w=[1,1],m=_.map(function(S){return Math.round(S.index*T)}),w[0]=Math.min(Math.max(w[0],0),1),w[1]=Math.min(Math.max(w[1],0),1);var f=_.map(function(S,R){var z=_[R].index,O=_[R].rgb.slice();return O.length===4&&O[3]>=0&&O[3]<=1||(O[3]=w[0]+(w[1]-w[0])*z),O}),u=[];for(A=0;A<m.length-1;++A){v=m[A+1]-m[A],x=f[A],M=f[A+1];for(var h=0;h<v;h++){var o=h/v;u.push([Math.round(t(x[0],M[0],o)),Math.round(t(x[1],M[1],o)),Math.round(t(x[2],M[2],o)),t(x[3],M[3],o)])}}return u.push(_[_.length-1].rgb.concat(w[1])),y==="hex"?u=u.map(r):y==="rgbaString"?u=u.map(d):y==="float"&&(u=u.map(n)),u}function n(s){return[s[0]/255,s[1]/255,s[2]/255,s[3]]}function r(s){for(var m,x="#",M=0;M<3;++M)m=s[M],m=m.toString(16),x+=("00"+m).substr(m.length);return x}function d(s){return"rgba("+s.join(",")+")"}},{"./colorScale":52,lerp:240}],54:[function(e,p,g){"use strict";p.exports=s;var a=e("robust-orientation"),t=e("signum"),i=e("two-sum"),n=e("robust-product"),r=e("robust-sum");function d(m,x,M){var v=i(m[0],-x[0]),_=i(m[1],-x[1]),l=i(M[0],-x[0]),y=i(M[1],-x[1]),T=r(n(v,l),n(_,y));return T[T.length-1]>=0}function s(m,x,M,v){var _=a(x,M,v);if(_===0){var l=t(a(m,x,M)),y=t(a(m,x,v));if(l===y){if(l===0){var T=d(m,x,M),w=d(m,x,v);return T===w?0:T?1:-1}return 0}else{if(y===0)return l>0||d(m,x,v)?-1:1;if(l===0)return y>0||d(m,x,M)?1:-1}return t(y-l)}var A=a(m,x,M);if(A>0)return _>0&&a(m,x,v)>0?1:-1;if(A<0)return _>0||a(m,x,v)>0?1:-1;var f=a(m,x,v);return f>0||d(m,x,M)?1:-1}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(e,p,g){"use strict";p.exports=function(t){return t<0?-1:t>0?1:0}},{}],56:[function(e,p,g){p.exports=i;var a=Math.min;function t(n,r){return n-r}function i(n,r){var d=n.length,s=n.length-r.length;if(s)return s;switch(d){case 0:return 0;case 1:return n[0]-r[0];case 2:return n[0]+n[1]-r[0]-r[1]||a(n[0],n[1])-a(r[0],r[1]);case 3:var m=n[0]+n[1],x=r[0]+r[1];if(s=m+n[2]-(x+r[2]),s)return s;var M=a(n[0],n[1]),v=a(r[0],r[1]);return a(M,n[2])-a(v,r[2])||a(M+n[2],m)-a(v+r[2],x);case 4:var _=n[0],l=n[1],y=n[2],T=n[3],w=r[0],A=r[1],f=r[2],u=r[3];return _+l+y+T-(w+A+f+u)||a(_,l,y,T)-a(w,A,f,u,w)||a(_+l,_+y,_+T,l+y,l+T,y+T)-a(w+A,w+f,w+u,A+f,A+u,f+u)||a(_+l+y,_+l+T,_+y+T,l+y+T)-a(w+A+f,w+A+u,w+f+u,A+f+u);default:for(var h=n.slice().sort(t),o=r.slice().sort(t),S=0;S<d;++S)if(s=h[S]-o[S],s)return s;return 0}}},{}],57:[function(e,p,g){"use strict";var a=e("compare-cell"),t=e("cell-orientation");p.exports=i;function i(n,r){return a(n,r)||t(n)-t(r)}},{"cell-orientation":47,"compare-cell":56}],58:[function(e,p,g){"use strict";var a=e("./lib/ch1d"),t=e("./lib/ch2d"),i=e("./lib/chnd");p.exports=n;function n(r){var d=r.length;if(d===0)return[];if(d===1)return[[0]];var s=r[0].length;return s===0?[]:s===1?a(r):s===2?t(r):i(r,s)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(e,p,g){"use strict";p.exports=a;function a(t){for(var i=0,n=0,r=1;r<t.length;++r)t[r][0]<t[i][0]&&(i=r),t[r][0]>t[n][0]&&(n=r);return i<n?[[i],[n]]:i>n?[[n],[i]]:[[i]]}},{}],60:[function(e,p,g){"use strict";p.exports=t;var a=e("monotone-convex-hull-2d");function t(i){var n=a(i),r=n.length;if(r<=2)return[];for(var d=new Array(r),s=n[r-1],m=0;m<r;++m){var x=n[m];d[m]=[s,x],s=x}return d}},{"monotone-convex-hull-2d":246}],61:[function(e,p,g){"use strict";p.exports=r;var a=e("incremental-convex-hull"),t=e("affine-hull");function i(d,s){for(var m=d.length,x=new Array(m),M=0;M<s.length;++M)x[M]=d[s[M]];for(var v=s.length,M=0;M<m;++M)s.indexOf(M)<0&&(x[v++]=d[M]);return x}function n(d,s){for(var m=d.length,x=s.length,M=0;M<m;++M)for(var v=d[M],_=0;_<v.length;++_){var l=v[_];if(l<x)v[_]=s[l];else{l=l-x;for(var y=0;y<x;++y)l>=s[y]&&(l+=1);v[_]=l}}return d}function r(d,s){try{return a(d,!0)}catch{var m=t(d);if(m.length<=s)return[];var x=i(d,m),M=a(x,!0);return n(M,m)}}},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(e,p,g){"use strict";function a(i,n,r,d,s,m){var x=6*s*s-6*s,M=3*s*s-4*s+1,v=-6*s*s+6*s,_=3*s*s-2*s;if(i.length){m||(m=new Array(i.length));for(var l=i.length-1;l>=0;--l)m[l]=x*i[l]+M*n[l]+v*r[l]+_*d[l];return m}return x*i+M*n+v*r[l]+_*d}function t(i,n,r,d,s,m){var x=s-1,M=s*s,v=x*x,_=(1+2*s)*v,l=s*v,y=M*(3-2*s),T=M*x;if(i.length){m||(m=new Array(i.length));for(var w=i.length-1;w>=0;--w)m[w]=_*i[w]+l*n[w]+y*r[w]+T*d[w];return m}return _*i+l*n+y*r+T*d}p.exports=t,p.exports.derivative=a},{}],63:[function(e,p,g){"use strict";var a=e("incremental-convex-hull"),t=e("uniq");p.exports=d;function i(s,m){this.point=s,this.index=m}function n(s,m){for(var x=s.point,M=m.point,v=x.length,_=0;_<v;++_){var l=M[_]-x[_];if(l)return l}return 0}function r(s,m,x){if(s===1)return x?[[-1,0]]:[];var M=m.map(function(T,w){return[T[0],w]});M.sort(function(T,w){return T[0]-w[0]});for(var v=new Array(s-1),_=1;_<s;++_){var l=M[_-1],y=M[_];v[_-1]=[l[1],y[1]]}return x&&v.push([-1,v[0][1]],[v[s-1][1],-1]),v}function d(s,m){var x=s.length;if(x===0)return[];var M=s[0].length;if(M<1)return[];if(M===1)return r(x,s,m);for(var v=new Array(x),_=1,l=0;l<x;++l){for(var y=s[l],T=new Array(M+1),w=0,A=0;A<M;++A){var f=y[A];T[A]=f,w+=f*f}T[M]=w,v[l]=new i(T,l),_=Math.max(w,_)}t(v,n),x=v.length;for(var u=new Array(x+M+1),h=new Array(x+M+1),o=(M+1)*(M+1)*_,S=new Array(M+1),l=0;l<=M;++l)S[l]=0;S[M]=o,u[0]=S.slice(),h[0]=-1;for(var l=0;l<=M;++l){var T=S.slice();T[l]=1,u[l+1]=T,h[l+1]=-1}for(var l=0;l<x;++l){var R=v[l];u[l+M+1]=R.point,h[l+M+1]=R.index}var z=a(u,!1);if(m?z=z.filter(function(O){for(var I=0,F=0;F<=M;++F){var D=h[O[F]];if(D<0&&++I>=2)return!1;O[F]=D}return!0}):z=z.filter(function(O){for(var I=0;I<=M;++I){var F=h[O[I]];if(F<0)return!1;O[I]=F}return!0}),M&1)for(var l=0;l<z.length;++l){var R=z[l],T=R[0];R[0]=R[1],R[1]=T}return z}},{"incremental-convex-hull":233,uniq:310}],64:[function(e,p,g){(function(a){(function(){var t=!1;if(typeof Float64Array<"u"){var i=new Float64Array(1),n=new Uint32Array(i.buffer);if(i[0]=1,t=!0,n[1]===1072693248){let T=function(f,u){return n[0]=f,n[1]=u,i[0]},w=function(f){return i[0]=f,n[0]},A=function(f){return i[0]=f,n[1]};var d=T,s=w,m=A;p.exports=function(u){return i[0]=u,[n[0],n[1]]},p.exports.pack=T,p.exports.lo=w,p.exports.hi=A}else if(n[0]===1072693248){let T=function(f,u){return n[1]=f,n[0]=u,i[0]},w=function(f){return i[0]=f,n[1]},A=function(f){return i[0]=f,n[0]};var x=T,M=w,v=A;p.exports=function(u){return i[0]=u,[n[1],n[0]]},p.exports.pack=T,p.exports.lo=w,p.exports.hi=A}else t=!1}if(!t){let T=function(f,u){return r.writeUInt32LE(f,0,!0),r.writeUInt32LE(u,4,!0),r.readDoubleLE(0,!0)},w=function(f){return r.writeDoubleLE(f,0,!0),r.readUInt32LE(0,!0)},A=function(f){return r.writeDoubleLE(f,0,!0),r.readUInt32LE(4,!0)};var _=T,l=w,y=A,r=new a(8);p.exports=function(u){return r.writeDoubleLE(u,0,!0),[r.readUInt32LE(0,!0),r.readUInt32LE(4,!0)]},p.exports.pack=T,p.exports.lo=w,p.exports.hi=A}p.exports.sign=function(T){return p.exports.hi(T)>>>31},p.exports.exponent=function(T){var w=p.exports.hi(T);return(w<<1>>>21)-1023},p.exports.fraction=function(T){var w=p.exports.lo(T),A=p.exports.hi(T),f=A&(1<<20)-1;return A&2146435072&&(f+=1<<20),[w,f]},p.exports.denormalized=function(T){var w=p.exports.hi(T);return!(w&2146435072)}}).call(this)}).call(this,e("buffer").Buffer)},{buffer:3}],65:[function(e,p,g){"use strict";function a(n,r,d){var s=n[d]|0;if(s<=0)return[];var m=new Array(s),x;if(d===n.length-1)for(x=0;x<s;++x)m[x]=r;else for(x=0;x<s;++x)m[x]=a(n,r,d+1);return m}function t(n,r){var d,s;for(d=new Array(n),s=0;s<n;++s)d[s]=r;return d}function i(n,r){switch(typeof r>"u"&&(r=0),typeof n){case"number":if(n>0)return t(n|0,r);break;case"object":if(typeof n.length=="number")return a(n,r,0);break}return[]}p.exports=i},{}],66:[function(e,p,g){"use strict";p.exports=t;var a=e("uniq");function t(i,n){var r=i.length;if(typeof n!="number"){n=0;for(var d=0;d<r;++d){var s=i[d];n=Math.max(n,s[0],s[1])}n=(n|0)+1}n=n|0;for(var m=new Array(n),d=0;d<n;++d)m[d]=[];for(var d=0;d<r;++d){var s=i[d];m[s[0]].push(s[1]),m[s[1]].push(s[0])}for(var x=0;x<n;++x)a(m[x],function(M,v){return M-v});return m}},{uniq:310}],67:[function(e,p,g){"use strict";p.exports=a;function a(t,i,n){var r=i||0,d=n||1;return[[t[12]+t[0],t[13]+t[1],t[14]+t[2],t[15]+t[3]],[t[12]-t[0],t[13]-t[1],t[14]-t[2],t[15]-t[3]],[t[12]+t[4],t[13]+t[5],t[14]+t[6],t[15]+t[7]],[t[12]-t[4],t[13]-t[5],t[14]-t[6],t[15]-t[7]],[r*t[12]+t[8],r*t[13]+t[9],r*t[14]+t[10],r*t[15]+t[11]],[d*t[12]-t[8],d*t[13]-t[9],d*t[14]-t[10],d*t[15]-t[11]]]}},{}],68:[function(e,p,g){"use strict";p.exports=s;var a=e("cubic-hermite"),t=e("binary-search-bounds");function i(m,x,M){return Math.min(x,Math.max(m,M))}function n(m,x,M){this.dimension=m.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var v=0;v<this.dimension;++v)this.bounds[0][v]=-1/0,this.bounds[1][v]=1/0;this._state=m.slice().reverse(),this._velocity=x.slice().reverse(),this._time=[M],this._scratch=[m.slice(),m.slice(),m.slice(),m.slice(),m.slice()]}var r=n.prototype;r.flush=function(m){var x=t.gt(this._time,m)-1;x<=0||(this._time.splice(0,x),this._state.splice(0,x*this.dimension),this._velocity.splice(0,x*this.dimension))},r.curve=function(m){var x=this._time,M=x.length,v=t.le(x,m),_=this._scratch[0],l=this._state,y=this._velocity,T=this.dimension,w=this.bounds;if(v<0)for(var A=T-1,f=0;f<T;++f,--A)_[f]=l[A];else if(v>=M-1)for(var A=l.length-1,u=m-x[M-1],f=0;f<T;++f,--A)_[f]=l[A]+u*y[A];else{for(var A=T*(v+1)-1,h=x[v],o=x[v+1],S=o-h||1,R=this._scratch[1],z=this._scratch[2],O=this._scratch[3],I=this._scratch[4],F=!0,f=0;f<T;++f,--A)R[f]=l[A],O[f]=y[A]*S,z[f]=l[A+T],I[f]=y[A+T]*S,F=F&&R[f]===z[f]&&O[f]===I[f]&&O[f]===0;if(F)for(var f=0;f<T;++f)_[f]=R[f];else a(R,O,z,I,(m-h)/S,_)}for(var D=w[0],B=w[1],f=0;f<T;++f)_[f]=i(D[f],B[f],_[f]);return _},r.dcurve=function(m){var x=this._time,M=x.length,v=t.le(x,m),_=this._scratch[0],l=this._state,y=this._velocity,T=this.dimension;if(v>=M-1)for(var w=l.length-1,A=m-x[M-1],f=0;f<T;++f,--w)_[f]=y[w];else{for(var w=T*(v+1)-1,u=x[v],h=x[v+1],o=h-u||1,S=this._scratch[1],R=this._scratch[2],z=this._scratch[3],O=this._scratch[4],I=!0,f=0;f<T;++f,--w)S[f]=l[w],z[f]=y[w]*o,R[f]=l[w+T],O[f]=y[w+T]*o,I=I&&S[f]===R[f]&&z[f]===O[f]&&z[f]===0;if(I)for(var f=0;f<T;++f)_[f]=0;else{a.derivative(S,z,R,O,(m-u)/o,_);for(var f=0;f<T;++f)_[f]/=o}}return _},r.lastT=function(){var m=this._time;return m[m.length-1]},r.stable=function(){for(var m=this._velocity,x=m.length,M=this.dimension-1;M>=0;--M)if(m[--x])return!1;return!0},r.jump=function(m){var x=this.lastT(),M=this.dimension;if(!(m<x||arguments.length!==M+1)){var v=this._state,_=this._velocity,l=v.length-this.dimension,y=this.bounds,T=y[0],w=y[1];this._time.push(x,m);for(var A=0;A<2;++A)for(var f=0;f<M;++f)v.push(v[l++]),_.push(0);this._time.push(m);for(var f=M;f>0;--f)v.push(i(T[f-1],w[f-1],arguments[f])),_.push(0)}},r.push=function(m){var x=this.lastT(),M=this.dimension;if(!(m<x||arguments.length!==M+1)){var v=this._state,_=this._velocity,l=v.length-this.dimension,y=m-x,T=this.bounds,w=T[0],A=T[1],f=y>1e-6?1/y:0;this._time.push(m);for(var u=M;u>0;--u){var h=i(w[u-1],A[u-1],arguments[u]);v.push(h),_.push((h-v[l++])*f)}}},r.set=function(m){var x=this.dimension;if(!(m<this.lastT()||arguments.length!==x+1)){var M=this._state,v=this._velocity,_=this.bounds,l=_[0],y=_[1];this._time.push(m);for(var T=x;T>0;--T)M.push(i(l[T-1],y[T-1],arguments[T])),v.push(0)}},r.move=function(m){var x=this.lastT(),M=this.dimension;if(!(m<=x||arguments.length!==M+1)){var v=this._state,_=this._velocity,l=v.length-this.dimension,y=this.bounds,T=y[0],w=y[1],A=m-x,f=A>1e-6?1/A:0;this._time.push(m);for(var u=M;u>0;--u){var h=arguments[u];v.push(i(T[u-1],w[u-1],v[l++]+h)),_.push(h*f)}}},r.idle=function(m){var x=this.lastT();if(!(m<x)){var M=this.dimension,v=this._state,_=this._velocity,l=v.length-M,y=this.bounds,T=y[0],w=y[1],A=m-x;this._time.push(m);for(var f=M-1;f>=0;--f)v.push(i(T[f],w[f],v[l]+A*_[l])),_.push(0),l+=1}};function d(m){for(var x=new Array(m),M=0;M<m;++M)x[M]=0;return x}function s(m,x,M){switch(arguments.length){case 0:return new n([0],[0],0);case 1:if(typeof m=="number"){var v=d(m);return new n(v,v,0)}else return new n(m,d(m.length),0);case 2:if(typeof x=="number"){var v=d(m.length);return new n(m,v,+x)}else M=0;case 3:if(m.length!==x.length)throw new Error("state and velocity lengths must match");return new n(m,x,M)}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(e,p,g){"use strict";p.exports=A;var a=0,t=1;function i(f,u,h,o,S,R){this._color=f,this.key=u,this.value=h,this.left=o,this.right=S,this._count=R}function n(f){return new i(f._color,f.key,f.value,f.left,f.right,f._count)}function r(f,u){return new i(f,u.key,u.value,u.left,u.right,u._count)}function d(f){f._count=1+(f.left?f.left._count:0)+(f.right?f.right._count:0)}function s(f,u){this._compare=f,this.root=u}var m=s.prototype;Object.defineProperty(m,"keys",{get:function(){var f=[];return this.forEach(function(u,h){f.push(u)}),f}}),Object.defineProperty(m,"values",{get:function(){var f=[];return this.forEach(function(u,h){f.push(h)}),f}}),Object.defineProperty(m,"length",{get:function(){return this.root?this.root._count:0}}),m.insert=function(f,u){for(var h=this._compare,o=this.root,S=[],R=[];o;){var z=h(f,o.key);S.push(o),R.push(z),z<=0?o=o.left:o=o.right}S.push(new i(a,f,u,null,null,1));for(var O=S.length-2;O>=0;--O){var o=S[O];R[O]<=0?S[O]=new i(o._color,o.key,o.value,S[O+1],o.right,o._count+1):S[O]=new i(o._color,o.key,o.value,o.left,S[O+1],o._count+1)}for(var O=S.length-1;O>1;--O){var I=S[O-1],o=S[O];if(I._color===t||o._color===t)break;var F=S[O-2];if(F.left===I)if(I.left===o){var D=F.right;if(D&&D._color===a)I._color=t,F.right=r(t,D),F._color=a,O-=1;else{if(F._color=a,F.left=I.right,I._color=t,I.right=F,S[O-2]=I,S[O-1]=o,d(F),d(I),O>=3){var B=S[O-3];B.left===F?B.left=I:B.right=I}break}}else{var D=F.right;if(D&&D._color===a)I._color=t,F.right=r(t,D),F._color=a,O-=1;else{if(I.right=o.left,F._color=a,F.left=o.right,o._color=t,o.left=I,o.right=F,S[O-2]=o,S[O-1]=I,d(F),d(I),d(o),O>=3){var B=S[O-3];B.left===F?B.left=o:B.right=o}break}}else if(I.right===o){var D=F.left;if(D&&D._color===a)I._color=t,F.left=r(t,D),F._color=a,O-=1;else{if(F._color=a,F.right=I.left,I._color=t,I.left=F,S[O-2]=I,S[O-1]=o,d(F),d(I),O>=3){var B=S[O-3];B.right===F?B.right=I:B.left=I}break}}else{var D=F.left;if(D&&D._color===a)I._color=t,F.left=r(t,D),F._color=a,O-=1;else{if(I.left=o.right,F._color=a,F.right=o.left,o._color=t,o.right=I,o.left=F,S[O-2]=o,S[O-1]=I,d(F),d(I),d(o),O>=3){var B=S[O-3];B.right===F?B.right=o:B.left=o}break}}}return S[0]._color=t,new s(h,S[0])};function x(f,u){if(u.left){var h=x(f,u.left);if(h)return h}var h=f(u.key,u.value);if(h)return h;if(u.right)return x(f,u.right)}function M(f,u,h,o){var S=u(f,o.key);if(S<=0){if(o.left){var R=M(f,u,h,o.left);if(R)return R}var R=h(o.key,o.value);if(R)return R}if(o.right)return M(f,u,h,o.right)}function v(f,u,h,o,S){var R=h(f,S.key),z=h(u,S.key),O;if(R<=0&&(S.left&&(O=v(f,u,h,o,S.left),O)||z>0&&(O=o(S.key,S.value),O)))return O;if(z>0&&S.right)return v(f,u,h,o,S.right)}m.forEach=function(u,h,o){if(!!this.root)switch(arguments.length){case 1:return x(u,this.root);case 2:return M(h,this._compare,u,this.root);case 3:return this._compare(h,o)>=0?void 0:v(h,o,this._compare,u,this.root)}},Object.defineProperty(m,"begin",{get:function(){for(var f=[],u=this.root;u;)f.push(u),u=u.left;return new _(this,f)}}),Object.defineProperty(m,"end",{get:function(){for(var f=[],u=this.root;u;)f.push(u),u=u.right;return new _(this,f)}}),m.at=function(f){if(f<0)return new _(this,[]);for(var u=this.root,h=[];;){if(h.push(u),u.left){if(f<u.left._count){u=u.left;continue}f-=u.left._count}if(!f)return new _(this,h);if(f-=1,u.right){if(f>=u.right._count)break;u=u.right}else break}return new _(this,[])},m.ge=function(f){for(var u=this._compare,h=this.root,o=[],S=0;h;){var R=u(f,h.key);o.push(h),R<=0&&(S=o.length),R<=0?h=h.left:h=h.right}return o.length=S,new _(this,o)},m.gt=function(f){for(var u=this._compare,h=this.root,o=[],S=0;h;){var R=u(f,h.key);o.push(h),R<0&&(S=o.length),R<0?h=h.left:h=h.right}return o.length=S,new _(this,o)},m.lt=function(f){for(var u=this._compare,h=this.root,o=[],S=0;h;){var R=u(f,h.key);o.push(h),R>0&&(S=o.length),R<=0?h=h.left:h=h.right}return o.length=S,new _(this,o)},m.le=function(f){for(var u=this._compare,h=this.root,o=[],S=0;h;){var R=u(f,h.key);o.push(h),R>=0&&(S=o.length),R<0?h=h.left:h=h.right}return o.length=S,new _(this,o)},m.find=function(f){for(var u=this._compare,h=this.root,o=[];h;){var S=u(f,h.key);if(o.push(h),S===0)return new _(this,o);S<=0?h=h.left:h=h.right}return new _(this,[])},m.remove=function(f){var u=this.find(f);return u?u.remove():this},m.get=function(f){for(var u=this._compare,h=this.root;h;){var o=u(f,h.key);if(o===0)return h.value;o<=0?h=h.left:h=h.right}};function _(f,u){this.tree=f,this._stack=u}var l=_.prototype;Object.defineProperty(l,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(l,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),l.clone=function(){return new _(this.tree,this._stack.slice())};function y(f,u){f.key=u.key,f.value=u.value,f.left=u.left,f.right=u.right,f._color=u._color,f._count=u._count}function T(f){for(var u,h,o,S,R=f.length-1;R>=0;--R){if(u=f[R],R===0){u._color=t;return}if(h=f[R-1],h.left===u){if(o=h.right,o.right&&o.right._color===a){if(o=h.right=n(o),S=o.right=n(o.right),h.right=o.left,o.left=h,o.right=S,o._color=h._color,u._color=t,h._color=t,S._color=t,d(h),d(o),R>1){var z=f[R-2];z.left===h?z.left=o:z.right=o}f[R-1]=o;return}else if(o.left&&o.left._color===a){if(o=h.right=n(o),S=o.left=n(o.left),h.right=S.left,o.left=S.right,S.left=h,S.right=o,S._color=h._color,h._color=t,o._color=t,u._color=t,d(h),d(o),d(S),R>1){var z=f[R-2];z.left===h?z.left=S:z.right=S}f[R-1]=S;return}if(o._color===t)if(h._color===a){h._color=t,h.right=r(a,o);return}else{h.right=r(a,o);continue}else{if(o=n(o),h.right=o.left,o.left=h,o._color=h._color,h._color=a,d(h),d(o),R>1){var z=f[R-2];z.left===h?z.left=o:z.right=o}f[R-1]=o,f[R]=h,R+1<f.length?f[R+1]=u:f.push(u),R=R+2}}else{if(o=h.left,o.left&&o.left._color===a){if(o=h.left=n(o),S=o.left=n(o.left),h.left=o.right,o.right=h,o.left=S,o._color=h._color,u._color=t,h._color=t,S._color=t,d(h),d(o),R>1){var z=f[R-2];z.right===h?z.right=o:z.left=o}f[R-1]=o;return}else if(o.right&&o.right._color===a){if(o=h.left=n(o),S=o.right=n(o.right),h.left=S.right,o.right=S.left,S.right=h,S.left=o,S._color=h._color,h._color=t,o._color=t,u._color=t,d(h),d(o),d(S),R>1){var z=f[R-2];z.right===h?z.right=S:z.left=S}f[R-1]=S;return}if(o._color===t)if(h._color===a){h._color=t,h.left=r(a,o);return}else{h.left=r(a,o);continue}else{if(o=n(o),h.left=o.right,o.right=h,o._color=h._color,h._color=a,d(h),d(o),R>1){var z=f[R-2];z.right===h?z.right=o:z.left=o}f[R-1]=o,f[R]=h,R+1<f.length?f[R+1]=u:f.push(u),R=R+2}}}}l.remove=function(){var f=this._stack;if(f.length===0)return this.tree;var u=new Array(f.length),h=f[f.length-1];u[u.length-1]=new i(h._color,h.key,h.value,h.left,h.right,h._count);for(var o=f.length-2;o>=0;--o){var h=f[o];h.left===f[o+1]?u[o]=new i(h._color,h.key,h.value,u[o+1],h.right,h._count):u[o]=new i(h._color,h.key,h.value,h.left,u[o+1],h._count)}if(h=u[u.length-1],h.left&&h.right){var S=u.length;for(h=h.left;h.right;)u.push(h),h=h.right;var R=u[S-1];u.push(new i(h._color,R.key,R.value,h.left,h.right,h._count)),u[S-1].key=h.key,u[S-1].value=h.value;for(var o=u.length-2;o>=S;--o)h=u[o],u[o]=new i(h._color,h.key,h.value,h.left,u[o+1],h._count);u[S-1].left=u[S]}if(h=u[u.length-1],h._color===a){var z=u[u.length-2];z.left===h?z.left=null:z.right===h&&(z.right=null),u.pop();for(var o=0;o<u.length;++o)u[o]._count--;return new s(this.tree._compare,u[0])}else if(h.left||h.right){h.left?y(h,h.left):h.right&&y(h,h.right),h._color=t;for(var o=0;o<u.length-1;++o)u[o]._count--;return new s(this.tree._compare,u[0])}else{if(u.length===1)return new s(this.tree._compare,null);for(var o=0;o<u.length;++o)u[o]._count--;var O=u[u.length-2];T(u),O.left===h?O.left=null:O.right=null}return new s(this.tree._compare,u[0])},Object.defineProperty(l,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(l,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(l,"index",{get:function(){var f=0,u=this._stack;if(u.length===0){var h=this.tree.root;return h?h._count:0}else u[u.length-1].left&&(f=u[u.length-1].left._count);for(var o=u.length-2;o>=0;--o)u[o+1]===u[o].right&&(++f,u[o].left&&(f+=u[o].left._count));return f},enumerable:!0}),l.next=function(){var f=this._stack;if(f.length!==0){var u=f[f.length-1];if(u.right)for(u=u.right;u;)f.push(u),u=u.left;else for(f.pop();f.length>0&&f[f.length-1].right===u;)u=f[f.length-1],f.pop()}},Object.defineProperty(l,"hasNext",{get:function(){var f=this._stack;if(f.length===0)return!1;if(f[f.length-1].right)return!0;for(var u=f.length-1;u>0;--u)if(f[u-1].left===f[u])return!0;return!1}}),l.update=function(f){var u=this._stack;if(u.length===0)throw new Error("Can't update empty node!");var h=new Array(u.length),o=u[u.length-1];h[h.length-1]=new i(o._color,o.key,f,o.left,o.right,o._count);for(var S=u.length-2;S>=0;--S)o=u[S],o.left===u[S+1]?h[S]=new i(o._color,o.key,o.value,h[S+1],o.right,o._count):h[S]=new i(o._color,o.key,o.value,o.left,h[S+1],o._count);return new s(this.tree._compare,h[0])},l.prev=function(){var f=this._stack;if(f.length!==0){var u=f[f.length-1];if(u.left)for(u=u.left;u;)f.push(u),u=u.right;else for(f.pop();f.length>0&&f[f.length-1].left===u;)u=f[f.length-1],f.pop()}},Object.defineProperty(l,"hasPrev",{get:function(){var f=this._stack;if(f.length===0)return!1;if(f[f.length-1].left)return!0;for(var u=f.length-1;u>0;--u)if(f[u-1].right===f[u])return!0;return!1}});function w(f,u){return f<u?-1:f>u?1:0}function A(f){return new s(f||w,null)}},{}],70:[function(e,p,g){"use strict";p.exports=u;var a=e("./lib/text.js"),t=e("./lib/lines.js"),i=e("./lib/background.js"),n=e("./lib/cube.js"),r=e("./lib/ticks.js"),d=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function s(h,o){return h[0]=o[0],h[1]=o[1],h[2]=o[2],h}function m(h){this.gl=h,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=i(h)}var x=m.prototype;x.update=function(h){h=h||{};function o(se,q,K){if(K in h){var G=h[K],Q=this[K],V;(se?Array.isArray(G)&&Array.isArray(G[0]):Array.isArray(G))?this[K]=V=[q(G[0]),q(G[1]),q(G[2])]:this[K]=V=[q(G),q(G),q(G)];for(var H=0;H<3;++H)if(V[H]!==Q[H])return!0}return!1}var S=o.bind(this,!1,Number),R=o.bind(this,!1,Boolean),z=o.bind(this,!1,String),O=o.bind(this,!0,function(se){if(Array.isArray(se)){if(se.length===3)return[+se[0],+se[1],+se[2],1];if(se.length===4)return[+se[0],+se[1],+se[2],+se[3]]}return[0,0,0,1]}),I,F=!1,D=!1;if("bounds"in h){var B=h.bounds;e:for(var U=0;U<2;++U)for(var X=0;X<3;++X)B[U][X]!==this.bounds[U][X]&&(D=!0),this.bounds[U][X]=B[U][X]}if("ticks"in h){I=h.ticks,F=!0,this.autoTicks=!1;for(var U=0;U<3;++U)this.tickSpacing[U]=0}else S("tickSpacing")&&(this.autoTicks=!0,D=!0);if(this._firstInit&&("ticks"in h||"tickSpacing"in h||(this.autoTicks=!0),D=!0,F=!0,this._firstInit=!1),D&&this.autoTicks&&(I=r.create(this.bounds,this.tickSpacing),F=!0),F){for(var U=0;U<3;++U)I[U].sort(function(q,K){return q.x-K.x});r.equal(I,this.ticks)?F=!1:this.ticks=I}R("tickEnable"),z("tickFont")&&(F=!0),S("tickSize"),S("tickAngle"),S("tickPad"),O("tickColor");var oe=z("labels");z("labelFont")&&(oe=!0),R("labelEnable"),S("labelSize"),S("labelPad"),O("labelColor"),R("lineEnable"),R("lineMirror"),S("lineWidth"),O("lineColor"),R("lineTickEnable"),R("lineTickMirror"),S("lineTickLength"),S("lineTickWidth"),O("lineTickColor"),R("gridEnable"),S("gridWidth"),O("gridColor"),R("zeroEnable"),O("zeroLineColor"),S("zeroLineWidth"),R("backgroundEnable"),O("backgroundColor"),this._text?this._text&&(oe||F)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=a(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&F&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=t(this.gl,this.bounds,this.ticks))};function M(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}var v=[new M,new M,new M];function _(h,o,S,R,z){for(var O=h.primalOffset,I=h.primalMinor,F=h.mirrorOffset,D=h.mirrorMinor,B=R[o],U=0;U<3;++U)if(o!==U){var X=O,oe=F,se=I,q=D;B&1<<U&&(X=F,oe=O,se=D,q=I),X[U]=S[0][U],oe[U]=S[1][U],z[U]>0?(se[U]=-1,q[U]=0):(se[U]=0,q[U]=1)}}var l=[0,0,0],y={model:d,view:d,projection:d,_ortho:!1};x.isOpaque=function(){return!0},x.isTransparent=function(){return!1},x.drawTransparent=function(h){};var T=0,w=[0,0,0],A=[0,0,0],f=[0,0,0];x.draw=function(h){h=h||y;for(var Q=this.gl,o=h.model||d,S=h.view||d,R=h.projection||d,z=this.bounds,O=h._ortho||!1,I=n(o,S,R,z,O),F=I.cubeEdges,D=I.axis,B=S[12],U=S[13],X=S[14],oe=S[15],se=O?2:1,q=se*this.pixelRatio*(R[3]*B+R[7]*U+R[11]*X+R[15]*oe)/Q.drawingBufferHeight,K=0;K<3;++K)this.lastCubeProps.cubeEdges[K]=F[K],this.lastCubeProps.axis[K]=D[K];for(var G=v,K=0;K<3;++K)_(v[K],K,this.bounds,F,D);for(var Q=this.gl,V=l,K=0;K<3;++K)this.backgroundEnable[K]?V[K]=D[K]:V[K]=0;this._background.draw(o,S,R,z,V,this.backgroundColor),this._lines.bind(o,S,R,this);for(var K=0;K<3;++K){var H=[0,0,0];D[K]>0?H[K]=z[1][K]:H[K]=z[0][K];for(var ee=0;ee<2;++ee){var J=(K+1+ee)%3,W=(K+1+(ee^1))%3;this.gridEnable[J]&&this._lines.drawGrid(J,W,this.bounds,H,this.gridColor[J],this.gridWidth[J]*this.pixelRatio)}for(var ee=0;ee<2;++ee){var J=(K+1+ee)%3,W=(K+1+(ee^1))%3;this.zeroEnable[W]&&Math.min(z[0][W],z[1][W])<=0&&Math.max(z[0][W],z[1][W])>=0&&this._lines.drawZero(J,W,this.bounds,H,this.zeroLineColor[W],this.zeroLineWidth[W]*this.pixelRatio)}}for(var K=0;K<3;++K){this.lineEnable[K]&&this._lines.drawAxisLine(K,this.bounds,G[K].primalOffset,this.lineColor[K],this.lineWidth[K]*this.pixelRatio),this.lineMirror[K]&&this._lines.drawAxisLine(K,this.bounds,G[K].mirrorOffset,this.lineColor[K],this.lineWidth[K]*this.pixelRatio);for(var re=s(w,G[K].primalMinor),j=s(A,G[K].mirrorMinor),Z=this.lineTickLength,ee=0;ee<3;++ee){var ne=q/o[5*ee];re[ee]*=Z[ee]*ne,j[ee]*=Z[ee]*ne}this.lineTickEnable[K]&&this._lines.drawAxisTicks(K,G[K].primalOffset,re,this.lineTickColor[K],this.lineTickWidth[K]*this.pixelRatio),this.lineTickMirror[K]&&this._lines.drawAxisTicks(K,G[K].mirrorOffset,j,this.lineTickColor[K],this.lineTickWidth[K]*this.pixelRatio)}this._lines.unbind(),this._text.bind(o,S,R,this.pixelRatio);var le,ge=.5,pe,xe;function Ee(ye){xe=[0,0,0],xe[ye]=1}function Te(ye,ke,Oe){var Qe=(ye+1)%3,Ve=(ye+2)%3,Ue=ke[Qe],Ie=ke[Ve],at=Oe[Qe],pt=Oe[Ve];if(Ue>0&&pt>0){Ee(Qe);return}else if(Ue>0&&pt<0){Ee(Qe);return}else if(Ue<0&&pt>0){Ee(Qe);return}else if(Ue<0&&pt<0){Ee(Qe);return}else if(Ie>0&&at>0){Ee(Ve);return}else if(Ie>0&&at<0){Ee(Ve);return}else if(Ie<0&&at>0){Ee(Ve);return}else if(Ie<0&&at<0){Ee(Ve);return}}for(var K=0;K<3;++K){for(var de=G[K].primalMinor,be=G[K].mirrorMinor,Le=s(f,G[K].primalOffset),ee=0;ee<3;++ee)this.lineTickEnable[K]&&(Le[ee]+=q*de[ee]*Math.max(this.lineTickLength[ee],0)/o[5*ee]);var De=[0,0,0];if(De[K]=1,this.tickEnable[K]){this.tickAngle[K]===-3600?(this.tickAngle[K]=0,this.tickAlign[K]="auto"):this.tickAlign[K]=-1,pe=1,le=[this.tickAlign[K],ge,pe],le[0]==="auto"?le[0]=T:le[0]=parseInt(""+le[0]),xe=[0,0,0],Te(K,de,be);for(var ee=0;ee<3;++ee)Le[ee]+=q*de[ee]*this.tickPad[ee]/o[5*ee];this._text.drawTicks(K,this.tickSize[K],this.tickAngle[K],Le,this.tickColor[K],De,xe,le)}if(this.labelEnable[K]){pe=0,xe=[0,0,0],this.labels[K].length>4&&(Ee(K),pe=1),le=[this.labelAlign[K],ge,pe],le[0]==="auto"?le[0]=T:le[0]=parseInt(""+le[0]);for(var ee=0;ee<3;++ee)Le[ee]+=q*de[ee]*this.labelPad[ee]/o[5*ee];Le[K]+=.5*(z[0][K]+z[1][K]),this._text.drawLabel(K,this.labelSize[K],this.labelAngle[K],Le,this.labelColor[K],[0,0,0],xe,le)}}this._text.unbind()},x.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null};function u(h,o){var S=new m(h);return S.update(o),S}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(e,p,g){"use strict";p.exports=d;var a=e("gl-buffer"),t=e("gl-vao"),i=e("./shaders").bg;function n(s,m,x,M){this.gl=s,this.buffer=m,this.vao=x,this.shader=M}var r=n.prototype;r.draw=function(s,m,x,M,v,_){for(var l=!1,y=0;y<3;++y)l=l||v[y];if(!!l){var T=this.gl;T.enable(T.POLYGON_OFFSET_FILL),T.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:s,view:m,projection:x,bounds:M,enable:v,colors:_},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),T.disable(T.POLYGON_OFFSET_FILL)}},r.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function d(s){for(var m=[],x=[],M=0,v=0;v<3;++v)for(var _=(v+1)%3,l=(v+2)%3,y=[0,0,0],T=[0,0,0],w=-1;w<=1;w+=2){x.push(M,M+2,M+1,M+1,M+2,M+3),y[v]=w,T[v]=w;for(var A=-1;A<=1;A+=2){y[_]=A;for(var f=-1;f<=1;f+=2)y[l]=f,m.push(y[0],y[1],y[2],T[0],T[1],T[2]),M+=1}var u=_;_=l,l=u}var h=a(s,new Float32Array(m)),o=a(s,new Uint16Array(x),s.ELEMENT_ARRAY_BUFFER),S=t(s,[{buffer:h,type:s.FLOAT,size:3,offset:0,stride:24},{buffer:h,type:s.FLOAT,size:3,offset:12,stride:24}],o),R=i(s);return R.attributes.position.location=0,R.attributes.normal.location=1,new n(s,h,S,R)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(e,p,g){"use strict";p.exports=w;var a=e("bit-twiddle"),t=e("gl-mat4/multiply"),i=e("split-polygon"),n=e("robust-orientation"),r=new Array(16),d=new Array(8),s=new Array(8),m=new Array(3),x=[0,0,0];(function(){for(var A=0;A<8;++A)d[A]=[1,1,1,1],s[A]=[1,1,1]})();function M(A,f,u){for(var h=0;h<4;++h){A[h]=u[12+h];for(var o=0;o<3;++o)A[h]+=f[o]*u[4*o+h]}}var v=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function _(A){for(var f=0;f<v.length;++f)if(A=i.positive(A,v[f]),A.length<3)return 0;for(var u=A[0],h=u[0]/u[3],o=u[1]/u[3],S=0,f=1;f+1<A.length;++f){var R=A[f],z=A[f+1],O=R[0]/R[3],I=R[1]/R[3],F=z[0]/z[3],D=z[1]/z[3],B=O-h,U=I-o,X=F-h,oe=D-o;S+=Math.abs(B*oe-U*X)}return S}var l=[1,1,1],y=[0,0,0],T={cubeEdges:l,axis:y};function w(A,f,u,h,o){t(r,f,A),t(r,u,r);for(var S=0,R=0;R<2;++R){m[2]=h[R][2];for(var z=0;z<2;++z){m[1]=h[z][1];for(var O=0;O<2;++O)m[0]=h[O][0],M(d[S],m,r),S+=1}}for(var I=-1,R=0;R<8;++R){for(var F=d[R][3],D=0;D<3;++D)s[R][D]=d[R][D]/F;o&&(s[R][2]*=-1),F<0&&(I<0||s[R][2]<s[I][2])&&(I=R)}if(I<0){I=0;for(var B=0;B<3;++B){for(var U=(B+2)%3,X=(B+1)%3,oe=-1,se=-1,q=0;q<2;++q){var K=q<<B,G=K+(q<<U)+(1-q<<X),Q=K+(1-q<<U)+(q<<X);n(s[K],s[G],s[Q],x)<0||(q?oe=1:se=1)}if(oe<0||se<0){se>oe&&(I|=1<<B);continue}for(var q=0;q<2;++q){var K=q<<B,G=K+(q<<U)+(1-q<<X),Q=K+(1-q<<U)+(q<<X),V=_([d[K],d[G],d[Q],d[K+(1<<U)+(1<<X)]]);q?oe=V:se=V}if(se>oe){I|=1<<B;continue}}}for(var H=7^I,ee=-1,R=0;R<8;++R)R===I||R===H||(ee<0||s[ee][1]>s[R][1])&&(ee=R);for(var J=-1,R=0;R<3;++R){var W=ee^1<<R;if(!(W===I||W===H)){J<0&&(J=W);var X=s[W];X[0]<s[J][0]&&(J=W)}}for(var re=-1,R=0;R<3;++R){var W=ee^1<<R;if(!(W===I||W===H||W===J)){re<0&&(re=W);var X=s[W];X[0]>s[re][0]&&(re=W)}}var j=l;j[0]=j[1]=j[2]=0,j[a.log2(J^ee)]=ee&J,j[a.log2(ee^re)]=ee&re;var Z=re^7;Z===I||Z===H?(Z=J^7,j[a.log2(re^Z)]=Z&re):j[a.log2(J^Z)]=Z&J;for(var ne=y,le=I,B=0;B<3;++B)le&1<<B?ne[B]=-1:ne[B]=1;return T}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(e,p,g){"use strict";p.exports=l;var a=e("gl-buffer"),t=e("gl-vao"),i=e("./shaders").line,n=[0,0,0],r=[0,0,0],d=[0,0,0],s=[0,0,0],m=[1,1];function x(y){return y[0]=y[1]=y[2]=0,y}function M(y,T){return y[0]=T[0],y[1]=T[1],y[2]=T[2],y}function v(y,T,w,A,f,u,h,o){this.gl=y,this.vertBuffer=T,this.vao=w,this.shader=A,this.tickCount=f,this.tickOffset=u,this.gridCount=h,this.gridOffset=o}var _=v.prototype;_.bind=function(y,T,w){this.shader.bind(),this.shader.uniforms.model=y,this.shader.uniforms.view=T,this.shader.uniforms.projection=w,m[0]=this.gl.drawingBufferWidth,m[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=m,this.vao.bind()},_.unbind=function(){this.vao.unbind()},_.drawAxisLine=function(y,T,w,A,f){var u=x(r);this.shader.uniforms.majorAxis=r,u[y]=T[1][y]-T[0][y],this.shader.uniforms.minorAxis=u;var h=M(s,w);h[y]+=T[0][y],this.shader.uniforms.offset=h,this.shader.uniforms.lineWidth=f,this.shader.uniforms.color=A;var o=x(d);o[(y+2)%3]=1,this.shader.uniforms.screenAxis=o,this.vao.draw(this.gl.TRIANGLES,6);var o=x(d);o[(y+1)%3]=1,this.shader.uniforms.screenAxis=o,this.vao.draw(this.gl.TRIANGLES,6)},_.drawAxisTicks=function(y,T,w,A,f){if(!!this.tickCount[y]){var u=x(n);u[y]=1,this.shader.uniforms.majorAxis=u,this.shader.uniforms.offset=T,this.shader.uniforms.minorAxis=w,this.shader.uniforms.color=A,this.shader.uniforms.lineWidth=f;var h=x(d);h[y]=1,this.shader.uniforms.screenAxis=h,this.vao.draw(this.gl.TRIANGLES,this.tickCount[y],this.tickOffset[y])}},_.drawGrid=function(y,T,w,A,f,u){if(!!this.gridCount[y]){var h=x(r);h[T]=w[1][T]-w[0][T],this.shader.uniforms.minorAxis=h;var o=M(s,A);o[T]+=w[0][T],this.shader.uniforms.offset=o;var S=x(n);S[y]=1,this.shader.uniforms.majorAxis=S;var R=x(d);R[y]=1,this.shader.uniforms.screenAxis=R,this.shader.uniforms.lineWidth=u,this.shader.uniforms.color=f,this.vao.draw(this.gl.TRIANGLES,this.gridCount[y],this.gridOffset[y])}},_.drawZero=function(y,T,w,A,f,u){var h=x(r);this.shader.uniforms.majorAxis=h,h[y]=w[1][y]-w[0][y],this.shader.uniforms.minorAxis=h;var o=M(s,A);o[y]+=w[0][y],this.shader.uniforms.offset=o;var S=x(d);S[T]=1,this.shader.uniforms.screenAxis=S,this.shader.uniforms.lineWidth=u,this.shader.uniforms.color=f,this.vao.draw(this.gl.TRIANGLES,6)},_.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()};function l(y,T,w){var A=[],f=[0,0,0],u=[0,0,0],h=[0,0,0],o=[0,0,0];A.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var S=0;S<3;++S){for(var O=A.length/3|0,R=0;R<w[S].length;++R){var z=+w[S][R].x;A.push(z,0,1,z,1,1,z,0,-1,z,0,-1,z,1,1,z,1,-1)}var F=A.length/3|0;f[S]=O,u[S]=F-O;for(var O=A.length/3|0,I=0;I<w[S].length;++I){var z=+w[S][I].x;A.push(z,0,1,z,1,1,z,0,-1,z,0,-1,z,1,1,z,1,-1)}var F=A.length/3|0;h[S]=O,o[S]=F-O}var D=a(y,new Float32Array(A)),B=t(y,[{buffer:D,type:y.FLOAT,size:3,stride:0,offset:0}]),U=i(y);return U.attributes.position.location=0,new v(y,D,B,U,u,f,o,h)}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(e,p,g){"use strict";var a=e("glslify"),t=e("gl-shader"),i=a([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),n=a([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);g.line=function(x){return t(x,i,n,null,[{name:"position",type:"vec3"}])};var r=a([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),d=a([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);g.text=function(x){return t(x,r,d,null,[{name:"position",type:"vec3"}])};var s=a([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),m=a([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);g.bg=function(x){return t(x,s,m,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(e,p,g){(function(a){(function(){"use strict";p.exports=l;var t=e("gl-buffer"),i=e("gl-vao"),n=e("vectorize-text"),r=e("./shaders").text,d=window||a.global||{},s=d.__TEXT_CACHE||{};d.__TEXT_CACHE={};var m=3;function x(y,T,w,A){this.gl=y,this.shader=T,this.buffer=w,this.vao=A,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var M=x.prototype,v=[0,0];M.bind=function(y,T,w,A){this.vao.bind(),this.shader.bind();var f=this.shader.uniforms;f.model=y,f.view=T,f.projection=w,f.pixelScale=A,v[0]=this.gl.drawingBufferWidth,v[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=v},M.unbind=function(){this.vao.unbind()},M.update=function(y,T,w,A,f){var u=[];function h(B,U,X,oe,se,q){var K=s[X];K||(K=s[X]={});var G=K[U];G||(G=K[U]=_(U,{triangles:!0,font:X,textAlign:"center",textBaseline:"middle",lineSpacing:se,styletags:q}));for(var Q=(oe||12)/12,V=G.positions,H=G.cells,ee=0,J=H.length;ee<J;++ee)for(var W=H[ee],re=2;re>=0;--re){var j=V[W[re]];u.push(Q*j[0],-Q*j[1],B)}}for(var o=[0,0,0],S=[0,0,0],R=[0,0,0],z=[0,0,0],O=1.25,I={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},F=0;F<3;++F){R[F]=u.length/m|0,h(.5*(y[0][F]+y[1][F]),T[F],w[F],12,O,I),z[F]=(u.length/m|0)-R[F],o[F]=u.length/m|0;for(var D=0;D<A[F].length;++D)!A[F][D].text||h(A[F][D].x,A[F][D].text,A[F][D].font||f,A[F][D].fontSize||12,O,I);S[F]=(u.length/m|0)-o[F]}this.buffer.update(u),this.tickOffset=o,this.tickCount=S,this.labelOffset=R,this.labelCount=z},M.drawTicks=function(y,T,w,A,f,u,h,o){!this.tickCount[y]||(this.shader.uniforms.axis=u,this.shader.uniforms.color=f,this.shader.uniforms.angle=w,this.shader.uniforms.scale=T,this.shader.uniforms.offset=A,this.shader.uniforms.alignDir=h,this.shader.uniforms.alignOpt=o,this.vao.draw(this.gl.TRIANGLES,this.tickCount[y],this.tickOffset[y]))},M.drawLabel=function(y,T,w,A,f,u,h,o){!this.labelCount[y]||(this.shader.uniforms.axis=u,this.shader.uniforms.color=f,this.shader.uniforms.angle=w,this.shader.uniforms.scale=T,this.shader.uniforms.offset=A,this.shader.uniforms.alignDir=h,this.shader.uniforms.alignOpt=o,this.vao.draw(this.gl.TRIANGLES,this.labelCount[y],this.labelOffset[y]))},M.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()};function _(y,T){try{return n(y,T)}catch(w){return console.warn('error vectorizing text:"'+y+'" error:',w),{cells:[],positions:[]}}}function l(y,T,w,A,f,u){var h=t(y),o=i(y,[{buffer:h,size:3}]),S=r(y);S.attributes.position.location=0;var R=new x(y,S,h,o);return R.update(T,w,A,f,u),R}}).call(this)}).call(this,e("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(e,p,g){"use strict";g.create=t,g.equal=i;function a(n,r){var d=n+"",s=d.indexOf("."),m=0;s>=0&&(m=d.length-s-1);var x=Math.pow(10,m),M=Math.round(n*r*x),v=M+"";if(v.indexOf("e")>=0)return v;var _=M/x,l=M%x;M<0?(_=-Math.ceil(_)|0,l=-l|0):(_=Math.floor(_)|0,l=l|0);var y=""+_;if(M<0&&(y="-"+y),m){for(var T=""+l;T.length<m;)T="0"+T;return y+"."+T}else return y}function t(n,r){for(var d=[],s=0;s<3;++s){for(var m=[],x=.5*(n[0][s]+n[1][s]),M=0;M*r[s]<=n[1][s];++M)m.push({x:M*r[s],text:a(r[s],M)});for(var M=-1;M*r[s]>=n[0][s];--M)m.push({x:M*r[s],text:a(r[s],M)});d.push(m)}return d}function i(n,r){for(var d=0;d<3;++d){if(n[d].length!==r[d].length)return!1;for(var s=0;s<n[d].length;++s){var m=n[d][s],x=r[d][s];if(m.x!==x.x||m.text!==x.text||m.font!==x.font||m.fontColor!==x.fontColor||m.fontSize!==x.fontSize||m.dx!==x.dx||m.dy!==x.dy)return!1}}return!0}},{}],77:[function(e,p,g){"use strict";p.exports=T;var a=e("extract-frustum-planes"),t=e("split-polygon"),i=e("./lib/cube.js"),n=e("gl-mat4/multiply"),r=e("gl-mat4/transpose"),d=e("gl-vec4/transformMat4"),s=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),m=new Float32Array(16);function x(w,A,f){this.lo=w,this.hi=A,this.pixelsPerDataUnit=f}var M=[0,0,0,1],v=[0,0,0,1];function _(w,A,f,u,h){for(var o=0;o<3;++o){for(var S=M,R=v,z=0;z<3;++z)R[z]=S[z]=f[z];R[3]=S[3]=1,R[o]+=1,d(R,R,A),R[3]<0&&(w[o]=1/0),S[o]-=1,d(S,S,A),S[3]<0&&(w[o]=1/0);var O=(S[0]/S[3]-R[0]/R[3])*u,I=(S[1]/S[3]-R[1]/R[3])*h;w[o]=.25*Math.sqrt(O*O+I*I)}return w}var l=[new x(1/0,-1/0,1/0),new x(1/0,-1/0,1/0),new x(1/0,-1/0,1/0)],y=[0,0,0];function T(w,A,f,u,I){var o=A.model||s,S=A.view||s,R=A.projection||s,z=A._ortho||!1,O=w.bounds,I=I||i(o,S,R,O,z),F=I.axis;n(m,S,o),n(m,R,m);for(var D=l,B=0;B<3;++B)D[B].lo=1/0,D[B].hi=-1/0,D[B].pixelsPerDataUnit=1/0;var U=a(r(m,m));r(m,m);for(var X=0;X<3;++X){var oe=(X+1)%3,se=(X+2)%3,q=y;e:for(var B=0;B<2;++B){var K=[];if(F[X]<0!=!!B){q[X]=O[B][X];for(var G=0;G<2;++G){q[oe]=O[G^B][oe];for(var Q=0;Q<2;++Q)q[se]=O[Q^G^B][se],K.push(q.slice())}for(var V=z?5:4,G=V;G===V;++G){if(K.length===0)continue e;K=t.positive(K,U[G])}for(var G=0;G<K.length;++G)for(var se=K[G],H=_(y,m,se,f,u),Q=0;Q<3;++Q)D[Q].lo=Math.min(D[Q].lo,se[Q]),D[Q].hi=Math.max(D[Q].hi,se[Q]),Q!==X&&(D[Q].pixelsPerDataUnit=Math.min(D[Q].pixelsPerDataUnit,Math.abs(H[Q])))}}}return D}},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(e,p,g){"use strict";var a=e("typedarray-pool"),t=e("ndarray-ops"),i=e("ndarray"),n=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function r(v,_,l,y,T){this.gl=v,this.type=_,this.handle=l,this.length=y,this.usage=T}var d=r.prototype;d.bind=function(){this.gl.bindBuffer(this.type,this.handle)},d.unbind=function(){this.gl.bindBuffer(this.type,null)},d.dispose=function(){this.gl.deleteBuffer(this.handle)};function s(v,_,l,y,T,w){var A=T.length*T.BYTES_PER_ELEMENT;if(w<0)return v.bufferData(_,T,y),A;if(A+w>l)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return v.bufferSubData(_,w,T),l}function m(v,_){for(var l=a.malloc(v.length,_),y=v.length,T=0;T<y;++T)l[T]=v[T];return l}function x(v,_){for(var l=1,y=_.length-1;y>=0;--y){if(_[y]!==l)return!1;l*=v[y]}return!0}d.update=function(v,_){if(typeof _!="number"&&(_=-1),this.bind(),typeof v=="object"&&typeof v.shape<"u"){var l=v.dtype;if(n.indexOf(l)<0&&(l="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER){var y=gl.getExtension("OES_element_index_uint");y&&l!=="uint16"?l="uint32":l="uint16"}if(l===v.dtype&&x(v.shape,v.stride))v.offset===0&&v.data.length===v.shape[0]?this.length=s(this.gl,this.type,this.length,this.usage,v.data,_):this.length=s(this.gl,this.type,this.length,this.usage,v.data.subarray(v.offset,v.shape[0]),_);else{var T=a.malloc(v.size,l),w=i(T,v.shape);t.assign(w,v),_<0?this.length=s(this.gl,this.type,this.length,this.usage,T,_):this.length=s(this.gl,this.type,this.length,this.usage,T.subarray(0,v.size),_),a.free(T)}}else if(Array.isArray(v)){var A;this.type===this.gl.ELEMENT_ARRAY_BUFFER?A=m(v,"uint16"):A=m(v,"float32"),_<0?this.length=s(this.gl,this.type,this.length,this.usage,A,_):this.length=s(this.gl,this.type,this.length,this.usage,A.subarray(0,v.length),_),a.free(A)}else if(typeof v=="object"&&typeof v.length=="number")this.length=s(this.gl,this.type,this.length,this.usage,v,_);else if(typeof v=="number"||v===void 0){if(_>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");v=v|0,v<=0&&(v=1),this.gl.bufferData(this.type,v|0,this.usage),this.length=v}else throw new Error("gl-buffer: Invalid data type")};function M(v,_,l,y){if(l=l||v.ARRAY_BUFFER,y=y||v.DYNAMIC_DRAW,l!==v.ARRAY_BUFFER&&l!==v.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(y!==v.DYNAMIC_DRAW&&y!==v.STATIC_DRAW&&y!==v.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var T=v.createBuffer(),w=new r(v,l,T,0,y);return w.update(_),w}p.exports=M},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(e,p,g){"use strict";var a=e("gl-vec3");p.exports=function(i,n){var r=i.positions,d=i.vectors,s={positions:[],vertexIntensity:[],vertexIntensityBounds:i.vertexIntensityBounds,vectors:[],cells:[],coneOffset:i.coneOffset,colormap:i.colormap};if(i.positions.length===0)return n&&(n[0]=[0,0,0],n[1]=[0,0,0]),s;for(var m=0,x=1/0,M=-1/0,v=1/0,_=-1/0,l=1/0,y=-1/0,T=null,w=null,A=[],f=1/0,u=!1,h=0;h<r.length;h++){var o=r[h];x=Math.min(o[0],x),M=Math.max(o[0],M),v=Math.min(o[1],v),_=Math.max(o[1],_),l=Math.min(o[2],l),y=Math.max(o[2],y);var S=d[h];if(a.length(S)>m&&(m=a.length(S)),h){var R=2*a.distance(T,o)/(a.length(w)+a.length(S));R?(f=Math.min(f,R),u=!1):u=!0}u||(T=o,w=S),A.push(S)}var z=[x,v,l],O=[M,_,y];n&&(n[0]=z,n[1]=O),m===0&&(m=1);var I=1/m;isFinite(f)||(f=1),s.vectorScale=f;var F=i.coneSize||.5;i.absoluteConeSize&&(F=i.absoluteConeSize*I),s.coneScale=F;for(var h=0,D=0;h<r.length;h++)for(var o=r[h],B=o[0],U=o[1],X=o[2],oe=A[h],se=a.length(oe)*I,q=0,K=8;q<K;q++){s.positions.push([B,U,X,D++]),s.positions.push([B,U,X,D++]),s.positions.push([B,U,X,D++]),s.positions.push([B,U,X,D++]),s.positions.push([B,U,X,D++]),s.positions.push([B,U,X,D++]),s.vectors.push(oe),s.vectors.push(oe),s.vectors.push(oe),s.vectors.push(oe),s.vectors.push(oe),s.vectors.push(oe),s.vertexIntensity.push(se,se,se),s.vertexIntensity.push(se,se,se);var G=s.positions.length;s.cells.push([G-6,G-5,G-4],[G-3,G-2,G-1])}return s};var t=e("./lib/shaders");p.exports.createMesh=e("./create_mesh"),p.exports.createConeMesh=function(i,n){return p.exports.createMesh(i,n,{shaders:t,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(e,p,g){"use strict";var a=e("gl-shader"),t=e("gl-buffer"),i=e("gl-vao"),n=e("gl-texture2d"),r=e("gl-mat4/multiply"),d=e("gl-mat4/invert"),s=e("ndarray"),m=e("colormap"),x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function M(A,f,u,h,o,S,R,z,O,I,F){this.gl=A,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=f,this.dirty=!0,this.triShader=u,this.pickShader=h,this.trianglePositions=o,this.triangleVectors=S,this.triangleColors=z,this.triangleUVs=O,this.triangleIds=R,this.triangleVAO=I,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=F,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=x,this._view=x,this._projection=x,this._resolution=[1,1]}var v=M.prototype;v.isOpaque=function(){return this.opacity>=1},v.isTransparent=function(){return this.opacity<1},v.pickSlots=1,v.setPickBase=function(A){this.pickId=A};function _(A){for(var f=m({colormap:A,nshades:256,format:"rgba"}),u=new Uint8Array(256*4),h=0;h<256;++h){for(var o=f[h],S=0;S<3;++S)u[4*h+S]=o[S];u[4*h+3]=o[3]*255}return s(u,[256,256,4],[4,0,1])}function l(A){for(var f=A.length,u=new Array(f),h=0;h<f;++h)u[h]=A[h][2];return u}v.update=function(A){A=A||{};var f=this.gl;this.dirty=!0,"lightPosition"in A&&(this.lightPosition=A.lightPosition),"opacity"in A&&(this.opacity=A.opacity),"ambient"in A&&(this.ambientLight=A.ambient),"diffuse"in A&&(this.diffuseLight=A.diffuse),"specular"in A&&(this.specularLight=A.specular),"roughness"in A&&(this.roughness=A.roughness),"fresnel"in A&&(this.fresnel=A.fresnel),A.tubeScale!==void 0&&(this.tubeScale=A.tubeScale),A.vectorScale!==void 0&&(this.vectorScale=A.vectorScale),A.coneScale!==void 0&&(this.coneScale=A.coneScale),A.coneOffset!==void 0&&(this.coneOffset=A.coneOffset),A.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=f.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=f.LINEAR,this.texture.setPixels(_(A.colormap)),this.texture.generateMipmap());var u=A.cells,h=A.positions,o=A.vectors;if(!h||!u||!o)return;var S=[],R=[],z=[],O=[],I=[];this.cells=u,this.positions=h,this.vectors=o;var F=A.meshColor||[1,1,1,1],D=A.vertexIntensity,B=1/0,U=-1/0;if(D)if(A.vertexIntensityBounds)B=+A.vertexIntensityBounds[0],U=+A.vertexIntensityBounds[1];else for(var X=0;X<D.length;++X){var oe=D[X];B=Math.min(B,oe),U=Math.max(U,oe)}else for(var X=0;X<h.length;++X){var oe=h[X][2];B=Math.min(B,oe),U=Math.max(U,oe)}D?this.intensity=D:this.intensity=l(h),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var X=0;X<h.length;++X)for(var se=h[X],q=0;q<3;++q)isNaN(se[q])||!isFinite(se[q])||(this.bounds[0][q]=Math.min(this.bounds[0][q],se[q]),this.bounds[1][q]=Math.max(this.bounds[1][q],se[q]));var K=0;e:for(var X=0;X<u.length;++X){var G=u[X];switch(G.length){case 3:for(var q=0;q<3;++q)for(var Q=G[q],se=h[Q],V=0;V<3;++V)if(isNaN(se[V])||!isFinite(se[V]))continue e;for(var q=0;q<3;++q){var Q=G[2-q],se=h[Q];S.push(se[0],se[1],se[2],se[3]);var H=o[Q];R.push(H[0],H[1],H[2],H[3]||0);var ee=F;ee.length===3?z.push(ee[0],ee[1],ee[2],1):z.push(ee[0],ee[1],ee[2],ee[3]);var J;D?J=[(D[Q]-B)/(U-B),0]:J=[(se[2]-B)/(U-B),0],O.push(J[0],J[1]),I.push(X)}K+=1;break;default:break}}this.triangleCount=K,this.trianglePositions.update(S),this.triangleVectors.update(R),this.triangleColors.update(z),this.triangleUVs.update(O),this.triangleIds.update(new Uint32Array(I))},v.drawTransparent=v.draw=function(A){A=A||{};for(var f=this.gl,u=A.model||x,h=A.view||x,o=A.projection||x,S=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],R=0;R<3;++R)S[0][R]=Math.max(S[0][R],this.clipBounds[0][R]),S[1][R]=Math.min(S[1][R],this.clipBounds[1][R]);var z={model:u,view:h,projection:o,inverseModel:x.slice(),clipBounds:S,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};z.inverseModel=d(z.inverseModel,z.model),f.disable(f.CULL_FACE),this.texture.bind(0);var O=new Array(16);r(O,z.view,z.model),r(O,z.projection,O),d(O,O);for(var R=0;R<3;++R)z.eyePosition[R]=O[12+R]/O[15];for(var I=O[15],R=0;R<3;++R)I+=this.lightPosition[R]*O[4*R+3];for(var R=0;R<3;++R){for(var F=O[12+R],D=0;D<3;++D)F+=O[4*D+R]*this.lightPosition[D];z.lightPosition[R]=F/I}if(this.triangleCount>0){var B=this.triShader;B.bind(),B.uniforms=z,this.triangleVAO.bind(),f.drawArrays(f.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}},v.drawPick=function(A){A=A||{};for(var f=this.gl,u=A.model||x,h=A.view||x,o=A.projection||x,S=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],R=0;R<3;++R)S[0][R]=Math.max(S[0][R],this.clipBounds[0][R]),S[1][R]=Math.min(S[1][R],this.clipBounds[1][R]);this._model=[].slice.call(u),this._view=[].slice.call(h),this._projection=[].slice.call(o),this._resolution=[f.drawingBufferWidth,f.drawingBufferHeight];var z={model:u,view:h,projection:o,clipBounds:S,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},O=this.pickShader;O.bind(),O.uniforms=z,this.triangleCount>0&&(this.triangleVAO.bind(),f.drawArrays(f.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind())},v.pick=function(A){if(!A||A.id!==this.pickId)return null;var f=A.value[0]+256*A.value[1]+65536*A.value[2],u=this.cells[f],h=this.positions[u[1]].slice(0,3),o={position:h,dataCoordinate:h,index:Math.floor(u[1]/48)};return this.traceType==="cone"?o.index=Math.floor(u[1]/48):this.traceType==="streamtube"&&(o.intensity=this.intensity[u[1]],o.velocity=this.vectors[u[1]].slice(0,3),o.divergence=this.vectors[u[1]][3],o.index=f),o},v.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()};function y(A,f){var u=a(A,f.meshShader.vertex,f.meshShader.fragment,null,f.meshShader.attributes);return u.attributes.position.location=0,u.attributes.color.location=2,u.attributes.uv.location=3,u.attributes.vector.location=4,u}function T(A,f){var u=a(A,f.pickShader.vertex,f.pickShader.fragment,null,f.pickShader.attributes);return u.attributes.position.location=0,u.attributes.id.location=1,u.attributes.vector.location=4,u}function w(A,f,u){var h=u.shaders;arguments.length===1&&(f=A,A=f.gl);var o=y(A,h),S=T(A,h),R=n(A,s(new Uint8Array([255,255,255,255]),[1,1,4]));R.generateMipmap(),R.minFilter=A.LINEAR_MIPMAP_LINEAR,R.magFilter=A.LINEAR;var z=t(A),O=t(A),I=t(A),F=t(A),D=t(A),B=i(A,[{buffer:z,type:A.FLOAT,size:4},{buffer:D,type:A.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:I,type:A.FLOAT,size:4},{buffer:F,type:A.FLOAT,size:2},{buffer:O,type:A.FLOAT,size:4}]),U=new M(A,R,o,S,z,O,D,I,F,B,u.traceType||"cone");return U.update(f),U}p.exports=w},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(e,p,g){var a=e("glslify"),t=a([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),i=a([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),n=a([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);g.meshShader={vertex:t,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},g.pickShader={vertex:n,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(e,p,g){p.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(e,p,g){var a=e("./1.0/numbers");p.exports=function(i){return a[i]}},{"./1.0/numbers":82}],84:[function(e,p,g){"use strict";p.exports=M;var a=e("gl-buffer"),t=e("gl-vao"),i=e("./shaders/index"),n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(v,_,l,y){this.gl=v,this.shader=y,this.buffer=_,this.vao=l,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var d=r.prototype;d.isOpaque=function(){return!this.hasAlpha},d.isTransparent=function(){return this.hasAlpha},d.drawTransparent=d.draw=function(v){var _=this.gl,l=this.shader.uniforms;this.shader.bind();var y=l.view=v.view||n,T=l.projection=v.projection||n;l.model=v.model||n,l.clipBounds=this.clipBounds,l.opacity=this.opacity;var w=y[12],A=y[13],f=y[14],u=y[15],h=v._ortho||!1,o=h?2:1,S=o*this.pixelRatio*(T[3]*w+T[7]*A+T[11]*f+T[15]*u)/_.drawingBufferHeight;this.vao.bind();for(var R=0;R<3;++R)_.lineWidth(this.lineWidth[R]*this.pixelRatio),l.capSize=this.capSize[R]*S,this.lineCount[R]&&_.drawArrays(_.LINES,this.lineOffset[R],this.lineCount[R]);this.vao.unbind()};function s(v,_){for(var l=0;l<3;++l)v[0][l]=Math.min(v[0][l],_[l]),v[1][l]=Math.max(v[1][l],_[l])}var m=function(){for(var v=new Array(3),_=0;_<3;++_){for(var l=[],y=1;y<=2;++y)for(var T=-1;T<=1;T+=2){var w=(y+_)%3,A=[0,0,0];A[w]=T,l.push(A)}v[_]=l}return v}();function x(v,_,l,y){for(var T=m[y],w=0;w<T.length;++w){var A=T[w];v.push(_[0],_[1],_[2],l[0],l[1],l[2],l[3],A[0],A[1],A[2])}return T.length}d.update=function(v){v=v||{},"lineWidth"in v&&(this.lineWidth=v.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in v&&(this.capSize=v.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in v&&(this.opacity=+v.opacity,this.opacity<1&&(this.hasAlpha=!0));var _=v.color||[[0,0,0],[0,0,0],[0,0,0]],l=v.position,y=v.error;if(Array.isArray(_[0])||(_=[_,_,_]),l&&y){var T=[],w=l.length,A=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var f=0;f<3;++f){this.lineOffset[f]=A;e:for(var u=0;u<w;++u){for(var h=l[u],o=0;o<3;++o)if(isNaN(h[o])||!isFinite(h[o]))continue e;var S=y[u],R=_[f];if(Array.isArray(R[0])&&(R=_[u]),R.length===3?R=[R[0],R[1],R[2],1]:R.length===4&&(R=[R[0],R[1],R[2],R[3]],!this.hasAlpha&&R[3]<1&&(this.hasAlpha=!0)),!(isNaN(S[0][f])||isNaN(S[1][f]))){if(S[0][f]<0){var z=h.slice();z[f]+=S[0][f],T.push(h[0],h[1],h[2],R[0],R[1],R[2],R[3],0,0,0,z[0],z[1],z[2],R[0],R[1],R[2],R[3],0,0,0),s(this.bounds,z),A+=2+x(T,z,R,f)}if(S[1][f]>0){var z=h.slice();z[f]+=S[1][f],T.push(h[0],h[1],h[2],R[0],R[1],R[2],R[3],0,0,0,z[0],z[1],z[2],R[0],R[1],R[2],R[3],0,0,0),s(this.bounds,z),A+=2+x(T,z,R,f)}}}this.lineCount[f]=A-this.lineOffset[f]}this.buffer.update(T)}},d.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()};function M(v){var _=v.gl,l=a(_),y=t(_,[{buffer:l,type:_.FLOAT,size:3,offset:0,stride:40},{buffer:l,type:_.FLOAT,size:4,offset:12,stride:40},{buffer:l,type:_.FLOAT,size:3,offset:28,stride:40}]),T=i(_);T.attributes.position.location=0,T.attributes.color.location=1,T.attributes.offset.location=2;var w=new r(_,l,y,T);return w.update(v),w}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(e,p,g){"use strict";var a=e("glslify"),t=e("gl-shader"),i=a([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),n=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);p.exports=function(r){return t(r,i,n,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(e,p,g){"use strict";var a=e("gl-texture2d");p.exports=A;var t=null,i,n,r,d;function s(f){var u=f.getParameter(f.FRAMEBUFFER_BINDING),h=f.getParameter(f.RENDERBUFFER_BINDING),o=f.getParameter(f.TEXTURE_BINDING_2D);return[u,h,o]}function m(f,u){f.bindFramebuffer(f.FRAMEBUFFER,u[0]),f.bindRenderbuffer(f.RENDERBUFFER,u[1]),f.bindTexture(f.TEXTURE_2D,u[2])}function x(f,u){var h=f.getParameter(u.MAX_COLOR_ATTACHMENTS_WEBGL);t=new Array(h+1);for(var o=0;o<=h;++o){for(var S=new Array(h),R=0;R<o;++R)S[R]=f.COLOR_ATTACHMENT0+R;for(var R=o;R<h;++R)S[R]=f.NONE;t[o]=S}}function M(f){switch(f){case i:throw new Error("gl-fbo: Framebuffer unsupported");case n:throw new Error("gl-fbo: Framebuffer incomplete attachment");case r:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case d:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function v(f,u,h,o,S,R){if(!o)return null;var z=a(f,u,h,S,o);return z.magFilter=f.NEAREST,z.minFilter=f.NEAREST,z.mipSamples=1,z.bind(),f.framebufferTexture2D(f.FRAMEBUFFER,R,f.TEXTURE_2D,z.handle,0),z}function _(f,u,h,o,S){var R=f.createRenderbuffer();return f.bindRenderbuffer(f.RENDERBUFFER,R),f.renderbufferStorage(f.RENDERBUFFER,o,u,h),f.framebufferRenderbuffer(f.FRAMEBUFFER,S,f.RENDERBUFFER,R),R}function l(f){var u=s(f.gl),h=f.gl,o=f.handle=h.createFramebuffer(),S=f._shape[0],R=f._shape[1],z=f.color.length,O=f._ext,I=f._useStencil,F=f._useDepth,D=f._colorType;h.bindFramebuffer(h.FRAMEBUFFER,o);for(var B=0;B<z;++B)f.color[B]=v(h,S,R,D,h.RGBA,h.COLOR_ATTACHMENT0+B);z===0?(f._color_rb=_(h,S,R,h.RGBA4,h.COLOR_ATTACHMENT0),O&&O.drawBuffersWEBGL(t[0])):z>1&&O.drawBuffersWEBGL(t[z]);var U=h.getExtension("WEBGL_depth_texture");U?I?f.depth=v(h,S,R,U.UNSIGNED_INT_24_8_WEBGL,h.DEPTH_STENCIL,h.DEPTH_STENCIL_ATTACHMENT):F&&(f.depth=v(h,S,R,h.UNSIGNED_SHORT,h.DEPTH_COMPONENT,h.DEPTH_ATTACHMENT)):F&&I?f._depth_rb=_(h,S,R,h.DEPTH_STENCIL,h.DEPTH_STENCIL_ATTACHMENT):F?f._depth_rb=_(h,S,R,h.DEPTH_COMPONENT16,h.DEPTH_ATTACHMENT):I&&(f._depth_rb=_(h,S,R,h.STENCIL_INDEX,h.STENCIL_ATTACHMENT));var X=h.checkFramebufferStatus(h.FRAMEBUFFER);if(X!==h.FRAMEBUFFER_COMPLETE){f._destroyed=!0,h.bindFramebuffer(h.FRAMEBUFFER,null),h.deleteFramebuffer(f.handle),f.handle=null,f.depth&&(f.depth.dispose(),f.depth=null),f._depth_rb&&(h.deleteRenderbuffer(f._depth_rb),f._depth_rb=null);for(var B=0;B<f.color.length;++B)f.color[B].dispose(),f.color[B]=null;f._color_rb&&(h.deleteRenderbuffer(f._color_rb),f._color_rb=null),m(h,u),M(X)}m(h,u)}function y(f,u,h,o,S,R,z,O){this.gl=f,this._shape=[u|0,h|0],this._destroyed=!1,this._ext=O,this.color=new Array(S);for(var I=0;I<S;++I)this.color[I]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=o,this._useDepth=R,this._useStencil=z;var F=this,D=[u|0,h|0];Object.defineProperties(D,{0:{get:function(){return F._shape[0]},set:function(B){return F.width=B}},1:{get:function(){return F._shape[1]},set:function(B){return F.height=B}}}),this._shapeVector=D,l(this)}var T=y.prototype;function w(f,u,h){if(f._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(!(f._shape[0]===u&&f._shape[1]===h)){var o=f.gl,S=o.getParameter(o.MAX_RENDERBUFFER_SIZE);if(u<0||u>S||h<0||h>S)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");f._shape[0]=u,f._shape[1]=h;for(var R=s(o),z=0;z<f.color.length;++z)f.color[z].shape=f._shape;f._color_rb&&(o.bindRenderbuffer(o.RENDERBUFFER,f._color_rb),o.renderbufferStorage(o.RENDERBUFFER,o.RGBA4,f._shape[0],f._shape[1])),f.depth&&(f.depth.shape=f._shape),f._depth_rb&&(o.bindRenderbuffer(o.RENDERBUFFER,f._depth_rb),f._useDepth&&f._useStencil?o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_STENCIL,f._shape[0],f._shape[1]):f._useDepth?o.renderbufferStorage(o.RENDERBUFFER,o.DEPTH_COMPONENT16,f._shape[0],f._shape[1]):f._useStencil&&o.renderbufferStorage(o.RENDERBUFFER,o.STENCIL_INDEX,f._shape[0],f._shape[1])),o.bindFramebuffer(o.FRAMEBUFFER,f.handle);var O=o.checkFramebufferStatus(o.FRAMEBUFFER);O!==o.FRAMEBUFFER_COMPLETE&&(f.dispose(),m(o,R),M(O)),m(o,R)}}Object.defineProperties(T,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(f){if(Array.isArray(f)||(f=[f|0,f|0]),f.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var u=f[0]|0,h=f[1]|0;return w(this,u,h),[u,h]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(f){return f=f|0,w(this,f,this._shape[1]),f},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(f){return f=f|0,w(this,this._shape[0],f),f},enumerable:!1}}),T.bind=function(){if(!this._destroyed){var f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,this.handle),f.viewport(0,0,this._shape[0],this._shape[1])}},T.dispose=function(){if(!this._destroyed){this._destroyed=!0;var f=this.gl;f.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(f.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var u=0;u<this.color.length;++u)this.color[u].dispose(),this.color[u]=null;this._color_rb&&(f.deleteRenderbuffer(this._color_rb),this._color_rb=null)}};function A(f,u,h,o){i||(i=f.FRAMEBUFFER_UNSUPPORTED,n=f.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,r=f.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,d=f.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var S=f.getExtension("WEBGL_draw_buffers");if(!t&&S&&x(f,S),Array.isArray(u)&&(o=h,h=u[1]|0,u=u[0]|0),typeof u!="number")throw new Error("gl-fbo: Missing shape parameter");var R=f.getParameter(f.MAX_RENDERBUFFER_SIZE);if(u<0||u>R||h<0||h>R)throw new Error("gl-fbo: Parameters are too large for FBO");o=o||{};var z=1;if("color"in o){if(z=Math.max(o.color|0,0),z<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(z>1)if(S){if(z>f.getParameter(S.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+z+" draw buffers")}else throw new Error("gl-fbo: Multiple draw buffer extension not supported")}var O=f.UNSIGNED_BYTE,I=f.getExtension("OES_texture_float");if(o.float&&z>0){if(!I)throw new Error("gl-fbo: Context does not support floating point textures");O=f.FLOAT}else o.preferFloat&&z>0&&I&&(O=f.FLOAT);var F=!0;"depth"in o&&(F=!!o.depth);var D=!1;return"stencil"in o&&(D=!!o.stencil),new y(f,u,h,O,z,F,D,S)}},{"gl-texture2d":146}],87:[function(e,p,g){var a=e("sprintf-js").sprintf,t=e("gl-constants/lookup"),i=e("glsl-shader-name"),n=e("add-line-numbers");p.exports=r;function r(d,s,m){"use strict";var x=i(s)||"of unknown name (see npm glsl-shader-name)",M="unknown type";m!==void 0&&(M=m===t.FRAGMENT_SHADER?"fragment":"vertex");for(var v=a(`Error compiling %s shader %s:
`,M,x),_=a("%s%s",v,d),l=d.split(`
`),y={},T=0;T<l.length;T++){var w=l[T];if(!(w===""||w==="\0")){var A=parseInt(w.split(":")[2]);if(isNaN(A))throw new Error(a("Could not parse error: %s",w));y[A]=w}}for(var f=n(s).split(`
`),T=0;T<f.length;T++)if(!(!y[T+3]&&!y[T+2]&&!y[T+1])){var u=f[T];if(v+=u+`
`,y[T+1]){var h=y[T+1];h=h.substr(h.split(":",3).join(":").length+1).trim(),v+=a(`^^^ %s

`,h)}}return{long:v.trim(),short:_.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(e,p,g){"use strict";p.exports=M;var a=e("binary-search-bounds"),t=e("iota-array"),i=e("typedarray-pool"),n=e("gl-shader"),r=e("gl-buffer"),d=e("./lib/shaders");function s(v,_,l,y,T,w,A){this.plot=v,this.shader=_,this.pickShader=l,this.positionBuffer=y,this.weightBuffer=T,this.colorBuffer=w,this.idBuffer=A,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var m=s.prototype,x=[0,0,1,0,0,1,1,0,1,1,0,1];m.draw=function(){var v=[1,0,0,0,1,0,0,0,1];return function(){var _=this.plot,l=this.shader,y=this.bounds,T=this.numVertices;if(!(T<=0)){var w=_.gl,A=_.dataBox,f=y[2]-y[0],u=y[3]-y[1],h=A[2]-A[0],o=A[3]-A[1];v[0]=2*f/h,v[4]=2*u/o,v[6]=2*(y[0]-A[0])/h-1,v[7]=2*(y[1]-A[1])/o-1,l.bind();var S=l.uniforms;S.viewTransform=v,S.shape=this.shape;var R=l.attributes;this.positionBuffer.bind(),R.position.pointer(),this.weightBuffer.bind(),R.weight.pointer(w.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),R.color.pointer(w.UNSIGNED_BYTE,!0),w.drawArrays(w.TRIANGLES,0,T)}}}(),m.drawPick=function(){var v=[1,0,0,0,1,0,0,0,1],_=[0,0,0,0];return function(l){var y=this.plot,T=this.pickShader,w=this.bounds,A=this.numVertices;if(!(A<=0)){var f=y.gl,u=y.dataBox,h=w[2]-w[0],o=w[3]-w[1],S=u[2]-u[0],R=u[3]-u[1];v[0]=2*h/S,v[4]=2*o/R,v[6]=2*(w[0]-u[0])/S-1,v[7]=2*(w[1]-u[1])/R-1;for(var z=0;z<4;++z)_[z]=l>>z*8&255;this.pickOffset=l,T.bind();var O=T.uniforms;O.viewTransform=v,O.pickOffset=_,O.shape=this.shape;var I=T.attributes;return this.positionBuffer.bind(),I.position.pointer(),this.weightBuffer.bind(),I.weight.pointer(f.UNSIGNED_BYTE,!1),this.idBuffer.bind(),I.pickId.pointer(f.UNSIGNED_BYTE,!1),f.drawArrays(f.TRIANGLES,0,A),l+this.shape[0]*this.shape[1]}}}(),m.pick=function(v,_,l){var y=this.pickOffset,T=this.shape[0]*this.shape[1];if(l<y||l>=y+T)return null;var w=l-y,A=this.xData,f=this.yData;return{object:this,pointId:w,dataCoord:[A[w%this.shape[0]],f[w/this.shape[0]|0]]}},m.update=function(v){v=v||{};var _=v.shape||[0,0],l=v.x||t(_[0]),y=v.y||t(_[1]),T=v.z||new Float32Array(_[0]*_[1]),w=v.zsmooth!==!1;this.xData=l,this.yData=y;var A=v.colorLevels||[0],f=v.colorValues||[0,0,0,1],u=A.length,h=this.bounds,o,S,R,z;w?(o=h[0]=l[0],S=h[1]=y[0],R=h[2]=l[l.length-1],z=h[3]=y[y.length-1]):(o=h[0]=l[0]+(l[1]-l[0])/2,S=h[1]=y[0]+(y[1]-y[0])/2,R=h[2]=l[l.length-1]+(l[l.length-1]-l[l.length-2])/2,z=h[3]=y[y.length-1]+(y[y.length-1]-y[y.length-2])/2);var O=1/(R-o),I=1/(z-S),F=_[0],D=_[1];this.shape=[F,D];var B=(w?(F-1)*(D-1):F*D)*(x.length>>>1);this.numVertices=B;for(var U=i.mallocUint8(B*4),X=i.mallocFloat32(B*2),oe=i.mallocUint8(B*2),se=i.mallocUint32(B),q=0,K=w?F-1:F,G=w?D-1:D,Q=0;Q<G;++Q){var V,H;w?(V=I*(y[Q]-S),H=I*(y[Q+1]-S)):(V=Q<D-1?I*(y[Q]-(y[Q+1]-y[Q])/2-S):I*(y[Q]-(y[Q]-y[Q-1])/2-S),H=Q<D-1?I*(y[Q]+(y[Q+1]-y[Q])/2-S):I*(y[Q]+(y[Q]-y[Q-1])/2-S));for(var ee=0;ee<K;++ee){var J,W;w?(J=O*(l[ee]-o),W=O*(l[ee+1]-o)):(J=ee<F-1?O*(l[ee]-(l[ee+1]-l[ee])/2-o):O*(l[ee]-(l[ee]-l[ee-1])/2-o),W=ee<F-1?O*(l[ee]+(l[ee+1]-l[ee])/2-o):O*(l[ee]+(l[ee]-l[ee-1])/2-o));for(var re=0;re<x.length;re+=2){var j=x[re],Z=x[re+1],ne=w?(Q+Z)*F+(ee+j):Q*F+ee,le=T[ne],ge=a.le(A,le),pe,xe,Ee,Te;if(ge<0)pe=f[0],xe=f[1],Ee=f[2],Te=f[3];else if(ge===u-1)pe=f[4*u-4],xe=f[4*u-3],Ee=f[4*u-2],Te=f[4*u-1];else{var de=(le-A[ge])/(A[ge+1]-A[ge]),be=1-de,Le=4*ge,De=4*(ge+1);pe=be*f[Le]+de*f[De],xe=be*f[Le+1]+de*f[De+1],Ee=be*f[Le+2]+de*f[De+2],Te=be*f[Le+3]+de*f[De+3]}U[4*q]=255*pe,U[4*q+1]=255*xe,U[4*q+2]=255*Ee,U[4*q+3]=255*Te,X[2*q]=J*.5+W*.5,X[2*q+1]=V*.5+H*.5,oe[2*q]=j,oe[2*q+1]=Z,se[q]=Q*F+ee,q+=1}}}this.positionBuffer.update(X),this.weightBuffer.update(oe),this.colorBuffer.update(U),this.idBuffer.update(se),i.free(X),i.free(U),i.free(oe),i.free(se)},m.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)};function M(v,_){var l=v.gl,y=n(l,d.vertex,d.fragment),T=n(l,d.pickVertex,d.pickFragment),w=r(l),A=r(l),f=r(l),u=r(l),h=new s(v,y,T,w,A,f,u);return h.update(_),v.addObject(h),h}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(e,p,g){"use strict";var a=e("glslify");p.exports={fragment:a([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:a([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:a([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:a([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:231}],90:[function(e,p,g){var a=e("glslify"),t=e("gl-shader"),i=a([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),n=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),r=a([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),d=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];g.createShader=function(s){return t(s,i,n,null,d)},g.createPickShader=function(s){return t(s,i,r,null,d)}},{"gl-shader":132,glslify:231}],91:[function(e,p,g){"use strict";p.exports=f;var a=e("gl-buffer"),t=e("gl-vao"),i=e("gl-texture2d"),n=new Uint8Array(4),r=new Float32Array(n.buffer);function d(u,h,o,S){return n[0]=S,n[1]=o,n[2]=h,n[3]=u,r[0]}var s=e("binary-search-bounds"),m=e("ndarray"),x=e("./lib/shaders"),M=x.createShader,v=x.createPickShader,_=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function l(u,h){for(var o=0,S=0;S<3;++S){var R=u[S]-h[S];o+=R*R}return Math.sqrt(o)}function y(u){for(var h=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],o=0;o<3;++o)h[0][o]=Math.max(u[0][o],h[0][o]),h[1][o]=Math.min(u[1][o],h[1][o]);return h}function T(u,h,o,S){this.arcLength=u,this.position=h,this.index=o,this.dataCoordinate=S}function w(u,h,o,S,R,z){this.gl=u,this.shader=h,this.pickShader=o,this.buffer=S,this.vao=R,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=z,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var A=w.prototype;A.isTransparent=function(){return this.hasAlpha},A.isOpaque=function(){return!this.hasAlpha},A.pickSlots=1,A.setPickBase=function(u){this.pickId=u},A.drawTransparent=A.draw=function(u){if(!!this.vertexCount){var h=this.gl,o=this.shader,S=this.vao;o.bind(),o.uniforms={model:u.model||_,view:u.view||_,projection:u.projection||_,clipBounds:y(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[h.drawingBufferWidth,h.drawingBufferHeight],pixelRatio:this.pixelRatio},S.bind(),S.draw(h.TRIANGLE_STRIP,this.vertexCount),S.unbind()}},A.drawPick=function(u){if(!!this.vertexCount){var h=this.gl,o=this.pickShader,S=this.vao;o.bind(),o.uniforms={model:u.model||_,view:u.view||_,projection:u.projection||_,pickId:this.pickId,clipBounds:y(this.clipBounds),screenShape:[h.drawingBufferWidth,h.drawingBufferHeight],pixelRatio:this.pixelRatio},S.bind(),S.draw(h.TRIANGLE_STRIP,this.vertexCount),S.unbind()}},A.update=function(u){var h,o;this.dirty=!0;var S=!!u.connectGaps;"dashScale"in u&&(this.dashScale=u.dashScale),this.hasAlpha=!1,"opacity"in u&&(this.opacity=+u.opacity,this.opacity<1&&(this.hasAlpha=!0));var R=[],z=[],O=[],I=0,F=0,D=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],B=u.position||u.positions;if(B){var U=u.color||u.colors||[0,0,0,1],X=u.lineWidth||1,oe=!1;e:for(h=1;h<B.length;++h){var se=B[h-1],q=B[h];for(z.push(I),O.push(se.slice()),o=0;o<3;++o){if(isNaN(se[o])||isNaN(q[o])||!isFinite(se[o])||!isFinite(q[o])){if(!S&&R.length>0){for(var K=0;K<24;++K)R.push(R[R.length-12]);F+=2,oe=!0}continue e}D[0][o]=Math.min(D[0][o],se[o],q[o]),D[1][o]=Math.max(D[1][o],se[o],q[o])}var G,Q;Array.isArray(U[0])?(G=U.length>h-1?U[h-1]:U.length>0?U[U.length-1]:[0,0,0,1],Q=U.length>h?U[h]:U.length>0?U[U.length-1]:[0,0,0,1]):G=Q=U,G.length===3&&(G=[G[0],G[1],G[2],1]),Q.length===3&&(Q=[Q[0],Q[1],Q[2],1]),!this.hasAlpha&&G[3]<1&&(this.hasAlpha=!0);var V;Array.isArray(X)?V=X.length>h-1?X[h-1]:X.length>0?X[X.length-1]:[0,0,0,1]:V=X;var H=I;if(I+=l(se,q),oe){for(o=0;o<2;++o)R.push(se[0],se[1],se[2],q[0],q[1],q[2],H,V,G[0],G[1],G[2],G[3]);F+=2,oe=!1}R.push(se[0],se[1],se[2],q[0],q[1],q[2],H,V,G[0],G[1],G[2],G[3],se[0],se[1],se[2],q[0],q[1],q[2],H,-V,G[0],G[1],G[2],G[3],q[0],q[1],q[2],se[0],se[1],se[2],I,-V,Q[0],Q[1],Q[2],Q[3],q[0],q[1],q[2],se[0],se[1],se[2],I,V,Q[0],Q[1],Q[2],Q[3]),F+=4}}if(this.buffer.update(R),z.push(I),O.push(B[B.length-1].slice()),this.bounds=D,this.vertexCount=F,this.points=O,this.arcLength=z,"dashes"in u){var ee=u.dashes,J=ee.slice();for(J.unshift(0),h=1;h<J.length;++h)J[h]=J[h-1]+J[h];var W=m(new Array(256*4),[256,1,4]);for(h=0;h<256;++h){for(o=0;o<4;++o)W.set(h,0,o,0);s.le(J,J[J.length-1]*h/255)&1?W.set(h,0,0,0):W.set(h,0,0,255)}this.texture.setPixels(W)}},A.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},A.pick=function(u){if(!u||u.id!==this.pickId)return null;var h=d(u.value[0],u.value[1],u.value[2],0),o=s.le(this.arcLength,h);if(o<0)return null;if(o===this.arcLength.length-1)return new T(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),o);for(var S=this.points[o],R=this.points[Math.min(o+1,this.points.length-1)],z=(h-this.arcLength[o])/(this.arcLength[o+1]-this.arcLength[o]),O=1-z,I=[0,0,0],F=0;F<3;++F)I[F]=O*S[F]+z*R[F];var D=Math.min(z<.5?o:o+1,this.points.length-1);return new T(h,I,D,this.points[D])};function f(u){var h=u.gl||u.scene&&u.scene.gl,o=M(h);o.attributes.position.location=0,o.attributes.nextPosition.location=1,o.attributes.arcLength.location=2,o.attributes.lineWidth.location=3,o.attributes.color.location=4;var S=v(h);S.attributes.position.location=0,S.attributes.nextPosition.location=1,S.attributes.arcLength.location=2,S.attributes.lineWidth.location=3,S.attributes.color.location=4;for(var R=a(h),z=t(h,[{buffer:R,size:3,offset:0,stride:48},{buffer:R,size:3,offset:12,stride:48},{buffer:R,size:1,offset:24,stride:48},{buffer:R,size:1,offset:28,stride:48},{buffer:R,size:4,offset:32,stride:48}]),O=m(new Array(256*4),[256,1,4]),I=0;I<256*4;++I)O.data[I]=255;var F=i(h,O);F.wrap=h.REPEAT;var D=new w(h,o,S,R,z,F);return D.update(u),D}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(e,p,g){p.exports=a;function a(t){var i=new Float32Array(16);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],i}},{}],93:[function(e,p,g){p.exports=a;function a(){var t=new Float32Array(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],94:[function(e,p,g){p.exports=a;function a(t){var i=t[0],n=t[1],r=t[2],d=t[3],s=t[4],m=t[5],x=t[6],M=t[7],v=t[8],_=t[9],l=t[10],y=t[11],T=t[12],w=t[13],A=t[14],f=t[15],u=i*m-n*s,h=i*x-r*s,o=i*M-d*s,S=n*x-r*m,R=n*M-d*m,z=r*M-d*x,O=v*w-_*T,I=v*A-l*T,F=v*f-y*T,D=_*A-l*w,B=_*f-y*w,U=l*f-y*A;return u*U-h*B+o*D+S*F-R*I+z*O}},{}],95:[function(e,p,g){p.exports=a;function a(t,i){var n=i[0],r=i[1],d=i[2],s=i[3],m=n+n,x=r+r,M=d+d,v=n*m,_=r*m,l=r*x,y=d*m,T=d*x,w=d*M,A=s*m,f=s*x,u=s*M;return t[0]=1-l-w,t[1]=_+u,t[2]=y-f,t[3]=0,t[4]=_-u,t[5]=1-v-w,t[6]=T+A,t[7]=0,t[8]=y+f,t[9]=T-A,t[10]=1-v-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],96:[function(e,p,g){p.exports=a;function a(t,i,n){var r=i[0],d=i[1],s=i[2],m=i[3],x=r+r,M=d+d,v=s+s,_=r*x,l=r*M,y=r*v,T=d*M,w=d*v,A=s*v,f=m*x,u=m*M,h=m*v;return t[0]=1-(T+A),t[1]=l+h,t[2]=y-u,t[3]=0,t[4]=l-h,t[5]=1-(_+A),t[6]=w+f,t[7]=0,t[8]=y+u,t[9]=w-f,t[10]=1-(_+T),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}},{}],97:[function(e,p,g){p.exports=a;function a(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{}],98:[function(e,p,g){p.exports=a;function a(t,i){var n=i[0],r=i[1],d=i[2],s=i[3],m=i[4],x=i[5],M=i[6],v=i[7],_=i[8],l=i[9],y=i[10],T=i[11],w=i[12],A=i[13],f=i[14],u=i[15],h=n*x-r*m,o=n*M-d*m,S=n*v-s*m,R=r*M-d*x,z=r*v-s*x,O=d*v-s*M,I=_*A-l*w,F=_*f-y*w,D=_*u-T*w,B=l*f-y*A,U=l*u-T*A,X=y*u-T*f,oe=h*X-o*U+S*B+R*D-z*F+O*I;return oe?(oe=1/oe,t[0]=(x*X-M*U+v*B)*oe,t[1]=(d*U-r*X-s*B)*oe,t[2]=(A*O-f*z+u*R)*oe,t[3]=(y*z-l*O-T*R)*oe,t[4]=(M*D-m*X-v*F)*oe,t[5]=(n*X-d*D+s*F)*oe,t[6]=(f*S-w*O-u*o)*oe,t[7]=(_*O-y*S+T*o)*oe,t[8]=(m*U-x*D+v*I)*oe,t[9]=(r*D-n*U-s*I)*oe,t[10]=(w*z-A*S+u*h)*oe,t[11]=(l*S-_*z-T*h)*oe,t[12]=(x*F-m*B-M*I)*oe,t[13]=(n*B-r*F+d*I)*oe,t[14]=(A*o-w*R-f*h)*oe,t[15]=(_*R-l*o+y*h)*oe,t):null}},{}],99:[function(e,p,g){var a=e("./identity");p.exports=t;function t(i,n,r,d){var s,m,x,M,v,_,l,y,T,w,A=n[0],f=n[1],u=n[2],h=d[0],o=d[1],S=d[2],R=r[0],z=r[1],O=r[2];return Math.abs(A-R)<1e-6&&Math.abs(f-z)<1e-6&&Math.abs(u-O)<1e-6?a(i):(l=A-R,y=f-z,T=u-O,w=1/Math.sqrt(l*l+y*y+T*T),l*=w,y*=w,T*=w,s=o*T-S*y,m=S*l-h*T,x=h*y-o*l,w=Math.sqrt(s*s+m*m+x*x),w?(w=1/w,s*=w,m*=w,x*=w):(s=0,m=0,x=0),M=y*x-T*m,v=T*s-l*x,_=l*m-y*s,w=Math.sqrt(M*M+v*v+_*_),w?(w=1/w,M*=w,v*=w,_*=w):(M=0,v=0,_=0),i[0]=s,i[1]=M,i[2]=l,i[3]=0,i[4]=m,i[5]=v,i[6]=y,i[7]=0,i[8]=x,i[9]=_,i[10]=T,i[11]=0,i[12]=-(s*A+m*f+x*u),i[13]=-(M*A+v*f+_*u),i[14]=-(l*A+y*f+T*u),i[15]=1,i)}},{"./identity":97}],100:[function(e,p,g){p.exports=a;function a(t,i,n){var r=i[0],d=i[1],s=i[2],m=i[3],x=i[4],M=i[5],v=i[6],_=i[7],l=i[8],y=i[9],T=i[10],w=i[11],A=i[12],f=i[13],u=i[14],h=i[15],o=n[0],S=n[1],R=n[2],z=n[3];return t[0]=o*r+S*x+R*l+z*A,t[1]=o*d+S*M+R*y+z*f,t[2]=o*s+S*v+R*T+z*u,t[3]=o*m+S*_+R*w+z*h,o=n[4],S=n[5],R=n[6],z=n[7],t[4]=o*r+S*x+R*l+z*A,t[5]=o*d+S*M+R*y+z*f,t[6]=o*s+S*v+R*T+z*u,t[7]=o*m+S*_+R*w+z*h,o=n[8],S=n[9],R=n[10],z=n[11],t[8]=o*r+S*x+R*l+z*A,t[9]=o*d+S*M+R*y+z*f,t[10]=o*s+S*v+R*T+z*u,t[11]=o*m+S*_+R*w+z*h,o=n[12],S=n[13],R=n[14],z=n[15],t[12]=o*r+S*x+R*l+z*A,t[13]=o*d+S*M+R*y+z*f,t[14]=o*s+S*v+R*T+z*u,t[15]=o*m+S*_+R*w+z*h,t}},{}],101:[function(e,p,g){p.exports=a;function a(t,i,n,r,d,s,m){var x=1/(i-n),M=1/(r-d),v=1/(s-m);return t[0]=-2*x,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*M,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*v,t[11]=0,t[12]=(i+n)*x,t[13]=(d+r)*M,t[14]=(m+s)*v,t[15]=1,t}},{}],102:[function(e,p,g){p.exports=a;function a(t,i,n,r,d){var s=1/Math.tan(i/2),m=1/(r-d);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(d+r)*m,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*d*r*m,t[15]=0,t}},{}],103:[function(e,p,g){p.exports=a;function a(t,i,n,r){var d=r[0],s=r[1],m=r[2],x=Math.sqrt(d*d+s*s+m*m),M,v,_,l,y,T,w,A,f,u,h,o,S,R,z,O,I,F,D,B,U,X,oe,se;return Math.abs(x)<1e-6?null:(x=1/x,d*=x,s*=x,m*=x,M=Math.sin(n),v=Math.cos(n),_=1-v,l=i[0],y=i[1],T=i[2],w=i[3],A=i[4],f=i[5],u=i[6],h=i[7],o=i[8],S=i[9],R=i[10],z=i[11],O=d*d*_+v,I=s*d*_+m*M,F=m*d*_-s*M,D=d*s*_-m*M,B=s*s*_+v,U=m*s*_+d*M,X=d*m*_+s*M,oe=s*m*_-d*M,se=m*m*_+v,t[0]=l*O+A*I+o*F,t[1]=y*O+f*I+S*F,t[2]=T*O+u*I+R*F,t[3]=w*O+h*I+z*F,t[4]=l*D+A*B+o*U,t[5]=y*D+f*B+S*U,t[6]=T*D+u*B+R*U,t[7]=w*D+h*B+z*U,t[8]=l*X+A*oe+o*se,t[9]=y*X+f*oe+S*se,t[10]=T*X+u*oe+R*se,t[11]=w*X+h*oe+z*se,i!==t&&(t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t)}},{}],104:[function(e,p,g){p.exports=a;function a(t,i,n){var r=Math.sin(n),d=Math.cos(n),s=i[4],m=i[5],x=i[6],M=i[7],v=i[8],_=i[9],l=i[10],y=i[11];return i!==t&&(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[4]=s*d+v*r,t[5]=m*d+_*r,t[6]=x*d+l*r,t[7]=M*d+y*r,t[8]=v*d-s*r,t[9]=_*d-m*r,t[10]=l*d-x*r,t[11]=y*d-M*r,t}},{}],105:[function(e,p,g){p.exports=a;function a(t,i,n){var r=Math.sin(n),d=Math.cos(n),s=i[0],m=i[1],x=i[2],M=i[3],v=i[8],_=i[9],l=i[10],y=i[11];return i!==t&&(t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[0]=s*d-v*r,t[1]=m*d-_*r,t[2]=x*d-l*r,t[3]=M*d-y*r,t[8]=s*r+v*d,t[9]=m*r+_*d,t[10]=x*r+l*d,t[11]=M*r+y*d,t}},{}],106:[function(e,p,g){p.exports=a;function a(t,i,n){var r=Math.sin(n),d=Math.cos(n),s=i[0],m=i[1],x=i[2],M=i[3],v=i[4],_=i[5],l=i[6],y=i[7];return i!==t&&(t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[0]=s*d+v*r,t[1]=m*d+_*r,t[2]=x*d+l*r,t[3]=M*d+y*r,t[4]=v*d-s*r,t[5]=_*d-m*r,t[6]=l*d-x*r,t[7]=y*d-M*r,t}},{}],107:[function(e,p,g){p.exports=a;function a(t,i,n){var r=n[0],d=n[1],s=n[2];return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=i[3]*r,t[4]=i[4]*d,t[5]=i[5]*d,t[6]=i[6]*d,t[7]=i[7]*d,t[8]=i[8]*s,t[9]=i[9]*s,t[10]=i[10]*s,t[11]=i[11]*s,t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],t}},{}],108:[function(e,p,g){p.exports=a;function a(t,i,n){var r=n[0],d=n[1],s=n[2],m,x,M,v,_,l,y,T,w,A,f,u;return i===t?(t[12]=i[0]*r+i[4]*d+i[8]*s+i[12],t[13]=i[1]*r+i[5]*d+i[9]*s+i[13],t[14]=i[2]*r+i[6]*d+i[10]*s+i[14],t[15]=i[3]*r+i[7]*d+i[11]*s+i[15]):(m=i[0],x=i[1],M=i[2],v=i[3],_=i[4],l=i[5],y=i[6],T=i[7],w=i[8],A=i[9],f=i[10],u=i[11],t[0]=m,t[1]=x,t[2]=M,t[3]=v,t[4]=_,t[5]=l,t[6]=y,t[7]=T,t[8]=w,t[9]=A,t[10]=f,t[11]=u,t[12]=m*r+_*d+w*s+i[12],t[13]=x*r+l*d+A*s+i[13],t[14]=M*r+y*d+f*s+i[14],t[15]=v*r+T*d+u*s+i[15]),t}},{}],109:[function(e,p,g){p.exports=a;function a(t,i){if(t===i){var n=i[1],r=i[2],d=i[3],s=i[6],m=i[7],x=i[11];t[1]=i[4],t[2]=i[8],t[3]=i[12],t[4]=n,t[6]=i[9],t[7]=i[13],t[8]=r,t[9]=s,t[11]=i[14],t[12]=d,t[13]=m,t[14]=x}else t[0]=i[0],t[1]=i[4],t[2]=i[8],t[3]=i[12],t[4]=i[1],t[5]=i[5],t[6]=i[9],t[7]=i[13],t[8]=i[2],t[9]=i[6],t[10]=i[10],t[11]=i[14],t[12]=i[3],t[13]=i[7],t[14]=i[11],t[15]=i[15];return t}},{}],110:[function(e,p,g){"use strict";var a=e("barycentric"),t=e("polytope-closest-point/lib/closest_point_2d.js");p.exports=s;function i(m,x){for(var M=[0,0,0,0],v=0;v<4;++v)for(var _=0;_<4;++_)M[_]+=m[4*v+_]*x[v];return M}function n(m,x,M,v,_){for(var l=i(v,i(M,i(x,[m[0],m[1],m[2],1]))),y=0;y<3;++y)l[y]/=l[3];return[.5*_[0]*(1+l[0]),.5*_[1]*(1-l[1])]}function r(m,x){if(m.length===2){for(var M=0,v=0,_=0;_<2;++_)M+=Math.pow(x[_]-m[0][_],2),v+=Math.pow(x[_]-m[1][_],2);return M=Math.sqrt(M),v=Math.sqrt(v),M+v<1e-6?[1,0]:[v/(M+v),M/(v+M)]}else if(m.length===3){var l=[0,0];return t(m[0],m[1],m[2],x,l),a(m,l)}return[]}function d(m,x){for(var M=[0,0,0],v=0;v<m.length;++v)for(var _=m[v],l=x[v],y=0;y<3;++y)M[y]+=l*_[y];return M}function s(m,x,M,v,_,l){if(m.length===1)return[0,m[0].slice()];for(var y=new Array(m.length),T=0;T<m.length;++T)y[T]=n(m[T],M,v,_,l);for(var w=0,A=1/0,T=0;T<y.length;++T){for(var f=0,u=0;u<2;++u)f+=Math.pow(y[T][u]-x[u],2);f<A&&(A=f,w=T)}for(var h=r(y,x),o=0,T=0;T<3;++T){if(h[T]<-.001||h[T]>1.0001)return null;o+=h[T]}return Math.abs(o-1)>.001?null:[w,d(m,h),h]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(e,p,g){var a=e("glslify"),t=a([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),i=a([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),n=a([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),r=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),d=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),s=a([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),m=a([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),x=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),M=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),v=a([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),_=a([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);g.meshShader={vertex:t,fragment:i,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},g.wireShader={vertex:n,fragment:r,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},g.pointShader={vertex:d,fragment:s,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},g.pickShader={vertex:m,fragment:x,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},g.pointPickShader={vertex:M,fragment:x,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},g.contourShader={vertex:v,fragment:_,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(e,p,g){"use strict";var a=1e-6,t=1e-6,i=e("gl-shader"),n=e("gl-buffer"),r=e("gl-vao"),d=e("gl-texture2d"),s=e("normals"),m=e("gl-mat4/multiply"),x=e("gl-mat4/invert"),M=e("ndarray"),v=e("colormap"),_=e("simplicial-complex-contour"),l=e("typedarray-pool"),y=e("./lib/shaders"),T=e("./lib/closest-point"),w=y.meshShader,A=y.wireShader,f=y.pointShader,u=y.pickShader,h=y.pointPickShader,o=y.contourShader,S=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function R(K,G,Q,V,H,ee,J,W,re,j,Z,ne,le,ge,pe,xe,Ee,Te,de,be,Le,De,ye,ke,Oe,Qe,Ve){this.gl=K,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=G,this.dirty=!0,this.triShader=Q,this.lineShader=V,this.pointShader=H,this.pickShader=ee,this.pointPickShader=J,this.contourShader=W,this.trianglePositions=re,this.triangleColors=Z,this.triangleNormals=le,this.triangleUVs=ne,this.triangleIds=j,this.triangleVAO=ge,this.triangleCount=0,this.lineWidth=1,this.edgePositions=pe,this.edgeColors=Ee,this.edgeUVs=Te,this.edgeIds=xe,this.edgeVAO=de,this.edgeCount=0,this.pointPositions=be,this.pointColors=De,this.pointUVs=ye,this.pointSizes=ke,this.pointIds=Le,this.pointVAO=Oe,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=Qe,this.contourVAO=Ve,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=S,this._view=S,this._projection=S,this._resolution=[1,1]}var z=R.prototype;z.isOpaque=function(){return!this.hasAlpha},z.isTransparent=function(){return this.hasAlpha},z.pickSlots=1,z.setPickBase=function(K){this.pickId=K};function O(K,G){if(!G||!G.length)return 1;for(var Q=0;Q<G.length;++Q){if(G.length<2)return 1;if(G[Q][0]===K)return G[Q][1];if(G[Q][0]>K&&Q>0){var V=(G[Q][0]-K)/(G[Q][0]-G[Q-1][0]);return G[Q][1]*(1-V)+V*G[Q-1][1]}}return 1}function I(K,G){for(var Q=v({colormap:K,nshades:256,format:"rgba"}),V=new Uint8Array(256*4),H=0;H<256;++H){for(var ee=Q[H],J=0;J<3;++J)V[4*H+J]=ee[J];G?V[4*H+3]=255*O(H/255,G):V[4*H+3]=255*ee[3]}return M(V,[256,256,4],[4,0,1])}function F(K){for(var G=K.length,Q=new Array(G),V=0;V<G;++V)Q[V]=K[V][2];return Q}z.highlight=function(K){if(!K||!this.contourEnable){this.contourCount=0;return}for(var G=_(this.cells,this.intensity,K.intensity),Q=G.cells,V=G.vertexIds,H=G.vertexWeights,ee=Q.length,J=l.mallocFloat32(2*3*ee),W=0,re=0;re<ee;++re)for(var j=Q[re],Z=0;Z<2;++Z){var ne=j[0];j.length===2&&(ne=j[Z]);for(var le=V[ne][0],ge=V[ne][1],pe=H[ne],xe=1-pe,Ee=this.positions[le],Te=this.positions[ge],de=0;de<3;++de)J[W++]=pe*Ee[de]+xe*Te[de]}this.contourCount=W/3|0,this.contourPositions.update(J.subarray(0,W)),l.free(J)},z.update=function(K){K=K||{};var G=this.gl;this.dirty=!0,"contourEnable"in K&&(this.contourEnable=K.contourEnable),"contourColor"in K&&(this.contourColor=K.contourColor),"lineWidth"in K&&(this.lineWidth=K.lineWidth),"lightPosition"in K&&(this.lightPosition=K.lightPosition),this.hasAlpha=!1,"opacity"in K&&(this.opacity=K.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in K&&(this.opacityscale=K.opacityscale,this.hasAlpha=!0),"ambient"in K&&(this.ambientLight=K.ambient),"diffuse"in K&&(this.diffuseLight=K.diffuse),"specular"in K&&(this.specularLight=K.specular),"roughness"in K&&(this.roughness=K.roughness),"fresnel"in K&&(this.fresnel=K.fresnel),K.texture?(this.texture.dispose(),this.texture=d(G,K.texture)):K.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=G.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=G.LINEAR,this.texture.setPixels(I(K.colormap,this.opacityscale)),this.texture.generateMipmap());var Q=K.cells,V=K.positions;if(!V||!Q)return;var H=[],ee=[],J=[],W=[],re=[],j=[],Z=[],ne=[],le=[],ge=[],pe=[],xe=[],Ee=[],Te=[];this.cells=Q,this.positions=V;var de=K.vertexNormals,be=K.cellNormals,Le=K.vertexNormalsEpsilon===void 0?a:K.vertexNormalsEpsilon,De=K.faceNormalsEpsilon===void 0?t:K.faceNormalsEpsilon;K.useFacetNormals&&!be&&(be=s.faceNormals(Q,V,De)),!be&&!de&&(de=s.vertexNormals(Q,V,Le));var ye=K.vertexColors,ke=K.cellColors,Oe=K.meshColor||[1,1,1,1],Qe=K.vertexUVs,Ve=K.vertexIntensity,Ue=K.cellUVs,Ie=K.cellIntensity,at=1/0,pt=-1/0;if(!Qe&&!Ue)if(Ve)if(K.vertexIntensityBounds)at=+K.vertexIntensityBounds[0],pt=+K.vertexIntensityBounds[1];else for(var Rt=0;Rt<Ve.length;++Rt){var Mt=Ve[Rt];at=Math.min(at,Mt),pt=Math.max(pt,Mt)}else if(Ie)if(K.cellIntensityBounds)at=+K.cellIntensityBounds[0],pt=+K.cellIntensityBounds[1];else for(var Rt=0;Rt<Ie.length;++Rt){var Mt=Ie[Rt];at=Math.min(at,Mt),pt=Math.max(pt,Mt)}else for(var Rt=0;Rt<V.length;++Rt){var Mt=V[Rt][2];at=Math.min(at,Mt),pt=Math.max(pt,Mt)}Ve?this.intensity=Ve:Ie?this.intensity=Ie:this.intensity=F(V),this.pickVertex=!(Ie||ke);var It=K.pointSizes,Bt=K.pointSize||1;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(var Rt=0;Rt<V.length;++Rt)for(var St=V[Rt],_t=0;_t<3;++_t)isNaN(St[_t])||!isFinite(St[_t])||(this.bounds[0][_t]=Math.min(this.bounds[0][_t],St[_t]),this.bounds[1][_t]=Math.max(this.bounds[1][_t],St[_t]));var it=0,ct=0,et=0;e:for(var Rt=0;Rt<Q.length;++Rt){var Pe=Q[Rt];switch(Pe.length){case 1:for(var We=Pe[0],St=V[We],_t=0;_t<3;++_t)if(isNaN(St[_t])||!isFinite(St[_t]))continue e;ge.push(St[0],St[1],St[2]);var je;ye?je=ye[We]:ke?je=ke[Rt]:je=Oe,this.opacityscale&&Ve?ee.push(je[0],je[1],je[2],this.opacity*O((Ve[We]-at)/(pt-at),this.opacityscale)):je.length===3?pe.push(je[0],je[1],je[2],this.opacity):(pe.push(je[0],je[1],je[2],je[3]*this.opacity),je[3]<1&&(this.hasAlpha=!0));var nt;Qe?nt=Qe[We]:Ve?nt=[(Ve[We]-at)/(pt-at),0]:Ue?nt=Ue[Rt]:Ie?nt=[(Ie[Rt]-at)/(pt-at),0]:nt=[(St[2]-at)/(pt-at),0],xe.push(nt[0],nt[1]),It?Ee.push(It[We]):Ee.push(Bt),Te.push(Rt),et+=1;break;case 2:for(var _t=0;_t<2;++_t)for(var We=Pe[_t],St=V[We],kt=0;kt<3;++kt)if(isNaN(St[kt])||!isFinite(St[kt]))continue e;for(var _t=0;_t<2;++_t){var We=Pe[_t],St=V[We];j.push(St[0],St[1],St[2]);var je;ye?je=ye[We]:ke?je=ke[Rt]:je=Oe,this.opacityscale&&Ve?ee.push(je[0],je[1],je[2],this.opacity*O((Ve[We]-at)/(pt-at),this.opacityscale)):je.length===3?Z.push(je[0],je[1],je[2],this.opacity):(Z.push(je[0],je[1],je[2],je[3]*this.opacity),je[3]<1&&(this.hasAlpha=!0));var nt;Qe?nt=Qe[We]:Ve?nt=[(Ve[We]-at)/(pt-at),0]:Ue?nt=Ue[Rt]:Ie?nt=[(Ie[Rt]-at)/(pt-at),0]:nt=[(St[2]-at)/(pt-at),0],ne.push(nt[0],nt[1]),le.push(Rt)}ct+=1;break;case 3:for(var _t=0;_t<3;++_t)for(var We=Pe[_t],St=V[We],kt=0;kt<3;++kt)if(isNaN(St[kt])||!isFinite(St[kt]))continue e;for(var _t=0;_t<3;++_t){var We=Pe[2-_t],St=V[We];H.push(St[0],St[1],St[2]);var je;ye?je=ye[We]:ke?je=ke[Rt]:je=Oe,je?this.opacityscale&&Ve?ee.push(je[0],je[1],je[2],this.opacity*O((Ve[We]-at)/(pt-at),this.opacityscale)):je.length===3?ee.push(je[0],je[1],je[2],this.opacity):(ee.push(je[0],je[1],je[2],je[3]*this.opacity),je[3]<1&&(this.hasAlpha=!0)):ee.push(.5,.5,.5,1);var nt;Qe?nt=Qe[We]:Ve?nt=[(Ve[We]-at)/(pt-at),0]:Ue?nt=Ue[Rt]:Ie?nt=[(Ie[Rt]-at)/(pt-at),0]:nt=[(St[2]-at)/(pt-at),0],W.push(nt[0],nt[1]);var wt;de?wt=de[We]:wt=be[Rt],J.push(wt[0],wt[1],wt[2]),re.push(Rt)}it+=1;break;default:break}}this.pointCount=et,this.edgeCount=ct,this.triangleCount=it,this.pointPositions.update(ge),this.pointColors.update(pe),this.pointUVs.update(xe),this.pointSizes.update(Ee),this.pointIds.update(new Uint32Array(Te)),this.edgePositions.update(j),this.edgeColors.update(Z),this.edgeUVs.update(ne),this.edgeIds.update(new Uint32Array(le)),this.trianglePositions.update(H),this.triangleColors.update(ee),this.triangleUVs.update(W),this.triangleNormals.update(J),this.triangleIds.update(new Uint32Array(re))},z.drawTransparent=z.draw=function(K){K=K||{};for(var G=this.gl,Q=K.model||S,V=K.view||S,H=K.projection||S,ee=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],J=0;J<3;++J)ee[0][J]=Math.max(ee[0][J],this.clipBounds[0][J]),ee[1][J]=Math.min(ee[1][J],this.clipBounds[1][J]);var W={model:Q,view:V,projection:H,inverseModel:S.slice(),clipBounds:ee,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};W.inverseModel=x(W.inverseModel,W.model),G.disable(G.CULL_FACE),this.texture.bind(0);var re=new Array(16);m(re,W.view,W.model),m(re,W.projection,re),x(re,re);for(var J=0;J<3;++J)W.eyePosition[J]=re[12+J]/re[15];for(var j=re[15],J=0;J<3;++J)j+=this.lightPosition[J]*re[4*J+3];for(var J=0;J<3;++J){for(var Z=re[12+J],ne=0;ne<3;++ne)Z+=re[4*ne+J]*this.lightPosition[ne];W.lightPosition[J]=Z/j}if(this.triangleCount>0){var le=this.triShader;le.bind(),le.uniforms=W,this.triangleVAO.bind(),G.drawArrays(G.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()}if(this.edgeCount>0&&this.lineWidth>0){var le=this.lineShader;le.bind(),le.uniforms=W,this.edgeVAO.bind(),G.lineWidth(this.lineWidth*this.pixelRatio),G.drawArrays(G.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()}if(this.pointCount>0){var le=this.pointShader;le.bind(),le.uniforms=W,this.pointVAO.bind(),G.drawArrays(G.POINTS,0,this.pointCount),this.pointVAO.unbind()}if(this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0){var le=this.contourShader;le.bind(),le.uniforms=W,this.contourVAO.bind(),G.drawArrays(G.LINES,0,this.contourCount),this.contourVAO.unbind()}},z.drawPick=function(K){K=K||{};for(var G=this.gl,Q=K.model||S,V=K.view||S,H=K.projection||S,ee=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],J=0;J<3;++J)ee[0][J]=Math.max(ee[0][J],this.clipBounds[0][J]),ee[1][J]=Math.min(ee[1][J],this.clipBounds[1][J]);this._model=[].slice.call(Q),this._view=[].slice.call(V),this._projection=[].slice.call(H),this._resolution=[G.drawingBufferWidth,G.drawingBufferHeight];var W={model:Q,view:V,projection:H,clipBounds:ee,pickId:this.pickId/255},re=this.pickShader;if(re.bind(),re.uniforms=W,this.triangleCount>0&&(this.triangleVAO.bind(),G.drawArrays(G.TRIANGLES,0,this.triangleCount*3),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),G.lineWidth(this.lineWidth*this.pixelRatio),G.drawArrays(G.LINES,0,this.edgeCount*2),this.edgeVAO.unbind()),this.pointCount>0){var re=this.pointPickShader;re.bind(),re.uniforms=W,this.pointVAO.bind(),G.drawArrays(G.POINTS,0,this.pointCount),this.pointVAO.unbind()}},z.pick=function(K){if(!K||K.id!==this.pickId)return null;for(var G=K.value[0]+256*K.value[1]+65536*K.value[2],Q=this.cells[G],V=this.positions,H=new Array(Q.length),ee=0;ee<Q.length;++ee)H[ee]=V[Q[ee]];var J=K.coord[0],W=K.coord[1];if(!this.pickVertex){var re=this.positions[Q[0]],j=this.positions[Q[1]],Z=this.positions[Q[2]],ne=[(re[0]+j[0]+Z[0])/3,(re[1]+j[1]+Z[1])/3,(re[2]+j[2]+Z[2])/3];return{_cellCenter:!0,position:[J,W],index:G,cell:Q,cellId:G,intensity:this.intensity[G],dataCoordinate:ne}}var le=T(H,[J*this.pixelRatio,this._resolution[1]-W*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!le)return null;for(var ge=le[2],pe=0,ee=0;ee<Q.length;++ee)pe+=ge[ee]*this.intensity[Q[ee]];return{position:le[1],index:Q[le[0]],cell:Q,cellId:G,intensity:pe,dataCoordinate:this.positions[Q[le[0]]]}},z.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()};function D(K){var G=i(K,w.vertex,w.fragment);return G.attributes.position.location=0,G.attributes.color.location=2,G.attributes.uv.location=3,G.attributes.normal.location=4,G}function B(K){var G=i(K,A.vertex,A.fragment);return G.attributes.position.location=0,G.attributes.color.location=2,G.attributes.uv.location=3,G}function U(K){var G=i(K,f.vertex,f.fragment);return G.attributes.position.location=0,G.attributes.color.location=2,G.attributes.uv.location=3,G.attributes.pointSize.location=4,G}function X(K){var G=i(K,u.vertex,u.fragment);return G.attributes.position.location=0,G.attributes.id.location=1,G}function oe(K){var G=i(K,h.vertex,h.fragment);return G.attributes.position.location=0,G.attributes.id.location=1,G.attributes.pointSize.location=4,G}function se(K){var G=i(K,o.vertex,o.fragment);return G.attributes.position.location=0,G}function q(K,G){arguments.length===1&&(G=K,K=G.gl);var Q=K.getExtension("OES_standard_derivatives")||K.getExtension("MOZ_OES_standard_derivatives")||K.getExtension("WEBKIT_OES_standard_derivatives");if(!Q)throw new Error("derivatives not supported");var V=D(K),H=B(K),ee=U(K),J=X(K),W=oe(K),re=se(K),j=d(K,M(new Uint8Array([255,255,255,255]),[1,1,4]));j.generateMipmap(),j.minFilter=K.LINEAR_MIPMAP_LINEAR,j.magFilter=K.LINEAR;var Z=n(K),ne=n(K),le=n(K),ge=n(K),pe=n(K),xe=r(K,[{buffer:Z,type:K.FLOAT,size:3},{buffer:pe,type:K.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ne,type:K.FLOAT,size:4},{buffer:le,type:K.FLOAT,size:2},{buffer:ge,type:K.FLOAT,size:3}]),Ee=n(K),Te=n(K),de=n(K),be=n(K),Le=r(K,[{buffer:Ee,type:K.FLOAT,size:3},{buffer:be,type:K.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Te,type:K.FLOAT,size:4},{buffer:de,type:K.FLOAT,size:2}]),De=n(K),ye=n(K),ke=n(K),Oe=n(K),Qe=n(K),Ve=r(K,[{buffer:De,type:K.FLOAT,size:3},{buffer:Qe,type:K.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ye,type:K.FLOAT,size:4},{buffer:ke,type:K.FLOAT,size:2},{buffer:Oe,type:K.FLOAT,size:1}]),Ue=n(K),Ie=r(K,[{buffer:Ue,type:K.FLOAT,size:3}]),at=new R(K,j,V,H,ee,J,W,re,Z,pe,ne,le,ge,xe,Ee,be,Te,de,Le,De,Qe,ye,ke,Oe,Ve,Ue,Ie);return at.update(G),at}p.exports=q},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(e,p,g){"use strict";p.exports=d;var a=e("gl-buffer"),t=e("gl-shader"),i=e("./shaders");function n(s,m,x){this.plot=s,this.vbo=m,this.shader=x}var r=n.prototype;r.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},r.drawBox=function(){var s=[0,0],m=[0,0];return function(x,M,v,_,l){var y=this.plot,T=this.shader,w=y.gl;s[0]=x,s[1]=M,m[0]=v,m[1]=_,T.uniforms.lo=s,T.uniforms.hi=m,T.uniforms.color=l,w.drawArrays(w.TRIANGLE_STRIP,0,4)}}(),r.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function d(s){var m=s.gl,x=a(m,[0,0,0,1,1,0,1,1]),M=t(m,i.boxVert,i.lineFrag);return new n(s,x,M)}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(e,p,g){"use strict";p.exports=m;var a=e("gl-buffer"),t=e("gl-shader"),i=e("binary-search-bounds"),n=e("./shaders");function r(x,M,v,_){this.plot=x,this.vbo=M,this.shader=v,this.tickShader=_,this.ticks=[[],[]]}function d(x,M){return x-M}var s=r.prototype;s.draw=function(){var x=[0,0],M=[0,0],v=[0,0];return function(){for(var _=this.plot,l=this.vbo,y=this.shader,T=this.ticks,w=_.gl,A=_._tickBounds,f=_.dataBox,u=_.viewBox,h=_.gridLineWidth,o=_.gridLineColor,S=_.gridLineEnable,R=_.pixelRatio,z=0;z<2;++z){var O=A[z],I=A[z+2],F=I-O,D=.5*(f[z+2]+f[z]),B=f[z+2]-f[z];M[z]=2*F/B,x[z]=2*(O-D)/B}y.bind(),l.bind(),y.attributes.dataCoord.pointer(),y.uniforms.dataShift=x,y.uniforms.dataScale=M;for(var U=0,z=0;z<2;++z){v[0]=v[1]=0,v[z]=1,y.uniforms.dataAxis=v,y.uniforms.lineWidth=h[z]/(u[z+2]-u[z])*R,y.uniforms.color=o[z];var X=T[z].length*6;S[z]&&X&&w.drawArrays(w.TRIANGLES,U,X),U+=X}}}(),s.drawTickMarks=function(){var x=[0,0],M=[0,0],v=[1,0],_=[0,1],l=[0,0],y=[0,0];return function(){for(var T=this.plot,w=this.vbo,A=this.tickShader,f=this.ticks,u=T.gl,h=T._tickBounds,o=T.dataBox,S=T.viewBox,R=T.pixelRatio,z=T.screenBox,O=z[2]-z[0],I=z[3]-z[1],F=S[2]-S[0],D=S[3]-S[1],B=0;B<2;++B){var U=h[B],X=h[B+2],oe=X-U,se=.5*(o[B+2]+o[B]),q=o[B+2]-o[B];M[B]=2*oe/q,x[B]=2*(U-se)/q}M[0]*=F/O,x[0]*=F/O,M[1]*=D/I,x[1]*=D/I,A.bind(),w.bind(),A.attributes.dataCoord.pointer();var K=A.uniforms;K.dataShift=x,K.dataScale=M;var G=T.tickMarkLength,Q=T.tickMarkWidth,V=T.tickMarkColor,H=0,ee=f[0].length*6,J=Math.min(i.ge(f[0],(o[0]-h[0])/(h[2]-h[0]),d),f[0].length),W=Math.min(i.gt(f[0],(o[2]-h[0])/(h[2]-h[0]),d),f[0].length),re=H+6*J,j=6*Math.max(0,W-J),Z=Math.min(i.ge(f[1],(o[1]-h[1])/(h[3]-h[1]),d),f[1].length),ne=Math.min(i.gt(f[1],(o[3]-h[1])/(h[3]-h[1]),d),f[1].length),le=ee+6*Z,ge=6*Math.max(0,ne-Z);l[0]=2*(S[0]-G[1])/O-1,l[1]=(S[3]+S[1])/I-1,y[0]=G[1]*R/O,y[1]=Q[1]*R/I,ge&&(K.color=V[1],K.tickScale=y,K.dataAxis=_,K.screenOffset=l,u.drawArrays(u.TRIANGLES,le,ge)),l[0]=(S[2]+S[0])/O-1,l[1]=2*(S[1]-G[0])/I-1,y[0]=Q[0]*R/O,y[1]=G[0]*R/I,j&&(K.color=V[0],K.tickScale=y,K.dataAxis=v,K.screenOffset=l,u.drawArrays(u.TRIANGLES,re,j)),l[0]=2*(S[2]+G[3])/O-1,l[1]=(S[3]+S[1])/I-1,y[0]=G[3]*R/O,y[1]=Q[3]*R/I,ge&&(K.color=V[3],K.tickScale=y,K.dataAxis=_,K.screenOffset=l,u.drawArrays(u.TRIANGLES,le,ge)),l[0]=(S[2]+S[0])/O-1,l[1]=2*(S[3]+G[2])/I-1,y[0]=Q[2]*R/O,y[1]=G[2]*R/I,j&&(K.color=V[2],K.tickScale=y,K.dataAxis=v,K.screenOffset=l,u.drawArrays(u.TRIANGLES,re,j))}}(),s.update=function(){var x=[1,1,-1,-1,1,-1],M=[1,-1,1,1,-1,-1];return function(v){for(var _=v.ticks,l=v.bounds,y=new Float32Array(6*3*(_[0].length+_[1].length)),T=this.plot.zeroLineEnable,w=0,A=[[],[]],f=0;f<2;++f)for(var u=A[f],h=_[f],o=l[f],S=l[f+2],R=0;R<h.length;++R){var z=(h[R].x-o)/(S-o);u.push(z);for(var O=0;O<6;++O)y[w++]=z,y[w++]=x[O],y[w++]=M[O]}this.ticks=A,this.vbo.update(y)}}(),s.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()};function m(x){var M=x.gl,v=a(M),_=t(M,n.gridVert,n.gridFrag),l=t(M,n.tickVert,n.gridFrag),y=new r(x,v,_,l);return y}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(e,p,g){"use strict";p.exports=d;var a=e("gl-buffer"),t=e("gl-shader"),i=e("./shaders");function n(s,m,x){this.plot=s,this.vbo=m,this.shader=x}var r=n.prototype;r.bind=function(){var s=this.shader;this.vbo.bind(),this.shader.bind(),s.attributes.coord.pointer(),s.uniforms.screenBox=this.plot.screenBox},r.drawLine=function(){var s=[0,0],m=[0,0];return function(x,M,v,_,l,y){var T=this.plot,w=this.shader,A=T.gl;s[0]=x,s[1]=M,m[0]=v,m[1]=_,w.uniforms.start=s,w.uniforms.end=m,w.uniforms.width=l*T.pixelRatio,w.uniforms.color=y,A.drawArrays(A.TRIANGLE_STRIP,0,4)}}(),r.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function d(s){var m=s.gl,x=a(m,[-1,-1,-1,1,1,-1,1,1]),M=t(m,i.lineVert,i.lineFrag),v=new n(s,x,M);return v}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(e,p,g){"use strict";var a=e("glslify"),t=a([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);p.exports={lineVert:a([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:t,textVert:a([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:t,gridVert:a([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:t,boxVert:a([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:a([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:231}],117:[function(e,p,g){"use strict";p.exports=m;var a=e("gl-buffer"),t=e("gl-shader"),i=e("text-cache"),n=e("binary-search-bounds"),r=e("./shaders");function d(x,M,v){this.plot=x,this.vbo=M,this.shader=v,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var s=d.prototype;s.drawTicks=function(){var x=[0,0],M=[0,0],v=[0,0];return function(_){var l=this.plot,y=this.shader,T=this.tickX[_],w=this.tickOffset[_],A=l.gl,f=l.viewBox,u=l.dataBox,h=l.screenBox,o=l.pixelRatio,S=l.tickEnable,R=l.tickPad,z=l.tickColor,O=l.tickAngle,I=l.labelEnable,F=l.labelPad,D=l.labelColor,B=l.labelAngle,U=this.labelOffset[_],X=this.labelCount[_],oe=n.lt(T,u[_]),se=n.le(T,u[_+2]);x[0]=x[1]=0,x[_]=1,M[_]=(f[2+_]+f[_])/(h[2+_]-h[_])-1;var q=2/h[2+(_^1)]-h[_^1];M[_^1]=q*f[_^1]-1,S[_]&&(M[_^1]-=q*o*R[_],oe<se&&w[se]>w[oe]&&(y.uniforms.dataAxis=x,y.uniforms.screenOffset=M,y.uniforms.color=z[_],y.uniforms.angle=O[_],A.drawArrays(A.TRIANGLES,w[oe],w[se]-w[oe]))),I[_]&&X&&(M[_^1]-=q*o*F[_],y.uniforms.dataAxis=v,y.uniforms.screenOffset=M,y.uniforms.color=D[_],y.uniforms.angle=B[_],A.drawArrays(A.TRIANGLES,U,X)),M[_^1]=q*f[2+(_^1)]-1,S[_+2]&&(M[_^1]+=q*o*R[_+2],oe<se&&w[se]>w[oe]&&(y.uniforms.dataAxis=x,y.uniforms.screenOffset=M,y.uniforms.color=z[_+2],y.uniforms.angle=O[_+2],A.drawArrays(A.TRIANGLES,w[oe],w[se]-w[oe]))),I[_+2]&&X&&(M[_^1]+=q*o*F[_+2],y.uniforms.dataAxis=v,y.uniforms.screenOffset=M,y.uniforms.color=D[_+2],y.uniforms.angle=B[_+2],A.drawArrays(A.TRIANGLES,U,X))}}(),s.drawTitle=function(){var x=[0,0],M=[0,0];return function(){var v=this.plot,_=this.shader,l=v.gl,y=v.screenBox,T=v.titleCenter,w=v.titleAngle,A=v.titleColor,f=v.pixelRatio;if(!!this.titleCount){for(var u=0;u<2;++u)M[u]=2*(T[u]*f-y[u])/(y[2+u]-y[u])-1;_.bind(),_.uniforms.dataAxis=x,_.uniforms.screenOffset=M,_.uniforms.angle=w,_.uniforms.color=A,l.drawArrays(l.TRIANGLES,this.titleOffset,this.titleCount)}}}(),s.bind=function(){var x=[0,0],M=[0,0],v=[0,0];return function(){var _=this.plot,l=this.shader,y=_._tickBounds,T=_.dataBox,w=_.screenBox,A=_.viewBox;l.bind();for(var f=0;f<2;++f){var u=y[f],h=y[f+2],o=h-u,S=.5*(T[f+2]+T[f]),R=T[f+2]-T[f],z=A[f],O=A[f+2],I=O-z,F=w[f],D=w[f+2],B=D-F;M[f]=2*o/R*I/B,x[f]=2*(u-S)/R*I/B}v[1]=2*_.pixelRatio/(w[3]-w[1]),v[0]=v[1]*(w[3]-w[1])/(w[2]-w[0]),l.uniforms.dataScale=M,l.uniforms.dataShift=x,l.uniforms.textScale=v,this.vbo.bind(),l.attributes.textCoordinate.pointer()}}(),s.update=function(x){var M=[],v=x.ticks,_=x.bounds,l,y,T,w,A,f;for(f=0;f<2;++f){var u=[Math.floor(M.length/3)],h=[-1/0],o=v[f];for(l=0;l<o.length;++l){var S=o[l],R=S.x,z=S.text,O=S.font||"sans-serif";A=S.fontSize||12;for(var I=1/(_[f+2]-_[f]),F=_[f],D=z.split(`
`),B=0;B<D.length;B++)for(w=i(O,D[B]).data,y=0;y<w.length;y+=2)M.push(w[y]*A,-w[y+1]*A-B*A*1.2,(R-F)*I);u.push(Math.floor(M.length/3)),h.push(R)}this.tickOffset[f]=u,this.tickX[f]=h}for(f=0;f<2;++f){for(this.labelOffset[f]=Math.floor(M.length/3),w=i(x.labelFont[f],x.labels[f],{textAlign:"center"}).data,A=x.labelSize[f],l=0;l<w.length;l+=2)M.push(w[l]*A,-w[l+1]*A,0);this.labelCount[f]=Math.floor(M.length/3)-this.labelOffset[f]}for(this.titleOffset=Math.floor(M.length/3),w=i(x.titleFont,x.title).data,A=x.titleSize,l=0;l<w.length;l+=2)M.push(w[l]*A,-w[l+1]*A,0);this.titleCount=Math.floor(M.length/3)-this.titleOffset,this.vbo.update(M)},s.dispose=function(){this.vbo.dispose(),this.shader.dispose()};function m(x){var M=x.gl,v=a(M),_=t(M,r.textVert,r.textFrag),l=new d(x,v,_);return l}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(e,p,g){"use strict";p.exports=v;var a=e("gl-select-static"),t=e("./lib/grid"),i=e("./lib/text"),n=e("./lib/line"),r=e("./lib/box");function d(_,l){this.gl=_,this.pickBuffer=l,this.screenBox=[0,0,_.drawingBufferWidth,_.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var s=d.prototype;s.setDirty=function(){this.dirty=this.pickDirty=!0},s.setOverlayDirty=function(){this.dirty=!0},s.nextDepthValue=function(){return this._depthCounter++/65536};function m(_,l,y){var T=.5*(y+1);return Math.floor((1-T)*_+T*l)|0}s.draw=function(){var _=[0,0,0,0];return function(){var l=this.gl,y=this.screenBox,T=this.viewBox,w=this.dataBox,A=this.pixelRatio,f=this.grid,u=this.line,h=this.text,o=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),!!this.dirty){if(this.dirty=!1,l.bindFramebuffer(l.FRAMEBUFFER,null),l.enable(l.SCISSOR_TEST),l.disable(l.DEPTH_TEST),l.depthFunc(l.LESS),l.depthMask(!1),l.enable(l.BLEND),l.blendEquation(l.FUNC_ADD,l.FUNC_ADD),l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA),this.borderColor){l.scissor(y[0],y[1],y[2]-y[0],y[3]-y[1]);var S=this.borderColor;l.clearColor(S[0]*S[3],S[1]*S[3],S[2]*S[3],S[3]),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT)}l.scissor(T[0],T[1],T[2]-T[0],T[3]-T[1]),l.viewport(T[0],T[1],T[2]-T[0],T[3]-T[1]);var R=this.backgroundColor;l.clearColor(R[0]*R[3],R[1]*R[3],R[2]*R[3],R[3]),l.clear(l.COLOR_BUFFER_BIT),f.draw();var z=this.zeroLineEnable,O=this.zeroLineColor,I=this.zeroLineWidth;if(z[0]||z[1]){u.bind();for(var F=0;F<2;++F)if(!(!z[F]||!(w[F]<=0&&w[F+2]>=0))){var D=y[F]-w[F]*(y[F+2]-y[F])/(w[F+2]-w[F]);F===0?u.drawLine(D,y[1],D,y[3],I[F],O[F]):u.drawLine(y[0],D,y[2],D,I[F],O[F])}}for(var F=0;F<o.length;++F)o[F].draw();l.viewport(y[0],y[1],y[2]-y[0],y[3]-y[1]),l.scissor(y[0],y[1],y[2]-y[0],y[3]-y[1]),this.grid.drawTickMarks(),u.bind();var B=this.borderLineEnable,U=this.borderLineWidth,X=this.borderLineColor;B[1]&&u.drawLine(T[0],T[1]-.5*U[1]*A,T[0],T[3]+.5*U[3]*A,U[1],X[1]),B[0]&&u.drawLine(T[0]-.5*U[0]*A,T[1],T[2]+.5*U[2]*A,T[1],U[0],X[0]),B[3]&&u.drawLine(T[2],T[1]-.5*U[1]*A,T[2],T[3]+.5*U[3]*A,U[3],X[3]),B[2]&&u.drawLine(T[0]-.5*U[0]*A,T[3],T[2]+.5*U[2]*A,T[3],U[2],X[2]),h.bind();for(var F=0;F<2;++F)h.drawTicks(F);this.titleEnable&&h.drawTitle();for(var oe=this.overlays,F=0;F<oe.length;++F)oe[F].draw();l.disable(l.SCISSOR_TEST),l.disable(l.BLEND),l.depthMask(!0)}}}(),s.drawPick=function(){return function(){if(!this.static){var _=this.pickBuffer,l=this.gl;this._pickTimeout=null,_.begin();for(var y=1,T=this.objects,w=0;w<T.length;++w)y=T[w].drawPick(y);_.end()}}}(),s.pick=function(){return function(_,l){if(!this.static){var y=this.pixelRatio,T=this.pickPixelRatio,w=this.viewBox,A=Math.round((_-w[0]/y)*T)|0,f=Math.round((l-w[1]/y)*T)|0,u=this.pickBuffer.query(A,f,this.pickRadius);if(!u)return null;for(var h=u.id+(u.value[0]<<8)+(u.value[1]<<16)+(u.value[2]<<24),o=this.objects,S=0;S<o.length;++S){var R=o[S].pick(A,f,h);if(R)return R}return null}}}();function x(_){for(var l=_.slice(),y=0;y<l.length;++y)l[y]=l[y].slice();return l}function M(_,l){return _.x-l.x}s.setScreenBox=function(_){var l=this.screenBox,y=this.pixelRatio;l[0]=Math.round(_[0]*y)|0,l[1]=Math.round(_[1]*y)|0,l[2]=Math.round(_[2]*y)|0,l[3]=Math.round(_[3]*y)|0,this.setDirty()},s.setDataBox=function(_){var l=this.dataBox,y=l[0]!==_[0]||l[1]!==_[1]||l[2]!==_[2]||l[3]!==_[3];y&&(l[0]=_[0],l[1]=_[1],l[2]=_[2],l[3]=_[3],this.setDirty())},s.setViewBox=function(_){var l=this.pixelRatio,y=this.viewBox;y[0]=Math.round(_[0]*l)|0,y[1]=Math.round(_[1]*l)|0,y[2]=Math.round(_[2]*l)|0,y[3]=Math.round(_[3]*l)|0;var T=this.pickPixelRatio;this.pickBuffer.shape=[Math.round((_[2]-_[0])*T)|0,Math.round((_[3]-_[1])*T)|0],this.setDirty()},s.update=function(_){_=_||{};var l=this.gl;this.pixelRatio=_.pixelRatio||1;var y=this.pixelRatio;this.pickPixelRatio=Math.max(y,1),this.setScreenBox(_.screenBox||[0,0,l.drawingBufferWidth/y,l.drawingBufferHeight/y]);var T=this.screenBox;this.setViewBox(_.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/y,.125*(this.screenBox[3]-this.screenBox[1])/y,.875*(this.screenBox[2]-this.screenBox[0])/y,.875*(this.screenBox[3]-this.screenBox[1])/y]);var w=this.viewBox,A=(w[2]-w[0])/(w[3]-w[1]);this.setDataBox(_.dataBox||[-10,-10/A,10,10/A]),this.borderColor=_.borderColor!==!1?(_.borderColor||[0,0,0,0]).slice():!1,this.backgroundColor=(_.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(_.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(_.gridLineWidth||[1,1]).slice(),this.gridLineColor=x(_.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(_.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(_.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=x(_.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(_.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(_.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=x(_.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(_.titleCenter||[.5*(w[0]+w[2])/y,(w[3]+120)/y]).slice(),this.titleEnable=!("titleEnable"in _)||!!_.titleEnable,this.titleAngle=_.titleAngle||0,this.titleColor=(_.titleColor||[0,0,0,1]).slice(),this.labelPad=(_.labelPad||[15,15,15,15]).slice(),this.labelAngle=(_.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(_.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=x(_.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(_.tickPad||[15,15,15,15]).slice(),this.tickAngle=(_.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(_.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=x(_.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(_.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(_.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=x(_.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var f=_.ticks||[[],[]],u=this._tickBounds;u[0]=u[1]=1/0,u[2]=u[3]=-1/0;for(var h=0;h<2;++h){var o=f[h].slice(0);o.length!==0&&(o.sort(M),u[h]=Math.min(u[h],o[0].x),u[h+2]=Math.max(u[h+2],o[o.length-1].x))}this.grid.update({bounds:u,ticks:f}),this.text.update({bounds:u,ticks:f,labels:_.labels||["x","y"],labelSize:_.labelSize||[12,12],labelFont:_.labelFont||["sans-serif","sans-serif"],title:_.title||"",titleSize:_.titleSize||18,titleFont:_.titleFont||"sans-serif"}),this.static=!!_.static,this.setDirty()},s.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var _=this.objects.length-1;_>=0;--_)this.objects[_].dispose();this.objects.length=0;for(var _=this.overlays.length-1;_>=0;--_)this.overlays[_].dispose();this.overlays.length=0,this.gl=null},s.addObject=function(_){this.objects.indexOf(_)<0&&(this.objects.push(_),this.setDirty())},s.removeObject=function(_){for(var l=this.objects,y=0;y<l.length;++y)if(l[y]===_){l.splice(y,1),this.setDirty();break}},s.addOverlay=function(_){this.overlays.indexOf(_)<0&&(this.overlays.push(_),this.setOverlayDirty())},s.removeOverlay=function(_){for(var l=this.overlays,y=0;y<l.length;++y)if(l[y]===_){l.splice(y,1),this.setOverlayDirty();break}};function v(_){var l=_.gl,y=a(l,[l.drawingBufferWidth,l.drawingBufferHeight]),T=new d(l,y);return T.grid=t(T),T.text=i(T),T.line=n(T),T.box=r(T),T.update(_),T}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(e,p,g){"use strict";p.exports=s;var a=e("right-now"),t=e("3d-view"),i=e("mouse-change"),n=e("mouse-wheel"),r=e("mouse-event-offset"),d=e("has-passive-events");function s(m,x){m=m||document.body,x=x||{};var M=[.01,1/0];"distanceLimits"in x&&(M[0]=x.distanceLimits[0],M[1]=x.distanceLimits[1]),"zoomMin"in x&&(M[0]=x.zoomMin),"zoomMax"in x&&(M[1]=x.zoomMax);var v=t({center:x.center||[0,0,0],up:x.up||[0,1,0],eye:x.eye||[0,0,10],mode:x.mode||"orbit",distanceLimits:M}),_=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=0,y=m.clientWidth,T=m.clientHeight,w={keyBindingMode:"rotate",enableWheel:!0,view:v,element:m,delay:x.delay||16,rotateSpeed:x.rotateSpeed||1,zoomSpeed:x.zoomSpeed||1,translateSpeed:x.translateSpeed||1,flipX:!!x.flipX,flipY:!!x.flipY,modes:v.modes,_ortho:x._ortho||x.projection&&x.projection.type==="orthographic"||!1,tick:function(){var A=a(),f=this.delay,u=A-2*f;v.idle(A-f),v.recalcMatrix(u),v.flush(A-(100+f*2));for(var h=!0,o=v.computedMatrix,S=0;S<16;++S)h=h&&_[S]===o[S],_[S]=o[S];var R=m.clientWidth===y&&m.clientHeight===T;return y=m.clientWidth,T=m.clientHeight,h?!R:(l=Math.exp(v.computedRadius[0]),!0)},lookAt:function(A,f,u){v.lookAt(v.lastT(),A,f,u)},rotate:function(A,f,u){v.rotate(v.lastT(),A,f,u)},pan:function(A,f,u){v.pan(v.lastT(),A,f,u)},translate:function(A,f,u){v.translate(v.lastT(),A,f,u)}};return Object.defineProperties(w,{matrix:{get:function(){return v.computedMatrix},set:function(A){return v.setMatrix(v.lastT(),A),v.computedMatrix},enumerable:!0},mode:{get:function(){return v.getMode()},set:function(A){var f=v.computedUp.slice(),u=v.computedEye.slice(),h=v.computedCenter.slice();if(v.setMode(A),A==="turntable"){var o=a();v._active.lookAt(o,u,h,f),v._active.lookAt(o+500,u,h,[0,0,1]),v._active.flush(o)}return v.getMode()},enumerable:!0},center:{get:function(){return v.computedCenter},set:function(A){return v.lookAt(v.lastT(),null,A),v.computedCenter},enumerable:!0},eye:{get:function(){return v.computedEye},set:function(A){return v.lookAt(v.lastT(),A),v.computedEye},enumerable:!0},up:{get:function(){return v.computedUp},set:function(A){return v.lookAt(v.lastT(),null,null,A),v.computedUp},enumerable:!0},distance:{get:function(){return l},set:function(A){return v.setDistance(v.lastT(),A),A},enumerable:!0},distanceLimits:{get:function(){return v.getDistanceLimits(M)},set:function(A){return v.setDistanceLimits(A),A},enumerable:!0}}),m.addEventListener("contextmenu",function(A){return A.preventDefault(),!1}),w._lastX=-1,w._lastY=-1,w._lastMods={shift:!1,control:!1,alt:!1,meta:!1},w.enableMouseListeners=function(){w.mouseListener=i(m,A),m.addEventListener("touchstart",function(f){var u=r(f.changedTouches[0],m);A(0,u[0],u[1],w._lastMods),A(1,u[0],u[1],w._lastMods)},d?{passive:!0}:!1),m.addEventListener("touchmove",function(f){var u=r(f.changedTouches[0],m);A(1,u[0],u[1],w._lastMods),f.preventDefault()},d?{passive:!1}:!1),m.addEventListener("touchend",function(f){A(0,w._lastX,w._lastY,w._lastMods)},d?{passive:!0}:!1);function A(f,u,h,o){var S=w.keyBindingMode;if(S!==!1){var R=S==="rotate",z=S==="pan",O=S==="zoom",I=!!o.control,F=!!o.alt,D=!!o.shift,B=!!(f&1),U=!!(f&2),X=!!(f&4),oe=1/m.clientHeight,se=oe*(u-w._lastX),q=oe*(h-w._lastY),K=w.flipX?1:-1,G=w.flipY?1:-1,Q=Math.PI*w.rotateSpeed,V=a();if(w._lastX!==-1&&w._lastY!==-1&&((R&&B&&!I&&!F&&!D||B&&!I&&!F&&D)&&v.rotate(V,K*Q*se,-G*Q*q,0),(z&&B&&!I&&!F&&!D||U||B&&I&&!F&&!D)&&v.pan(V,-w.translateSpeed*se*l,w.translateSpeed*q*l,0),O&&B&&!I&&!F&&!D||X||B&&!I&&F&&!D)){var H=-w.zoomSpeed*q/window.innerHeight*(V-v.lastT())*100;v.pan(V,0,0,l*(Math.exp(H)-1))}return w._lastX=u,w._lastY=h,w._lastMods=o,!0}}w.wheelListener=n(m,function(f,u){if(w.keyBindingMode!==!1&&!!w.enableWheel){var h=w.flipX?1:-1,o=w.flipY?1:-1,S=a();if(Math.abs(f)>Math.abs(u))v.rotate(S,0,0,-f*h*Math.PI*w.rotateSpeed/window.innerWidth);else if(!w._ortho){var R=-w.zoomSpeed*o*u/window.innerHeight*(S-v.lastT())/20;v.pan(S,0,0,l*(Math.exp(R)-1))}}},!0)},w.enableMouseListeners(),w}},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(e,p,g){var a=e("glslify"),t=e("gl-shader"),i=a([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),n=a([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);p.exports=function(r){return t(r,i,n,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(e,p,g){"use strict";var a=e("./camera.js"),t=e("gl-axes3d"),i=e("gl-axes3d/properties"),n=e("gl-spikes3d"),r=e("gl-select-static"),d=e("gl-fbo"),s=e("a-big-triangle"),m=e("mouse-change"),x=e("gl-mat4/perspective"),M=e("gl-mat4/ortho"),v=e("./lib/shader"),_=e("is-mobile")({tablet:!0,featureDetect:!0});p.exports={createScene:A,createCamera:a};function l(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function y(u,h){var o=null;try{o=u.getContext("webgl",h),o||(o=u.getContext("experimental-webgl",h))}catch{return null}return o}function T(u){var h=Math.round(Math.log(Math.abs(u))/Math.log(10));if(h<0){var o=Math.round(Math.pow(10,-h));return Math.ceil(u*o)/o}else if(h>0){var o=Math.round(Math.pow(10,h));return Math.ceil(u/o)*o}return Math.ceil(u)}function w(u){return typeof u=="boolean"?u:!0}function A(u){u=u||{},u.camera=u.camera||{};var h=u.canvas;if(!h)if(h=document.createElement("canvas"),u.container){var o=u.container;o.appendChild(h)}else document.body.appendChild(h);var S=u.gl;if(S||(u.glOptions&&(_=!!u.glOptions.preserveDrawingBuffer),S=y(h,u.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:_})),!S)throw new Error("webgl not supported");var R=u.bounds||[[-10,-10,-10],[10,10,10]],z=new l,O=d(S,S.drawingBufferWidth,S.drawingBufferHeight,{preferFloat:!_}),I=v(S),F=u.cameraObject&&u.cameraObject._ortho===!0||u.camera.projection&&u.camera.projection.type==="orthographic"||!1,D={eye:u.camera.eye||[2,0,0],center:u.camera.center||[0,0,0],up:u.camera.up||[0,1,0],zoomMin:u.camera.zoomMax||.1,zoomMax:u.camera.zoomMin||100,mode:u.camera.mode||"turntable",_ortho:F},B=u.axes||{},U=t(S,B);U.enable=!B.disable;var X=u.spikes||{},oe=n(S,X),se=[],q=[],K=[],G=[],Q=!0,J=!0,V=new Array(16),H=new Array(16),ee={view:null,projection:V,model:H,_ortho:!1},J=!0,W=[S.drawingBufferWidth,S.drawingBufferHeight],re=u.cameraObject||a(h,D),j={gl:S,contextLost:!1,pixelRatio:u.pixelRatio||1,canvas:h,selection:z,camera:re,axes:U,axesPixels:null,spikes:oe,bounds:R,objects:se,shape:W,aspect:u.aspectRatio||[1,1,1],pickRadius:u.pickRadius||10,zNear:u.zNear||.01,zFar:u.zFar||1e3,fovy:u.fovy||Math.PI/4,clearColor:u.clearColor||[0,0,0,0],autoResize:w(u.autoResize),autoBounds:w(u.autoBounds),autoScale:!!u.autoScale,autoCenter:w(u.autoCenter),clipToBounds:w(u.clipToBounds),snapToData:!!u.snapToData,onselect:u.onselect||null,onrender:u.onrender||null,onclick:u.onclick||null,cameraParams:ee,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(be){this.aspect[0]=be.x,this.aspect[1]=be.y,this.aspect[2]=be.z,J=!0},setBounds:function(be,Le){this.bounds[0][be]=Le.min,this.bounds[1][be]=Le.max},setClearColor:function(be){this.clearColor=be},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},Z=[S.drawingBufferWidth/j.pixelRatio|0,S.drawingBufferHeight/j.pixelRatio|0];function ne(){if(!j._stopped&&!!j.autoResize){var be=h.parentNode,Le=1,De=1;be&&be!==document.body?(Le=be.clientWidth,De=be.clientHeight):(Le=window.innerWidth,De=window.innerHeight);var ye=Math.ceil(Le*j.pixelRatio)|0,ke=Math.ceil(De*j.pixelRatio)|0;if(ye!==h.width||ke!==h.height){h.width=ye,h.height=ke;var Oe=h.style;Oe.position=Oe.position||"absolute",Oe.left="0px",Oe.top="0px",Oe.width=Le+"px",Oe.height=De+"px",Q=!0}}}j.autoResize&&ne(),window.addEventListener("resize",ne);function le(){for(var be=se.length,Le=G.length,De=0;De<Le;++De)K[De]=0;e:for(var De=0;De<be;++De){var ye=se[De],ke=ye.pickSlots;if(!ke){q[De]=-1;continue}for(var Oe=0;Oe<Le;++Oe)if(K[Oe]+ke<255){q[De]=Oe,ye.setPickBase(K[Oe]+1),K[Oe]+=ke;continue e}var Qe=r(S,W);q[De]=Le,G.push(Qe),K.push(ke),ye.setPickBase(1),Le+=1}for(;Le>0&&K[Le-1]===0;)K.pop(),G.pop().dispose()}j.update=function(be){j._stopped||(be=be||{},Q=!0,J=!0)},j.add=function(be){j._stopped||(be.axes=U,se.push(be),q.push(-1),Q=!0,J=!0,le())},j.remove=function(be){if(!j._stopped){var Le=se.indexOf(be);Le<0||(se.splice(Le,1),q.pop(),Q=!0,J=!0,le())}},j.dispose=function(){if(!j._stopped&&(j._stopped=!0,window.removeEventListener("resize",ne),h.removeEventListener("webglcontextlost",ge),j.mouseListener.enabled=!1,!j.contextLost)){U.dispose(),oe.dispose();for(var be=0;be<se.length;++be)se[be].dispose();O.dispose();for(var be=0;be<G.length;++be)G[be].dispose();I.dispose(),S=null,U=null,oe=null,se=[]}},j._mouseRotating=!1,j._prevButtons=0,j.enableMouseListeners=function(){j.mouseListener=m(h,function(be,Le,De){if(!j._stopped){var ye=G.length,ke=se.length,Oe=z.object;z.distance=1/0,z.mouse[0]=Le,z.mouse[1]=De,z.object=null,z.screen=null,z.dataCoordinate=z.dataPosition=null;var Qe=!1;if(be&&j._prevButtons)j._mouseRotating=!0;else{j._mouseRotating&&(J=!0),j._mouseRotating=!1;for(var Ve=0;Ve<ye;++Ve){var Ue=G[Ve].query(Le,Z[1]-De-1,j.pickRadius);if(Ue){if(Ue.distance>z.distance)continue;for(var Ie=0;Ie<ke;++Ie){var at=se[Ie];if(q[Ie]===Ve){var pt=at.pick(Ue);pt&&(z.buttons=be,z.screen=Ue.coord,z.distance=Ue.distance,z.object=at,z.index=pt.distance,z.dataPosition=pt.position,z.dataCoordinate=pt.dataCoordinate,z.data=pt,Qe=!0)}}}}}Oe&&Oe!==z.object&&(Oe.highlight&&Oe.highlight(null),Q=!0),z.object&&(z.object.highlight&&z.object.highlight(z.data),Q=!0),Qe=Qe||z.object!==Oe,Qe&&j.onselect&&j.onselect(z),be&1&&!(j._prevButtons&1)&&j.onclick&&j.onclick(z),j._prevButtons=be}})};function ge(){if(j.contextLost)return!0;S.isContextLost()&&(j.contextLost=!0,j.mouseListener.enabled=!1,j.selection.object=null,j.oncontextloss&&j.oncontextloss())}h.addEventListener("webglcontextlost",ge);function pe(){if(!ge()){S.colorMask(!0,!0,!0,!0),S.depthMask(!0),S.disable(S.BLEND),S.enable(S.DEPTH_TEST),S.depthFunc(S.LEQUAL);for(var be=se.length,Le=G.length,De=0;De<Le;++De){var ye=G[De];ye.shape=Z,ye.begin();for(var ke=0;ke<be;++ke)if(q[ke]===De){var Oe=se[ke];Oe.drawPick&&(Oe.pixelRatio=1,Oe.drawPick(ee))}ye.end()}}}var xe=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Ee=[xe[0].slice(),xe[1].slice()];function Te(){if(!ge()){ne();var be=j.camera.tick();ee.view=j.camera.matrix,Q=Q||be,J=J||be,U.pixelRatio=j.pixelRatio,oe.pixelRatio=j.pixelRatio;var Le=se.length,De=xe[0],ye=xe[1];De[0]=De[1]=De[2]=1/0,ye[0]=ye[1]=ye[2]=-1/0;for(var ke=0;ke<Le;++ke){var Oe=se[ke];Oe.pixelRatio=j.pixelRatio,Oe.axes=j.axes,Q=Q||!!Oe.dirty,J=J||!!Oe.dirty;var Qe=Oe.bounds;if(Qe)for(var Ve=Qe[0],Ue=Qe[1],Ie=0;Ie<3;++Ie)De[Ie]=Math.min(De[Ie],Ve[Ie]),ye[Ie]=Math.max(ye[Ie],Ue[Ie])}var at=j.bounds;if(j.autoBounds)for(var Ie=0;Ie<3;++Ie){if(ye[Ie]<De[Ie])De[Ie]=-1,ye[Ie]=1;else{De[Ie]===ye[Ie]&&(De[Ie]-=1,ye[Ie]+=1);var pt=.05*(ye[Ie]-De[Ie]);De[Ie]=De[Ie]-pt,ye[Ie]=ye[Ie]+pt}at[0][Ie]=De[Ie],at[1][Ie]=ye[Ie]}for(var Rt=!1,Ie=0;Ie<3;++Ie)Rt=Rt||Ee[0][Ie]!==at[0][Ie]||Ee[1][Ie]!==at[1][Ie],Ee[0][Ie]=at[0][Ie],Ee[1][Ie]=at[1][Ie];if(J=J||Rt,Q=Q||Rt,!!Q){if(Rt){for(var Mt=[0,0,0],ke=0;ke<3;++ke)Mt[ke]=T((at[1][ke]-at[0][ke])/10);U.autoTicks?U.update({bounds:at,tickSpacing:Mt}):U.update({bounds:at})}var It=S.drawingBufferWidth,Bt=S.drawingBufferHeight;W[0]=It,W[1]=Bt,Z[0]=Math.max(It/j.pixelRatio,1)|0,Z[1]=Math.max(Bt/j.pixelRatio,1)|0,f(j,F);for(var ke=0;ke<Le;++ke){var Oe=se[ke];Oe.axesBounds=at,j.clipToBounds&&(Oe.clipBounds=at)}z.object&&(j.snapToData?oe.position=z.dataCoordinate:oe.position=z.dataPosition,oe.bounds=at),J&&(J=!1,pe()),j.axesPixels=i(j.axes,ee,It,Bt),j.onrender&&j.onrender(),S.bindFramebuffer(S.FRAMEBUFFER,null),S.viewport(0,0,It,Bt),j.clearRGBA(),S.depthMask(!0),S.colorMask(!0,!0,!0,!0),S.enable(S.DEPTH_TEST),S.depthFunc(S.LEQUAL),S.disable(S.BLEND),S.disable(S.CULL_FACE);var St=!1;U.enable&&(St=St||U.isTransparent(),U.draw(ee)),oe.axes=U,z.object&&oe.draw(ee),S.disable(S.CULL_FACE);for(var ke=0;ke<Le;++ke){var Oe=se[ke];Oe.axes=U,Oe.pixelRatio=j.pixelRatio,Oe.isOpaque&&Oe.isOpaque()&&Oe.draw(ee),Oe.isTransparent&&Oe.isTransparent()&&(St=!0)}if(St){O.shape=W,O.bind(),S.clear(S.DEPTH_BUFFER_BIT),S.colorMask(!1,!1,!1,!1),S.depthMask(!0),S.depthFunc(S.LESS),U.enable&&U.isTransparent()&&U.drawTransparent(ee);for(var ke=0;ke<Le;++ke){var Oe=se[ke];Oe.isOpaque&&Oe.isOpaque()&&Oe.draw(ee)}S.enable(S.BLEND),S.blendEquation(S.FUNC_ADD),S.blendFunc(S.ONE,S.ONE_MINUS_SRC_ALPHA),S.colorMask(!0,!0,!0,!0),S.depthMask(!1),S.clearColor(0,0,0,0),S.clear(S.COLOR_BUFFER_BIT),U.isTransparent()&&U.drawTransparent(ee);for(var ke=0;ke<Le;++ke){var Oe=se[ke];Oe.isTransparent&&Oe.isTransparent()&&Oe.drawTransparent(ee)}S.bindFramebuffer(S.FRAMEBUFFER,null),S.blendFunc(S.ONE,S.ONE_MINUS_SRC_ALPHA),S.disable(S.DEPTH_TEST),I.bind(),O.color[0].bind(0),I.uniforms.accumBuffer=0,s(S),S.disable(S.BLEND)}Q=!1;for(var ke=0;ke<Le;++ke)se[ke].dirty=!1}}}function de(){j._stopped||j.contextLost||(Te(),requestAnimationFrame(de))}return j.enableMouseListeners(),de(),j.redraw=function(){j._stopped||(Q=!0,Te())},j}function f(u,h){var o=u.bounds,S=u.cameraParams,R=S.projection,z=S.model,O=u.gl.drawingBufferWidth,I=u.gl.drawingBufferHeight,F=u.zNear,D=u.zFar,B=u.fovy,U=O/I;h?(M(R,-U,U,-1,1,F,D),S._ortho=!0):(x(R,B,U,F,D),S._ortho=!1);for(var X=0;X<16;++X)z[X]=0;z[15]=1;for(var oe=0,X=0;X<3;++X)oe=Math.max(oe,o[1][X]-o[0][X]);for(var X=0;X<3;++X)u.autoScale?z[5*X]=u.aspect[X]/(o[1][X]-o[0][X]):z[5*X]=1/oe,u.autoCenter&&(z[12+X]=-z[5*X]*.5*(o[0][X]+o[1][X]))}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(e,p,g){var a=e("glslify");g.pointVertex=a([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),g.pointFragment=a([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),g.pickVertex=a([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),g.pickFragment=a([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:231}],123:[function(e,p,g){"use strict";var a=e("gl-shader"),t=e("gl-buffer"),i=e("typedarray-pool"),n=e("./lib/shader");p.exports=m;function r(x,M,v,_,l){this.plot=x,this.offsetBuffer=M,this.pickBuffer=v,this.shader=_,this.pickShader=l,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}var d=r.prototype;d.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},d.update=function(x){var M;x=x||{};function v(f,u){return f in x?x[f]:u}this.sizeMin=v("sizeMin",.5),this.sizeMax=v("sizeMax",20),this.color=v("color",[1,0,0,1]).slice(),this.areaRatio=v("areaRatio",1),this.borderColor=v("borderColor",[0,0,0,1]).slice(),this.blend=v("blend",!1);var _=x.positions.length>>>1,l=x.positions instanceof Float32Array,y=x.idToIndex instanceof Int32Array&&x.idToIndex.length>=_,T=x.positions,w=l?T:i.mallocFloat32(T.length),A=y?x.idToIndex:i.mallocInt32(_);if(l||w.set(T),!y)for(w.set(T),M=0;M<_;M++)A[M]=M;this.points=T,this.offsetBuffer.update(w),this.pickBuffer.update(A),l||i.free(w),y||i.free(A),this.pointCount=_,this.pickOffset=0};function s(x,M){var v=0,_=x.length>>>1,l;for(l=0;l<_;l++){var y=x[l*2],T=x[l*2+1];y>=M[0]&&y<=M[2]&&T>=M[1]&&T<=M[3]&&v++}return v}d.unifiedDraw=function(){var x=[1,0,0,0,1,0,0,0,1],M=[0,0,0,0];return function(v){var _=v!==void 0,l=_?this.pickShader:this.shader,y=this.plot.gl,T=this.plot.dataBox;if(this.pointCount===0)return v;var w=T[2]-T[0],A=T[3]-T[1],f=s(this.points,T),u=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(f,.33333)));x[0]=2/w,x[4]=2/A,x[6]=-2*T[0]/w-1,x[7]=-2*T[1]/A-1,this.offsetBuffer.bind(),l.bind(),l.attributes.position.pointer(),l.uniforms.matrix=x,l.uniforms.color=this.color,l.uniforms.borderColor=this.borderColor,l.uniforms.pointCloud=u<5,l.uniforms.pointSize=u,l.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),_&&(M[0]=v&255,M[1]=v>>8&255,M[2]=v>>16&255,M[3]=v>>24&255,this.pickBuffer.bind(),l.attributes.pickId.pointer(y.UNSIGNED_BYTE),l.uniforms.pickOffset=M,this.pickOffset=v);var h=y.getParameter(y.BLEND),o=y.getParameter(y.DITHER);return h&&!this.blend&&y.disable(y.BLEND),o&&y.disable(y.DITHER),y.drawArrays(y.POINTS,0,this.pointCount),h&&!this.blend&&y.enable(y.BLEND),o&&y.enable(y.DITHER),v+this.pointCount}}(),d.draw=d.unifiedDraw,d.drawPick=d.unifiedDraw,d.pick=function(x,M,v){var _=this.pickOffset,l=this.pointCount;if(v<_||v>=_+l)return null;var y=v-_,T=this.points;return{object:this,pointId:y,dataCoord:[T[2*y],T[2*y+1]]}};function m(x,M){var v=x.gl,_=t(v),l=t(v),y=a(v,n.pointVertex,n.pointFragment),T=a(v,n.pickVertex,n.pickFragment),w=new r(x,_,l,y,T);return w.update(M),x.addObject(w),w}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(e,p,g){p.exports=a;function a(t,i,n,r){var d=i[0],s=i[1],m=i[2],x=i[3],M=n[0],v=n[1],_=n[2],l=n[3],y,T,w,A,f;return T=d*M+s*v+m*_+x*l,T<0&&(T=-T,M=-M,v=-v,_=-_,l=-l),1-T>1e-6?(y=Math.acos(T),w=Math.sin(y),A=Math.sin((1-r)*y)/w,f=Math.sin(r*y)/w):(A=1-r,f=r),t[0]=A*d+f*M,t[1]=A*s+f*v,t[2]=A*m+f*_,t[3]=A*x+f*l,t}},{}],125:[function(e,p,g){"use strict";p.exports=function(a){return!a&&a!==0?"":a.toString()}},{}],126:[function(e,p,g){"use strict";var a=e("vectorize-text");p.exports=i;var t={};function i(n,r,d){var s=t[r];if(s||(s=t[r]={}),n in s)return s[n];var m={textAlign:"center",textBaseline:"middle",lineHeight:1,font:r,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}};m.triangles=!0;var x=a(n,m);m.triangles=!1;var M=a(n,m),v,_;if(d&&d!==1){for(v=0;v<x.positions.length;++v)for(_=0;_<x.positions[v].length;++_)x.positions[v][_]/=d;for(v=0;v<M.positions.length;++v)for(_=0;_<M.positions[v].length;++_)M.positions[v][_]/=d}var l=[[1/0,1/0],[-1/0,-1/0]],y=M.positions.length;for(v=0;v<y;++v){var T=M.positions[v];for(_=0;_<2;++_)l[0][_]=Math.min(l[0][_],T[_]),l[1][_]=Math.max(l[1][_],T[_])}return s[n]=[x,M,l]}},{"vectorize-text":311}],127:[function(e,p,g){var a=e("gl-shader"),t=e("glslify"),i=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),n=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),r=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),d=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),s=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),m=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],x={vertex:i,fragment:d,attributes:m},M={vertex:n,fragment:d,attributes:m},v={vertex:r,fragment:d,attributes:m},_={vertex:i,fragment:s,attributes:m},l={vertex:n,fragment:s,attributes:m},y={vertex:r,fragment:s,attributes:m};function T(w,A){var f=a(w,A),u=f.attributes;return u.position.location=0,u.color.location=1,u.glyph.location=2,u.id.location=3,f}g.createPerspective=function(w){return T(w,x)},g.createOrtho=function(w){return T(w,M)},g.createProject=function(w){return T(w,v)},g.createPickPerspective=function(w){return T(w,_)},g.createPickOrtho=function(w){return T(w,l)},g.createPickProject=function(w){return T(w,y)}},{"gl-shader":132,glslify:231}],128:[function(e,p,g){"use strict";var a=e("is-string-blank"),t=e("gl-buffer"),i=e("gl-vao"),n=e("typedarray-pool"),r=e("gl-mat4/multiply"),d=e("./lib/shaders"),s=e("./lib/glyphs"),m=e("./lib/get-simple-string"),x=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];p.exports=q;function M(K,G){var Q=K[0],V=K[1],H=K[2],ee=K[3];return K[0]=G[0]*Q+G[4]*V+G[8]*H+G[12]*ee,K[1]=G[1]*Q+G[5]*V+G[9]*H+G[13]*ee,K[2]=G[2]*Q+G[6]*V+G[10]*H+G[14]*ee,K[3]=G[3]*Q+G[7]*V+G[11]*H+G[15]*ee,K}function v(K,G,Q,V){return M(V,V,Q),M(V,V,G),M(V,V,K)}function _(K,G){this.index=K,this.dataCoordinate=this.position=G}function l(K){return K===!0||K>1?1:K}function y(K,G,Q,V,H,ee,J,W,re,j,Z,ne){this.gl=K,this.pixelRatio=1,this.shader=G,this.orthoShader=Q,this.projectShader=V,this.pointBuffer=H,this.colorBuffer=ee,this.glyphBuffer=J,this.idBuffer=W,this.vao=re,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=j,this.pickOrthoShader=Z,this.pickProjectShader=ne,this.points=[],this._selectResult=new _(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}var T=y.prototype;T.pickSlots=1,T.setPickBase=function(K){this.pickId=K},T.isTransparent=function(){if(this.hasAlpha)return!0;for(var K=0;K<3;++K)if(this.axesProject[K]&&this.projectHasAlpha)return!0;return!1},T.isOpaque=function(){if(!this.hasAlpha)return!0;for(var K=0;K<3;++K)if(this.axesProject[K]&&!this.projectHasAlpha)return!0;return!1};var w=[0,0],A=[0,0,0],f=[0,0,0],u=[0,0,0,1],h=[0,0,0,1],o=x.slice(),S=[0,0,0],R=[[0,0,0],[0,0,0]];function z(K){return K[0]=K[1]=K[2]=0,K}function O(K,G){return K[0]=G[0],K[1]=G[1],K[2]=G[2],K[3]=1,K}function I(K,G,Q,V){return K[0]=G[0],K[1]=G[1],K[2]=G[2],K[Q]=V,K}function F(K){for(var G=R,Q=0;Q<2;++Q)for(var V=0;V<3;++V)G[Q][V]=Math.max(Math.min(K[Q][V],1e8),-1e8);return G}function D(K,G,Q,V){var H=G.axesProject,ee=G.gl,J=K.uniforms,W=Q.model||x,re=Q.view||x,j=Q.projection||x,Z=G.axesBounds,ne=F(G.clipBounds),le;G.axes&&G.axes.lastCubeProps?le=G.axes.lastCubeProps.axis:le=[1,1,1],w[0]=2/ee.drawingBufferWidth,w[1]=2/ee.drawingBufferHeight,K.bind(),J.view=re,J.projection=j,J.screenSize=w,J.highlightId=G.highlightId,J.highlightScale=G.highlightScale,J.clipBounds=ne,J.pickGroup=G.pickId/255,J.pixelRatio=V;for(var ge=0;ge<3;++ge)if(!!H[ge]){J.scale=G.projectScale[ge],J.opacity=G.projectOpacity[ge];for(var pe=o,xe=0;xe<16;++xe)pe[xe]=0;for(var xe=0;xe<4;++xe)pe[5*xe]=1;pe[5*ge]=0,le[ge]<0?pe[12+ge]=Z[0][ge]:pe[12+ge]=Z[1][ge],r(pe,W,pe),J.model=pe;var Ee=(ge+1)%3,Te=(ge+2)%3,de=z(A),be=z(f);de[Ee]=1,be[Te]=1;var Le=v(j,re,W,O(u,de)),De=v(j,re,W,O(h,be));if(Math.abs(Le[1])>Math.abs(De[1])){var ye=Le;Le=De,De=ye,ye=de,de=be,be=ye;var ke=Ee;Ee=Te,Te=ke}Le[0]<0&&(de[Ee]=-1),De[1]>0&&(be[Te]=-1);for(var Oe=0,Qe=0,xe=0;xe<4;++xe)Oe+=Math.pow(W[4*Ee+xe],2),Qe+=Math.pow(W[4*Te+xe],2);de[Ee]/=Math.sqrt(Oe),be[Te]/=Math.sqrt(Qe),J.axes[0]=de,J.axes[1]=be,J.fragClipBounds[0]=I(S,ne[0],ge,-1e8),J.fragClipBounds[1]=I(S,ne[1],ge,1e8),G.vao.bind(),G.vao.draw(ee.TRIANGLES,G.vertexCount),G.lineWidth>0&&(ee.lineWidth(G.lineWidth*V),G.vao.draw(ee.LINES,G.lineVertexCount,G.vertexCount)),G.vao.unbind()}}var B=[-1e8,-1e8,-1e8],U=[1e8,1e8,1e8],X=[B,U];function oe(K,G,Q,V,H,ee,J){var W=Q.gl;if((ee===Q.projectHasAlpha||J)&&D(G,Q,V,H),ee===Q.hasAlpha||J){K.bind();var re=K.uniforms;re.model=V.model||x,re.view=V.view||x,re.projection=V.projection||x,w[0]=2/W.drawingBufferWidth,w[1]=2/W.drawingBufferHeight,re.screenSize=w,re.highlightId=Q.highlightId,re.highlightScale=Q.highlightScale,re.fragClipBounds=X,re.clipBounds=Q.axes.bounds,re.opacity=Q.opacity,re.pickGroup=Q.pickId/255,re.pixelRatio=H,Q.vao.bind(),Q.vao.draw(W.TRIANGLES,Q.vertexCount),Q.lineWidth>0&&(W.lineWidth(Q.lineWidth*H),Q.vao.draw(W.LINES,Q.lineVertexCount,Q.vertexCount)),Q.vao.unbind()}}T.draw=function(K){var G=this.useOrtho?this.orthoShader:this.shader;oe(G,this.projectShader,this,K,this.pixelRatio,!1,!1)},T.drawTransparent=function(K){var G=this.useOrtho?this.orthoShader:this.shader;oe(G,this.projectShader,this,K,this.pixelRatio,!0,!1)},T.drawPick=function(K){var G=this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader;oe(G,this.pickProjectShader,this,K,1,!0,!0)},T.pick=function(K){if(!K||K.id!==this.pickId)return null;var G=K.value[2]+(K.value[1]<<8)+(K.value[0]<<16);if(G>=this.pointCount||G<0)return null;var Q=this.points[G],V=this._selectResult;V.index=G;for(var H=0;H<3;++H)V.position[H]=V.dataCoordinate[H]=Q[H];return V},T.highlight=function(K){if(!K)this.highlightId=[1,1,1,1];else{var G=K.index,Q=G&255,V=G>>8&255,H=G>>16&255;this.highlightId=[Q/255,V/255,H/255,0]}};function se(K,G,Q,V){var H;Array.isArray(K)?G<K.length?H=K[G]:H=void 0:H=K,H=m(H);var ee=!0;a(H)&&(H="\u25BC",ee=!1);var J=s(H,Q,V);return{mesh:J[0],lines:J[1],bounds:J[2],visible:ee}}T.update=function(K){if(K=K||{},"perspective"in K&&(this.useOrtho=!K.perspective),"orthographic"in K&&(this.useOrtho=!!K.orthographic),"lineWidth"in K&&(this.lineWidth=K.lineWidth),"project"in K)if(Array.isArray(K.project))this.axesProject=K.project;else{var G=!!K.project;this.axesProject=[G,G,G]}if("projectScale"in K)if(Array.isArray(K.projectScale))this.projectScale=K.projectScale.slice();else{var Q=+K.projectScale;this.projectScale=[Q,Q,Q]}if(this.projectHasAlpha=!1,"projectOpacity"in K){if(Array.isArray(K.projectOpacity))this.projectOpacity=K.projectOpacity.slice();else{var Q=+K.projectOpacity;this.projectOpacity=[Q,Q,Q]}for(var V=0;V<3;++V)this.projectOpacity[V]=l(this.projectOpacity[V]),this.projectOpacity[V]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in K&&(this.opacity=l(K.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var H=K.position,ee=K.font||"normal",J=K.alignment||[0,0],W,re;if(J.length===2)W=J[0],re=J[1];else{W=[],re=[];for(var V=0;V<J.length;++V)W[V]=J[V][0],re[V]=J[V][1]}var j=[1/0,1/0,1/0],Z=[-1/0,-1/0,-1/0],ne=K.glyph,le=K.color,ge=K.size,pe=K.angle,xe=K.lineColor,Ee=-1,Te=0,de=0,be=0;if(H.length){be=H.length;e:for(var V=0;V<be;++V){for(var Le=H[V],De=0;De<3;++De)if(isNaN(Le[De])||!isFinite(Le[De]))continue e;var ye=se(ne,V,ee,this.pixelRatio),ke=ye.mesh,Oe=ye.lines,Qe=ye.bounds;Te+=ke.cells.length*3,de+=Oe.edges.length*2}}var Ve=Te+de,Ue=n.mallocFloat(3*Ve),Ie=n.mallocFloat(4*Ve),at=n.mallocFloat(2*Ve),pt=n.mallocUint32(Ve);if(Ve>0){var Rt=0,Mt=Te,It=[0,0,0,1],Bt=[0,0,0,1],St=Array.isArray(le)&&Array.isArray(le[0]),_t=Array.isArray(xe)&&Array.isArray(xe[0]);e:for(var V=0;V<be;++V){Ee+=1;for(var Le=H[V],De=0;De<3;++De){if(isNaN(Le[De])||!isFinite(Le[De]))continue e;Z[De]=Math.max(Z[De],Le[De]),j[De]=Math.min(j[De],Le[De])}var ye=se(ne,V,ee,this.pixelRatio),ke=ye.mesh,Oe=ye.lines,Qe=ye.bounds,it=ye.visible;if(!it)It=[1,1,1,0];else if(Array.isArray(le)){var ct;if(St?V<le.length?ct=le[V]:ct=[0,0,0,0]:ct=le,ct.length===3){for(var De=0;De<3;++De)It[De]=ct[De];It[3]=1}else if(ct.length===4){for(var De=0;De<4;++De)It[De]=ct[De];!this.hasAlpha&&ct[3]<1&&(this.hasAlpha=!0)}}else It[0]=It[1]=It[2]=0,It[3]=1;if(!it)Bt=[1,1,1,0];else if(Array.isArray(xe)){var ct;if(_t?V<xe.length?ct=xe[V]:ct=[0,0,0,0]:ct=xe,ct.length===3){for(var De=0;De<3;++De)Bt[De]=ct[De];Bt[De]=1}else if(ct.length===4){for(var De=0;De<4;++De)Bt[De]=ct[De];!this.hasAlpha&&ct[3]<1&&(this.hasAlpha=!0)}}else Bt[0]=Bt[1]=Bt[2]=0,Bt[3]=1;var et=.5;it?Array.isArray(ge)?V<ge.length?et=+ge[V]:et=12:ge?et=+ge:this.useOrtho&&(et=12):et=0;var Pe=0;Array.isArray(pe)?V<pe.length?Pe=+pe[V]:Pe=0:pe&&(Pe=+pe);for(var We=Math.cos(Pe),je=Math.sin(Pe),Le=H[V],De=0;De<3;++De)Z[De]=Math.max(Z[De],Le[De]),j[De]=Math.min(j[De],Le[De]);var nt=W,kt=re,nt=0;Array.isArray(W)?V<W.length?nt=W[V]:nt=0:W&&(nt=W);var kt=0;Array.isArray(re)?V<re.length?kt=re[V]:kt=0:re&&(kt=re),nt*=nt>0?1-Qe[0][0]:nt<0?1+Qe[1][0]:1,kt*=kt>0?1-Qe[0][1]:kt<0?1+Qe[1][1]:1;for(var wt=[nt,kt],$t=ke.cells||[],Qt=ke.positions||[],De=0;De<$t.length;++De)for(var Vt=$t[De],qt=0;qt<3;++qt){for(var zt=0;zt<3;++zt)Ue[3*Rt+zt]=Le[zt];for(var zt=0;zt<4;++zt)Ie[4*Rt+zt]=It[zt];pt[Rt]=Ee;var Ht=Qt[Vt[qt]];at[2*Rt]=et*(We*Ht[0]-je*Ht[1]+wt[0]),at[2*Rt+1]=et*(je*Ht[0]+We*Ht[1]+wt[1]),Rt+=1}for(var $t=Oe.edges,Qt=Oe.positions,De=0;De<$t.length;++De)for(var Vt=$t[De],qt=0;qt<2;++qt){for(var zt=0;zt<3;++zt)Ue[3*Mt+zt]=Le[zt];for(var zt=0;zt<4;++zt)Ie[4*Mt+zt]=Bt[zt];pt[Mt]=Ee;var Ht=Qt[Vt[qt]];at[2*Mt]=et*(We*Ht[0]-je*Ht[1]+wt[0]),at[2*Mt+1]=et*(je*Ht[0]+We*Ht[1]+wt[1]),Mt+=1}}}this.bounds=[j,Z],this.points=H,this.pointCount=H.length,this.vertexCount=Te,this.lineVertexCount=de,this.pointBuffer.update(Ue),this.colorBuffer.update(Ie),this.glyphBuffer.update(at),this.idBuffer.update(pt),n.free(Ue),n.free(Ie),n.free(at),n.free(pt)},T.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()};function q(K){var G=K.gl,Q=d.createPerspective(G),V=d.createOrtho(G),H=d.createProject(G),ee=d.createPickPerspective(G),J=d.createPickOrtho(G),W=d.createPickProject(G),re=t(G),j=t(G),Z=t(G),ne=t(G),le=i(G,[{buffer:re,size:3,type:G.FLOAT},{buffer:j,size:4,type:G.FLOAT},{buffer:Z,size:2,type:G.FLOAT},{buffer:ne,size:4,type:G.UNSIGNED_BYTE,normalized:!0}]),ge=new y(G,Q,V,H,re,j,Z,ne,le,ee,J,W);return ge.update(K),ge}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(e,p,g){"use strict";var a=e("glslify");g.boxVertex=a([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),g.boxFragment=a([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:231}],130:[function(e,p,g){"use strict";var a=e("gl-shader"),t=e("gl-buffer"),i=e("./lib/shaders");p.exports=d;function n(s,m,x){this.plot=s,this.boxBuffer=m,this.boxShader=x,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}var r=n.prototype;r.draw=function(){if(!!this.enabled){var s=this.plot,m=this.selectBox,x=this.borderWidth,M=this.innerFill,v=this.innerColor,_=this.outerFill,l=this.outerColor,y=this.borderColor,T=s.box,w=s.screenBox,A=s.dataBox,f=s.viewBox,u=s.pixelRatio,h=(m[0]-A[0])*(f[2]-f[0])/(A[2]-A[0])+f[0],o=(m[1]-A[1])*(f[3]-f[1])/(A[3]-A[1])+f[1],S=(m[2]-A[0])*(f[2]-f[0])/(A[2]-A[0])+f[0],R=(m[3]-A[1])*(f[3]-f[1])/(A[3]-A[1])+f[1];if(h=Math.max(h,f[0]),o=Math.max(o,f[1]),S=Math.min(S,f[2]),R=Math.min(R,f[3]),!(S<h||R<o)){T.bind();var z=w[2]-w[0],O=w[3]-w[1];if(this.outerFill&&(T.drawBox(0,0,z,o,l),T.drawBox(0,o,h,R,l),T.drawBox(0,R,z,O,l),T.drawBox(S,o,z,R,l)),this.innerFill&&T.drawBox(h,o,S,R,v),x>0){var I=x*u;T.drawBox(h-I,o-I,S+I,o+I,y),T.drawBox(h-I,R-I,S+I,R+I,y),T.drawBox(h-I,o-I,h+I,R+I,y),T.drawBox(S-I,o-I,S+I,R+I,y)}}}},r.update=function(s){s=s||{},this.innerFill=!!s.innerFill,this.outerFill=!!s.outerFill,this.innerColor=(s.innerColor||[0,0,0,.5]).slice(),this.outerColor=(s.outerColor||[0,0,0,.5]).slice(),this.borderColor=(s.borderColor||[0,0,0,1]).slice(),this.borderWidth=s.borderWidth||0,this.selectBox=(s.selectBox||this.selectBox).slice()},r.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)};function d(s,m){var x=s.gl,M=t(x,[0,0,0,1,1,0,1,1]),v=a(x,i.boxVertex,i.boxFragment),_=new n(s,M,v);return _.update(m),s.addOverlay(_),_}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(e,p,g){"use strict";p.exports=x;var a=e("gl-fbo"),t=e("typedarray-pool"),i=e("ndarray"),n=e("bit-twiddle").nextPow2,r=function(M,v,_){for(var l=1e8,y=-1,T=-1,w=M.shape[0],A=M.shape[1],f=0;f<w;f++)for(var u=0;u<A;u++){var h=M.get(f,u,0),o=M.get(f,u,1),S=M.get(f,u,2),R=M.get(f,u,3);if(h<255||o<255||S<255||R<255){var z=v-f,O=_-u,I=z*z+O*O;I<l&&(l=I,y=f,T=u)}}return[y,T,l]};function d(M,v,_,l,y){this.coord=[M,v],this.id=_,this.value=l,this.distance=y}function s(M,v,_){this.gl=M,this.fbo=v,this.buffer=_,this._readTimeout=null;var l=this;this._readCallback=function(){!l.gl||(v.bind(),M.readPixels(0,0,v.shape[0],v.shape[1],M.RGBA,M.UNSIGNED_BYTE,l.buffer),l._readTimeout=null)}}var m=s.prototype;Object.defineProperty(m,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(M){if(!!this.gl){this.fbo.shape=M;var v=this.fbo.shape[0],_=this.fbo.shape[1];if(_*v*4>this.buffer.length){t.free(this.buffer);for(var l=this.buffer=t.mallocUint8(n(_*v*4)),y=0;y<_*v*4;++y)l[y]=255}return M}}}),m.begin=function(){var M=this.gl,v=this.shape;!M||(this.fbo.bind(),M.clearColor(1,1,1,1),M.clear(M.COLOR_BUFFER_BIT|M.DEPTH_BUFFER_BIT))},m.end=function(){var M=this.gl;!M||(M.bindFramebuffer(M.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},m.query=function(M,v,_){if(!this.gl)return null;var l=this.fbo.shape.slice();M=M|0,v=v|0,typeof _!="number"&&(_=1);var y=Math.min(Math.max(M-_,0),l[0])|0,T=Math.min(Math.max(M+_,0),l[0])|0,w=Math.min(Math.max(v-_,0),l[1])|0,A=Math.min(Math.max(v+_,0),l[1])|0;if(T<=y||A<=w)return null;var f=[T-y,A-w],u=i(this.buffer,[f[0],f[1],4],[4,l[0]*4,1],4*(y+l[0]*w)),h=r(u.hi(f[0],f[1],1),_,_),o=h[0],S=h[1];if(o<0||Math.pow(this.radius,2)<h[2])return null;var R=u.get(o,S,0),z=u.get(o,S,1),O=u.get(o,S,2),I=u.get(o,S,3);return new d(o+y|0,S+w|0,R,[z,O,I],Math.sqrt(h[2]))},m.dispose=function(){!this.gl||(this.fbo.dispose(),t.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))};function x(M,v){var _=v[0],l=v[1],y={},T=a(M,_,l,y),w=t.mallocUint8(_*l*4);return new s(M,T,w)}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(e,p,g){"use strict";var a=e("./lib/create-uniforms"),t=e("./lib/create-attributes"),i=e("./lib/reflect"),n=e("./lib/shader-cache"),r=e("./lib/runtime-reflect"),d=e("./lib/GLError");function s(v){this.gl=v,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var m=s.prototype;m.bind=function(){this.program||this._relink();var v,_=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),l=this.gl.lastAttribCount;if(_>l)for(v=l;v<_;v++)this.gl.enableVertexAttribArray(v);else if(l>_)for(v=_;v<l;v++)this.gl.disableVertexAttribArray(v);this.gl.lastAttribCount=_,this.gl.useProgram(this.program)},m.dispose=function(){for(var v=this.gl.lastAttribCount,_=0;_<v;_++)this.gl.disableVertexAttribArray(_);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null};function x(v,_){return v.name<_.name?-1:1}m.update=function(v,_,l,y){if(!_||arguments.length===1){var T=v;v=T.vertex,_=T.fragment,l=T.uniforms,y=T.attributes}var w=this,A=w.gl,f=w._vref;w._vref=n.shader(A,A.VERTEX_SHADER,v),f&&f.dispose(),w.vertShader=w._vref.shader;var u=this._fref;if(w._fref=n.shader(A,A.FRAGMENT_SHADER,_),u&&u.dispose(),w.fragShader=w._fref.shader,!l||!y){var h=A.createProgram();if(A.attachShader(h,w.fragShader),A.attachShader(h,w.vertShader),A.linkProgram(h),!A.getProgramParameter(h,A.LINK_STATUS)){var o=A.getProgramInfoLog(h);throw new d(o,"Error linking program:"+o)}l=l||r.uniforms(A,h),y=y||r.attributes(A,h),A.deleteProgram(h)}y=y.slice(),y.sort(x);var S=[],R=[],z=[],O;for(O=0;O<y.length;++O){var I=y[O];if(I.type.indexOf("mat")>=0){for(var F=I.type.charAt(I.type.length-1)|0,D=new Array(F),B=0;B<F;++B)D[B]=z.length,R.push(I.name+"["+B+"]"),typeof I.location=="number"?z.push(I.location+B):Array.isArray(I.location)&&I.location.length===F&&typeof I.location[B]=="number"?z.push(I.location[B]|0):z.push(-1);S.push({name:I.name,type:I.type,locations:D})}else S.push({name:I.name,type:I.type,locations:[z.length]}),R.push(I.name),typeof I.location=="number"?z.push(I.location|0):z.push(-1)}var U=0;for(O=0;O<z.length;++O)if(z[O]<0){for(;z.indexOf(U)>=0;)U+=1;z[O]=U}var X=new Array(l.length);function oe(){w.program=n.program(A,w._vref,w._fref,R,z);for(var se=0;se<l.length;++se)X[se]=A.getUniformLocation(w.program,l[se].name)}oe(),w._relink=oe,w.types={uniforms:i(l),attributes:i(y)},w.attributes=t(A,w,S,z),Object.defineProperty(w,"uniforms",a(A,w,l,X))};function M(v,_,l,y,T){var w=new s(v);return w.update(_,l,y,T),w}p.exports=M},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(e,p,g){function a(t,i,n){this.shortMessage=i||"",this.longMessage=n||"",this.rawError=t||"",this.message="gl-shader: "+(i||t||"")+(n?`
`+n:""),this.stack=new Error().stack}a.prototype=new Error,a.prototype.name="GLError",a.prototype.constructor=a,p.exports=a},{}],134:[function(e,p,g){"use strict";p.exports=s;var a=e("./GLError");function t(m,x,M,v,_,l){this._gl=m,this._wrapper=x,this._index=M,this._locations=v,this._dimension=_,this._constFunc=l}var i=t.prototype;i.pointer=function(x,M,v,_){var l=this,y=l._gl,T=l._locations[l._index];y.vertexAttribPointer(T,l._dimension,x||y.FLOAT,!!M,v||0,_||0),y.enableVertexAttribArray(T)},i.set=function(m,x,M,v){return this._constFunc(this._locations[this._index],m,x,M,v)},Object.defineProperty(i,"location",{get:function(){return this._locations[this._index]},set:function(m){return m!==this._locations[this._index]&&(this._locations[this._index]=m|0,this._wrapper.program=null),m|0}});var n=[function(m,x,M){return M.length===void 0?m.vertexAttrib1f(x,M):m.vertexAttrib1fv(x,M)},function(m,x,M,v){return M.length===void 0?m.vertexAttrib2f(x,M,v):m.vertexAttrib2fv(x,M)},function(m,x,M,v,_){return M.length===void 0?m.vertexAttrib3f(x,M,v,_):m.vertexAttrib3fv(x,M)},function(m,x,M,v,_,l){return M.length===void 0?m.vertexAttrib4f(x,M,v,_,l):m.vertexAttrib4fv(x,M)}];function r(m,x,M,v,_,l,y){var T=n[_],w=new t(m,x,M,v,_,T);Object.defineProperty(l,y,{set:function(A){return m.disableVertexAttribArray(v[M]),T(m,v[M],A),A},get:function(){return w},enumerable:!0})}function d(m,x,M,v,_,l,y){for(var T=new Array(_),w=new Array(_),A=0;A<_;++A)r(m,x,M[A],v,_,T,A),w[A]=T[A];Object.defineProperty(T,"location",{set:function(h){if(Array.isArray(h))for(var o=0;o<_;++o)w[o].location=h[o];else for(var o=0;o<_;++o)w[o].location=h+o;return h},get:function(){for(var h=new Array(_),o=0;o<_;++o)h[o]=v[M[o]];return h},enumerable:!0}),T.pointer=function(h,o,S,R){h=h||m.FLOAT,o=!!o,S=S||_*_,R=R||0;for(var z=0;z<_;++z){var O=v[M[z]];m.vertexAttribPointer(O,_,h,o,S,R+z*_),m.enableVertexAttribArray(O)}};var f=new Array(_),u=m["vertexAttrib"+_+"fv"];Object.defineProperty(l,y,{set:function(h){for(var o=0;o<_;++o){var S=v[M[o]];if(m.disableVertexAttribArray(S),Array.isArray(h[0]))u.call(m,S,h[o]);else{for(var R=0;R<_;++R)f[R]=h[_*o+R];u.call(m,S,f)}}return h},get:function(){return T},enumerable:!0})}function s(m,x,M,v){for(var _={},l=0,y=M.length;l<y;++l){var T=M[l],w=T.name,A=T.type,f=T.locations;switch(A){case"bool":case"int":case"float":r(m,x,f[0],v,1,_,w);break;default:if(A.indexOf("vec")>=0){var u=A.charCodeAt(A.length-1)-48;if(u<2||u>4)throw new a("","Invalid data type for attribute "+w+": "+A);r(m,x,f[0],v,u,_,w)}else if(A.indexOf("mat")>=0){var u=A.charCodeAt(A.length-1)-48;if(u<2||u>4)throw new a("","Invalid data type for attribute "+w+": "+A);d(m,x,f,v,u,_,w)}else throw new a("","Unknown data type for attribute "+w+": "+A);break}}return _}},{"./GLError":133}],135:[function(e,p,g){"use strict";var a=e("./reflect"),t=e("./GLError");p.exports=r;function i(d){return function(){return d}}function n(d,s){for(var m=new Array(d),x=0;x<d;++x)m[x]=s;return m}function r(d,s,m,x){function M(A){return function(f,u,h){return f.getUniform(u.program,h[A])}}function v(A){return function(u){for(var h=_("",A),o=0;o<h.length;++o){var S=h[o],R=S[0],z=S[1];if(x[z]){var O=u;if(typeof R=="string"&&(R.indexOf(".")===0||R.indexOf("[")===0)){var I=R;if(R.indexOf(".")===0&&(I=R.slice(1)),I.indexOf("]")===I.length-1){var F=I.indexOf("["),D=I.slice(0,F),B=I.slice(F+1,I.length-1);O=D?u[D][B]:u[B]}else O=u[I]}var U=m[z].type,X;switch(U){case"bool":case"int":case"sampler2D":case"samplerCube":d.uniform1i(x[z],O);break;case"float":d.uniform1f(x[z],O);break;default:var oe=U.indexOf("vec");if(0<=oe&&oe<=1&&U.length===4+oe){if(X=U.charCodeAt(U.length-1)-48,X<2||X>4)throw new t("","Invalid data type");switch(U.charAt(0)){case"b":case"i":d["uniform"+X+"iv"](x[z],O);break;case"v":d["uniform"+X+"fv"](x[z],O);break;default:throw new t("","Unrecognized data type for vector "+name+": "+U)}}else if(U.indexOf("mat")===0&&U.length===4){if(X=U.charCodeAt(U.length-1)-48,X<2||X>4)throw new t("","Invalid uniform dimension type for matrix "+name+": "+U);d["uniformMatrix"+X+"fv"](x[z],!1,O);break}else throw new t("","Unknown uniform data type for "+name+": "+U)}}}}}function _(A,f){if(typeof f!="object")return[[A,f]];var u=[];for(var h in f){var o=f[h],S=A;parseInt(h)+""===h?S+="["+h+"]":S+="."+h,typeof o=="object"?u.push.apply(u,_(S,o)):u.push([S,o])}return u}function l(A){switch(A){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":return 0;case"float":return 0;default:var f=A.indexOf("vec");if(0<=f&&f<=1&&A.length===4+f){var u=A.charCodeAt(A.length-1)-48;if(u<2||u>4)throw new t("","Invalid data type");return A.charAt(0)==="b"?n(u,!1):n(u,0)}else if(A.indexOf("mat")===0&&A.length===4){var u=A.charCodeAt(A.length-1)-48;if(u<2||u>4)throw new t("","Invalid uniform dimension type for matrix "+name+": "+A);return n(u*u,0)}else throw new t("","Unknown uniform data type for "+name+": "+A)}}function y(A,f,u){if(typeof u=="object"){var h=T(u);Object.defineProperty(A,f,{get:i(h),set:v(u),enumerable:!0,configurable:!1})}else x[u]?Object.defineProperty(A,f,{get:M(u),set:v(u),enumerable:!0,configurable:!1}):A[f]=l(m[u].type)}function T(A){var f;if(Array.isArray(A)){f=new Array(A.length);for(var u=0;u<A.length;++u)y(f,u,A[u])}else{f={};for(var h in A)y(f,h,A[h])}return f}var w=a(m,!0);return{get:i(T(w)),set:v(w),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(e,p,g){"use strict";p.exports=a;function a(t,i){for(var n={},r=0;r<t.length;++r)for(var d=t[r].name,s=d.split("."),m=n,x=0;x<s.length;++x){var M=s[x].split("[");if(M.length>1){M[0]in m||(m[M[0]]=[]),m=m[M[0]];for(var v=1;v<M.length;++v){var _=parseInt(M[v]);v<M.length-1||x<s.length-1?(_ in m||(v<M.length-1?m[_]=[]:m[_]={}),m=m[_]):i?m[_]=r:m[_]=t[r].type}}else x<s.length-1?(M[0]in m||(m[M[0]]={}),m=m[M[0]]):i?m[M[0]]=r:m[M[0]]=t[r].type}return n}},{}],137:[function(e,p,g){"use strict";g.uniforms=n,g.attributes=r;var a={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},t=null;function i(d,s){if(!t){var m=Object.keys(a);t={};for(var x=0;x<m.length;++x){var M=m[x];t[d[M]]=a[M]}}return t[s]}function n(d,s){for(var m=d.getProgramParameter(s,d.ACTIVE_UNIFORMS),x=[],M=0;M<m;++M){var v=d.getActiveUniform(s,M);if(v){var _=i(d,v.type);if(v.size>1)for(var l=0;l<v.size;++l)x.push({name:v.name.replace("[0]","["+l+"]"),type:_});else x.push({name:v.name,type:_})}}return x}function r(d,s){for(var m=d.getProgramParameter(s,d.ACTIVE_ATTRIBUTES),x=[],M=0;M<m;++M){var v=d.getActiveAttrib(s,M);v&&x.push({name:v.name,type:i(d,v.type)})}return x}},{}],138:[function(e,p,g){"use strict";g.shader=_,g.program=l;var a=e("./GLError"),t=e("gl-format-compiler-error"),i=typeof WeakMap>"u"?e("weakmap-shim"):WeakMap,n=new i,r=0;function d(y,T,w,A,f,u,h){this.id=y,this.src=T,this.type=w,this.shader=A,this.count=u,this.programs=[],this.cache=h}d.prototype.dispose=function(){if(--this.count===0){for(var y=this.cache,T=y.gl,w=this.programs,A=0,f=w.length;A<f;++A){var u=y.programs[w[A]];u&&(delete y.programs[A],T.deleteProgram(u))}T.deleteShader(this.shader),delete y.shaders[this.type===T.FRAGMENT_SHADER|0][this.src]}};function s(y){this.gl=y,this.shaders=[{},{}],this.programs={}}var m=s.prototype;function x(y,T,w){var A=y.createShader(T);if(y.shaderSource(A,w),y.compileShader(A),!y.getShaderParameter(A,y.COMPILE_STATUS)){var f=y.getShaderInfoLog(A);try{var u=t(f,w,T)}catch(h){throw console.warn("Failed to format compiler error: "+h),new a(f,`Error compiling shader:
`+f)}throw new a(f,u.short,u.long)}return A}m.getShaderReference=function(y,T){var w=this.gl,A=this.shaders[y===w.FRAGMENT_SHADER|0],f=A[T];if(!f||!w.isShader(f.shader)){var u=x(w,y,T);f=A[T]=new d(r++,T,y,u,[],1,this)}else f.count+=1;return f};function M(y,T,w,A,f){var u=y.createProgram();y.attachShader(u,T),y.attachShader(u,w);for(var h=0;h<A.length;++h)y.bindAttribLocation(u,f[h],A[h]);if(y.linkProgram(u),!y.getProgramParameter(u,y.LINK_STATUS)){var o=y.getProgramInfoLog(u);throw new a(o,"Error linking program: "+o)}return u}m.getProgram=function(y,T,w,A){var f=[y.id,T.id,w.join(":"),A.join(":")].join("@"),u=this.programs[f];return(!u||!this.gl.isProgram(u))&&(this.programs[f]=u=M(this.gl,y.shader,T.shader,w,A),y.programs.push(f),T.programs.push(f)),u};function v(y){var T=n.get(y);return T||(T=new s(y),n.set(y,T)),T}function _(y,T,w){return v(y).getShaderReference(T,w)}function l(y,T,w,A,f){return v(y).getProgram(T,w,A,f)}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(e,p,g){"use strict";p.exports=i;function a(n){this.plot=n,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}var t=a.prototype;t.update=function(n){n=n||{},this.enable=(n.enable||[!0,!0,!1,!1]).slice(),this.width=(n.width||[1,1,1,1]).slice(),this.color=(n.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(r){return r.slice()}),this.center=(n.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},t.draw=function(){var n=this.enable,r=this.width,d=this.color,s=this.center,m=this.plot,x=m.line,M=m.dataBox,v=m.viewBox;if(x.bind(),M[0]<=s[0]&&s[0]<=M[2]&&M[1]<=s[1]&&s[1]<=M[3]){var _=v[0]+(s[0]-M[0])/(M[2]-M[0])*(v[2]-v[0]),l=v[1]+(s[1]-M[1])/(M[3]-M[1])*(v[3]-v[1]);n[0]&&x.drawLine(_,l,v[0],l,r[0],d[0]),n[1]&&x.drawLine(_,l,_,v[1],r[1],d[1]),n[2]&&x.drawLine(_,l,v[2],l,r[2],d[2]),n[3]&&x.drawLine(_,l,_,v[3],r[3],d[3])}},t.dispose=function(){this.plot.removeOverlay(this)};function i(n,r){var d=new a(n);return d.update(r),n.addOverlay(d),d}},{}],140:[function(e,p,g){"use strict";var a=e("glslify"),t=e("gl-shader"),i=a([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),n=a([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);p.exports=function(r){return t(r,i,n,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(e,p,g){"use strict";var a=e("gl-buffer"),t=e("gl-vao"),i=e("./shaders/index");p.exports=M;var n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(v,_,l,y){this.gl=v,this.buffer=_,this.vao=l,this.shader=y,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var d=r.prototype,s=[0,0,0],m=[0,0,0],x=[0,0];d.isTransparent=function(){return!1},d.drawTransparent=function(v){},d.draw=function(v){var _=this.gl,l=this.vao,y=this.shader;l.bind(),y.bind();var T=v.model||n,w=v.view||n,A=v.projection||n,f;this.axes&&(f=this.axes.lastCubeProps.axis);for(var u=s,h=m,o=0;o<3;++o)f&&f[o]<0?(u[o]=this.bounds[0][o],h[o]=this.bounds[1][o]):(u[o]=this.bounds[1][o],h[o]=this.bounds[0][o]);x[0]=_.drawingBufferWidth,x[1]=_.drawingBufferHeight,y.uniforms.model=T,y.uniforms.view=w,y.uniforms.projection=A,y.uniforms.coordinates=[this.position,u,h],y.uniforms.colors=this.colors,y.uniforms.screenShape=x;for(var o=0;o<3;++o)y.uniforms.lineWidth=this.lineWidth[o]*this.pixelRatio,this.enabled[o]&&(l.draw(_.TRIANGLES,6,6*o),this.drawSides[o]&&l.draw(_.TRIANGLES,12,18+12*o));l.unbind()},d.update=function(v){!v||("bounds"in v&&(this.bounds=v.bounds),"position"in v&&(this.position=v.position),"lineWidth"in v&&(this.lineWidth=v.lineWidth),"colors"in v&&(this.colors=v.colors),"enabled"in v&&(this.enabled=v.enabled),"drawSides"in v&&(this.drawSides=v.drawSides))},d.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()};function M(v,_){var l=[];function y(u,h,o,S,R,z){var O=[u,h,o,0,0,0,1];O[S+3]=1,O[S]=R,l.push.apply(l,O),O[6]=-1,l.push.apply(l,O),O[S]=z,l.push.apply(l,O),l.push.apply(l,O),O[6]=1,l.push.apply(l,O),O[S]=R,l.push.apply(l,O)}y(0,0,0,0,0,1),y(0,0,0,1,0,1),y(0,0,0,2,0,1),y(1,0,0,1,-1,1),y(1,0,0,2,-1,1),y(0,1,0,0,-1,1),y(0,1,0,2,-1,1),y(0,0,1,0,-1,1),y(0,0,1,1,-1,1);var T=a(v,l),w=t(v,[{type:v.FLOAT,buffer:T,size:3,offset:0,stride:28},{type:v.FLOAT,buffer:T,size:3,offset:12,stride:28},{type:v.FLOAT,buffer:T,size:1,offset:24,stride:28}]),A=i(v);A.attributes.position.location=0,A.attributes.color.location=1,A.attributes.weight.location=2;var f=new r(v,T,w,A);return f.update(_),f}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(e,p,g){var a=e("glslify"),t=a([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),i=a([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),n=a([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=a([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);g.meshShader={vertex:t,fragment:i,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},g.pickShader={vertex:n,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(e,p,g){"use strict";var a=e("gl-vec3"),t=e("gl-vec4"),i=["xyz","xzy","yxz","yzx","zxy","zyx"],n=function(y,T,w,A){for(var f=y.points,u=y.velocities,h=y.divergences,o=[],S=[],R=[],z=[],O=[],I=[],F=0,D=0,B=t.create(),U=t.create(),X=8,oe=0;oe<f.length;oe++){var se=f[oe],q=u[oe],K=h[oe];T===0&&(K=w*.05),D=a.length(q)/A,B=t.create(),a.copy(B,q),B[3]=K;for(var G=0;G<X;G++)O[G]=[se[0],se[1],se[2],G];if(z.length>0)for(var G=0;G<X;G++){var Q=(G+1)%X;o.push(z[G],O[G],O[Q],O[Q],z[Q],z[G]),R.push(U,B,B,B,U,U),I.push(F,D,D,D,F,F);var V=o.length;S.push([V-6,V-5,V-4],[V-3,V-2,V-1])}var H=z;z=O,O=H;var ee=U;U=B,B=ee;var J=F;F=D,D=J}return{positions:o,cells:S,vectors:R,vertexIntensity:I}},r=function(y,T,w,A){for(var f=0,u=0;u<y.length;u++)for(var h=y[u].velocities,o=0;o<h.length;o++)f=Math.max(f,a.length(h[o]));for(var S=y.map(function(oe){return n(oe,w,A,f)}),R=[],z=[],O=[],I=[],u=0;u<S.length;u++){var F=S[u],D=R.length;R=R.concat(F.positions),O=O.concat(F.vectors),I=I.concat(F.vertexIntensity);for(var o=0;o<F.cells.length;o++){var B=F.cells[o],U=[];z.push(U);for(var X=0;X<B.length;X++)U.push(B[X]+D)}}return{positions:R,cells:z,vectors:O,vertexIntensity:I,colormap:T}},d=function(y,T){var w=y.length,A;for(A=0;A<w;A++){var f=y[A];if(f===T)return A;if(f>T)return A-1}return A},s=function(y,T,w){return y<T?T:y>w?w:y},m=function(y,T,w){var A=T.vectors,f=T.meshgrid,u=y[0],h=y[1],o=y[2],S=f[0].length,R=f[1].length,z=f[2].length,O=d(f[0],u),I=d(f[1],h),F=d(f[2],o),D=O+1,B=I+1,U=F+1;if(O=s(O,0,S-1),D=s(D,0,S-1),I=s(I,0,R-1),B=s(B,0,R-1),F=s(F,0,z-1),U=s(U,0,z-1),O<0||I<0||F<0||D>S-1||B>R-1||U>z-1)return a.create();var X=f[0][O],oe=f[0][D],se=f[1][I],q=f[1][B],K=f[2][F],G=f[2][U],Q=(u-X)/(oe-X),V=(h-se)/(q-se),H=(o-K)/(G-K);isFinite(Q)||(Q=.5),isFinite(V)||(V=.5),isFinite(H)||(H=.5);var ee,J,W,re,j,Z;switch(w.reversedX&&(O=S-1-O,D=S-1-D),w.reversedY&&(I=R-1-I,B=R-1-B),w.reversedZ&&(F=z-1-F,U=z-1-U),w.filled){case 5:j=F,Z=U,W=I*z,re=B*z,ee=O*z*R,J=D*z*R;break;case 4:j=F,Z=U,ee=O*z,J=D*z,W=I*z*S,re=B*z*S;break;case 3:W=I,re=B,j=F*R,Z=U*R,ee=O*R*z,J=D*R*z;break;case 2:W=I,re=B,ee=O*R,J=D*R,j=F*R*S,Z=U*R*S;break;case 1:ee=O,J=D,j=F*S,Z=U*S,W=I*S*z,re=B*S*z;break;default:ee=O,J=D,W=I*S,re=B*S,j=F*S*R,Z=U*S*R;break}var ne=A[ee+W+j],le=A[ee+W+Z],ge=A[ee+re+j],pe=A[ee+re+Z],xe=A[J+W+j],Ee=A[J+W+Z],Te=A[J+re+j],de=A[J+re+Z],be=a.create(),Le=a.create(),De=a.create(),ye=a.create();a.lerp(be,ne,xe,Q),a.lerp(Le,le,Ee,Q),a.lerp(De,ge,Te,Q),a.lerp(ye,pe,de,Q);var ke=a.create(),Oe=a.create();a.lerp(ke,be,De,V),a.lerp(Oe,Le,ye,V);var Qe=a.create();return a.lerp(Qe,ke,Oe,H),Qe},x=function(y,T){var w=T[0],A=T[1],f=T[2];return y[0]=w<0?-w:w,y[1]=A<0?-A:A,y[2]=f<0?-f:f,y},M=function(y){var T=1/0;y.sort(function(u,h){return u-h});for(var w=y.length,A=1;A<w;A++){var f=Math.abs(y[A]-y[A-1]);f<T&&(T=f)}return T},v=function(y){for(var T=[],w=[],A=[],f={},u={},h={},o=y.length,S=0;S<o;S++){var R=y[S],z=R[0],O=R[1],I=R[2];f[z]||(T.push(z),f[z]=!0),u[O]||(w.push(O),u[O]=!0),h[I]||(A.push(I),h[I]=!0)}var F=M(T),D=M(w),B=M(A),U=Math.min(F,D,B);return isFinite(U)?U:1};p.exports=function(y,T){var w=y.startingPositions,A=y.maxLength||1e3,f=y.tubeSize||1,u=y.absoluteTubeSize,h=y.gridFill||"+x+y+z",o={};h.indexOf("-x")!==-1&&(o.reversedX=!0),h.indexOf("-y")!==-1&&(o.reversedY=!0),h.indexOf("-z")!==-1&&(o.reversedZ=!0),o.filled=i.indexOf(h.replace(/-/g,"").replace(/\+/g,""));var S=y.getVelocity||function(Ee){return m(Ee,y,o)},R=y.getDivergence||function(Ee,Te){var de=a.create(),be=1e-4;a.add(de,Ee,[be,0,0]);var Le=S(de);a.subtract(Le,Le,Te),a.scale(Le,Le,1/be),a.add(de,Ee,[0,be,0]);var De=S(de);a.subtract(De,De,Te),a.scale(De,De,1/be),a.add(de,Ee,[0,0,be]);var ye=S(de);return a.subtract(ye,ye,Te),a.scale(ye,ye,1/be),a.add(de,Le,De),a.add(de,de,ye),de},z=[],O=T[0][0],I=T[0][1],F=T[0][2],D=T[1][0],B=T[1][1],U=T[1][2],X=function(Ee){var Te=Ee[0],de=Ee[1],be=Ee[2];return!(Te<O||Te>D||de<I||de>B||be<F||be>U)},oe=a.distance(T[0],T[1]),se=10*oe/A,q=se*se,K=1,G=0,Q=w.length;Q>1&&(K=v(w));for(var V=0;V<Q;V++){var H=a.create();a.copy(H,w[V]);var ee=[H],J=[],W=S(H),re=H;J.push(W);var j=[],Z=R(H,W),ne=a.length(Z);isFinite(ne)&&ne>G&&(G=ne),j.push(ne),z.push({points:ee,velocities:J,divergences:j});for(var le=0;le<A*100&&ee.length<A&&X(H);){le++;var ge=a.clone(W),pe=a.squaredLength(ge);if(pe===0)break;if(pe>q&&a.scale(ge,ge,se/Math.sqrt(pe)),a.add(ge,ge,H),W=S(ge),a.squaredDistance(re,ge)-q>-1e-4*q){ee.push(ge),re=ge,J.push(W);var Z=R(ge,W),ne=a.length(Z);isFinite(ne)&&ne>G&&(G=ne),j.push(ne)}H=ge}}var xe=r(z,y.colormap,G,K);return u?xe.tubeScale=u:(G===0&&(G=1),xe.tubeScale=f*.5*K/G),xe};var _=e("./lib/shaders"),l=e("gl-cone3d").createMesh;p.exports.createTubeMesh=function(y,T){return l(y,T,{shaders:_,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(e,p,g){var a=e("gl-shader"),t=e("glslify"),i=t([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),n=t([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),r=t([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),d=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);g.createShader=function(s){var m=a(s,i,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return m.attributes.uv.location=0,m.attributes.f.location=1,m.attributes.normal.location=2,m},g.createPickShader=function(s){var m=a(s,i,d,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return m.attributes.uv.location=0,m.attributes.f.location=1,m.attributes.normal.location=2,m},g.createContourShader=function(s){var m=a(s,r,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return m.attributes.uv.location=0,m.attributes.f.location=1,m},g.createPickContourShader=function(s){var m=a(s,r,d,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return m.attributes.uv.location=0,m.attributes.f.location=1,m}},{"gl-shader":132,glslify:231}],145:[function(e,p,g){"use strict";p.exports=ee;var a=e("bit-twiddle"),t=e("gl-buffer"),i=e("gl-vao"),n=e("gl-texture2d"),r=e("typedarray-pool"),d=e("colormap"),s=e("ndarray-ops"),m=e("ndarray-pack"),x=e("ndarray"),M=e("surface-nets"),v=e("gl-mat4/multiply"),_=e("gl-mat4/invert"),l=e("binary-search-bounds"),y=e("ndarray-gradient"),T=e("./lib/shaders"),w=T.createShader,A=T.createContourShader,f=T.createPickShader,u=T.createPickContourShader,h=4*(4+3+3),o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],S=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],R=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];(function(){for(var J=0;J<3;++J){var W=R[J],re=(J+1)%3,j=(J+2)%3;W[re+0]=1,W[j+3]=1,W[J+6]=1}})();function z(J,W,re,j,Z){this.position=J,this.index=W,this.uv=re,this.level=j,this.dataCoordinate=Z}var O=256;function I(J,W,re,j,Z,ne,le,ge,pe,xe,Ee,Te,de,be,Le){this.gl=J,this.shape=W,this.bounds=re,this.objectOffset=Le,this.intensityBounds=[],this._shader=j,this._pickShader=Z,this._coordinateBuffer=ne,this._vao=le,this._colorMap=ge,this._contourShader=pe,this._contourPickShader=xe,this._contourBuffer=Ee,this._contourVAO=Te,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new z([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=de,this._dynamicVAO=be,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[x(r.mallocFloat(1024),[0,0]),x(r.mallocFloat(1024),[0,0]),x(r.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var F=I.prototype;F.genColormap=function(J,W){var re=!1,j=m([d({colormap:J,nshades:O,format:"rgba"}).map(function(Z,ne){var le=W?D(ne/255,W):Z[3];return le<1&&(re=!0),[Z[0],Z[1],Z[2],255*le]})]);return s.divseq(j,255),this.hasAlphaScale=re,j},F.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},F.isOpaque=function(){return!this.isTransparent()},F.pickSlots=1,F.setPickBase=function(J){this.pickId=J};function D(J,W){if(!W||!W.length)return 1;for(var re=0;re<W.length;++re){if(W.length<2)return 1;if(W[re][0]===J)return W[re][1];if(W[re][0]>J&&re>0){var j=(W[re][0]-J)/(W[re][0]-W[re-1][0]);return W[re][1]*(1-j)+j*W[re-1][1]}}return 1}var B=[0,0,0],U={showSurface:!1,showContour:!1,projections:[o.slice(),o.slice(),o.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function X(J,W){var re,j,Z,ne=W.axes&&W.axes.lastCubeProps.axis||B,le=W.showSurface,ge=W.showContour;for(re=0;re<3;++re)for(le=le||W.surfaceProject[re],j=0;j<3;++j)ge=ge||W.contourProject[re][j];for(re=0;re<3;++re){var pe=U.projections[re];for(j=0;j<16;++j)pe[j]=0;for(j=0;j<4;++j)pe[5*j]=1;pe[5*re]=0,pe[12+re]=W.axesBounds[+(ne[re]>0)][re],v(pe,J.model,pe);var xe=U.clipBounds[re];for(Z=0;Z<2;++Z)for(j=0;j<3;++j)xe[Z][j]=J.clipBounds[Z][j];xe[0][re]=-1e8,xe[1][re]=1e8}return U.showSurface=le,U.showContour=ge,U}var oe={model:o,view:o,projection:o,inverseModel:o.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},se=o.slice(),q=[1,0,0,0,1,0,0,0,1];function K(J,W){J=J||{};var re=this.gl;re.disable(re.CULL_FACE),this._colorMap.bind(0);var j=oe;j.model=J.model||o,j.view=J.view||o,j.projection=J.projection||o,j.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],j.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],j.objectOffset=this.objectOffset,j.contourColor=this.contourColor[0],j.inverseModel=_(j.inverseModel,j.model);for(var Z=0;Z<2;++Z)for(var ne=j.clipBounds[Z],le=0;le<3;++le)ne[le]=Math.min(Math.max(this.clipBounds[Z][le],-1e8),1e8);j.kambient=this.ambientLight,j.kdiffuse=this.diffuseLight,j.kspecular=this.specularLight,j.roughness=this.roughness,j.fresnel=this.fresnel,j.opacity=this.opacity,j.height=0,j.permutation=q,j.vertexColor=this.vertexColor;var ge=se;for(v(ge,j.view,j.model),v(ge,j.projection,ge),_(ge,ge),Z=0;Z<3;++Z)j.eyePosition[Z]=ge[12+Z]/ge[15];var pe=ge[15];for(Z=0;Z<3;++Z)pe+=this.lightPosition[Z]*ge[4*Z+3];for(Z=0;Z<3;++Z){var xe=ge[12+Z];for(le=0;le<3;++le)xe+=ge[4*le+Z]*this.lightPosition[le];j.lightPosition[Z]=xe/pe}var Ee=X(j,this);if(Ee.showSurface){for(this._shader.bind(),this._shader.uniforms=j,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(re.TRIANGLES,this._vertexCount),Z=0;Z<3;++Z)!this.surfaceProject[Z]||!this.vertexCount||(this._shader.uniforms.model=Ee.projections[Z],this._shader.uniforms.clipBounds=Ee.clipBounds[Z],this._vao.draw(re.TRIANGLES,this._vertexCount));this._vao.unbind()}if(Ee.showContour){var Te=this._contourShader;j.kambient=1,j.kdiffuse=0,j.kspecular=0,j.opacity=1,Te.bind(),Te.uniforms=j;var de=this._contourVAO;for(de.bind(),Z=0;Z<3;++Z)for(Te.uniforms.permutation=R[Z],re.lineWidth(this.contourWidth[Z]*this.pixelRatio),le=0;le<this.contourLevels[Z].length;++le)le===this.highlightLevel[Z]?(Te.uniforms.contourColor=this.highlightColor[Z],Te.uniforms.contourTint=this.highlightTint[Z]):(le===0||le-1===this.highlightLevel[Z])&&(Te.uniforms.contourColor=this.contourColor[Z],Te.uniforms.contourTint=this.contourTint[Z]),this._contourCounts[Z][le]&&(Te.uniforms.height=this.contourLevels[Z][le],de.draw(re.LINES,this._contourCounts[Z][le],this._contourOffsets[Z][le]));for(Z=0;Z<3;++Z)for(Te.uniforms.model=Ee.projections[Z],Te.uniforms.clipBounds=Ee.clipBounds[Z],le=0;le<3;++le)if(!!this.contourProject[Z][le]){Te.uniforms.permutation=R[le],re.lineWidth(this.contourWidth[le]*this.pixelRatio);for(var be=0;be<this.contourLevels[le].length;++be)be===this.highlightLevel[le]?(Te.uniforms.contourColor=this.highlightColor[le],Te.uniforms.contourTint=this.highlightTint[le]):(be===0||be-1===this.highlightLevel[le])&&(Te.uniforms.contourColor=this.contourColor[le],Te.uniforms.contourTint=this.contourTint[le]),this._contourCounts[le][be]&&(Te.uniforms.height=this.contourLevels[le][be],de.draw(re.LINES,this._contourCounts[le][be],this._contourOffsets[le][be]))}for(de.unbind(),de=this._dynamicVAO,de.bind(),Z=0;Z<3;++Z)if(this._dynamicCounts[Z]!==0)for(Te.uniforms.model=j.model,Te.uniforms.clipBounds=j.clipBounds,Te.uniforms.permutation=R[Z],re.lineWidth(this.dynamicWidth[Z]*this.pixelRatio),Te.uniforms.contourColor=this.dynamicColor[Z],Te.uniforms.contourTint=this.dynamicTint[Z],Te.uniforms.height=this.dynamicLevel[Z],de.draw(re.LINES,this._dynamicCounts[Z],this._dynamicOffsets[Z]),le=0;le<3;++le)!this.contourProject[le][Z]||(Te.uniforms.model=Ee.projections[le],Te.uniforms.clipBounds=Ee.clipBounds[le],de.draw(re.LINES,this._dynamicCounts[Z],this._dynamicOffsets[Z]));de.unbind()}}F.draw=function(J){return K.call(this,J,!1)},F.drawTransparent=function(J){return K.call(this,J,!0)};var G={model:o,view:o,projection:o,inverseModel:o,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};F.drawPick=function(J){J=J||{};var W=this.gl;W.disable(W.CULL_FACE);var re=G;re.model=J.model||o,re.view=J.view||o,re.projection=J.projection||o,re.shape=this._field[2].shape,re.pickId=this.pickId/255,re.lowerBound=this.bounds[0],re.upperBound=this.bounds[1],re.objectOffset=this.objectOffset,re.permutation=q;for(var j=0;j<2;++j)for(var Z=re.clipBounds[j],ne=0;ne<3;++ne)Z[ne]=Math.min(Math.max(this.clipBounds[j][ne],-1e8),1e8);var le=X(re,this);if(le.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=re,this._vao.bind(),this._vao.draw(W.TRIANGLES,this._vertexCount),j=0;j<3;++j)!this.surfaceProject[j]||(this._pickShader.uniforms.model=le.projections[j],this._pickShader.uniforms.clipBounds=le.clipBounds[j],this._vao.draw(W.TRIANGLES,this._vertexCount));this._vao.unbind()}if(le.showContour){var ge=this._contourPickShader;ge.bind(),ge.uniforms=re;var pe=this._contourVAO;for(pe.bind(),ne=0;ne<3;++ne)for(W.lineWidth(this.contourWidth[ne]*this.pixelRatio),ge.uniforms.permutation=R[ne],j=0;j<this.contourLevels[ne].length;++j)this._contourCounts[ne][j]&&(ge.uniforms.height=this.contourLevels[ne][j],pe.draw(W.LINES,this._contourCounts[ne][j],this._contourOffsets[ne][j]));for(j=0;j<3;++j)for(ge.uniforms.model=le.projections[j],ge.uniforms.clipBounds=le.clipBounds[j],ne=0;ne<3;++ne)if(!!this.contourProject[j][ne]){ge.uniforms.permutation=R[ne],W.lineWidth(this.contourWidth[ne]*this.pixelRatio);for(var xe=0;xe<this.contourLevels[ne].length;++xe)this._contourCounts[ne][xe]&&(ge.uniforms.height=this.contourLevels[ne][xe],pe.draw(W.LINES,this._contourCounts[ne][xe],this._contourOffsets[ne][xe]))}pe.unbind()}},F.pick=function(J){if(!J||J.id!==this.pickId)return null;var W=this._field[2].shape,re=this._pickResult,j=W[0]*(J.value[0]+(J.value[2]>>4)/16)/255,Z=Math.floor(j),ne=j-Z,le=W[1]*(J.value[1]+(J.value[2]&15)/16)/255,ge=Math.floor(le),pe=le-ge;Z+=1,ge+=1;var xe=re.position;xe[0]=xe[1]=xe[2]=0;for(var Ee=0;Ee<2;++Ee)for(var Te=Ee?ne:1-ne,de=0;de<2;++de)for(var be=de?pe:1-pe,Le=Z+Ee,De=ge+de,ye=Te*be,ke=0;ke<3;++ke)xe[ke]+=this._field[ke].get(Le,De)*ye;for(var Oe=this._pickResult.level,Qe=0;Qe<3;++Qe)if(Oe[Qe]=l.le(this.contourLevels[Qe],xe[Qe]),Oe[Qe]<0)this.contourLevels[Qe].length>0&&(Oe[Qe]=0);else if(Oe[Qe]<this.contourLevels[Qe].length-1){var Ve=this.contourLevels[Qe][Oe[Qe]],Ue=this.contourLevels[Qe][Oe[Qe]+1];Math.abs(Ve-xe[Qe])>Math.abs(Ue-xe[Qe])&&(Oe[Qe]+=1)}for(re.index[0]=ne<.5?Z:Z+1,re.index[1]=pe<.5?ge:ge+1,re.uv[0]=j/W[0],re.uv[1]=le/W[1],ke=0;ke<3;++ke)re.dataCoordinate[ke]=this._field[ke].get(re.index[0],re.index[1]);return re},F.padField=function(J,W){var re=W.shape.slice(),j=J.shape.slice();s.assign(J.lo(1,1).hi(re[0],re[1]),W),s.assign(J.lo(1).hi(re[0],1),W.hi(re[0],1)),s.assign(J.lo(1,j[1]-1).hi(re[0],1),W.lo(0,re[1]-1).hi(re[0],1)),s.assign(J.lo(0,1).hi(1,re[1]),W.hi(1)),s.assign(J.lo(j[0]-1,1).hi(1,re[1]),W.lo(re[0]-1)),J.set(0,0,W.get(0,0)),J.set(0,j[1]-1,W.get(0,re[1]-1)),J.set(j[0]-1,0,W.get(re[0]-1,0)),J.set(j[0]-1,j[1]-1,W.get(re[0]-1,re[1]-1))};function Q(J,W){return Array.isArray(J)?[W(J[0]),W(J[1]),W(J[2])]:[W(J),W(J),W(J)]}function V(J){return Array.isArray(J)?J.length===3?[J[0],J[1],J[2],1]:[J[0],J[1],J[2],J[3]]:[0,0,0,1]}function H(J){if(Array.isArray(J)){if(Array.isArray(J))return[V(J[0]),V(J[1]),V(J[2])];var W=V(J);return[W.slice(),W.slice(),W.slice()]}}F.update=function(J){J=J||{},this.objectOffset=J.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in J&&(this.contourWidth=Q(J.contourWidth,Number)),"showContour"in J&&(this.showContour=Q(J.showContour,Boolean)),"showSurface"in J&&(this.showSurface=!!J.showSurface),"contourTint"in J&&(this.contourTint=Q(J.contourTint,Boolean)),"contourColor"in J&&(this.contourColor=H(J.contourColor)),"contourProject"in J&&(this.contourProject=Q(J.contourProject,function(Ot){return Q(Ot,Boolean)})),"surfaceProject"in J&&(this.surfaceProject=J.surfaceProject),"dynamicColor"in J&&(this.dynamicColor=H(J.dynamicColor)),"dynamicTint"in J&&(this.dynamicTint=Q(J.dynamicTint,Number)),"dynamicWidth"in J&&(this.dynamicWidth=Q(J.dynamicWidth,Number)),"opacity"in J&&(this.opacity=J.opacity),"opacityscale"in J&&(this.opacityscale=J.opacityscale),"colorBounds"in J&&(this.colorBounds=J.colorBounds),"vertexColor"in J&&(this.vertexColor=J.vertexColor?1:0),"colormap"in J&&this._colorMap.setPixels(this.genColormap(J.colormap,this.opacityscale));var W=J.field||J.coords&&J.coords[2]||null,re=!1;if(W||(this._field[2].shape[0]||this._field[2].shape[2]?W=this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):W=this._field[2].hi(0,0)),"field"in J||"coords"in J){var j=(W.shape[0]+2)*(W.shape[1]+2);j>this._field[2].data.length&&(r.freeFloat(this._field[2].data),this._field[2].data=r.mallocFloat(a.nextPow2(j))),this._field[2]=x(this._field[2].data,[W.shape[0]+2,W.shape[1]+2]),this.padField(this._field[2],W),this.shape=W.shape.slice();for(var Z=this.shape,ne=0;ne<2;++ne)this._field[2].size>this._field[ne].data.length&&(r.freeFloat(this._field[ne].data),this._field[ne].data=r.mallocFloat(this._field[2].size)),this._field[ne]=x(this._field[ne].data,[Z[0]+2,Z[1]+2]);if(J.coords){var le=J.coords;if(!Array.isArray(le)||le.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(ne=0;ne<2;++ne){var ge=le[ne];for(de=0;de<2;++de)if(ge.shape[de]!==Z[de])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[ne],ge)}}else if(J.ticks){var pe=J.ticks;if(!Array.isArray(pe)||pe.length!==2)throw new Error("gl-surface: invalid ticks");for(ne=0;ne<2;++ne){var xe=pe[ne];if((Array.isArray(xe)||xe.length)&&(xe=x(xe)),xe.shape[0]!==Z[ne])throw new Error("gl-surface: invalid tick length");var Ee=x(xe.data,Z);Ee.stride[ne]=xe.stride[0],Ee.stride[ne^1]=0,this.padField(this._field[ne],Ee)}}else{for(ne=0;ne<2;++ne){var Te=[0,0];Te[ne]=1,this._field[ne]=x(this._field[ne].data,[Z[0]+2,Z[1]+2],Te,0)}this._field[0].set(0,0,0);for(var de=0;de<Z[0];++de)this._field[0].set(de+1,0,de);for(this._field[0].set(Z[0]+1,0,Z[0]-1),this._field[1].set(0,0,0),de=0;de<Z[1];++de)this._field[1].set(0,de+1,de);this._field[1].set(0,Z[1]+1,Z[1]-1)}var be=this._field,Le=x(r.mallocFloat(be[2].size*3*2),[3,Z[0]+2,Z[1]+2,2]);for(ne=0;ne<3;++ne)y(Le.pick(ne),be[ne],"mirror");var De=x(r.mallocFloat(be[2].size*3),[Z[0]+2,Z[1]+2,3]);for(ne=0;ne<Z[0]+2;++ne)for(de=0;de<Z[1]+2;++de){var ye=Le.get(0,ne,de,0),ke=Le.get(0,ne,de,1),Oe=Le.get(1,ne,de,0),Qe=Le.get(1,ne,de,1),Ve=Le.get(2,ne,de,0),Ue=Le.get(2,ne,de,1),Ie=Oe*Ue-Qe*Ve,at=Ve*ke-Ue*ye,pt=ye*Qe-ke*Oe,Rt=Math.sqrt(Ie*Ie+at*at+pt*pt);Rt<1e-8?(Rt=Math.max(Math.abs(Ie),Math.abs(at),Math.abs(pt)),Rt<1e-8?(pt=1,at=Ie=0,Rt=1):Rt=1/Rt):Rt=1/Math.sqrt(Rt),De.set(ne,de,0,Ie*Rt),De.set(ne,de,1,at*Rt),De.set(ne,de,2,pt*Rt)}r.free(Le.data);var Mt=[1/0,1/0,1/0],It=[-1/0,-1/0,-1/0],Bt=1/0,St=-1/0,_t=(Z[0]-1)*(Z[1]-1)*6,it=r.mallocFloat(a.nextPow2(10*_t)),ct=0,et=0;for(ne=0;ne<Z[0]-1;++ne){e:for(de=0;de<Z[1]-1;++de){for(var Pe=0;Pe<2;++Pe)for(var We=0;We<2;++We)for(var je=0;je<3;++je){var nt=this._field[je].get(1+ne+Pe,1+de+We);if(isNaN(nt)||!isFinite(nt))continue e}for(je=0;je<6;++je){var kt=ne+S[je][0],wt=de+S[je][1],Vt=this._field[0].get(kt+1,wt+1),qt=this._field[1].get(kt+1,wt+1);nt=this._field[2].get(kt+1,wt+1),Ie=De.get(kt+1,wt+1,0),at=De.get(kt+1,wt+1,1),pt=De.get(kt+1,wt+1,2),J.intensity&&(zt=J.intensity.get(kt,wt));var zt=J.intensity?J.intensity.get(kt,wt):nt+this.objectOffset[2];it[ct++]=kt,it[ct++]=wt,it[ct++]=Vt,it[ct++]=qt,it[ct++]=nt,it[ct++]=0,it[ct++]=zt,it[ct++]=Ie,it[ct++]=at,it[ct++]=pt,Mt[0]=Math.min(Mt[0],Vt+this.objectOffset[0]),Mt[1]=Math.min(Mt[1],qt+this.objectOffset[1]),Mt[2]=Math.min(Mt[2],nt+this.objectOffset[2]),Bt=Math.min(Bt,zt),It[0]=Math.max(It[0],Vt+this.objectOffset[0]),It[1]=Math.max(It[1],qt+this.objectOffset[1]),It[2]=Math.max(It[2],nt+this.objectOffset[2]),St=Math.max(St,zt),et+=1}}}for(J.intensityBounds&&(Bt=+J.intensityBounds[0],St=+J.intensityBounds[1]),ne=6;ne<ct;ne+=10)it[ne]=(it[ne]-Bt)/(St-Bt);this._vertexCount=et,this._coordinateBuffer.update(it.subarray(0,ct)),r.freeFloat(it),r.free(De.data),this.bounds=[Mt,It],this.intensity=J.intensity||this._field[2],(this.intensityBounds[0]!==Bt||this.intensityBounds[1]!==St)&&(re=!0),this.intensityBounds=[Bt,St]}if("levels"in J){var Ht=J.levels;for(Array.isArray(Ht[0])?Ht=Ht.slice():Ht=[[],[],Ht],ne=0;ne<3;++ne)Ht[ne]=Ht[ne].slice(),Ht[ne].sort(function(Ot,ir){return Ot-ir});for(ne=0;ne<3;++ne)for(de=0;de<Ht[ne].length;++de)Ht[ne][de]-=this.objectOffset[ne];e:for(ne=0;ne<3;++ne){if(Ht[ne].length!==this.contourLevels[ne].length){re=!0;break}for(de=0;de<Ht[ne].length;++de)if(Ht[ne][de]!==this.contourLevels[ne][de]){re=!0;break e}}this.contourLevels=Ht}if(re){be=this._field,Z=this.shape;for(var $t=[],Qt=0;Qt<3;++Qt){var fr=this.contourLevels[Qt],jr=[],cn=[],Qr=[0,0,0];for(ne=0;ne<fr.length;++ne){var lt=M(this._field[Qt],fr[ne]);jr.push($t.length/5|0),et=0;e:for(de=0;de<lt.cells.length;++de){var Gt=lt.cells[de];for(je=0;je<2;++je){var Kt=lt.positions[Gt[je]],Nt=Kt[0],gr=Math.floor(Nt)|0,tt=Nt-gr,we=Kt[1],Me=Math.floor(we)|0,Ne=we-Me,Xe=!1;t:for(var Ke=0;Ke<3;++Ke){Qr[Ke]=0;var rt=(Qt+Ke+1)%3;for(Pe=0;Pe<2;++Pe){var Je=Pe?tt:1-tt;for(kt=Math.min(Math.max(gr+Pe,0),Z[0])|0,We=0;We<2;++We){var vt=We?Ne:1-Ne;if(wt=Math.min(Math.max(Me+We,0),Z[1])|0,Ke<2?nt=this._field[rt].get(kt,wt):nt=(this.intensity.get(kt,wt)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(nt)||isNaN(nt)){Xe=!0;break t}var bt=Je*vt;Qr[Ke]+=bt*nt}}}if(!Xe)$t.push(Qr[0],Qr[1],Kt[0],Kt[1],Qr[2]),et+=1;else{if(je>0){for(var Et=0;Et<5;++Et)$t.pop();et-=1}continue e}}}cn.push(et)}this._contourOffsets[Qt]=jr,this._contourCounts[Qt]=cn}var Wt=r.mallocFloat($t.length);for(ne=0;ne<$t.length;++ne)Wt[ne]=$t[ne];this._contourBuffer.update(Wt),r.freeFloat(Wt)}},F.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var J=0;J<3;++J)r.freeFloat(this._field[J].data)},F.highlight=function(J){var W;if(!J){this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],this.highlightLevel=[-1,-1,-1];return}for(W=0;W<3;++W)this.enableHighlight[W]?this.highlightLevel[W]=J.level[W]:this.highlightLevel[W]=-1;var re;for(this.snapToData?re=J.dataCoordinate:re=J.position,W=0;W<3;++W)re[W]-=this.objectOffset[W];if(!((!this.enableDynamic[0]||re[0]===this.dynamicLevel[0])&&(!this.enableDynamic[1]||re[1]===this.dynamicLevel[1])&&(!this.enableDynamic[2]||re[2]===this.dynamicLevel[2]))){for(var j=0,Z=this.shape,ne=r.mallocFloat(12*Z[0]*Z[1]),le=0;le<3;++le){if(!this.enableDynamic[le]){this.dynamicLevel[le]=NaN,this._dynamicCounts[le]=0;continue}this.dynamicLevel[le]=re[le];var ge=(le+1)%3,pe=(le+2)%3,xe=this._field[le],Ee=this._field[ge],Te=this._field[pe],de=M(xe,re[le]),be=de.cells,Le=de.positions;for(this._dynamicOffsets[le]=j,W=0;W<be.length;++W)for(var De=be[W],ye=0;ye<2;++ye){var ke=Le[De[ye]],Oe=+ke[0],Qe=Oe|0,Ve=Math.min(Qe+1,Z[0])|0,Ue=Oe-Qe,Ie=1-Ue,at=+ke[1],pt=at|0,Rt=Math.min(pt+1,Z[1])|0,Mt=at-pt,It=1-Mt,Bt=Ie*It,St=Ie*Mt,_t=Ue*It,it=Ue*Mt,ct=Bt*Ee.get(Qe,pt)+St*Ee.get(Qe,Rt)+_t*Ee.get(Ve,pt)+it*Ee.get(Ve,Rt),et=Bt*Te.get(Qe,pt)+St*Te.get(Qe,Rt)+_t*Te.get(Ve,pt)+it*Te.get(Ve,Rt);if(isNaN(ct)||isNaN(et)){ye&&(j-=1);break}ne[2*j+0]=ct,ne[2*j+1]=et,j+=1}this._dynamicCounts[le]=j-this._dynamicOffsets[le]}this._dynamicBuffer.update(ne.subarray(0,2*j)),r.freeFloat(ne)}};function ee(J){var W=J.gl,re=w(W),j=f(W),Z=A(W),ne=u(W),le=t(W),ge=i(W,[{buffer:le,size:4,stride:h,offset:0},{buffer:le,size:3,stride:h,offset:16},{buffer:le,size:3,stride:h,offset:28}]),pe=t(W),xe=i(W,[{buffer:pe,size:4,stride:20,offset:0},{buffer:pe,size:1,stride:20,offset:16}]),Ee=t(W),Te=i(W,[{buffer:Ee,size:2,type:W.FLOAT}]),de=n(W,1,O,W.RGBA,W.UNSIGNED_BYTE);de.minFilter=W.LINEAR,de.magFilter=W.LINEAR;var be=new I(W,[0,0],[[0,0,0],[0,0,0]],re,j,le,ge,de,Z,ne,pe,xe,Ee,Te,[0,0,0]),Le={levels:[[],[],[]]};for(var De in J)Le[De]=J[De];return Le.colormap=Le.colormap||"jet",be.update(Le),be}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(e,p,g){"use strict";var a=e("ndarray"),t=e("ndarray-ops"),i=e("typedarray-pool");p.exports=u;var n=null,r=null,d=null;function s(h){n=[h.LINEAR,h.NEAREST_MIPMAP_LINEAR,h.LINEAR_MIPMAP_NEAREST,h.LINEAR_MIPMAP_NEAREST],r=[h.NEAREST,h.LINEAR,h.NEAREST_MIPMAP_NEAREST,h.NEAREST_MIPMAP_LINEAR,h.LINEAR_MIPMAP_NEAREST,h.LINEAR_MIPMAP_LINEAR],d=[h.REPEAT,h.CLAMP_TO_EDGE,h.MIRRORED_REPEAT]}function m(h){return typeof HTMLCanvasElement<"u"&&h instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&h instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&h instanceof HTMLVideoElement||typeof ImageData<"u"&&h instanceof ImageData}var x=function(h,o){t.muls(h,o,255)};function M(h,o,S){var R=h.gl,z=R.getParameter(R.MAX_TEXTURE_SIZE);if(o<0||o>z||S<0||S>z)throw new Error("gl-texture2d: Invalid texture size");return h._shape=[o,S],h.bind(),R.texImage2D(R.TEXTURE_2D,0,h.format,o,S,0,h.format,h.type,null),h._mipLevels=[0],h}function v(h,o,S,R,z,O){this.gl=h,this.handle=o,this.format=z,this.type=O,this._shape=[S,R],this._mipLevels=[0],this._magFilter=h.NEAREST,this._minFilter=h.NEAREST,this._wrapS=h.CLAMP_TO_EDGE,this._wrapT=h.CLAMP_TO_EDGE,this._anisoSamples=1;var I=this,F=[this._wrapS,this._wrapT];Object.defineProperties(F,[{get:function(){return I._wrapS},set:function(B){return I.wrapS=B}},{get:function(){return I._wrapT},set:function(B){return I.wrapT=B}}]),this._wrapVector=F;var D=[this._shape[0],this._shape[1]];Object.defineProperties(D,[{get:function(){return I._shape[0]},set:function(B){return I.width=B}},{get:function(){return I._shape[1]},set:function(B){return I.height=B}}]),this._shapeVector=D}var _=v.prototype;Object.defineProperties(_,{minFilter:{get:function(){return this._minFilter},set:function(h){this.bind();var o=this.gl;if(this.type===o.FLOAT&&n.indexOf(h)>=0&&(o.getExtension("OES_texture_float_linear")||(h=o.NEAREST)),r.indexOf(h)<0)throw new Error("gl-texture2d: Unknown filter mode "+h);return o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,h),this._minFilter=h}},magFilter:{get:function(){return this._magFilter},set:function(h){this.bind();var o=this.gl;if(this.type===o.FLOAT&&n.indexOf(h)>=0&&(o.getExtension("OES_texture_float_linear")||(h=o.NEAREST)),r.indexOf(h)<0)throw new Error("gl-texture2d: Unknown filter mode "+h);return o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,h),this._magFilter=h}},mipSamples:{get:function(){return this._anisoSamples},set:function(h){var o=this._anisoSamples;if(this._anisoSamples=Math.max(h,1)|0,o!==this._anisoSamples){var S=this.gl.getExtension("EXT_texture_filter_anisotropic");S&&this.gl.texParameterf(this.gl.TEXTURE_2D,S.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(h){if(this.bind(),d.indexOf(h)<0)throw new Error("gl-texture2d: Unknown wrap mode "+h);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,h),this._wrapS=h}},wrapT:{get:function(){return this._wrapT},set:function(h){if(this.bind(),d.indexOf(h)<0)throw new Error("gl-texture2d: Unknown wrap mode "+h);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,h),this._wrapT=h}},wrap:{get:function(){return this._wrapVector},set:function(h){if(Array.isArray(h)||(h=[h,h]),h.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var o=0;o<2;++o)if(d.indexOf(h[o])<0)throw new Error("gl-texture2d: Unknown wrap mode "+h);this._wrapS=h[0],this._wrapT=h[1];var S=this.gl;return this.bind(),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_S,this._wrapS),S.texParameteri(S.TEXTURE_2D,S.TEXTURE_WRAP_T,this._wrapT),h}},shape:{get:function(){return this._shapeVector},set:function(h){if(!Array.isArray(h))h=[h|0,h|0];else if(h.length!==2)throw new Error("gl-texture2d: Invalid texture shape");return M(this,h[0]|0,h[1]|0),[h[0]|0,h[1]|0]}},width:{get:function(){return this._shape[0]},set:function(h){return h=h|0,M(this,h,this._shape[1]),h}},height:{get:function(){return this._shape[1]},set:function(h){return h=h|0,M(this,this._shape[0],h),h}}}),_.bind=function(h){var o=this.gl;return h!==void 0&&o.activeTexture(o.TEXTURE0+(h|0)),o.bindTexture(o.TEXTURE_2D,this.handle),h!==void 0?h|0:o.getParameter(o.ACTIVE_TEXTURE)-o.TEXTURE0},_.dispose=function(){this.gl.deleteTexture(this.handle)},_.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var h=Math.min(this._shape[0],this._shape[1]),o=0;h>0;++o,h>>>=1)this._mipLevels.indexOf(o)<0&&this._mipLevels.push(o)},_.setPixels=function(h,o,S,R){var z=this.gl;this.bind(),Array.isArray(o)?(R=S,S=o[1]|0,o=o[0]|0):(o=o||0,S=S||0),R=R||0;var O=m(h)?h:h.raw;if(O){var I=this._mipLevels.indexOf(R)<0;I?(z.texImage2D(z.TEXTURE_2D,0,this.format,this.format,this.type,O),this._mipLevels.push(R)):z.texSubImage2D(z.TEXTURE_2D,R,o,S,this.format,this.type,O)}else if(h.shape&&h.stride&&h.data){if(h.shape.length<2||o+h.shape[1]>this._shape[1]>>>R||S+h.shape[0]>this._shape[0]>>>R||o<0||S<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");y(z,o,S,R,this.format,this.type,this._mipLevels,h)}else throw new Error("gl-texture2d: Unsupported data type")};function l(h,o){return h.length===3?o[2]===1&&o[1]===h[0]*h[2]&&o[0]===h[2]:o[0]===1&&o[1]===h[0]}function y(h,o,S,R,z,O,I,F){var D=F.dtype,B=F.shape.slice();if(B.length<2||B.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var U=0,X=0,oe=l(B,F.stride.slice());D==="float32"?U=h.FLOAT:D==="float64"?(U=h.FLOAT,oe=!1,D="float32"):D==="uint8"?U=h.UNSIGNED_BYTE:(U=h.UNSIGNED_BYTE,oe=!1,D="uint8");var se=1;if(B.length===2)X=h.LUMINANCE,B=[B[0],B[1],1],F=a(F.data,B,[F.stride[0],F.stride[1],1],F.offset);else if(B.length===3){if(B[2]===1)X=h.ALPHA;else if(B[2]===2)X=h.LUMINANCE_ALPHA;else if(B[2]===3)X=h.RGB;else if(B[2]===4)X=h.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");se=B[2]}else throw new Error("gl-texture2d: Invalid shape for texture");if((X===h.LUMINANCE||X===h.ALPHA)&&(z===h.LUMINANCE||z===h.ALPHA)&&(X=z),X!==z)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var q=F.size,K=I.indexOf(R)<0;if(K&&I.push(R),U===O&&oe)F.offset===0&&F.data.length===q?K?h.texImage2D(h.TEXTURE_2D,R,z,B[0],B[1],0,z,O,F.data):h.texSubImage2D(h.TEXTURE_2D,R,o,S,B[0],B[1],z,O,F.data):K?h.texImage2D(h.TEXTURE_2D,R,z,B[0],B[1],0,z,O,F.data.subarray(F.offset,F.offset+q)):h.texSubImage2D(h.TEXTURE_2D,R,o,S,B[0],B[1],z,O,F.data.subarray(F.offset,F.offset+q));else{var G;O===h.FLOAT?G=i.mallocFloat32(q):G=i.mallocUint8(q);var Q=a(G,B,[B[2],B[2]*B[0],1]);U===h.FLOAT&&O===h.UNSIGNED_BYTE?x(Q,F):t.assign(Q,F),K?h.texImage2D(h.TEXTURE_2D,R,z,B[0],B[1],0,z,O,G.subarray(0,q)):h.texSubImage2D(h.TEXTURE_2D,R,o,S,B[0],B[1],z,O,G.subarray(0,q)),O===h.FLOAT?i.freeFloat32(G):i.freeUint8(G)}}function T(h){var o=h.createTexture();return h.bindTexture(h.TEXTURE_2D,o),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.NEAREST),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),o}function w(h,o,S,R,z){var O=h.getParameter(h.MAX_TEXTURE_SIZE);if(o<0||o>O||S<0||S>O)throw new Error("gl-texture2d: Invalid texture shape");if(z===h.FLOAT&&!h.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var I=T(h);return h.texImage2D(h.TEXTURE_2D,0,R,o,S,0,R,z,null),new v(h,I,o,S,R,z)}function A(h,o,S,R,z,O){var I=T(h);return h.texImage2D(h.TEXTURE_2D,0,z,z,O,o),new v(h,I,S,R,z,O)}function f(h,o){var S=o.dtype,R=o.shape.slice(),z=h.getParameter(h.MAX_TEXTURE_SIZE);if(R[0]<0||R[0]>z||R[1]<0||R[1]>z)throw new Error("gl-texture2d: Invalid texture size");var O=l(R,o.stride.slice()),I=0;S==="float32"?I=h.FLOAT:S==="float64"?(I=h.FLOAT,O=!1,S="float32"):S==="uint8"?I=h.UNSIGNED_BYTE:(I=h.UNSIGNED_BYTE,O=!1,S="uint8");var F=0;if(R.length===2)F=h.LUMINANCE,R=[R[0],R[1],1],o=a(o.data,R,[o.stride[0],o.stride[1],1],o.offset);else if(R.length===3)if(R[2]===1)F=h.ALPHA;else if(R[2]===2)F=h.LUMINANCE_ALPHA;else if(R[2]===3)F=h.RGB;else if(R[2]===4)F=h.RGBA;else throw new Error("gl-texture2d: Invalid shape for pixel coords");else throw new Error("gl-texture2d: Invalid shape for texture");I===h.FLOAT&&!h.getExtension("OES_texture_float")&&(I=h.UNSIGNED_BYTE,O=!1);var D,B,U=o.size;if(O)o.offset===0&&o.data.length===U?D=o.data:D=o.data.subarray(o.offset,o.offset+U);else{var X=[R[2],R[2]*R[0],1];B=i.malloc(U,S);var oe=a(B,R,X,0);(S==="float32"||S==="float64")&&I===h.UNSIGNED_BYTE?x(oe,o):t.assign(oe,o),D=B.subarray(0,U)}var se=T(h);return h.texImage2D(h.TEXTURE_2D,0,F,R[0],R[1],0,F,I,D),O||i.free(B),new v(h,se,R[0],R[1],F,I)}function u(h){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(n||s(h),typeof arguments[1]=="number")return w(h,arguments[1],arguments[2],arguments[3]||h.RGBA,arguments[4]||h.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return w(h,arguments[1][0]|0,arguments[1][1]|0,arguments[2]||h.RGBA,arguments[3]||h.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var o=arguments[1],S=m(o)?o:o.raw;if(S)return A(h,S,o.width|0,o.height|0,arguments[2]||h.RGBA,arguments[3]||h.UNSIGNED_BYTE);if(o.shape&&o.data&&o.stride)return f(h,o)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(e,p,g){"use strict";function a(t,i,n){i?i.bind():t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null);var r=t.getParameter(t.MAX_VERTEX_ATTRIBS)|0;if(n){if(n.length>r)throw new Error("gl-vao: Too many vertex attributes");for(var d=0;d<n.length;++d){var s=n[d];if(s.buffer){var m=s.buffer,x=s.size||4,M=s.type||t.FLOAT,v=!!s.normalized,_=s.stride||0,l=s.offset||0;m.bind(),t.enableVertexAttribArray(d),t.vertexAttribPointer(d,x,M,v,_,l)}else{if(typeof s=="number")t.vertexAttrib1f(d,s);else if(s.length===1)t.vertexAttrib1f(d,s[0]);else if(s.length===2)t.vertexAttrib2f(d,s[0],s[1]);else if(s.length===3)t.vertexAttrib3f(d,s[0],s[1],s[2]);else if(s.length===4)t.vertexAttrib4f(d,s[0],s[1],s[2],s[3]);else throw new Error("gl-vao: Invalid vertex attribute");t.disableVertexAttribArray(d)}}for(;d<r;++d)t.disableVertexAttribArray(d)}else{t.bindBuffer(t.ARRAY_BUFFER,null);for(var d=0;d<r;++d)t.disableVertexAttribArray(d)}}p.exports=a},{}],148:[function(e,p,g){"use strict";var a=e("./do-bind.js");function t(n){this.gl=n,this._elements=null,this._attributes=null,this._elementsType=n.UNSIGNED_SHORT}t.prototype.bind=function(){a(this.gl,this._elements,this._attributes)},t.prototype.update=function(n,r,d){this._elements=r,this._attributes=n,this._elementsType=d||this.gl.UNSIGNED_SHORT},t.prototype.dispose=function(){},t.prototype.unbind=function(){},t.prototype.draw=function(n,r,d){d=d||0;var s=this.gl;this._elements?s.drawElements(n,r,this._elementsType,d):s.drawArrays(n,d,r)};function i(n){return new t(n)}p.exports=i},{"./do-bind.js":147}],149:[function(e,p,g){"use strict";var a=e("./do-bind.js");function t(r,d,s,m,x,M){this.location=r,this.dimension=d,this.a=s,this.b=m,this.c=x,this.d=M}t.prototype.bind=function(r){switch(this.dimension){case 1:r.vertexAttrib1f(this.location,this.a);break;case 2:r.vertexAttrib2f(this.location,this.a,this.b);break;case 3:r.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:r.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d);break}};function i(r,d,s){this.gl=r,this._ext=d,this.handle=s,this._attribs=[],this._useElements=!1,this._elementsType=r.UNSIGNED_SHORT}i.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var r=0;r<this._attribs.length;++r)this._attribs[r].bind(this.gl)},i.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},i.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},i.prototype.update=function(r,d,s){if(this.bind(),a(this.gl,d,r),this.unbind(),this._attribs.length=0,r)for(var m=0;m<r.length;++m){var x=r[m];typeof x=="number"?this._attribs.push(new t(m,1,x)):Array.isArray(x)&&this._attribs.push(new t(m,x.length,x[0],x[1],x[2],x[3]))}this._useElements=!!d,this._elementsType=s||this.gl.UNSIGNED_SHORT},i.prototype.draw=function(r,d,s){s=s||0;var m=this.gl;this._useElements?m.drawElements(r,d,this._elementsType,s):m.drawArrays(r,s,d)};function n(r,d){return new i(r,d,d.createVertexArrayOES())}p.exports=n},{"./do-bind.js":147}],150:[function(e,p,g){"use strict";var a=e("./lib/vao-native.js"),t=e("./lib/vao-emulated.js");function i(r){this.bindVertexArrayOES=r.bindVertexArray.bind(r),this.createVertexArrayOES=r.createVertexArray.bind(r),this.deleteVertexArrayOES=r.deleteVertexArray.bind(r)}function n(r,d,s,m){var x=r.createVertexArray?new i(r):r.getExtension("OES_vertex_array_object"),M;return x?M=a(r,x):M=t(r),M.update(d,s,m),M}p.exports=n},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}},{}],152:[function(e,p,g){p.exports=n;var a=e("./fromValues"),t=e("./normalize"),i=e("./dot");function n(r,d){var s=a(r[0],r[1],r[2]),m=a(d[0],d[1],d[2]);t(s,s),t(m,m);var x=i(s,m);return x>1?0:Math.acos(x)}},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(e,p,g){p.exports=a;function a(t,i){return t[0]=Math.ceil(i[0]),t[1]=Math.ceil(i[1]),t[2]=Math.ceil(i[2]),t}},{}],154:[function(e,p,g){p.exports=a;function a(t){var i=new Float32Array(3);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i}},{}],155:[function(e,p,g){p.exports=a;function a(t,i){return t[0]=i[0],t[1]=i[1],t[2]=i[2],t}},{}],156:[function(e,p,g){p.exports=a;function a(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}},{}],157:[function(e,p,g){p.exports=a;function a(t,i,n){var r=i[0],d=i[1],s=i[2],m=n[0],x=n[1],M=n[2];return t[0]=d*M-s*x,t[1]=s*m-r*M,t[2]=r*x-d*m,t}},{}],158:[function(e,p,g){p.exports=e("./distance")},{"./distance":159}],159:[function(e,p,g){p.exports=a;function a(t,i){var n=i[0]-t[0],r=i[1]-t[1],d=i[2]-t[2];return Math.sqrt(n*n+r*r+d*d)}},{}],160:[function(e,p,g){p.exports=e("./divide")},{"./divide":161}],161:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]/n[0],t[1]=i[1]/n[1],t[2]=i[2]/n[2],t}},{}],162:[function(e,p,g){p.exports=a;function a(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]}},{}],163:[function(e,p,g){p.exports=1e-6},{}],164:[function(e,p,g){p.exports=t;var a=e("./epsilon");function t(i,n){var r=i[0],d=i[1],s=i[2],m=n[0],x=n[1],M=n[2];return Math.abs(r-m)<=a*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(d-x)<=a*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(s-M)<=a*Math.max(1,Math.abs(s),Math.abs(M))}},{"./epsilon":163}],165:[function(e,p,g){p.exports=a;function a(t,i){return t[0]===i[0]&&t[1]===i[1]&&t[2]===i[2]}},{}],166:[function(e,p,g){p.exports=a;function a(t,i){return t[0]=Math.floor(i[0]),t[1]=Math.floor(i[1]),t[2]=Math.floor(i[2]),t}},{}],167:[function(e,p,g){p.exports=t;var a=e("./create")();function t(i,n,r,d,s,m){var x,M;for(n||(n=3),r||(r=0),d?M=Math.min(d*n+r,i.length):M=i.length,x=r;x<M;x+=n)a[0]=i[x],a[1]=i[x+1],a[2]=i[x+2],s(a,a,m),i[x]=a[0],i[x+1]=a[1],i[x+2]=a[2];return i}},{"./create":156}],168:[function(e,p,g){p.exports=a;function a(t,i,n){var r=new Float32Array(3);return r[0]=t,r[1]=i,r[2]=n,r}},{}],169:[function(e,p,g){p.exports={EPSILON:e("./epsilon"),create:e("./create"),clone:e("./clone"),angle:e("./angle"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),equals:e("./equals"),exactEquals:e("./exactEquals"),add:e("./add"),subtract:e("./subtract"),sub:e("./sub"),multiply:e("./multiply"),mul:e("./mul"),divide:e("./divide"),div:e("./div"),min:e("./min"),max:e("./max"),floor:e("./floor"),ceil:e("./ceil"),round:e("./round"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),dist:e("./dist"),squaredDistance:e("./squaredDistance"),sqrDist:e("./sqrDist"),length:e("./length"),len:e("./len"),squaredLength:e("./squaredLength"),sqrLen:e("./sqrLen"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),cross:e("./cross"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformMat3:e("./transformMat3"),transformQuat:e("./transformQuat"),rotateX:e("./rotateX"),rotateY:e("./rotateY"),rotateZ:e("./rotateZ"),forEach:e("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(e,p,g){p.exports=a;function a(t,i){return t[0]=1/i[0],t[1]=1/i[1],t[2]=1/i[2],t}},{}],171:[function(e,p,g){p.exports=e("./length")},{"./length":172}],172:[function(e,p,g){p.exports=a;function a(t){var i=t[0],n=t[1],r=t[2];return Math.sqrt(i*i+n*n+r*r)}},{}],173:[function(e,p,g){p.exports=a;function a(t,i,n,r){var d=i[0],s=i[1],m=i[2];return t[0]=d+r*(n[0]-d),t[1]=s+r*(n[1]-s),t[2]=m+r*(n[2]-m),t}},{}],174:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=Math.max(i[0],n[0]),t[1]=Math.max(i[1],n[1]),t[2]=Math.max(i[2],n[2]),t}},{}],175:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=Math.min(i[0],n[0]),t[1]=Math.min(i[1],n[1]),t[2]=Math.min(i[2],n[2]),t}},{}],176:[function(e,p,g){p.exports=e("./multiply")},{"./multiply":177}],177:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]*n[0],t[1]=i[1]*n[1],t[2]=i[2]*n[2],t}},{}],178:[function(e,p,g){p.exports=a;function a(t,i){return t[0]=-i[0],t[1]=-i[1],t[2]=-i[2],t}},{}],179:[function(e,p,g){p.exports=a;function a(t,i){var n=i[0],r=i[1],d=i[2],s=n*n+r*r+d*d;return s>0&&(s=1/Math.sqrt(s),t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s),t}},{}],180:[function(e,p,g){p.exports=a;function a(t,i){i=i||1;var n=Math.random()*2*Math.PI,r=Math.random()*2-1,d=Math.sqrt(1-r*r)*i;return t[0]=Math.cos(n)*d,t[1]=Math.sin(n)*d,t[2]=r*i,t}},{}],181:[function(e,p,g){p.exports=a;function a(t,i,n,r){var d=n[1],s=n[2],m=i[1]-d,x=i[2]-s,M=Math.sin(r),v=Math.cos(r);return t[0]=i[0],t[1]=d+m*v-x*M,t[2]=s+m*M+x*v,t}},{}],182:[function(e,p,g){p.exports=a;function a(t,i,n,r){var d=n[0],s=n[2],m=i[0]-d,x=i[2]-s,M=Math.sin(r),v=Math.cos(r);return t[0]=d+x*M+m*v,t[1]=i[1],t[2]=s+x*v-m*M,t}},{}],183:[function(e,p,g){p.exports=a;function a(t,i,n,r){var d=n[0],s=n[1],m=i[0]-d,x=i[1]-s,M=Math.sin(r),v=Math.cos(r);return t[0]=d+m*v-x*M,t[1]=s+m*M+x*v,t[2]=i[2],t}},{}],184:[function(e,p,g){p.exports=a;function a(t,i){return t[0]=Math.round(i[0]),t[1]=Math.round(i[1]),t[2]=Math.round(i[2]),t}},{}],185:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t}},{}],186:[function(e,p,g){p.exports=a;function a(t,i,n,r){return t[0]=i[0]+n[0]*r,t[1]=i[1]+n[1]*r,t[2]=i[2]+n[2]*r,t}},{}],187:[function(e,p,g){p.exports=a;function a(t,i,n,r){return t[0]=i,t[1]=n,t[2]=r,t}},{}],188:[function(e,p,g){p.exports=e("./squaredDistance")},{"./squaredDistance":190}],189:[function(e,p,g){p.exports=e("./squaredLength")},{"./squaredLength":191}],190:[function(e,p,g){p.exports=a;function a(t,i){var n=i[0]-t[0],r=i[1]-t[1],d=i[2]-t[2];return n*n+r*r+d*d}},{}],191:[function(e,p,g){p.exports=a;function a(t){var i=t[0],n=t[1],r=t[2];return i*i+n*n+r*r}},{}],192:[function(e,p,g){p.exports=e("./subtract")},{"./subtract":193}],193:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]-n[0],t[1]=i[1]-n[1],t[2]=i[2]-n[2],t}},{}],194:[function(e,p,g){p.exports=a;function a(t,i,n){var r=i[0],d=i[1],s=i[2];return t[0]=r*n[0]+d*n[3]+s*n[6],t[1]=r*n[1]+d*n[4]+s*n[7],t[2]=r*n[2]+d*n[5]+s*n[8],t}},{}],195:[function(e,p,g){p.exports=a;function a(t,i,n){var r=i[0],d=i[1],s=i[2],m=n[3]*r+n[7]*d+n[11]*s+n[15];return m=m||1,t[0]=(n[0]*r+n[4]*d+n[8]*s+n[12])/m,t[1]=(n[1]*r+n[5]*d+n[9]*s+n[13])/m,t[2]=(n[2]*r+n[6]*d+n[10]*s+n[14])/m,t}},{}],196:[function(e,p,g){p.exports=a;function a(t,i,n){var r=i[0],d=i[1],s=i[2],m=n[0],x=n[1],M=n[2],v=n[3],_=v*r+x*s-M*d,l=v*d+M*r-m*s,y=v*s+m*d-x*r,T=-m*r-x*d-M*s;return t[0]=_*v+T*-m+l*-M-y*-x,t[1]=l*v+T*-x+y*-m-_*-M,t[2]=y*v+T*-M+_*-x-l*-m,t}},{}],197:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t[3]=i[3]+n[3],t}},{}],198:[function(e,p,g){p.exports=a;function a(t){var i=new Float32Array(4);return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i}},{}],199:[function(e,p,g){p.exports=a;function a(t,i){return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t}},{}],200:[function(e,p,g){p.exports=a;function a(){var t=new Float32Array(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}},{}],201:[function(e,p,g){p.exports=a;function a(t,i){var n=i[0]-t[0],r=i[1]-t[1],d=i[2]-t[2],s=i[3]-t[3];return Math.sqrt(n*n+r*r+d*d+s*s)}},{}],202:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]/n[0],t[1]=i[1]/n[1],t[2]=i[2]/n[2],t[3]=i[3]/n[3],t}},{}],203:[function(e,p,g){p.exports=a;function a(t,i){return t[0]*i[0]+t[1]*i[1]+t[2]*i[2]+t[3]*i[3]}},{}],204:[function(e,p,g){p.exports=a;function a(t,i,n,r){var d=new Float32Array(4);return d[0]=t,d[1]=i,d[2]=n,d[3]=r,d}},{}],205:[function(e,p,g){p.exports={create:e("./create"),clone:e("./clone"),fromValues:e("./fromValues"),copy:e("./copy"),set:e("./set"),add:e("./add"),subtract:e("./subtract"),multiply:e("./multiply"),divide:e("./divide"),min:e("./min"),max:e("./max"),scale:e("./scale"),scaleAndAdd:e("./scaleAndAdd"),distance:e("./distance"),squaredDistance:e("./squaredDistance"),length:e("./length"),squaredLength:e("./squaredLength"),negate:e("./negate"),inverse:e("./inverse"),normalize:e("./normalize"),dot:e("./dot"),lerp:e("./lerp"),random:e("./random"),transformMat4:e("./transformMat4"),transformQuat:e("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(e,p,g){p.exports=a;function a(t,i){return t[0]=1/i[0],t[1]=1/i[1],t[2]=1/i[2],t[3]=1/i[3],t}},{}],207:[function(e,p,g){p.exports=a;function a(t){var i=t[0],n=t[1],r=t[2],d=t[3];return Math.sqrt(i*i+n*n+r*r+d*d)}},{}],208:[function(e,p,g){p.exports=a;function a(t,i,n,r){var d=i[0],s=i[1],m=i[2],x=i[3];return t[0]=d+r*(n[0]-d),t[1]=s+r*(n[1]-s),t[2]=m+r*(n[2]-m),t[3]=x+r*(n[3]-x),t}},{}],209:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=Math.max(i[0],n[0]),t[1]=Math.max(i[1],n[1]),t[2]=Math.max(i[2],n[2]),t[3]=Math.max(i[3],n[3]),t}},{}],210:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=Math.min(i[0],n[0]),t[1]=Math.min(i[1],n[1]),t[2]=Math.min(i[2],n[2]),t[3]=Math.min(i[3],n[3]),t}},{}],211:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]*n[0],t[1]=i[1]*n[1],t[2]=i[2]*n[2],t[3]=i[3]*n[3],t}},{}],212:[function(e,p,g){p.exports=a;function a(t,i){return t[0]=-i[0],t[1]=-i[1],t[2]=-i[2],t[3]=-i[3],t}},{}],213:[function(e,p,g){p.exports=a;function a(t,i){var n=i[0],r=i[1],d=i[2],s=i[3],m=n*n+r*r+d*d+s*s;return m>0&&(m=1/Math.sqrt(m),t[0]=n*m,t[1]=r*m,t[2]=d*m,t[3]=s*m),t}},{}],214:[function(e,p,g){var a=e("./normalize"),t=e("./scale");p.exports=i;function i(n,r){return r=r||1,n[0]=Math.random(),n[1]=Math.random(),n[2]=Math.random(),n[3]=Math.random(),a(n,n),t(n,n,r),n}},{"./normalize":213,"./scale":215}],215:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=i[3]*n,t}},{}],216:[function(e,p,g){p.exports=a;function a(t,i,n,r){return t[0]=i[0]+n[0]*r,t[1]=i[1]+n[1]*r,t[2]=i[2]+n[2]*r,t[3]=i[3]+n[3]*r,t}},{}],217:[function(e,p,g){p.exports=a;function a(t,i,n,r,d){return t[0]=i,t[1]=n,t[2]=r,t[3]=d,t}},{}],218:[function(e,p,g){p.exports=a;function a(t,i){var n=i[0]-t[0],r=i[1]-t[1],d=i[2]-t[2],s=i[3]-t[3];return n*n+r*r+d*d+s*s}},{}],219:[function(e,p,g){p.exports=a;function a(t){var i=t[0],n=t[1],r=t[2],d=t[3];return i*i+n*n+r*r+d*d}},{}],220:[function(e,p,g){p.exports=a;function a(t,i,n){return t[0]=i[0]-n[0],t[1]=i[1]-n[1],t[2]=i[2]-n[2],t[3]=i[3]-n[3],t}},{}],221:[function(e,p,g){p.exports=a;function a(t,i,n){var r=i[0],d=i[1],s=i[2],m=i[3];return t[0]=n[0]*r+n[4]*d+n[8]*s+n[12]*m,t[1]=n[1]*r+n[5]*d+n[9]*s+n[13]*m,t[2]=n[2]*r+n[6]*d+n[10]*s+n[14]*m,t[3]=n[3]*r+n[7]*d+n[11]*s+n[15]*m,t}},{}],222:[function(e,p,g){p.exports=a;function a(t,i,n){var r=i[0],d=i[1],s=i[2],m=n[0],x=n[1],M=n[2],v=n[3],_=v*r+x*s-M*d,l=v*d+M*r-m*s,y=v*s+m*d-x*r,T=-m*r-x*d-M*s;return t[0]=_*v+T*-m+l*-M-y*-x,t[1]=l*v+T*-x+y*-m-_*-M,t[2]=y*v+T*-M+_*-x-l*-m,t[3]=i[3],t}},{}],223:[function(e,p,g){var a=e("glsl-tokenizer"),t=e("atob-lite");p.exports=i;function i(n){for(var r=Array.isArray(n)?n:a(n),d=0;d<r.length;d++){var s=r[d];if(s.type==="preprocessor"){var m=s.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(!!m&&!!m[2]){var x=m[1],M=m[2];return(x?t(M):M).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(e,p,g){p.exports=o;var a=e("./lib/literals"),t=e("./lib/operators"),i=e("./lib/builtins"),n=e("./lib/literals-300es"),r=e("./lib/builtins-300es"),d=999,s=9999,m=0,x=1,M=2,v=3,_=4,l=5,y=6,T=7,w=8,A=9,f=10,u=11,h=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function o(S){var R=0,z=0,O=d,I,F,D=[],B=[],U=0,X=0,oe=1,se=0,q=0,K=!1,G=!1,Q="",V;S=S||{};var H=i,ee=a;S.version==="300 es"&&(H=r,ee=n);for(var J={},W={},R=0;R<H.length;R++)J[H[R]]=!0;for(var R=0;R<ee.length;R++)W[ee[R]]=!0;return function(ye){return B=[],ye!==null?j(ye):Z()};function re(ye){ye.length&&B.push({type:h[O],data:ye,position:q,line:oe,column:se})}function j(ye){R=0,ye.toString&&(ye=ye.toString()),Q+=ye.replace(/\r\n/g,`
`),V=Q.length;for(var ke;I=Q[R],R<V;){switch(ke=R,O){case m:R=xe();break;case x:R=pe();break;case M:R=ge();break;case v:R=Ee();break;case _:R=be();break;case u:R=de();break;case l:R=Le();break;case s:R=De();break;case A:R=le();break;case d:R=ne();break}if(ke!==R)switch(Q[ke]){case`
`:se=0,++oe;break;default:++se;break}}return z+=R,Q=Q.slice(R),B}function Z(ye){return D.length&&re(D.join("")),O=f,re("(eof)"),B}function ne(){return D=D.length?[]:D,F==="/"&&I==="*"?(q=z+R-1,O=m,F=I,R+1):F==="/"&&I==="/"?(q=z+R-1,O=x,F=I,R+1):I==="#"?(O=M,q=z+R,R):/\s/.test(I)?(O=A,q=z+R,R):(K=/\d/.test(I),G=/[^\w_]/.test(I),q=z+R,O=K?_:G?v:s,R)}function le(){return/[^\s]/g.test(I)?(re(D.join("")),O=d,R):(D.push(I),F=I,R+1)}function ge(){return(I==="\r"||I===`
`)&&F!=="\\"?(re(D.join("")),O=d,R):(D.push(I),F=I,R+1)}function pe(){return ge()}function xe(){return I==="/"&&F==="*"?(D.push(I),re(D.join("")),O=d,R+1):(D.push(I),F=I,R+1)}function Ee(){if(F==="."&&/\d/.test(I))return O=l,R;if(F==="/"&&I==="*")return O=m,R;if(F==="/"&&I==="/")return O=x,R;if(I==="."&&D.length){for(;Te(D););return O=l,R}if(I===";"||I===")"||I==="("){if(D.length)for(;Te(D););return re(I),O=d,R+1}var ye=D.length===2&&I!=="=";if(/[\w_\d\s]/.test(I)||ye){for(;Te(D););return O=d,R}return D.push(I),F=I,R+1}function Te(ye){var ke=0,Oe,Qe;do{if(Oe=t.indexOf(ye.slice(0,ye.length+ke).join("")),Qe=t[Oe],Oe===-1){if(ke--+ye.length>0)continue;Qe=ye.slice(0,1).join("")}return re(Qe),q+=Qe.length,D=D.slice(Qe.length),D.length}while(1)}function de(){return/[^a-fA-F0-9]/.test(I)?(re(D.join("")),O=d,R):(D.push(I),F=I,R+1)}function be(){return I==="."||/[eE]/.test(I)?(D.push(I),O=l,F=I,R+1):I==="x"&&D.length===1&&D[0]==="0"?(O=u,D.push(I),F=I,R+1):/[^\d]/.test(I)?(re(D.join("")),O=d,R):(D.push(I),F=I,R+1)}function Le(){return I==="f"&&(D.push(I),F=I,R+=1),/[eE]/.test(I)||(I==="-"||I==="+")&&/[eE]/.test(F)?(D.push(I),F=I,R+1):/[^\d]/.test(I)?(re(D.join("")),O=d,R):(D.push(I),F=I,R+1)}function De(){if(/[^\d\w_]/.test(I)){var ye=D.join("");return W[ye]?O=w:J[ye]?O=T:O=y,re(D.join("")),O=d,R}return D.push(I),F=I,R+1}}},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(e,p,g){var a=e("./builtins");a=a.slice().filter(function(t){return!/^(gl\_|texture)/.test(t)}),p.exports=a.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(e,p,g){p.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(e,p,g){var a=e("./literals");p.exports=a.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(e,p,g){p.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(e,p,g){p.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(e,p,g){var a=e("./index");p.exports=t;function t(i,n){var r=a(n),d=[];return d=d.concat(r(i)),d=d.concat(r(null)),d}},{"./index":224}],231:[function(e,p,g){p.exports=function(a){typeof a=="string"&&(a=[a]);for(var t=[].slice.call(arguments,1),i=[],n=0;n<a.length-1;n++)i.push(a[n],t[n]||"");return i.push(a[n]),i.join("")}},{}],232:[function(e,p,g){"use strict";var a=e("is-browser");function t(){var i=!1;try{var n=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("test",null,n),window.removeEventListener("test",null,n)}catch{i=!1}return i}p.exports=a&&t()},{"is-browser":236}],233:[function(e,p,g){"use strict";p.exports=v;var a=e("robust-orientation"),t=e("simplicial-complex").compareCells;function i(_,l,y){this.vertices=_,this.adjacent=l,this.boundary=y,this.lastVisited=-1}i.prototype.flip=function(){var _=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=_;var l=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=l};function n(_,l,y){this.vertices=_,this.cell=l,this.index=y}function r(_,l){return t(_.vertices,l.vertices)}function d(_){return function(){var l=this.tuple;return _.apply(this,l)}}function s(_){var l=a[_+1];return l||(l=a),d(l)}var m=[];function x(_,l,y){this.dimension=_,this.vertices=l,this.simplices=y,this.interior=y.filter(function(A){return!A.boundary}),this.tuple=new Array(_+1);for(var T=0;T<=_;++T)this.tuple[T]=this.vertices[T];var w=m[_];w||(w=m[_]=s(_)),this.orient=w}var M=x.prototype;M.handleBoundaryDegeneracy=function(_,l){var y=this.dimension,T=this.vertices.length-1,w=this.tuple,A=this.vertices,f=[_];for(_.lastVisited=-T;f.length>0;){_=f.pop();for(var u=_.adjacent,h=0;h<=y;++h){var o=u[h];if(!(!o.boundary||o.lastVisited<=-T)){for(var S=o.vertices,R=0;R<=y;++R){var z=S[R];z<0?w[R]=l:w[R]=A[z]}var O=this.orient();if(O>0)return o;o.lastVisited=-T,O===0&&f.push(o)}}}return null},M.walk=function(_,l){var y=this.vertices.length-1,T=this.dimension,w=this.vertices,A=this.tuple,f=l?this.interior.length*Math.random()|0:this.interior.length-1,u=this.interior[f];e:for(;!u.boundary;){for(var h=u.vertices,o=u.adjacent,S=0;S<=T;++S)A[S]=w[h[S]];u.lastVisited=y;for(var S=0;S<=T;++S){var R=o[S];if(!(R.lastVisited>=y)){var z=A[S];A[S]=_;var O=this.orient();if(A[S]=z,O<0){u=R;continue e}else R.boundary?R.lastVisited=-y:R.lastVisited=y}}return}return u},M.addPeaks=function(_,l){var y=this.vertices.length-1,T=this.dimension,w=this.vertices,A=this.tuple,f=this.interior,u=this.simplices,h=[l];l.lastVisited=y,l.vertices[l.vertices.indexOf(-1)]=y,l.boundary=!1,f.push(l);for(var o=[];h.length>0;){var l=h.pop(),S=l.vertices,R=l.adjacent,z=S.indexOf(y);if(!(z<0)){for(var O=0;O<=T;++O)if(O!==z){var I=R[O];if(!(!I.boundary||I.lastVisited>=y)){var F=I.vertices;if(I.lastVisited!==-y){for(var D=0,B=0;B<=T;++B)F[B]<0?(D=B,A[B]=_):A[B]=w[F[B]];var U=this.orient();if(U>0){F[D]=y,I.boundary=!1,f.push(I),h.push(I),I.lastVisited=y;continue}else I.lastVisited=-y}var X=I.adjacent,oe=S.slice(),se=R.slice(),q=new i(oe,se,!0);u.push(q);var K=X.indexOf(l);if(!(K<0)){X[K]=q,se[z]=I,oe[O]=-1,se[O]=l,R[O]=q,q.flip();for(var B=0;B<=T;++B){var G=oe[B];if(!(G<0||G===y)){for(var Q=new Array(T-1),V=0,H=0;H<=T;++H){var ee=oe[H];ee<0||H===B||(Q[V++]=ee)}o.push(new n(Q,q,B))}}}}}}}o.sort(r);for(var O=0;O+1<o.length;O+=2){var J=o[O],W=o[O+1],re=J.index,j=W.index;re<0||j<0||(J.cell.adjacent[J.index]=W.cell,W.cell.adjacent[W.index]=J.cell)}},M.insert=function(_,l){var y=this.vertices;y.push(_);var T=this.walk(_,l);if(!!T){for(var w=this.dimension,A=this.tuple,f=0;f<=w;++f){var u=T.vertices[f];u<0?A[f]=_:A[f]=y[u]}var h=this.orient(A);h<0||h===0&&(T=this.handleBoundaryDegeneracy(T,_),!T)||this.addPeaks(_,T)}},M.boundary=function(){for(var _=this.dimension,l=[],y=this.simplices,T=y.length,w=0;w<T;++w){var A=y[w];if(A.boundary){for(var f=new Array(_),u=A.vertices,h=0,o=0,S=0;S<=_;++S)u[S]>=0?f[h++]=u[S]:o=S&1;if(o===(_&1)){var R=f[0];f[0]=f[1],f[1]=R}l.push(f)}}return l};function v(_,l){var y=_.length;if(y===0)throw new Error("Must have at least d+1 points");var T=_[0].length;if(y<=T)throw new Error("Must input at least d+1 points");var w=_.slice(0,T+1),A=a.apply(void 0,w);if(A===0)throw new Error("Input not in general position");for(var f=new Array(T+1),u=0;u<=T;++u)f[u]=u;A<0&&(f[0]=1,f[1]=0);for(var h=new i(f,new Array(T+1),!1),o=h.adjacent,S=new Array(T+2),u=0;u<=T;++u){for(var R=f.slice(),z=0;z<=T;++z)z===u&&(R[z]=-1);var O=R[0];R[0]=R[1],R[1]=O;var I=new i(R,new Array(T+1),!0);o[u]=I,S[u]=I}S[T+1]=h;for(var u=0;u<=T;++u)for(var R=o[u].vertices,F=o[u].adjacent,z=0;z<=T;++z){var D=R[z];if(D<0){F[z]=h;continue}for(var B=0;B<=T;++B)o[B].vertices.indexOf(D)<0&&(F[z]=o[B])}for(var U=new x(T,w,S),X=!!l,u=T+1;u<y;++u)U.insert(_[u],X);return U.boundary()}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(e,p,g){"use strict";var a=e("binary-search-bounds"),t=0,i=1,n=2;p.exports=h;function r(o,S,R,z,O){this.mid=o,this.left=S,this.right=R,this.leftPoints=z,this.rightPoints=O,this.count=(S?S.count:0)+(R?R.count:0)+z.length}var d=r.prototype;function s(o,S){o.mid=S.mid,o.left=S.left,o.right=S.right,o.leftPoints=S.leftPoints,o.rightPoints=S.rightPoints,o.count=S.count}function m(o,S){var R=A(S);o.mid=R.mid,o.left=R.left,o.right=R.right,o.leftPoints=R.leftPoints,o.rightPoints=R.rightPoints,o.count=R.count}function x(o,S){var R=o.intervals([]);R.push(S),m(o,R)}function M(o,S){var R=o.intervals([]),z=R.indexOf(S);return z<0?t:(R.splice(z,1),m(o,R),i)}d.intervals=function(o){return o.push.apply(o,this.leftPoints),this.left&&this.left.intervals(o),this.right&&this.right.intervals(o),o},d.insert=function(o){var S=this.count-this.leftPoints.length;if(this.count+=1,o[1]<this.mid)this.left?4*(this.left.count+1)>3*(S+1)?x(this,o):this.left.insert(o):this.left=A([o]);else if(o[0]>this.mid)this.right?4*(this.right.count+1)>3*(S+1)?x(this,o):this.right.insert(o):this.right=A([o]);else{var R=a.ge(this.leftPoints,o,T),z=a.ge(this.rightPoints,o,w);this.leftPoints.splice(R,0,o),this.rightPoints.splice(z,0,o)}},d.remove=function(o){var S=this.count-this.leftPoints;if(o[1]<this.mid){if(!this.left)return t;var R=this.right?this.right.count:0;if(4*R>3*(S-1))return M(this,o);var z=this.left.remove(o);return z===n?(this.left=null,this.count-=1,i):(z===i&&(this.count-=1),z)}else if(o[0]>this.mid){if(!this.right)return t;var O=this.left?this.left.count:0;if(4*O>3*(S-1))return M(this,o);var z=this.right.remove(o);return z===n?(this.right=null,this.count-=1,i):(z===i&&(this.count-=1),z)}else{if(this.count===1)return this.leftPoints[0]===o?n:t;if(this.leftPoints.length===1&&this.leftPoints[0]===o){if(this.left&&this.right){for(var I=this,F=this.left;F.right;)I=F,F=F.right;if(I===this)F.right=this.right;else{var D=this.left,z=this.right;I.count-=F.count,I.right=F.left,F.left=D,F.right=z}s(this,F),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?s(this,this.left):s(this,this.right);return i}for(var D=a.ge(this.leftPoints,o,T);D<this.leftPoints.length&&this.leftPoints[D][0]===o[0];++D)if(this.leftPoints[D]===o){this.count-=1,this.leftPoints.splice(D,1);for(var z=a.ge(this.rightPoints,o,w);z<this.rightPoints.length&&this.rightPoints[z][1]===o[1];++z)if(this.rightPoints[z]===o)return this.rightPoints.splice(z,1),i}return t}};function v(o,S,R){for(var z=0;z<o.length&&o[z][0]<=S;++z){var O=R(o[z]);if(O)return O}}function _(o,S,R){for(var z=o.length-1;z>=0&&o[z][1]>=S;--z){var O=R(o[z]);if(O)return O}}function l(o,S){for(var R=0;R<o.length;++R){var z=S(o[R]);if(z)return z}}d.queryPoint=function(o,S){if(o<this.mid){if(this.left){var R=this.left.queryPoint(o,S);if(R)return R}return v(this.leftPoints,o,S)}else if(o>this.mid){if(this.right){var R=this.right.queryPoint(o,S);if(R)return R}return _(this.rightPoints,o,S)}else return l(this.leftPoints,S)},d.queryInterval=function(o,S,R){if(o<this.mid&&this.left){var z=this.left.queryInterval(o,S,R);if(z)return z}if(S>this.mid&&this.right){var z=this.right.queryInterval(o,S,R);if(z)return z}return S<this.mid?v(this.leftPoints,S,R):o>this.mid?_(this.rightPoints,o,R):l(this.leftPoints,R)};function y(o,S){return o-S}function T(o,S){var R=o[0]-S[0];return R||o[1]-S[1]}function w(o,S){var R=o[1]-S[1];return R||o[0]-S[0]}function A(o){if(o.length===0)return null;for(var S=[],R=0;R<o.length;++R)S.push(o[R][0],o[R][1]);S.sort(y);for(var z=S[S.length>>1],O=[],I=[],F=[],R=0;R<o.length;++R){var D=o[R];D[1]<z?O.push(D):z<D[0]?I.push(D):F.push(D)}var B=F,U=F.slice();return B.sort(T),U.sort(w),new r(z,A(O),A(I),B,U)}function f(o){this.root=o}var u=f.prototype;u.insert=function(o){this.root?this.root.insert(o):this.root=new r(o[0],null,null,[o],[o])},u.remove=function(o){if(this.root){var S=this.root.remove(o);return S===n&&(this.root=null),S!==t}return!1},u.queryPoint=function(o,S){if(this.root)return this.root.queryPoint(o,S)},u.queryInterval=function(o,S,R){if(o<=S&&this.root)return this.root.queryInterval(o,S,R)},Object.defineProperty(u,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(u,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function h(o){return!o||o.length===0?new f(null):new f(A(o))}},{"binary-search-bounds":31}],235:[function(e,p,g){"use strict";function a(t){for(var i=new Array(t),n=0;n<t;++n)i[n]=n;return i}p.exports=a},{}],236:[function(e,p,g){p.exports=!0},{}],237:[function(e,p,g){p.exports=function(i){return i!=null&&(a(i)||t(i)||!!i._isBuffer)};function a(i){return!!i.constructor&&typeof i.constructor.isBuffer=="function"&&i.constructor.isBuffer(i)}function t(i){return typeof i.readFloatLE=="function"&&typeof i.slice=="function"&&a(i.slice(0,0))}},{}],238:[function(e,p,g){"use strict";p.exports=i,p.exports.isMobile=i,p.exports.default=i;var a=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function i(n){n||(n={});var r=n.ua;if(!r&&typeof navigator<"u"&&(r=navigator.userAgent),r&&r.headers&&typeof r.headers["user-agent"]=="string"&&(r=r.headers["user-agent"]),typeof r!="string")return!1;var d=n.tablet?t.test(r):a.test(r);return!d&&n.tablet&&n.featureDetect&&navigator&&navigator.maxTouchPoints>1&&r.indexOf("Macintosh")!==-1&&r.indexOf("Safari")!==-1&&(d=!0),d}},{}],239:[function(e,p,g){"use strict";p.exports=function(a){for(var t=a.length,i,n=0;n<t;n++)if(i=a.charCodeAt(n),(i<9||i>13)&&i!==32&&i!==133&&i!==160&&i!==5760&&i!==6158&&(i<8192||i>8205)&&i!==8232&&i!==8233&&i!==8239&&i!==8287&&i!==8288&&i!==12288&&i!==65279)return!1;return!0}},{}],240:[function(e,p,g){function a(t,i,n){return t*(1-n)+i*n}p.exports=a},{}],241:[function(e,p,g){var a=e("./normalize"),t=e("gl-mat4/create"),i=e("gl-mat4/clone"),n=e("gl-mat4/determinant"),r=e("gl-mat4/invert"),d=e("gl-mat4/transpose"),s={length:e("gl-vec3/length"),normalize:e("gl-vec3/normalize"),dot:e("gl-vec3/dot"),cross:e("gl-vec3/cross")},m=t(),x=t(),M=[0,0,0,0],v=[[0,0,0],[0,0,0],[0,0,0]],_=[0,0,0];p.exports=function(A,f,u,h,o,S){if(f||(f=[0,0,0]),u||(u=[0,0,0]),h||(h=[0,0,0]),o||(o=[0,0,0,1]),S||(S=[0,0,0,1]),!a(m,A)||(i(x,m),x[3]=0,x[7]=0,x[11]=0,x[15]=1,Math.abs(n(x)<1e-8)))return!1;var R=m[3],z=m[7],O=m[11],I=m[12],F=m[13],D=m[14],B=m[15];if(R!==0||z!==0||O!==0){M[0]=R,M[1]=z,M[2]=O,M[3]=B;var U=r(x,x);if(!U)return!1;d(x,x),l(o,M,x)}else o[0]=o[1]=o[2]=0,o[3]=1;if(f[0]=I,f[1]=F,f[2]=D,y(v,m),u[0]=s.length(v[0]),s.normalize(v[0],v[0]),h[0]=s.dot(v[0],v[1]),T(v[1],v[1],v[0],1,-h[0]),u[1]=s.length(v[1]),s.normalize(v[1],v[1]),h[0]/=u[1],h[1]=s.dot(v[0],v[2]),T(v[2],v[2],v[0],1,-h[1]),h[2]=s.dot(v[1],v[2]),T(v[2],v[2],v[1],1,-h[2]),u[2]=s.length(v[2]),s.normalize(v[2],v[2]),h[1]/=u[2],h[2]/=u[2],s.cross(_,v[1],v[2]),s.dot(v[0],_)<0)for(var X=0;X<3;X++)u[X]*=-1,v[X][0]*=-1,v[X][1]*=-1,v[X][2]*=-1;return S[0]=.5*Math.sqrt(Math.max(1+v[0][0]-v[1][1]-v[2][2],0)),S[1]=.5*Math.sqrt(Math.max(1-v[0][0]+v[1][1]-v[2][2],0)),S[2]=.5*Math.sqrt(Math.max(1-v[0][0]-v[1][1]+v[2][2],0)),S[3]=.5*Math.sqrt(Math.max(1+v[0][0]+v[1][1]+v[2][2],0)),v[2][1]>v[1][2]&&(S[0]=-S[0]),v[0][2]>v[2][0]&&(S[1]=-S[1]),v[1][0]>v[0][1]&&(S[2]=-S[2]),!0};function l(w,A,f){var u=A[0],h=A[1],o=A[2],S=A[3];return w[0]=f[0]*u+f[4]*h+f[8]*o+f[12]*S,w[1]=f[1]*u+f[5]*h+f[9]*o+f[13]*S,w[2]=f[2]*u+f[6]*h+f[10]*o+f[14]*S,w[3]=f[3]*u+f[7]*h+f[11]*o+f[15]*S,w}function y(w,A){w[0][0]=A[0],w[0][1]=A[1],w[0][2]=A[2],w[1][0]=A[4],w[1][1]=A[5],w[1][2]=A[6],w[2][0]=A[8],w[2][1]=A[9],w[2][2]=A[10]}function T(w,A,f,u,h){w[0]=A[0]*u+f[0]*h,w[1]=A[1]*u+f[1]*h,w[2]=A[2]*u+f[2]*h}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(e,p,g){p.exports=function(t,i){var n=i[15];if(n===0)return!1;for(var r=1/n,d=0;d<16;d++)t[d]=i[d]*r;return!0}},{}],243:[function(e,p,g){var a=e("gl-vec3/lerp"),t=e("mat4-recompose"),i=e("mat4-decompose"),n=e("gl-mat4/determinant"),r=e("quat-slerp"),d=M(),s=M(),m=M();p.exports=x;function x(l,y,T,w){if(n(y)===0||n(T)===0)return!1;var A=i(y,d.translate,d.scale,d.skew,d.perspective,d.quaternion),f=i(T,s.translate,s.scale,s.skew,s.perspective,s.quaternion);return!A||!f?!1:(a(m.translate,d.translate,s.translate,w),a(m.skew,d.skew,s.skew,w),a(m.scale,d.scale,s.scale,w),a(m.perspective,d.perspective,s.perspective,w),r(m.quaternion,d.quaternion,s.quaternion,w),t(l,m.translate,m.scale,m.skew,m.perspective,m.quaternion),!0)}function M(){return{translate:v(),scale:v(1),skew:v(),perspective:_(),quaternion:_()}}function v(l){return[l||0,l||0,l||0]}function _(){return[0,0,0,1]}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(e,p,g){var a={identity:e("gl-mat4/identity"),translate:e("gl-mat4/translate"),multiply:e("gl-mat4/multiply"),create:e("gl-mat4/create"),scale:e("gl-mat4/scale"),fromRotationTranslation:e("gl-mat4/fromRotationTranslation")},t=a.create(),i=a.create();p.exports=function(r,d,s,m,x,M){return a.identity(r),a.fromRotationTranslation(r,M,d),r[3]=x[0],r[7]=x[1],r[11]=x[2],r[15]=x[3],a.identity(i),m[2]!==0&&(i[9]=m[2],a.multiply(r,r,i)),m[1]!==0&&(i[9]=0,i[8]=m[1],a.multiply(r,r,i)),m[0]!==0&&(i[8]=0,i[4]=m[0],a.multiply(r,r,i)),a.scale(r,r,s),r}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(e,p,g){"use strict";var a=e("binary-search-bounds"),t=e("mat4-interpolate"),i=e("gl-mat4/invert"),n=e("gl-mat4/rotateX"),r=e("gl-mat4/rotateY"),d=e("gl-mat4/rotateZ"),s=e("gl-mat4/lookAt"),m=e("gl-mat4/translate"),x=e("gl-mat4/scale"),M=e("gl-vec3/normalize"),v=[0,0,0];p.exports=T;function _(w){this._components=w.slice(),this._time=[0],this.prevMatrix=w.slice(),this.nextMatrix=w.slice(),this.computedMatrix=w.slice(),this.computedInverse=w.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}var l=_.prototype;l.recalcMatrix=function(w){var A=this._time,f=a.le(A,w),u=this.computedMatrix;if(!(f<0)){var h=this._components;if(f===A.length-1)for(var o=16*f,S=0;S<16;++S)u[S]=h[o++];else{for(var R=A[f+1]-A[f],o=16*f,z=this.prevMatrix,O=!0,S=0;S<16;++S)z[S]=h[o++];for(var I=this.nextMatrix,S=0;S<16;++S)I[S]=h[o++],O=O&&z[S]===I[S];if(R<1e-6||O)for(var S=0;S<16;++S)u[S]=z[S];else t(u,z,I,(w-A[f])/R)}var F=this.computedUp;F[0]=u[1],F[1]=u[5],F[2]=u[9],M(F,F);var D=this.computedInverse;i(D,u);var B=this.computedEye,U=D[15];B[0]=D[12]/U,B[1]=D[13]/U,B[2]=D[14]/U;for(var X=this.computedCenter,oe=Math.exp(this.computedRadius[0]),S=0;S<3;++S)X[S]=B[S]-u[2+4*S]*oe}},l.idle=function(w){if(!(w<this.lastT())){for(var A=this._components,f=A.length-16,u=0;u<16;++u)A.push(A[f++]);this._time.push(w)}},l.flush=function(w){var A=a.gt(this._time,w)-2;A<0||(this._time.splice(0,A),this._components.splice(0,16*A))},l.lastT=function(){return this._time[this._time.length-1]},l.lookAt=function(w,A,f,u){this.recalcMatrix(w),A=A||this.computedEye,f=f||v,u=u||this.computedUp,this.setMatrix(w,s(this.computedMatrix,A,f,u));for(var h=0,o=0;o<3;++o)h+=Math.pow(f[o]-A[o],2);h=Math.log(Math.sqrt(h)),this.computedRadius[0]=h},l.rotate=function(w,A,f,u){this.recalcMatrix(w);var h=this.computedInverse;A&&r(h,h,A),f&&n(h,h,f),u&&d(h,h,u),this.setMatrix(w,i(this.computedMatrix,h))};var y=[0,0,0];l.pan=function(w,A,f,u){y[0]=-(A||0),y[1]=-(f||0),y[2]=-(u||0),this.recalcMatrix(w);var h=this.computedInverse;m(h,h,y),this.setMatrix(w,i(h,h))},l.translate=function(w,A,f,u){y[0]=A||0,y[1]=f||0,y[2]=u||0,this.recalcMatrix(w);var h=this.computedMatrix;m(h,h,y),this.setMatrix(w,h)},l.setMatrix=function(w,A){if(!(w<this.lastT())){this._time.push(w);for(var f=0;f<16;++f)this._components.push(A[f])}},l.setDistance=function(w,A){this.computedRadius[0]=A},l.setDistanceLimits=function(w,A){var f=this._limits;f[0]=w,f[1]=A},l.getDistanceLimits=function(w){var A=this._limits;return w?(w[0]=A[0],w[1]=A[1],w):A};function T(w){w=w||{};var A=w.matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return new _(A)}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(e,p,g){"use strict";p.exports=t;var a=e("robust-orientation")[3];function t(i){var n=i.length;if(n<3){for(var _=new Array(n),r=0;r<n;++r)_[r]=r;return n===2&&i[0][0]===i[1][0]&&i[0][1]===i[1][1]?[0]:_}for(var d=new Array(n),r=0;r<n;++r)d[r]=r;d.sort(function(w,A){var f=i[w][0]-i[A][0];return f||i[w][1]-i[A][1]});for(var s=[d[0],d[1]],m=[d[0],d[1]],r=2;r<n;++r){for(var x=d[r],M=i[x],v=s.length;v>1&&a(i[s[v-2]],i[s[v-1]],M)<=0;)v-=1,s.pop();for(s.push(x),v=m.length;v>1&&a(i[m[v-2]],i[m[v-1]],M)>=0;)v-=1,m.pop();m.push(x)}for(var _=new Array(m.length+s.length-2),l=0,r=0,y=s.length;r<y;++r)_[l++]=s[r];for(var T=m.length-2;T>0;--T)_[l++]=m[T];return _}},{"robust-orientation":284}],247:[function(e,p,g){"use strict";p.exports=t;var a=e("mouse-event");function t(i,n){n||(n=i,i=window);var r=0,d=0,s=0,m={shift:!1,alt:!1,control:!1,meta:!1},x=!1;function M(o){var S=!1;return"altKey"in o&&(S=S||o.altKey!==m.alt,m.alt=!!o.altKey),"shiftKey"in o&&(S=S||o.shiftKey!==m.shift,m.shift=!!o.shiftKey),"ctrlKey"in o&&(S=S||o.ctrlKey!==m.control,m.control=!!o.ctrlKey),"metaKey"in o&&(S=S||o.metaKey!==m.meta,m.meta=!!o.metaKey),S}function v(o,S){var R=a.x(S),z=a.y(S);"buttons"in S&&(o=S.buttons|0),(o!==r||R!==d||z!==s||M(S))&&(r=o|0,d=R||0,s=z||0,n&&n(r,d,s,m))}function _(o){v(0,o)}function l(){(r||d||s||m.shift||m.alt||m.meta||m.control)&&(d=s=0,r=0,m.shift=m.alt=m.control=m.meta=!1,n&&n(0,0,0,m))}function y(o){M(o)&&n&&n(r,d,s,m)}function T(o){a.buttons(o)===0?v(0,o):v(r,o)}function w(o){v(r|a.buttons(o),o)}function A(o){v(r&~a.buttons(o),o)}function f(){x||(x=!0,i.addEventListener("mousemove",T),i.addEventListener("mousedown",w),i.addEventListener("mouseup",A),i.addEventListener("mouseleave",_),i.addEventListener("mouseenter",_),i.addEventListener("mouseout",_),i.addEventListener("mouseover",_),i.addEventListener("blur",l),i.addEventListener("keyup",y),i.addEventListener("keydown",y),i.addEventListener("keypress",y),i!==window&&(window.addEventListener("blur",l),window.addEventListener("keyup",y),window.addEventListener("keydown",y),window.addEventListener("keypress",y)))}function u(){!x||(x=!1,i.removeEventListener("mousemove",T),i.removeEventListener("mousedown",w),i.removeEventListener("mouseup",A),i.removeEventListener("mouseleave",_),i.removeEventListener("mouseenter",_),i.removeEventListener("mouseout",_),i.removeEventListener("mouseover",_),i.removeEventListener("blur",l),i.removeEventListener("keyup",y),i.removeEventListener("keydown",y),i.removeEventListener("keypress",y),i!==window&&(window.removeEventListener("blur",l),window.removeEventListener("keyup",y),window.removeEventListener("keydown",y),window.removeEventListener("keypress",y)))}f();var h={element:i};return Object.defineProperties(h,{enabled:{get:function(){return x},set:function(o){o?f():u()},enumerable:!0},buttons:{get:function(){return r},enumerable:!0},x:{get:function(){return d},enumerable:!0},y:{get:function(){return s},enumerable:!0},mods:{get:function(){return m},enumerable:!0}}),h}},{"mouse-event":249}],248:[function(e,p,g){var a={left:0,top:0};p.exports=t;function t(n,r,d){r=r||n.currentTarget||n.srcElement,Array.isArray(d)||(d=[0,0]);var s=n.clientX||0,m=n.clientY||0,x=i(r);return d[0]=s-x.left,d[1]=m-x.top,d}function i(n){return n===window||n===document||n===document.body?a:n.getBoundingClientRect()}},{}],249:[function(e,p,g){"use strict";function a(r){if(typeof r=="object"){if("buttons"in r)return r.buttons;if("which"in r){var d=r.which;if(d===2)return 4;if(d===3)return 2;if(d>0)return 1<<d-1}else if("button"in r){var d=r.button;if(d===1)return 4;if(d===2)return 2;if(d>=0)return 1<<d}}return 0}g.buttons=a;function t(r){return r.target||r.srcElement||window}g.element=t;function i(r){if(typeof r=="object"){if("offsetX"in r)return r.offsetX;var d=t(r),s=d.getBoundingClientRect();return r.clientX-s.left}return 0}g.x=i;function n(r){if(typeof r=="object"){if("offsetY"in r)return r.offsetY;var d=t(r),s=d.getBoundingClientRect();return r.clientY-s.top}return 0}g.y=n},{}],250:[function(e,p,g){"use strict";var a=e("to-px");p.exports=t;function t(i,n,r){typeof i=="function"&&(r=!!n,n=i,i=window);var d=a("ex",i),s=function(m){r&&m.preventDefault();var x=m.deltaX||0,M=m.deltaY||0,v=m.deltaZ||0,_=m.deltaMode,l=1;switch(_){case 1:l=d;break;case 2:l=window.innerHeight;break}if(x*=l,M*=l,v*=l,x||M||v)return n(x,M,v,m)};return i.addEventListener("wheel",s),s}},{"to-px":304}],251:[function(e,p,g){"use strict";var a=e("typedarray-pool");p.exports=n;var t={"false,0,1":function(d,s,m,x,M){return function(_,l,y,T){var w=_.shape[0]|0,A=_.shape[1]|0,f=_.data,u=_.offset|0,h=_.stride[0]|0,o=_.stride[1]|0,S=u,R,z=-h|0,O=0,I=-o|0,F=0,D=-h-o|0,B=0,U=h|0,X=o-h*w|0,oe=0,se=0,q=0,K=2*w|0,G=x(K),Q=x(K),V=0,H=0,ee=-1,J=-1,W=0,re=-w|0,j=w|0,Z=0,ne=-w-1|0,le=w-1|0,ge=0,pe=0,xe=0;for(oe=0;oe<w;++oe)G[V++]=m(f[S],l,y,T),S+=U;if(S+=X,A>0){if(se=1,G[V++]=m(f[S],l,y,T),S+=U,w>0)for(oe=1,R=f[S],H=G[V]=m(R,l,y,T),W=G[V+ee],Z=G[V+re],ge=G[V+ne],(H!==W||H!==Z||H!==ge)&&(O=f[S+z],F=f[S+I],B=f[S+D],d(oe,se,R,O,F,B,H,W,Z,ge,l,y,T),pe=Q[V]=q++),V+=1,S+=U,oe=2;oe<w;++oe)R=f[S],H=G[V]=m(R,l,y,T),W=G[V+ee],Z=G[V+re],ge=G[V+ne],(H!==W||H!==Z||H!==ge)&&(O=f[S+z],F=f[S+I],B=f[S+D],d(oe,se,R,O,F,B,H,W,Z,ge,l,y,T),pe=Q[V]=q++,ge!==W&&s(Q[V+ee],pe,B,O,ge,W,l,y,T)),V+=1,S+=U;for(S+=X,V=0,xe=ee,ee=J,J=xe,xe=re,re=j,j=xe,xe=ne,ne=le,le=xe,se=2;se<A;++se){if(G[V++]=m(f[S],l,y,T),S+=U,w>0)for(oe=1,R=f[S],H=G[V]=m(R,l,y,T),W=G[V+ee],Z=G[V+re],ge=G[V+ne],(H!==W||H!==Z||H!==ge)&&(O=f[S+z],F=f[S+I],B=f[S+D],d(oe,se,R,O,F,B,H,W,Z,ge,l,y,T),pe=Q[V]=q++,ge!==Z&&s(Q[V+re],pe,F,B,Z,ge,l,y,T)),V+=1,S+=U,oe=2;oe<w;++oe)R=f[S],H=G[V]=m(R,l,y,T),W=G[V+ee],Z=G[V+re],ge=G[V+ne],(H!==W||H!==Z||H!==ge)&&(O=f[S+z],F=f[S+I],B=f[S+D],d(oe,se,R,O,F,B,H,W,Z,ge,l,y,T),pe=Q[V]=q++,ge!==Z&&s(Q[V+re],pe,F,B,Z,ge,l,y,T),ge!==W&&s(Q[V+ee],pe,B,O,ge,W,l,y,T)),V+=1,S+=U;se&1&&(V=0),xe=ee,ee=J,J=xe,xe=re,re=j,j=xe,xe=ne,ne=le,le=xe,S+=X}}M(Q),M(G)}},"false,1,0":function(d,s,m,x,M){return function(_,l,y,T){var w=_.shape[0]|0,A=_.shape[1]|0,f=_.data,u=_.offset|0,h=_.stride[0]|0,o=_.stride[1]|0,S=u,R,z=-h|0,O=0,I=-o|0,F=0,D=-h-o|0,B=0,U=o|0,X=h-o*A|0,oe=0,se=0,q=0,K=2*A|0,G=x(K),Q=x(K),V=0,H=0,ee=-1,J=-1,W=0,re=-A|0,j=A|0,Z=0,ne=-A-1|0,le=A-1|0,ge=0,pe=0,xe=0;for(se=0;se<A;++se)G[V++]=m(f[S],l,y,T),S+=U;if(S+=X,w>0){if(oe=1,G[V++]=m(f[S],l,y,T),S+=U,A>0)for(se=1,R=f[S],H=G[V]=m(R,l,y,T),Z=G[V+re],W=G[V+ee],ge=G[V+ne],(H!==Z||H!==W||H!==ge)&&(O=f[S+z],F=f[S+I],B=f[S+D],d(oe,se,R,O,F,B,H,Z,W,ge,l,y,T),pe=Q[V]=q++),V+=1,S+=U,se=2;se<A;++se)R=f[S],H=G[V]=m(R,l,y,T),Z=G[V+re],W=G[V+ee],ge=G[V+ne],(H!==Z||H!==W||H!==ge)&&(O=f[S+z],F=f[S+I],B=f[S+D],d(oe,se,R,O,F,B,H,Z,W,ge,l,y,T),pe=Q[V]=q++,ge!==W&&s(Q[V+ee],pe,F,B,W,ge,l,y,T)),V+=1,S+=U;for(S+=X,V=0,xe=re,re=j,j=xe,xe=ee,ee=J,J=xe,xe=ne,ne=le,le=xe,oe=2;oe<w;++oe){if(G[V++]=m(f[S],l,y,T),S+=U,A>0)for(se=1,R=f[S],H=G[V]=m(R,l,y,T),Z=G[V+re],W=G[V+ee],ge=G[V+ne],(H!==Z||H!==W||H!==ge)&&(O=f[S+z],F=f[S+I],B=f[S+D],d(oe,se,R,O,F,B,H,Z,W,ge,l,y,T),pe=Q[V]=q++,ge!==Z&&s(Q[V+re],pe,B,O,ge,Z,l,y,T)),V+=1,S+=U,se=2;se<A;++se)R=f[S],H=G[V]=m(R,l,y,T),Z=G[V+re],W=G[V+ee],ge=G[V+ne],(H!==Z||H!==W||H!==ge)&&(O=f[S+z],F=f[S+I],B=f[S+D],d(oe,se,R,O,F,B,H,Z,W,ge,l,y,T),pe=Q[V]=q++,ge!==W&&s(Q[V+ee],pe,F,B,W,ge,l,y,T),ge!==Z&&s(Q[V+re],pe,B,O,ge,Z,l,y,T)),V+=1,S+=U;oe&1&&(V=0),xe=re,re=j,j=xe,xe=ee,ee=J,J=xe,xe=ne,ne=le,le=xe,S+=X}}M(Q),M(G)}}};function i(r,d,s,m,x,M){var v=[M,x].join(","),_=t[v];return _(r,d,s,a.mallocUint32,a.freeUint32)}function n(r){function d(l){throw new Error("ndarray-extract-contour: "+l)}typeof r!="object"&&d("Must specify arguments");var s=r.order;Array.isArray(s)||d("Must specify order");var m=r.arrayArguments||1;m<1&&d("Must have at least one array argument");var x=r.scalarArguments||0;x<0&&d("Scalar arg count must be > 0"),typeof r.vertex!="function"&&d("Must specify vertex creation function"),typeof r.cell!="function"&&d("Must specify cell creation function"),typeof r.phase!="function"&&d("Must specify phase function");for(var M=r.getters||[],v=new Array(m),_=0;_<m;++_)M.indexOf(_)>=0?v[_]=!0:v[_]=!1;return i(r.vertex,r.cell,r.phase,x,s,v)}},{"typedarray-pool":308}],252:[function(e,p,g){"use strict";var a=e("dup"),t={zero:function(T,w,A,f){var u=T[0],h=A[0];f|=0;var o=0,S=h;for(o=0;o<u;++o)w[f]=0,f+=S},fdTemplate1:function(T,w,A,f,u,h,o){var S=T[0],R=A[0],z=h[0],O=-1*R,I=R;f|=0,o|=0;var F=0,D=R,B=z;for(F=0;F<S;++F)u[o]=.5*(w[f+O]-w[f+I]),f+=D,o+=B},fdTemplate2:function(T,w,A,f,u,h,o,S,R,z){var O=T[0],I=T[1],F=A[0],D=A[1],B=h[0],U=h[1],X=R[0],oe=R[1],se=-1*F,q=F,K=-1*D,G=D;f|=0,o|=0,z|=0;var Q=0,V=0,H=D,ee=F-I*D,J=U,W=B-I*U,re=oe,j=X-I*oe;for(V=0;V<O;++V){for(Q=0;Q<I;++Q)u[o]=.5*(w[f+se]-w[f+q]),S[z]=.5*(w[f+K]-w[f+G]),f+=H,o+=J,z+=re;f+=ee,o+=W,z+=j}}},i={cdiff:function(T){var w={};return function(f,u,h){var o=f.dtype,S=f.order,R=u.dtype,z=u.order,O=h.dtype,I=h.order,F=[o,S.join(),R,z.join(),O,I.join()].join(),D=w[F];return D||(w[F]=D=T([o,S,R,z,O,I])),D(f.shape.slice(0),f.data,f.stride,f.offset|0,u.data,u.stride,u.offset|0,h.data,h.stride,h.offset|0)}},zero:function(T){var w={};return function(f){var u=f.dtype,h=f.order,o=[u,h.join()].join(),S=w[o];return S||(w[o]=S=T([u,h])),S(f.shape.slice(0),f.data,f.stride,f.offset|0)}},fdTemplate1:function(T){var w={};return function(f,u){var h=f.dtype,o=f.order,S=u.dtype,R=u.order,z=[h,o.join(),S,R.join()].join(),O=w[z];return O||(w[z]=O=T([h,o,S,R])),O(f.shape.slice(0),f.data,f.stride,f.offset|0,u.data,u.stride,u.offset|0)}},fdTemplate2:function(T){var w={};return function(f,u,h){var o=f.dtype,S=f.order,R=u.dtype,z=u.order,O=h.dtype,I=h.order,F=[o,S.join(),R,z.join(),O,I.join()].join(),D=w[F];return D||(w[F]=D=T([o,S,R,z,O,I])),D(f.shape.slice(0),f.data,f.stride,f.offset|0,u.data,u.stride,u.offset|0,h.data,h.stride,h.offset|0)}}};function n(T){var w=i[T.funcName];return w(r.bind(void 0,T))}function r(T){return t[T.funcName]}function d(T){return n({funcName:T.funcName})}var s={},m={},x={body:"",args:[],thisVars:[],localVars:[]},M=d({funcName:"cdiff"}),v=d({funcName:"zero"});function _(T){return T in s?s[T]:s[T]=d({funcName:"fdTemplate"+T})}function l(T,w,A,f){return function(u,h){var o=h.shape.slice();return o[0]>2&&o[1]>2&&f(h.pick(-1,-1).lo(1,1).hi(o[0]-2,o[1]-2),u.pick(-1,-1,0).lo(1,1).hi(o[0]-2,o[1]-2),u.pick(-1,-1,1).lo(1,1).hi(o[0]-2,o[1]-2)),o[1]>2&&(A(h.pick(0,-1).lo(1).hi(o[1]-2),u.pick(0,-1,1).lo(1).hi(o[1]-2)),w(u.pick(0,-1,0).lo(1).hi(o[1]-2))),o[1]>2&&(A(h.pick(o[0]-1,-1).lo(1).hi(o[1]-2),u.pick(o[0]-1,-1,1).lo(1).hi(o[1]-2)),w(u.pick(o[0]-1,-1,0).lo(1).hi(o[1]-2))),o[0]>2&&(A(h.pick(-1,0).lo(1).hi(o[0]-2),u.pick(-1,0,0).lo(1).hi(o[0]-2)),w(u.pick(-1,0,1).lo(1).hi(o[0]-2))),o[0]>2&&(A(h.pick(-1,o[1]-1).lo(1).hi(o[0]-2),u.pick(-1,o[1]-1,0).lo(1).hi(o[0]-2)),w(u.pick(-1,o[1]-1,1).lo(1).hi(o[0]-2))),u.set(0,0,0,0),u.set(0,0,1,0),u.set(o[0]-1,0,0,0),u.set(o[0]-1,0,1,0),u.set(0,o[1]-1,0,0),u.set(0,o[1]-1,1,0),u.set(o[0]-1,o[1]-1,0,0),u.set(o[0]-1,o[1]-1,1,0),u}}function y(T){var w=T.join(),o=m[w];if(o)return o;for(var A=T.length,f=[M,v],u=1;u<=A;++u)f.push(_(u));var h=l,o=h.apply(void 0,f);return m[w]=o,o}p.exports=function(w,A,f){if(Array.isArray(f)||(typeof f=="string"?f=a(A.dimension,f):f=a(A.dimension,"clamp")),A.size===0)return w;if(A.dimension===0)return w.set(0),w;var u=y(f);return u(w,A)}},{dup:65}],253:[function(e,p,g){"use strict";function a(d,s){var m=Math.floor(s),x=s-m,M=0<=m&&m<d.shape[0],v=0<=m+1&&m+1<d.shape[0],_=M?+d.get(m):0,l=v?+d.get(m+1):0;return(1-x)*_+x*l}function t(d,s,m){var x=Math.floor(s),M=s-x,v=0<=x&&x<d.shape[0],_=0<=x+1&&x+1<d.shape[0],l=Math.floor(m),y=m-l,T=0<=l&&l<d.shape[1],w=0<=l+1&&l+1<d.shape[1],A=v&&T?d.get(x,l):0,f=v&&w?d.get(x,l+1):0,u=_&&T?d.get(x+1,l):0,h=_&&w?d.get(x+1,l+1):0;return(1-y)*((1-M)*A+M*u)+y*((1-M)*f+M*h)}function i(d,s,m,x){var M=Math.floor(s),v=s-M,_=0<=M&&M<d.shape[0],l=0<=M+1&&M+1<d.shape[0],y=Math.floor(m),T=m-y,w=0<=y&&y<d.shape[1],A=0<=y+1&&y+1<d.shape[1],f=Math.floor(x),u=x-f,h=0<=f&&f<d.shape[2],o=0<=f+1&&f+1<d.shape[2],S=_&&w&&h?d.get(M,y,f):0,R=_&&A&&h?d.get(M,y+1,f):0,z=l&&w&&h?d.get(M+1,y,f):0,O=l&&A&&h?d.get(M+1,y+1,f):0,I=_&&w&&o?d.get(M,y,f+1):0,F=_&&A&&o?d.get(M,y+1,f+1):0,D=l&&w&&o?d.get(M+1,y,f+1):0,B=l&&A&&o?d.get(M+1,y+1,f+1):0;return(1-u)*((1-T)*((1-v)*S+v*z)+T*((1-v)*R+v*O))+u*((1-T)*((1-v)*I+v*D)+T*((1-v)*F+v*B))}function n(d){var s=d.shape.length|0,m=new Array(s),x=new Array(s),M=new Array(s),v=new Array(s),_,l;for(_=0;_<s;++_)l=+arguments[_+1],m[_]=Math.floor(l),x[_]=l-m[_],M[_]=0<=m[_]&&m[_]<d.shape[_],v[_]=0<=m[_]+1&&m[_]+1<d.shape[_];var y=0,T,w,A;e:for(_=0;_<1<<s;++_){for(w=1,A=d.offset,T=0;T<s;++T)if(_&1<<T){if(!v[T])continue e;w*=x[T],A+=d.stride[T]*(m[T]+1)}else{if(!M[T])continue e;w*=1-x[T],A+=d.stride[T]*m[T]}y+=w*d.data[A]}return y}function r(d,s,m,x){switch(d.shape.length){case 0:return 0;case 1:return a(d,s);case 2:return t(d,s,m);case 3:return i(d,s,m,x);default:return n.apply(void 0,arguments)}}p.exports=r,p.exports.d1=a,p.exports.d2=t,p.exports.d3=i},{}],254:[function(e,p,g){"use strict";var a={"float64,2,1,0":function(){return function(x,M,v,_,l){var y=x[0],T=x[1],w=x[2],A=v[0],f=v[1],u=v[2];_|=0;var h=0,o=0,S=0,R=u,z=f-w*u,O=A-T*f;for(S=0;S<y;++S){for(o=0;o<T;++o){for(h=0;h<w;++h)M[_]/=l,_+=R;_+=z}_+=O}}},"uint8,2,0,1,float64,2,1,0":function(){return function(x,M,v,_,l,y,T,w){var A=x[0],f=x[1],u=x[2],h=v[0],o=v[1],S=v[2],R=y[0],z=y[1],O=y[2];_|=0,T|=0;for(var I=_,F=T,D=x[0]|0;D>0;){D<64?(A=D,D=0):(A=64,D-=64);for(var B=x[1]|0;B>0;){B<64?(f=B,B=0):(f=64,B-=64),_=I+D*h+B*o,T=F+D*R+B*z;var U=0,X=0,oe=0,se=S,q=h-u*S,K=o-A*h,G=O,Q=R-u*O,V=z-A*R;for(oe=0;oe<f;++oe){for(X=0;X<A;++X){for(U=0;U<u;++U)M[_]=l[T]*w,_+=se,T+=G;_+=q,T+=Q}_+=K,T+=V}}}}},"float32,1,0,float32,1,0":function(){return function(x,M,v,_,l,y,T){var w=x[0],A=x[1],f=v[0],u=v[1],h=y[0],o=y[1];_|=0,T|=0;var S=0,R=0,z=u,O=f-A*u,I=o,F=h-A*o;for(R=0;R<w;++R){for(S=0;S<A;++S)M[_]=l[T],_+=z,T+=I;_+=O,T+=F}}},"float32,1,0,float32,0,1":function(){return function(x,M,v,_,l,y,T){var w=x[0],A=x[1],f=v[0],u=v[1],h=y[0],o=y[1];_|=0,T|=0;for(var S=_,R=T,z=x[1]|0;z>0;){z<64?(A=z,z=0):(A=64,z-=64);for(var O=x[0]|0;O>0;){O<64?(w=O,O=0):(w=64,O-=64),_=S+z*u+O*f,T=R+z*o+O*h;var I=0,F=0,D=u,B=f-A*u,U=o,X=h-A*o;for(F=0;F<w;++F){for(I=0;I<A;++I)M[_]=l[T],_+=D,T+=U;_+=B,T+=X}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(x,M,v,_,l,y,T){var w=x[0],A=x[1],f=x[2],u=v[0],h=v[1],o=v[2],S=y[0],R=y[1],z=y[2];_|=0,T|=0;for(var O=_,I=T,F=x[2]|0;F>0;){F<64?(f=F,F=0):(f=64,F-=64);for(var D=x[0]|0;D>0;){D<64?(w=D,D=0):(w=64,D-=64);for(var B=x[1]|0;B>0;){B<64?(A=B,B=0):(A=64,B-=64),_=O+F*o+D*u+B*h,T=I+F*z+D*S+B*R;var U=0,X=0,oe=0,se=o,q=u-f*o,K=h-w*u,G=z,Q=S-f*z,V=R-w*S;for(oe=0;oe<A;++oe){for(X=0;X<w;++X){for(U=0;U<f;++U)M[_]=l[T],_+=se,T+=G;_+=q,T+=Q}_+=K,T+=V}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(x,M,v,_,l,y,T){var w=x[0],A=x[1],f=x[2],u=v[0],h=v[1],o=v[2],S=y[0],R=y[1],z=y[2];_|=0,T|=0;var O=0,I=0,F=0,D=o,B=u-f*o,U=h-w*u,X=z,oe=S-f*z,se=R-w*S;for(F=0;F<A;++F){for(I=0;I<w;++I){for(O=0;O<f;++O)M[_]=l[T],_+=D,T+=X;_+=B,T+=oe}_+=U,T+=se}}}};function t(m,x){var M=x.join(","),v=a[M];return v()}var i=t,n={mul:function(m){var x={};return function(v,_,l){var y=v.dtype,T=v.order,w=_.dtype,A=_.order,f=l.dtype,u=l.order,h=[y,T.join(),w,A.join(),f,u.join()].join(),o=x[h];return o||(x[h]=o=m([y,T,w,A,f,u])),o(v.shape.slice(0),v.data,v.stride,v.offset|0,_.data,_.stride,_.offset|0,l.data,l.stride,l.offset|0)}},muls:function(m){var x={};return function(v,_,l){var y=v.dtype,T=v.order,w=_.dtype,A=_.order,f=[y,T.join(),w,A.join()].join(),u=x[f];return u||(x[f]=u=m([y,T,w,A])),u(v.shape.slice(0),v.data,v.stride,v.offset|0,_.data,_.stride,_.offset|0,l)}},mulseq:function(m){var x={};return function(v,_){var l=v.dtype,y=v.order,T=[l,y.join()].join(),w=x[T];return w||(x[T]=w=m([l,y])),w(v.shape.slice(0),v.data,v.stride,v.offset|0,_)}},div:function(m){var x={};return function(v,_,l){var y=v.dtype,T=v.order,w=_.dtype,A=_.order,f=l.dtype,u=l.order,h=[y,T.join(),w,A.join(),f,u.join()].join(),o=x[h];return o||(x[h]=o=m([y,T,w,A,f,u])),o(v.shape.slice(0),v.data,v.stride,v.offset|0,_.data,_.stride,_.offset|0,l.data,l.stride,l.offset|0)}},divs:function(m){var x={};return function(v,_,l){var y=v.dtype,T=v.order,w=_.dtype,A=_.order,f=[y,T.join(),w,A.join()].join(),u=x[f];return u||(x[f]=u=m([y,T,w,A])),u(v.shape.slice(0),v.data,v.stride,v.offset|0,_.data,_.stride,_.offset|0,l)}},divseq:function(m){var x={};return function(v,_){var l=v.dtype,y=v.order,T=[l,y.join()].join(),w=x[T];return w||(x[T]=w=m([l,y])),w(v.shape.slice(0),v.data,v.stride,v.offset|0,_)}},assign:function(m){var x={};return function(v,_){var l=v.dtype,y=v.order,T=_.dtype,w=_.order,A=[l,y.join(),T,w.join()].join(),f=x[A];return f||(x[A]=f=m([l,y,T,w])),f(v.shape.slice(0),v.data,v.stride,v.offset|0,_.data,_.stride,_.offset|0)}}};function r(m){var x=n[m.funcName];return x(i.bind(void 0,m))}function d(m){return r({funcName:m.funcName})}var s={mul:"*",div:"/"};(function(){for(var m in s)g[m]=d({funcName:m}),g[m+"s"]=d({funcName:m+"s"}),g[m+"seq"]=d({funcName:m+"seq"})})(),g.assign=d({funcName:"assign"})},{}],255:[function(e,p,g){"use strict";var a=e("ndarray"),t=e("./doConvert.js");p.exports=function(n,r){for(var d=[],s=n,m=1;Array.isArray(s);)d.push(s.length),m*=s.length,s=s[0];return d.length===0?a():(r||(r=a(new Float64Array(m),d)),t(r,n),r)}},{"./doConvert.js":256,ndarray:259}],256:[function(e,p,g){"use strict";function a(){return function(s,m,x,M,v){var _=s[0],l=s[1],y=s[2],T=x[0],w=x[1],A=x[2],f=[0,0,0];M|=0;var u=0,h=0,o=0,S=A,R=w-y*A,z=T-l*w;for(o=0;o<_;++o){for(h=0;h<l;++h){for(u=0;u<y;++u){{var O=v,I;for(I=0;I<f.length-1;++I)O=O[f[I]];m[M]=O[f[f.length-1]]}M+=S,++f[2]}M+=R,f[2]-=y,++f[1]}M+=z,f[1]-=l,++f[0]}}}function t(){return a()}var i=t;function n(s){var m={};return function(M,v){var _=M.dtype,l=M.order,y=[_,l.join()].join(),T=m[y];return T||(m[y]=T=s([_,l])),T(M.shape.slice(0),M.data,M.stride,M.offset|0,v)}}function r(s){return n(i.bind(void 0,s))}function d(s){return r({funcName:s.funcName})}p.exports=d({funcName:"convert"})},{}],257:[function(e,p,g){"use strict";var a=e("typedarray-pool");function t(x){switch(x){case"uint32":return[a.mallocUint32,a.freeUint32];default:return null}}var i={"uint32,1,0":function(x,M){return function(_,l,y,T,w,A,f,u,h,o,S){var R,z,O,I=_*w+T,F,D=x(u),B,U,X,oe;for(R=_+1;R<=l;++R){for(z=R,I+=w,O=I,B=0,U=I,F=0;F<u;++F)D[B++]=y[U],U+=h;e:for(;z-- >_;){B=0,U=O-w;t:for(F=0;F<u;++F){if(X=y[U],oe=D[B],X<oe)break e;if(X>oe)break t;U+=o,B+=S}for(B=O,U=O-w,F=0;F<u;++F)y[B]=y[U],B+=h,U+=h;O-=w}for(B=O,U=0,F=0;F<u;++F)y[B]=D[U++],B+=h}M(D)}}};function n(x,M){var v=t(M),_=[M,x].join(","),l=i[_];return v?l(v[0],v[1]):l()}var r={"uint32,1,0":function(x,M,v){return function _(l,y,T,w,A,f,u,h,o,S,R){var z=(y-l+1)/6|0,O=l+z,I=y-z,F=l+y>>1,D=F-z,B=F+z,U=O,X=D,oe=F,se=B,q=I,K=l+1,G=y-1,Q=!0,V,H,ee,J,W,re,j,Z,ne,le=0,ge=0,pe=0,xe,Ee,Te,de,be,Le,De,ye,ke,Oe,Qe,Ve,Ue,Ie,at,pt,Rt=h,Mt=M(Rt),It=M(Rt);Ee=A*U,Te=A*X,pt=w;e:for(xe=0;xe<h;++xe){if(j=Ee+pt,Z=Te+pt,pe=T[j]-T[Z],pe>0){H=U,U=X,X=H;break e}if(pe<0)break e;pt+=S}Ee=A*se,Te=A*q,pt=w;e:for(xe=0;xe<h;++xe){if(j=Ee+pt,Z=Te+pt,pe=T[j]-T[Z],pe>0){H=se,se=q,q=H;break e}if(pe<0)break e;pt+=S}Ee=A*U,Te=A*oe,pt=w;e:for(xe=0;xe<h;++xe){if(j=Ee+pt,Z=Te+pt,pe=T[j]-T[Z],pe>0){H=U,U=oe,oe=H;break e}if(pe<0)break e;pt+=S}Ee=A*X,Te=A*oe,pt=w;e:for(xe=0;xe<h;++xe){if(j=Ee+pt,Z=Te+pt,pe=T[j]-T[Z],pe>0){H=X,X=oe,oe=H;break e}if(pe<0)break e;pt+=S}Ee=A*U,Te=A*se,pt=w;e:for(xe=0;xe<h;++xe){if(j=Ee+pt,Z=Te+pt,pe=T[j]-T[Z],pe>0){H=U,U=se,se=H;break e}if(pe<0)break e;pt+=S}Ee=A*oe,Te=A*se,pt=w;e:for(xe=0;xe<h;++xe){if(j=Ee+pt,Z=Te+pt,pe=T[j]-T[Z],pe>0){H=oe,oe=se,se=H;break e}if(pe<0)break e;pt+=S}Ee=A*X,Te=A*q,pt=w;e:for(xe=0;xe<h;++xe){if(j=Ee+pt,Z=Te+pt,pe=T[j]-T[Z],pe>0){H=X,X=q,q=H;break e}if(pe<0)break e;pt+=S}Ee=A*X,Te=A*oe,pt=w;e:for(xe=0;xe<h;++xe){if(j=Ee+pt,Z=Te+pt,pe=T[j]-T[Z],pe>0){H=X,X=oe,oe=H;break e}if(pe<0)break e;pt+=S}Ee=A*se,Te=A*q,pt=w;e:for(xe=0;xe<h;++xe){if(j=Ee+pt,Z=Te+pt,pe=T[j]-T[Z],pe>0){H=se,se=q,q=H;break e}if(pe<0)break e;pt+=S}for(Ee=A*U,Te=A*X,de=A*oe,be=A*se,Le=A*q,De=A*O,ye=A*F,ke=A*I,at=0,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,ne=de+pt,Oe=be+pt,Qe=Le+pt,Ve=De+pt,Ue=ye+pt,Ie=ke+pt,Mt[at]=T[Z],It[at]=T[Oe],Q=Q&&Mt[at]===It[at],ee=T[j],J=T[ne],W=T[Qe],T[Ve]=ee,T[Ue]=J,T[Ie]=W,++at,pt+=o;for(Ee=A*D,Te=A*l,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,T[j]=T[Z],pt+=o;for(Ee=A*B,Te=A*y,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,T[j]=T[Z],pt+=o;if(Q)for(re=K;re<=G;++re){j=w+re*A,at=0;e:for(xe=0;xe<h;++xe){if(pe=T[j]-Mt[at],pe!==0)break e;at+=R,j+=S}if(pe!==0)if(pe<0){if(re!==K)for(Ee=A*re,Te=A*K,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,V=T[j],T[j]=T[Z],T[Z]=V,pt+=o;++K}else for(;;){j=w+G*A,at=0;e:for(xe=0;xe<h;++xe){if(pe=T[j]-Mt[at],pe!==0)break e;at+=R,j+=S}if(pe>0)G--;else if(pe<0){for(Ee=A*re,Te=A*K,de=A*G,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,ne=de+pt,V=T[j],T[j]=T[Z],T[Z]=T[ne],T[ne]=V,pt+=o;++K,--G;break}else{for(Ee=A*re,Te=A*G,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,V=T[j],T[j]=T[Z],T[Z]=V,pt+=o;--G;break}}}else for(re=K;re<=G;++re){j=w+re*A,at=0;e:for(xe=0;xe<h;++xe){if(le=T[j]-Mt[at],le!==0)break e;at+=R,j+=S}if(le<0){if(re!==K)for(Ee=A*re,Te=A*K,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,V=T[j],T[j]=T[Z],T[Z]=V,pt+=o;++K}else{j=w+re*A,at=0;e:for(xe=0;xe<h;++xe){if(ge=T[j]-It[at],ge!==0)break e;at+=R,j+=S}if(ge>0)for(;;){j=w+G*A,at=0;e:for(xe=0;xe<h;++xe){if(pe=T[j]-It[at],pe!==0)break e;at+=R,j+=S}if(pe>0){if(--G<re)break;continue}else{j=w+G*A,at=0;e:for(xe=0;xe<h;++xe){if(pe=T[j]-Mt[at],pe!==0)break e;at+=R,j+=S}if(pe<0){for(Ee=A*re,Te=A*K,de=A*G,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,ne=de+pt,V=T[j],T[j]=T[Z],T[Z]=T[ne],T[ne]=V,pt+=o;++K,--G}else{for(Ee=A*re,Te=A*G,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,V=T[j],T[j]=T[Z],T[Z]=V,pt+=o;--G}break}}}}for(Ee=A*l,Te=A*(K-1),at=0,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,T[j]=T[Z],T[Z]=Mt[at],++at,pt+=o;for(Ee=A*y,Te=A*(G+1),at=0,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,T[j]=T[Z],T[Z]=It[at],++at,pt+=o;if(K-2-l<=32?x(l,K-2,T,w,A,f,u,h,o,S,R):_(l,K-2,T,w,A,f,u,h,o,S,R),y-(G+2)<=32?x(G+2,y,T,w,A,f,u,h,o,S,R):_(G+2,y,T,w,A,f,u,h,o,S,R),Q){v(Mt),v(It);return}if(K<O&&G>I){e:for(;;){for(j=w+K*A,at=0,pt=w,xe=0;xe<h;++xe){if(T[j]!==Mt[at])break e;++at,j+=o}++K}e:for(;;){for(j=w+G*A,at=0,pt=w,xe=0;xe<h;++xe){if(T[j]!==It[at])break e;++at,j+=o}--G}for(re=K;re<=G;++re){j=w+re*A,at=0;e:for(xe=0;xe<h;++xe){if(le=T[j]-Mt[at],le!==0)break e;at+=R,j+=S}if(le===0){if(re!==K)for(Ee=A*re,Te=A*K,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,V=T[j],T[j]=T[Z],T[Z]=V,pt+=o;++K}else{j=w+re*A,at=0;e:for(xe=0;xe<h;++xe){if(ge=T[j]-It[at],ge!==0)break e;at+=R,j+=S}if(ge===0)for(;;){j=w+G*A,at=0;e:for(xe=0;xe<h;++xe){if(pe=T[j]-It[at],pe!==0)break e;at+=R,j+=S}if(pe===0){if(--G<re)break;continue}else{j=w+G*A,at=0;e:for(xe=0;xe<h;++xe){if(pe=T[j]-Mt[at],pe!==0)break e;at+=R,j+=S}if(pe<0){for(Ee=A*re,Te=A*K,de=A*G,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,ne=de+pt,V=T[j],T[j]=T[Z],T[Z]=T[ne],T[ne]=V,pt+=o;++K,--G}else{for(Ee=A*re,Te=A*G,pt=w,xe=0;xe<h;++xe)j=Ee+pt,Z=Te+pt,V=T[j],T[j]=T[Z],T[Z]=V,pt+=o;--G}break}}}}}v(Mt),v(It),G-K<=32?x(K,G,T,w,A,f,u,h,o,S,R):_(K,G,T,w,A,f,u,h,o,S,R)}}};function d(x,M,v){var _=t(M),l=[M,x].join(","),y=r[l];return x.length>1&&_?y(v,_[0],_[1]):y(v)}var s={"uint32,1,0":function(x,M){return function(v){var _=v.data,l=v.offset|0,y=v.shape,T=v.stride,w=T[0]|0,A=y[0]|0,f=T[1]|0,u=y[1]|0,h=f,o=f,S=1;A<=32?x(0,A-1,_,l,w,f,A,u,h,o,S):M(0,A-1,_,l,w,f,A,u,h,o,S)}}};function m(x,M){var v=[M,x].join(","),_=s[v],l=n(x,M),y=d(x,M,l);return _(l,y)}p.exports=m},{"typedarray-pool":308}],258:[function(e,p,g){"use strict";var a=e("./lib/compile_sort.js"),t={};function i(n){var r=n.order,d=n.dtype,s=[r,d],m=s.join(":"),x=t[m];return x||(t[m]=x=a(r,d)),x(n),n}p.exports=i},{"./lib/compile_sort.js":257}],259:[function(e,p,g){var a=e("is-buffer"),t=typeof Float64Array<"u";function i(M,v){return M[0]-v[0]}function n(){var M=this.stride,v=new Array(M.length),_;for(_=0;_<v.length;++_)v[_]=[Math.abs(M[_]),_];v.sort(i);var l=new Array(v.length);for(_=0;_<l.length;++_)l[_]=v[_][1];return l}var r={T:function(M){function v(l){this.data=l}var _=v.prototype;return _.dtype=M,_.index=function(){return-1},_.size=0,_.dimension=-1,_.shape=_.stride=_.order=[],_.lo=_.hi=_.transpose=_.step=function(){return new v(this.data)},_.get=_.set=function(){},_.pick=function(){return null},function(y){return new v(y)}},0:function(M,v){function _(y,T){this.data=y,this.offset=T}var l=_.prototype;return l.dtype=M,l.index=function(){return this.offset},l.dimension=0,l.size=1,l.shape=l.stride=l.order=[],l.lo=l.hi=l.transpose=l.step=function(){return new _(this.data,this.offset)},l.pick=function(){return v(this.data)},l.valueOf=l.get=function(){return M==="generic"?this.data.get(this.offset):this.data[this.offset]},l.set=function(T){return M==="generic"?this.data.set(this.offset,T):this.data[this.offset]=T},function(T,w,A,f){return new _(T,f)}},1:function(M,v,_){function l(T,w,A,f){this.data=T,this.shape=[w],this.stride=[A],this.offset=f|0}var y=l.prototype;return y.dtype=M,y.dimension=1,Object.defineProperty(y,"size",{get:function(){return this.shape[0]}}),y.order=[0],y.set=function(w,A){return M==="generic"?this.data.set(this.offset+this.stride[0]*w,A):this.data[this.offset+this.stride[0]*w]=A},y.get=function(w){return M==="generic"?this.data.get(this.offset+this.stride[0]*w):this.data[this.offset+this.stride[0]*w]},y.index=function(w){return this.offset+this.stride[0]*w},y.hi=function(w){return new l(this.data,typeof w!="number"||w<0?this.shape[0]:w|0,this.stride[0],this.offset)},y.lo=function(w){var A=this.offset,f=0,u=this.shape[0],h=this.stride[0];return typeof w=="number"&&w>=0&&(f=w|0,A+=h*f,u-=f),new l(this.data,u,h,A)},y.step=function(w){var A=this.shape[0],f=this.stride[0],u=this.offset,h=0,o=Math.ceil;return typeof w=="number"&&(h=w|0,h<0?(u+=f*(A-1),A=o(-A/h)):A=o(A/h),f*=h),new l(this.data,A,f,u)},y.transpose=function(w){w=w===void 0?0:w|0;var A=this.shape,f=this.stride;return new l(this.data,A[w],f[w],this.offset)},y.pick=function(w){var A=[],f=[],u=this.offset;typeof w=="number"&&w>=0?u=u+this.stride[0]*w|0:(A.push(this.shape[0]),f.push(this.stride[0]));var h=v[A.length+1];return h(this.data,A,f,u)},function(w,A,f,u){return new l(w,A[0],f[0],u)}},2:function(M,v,_){function l(T,w,A,f,u,h){this.data=T,this.shape=[w,A],this.stride=[f,u],this.offset=h|0}var y=l.prototype;return y.dtype=M,y.dimension=2,Object.defineProperty(y,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(y,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),y.set=function(w,A,f){return M==="generic"?this.data.set(this.offset+this.stride[0]*w+this.stride[1]*A,f):this.data[this.offset+this.stride[0]*w+this.stride[1]*A]=f},y.get=function(w,A){return M==="generic"?this.data.get(this.offset+this.stride[0]*w+this.stride[1]*A):this.data[this.offset+this.stride[0]*w+this.stride[1]*A]},y.index=function(w,A){return this.offset+this.stride[0]*w+this.stride[1]*A},y.hi=function(w,A){return new l(this.data,typeof w!="number"||w<0?this.shape[0]:w|0,typeof A!="number"||A<0?this.shape[1]:A|0,this.stride[0],this.stride[1],this.offset)},y.lo=function(w,A){var f=this.offset,u=0,h=this.shape[0],o=this.shape[1],S=this.stride[0],R=this.stride[1];return typeof w=="number"&&w>=0&&(u=w|0,f+=S*u,h-=u),typeof A=="number"&&A>=0&&(u=A|0,f+=R*u,o-=u),new l(this.data,h,o,S,R,f)},y.step=function(w,A){var f=this.shape[0],u=this.shape[1],h=this.stride[0],o=this.stride[1],S=this.offset,R=0,z=Math.ceil;return typeof w=="number"&&(R=w|0,R<0?(S+=h*(f-1),f=z(-f/R)):f=z(f/R),h*=R),typeof A=="number"&&(R=A|0,R<0?(S+=o*(u-1),u=z(-u/R)):u=z(u/R),o*=R),new l(this.data,f,u,h,o,S)},y.transpose=function(w,A){w=w===void 0?0:w|0,A=A===void 0?1:A|0;var f=this.shape,u=this.stride;return new l(this.data,f[w],f[A],u[w],u[A],this.offset)},y.pick=function(w,A){var f=[],u=[],h=this.offset;typeof w=="number"&&w>=0?h=h+this.stride[0]*w|0:(f.push(this.shape[0]),u.push(this.stride[0])),typeof A=="number"&&A>=0?h=h+this.stride[1]*A|0:(f.push(this.shape[1]),u.push(this.stride[1]));var o=v[f.length+1];return o(this.data,f,u,h)},function(w,A,f,u){return new l(w,A[0],A[1],f[0],f[1],u)}},3:function(M,v,_){function l(T,w,A,f,u,h,o,S){this.data=T,this.shape=[w,A,f],this.stride=[u,h,o],this.offset=S|0}var y=l.prototype;return y.dtype=M,y.dimension=3,Object.defineProperty(y,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(y,"order",{get:function(){var w=Math.abs(this.stride[0]),A=Math.abs(this.stride[1]),f=Math.abs(this.stride[2]);return w>A?A>f?[2,1,0]:w>f?[1,2,0]:[1,0,2]:w>f?[2,0,1]:f>A?[0,1,2]:[0,2,1]}}),y.set=function(w,A,f,u){return M==="generic"?this.data.set(this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f,u):this.data[this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f]=u},y.get=function(w,A,f){return M==="generic"?this.data.get(this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f):this.data[this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f]},y.index=function(w,A,f){return this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f},y.hi=function(w,A,f){return new l(this.data,typeof w!="number"||w<0?this.shape[0]:w|0,typeof A!="number"||A<0?this.shape[1]:A|0,typeof f!="number"||f<0?this.shape[2]:f|0,this.stride[0],this.stride[1],this.stride[2],this.offset)},y.lo=function(w,A,f){var u=this.offset,h=0,o=this.shape[0],S=this.shape[1],R=this.shape[2],z=this.stride[0],O=this.stride[1],I=this.stride[2];return typeof w=="number"&&w>=0&&(h=w|0,u+=z*h,o-=h),typeof A=="number"&&A>=0&&(h=A|0,u+=O*h,S-=h),typeof f=="number"&&f>=0&&(h=f|0,u+=I*h,R-=h),new l(this.data,o,S,R,z,O,I,u)},y.step=function(w,A,f){var u=this.shape[0],h=this.shape[1],o=this.shape[2],S=this.stride[0],R=this.stride[1],z=this.stride[2],O=this.offset,I=0,F=Math.ceil;return typeof w=="number"&&(I=w|0,I<0?(O+=S*(u-1),u=F(-u/I)):u=F(u/I),S*=I),typeof A=="number"&&(I=A|0,I<0?(O+=R*(h-1),h=F(-h/I)):h=F(h/I),R*=I),typeof f=="number"&&(I=f|0,I<0?(O+=z*(o-1),o=F(-o/I)):o=F(o/I),z*=I),new l(this.data,u,h,o,S,R,z,O)},y.transpose=function(w,A,f){w=w===void 0?0:w|0,A=A===void 0?1:A|0,f=f===void 0?2:f|0;var u=this.shape,h=this.stride;return new l(this.data,u[w],u[A],u[f],h[w],h[A],h[f],this.offset)},y.pick=function(w,A,f){var u=[],h=[],o=this.offset;typeof w=="number"&&w>=0?o=o+this.stride[0]*w|0:(u.push(this.shape[0]),h.push(this.stride[0])),typeof A=="number"&&A>=0?o=o+this.stride[1]*A|0:(u.push(this.shape[1]),h.push(this.stride[1])),typeof f=="number"&&f>=0?o=o+this.stride[2]*f|0:(u.push(this.shape[2]),h.push(this.stride[2]));var S=v[u.length+1];return S(this.data,u,h,o)},function(w,A,f,u){return new l(w,A[0],A[1],A[2],f[0],f[1],f[2],u)}},4:function(M,v,_){function l(T,w,A,f,u,h,o,S,R,z){this.data=T,this.shape=[w,A,f,u],this.stride=[h,o,S,R],this.offset=z|0}var y=l.prototype;return y.dtype=M,y.dimension=4,Object.defineProperty(y,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(y,"order",{get:_}),y.set=function(w,A,f,u,h){return M==="generic"?this.data.set(this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f+this.stride[3]*u,h):this.data[this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f+this.stride[3]*u]=h},y.get=function(w,A,f,u){return M==="generic"?this.data.get(this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f+this.stride[3]*u):this.data[this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f+this.stride[3]*u]},y.index=function(w,A,f,u){return this.offset+this.stride[0]*w+this.stride[1]*A+this.stride[2]*f+this.stride[3]*u},y.hi=function(w,A,f,u){return new l(this.data,typeof w!="number"||w<0?this.shape[0]:w|0,typeof A!="number"||A<0?this.shape[1]:A|0,typeof f!="number"||f<0?this.shape[2]:f|0,typeof u!="number"||u<0?this.shape[3]:u|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},y.lo=function(w,A,f,u){var h=this.offset,o=0,S=this.shape[0],R=this.shape[1],z=this.shape[2],O=this.shape[3],I=this.stride[0],F=this.stride[1],D=this.stride[2],B=this.stride[3];return typeof w=="number"&&w>=0&&(o=w|0,h+=I*o,S-=o),typeof A=="number"&&A>=0&&(o=A|0,h+=F*o,R-=o),typeof f=="number"&&f>=0&&(o=f|0,h+=D*o,z-=o),typeof u=="number"&&u>=0&&(o=u|0,h+=B*o,O-=o),new l(this.data,S,R,z,O,I,F,D,B,h)},y.step=function(w,A,f,u){var h=this.shape[0],o=this.shape[1],S=this.shape[2],R=this.shape[3],z=this.stride[0],O=this.stride[1],I=this.stride[2],F=this.stride[3],D=this.offset,B=0,U=Math.ceil;return typeof w=="number"&&(B=w|0,B<0?(D+=z*(h-1),h=U(-h/B)):h=U(h/B),z*=B),typeof A=="number"&&(B=A|0,B<0?(D+=O*(o-1),o=U(-o/B)):o=U(o/B),O*=B),typeof f=="number"&&(B=f|0,B<0?(D+=I*(S-1),S=U(-S/B)):S=U(S/B),I*=B),typeof u=="number"&&(B=u|0,B<0?(D+=F*(R-1),R=U(-R/B)):R=U(R/B),F*=B),new l(this.data,h,o,S,R,z,O,I,F,D)},y.transpose=function(w,A,f,u){w=w===void 0?0:w|0,A=A===void 0?1:A|0,f=f===void 0?2:f|0,u=u===void 0?3:u|0;var h=this.shape,o=this.stride;return new l(this.data,h[w],h[A],h[f],h[u],o[w],o[A],o[f],o[u],this.offset)},y.pick=function(w,A,f,u){var h=[],o=[],S=this.offset;typeof w=="number"&&w>=0?S=S+this.stride[0]*w|0:(h.push(this.shape[0]),o.push(this.stride[0])),typeof A=="number"&&A>=0?S=S+this.stride[1]*A|0:(h.push(this.shape[1]),o.push(this.stride[1])),typeof f=="number"&&f>=0?S=S+this.stride[2]*f|0:(h.push(this.shape[2]),o.push(this.stride[2])),typeof u=="number"&&u>=0?S=S+this.stride[3]*u|0:(h.push(this.shape[3]),o.push(this.stride[3]));var R=v[h.length+1];return R(this.data,h,o,S)},function(w,A,f,u){return new l(w,A[0],A[1],A[2],A[3],f[0],f[1],f[2],f[3],u)}},5:function(v,_,l){function y(w,A,f,u,h,o,S,R,z,O,I,F){this.data=w,this.shape=[A,f,u,h,o],this.stride=[S,R,z,O,I],this.offset=F|0}var T=y.prototype;return T.dtype=v,T.dimension=5,Object.defineProperty(T,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(T,"order",{get:l}),T.set=function(A,f,u,h,o,S){return v==="generic"?this.data.set(this.offset+this.stride[0]*A+this.stride[1]*f+this.stride[2]*u+this.stride[3]*h+this.stride[4]*o,S):this.data[this.offset+this.stride[0]*A+this.stride[1]*f+this.stride[2]*u+this.stride[3]*h+this.stride[4]*o]=S},T.get=function(A,f,u,h,o){return v==="generic"?this.data.get(this.offset+this.stride[0]*A+this.stride[1]*f+this.stride[2]*u+this.stride[3]*h+this.stride[4]*o):this.data[this.offset+this.stride[0]*A+this.stride[1]*f+this.stride[2]*u+this.stride[3]*h+this.stride[4]*o]},T.index=function(A,f,u,h,o){return this.offset+this.stride[0]*A+this.stride[1]*f+this.stride[2]*u+this.stride[3]*h+this.stride[4]*o},T.hi=function(A,f,u,h,o){return new y(this.data,typeof A!="number"||A<0?this.shape[0]:A|0,typeof f!="number"||f<0?this.shape[1]:f|0,typeof u!="number"||u<0?this.shape[2]:u|0,typeof h!="number"||h<0?this.shape[3]:h|0,typeof o!="number"||o<0?this.shape[4]:o|0,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},T.lo=function(A,f,u,h,o){var S=this.offset,R=0,z=this.shape[0],O=this.shape[1],I=this.shape[2],F=this.shape[3],D=this.shape[4],B=this.stride[0],U=this.stride[1],X=this.stride[2],oe=this.stride[3],se=this.stride[4];return typeof A=="number"&&A>=0&&(R=A|0,S+=B*R,z-=R),typeof f=="number"&&f>=0&&(R=f|0,S+=U*R,O-=R),typeof u=="number"&&u>=0&&(R=u|0,S+=X*R,I-=R),typeof h=="number"&&h>=0&&(R=h|0,S+=oe*R,F-=R),typeof o=="number"&&o>=0&&(R=o|0,S+=se*R,D-=R),new y(this.data,z,O,I,F,D,B,U,X,oe,se,S)},T.step=function(A,f,u,h,o){var S=this.shape[0],R=this.shape[1],z=this.shape[2],O=this.shape[3],I=this.shape[4],F=this.stride[0],D=this.stride[1],B=this.stride[2],U=this.stride[3],X=this.stride[4],oe=this.offset,se=0,q=Math.ceil;return typeof A=="number"&&(se=A|0,se<0?(oe+=F*(S-1),S=q(-S/se)):S=q(S/se),F*=se),typeof f=="number"&&(se=f|0,se<0?(oe+=D*(R-1),R=q(-R/se)):R=q(R/se),D*=se),typeof u=="number"&&(se=u|0,se<0?(oe+=B*(z-1),z=q(-z/se)):z=q(z/se),B*=se),typeof h=="number"&&(se=h|0,se<0?(oe+=U*(O-1),O=q(-O/se)):O=q(O/se),U*=se),typeof o=="number"&&(se=o|0,se<0?(oe+=X*(I-1),I=q(-I/se)):I=q(I/se),X*=se),new y(this.data,S,R,z,O,I,F,D,B,U,X,oe)},T.transpose=function(A,f,u,h,o){A=A===void 0?0:A|0,f=f===void 0?1:f|0,u=u===void 0?2:u|0,h=h===void 0?3:h|0,o=o===void 0?4:o|0;var S=this.shape,R=this.stride;return new y(this.data,S[A],S[f],S[u],S[h],S[o],R[A],R[f],R[u],R[h],R[o],this.offset)},T.pick=function(A,f,u,h,o){var S=[],R=[],z=this.offset;typeof A=="number"&&A>=0?z=z+this.stride[0]*A|0:(S.push(this.shape[0]),R.push(this.stride[0])),typeof f=="number"&&f>=0?z=z+this.stride[1]*f|0:(S.push(this.shape[1]),R.push(this.stride[1])),typeof u=="number"&&u>=0?z=z+this.stride[2]*u|0:(S.push(this.shape[2]),R.push(this.stride[2])),typeof h=="number"&&h>=0?z=z+this.stride[3]*h|0:(S.push(this.shape[3]),R.push(this.stride[3])),typeof o=="number"&&o>=0?z=z+this.stride[4]*o|0:(S.push(this.shape[4]),R.push(this.stride[4]));var O=_[S.length+1];return O(this.data,S,R,z)},function(A,f,u,h){return new y(A,f[0],f[1],f[2],f[3],f[4],u[0],u[1],u[2],u[3],u[4],h)}}};function d(M,v){var _=v===-1?"T":String(v),l=r[_];return v===-1?l(M):v===0?l(M,m[M][0]):l(M,m[M],n)}function s(M){if(a(M))return"buffer";if(t)switch(Object.prototype.toString.call(M)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(M)?"array":"generic"}var m={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};function x(M,v,_,l){if(M===void 0){var u=m.array[0];return u([])}else typeof M=="number"&&(M=[M]);v===void 0&&(v=[M.length]);var y=v.length;if(_===void 0){_=new Array(y);for(var T=y-1,w=1;T>=0;--T)_[T]=w,w*=v[T]}if(l===void 0){l=0;for(var T=0;T<y;++T)_[T]<0&&(l-=(v[T]-1)*_[T])}for(var A=s(M),f=m[A];f.length<=y+1;)f.push(d(A,f.length-1));var u=f[y+1];return u(M,v,_,l)}p.exports=x},{"is-buffer":237}],260:[function(e,p,g){"use strict";var a=e("double-bits"),t=Math.pow(2,-1074),i=-1>>>0;p.exports=n;function n(r,d){if(isNaN(r)||isNaN(d))return NaN;if(r===d)return r;if(r===0)return d<0?-t:t;var s=a.hi(r),m=a.lo(r);return d>r==r>0?m===i?(s+=1,m=0):m+=1:m===0?(m=i,s-=1):m-=1,a.pack(m,s)}},{"double-bits":64}],261:[function(e,p,g){var a=1e-6,t=1e-6;g.vertexNormals=function(i,n,r){for(var d=n.length,s=new Array(d),m=r===void 0?a:r,x=0;x<d;++x)s[x]=[0,0,0];for(var x=0;x<i.length;++x)for(var M=i[x],v=0,_=M[M.length-1],l=M[0],y=0;y<M.length;++y){v=_,_=l,l=M[(y+1)%M.length];for(var T=n[v],w=n[_],A=n[l],f=new Array(3),u=0,h=new Array(3),o=0,S=0;S<3;++S)f[S]=T[S]-w[S],u+=f[S]*f[S],h[S]=A[S]-w[S],o+=h[S]*h[S];if(u*o>m)for(var R=s[_],z=1/Math.sqrt(u*o),S=0;S<3;++S){var O=(S+1)%3,I=(S+2)%3;R[S]+=z*(h[O]*f[I]-h[I]*f[O])}}for(var x=0;x<d;++x){for(var R=s[x],F=0,S=0;S<3;++S)F+=R[S]*R[S];if(F>m)for(var z=1/Math.sqrt(F),S=0;S<3;++S)R[S]*=z;else for(var S=0;S<3;++S)R[S]=0}return s},g.faceNormals=function(i,n,r){for(var d=i.length,s=new Array(d),m=r===void 0?t:r,x=0;x<d;++x){for(var M=i[x],v=new Array(3),_=0;_<3;++_)v[_]=n[M[_]];for(var l=new Array(3),y=new Array(3),_=0;_<3;++_)l[_]=v[1][_]-v[0][_],y[_]=v[2][_]-v[0][_];for(var T=new Array(3),w=0,_=0;_<3;++_){var A=(_+1)%3,f=(_+2)%3;T[_]=l[A]*y[f]-l[f]*y[A],w+=T[_]*T[_]}w>m?w=1/Math.sqrt(w):w=0;for(var _=0;_<3;++_)T[_]*=w;s[x]=T}return s}},{}],262:[function(e,p,g){"use strict";p.exports=a;function a(t,i,n,r,d,s,m,x,M,v){var _=i+s+v;if(l>0){var l=Math.sqrt(_+1);t[0]=.5*(m-M)/l,t[1]=.5*(x-r)/l,t[2]=.5*(n-s)/l,t[3]=.5*l}else{var y=Math.max(i,s,v),l=Math.sqrt(2*y-_+1);i>=y?(t[0]=.5*l,t[1]=.5*(d+n)/l,t[2]=.5*(x+r)/l,t[3]=.5*(m-M)/l):s>=y?(t[0]=.5*(n+d)/l,t[1]=.5*l,t[2]=.5*(M+m)/l,t[3]=.5*(x-r)/l):(t[0]=.5*(r+x)/l,t[1]=.5*(m+M)/l,t[2]=.5*l,t[3]=.5*(n-d)/l)}return t}},{}],263:[function(e,p,g){"use strict";p.exports=v;var a=e("filtered-vector"),t=e("gl-mat4/lookAt"),i=e("gl-mat4/fromQuat"),n=e("gl-mat4/invert"),r=e("./lib/quatFromFrame");function d(_,l,y){return Math.sqrt(Math.pow(_,2)+Math.pow(l,2)+Math.pow(y,2))}function s(_,l,y,T){return Math.sqrt(Math.pow(_,2)+Math.pow(l,2)+Math.pow(y,2)+Math.pow(T,2))}function m(_,l){var y=l[0],T=l[1],w=l[2],A=l[3],f=s(y,T,w,A);f>1e-6?(_[0]=y/f,_[1]=T/f,_[2]=w/f,_[3]=A/f):(_[0]=_[1]=_[2]=0,_[3]=1)}function x(_,l,y){this.radius=a([y]),this.center=a(l),this.rotation=a(_),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var M=x.prototype;M.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},M.recalcMatrix=function(_){this.radius.curve(_),this.center.curve(_),this.rotation.curve(_);var l=this.computedRotation;m(l,l);var y=this.computedMatrix;i(y,l);var T=this.computedCenter,w=this.computedEye,A=this.computedUp,f=Math.exp(this.computedRadius[0]);w[0]=T[0]+f*y[2],w[1]=T[1]+f*y[6],w[2]=T[2]+f*y[10],A[0]=y[1],A[1]=y[5],A[2]=y[9];for(var u=0;u<3;++u){for(var h=0,o=0;o<3;++o)h+=y[u+4*o]*w[o];y[12+u]=-h}},M.getMatrix=function(_,l){this.recalcMatrix(_);var y=this.computedMatrix;if(l){for(var T=0;T<16;++T)l[T]=y[T];return l}return y},M.idle=function(_){this.center.idle(_),this.radius.idle(_),this.rotation.idle(_)},M.flush=function(_){this.center.flush(_),this.radius.flush(_),this.rotation.flush(_)},M.pan=function(_,l,y,T){l=l||0,y=y||0,T=T||0,this.recalcMatrix(_);var w=this.computedMatrix,A=w[1],f=w[5],u=w[9],h=d(A,f,u);A/=h,f/=h,u/=h;var o=w[0],S=w[4],R=w[8],z=o*A+S*f+R*u;o-=A*z,S-=f*z,R-=u*z;var O=d(o,S,R);o/=O,S/=O,R/=O;var I=w[2],F=w[6],D=w[10],B=I*A+F*f+D*u,U=I*o+F*S+D*R;I-=B*A+U*o,F-=B*f+U*S,D-=B*u+U*R;var X=d(I,F,D);I/=X,F/=X,D/=X;var oe=o*l+A*y,se=S*l+f*y,q=R*l+u*y;this.center.move(_,oe,se,q);var K=Math.exp(this.computedRadius[0]);K=Math.max(1e-4,K+T),this.radius.set(_,Math.log(K))},M.rotate=function(_,l,y,T){this.recalcMatrix(_),l=l||0,y=y||0;var w=this.computedMatrix,A=w[0],f=w[4],u=w[8],h=w[1],o=w[5],S=w[9],R=w[2],z=w[6],O=w[10],I=l*A+y*h,F=l*f+y*o,D=l*u+y*S,B=-(z*D-O*F),U=-(O*I-R*D),X=-(R*F-z*I),oe=Math.sqrt(Math.max(0,1-Math.pow(B,2)-Math.pow(U,2)-Math.pow(X,2))),se=s(B,U,X,oe);se>1e-6?(B/=se,U/=se,X/=se,oe/=se):(B=U=X=0,oe=1);var q=this.computedRotation,K=q[0],G=q[1],Q=q[2],V=q[3],H=K*oe+V*B+G*X-Q*U,ee=G*oe+V*U+Q*B-K*X,J=Q*oe+V*X+K*U-G*B,W=V*oe-K*B-G*U-Q*X;if(T){B=R,U=z,X=O;var re=Math.sin(T)/d(B,U,X);B*=re,U*=re,X*=re,oe=Math.cos(l),H=H*oe+W*B+ee*X-J*U,ee=ee*oe+W*U+J*B-H*X,J=J*oe+W*X+H*U-ee*B,W=W*oe-H*B-ee*U-J*X}var j=s(H,ee,J,W);j>1e-6?(H/=j,ee/=j,J/=j,W/=j):(H=ee=J=0,W=1),this.rotation.set(_,H,ee,J,W)},M.lookAt=function(_,l,y,T){this.recalcMatrix(_),y=y||this.computedCenter,l=l||this.computedEye,T=T||this.computedUp;var w=this.computedMatrix;t(w,l,y,T);var A=this.computedRotation;r(A,w[0],w[1],w[2],w[4],w[5],w[6],w[8],w[9],w[10]),m(A,A),this.rotation.set(_,A[0],A[1],A[2],A[3]);for(var f=0,u=0;u<3;++u)f+=Math.pow(y[u]-l[u],2);this.radius.set(_,.5*Math.log(Math.max(f,1e-6))),this.center.set(_,y[0],y[1],y[2])},M.translate=function(_,l,y,T){this.center.move(_,l||0,y||0,T||0)},M.setMatrix=function(_,l){var y=this.computedRotation;r(y,l[0],l[1],l[2],l[4],l[5],l[6],l[8],l[9],l[10]),m(y,y),this.rotation.set(_,y[0],y[1],y[2],y[3]);var T=this.computedMatrix;n(T,l);var w=T[15];if(Math.abs(w)>1e-6){var A=T[12]/w,f=T[13]/w,u=T[14]/w;this.recalcMatrix(_);var h=Math.exp(this.computedRadius[0]);this.center.set(_,A-T[2]*h,f-T[6]*h,u-T[10]*h),this.radius.idle(_)}else this.center.idle(_),this.radius.idle(_)},M.setDistance=function(_,l){l>0&&this.radius.set(_,Math.log(l))},M.setDistanceLimits=function(_,l){_>0?_=Math.log(_):_=-1/0,l>0?l=Math.log(l):l=1/0,l=Math.max(l,_),this.radius.bounds[0][0]=_,this.radius.bounds[1][0]=l},M.getDistanceLimits=function(_){var l=this.radius.bounds;return _?(_[0]=Math.exp(l[0][0]),_[1]=Math.exp(l[1][0]),_):[Math.exp(l[0][0]),Math.exp(l[1][0])]},M.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},M.fromJSON=function(_){var l=this.lastT(),y=_.center;y&&this.center.set(l,y[0],y[1],y[2]);var T=_.rotation;T&&this.rotation.set(l,T[0],T[1],T[2],T[3]);var w=_.distance;w&&w>0&&this.radius.set(l,Math.log(w)),this.setDistanceLimits(_.zoomMin,_.zoomMax)};function v(_){_=_||{};var l=_.center||[0,0,0],y=_.rotation||[0,0,0,1],T=_.radius||1;l=[].slice.call(l,0,3),y=[].slice.call(y,0,4),m(y,y);var w=new x(y,l,Math.log(T));return w.setDistanceLimits(_.zoomMin,_.zoomMax),("eye"in _||"up"in _)&&w.lookAt(0,_.eye,_.center,_.up),w}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(e,p,g){"use strict";var a=e("repeat-string");p.exports=function(i,n,r){return r=typeof r<"u"?r+"":" ",a(r,n)+i}},{"repeat-string":277}],265:[function(e,p,g){p.exports=function(t,i){i||(i=[0,""]),t=String(t);var n=parseFloat(t,10);return i[0]=n,i[1]=t.match(/[\d.\-\+]*\s*(.*)/)[1]||"",i}},{}],266:[function(e,p,g){"use strict";p.exports=t;var a=e("compare-angle");function t(i,n){for(var r=n.length|0,d=i.length,s=[new Array(r),new Array(r)],m=0;m<r;++m)s[0][m]=[],s[1][m]=[];for(var m=0;m<d;++m){var x=i[m];s[0][x[0]].push(x),s[1][x[1]].push(x)}for(var M=[],m=0;m<r;++m)s[0][m].length+s[1][m].length===0&&M.push([m]);function v(u,h){var o=s[h][u[h]];o.splice(o.indexOf(u),1)}function _(u,h,o){for(var S,R,z,O=0;O<2;++O)if(s[O][h].length>0){S=s[O][h][0],z=O;break}R=S[z^1];for(var I=0;I<2;++I)for(var F=s[I][h],D=0;D<F.length;++D){var B=F[D],U=B[I^1],X=a(n[u],n[h],n[R],n[U]);X>0&&(S=B,R=U,z=I)}return o||S&&v(S,z),R}function l(u,h){var o=s[h][u][0],S=[u];v(o,h);for(var R=o[h^1],z=h;;){for(;R!==u;)S.push(R),R=_(S[S.length-2],R,!1);if(s[0][u].length+s[1][u].length===0)break;var O=S[S.length-1],I=u,F=S[1],D=_(O,I,!0);if(a(n[O],n[I],n[F],n[D])<0)break;S.push(u),R=_(O,I)}return S}function y(u,h){return h[1]===h[h.length-1]}for(var m=0;m<r;++m)for(var T=0;T<2;++T){for(var w=[];s[T][m].length>0;){var A=s[0][m].length,f=l(m,T);y(w,f)?w.push.apply(w,f):(w.length>0&&M.push(w),w=f)}w.length>0&&M.push(w)}return M}},{"compare-angle":54}],267:[function(e,p,g){"use strict";p.exports=t;var a=e("edges-to-adjacency-list");function t(i,n){for(var r=a(i,n.length),d=new Array(n.length),s=new Array(n.length),m=[],x=0;x<n.length;++x){var M=r[x].length;s[x]=M,d[x]=!0,M<=1&&m.push(x)}for(;m.length>0;){var v=m.pop();d[v]=!1;for(var _=r[v],x=0;x<_.length;++x){var l=_[x];--s[l]===0&&m.push(l)}}for(var y=new Array(n.length),T=[],x=0;x<n.length;++x)if(d[x]){var v=T.length;y[x]=v,T.push(n[x])}else y[x]=-1;for(var w=[],x=0;x<i.length;++x){var A=i[x];d[A[0]]&&d[A[1]]&&w.push([y[A[0]],y[A[1]]])}return[w,T]}},{"edges-to-adjacency-list":66}],268:[function(e,p,g){"use strict";p.exports=M;var a=e("edges-to-adjacency-list"),t=e("planar-dual"),i=e("point-in-big-polygon"),n=e("two-product"),r=e("robust-sum"),d=e("uniq"),s=e("./lib/trim-leaves");function m(v,_){for(var l=new Array(v),y=0;y<v;++y)l[y]=_;return l}function x(v){for(var _=new Array(v),l=0;l<v;++l)_[l]=[];return _}function M(v,_){var re=s(v,_);v=re[0],_=re[1];for(var l=_.length,y=v.length,T=a(v,_.length),w=0;w<l;++w)if(T[w].length%2===1)throw new Error("planar-graph-to-polyline: graph must be manifold");var A=t(v,_);function f(xe){for(var Ee=xe.length,Te=[0],de=0;de<Ee;++de){var be=_[xe[de]],Le=_[xe[(de+1)%Ee]],De=n(-be[0],be[1]),ye=n(-be[0],Le[1]),ke=n(Le[0],be[1]),Oe=n(Le[0],Le[1]);Te=r(Te,r(r(De,ye),r(ke,Oe)))}return Te[Te.length-1]>0}A=A.filter(f);for(var u=A.length,h=new Array(u),o=new Array(u),w=0;w<u;++w){h[w]=w;var S=new Array(u),R=A[w].map(function(Ee){return _[Ee]}),z=i([R]),O=0;e:for(var I=0;I<u;++I)if(S[I]=0,w!==I){for(var F=A[I],D=F.length,B=0;B<D;++B){var U=z(_[F[B]]);if(U!==0){U<0&&(S[I]=1,O+=1);continue e}}S[I]=1,O+=1}o[w]=[O,w,S]}o.sort(function(xe,Ee){return Ee[0]-xe[0]});for(var w=0;w<u;++w)for(var S=o[w],X=S[1],oe=S[2],I=0;I<u;++I)oe[I]&&(h[I]=X);for(var se=x(u),w=0;w<u;++w)se[w].push(h[w]),se[h[w]].push(w);for(var q={},K=m(l,!1),w=0;w<u;++w)for(var F=A[w],D=F.length,I=0;I<D;++I){var G=F[I],Q=F[(I+1)%D],V=Math.min(G,Q)+":"+Math.max(G,Q);if(V in q){var H=q[V];se[H].push(w),se[w].push(H),K[G]=K[Q]=!0}else q[V]=w}function ee(xe){for(var Ee=xe.length,Te=0;Te<Ee;++Te)if(!K[xe[Te]])return!1;return!0}for(var J=[],W=m(u,-1),w=0;w<u;++w)h[w]===w&&!ee(A[w])?(J.push(w),W[w]=0):W[w]=-1;for(var re=[];J.length>0;){var j=J.pop(),Z=se[j];d(Z,function(xe,Ee){return xe-Ee});var ne=Z.length,le=W[j],ge;if(le===0){var F=A[j];ge=[F]}for(var w=0;w<ne;++w){var pe=Z[w];if(!(W[pe]>=0)&&(W[pe]=le^1,J.push(pe),le===0)){var F=A[pe];ee(F)||(F.reverse(),ge.push(F))}}le===0&&re.push(ge)}return re}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(e,p,g){p.exports=_;var a=e("robust-orientation")[3],t=e("slab-decomposition"),i=e("interval-tree-1d"),n=e("binary-search-bounds");function r(){return!0}function d(l){return function(y,T){var w=l[y];return w?!!w.queryPoint(T,r):!1}}function s(l){for(var y={},T=0;T<l.length;++T){var w=l[T],A=w[0][0],f=w[0][1],u=w[1][1],h=[Math.min(f,u),Math.max(f,u)];A in y?y[A].push(h):y[A]=[h]}for(var o={},S=Object.keys(y),T=0;T<S.length;++T){var R=y[S[T]];o[S[T]]=i(R)}return d(o)}function m(l,y){return function(T){var w=n.le(y,T[0]);if(w<0)return 1;var A=l[w];if(!A)if(w>0&&y[w]===T[0])A=l[w-1];else return 1;for(var f=1;A;){var u=A.key,h=a(T,u[0],u[1]);if(u[0][0]<u[1][0])if(h<0)A=A.left;else if(h>0)f=-1,A=A.right;else return 0;else if(h>0)A=A.left;else if(h<0)f=1,A=A.right;else return 0}return f}}function x(l){return 1}function M(l){return function(T){return l(T[0],T[1])?0:1}}function v(l,y){return function(w){return l(w[0],w[1])?0:y(w)}}function _(l){for(var y=l.length,T=[],w=[],A=0,f=0;f<y;++f)for(var u=l[f],h=u.length,o=h-1,S=0;S<h;o=S++){var R=u[o],z=u[S];R[0]===z[0]?w.push([R,z]):T.push([R,z])}if(T.length===0)return w.length===0?x:M(s(w));var O=t(T),I=m(O.slabs,O.coordinates);return w.length===0?I:v(s(w),I)}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(e,p,g){"use strict";var a=new Float64Array(4),t=new Float64Array(4),i=new Float64Array(4);function n(r,d,s,m,x){a.length<m.length&&(a=new Float64Array(m.length),t=new Float64Array(m.length),i=new Float64Array(m.length));for(var M=0;M<m.length;++M)a[M]=r[M]-m[M],t[M]=d[M]-r[M],i[M]=s[M]-r[M];for(var v=0,_=0,l=0,y=0,T=0,w=0,M=0;M<m.length;++M){var A=t[M],f=i[M],u=a[M];v+=A*A,_+=A*f,l+=f*f,y+=u*A,T+=u*f,w+=u*u}var h=Math.abs(v*l-_*_),o=_*T-l*y,S=_*y-v*T,R;if(o+S<=h)if(o<0)S<0&&y<0?(S=0,-y>=v?(o=1,R=v+2*y+w):(o=-y/v,R=y*o+w)):(o=0,T>=0?(S=0,R=w):-T>=l?(S=1,R=l+2*T+w):(S=-T/l,R=T*S+w));else if(S<0)S=0,y>=0?(o=0,R=w):-y>=v?(o=1,R=v+2*y+w):(o=-y/v,R=y*o+w);else{var z=1/h;o*=z,S*=z,R=o*(v*o+_*S+2*y)+S*(_*o+l*S+2*T)+w}else{var O,I,F,D;o<0?(O=_+y,I=l+T,I>O?(F=I-O,D=v-2*_+l,F>=D?(o=1,S=0,R=v+2*y+w):(o=F/D,S=1-o,R=o*(v*o+_*S+2*y)+S*(_*o+l*S+2*T)+w)):(o=0,I<=0?(S=1,R=l+2*T+w):T>=0?(S=0,R=w):(S=-T/l,R=T*S+w))):S<0?(O=_+T,I=v+y,I>O?(F=I-O,D=v-2*_+l,F>=D?(S=1,o=0,R=l+2*T+w):(S=F/D,o=1-S,R=o*(v*o+_*S+2*y)+S*(_*o+l*S+2*T)+w)):(S=0,I<=0?(o=1,R=v+2*y+w):y>=0?(o=0,R=w):(o=-y/v,R=y*o+w))):(F=l+T-_-y,F<=0?(o=0,S=1,R=l+2*T+w):(D=v-2*_+l,F>=D?(o=1,S=0,R=v+2*y+w):(o=F/D,S=1-o,R=o*(v*o+_*S+2*y)+S*(_*o+l*S+2*T)+w)))}for(var B=1-o-S,M=0;M<m.length;++M)x[M]=B*r[M]+o*d[M]+S*s[M];return R<0?0:R}p.exports=n},{}],271:[function(e,p,g){p.exports=e("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(e,p,g){"use strict";var a=e("big-rat/add");p.exports=t;function t(i,n){for(var r=i.length,d=new Array(r),s=0;s<r;++s)d[s]=a(i[s],n[s]);return d}},{"big-rat/add":15}],273:[function(e,p,g){"use strict";p.exports=t;var a=e("big-rat");function t(i){for(var n=new Array(i.length),r=0;r<i.length;++r)n[r]=a(i[r]);return n}},{"big-rat":18}],274:[function(e,p,g){"use strict";var a=e("big-rat"),t=e("big-rat/mul");p.exports=i;function i(n,r){for(var d=a(r),s=n.length,m=new Array(s),x=0;x<s;++x)m[x]=t(n[x],d);return m}},{"big-rat":18,"big-rat/mul":27}],275:[function(e,p,g){"use strict";var a=e("big-rat/sub");p.exports=t;function t(i,n){for(var r=i.length,d=new Array(r),s=0;s<r;++s)d[s]=a(i[s],n[s]);return d}},{"big-rat/sub":29}],276:[function(e,p,g){"use strict";var a=e("compare-cell"),t=e("compare-oriented-cell"),i=e("cell-orientation");p.exports=n;function n(r){r.sort(t);for(var d=r.length,s=0,m=0;m<d;++m){var x=r[m],M=i(x);if(M!==0){if(s>0){var v=r[s-1];if(a(x,v)===0&&i(v)!==M){s-=1;continue}}r[s++]=x}}return r.length=s,r}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(e,p,g){"use strict";var a="",t;p.exports=i;function i(n,r){if(typeof n!="string")throw new TypeError("expected a string");if(r===1)return n;if(r===2)return n+n;var d=n.length*r;if(t!==n||typeof t>"u")t=n,a="";else if(a.length>=d)return a.substr(0,d);for(;d>a.length&&r>1;)r&1&&(a+=n),r>>=1,n+=n;return a+=n,a=a.substr(0,d),a}},{}],278:[function(e,p,g){(function(a){(function(){p.exports=a.performance&&a.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,typeof b<"u"?b:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(e,p,g){"use strict";p.exports=a;function a(t){for(var i=t.length,n=t[t.length-1],r=i,d=i-2;d>=0;--d){var s=n,m=t[d];n=s+m;var x=n-s,M=m-x;M&&(t[--r]=n,n=M)}for(var v=0,d=r;d<i;++d){var s=t[d],m=n;n=s+m;var x=n-s,M=m-x;M&&(t[v++]=M)}return t[v++]=n,t.length=v,t}},{}],280:[function(e,p,g){"use strict";var a=e("two-product"),t=e("robust-sum"),i=e("robust-scale"),n=e("robust-compress"),r=6;function d(y,T,w,A){return function(u){return A(y(w(u[0][0],u[1][1]),w(-u[0][1],u[1][0])))}}function s(y,T,w,A){return function(u){return A(y(T(y(w(u[1][1],u[2][2]),w(-u[1][2],u[2][1])),u[0][0]),y(T(y(w(u[1][0],u[2][2]),w(-u[1][2],u[2][0])),-u[0][1]),T(y(w(u[1][0],u[2][1]),w(-u[1][1],u[2][0])),u[0][2]))))}}function m(y,T,w,A){return function(u){return A(y(y(T(y(T(y(w(u[2][2],u[3][3]),w(-u[2][3],u[3][2])),u[1][1]),y(T(y(w(u[2][1],u[3][3]),w(-u[2][3],u[3][1])),-u[1][2]),T(y(w(u[2][1],u[3][2]),w(-u[2][2],u[3][1])),u[1][3]))),u[0][0]),T(y(T(y(w(u[2][2],u[3][3]),w(-u[2][3],u[3][2])),u[1][0]),y(T(y(w(u[2][0],u[3][3]),w(-u[2][3],u[3][0])),-u[1][2]),T(y(w(u[2][0],u[3][2]),w(-u[2][2],u[3][0])),u[1][3]))),-u[0][1])),y(T(y(T(y(w(u[2][1],u[3][3]),w(-u[2][3],u[3][1])),u[1][0]),y(T(y(w(u[2][0],u[3][3]),w(-u[2][3],u[3][0])),-u[1][1]),T(y(w(u[2][0],u[3][1]),w(-u[2][1],u[3][0])),u[1][3]))),u[0][2]),T(y(T(y(w(u[2][1],u[3][2]),w(-u[2][2],u[3][1])),u[1][0]),y(T(y(w(u[2][0],u[3][2]),w(-u[2][2],u[3][0])),-u[1][1]),T(y(w(u[2][0],u[3][1]),w(-u[2][1],u[3][0])),u[1][2]))),-u[0][3]))))}}function x(y,T,w,A){return function(u){return A(y(y(T(y(y(T(y(T(y(w(u[3][3],u[4][4]),w(-u[3][4],u[4][3])),u[2][2]),y(T(y(w(u[3][2],u[4][4]),w(-u[3][4],u[4][2])),-u[2][3]),T(y(w(u[3][2],u[4][3]),w(-u[3][3],u[4][2])),u[2][4]))),u[1][1]),T(y(T(y(w(u[3][3],u[4][4]),w(-u[3][4],u[4][3])),u[2][1]),y(T(y(w(u[3][1],u[4][4]),w(-u[3][4],u[4][1])),-u[2][3]),T(y(w(u[3][1],u[4][3]),w(-u[3][3],u[4][1])),u[2][4]))),-u[1][2])),y(T(y(T(y(w(u[3][2],u[4][4]),w(-u[3][4],u[4][2])),u[2][1]),y(T(y(w(u[3][1],u[4][4]),w(-u[3][4],u[4][1])),-u[2][2]),T(y(w(u[3][1],u[4][2]),w(-u[3][2],u[4][1])),u[2][4]))),u[1][3]),T(y(T(y(w(u[3][2],u[4][3]),w(-u[3][3],u[4][2])),u[2][1]),y(T(y(w(u[3][1],u[4][3]),w(-u[3][3],u[4][1])),-u[2][2]),T(y(w(u[3][1],u[4][2]),w(-u[3][2],u[4][1])),u[2][3]))),-u[1][4]))),u[0][0]),T(y(y(T(y(T(y(w(u[3][3],u[4][4]),w(-u[3][4],u[4][3])),u[2][2]),y(T(y(w(u[3][2],u[4][4]),w(-u[3][4],u[4][2])),-u[2][3]),T(y(w(u[3][2],u[4][3]),w(-u[3][3],u[4][2])),u[2][4]))),u[1][0]),T(y(T(y(w(u[3][3],u[4][4]),w(-u[3][4],u[4][3])),u[2][0]),y(T(y(w(u[3][0],u[4][4]),w(-u[3][4],u[4][0])),-u[2][3]),T(y(w(u[3][0],u[4][3]),w(-u[3][3],u[4][0])),u[2][4]))),-u[1][2])),y(T(y(T(y(w(u[3][2],u[4][4]),w(-u[3][4],u[4][2])),u[2][0]),y(T(y(w(u[3][0],u[4][4]),w(-u[3][4],u[4][0])),-u[2][2]),T(y(w(u[3][0],u[4][2]),w(-u[3][2],u[4][0])),u[2][4]))),u[1][3]),T(y(T(y(w(u[3][2],u[4][3]),w(-u[3][3],u[4][2])),u[2][0]),y(T(y(w(u[3][0],u[4][3]),w(-u[3][3],u[4][0])),-u[2][2]),T(y(w(u[3][0],u[4][2]),w(-u[3][2],u[4][0])),u[2][3]))),-u[1][4]))),-u[0][1])),y(T(y(y(T(y(T(y(w(u[3][3],u[4][4]),w(-u[3][4],u[4][3])),u[2][1]),y(T(y(w(u[3][1],u[4][4]),w(-u[3][4],u[4][1])),-u[2][3]),T(y(w(u[3][1],u[4][3]),w(-u[3][3],u[4][1])),u[2][4]))),u[1][0]),T(y(T(y(w(u[3][3],u[4][4]),w(-u[3][4],u[4][3])),u[2][0]),y(T(y(w(u[3][0],u[4][4]),w(-u[3][4],u[4][0])),-u[2][3]),T(y(w(u[3][0],u[4][3]),w(-u[3][3],u[4][0])),u[2][4]))),-u[1][1])),y(T(y(T(y(w(u[3][1],u[4][4]),w(-u[3][4],u[4][1])),u[2][0]),y(T(y(w(u[3][0],u[4][4]),w(-u[3][4],u[4][0])),-u[2][1]),T(y(w(u[3][0],u[4][1]),w(-u[3][1],u[4][0])),u[2][4]))),u[1][3]),T(y(T(y(w(u[3][1],u[4][3]),w(-u[3][3],u[4][1])),u[2][0]),y(T(y(w(u[3][0],u[4][3]),w(-u[3][3],u[4][0])),-u[2][1]),T(y(w(u[3][0],u[4][1]),w(-u[3][1],u[4][0])),u[2][3]))),-u[1][4]))),u[0][2]),y(T(y(y(T(y(T(y(w(u[3][2],u[4][4]),w(-u[3][4],u[4][2])),u[2][1]),y(T(y(w(u[3][1],u[4][4]),w(-u[3][4],u[4][1])),-u[2][2]),T(y(w(u[3][1],u[4][2]),w(-u[3][2],u[4][1])),u[2][4]))),u[1][0]),T(y(T(y(w(u[3][2],u[4][4]),w(-u[3][4],u[4][2])),u[2][0]),y(T(y(w(u[3][0],u[4][4]),w(-u[3][4],u[4][0])),-u[2][2]),T(y(w(u[3][0],u[4][2]),w(-u[3][2],u[4][0])),u[2][4]))),-u[1][1])),y(T(y(T(y(w(u[3][1],u[4][4]),w(-u[3][4],u[4][1])),u[2][0]),y(T(y(w(u[3][0],u[4][4]),w(-u[3][4],u[4][0])),-u[2][1]),T(y(w(u[3][0],u[4][1]),w(-u[3][1],u[4][0])),u[2][4]))),u[1][2]),T(y(T(y(w(u[3][1],u[4][2]),w(-u[3][2],u[4][1])),u[2][0]),y(T(y(w(u[3][0],u[4][2]),w(-u[3][2],u[4][0])),-u[2][1]),T(y(w(u[3][0],u[4][1]),w(-u[3][1],u[4][0])),u[2][2]))),-u[1][4]))),-u[0][3]),T(y(y(T(y(T(y(w(u[3][2],u[4][3]),w(-u[3][3],u[4][2])),u[2][1]),y(T(y(w(u[3][1],u[4][3]),w(-u[3][3],u[4][1])),-u[2][2]),T(y(w(u[3][1],u[4][2]),w(-u[3][2],u[4][1])),u[2][3]))),u[1][0]),T(y(T(y(w(u[3][2],u[4][3]),w(-u[3][3],u[4][2])),u[2][0]),y(T(y(w(u[3][0],u[4][3]),w(-u[3][3],u[4][0])),-u[2][2]),T(y(w(u[3][0],u[4][2]),w(-u[3][2],u[4][0])),u[2][3]))),-u[1][1])),y(T(y(T(y(w(u[3][1],u[4][3]),w(-u[3][3],u[4][1])),u[2][0]),y(T(y(w(u[3][0],u[4][3]),w(-u[3][3],u[4][0])),-u[2][1]),T(y(w(u[3][0],u[4][1]),w(-u[3][1],u[4][0])),u[2][3]))),u[1][2]),T(y(T(y(w(u[3][1],u[4][2]),w(-u[3][2],u[4][1])),u[2][0]),y(T(y(w(u[3][0],u[4][2]),w(-u[3][2],u[4][0])),-u[2][1]),T(y(w(u[3][0],u[4][1]),w(-u[3][1],u[4][0])),u[2][2]))),-u[1][3]))),u[0][4])))))}}function M(y){var T=y===2?d:y===3?s:y===4?m:y===5?x:void 0;return T(t,i,a,n)}var v=[function(){return[0]},function(T){return[T[0][0]]}];function _(y,T,w,A,f,u,h,o){return function(R){switch(R.length){case 0:return y(R);case 1:return T(R);case 2:return w(R);case 3:return A(R);case 4:return f(R);case 5:return u(R)}var z=h[R.length];return z||(z=h[R.length]=o(R.length)),z(R)}}function l(){for(;v.length<r;)v.push(M(v.length));p.exports=_.apply(void 0,v.concat([v,M]));for(var y=0;y<v.length;++y)p.exports[y]=v[y]}l()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(e,p,g){"use strict";var a=e("two-product"),t=e("robust-sum");p.exports=i;function i(n,r){for(var d=a(n[0],r[0]),s=1;s<n.length;++s)d=t(d,a(n[s],r[s]));return d}},{"robust-sum":289,"two-product":306}],282:[function(e,p,g){"use strict";var a=e("two-product"),t=e("robust-sum"),i=e("robust-subtract"),n=e("robust-scale"),r=6;function d(f){var u=f===3?M:f===4?v:f===5?_:l;return u(t,i,a,n)}function s(){return 0}function m(){return 0}function x(){return 0}function M(f,u,h,o){function S(R,z,O){var I=h(R[0],R[0]),F=o(I,z[0]),D=o(I,O[0]),B=h(z[0],z[0]),U=o(B,R[0]),X=o(B,O[0]),oe=h(O[0],O[0]),se=o(oe,R[0]),q=o(oe,z[0]),K=f(u(q,X),u(U,F)),G=u(se,D),Q=u(K,G);return Q[Q.length-1]}return S}function v(f,u,h,o){function S(R,z,O,I){var F=f(h(R[0],R[0]),h(R[1],R[1])),D=o(F,z[0]),B=o(F,O[0]),U=o(F,I[0]),X=f(h(z[0],z[0]),h(z[1],z[1])),oe=o(X,R[0]),se=o(X,O[0]),q=o(X,I[0]),K=f(h(O[0],O[0]),h(O[1],O[1])),G=o(K,R[0]),Q=o(K,z[0]),V=o(K,I[0]),H=f(h(I[0],I[0]),h(I[1],I[1])),ee=o(H,R[0]),J=o(H,z[0]),W=o(H,O[0]),re=f(f(o(u(W,V),z[1]),f(o(u(J,q),-O[1]),o(u(Q,se),I[1]))),f(o(u(J,q),R[1]),f(o(u(ee,U),-z[1]),o(u(oe,D),I[1])))),j=f(f(o(u(W,V),R[1]),f(o(u(ee,U),-O[1]),o(u(G,B),I[1]))),f(o(u(Q,se),R[1]),f(o(u(G,B),-z[1]),o(u(oe,D),O[1])))),Z=u(re,j);return Z[Z.length-1]}return S}function _(f,u,h,o){function S(R,z,O,I,F){var D=f(h(R[0],R[0]),f(h(R[1],R[1]),h(R[2],R[2]))),B=o(D,z[0]),U=o(D,O[0]),X=o(D,I[0]),oe=o(D,F[0]),se=f(h(z[0],z[0]),f(h(z[1],z[1]),h(z[2],z[2]))),q=o(se,R[0]),K=o(se,O[0]),G=o(se,I[0]),Q=o(se,F[0]),V=f(h(O[0],O[0]),f(h(O[1],O[1]),h(O[2],O[2]))),H=o(V,R[0]),ee=o(V,z[0]),J=o(V,I[0]),W=o(V,F[0]),re=f(h(I[0],I[0]),f(h(I[1],I[1]),h(I[2],I[2]))),j=o(re,R[0]),Z=o(re,z[0]),ne=o(re,O[0]),le=o(re,F[0]),ge=f(h(F[0],F[0]),f(h(F[1],F[1]),h(F[2],F[2]))),pe=o(ge,R[0]),xe=o(ge,z[0]),Ee=o(ge,O[0]),Te=o(ge,I[0]),de=f(f(f(o(f(o(u(Te,le),O[1]),f(o(u(Ee,W),-I[1]),o(u(ne,J),F[1]))),z[2]),f(o(f(o(u(Te,le),z[1]),f(o(u(xe,Q),-I[1]),o(u(Z,G),F[1]))),-O[2]),o(f(o(u(Ee,W),z[1]),f(o(u(xe,Q),-O[1]),o(u(ee,K),F[1]))),I[2]))),f(o(f(o(u(ne,J),z[1]),f(o(u(Z,G),-O[1]),o(u(ee,K),I[1]))),-F[2]),f(o(f(o(u(Te,le),z[1]),f(o(u(xe,Q),-I[1]),o(u(Z,G),F[1]))),R[2]),o(f(o(u(Te,le),R[1]),f(o(u(pe,oe),-I[1]),o(u(j,X),F[1]))),-z[2])))),f(f(o(f(o(u(xe,Q),R[1]),f(o(u(pe,oe),-z[1]),o(u(q,B),F[1]))),I[2]),f(o(f(o(u(Z,G),R[1]),f(o(u(j,X),-z[1]),o(u(q,B),I[1]))),-F[2]),o(f(o(u(ne,J),z[1]),f(o(u(Z,G),-O[1]),o(u(ee,K),I[1]))),R[2]))),f(o(f(o(u(ne,J),R[1]),f(o(u(j,X),-O[1]),o(u(H,U),I[1]))),-z[2]),f(o(f(o(u(Z,G),R[1]),f(o(u(j,X),-z[1]),o(u(q,B),I[1]))),O[2]),o(f(o(u(ee,K),R[1]),f(o(u(H,U),-z[1]),o(u(q,B),O[1]))),-I[2]))))),be=f(f(f(o(f(o(u(Te,le),O[1]),f(o(u(Ee,W),-I[1]),o(u(ne,J),F[1]))),R[2]),o(f(o(u(Te,le),R[1]),f(o(u(pe,oe),-I[1]),o(u(j,X),F[1]))),-O[2])),f(o(f(o(u(Ee,W),R[1]),f(o(u(pe,oe),-O[1]),o(u(H,U),F[1]))),I[2]),o(f(o(u(ne,J),R[1]),f(o(u(j,X),-O[1]),o(u(H,U),I[1]))),-F[2]))),f(f(o(f(o(u(Ee,W),z[1]),f(o(u(xe,Q),-O[1]),o(u(ee,K),F[1]))),R[2]),o(f(o(u(Ee,W),R[1]),f(o(u(pe,oe),-O[1]),o(u(H,U),F[1]))),-z[2])),f(o(f(o(u(xe,Q),R[1]),f(o(u(pe,oe),-z[1]),o(u(q,B),F[1]))),O[2]),o(f(o(u(ee,K),R[1]),f(o(u(H,U),-z[1]),o(u(q,B),O[1]))),-F[2])))),Le=u(de,be);return Le[Le.length-1]}return S}function l(f,u,h,o){function S(R,z,O,I,F,D){var B=f(f(h(R[0],R[0]),h(R[1],R[1])),f(h(R[2],R[2]),h(R[3],R[3]))),U=o(B,z[0]),X=o(B,O[0]),oe=o(B,I[0]),se=o(B,F[0]),q=o(B,D[0]),K=f(f(h(z[0],z[0]),h(z[1],z[1])),f(h(z[2],z[2]),h(z[3],z[3]))),G=o(K,R[0]),Q=o(K,O[0]),V=o(K,I[0]),H=o(K,F[0]),ee=o(K,D[0]),J=f(f(h(O[0],O[0]),h(O[1],O[1])),f(h(O[2],O[2]),h(O[3],O[3]))),W=o(J,R[0]),re=o(J,z[0]),j=o(J,I[0]),Z=o(J,F[0]),ne=o(J,D[0]),le=f(f(h(I[0],I[0]),h(I[1],I[1])),f(h(I[2],I[2]),h(I[3],I[3]))),ge=o(le,R[0]),pe=o(le,z[0]),xe=o(le,O[0]),Ee=o(le,F[0]),Te=o(le,D[0]),de=f(f(h(F[0],F[0]),h(F[1],F[1])),f(h(F[2],F[2]),h(F[3],F[3]))),be=o(de,R[0]),Le=o(de,z[0]),De=o(de,O[0]),ye=o(de,I[0]),ke=o(de,D[0]),Oe=f(f(h(D[0],D[0]),h(D[1],D[1])),f(h(D[2],D[2]),h(D[3],D[3]))),Qe=o(Oe,R[0]),Ve=o(Oe,z[0]),Ue=o(Oe,O[0]),Ie=o(Oe,I[0]),at=o(Oe,F[0]),pt=f(f(f(o(f(f(o(f(o(u(at,ke),I[1]),f(o(u(Ie,Te),-F[1]),o(u(ye,Ee),D[1]))),O[2]),o(f(o(u(at,ke),O[1]),f(o(u(Ue,ne),-F[1]),o(u(De,Z),D[1]))),-I[2])),f(o(f(o(u(Ie,Te),O[1]),f(o(u(Ue,ne),-I[1]),o(u(xe,j),D[1]))),F[2]),o(f(o(u(ye,Ee),O[1]),f(o(u(De,Z),-I[1]),o(u(xe,j),F[1]))),-D[2]))),z[3]),f(o(f(f(o(f(o(u(at,ke),I[1]),f(o(u(Ie,Te),-F[1]),o(u(ye,Ee),D[1]))),z[2]),o(f(o(u(at,ke),z[1]),f(o(u(Ve,ee),-F[1]),o(u(Le,H),D[1]))),-I[2])),f(o(f(o(u(Ie,Te),z[1]),f(o(u(Ve,ee),-I[1]),o(u(pe,V),D[1]))),F[2]),o(f(o(u(ye,Ee),z[1]),f(o(u(Le,H),-I[1]),o(u(pe,V),F[1]))),-D[2]))),-O[3]),o(f(f(o(f(o(u(at,ke),O[1]),f(o(u(Ue,ne),-F[1]),o(u(De,Z),D[1]))),z[2]),o(f(o(u(at,ke),z[1]),f(o(u(Ve,ee),-F[1]),o(u(Le,H),D[1]))),-O[2])),f(o(f(o(u(Ue,ne),z[1]),f(o(u(Ve,ee),-O[1]),o(u(re,Q),D[1]))),F[2]),o(f(o(u(De,Z),z[1]),f(o(u(Le,H),-O[1]),o(u(re,Q),F[1]))),-D[2]))),I[3]))),f(f(o(f(f(o(f(o(u(Ie,Te),O[1]),f(o(u(Ue,ne),-I[1]),o(u(xe,j),D[1]))),z[2]),o(f(o(u(Ie,Te),z[1]),f(o(u(Ve,ee),-I[1]),o(u(pe,V),D[1]))),-O[2])),f(o(f(o(u(Ue,ne),z[1]),f(o(u(Ve,ee),-O[1]),o(u(re,Q),D[1]))),I[2]),o(f(o(u(xe,j),z[1]),f(o(u(pe,V),-O[1]),o(u(re,Q),I[1]))),-D[2]))),-F[3]),o(f(f(o(f(o(u(ye,Ee),O[1]),f(o(u(De,Z),-I[1]),o(u(xe,j),F[1]))),z[2]),o(f(o(u(ye,Ee),z[1]),f(o(u(Le,H),-I[1]),o(u(pe,V),F[1]))),-O[2])),f(o(f(o(u(De,Z),z[1]),f(o(u(Le,H),-O[1]),o(u(re,Q),F[1]))),I[2]),o(f(o(u(xe,j),z[1]),f(o(u(pe,V),-O[1]),o(u(re,Q),I[1]))),-F[2]))),D[3])),f(o(f(f(o(f(o(u(at,ke),I[1]),f(o(u(Ie,Te),-F[1]),o(u(ye,Ee),D[1]))),z[2]),o(f(o(u(at,ke),z[1]),f(o(u(Ve,ee),-F[1]),o(u(Le,H),D[1]))),-I[2])),f(o(f(o(u(Ie,Te),z[1]),f(o(u(Ve,ee),-I[1]),o(u(pe,V),D[1]))),F[2]),o(f(o(u(ye,Ee),z[1]),f(o(u(Le,H),-I[1]),o(u(pe,V),F[1]))),-D[2]))),R[3]),o(f(f(o(f(o(u(at,ke),I[1]),f(o(u(Ie,Te),-F[1]),o(u(ye,Ee),D[1]))),R[2]),o(f(o(u(at,ke),R[1]),f(o(u(Qe,q),-F[1]),o(u(be,se),D[1]))),-I[2])),f(o(f(o(u(Ie,Te),R[1]),f(o(u(Qe,q),-I[1]),o(u(ge,oe),D[1]))),F[2]),o(f(o(u(ye,Ee),R[1]),f(o(u(be,se),-I[1]),o(u(ge,oe),F[1]))),-D[2]))),-z[3])))),f(f(f(o(f(f(o(f(o(u(at,ke),z[1]),f(o(u(Ve,ee),-F[1]),o(u(Le,H),D[1]))),R[2]),o(f(o(u(at,ke),R[1]),f(o(u(Qe,q),-F[1]),o(u(be,se),D[1]))),-z[2])),f(o(f(o(u(Ve,ee),R[1]),f(o(u(Qe,q),-z[1]),o(u(G,U),D[1]))),F[2]),o(f(o(u(Le,H),R[1]),f(o(u(be,se),-z[1]),o(u(G,U),F[1]))),-D[2]))),I[3]),o(f(f(o(f(o(u(Ie,Te),z[1]),f(o(u(Ve,ee),-I[1]),o(u(pe,V),D[1]))),R[2]),o(f(o(u(Ie,Te),R[1]),f(o(u(Qe,q),-I[1]),o(u(ge,oe),D[1]))),-z[2])),f(o(f(o(u(Ve,ee),R[1]),f(o(u(Qe,q),-z[1]),o(u(G,U),D[1]))),I[2]),o(f(o(u(pe,V),R[1]),f(o(u(ge,oe),-z[1]),o(u(G,U),I[1]))),-D[2]))),-F[3])),f(o(f(f(o(f(o(u(ye,Ee),z[1]),f(o(u(Le,H),-I[1]),o(u(pe,V),F[1]))),R[2]),o(f(o(u(ye,Ee),R[1]),f(o(u(be,se),-I[1]),o(u(ge,oe),F[1]))),-z[2])),f(o(f(o(u(Le,H),R[1]),f(o(u(be,se),-z[1]),o(u(G,U),F[1]))),I[2]),o(f(o(u(pe,V),R[1]),f(o(u(ge,oe),-z[1]),o(u(G,U),I[1]))),-F[2]))),D[3]),o(f(f(o(f(o(u(Ie,Te),O[1]),f(o(u(Ue,ne),-I[1]),o(u(xe,j),D[1]))),z[2]),o(f(o(u(Ie,Te),z[1]),f(o(u(Ve,ee),-I[1]),o(u(pe,V),D[1]))),-O[2])),f(o(f(o(u(Ue,ne),z[1]),f(o(u(Ve,ee),-O[1]),o(u(re,Q),D[1]))),I[2]),o(f(o(u(xe,j),z[1]),f(o(u(pe,V),-O[1]),o(u(re,Q),I[1]))),-D[2]))),R[3]))),f(f(o(f(f(o(f(o(u(Ie,Te),O[1]),f(o(u(Ue,ne),-I[1]),o(u(xe,j),D[1]))),R[2]),o(f(o(u(Ie,Te),R[1]),f(o(u(Qe,q),-I[1]),o(u(ge,oe),D[1]))),-O[2])),f(o(f(o(u(Ue,ne),R[1]),f(o(u(Qe,q),-O[1]),o(u(W,X),D[1]))),I[2]),o(f(o(u(xe,j),R[1]),f(o(u(ge,oe),-O[1]),o(u(W,X),I[1]))),-D[2]))),-z[3]),o(f(f(o(f(o(u(Ie,Te),z[1]),f(o(u(Ve,ee),-I[1]),o(u(pe,V),D[1]))),R[2]),o(f(o(u(Ie,Te),R[1]),f(o(u(Qe,q),-I[1]),o(u(ge,oe),D[1]))),-z[2])),f(o(f(o(u(Ve,ee),R[1]),f(o(u(Qe,q),-z[1]),o(u(G,U),D[1]))),I[2]),o(f(o(u(pe,V),R[1]),f(o(u(ge,oe),-z[1]),o(u(G,U),I[1]))),-D[2]))),O[3])),f(o(f(f(o(f(o(u(Ue,ne),z[1]),f(o(u(Ve,ee),-O[1]),o(u(re,Q),D[1]))),R[2]),o(f(o(u(Ue,ne),R[1]),f(o(u(Qe,q),-O[1]),o(u(W,X),D[1]))),-z[2])),f(o(f(o(u(Ve,ee),R[1]),f(o(u(Qe,q),-z[1]),o(u(G,U),D[1]))),O[2]),o(f(o(u(re,Q),R[1]),f(o(u(W,X),-z[1]),o(u(G,U),O[1]))),-D[2]))),-I[3]),o(f(f(o(f(o(u(xe,j),z[1]),f(o(u(pe,V),-O[1]),o(u(re,Q),I[1]))),R[2]),o(f(o(u(xe,j),R[1]),f(o(u(ge,oe),-O[1]),o(u(W,X),I[1]))),-z[2])),f(o(f(o(u(pe,V),R[1]),f(o(u(ge,oe),-z[1]),o(u(G,U),I[1]))),O[2]),o(f(o(u(re,Q),R[1]),f(o(u(W,X),-z[1]),o(u(G,U),O[1]))),-I[2]))),D[3]))))),Rt=f(f(f(o(f(f(o(f(o(u(at,ke),I[1]),f(o(u(Ie,Te),-F[1]),o(u(ye,Ee),D[1]))),O[2]),o(f(o(u(at,ke),O[1]),f(o(u(Ue,ne),-F[1]),o(u(De,Z),D[1]))),-I[2])),f(o(f(o(u(Ie,Te),O[1]),f(o(u(Ue,ne),-I[1]),o(u(xe,j),D[1]))),F[2]),o(f(o(u(ye,Ee),O[1]),f(o(u(De,Z),-I[1]),o(u(xe,j),F[1]))),-D[2]))),R[3]),f(o(f(f(o(f(o(u(at,ke),I[1]),f(o(u(Ie,Te),-F[1]),o(u(ye,Ee),D[1]))),R[2]),o(f(o(u(at,ke),R[1]),f(o(u(Qe,q),-F[1]),o(u(be,se),D[1]))),-I[2])),f(o(f(o(u(Ie,Te),R[1]),f(o(u(Qe,q),-I[1]),o(u(ge,oe),D[1]))),F[2]),o(f(o(u(ye,Ee),R[1]),f(o(u(be,se),-I[1]),o(u(ge,oe),F[1]))),-D[2]))),-O[3]),o(f(f(o(f(o(u(at,ke),O[1]),f(o(u(Ue,ne),-F[1]),o(u(De,Z),D[1]))),R[2]),o(f(o(u(at,ke),R[1]),f(o(u(Qe,q),-F[1]),o(u(be,se),D[1]))),-O[2])),f(o(f(o(u(Ue,ne),R[1]),f(o(u(Qe,q),-O[1]),o(u(W,X),D[1]))),F[2]),o(f(o(u(De,Z),R[1]),f(o(u(be,se),-O[1]),o(u(W,X),F[1]))),-D[2]))),I[3]))),f(f(o(f(f(o(f(o(u(Ie,Te),O[1]),f(o(u(Ue,ne),-I[1]),o(u(xe,j),D[1]))),R[2]),o(f(o(u(Ie,Te),R[1]),f(o(u(Qe,q),-I[1]),o(u(ge,oe),D[1]))),-O[2])),f(o(f(o(u(Ue,ne),R[1]),f(o(u(Qe,q),-O[1]),o(u(W,X),D[1]))),I[2]),o(f(o(u(xe,j),R[1]),f(o(u(ge,oe),-O[1]),o(u(W,X),I[1]))),-D[2]))),-F[3]),o(f(f(o(f(o(u(ye,Ee),O[1]),f(o(u(De,Z),-I[1]),o(u(xe,j),F[1]))),R[2]),o(f(o(u(ye,Ee),R[1]),f(o(u(be,se),-I[1]),o(u(ge,oe),F[1]))),-O[2])),f(o(f(o(u(De,Z),R[1]),f(o(u(be,se),-O[1]),o(u(W,X),F[1]))),I[2]),o(f(o(u(xe,j),R[1]),f(o(u(ge,oe),-O[1]),o(u(W,X),I[1]))),-F[2]))),D[3])),f(o(f(f(o(f(o(u(at,ke),O[1]),f(o(u(Ue,ne),-F[1]),o(u(De,Z),D[1]))),z[2]),o(f(o(u(at,ke),z[1]),f(o(u(Ve,ee),-F[1]),o(u(Le,H),D[1]))),-O[2])),f(o(f(o(u(Ue,ne),z[1]),f(o(u(Ve,ee),-O[1]),o(u(re,Q),D[1]))),F[2]),o(f(o(u(De,Z),z[1]),f(o(u(Le,H),-O[1]),o(u(re,Q),F[1]))),-D[2]))),R[3]),o(f(f(o(f(o(u(at,ke),O[1]),f(o(u(Ue,ne),-F[1]),o(u(De,Z),D[1]))),R[2]),o(f(o(u(at,ke),R[1]),f(o(u(Qe,q),-F[1]),o(u(be,se),D[1]))),-O[2])),f(o(f(o(u(Ue,ne),R[1]),f(o(u(Qe,q),-O[1]),o(u(W,X),D[1]))),F[2]),o(f(o(u(De,Z),R[1]),f(o(u(be,se),-O[1]),o(u(W,X),F[1]))),-D[2]))),-z[3])))),f(f(f(o(f(f(o(f(o(u(at,ke),z[1]),f(o(u(Ve,ee),-F[1]),o(u(Le,H),D[1]))),R[2]),o(f(o(u(at,ke),R[1]),f(o(u(Qe,q),-F[1]),o(u(be,se),D[1]))),-z[2])),f(o(f(o(u(Ve,ee),R[1]),f(o(u(Qe,q),-z[1]),o(u(G,U),D[1]))),F[2]),o(f(o(u(Le,H),R[1]),f(o(u(be,se),-z[1]),o(u(G,U),F[1]))),-D[2]))),O[3]),o(f(f(o(f(o(u(Ue,ne),z[1]),f(o(u(Ve,ee),-O[1]),o(u(re,Q),D[1]))),R[2]),o(f(o(u(Ue,ne),R[1]),f(o(u(Qe,q),-O[1]),o(u(W,X),D[1]))),-z[2])),f(o(f(o(u(Ve,ee),R[1]),f(o(u(Qe,q),-z[1]),o(u(G,U),D[1]))),O[2]),o(f(o(u(re,Q),R[1]),f(o(u(W,X),-z[1]),o(u(G,U),O[1]))),-D[2]))),-F[3])),f(o(f(f(o(f(o(u(De,Z),z[1]),f(o(u(Le,H),-O[1]),o(u(re,Q),F[1]))),R[2]),o(f(o(u(De,Z),R[1]),f(o(u(be,se),-O[1]),o(u(W,X),F[1]))),-z[2])),f(o(f(o(u(Le,H),R[1]),f(o(u(be,se),-z[1]),o(u(G,U),F[1]))),O[2]),o(f(o(u(re,Q),R[1]),f(o(u(W,X),-z[1]),o(u(G,U),O[1]))),-F[2]))),D[3]),o(f(f(o(f(o(u(ye,Ee),O[1]),f(o(u(De,Z),-I[1]),o(u(xe,j),F[1]))),z[2]),o(f(o(u(ye,Ee),z[1]),f(o(u(Le,H),-I[1]),o(u(pe,V),F[1]))),-O[2])),f(o(f(o(u(De,Z),z[1]),f(o(u(Le,H),-O[1]),o(u(re,Q),F[1]))),I[2]),o(f(o(u(xe,j),z[1]),f(o(u(pe,V),-O[1]),o(u(re,Q),I[1]))),-F[2]))),R[3]))),f(f(o(f(f(o(f(o(u(ye,Ee),O[1]),f(o(u(De,Z),-I[1]),o(u(xe,j),F[1]))),R[2]),o(f(o(u(ye,Ee),R[1]),f(o(u(be,se),-I[1]),o(u(ge,oe),F[1]))),-O[2])),f(o(f(o(u(De,Z),R[1]),f(o(u(be,se),-O[1]),o(u(W,X),F[1]))),I[2]),o(f(o(u(xe,j),R[1]),f(o(u(ge,oe),-O[1]),o(u(W,X),I[1]))),-F[2]))),-z[3]),o(f(f(o(f(o(u(ye,Ee),z[1]),f(o(u(Le,H),-I[1]),o(u(pe,V),F[1]))),R[2]),o(f(o(u(ye,Ee),R[1]),f(o(u(be,se),-I[1]),o(u(ge,oe),F[1]))),-z[2])),f(o(f(o(u(Le,H),R[1]),f(o(u(be,se),-z[1]),o(u(G,U),F[1]))),I[2]),o(f(o(u(pe,V),R[1]),f(o(u(ge,oe),-z[1]),o(u(G,U),I[1]))),-F[2]))),O[3])),f(o(f(f(o(f(o(u(De,Z),z[1]),f(o(u(Le,H),-O[1]),o(u(re,Q),F[1]))),R[2]),o(f(o(u(De,Z),R[1]),f(o(u(be,se),-O[1]),o(u(W,X),F[1]))),-z[2])),f(o(f(o(u(Le,H),R[1]),f(o(u(be,se),-z[1]),o(u(G,U),F[1]))),O[2]),o(f(o(u(re,Q),R[1]),f(o(u(W,X),-z[1]),o(u(G,U),O[1]))),-F[2]))),-I[3]),o(f(f(o(f(o(u(xe,j),z[1]),f(o(u(pe,V),-O[1]),o(u(re,Q),I[1]))),R[2]),o(f(o(u(xe,j),R[1]),f(o(u(ge,oe),-O[1]),o(u(W,X),I[1]))),-z[2])),f(o(f(o(u(pe,V),R[1]),f(o(u(ge,oe),-z[1]),o(u(G,U),I[1]))),O[2]),o(f(o(u(re,Q),R[1]),f(o(u(W,X),-z[1]),o(u(G,U),O[1]))),-I[2]))),F[3]))))),Mt=u(pt,Rt);return Mt[Mt.length-1]}return S}var y=[s,m,x];function T(f){var u=y[f.length];return u||(u=y[f.length]=d(f.length)),u.apply(void 0,f)}function w(f,u,h,o,S,R,z,O){function I(F,D,B,U,X,oe){switch(arguments.length){case 0:case 1:return 0;case 2:return o(F,D);case 3:return S(F,D,B);case 4:return R(F,D,B,U);case 5:return z(F,D,B,U,X);case 6:return O(F,D,B,U,X,oe)}for(var se=new Array(arguments.length),q=0;q<arguments.length;++q)se[q]=arguments[q];return f(se)}return I}function A(){for(;y.length<=r;)y.push(d(y.length));p.exports=w.apply(void 0,[T].concat(y));for(var f=0;f<=r;++f)p.exports[f]=y[f]}A()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(e,p,g){"use strict";var a=e("robust-determinant"),t=6;function i(y){var T=y===2?d:y===3?s:y===4?m:y===5?x:M;return y<6?T(a[y]):T(a)}function n(){return[[0]]}function r(y,T){return[[T[0]],[y[0][0]]]}function d(y){return function(w,A){return[y([[+A[0],+w[0][1]],[+A[1],+w[1][1]]]),y([[+w[0][0],+A[0]],[+w[1][0],+A[1]]]),y(w)]}}function s(y){return function(w,A){return[y([[+A[0],+w[0][1],+w[0][2]],[+A[1],+w[1][1],+w[1][2]],[+A[2],+w[2][1],+w[2][2]]]),y([[+w[0][0],+A[0],+w[0][2]],[+w[1][0],+A[1],+w[1][2]],[+w[2][0],+A[2],+w[2][2]]]),y([[+w[0][0],+w[0][1],+A[0]],[+w[1][0],+w[1][1],+A[1]],[+w[2][0],+w[2][1],+A[2]]]),y(w)]}}function m(y){return function(w,A){return[y([[+A[0],+w[0][1],+w[0][2],+w[0][3]],[+A[1],+w[1][1],+w[1][2],+w[1][3]],[+A[2],+w[2][1],+w[2][2],+w[2][3]],[+A[3],+w[3][1],+w[3][2],+w[3][3]]]),y([[+w[0][0],+A[0],+w[0][2],+w[0][3]],[+w[1][0],+A[1],+w[1][2],+w[1][3]],[+w[2][0],+A[2],+w[2][2],+w[2][3]],[+w[3][0],+A[3],+w[3][2],+w[3][3]]]),y([[+w[0][0],+w[0][1],+A[0],+w[0][3]],[+w[1][0],+w[1][1],+A[1],+w[1][3]],[+w[2][0],+w[2][1],+A[2],+w[2][3]],[+w[3][0],+w[3][1],+A[3],+w[3][3]]]),y([[+w[0][0],+w[0][1],+w[0][2],+A[0]],[+w[1][0],+w[1][1],+w[1][2],+A[1]],[+w[2][0],+w[2][1],+w[2][2],+A[2]],[+w[3][0],+w[3][1],+w[3][2],+A[3]]]),y(w)]}}function x(y){return function(w,A){return[y([[+A[0],+w[0][1],+w[0][2],+w[0][3],+w[0][4]],[+A[1],+w[1][1],+w[1][2],+w[1][3],+w[1][4]],[+A[2],+w[2][1],+w[2][2],+w[2][3],+w[2][4]],[+A[3],+w[3][1],+w[3][2],+w[3][3],+w[3][4]],[+A[4],+w[4][1],+w[4][2],+w[4][3],+w[4][4]]]),y([[+w[0][0],+A[0],+w[0][2],+w[0][3],+w[0][4]],[+w[1][0],+A[1],+w[1][2],+w[1][3],+w[1][4]],[+w[2][0],+A[2],+w[2][2],+w[2][3],+w[2][4]],[+w[3][0],+A[3],+w[3][2],+w[3][3],+w[3][4]],[+w[4][0],+A[4],+w[4][2],+w[4][3],+w[4][4]]]),y([[+w[0][0],+w[0][1],+A[0],+w[0][3],+w[0][4]],[+w[1][0],+w[1][1],+A[1],+w[1][3],+w[1][4]],[+w[2][0],+w[2][1],+A[2],+w[2][3],+w[2][4]],[+w[3][0],+w[3][1],+A[3],+w[3][3],+w[3][4]],[+w[4][0],+w[4][1],+A[4],+w[4][3],+w[4][4]]]),y([[+w[0][0],+w[0][1],+w[0][2],+A[0],+w[0][4]],[+w[1][0],+w[1][1],+w[1][2],+A[1],+w[1][4]],[+w[2][0],+w[2][1],+w[2][2],+A[2],+w[2][4]],[+w[3][0],+w[3][1],+w[3][2],+A[3],+w[3][4]],[+w[4][0],+w[4][1],+w[4][2],+A[4],+w[4][4]]]),y([[+w[0][0],+w[0][1],+w[0][2],+w[0][3],+A[0]],[+w[1][0],+w[1][1],+w[1][2],+w[1][3],+A[1]],[+w[2][0],+w[2][1],+w[2][2],+w[2][3],+A[2]],[+w[3][0],+w[3][1],+w[3][2],+w[3][3],+A[3]],[+w[4][0],+w[4][1],+w[4][2],+w[4][3],+A[4]]]),y(w)]}}function M(y){return function(w,A){return[y([[+A[0],+w[0][1],+w[0][2],+w[0][3],+w[0][4],+w[0][5]],[+A[1],+w[1][1],+w[1][2],+w[1][3],+w[1][4],+w[1][5]],[+A[2],+w[2][1],+w[2][2],+w[2][3],+w[2][4],+w[2][5]],[+A[3],+w[3][1],+w[3][2],+w[3][3],+w[3][4],+w[3][5]],[+A[4],+w[4][1],+w[4][2],+w[4][3],+w[4][4],+w[4][5]],[+A[5],+w[5][1],+w[5][2],+w[5][3],+w[5][4],+w[5][5]]]),y([[+w[0][0],+A[0],+w[0][2],+w[0][3],+w[0][4],+w[0][5]],[+w[1][0],+A[1],+w[1][2],+w[1][3],+w[1][4],+w[1][5]],[+w[2][0],+A[2],+w[2][2],+w[2][3],+w[2][4],+w[2][5]],[+w[3][0],+A[3],+w[3][2],+w[3][3],+w[3][4],+w[3][5]],[+w[4][0],+A[4],+w[4][2],+w[4][3],+w[4][4],+w[4][5]],[+w[5][0],+A[5],+w[5][2],+w[5][3],+w[5][4],+w[5][5]]]),y([[+w[0][0],+w[0][1],+A[0],+w[0][3],+w[0][4],+w[0][5]],[+w[1][0],+w[1][1],+A[1],+w[1][3],+w[1][4],+w[1][5]],[+w[2][0],+w[2][1],+A[2],+w[2][3],+w[2][4],+w[2][5]],[+w[3][0],+w[3][1],+A[3],+w[3][3],+w[3][4],+w[3][5]],[+w[4][0],+w[4][1],+A[4],+w[4][3],+w[4][4],+w[4][5]],[+w[5][0],+w[5][1],+A[5],+w[5][3],+w[5][4],+w[5][5]]]),y([[+w[0][0],+w[0][1],+w[0][2],+A[0],+w[0][4],+w[0][5]],[+w[1][0],+w[1][1],+w[1][2],+A[1],+w[1][4],+w[1][5]],[+w[2][0],+w[2][1],+w[2][2],+A[2],+w[2][4],+w[2][5]],[+w[3][0],+w[3][1],+w[3][2],+A[3],+w[3][4],+w[3][5]],[+w[4][0],+w[4][1],+w[4][2],+A[4],+w[4][4],+w[4][5]],[+w[5][0],+w[5][1],+w[5][2],+A[5],+w[5][4],+w[5][5]]]),y([[+w[0][0],+w[0][1],+w[0][2],+w[0][3],+A[0],+w[0][5]],[+w[1][0],+w[1][1],+w[1][2],+w[1][3],+A[1],+w[1][5]],[+w[2][0],+w[2][1],+w[2][2],+w[2][3],+A[2],+w[2][5]],[+w[3][0],+w[3][1],+w[3][2],+w[3][3],+A[3],+w[3][5]],[+w[4][0],+w[4][1],+w[4][2],+w[4][3],+A[4],+w[4][5]],[+w[5][0],+w[5][1],+w[5][2],+w[5][3],+A[5],+w[5][5]]]),y([[+w[0][0],+w[0][1],+w[0][2],+w[0][3],+w[0][4],+A[0]],[+w[1][0],+w[1][1],+w[1][2],+w[1][3],+w[1][4],+A[1]],[+w[2][0],+w[2][1],+w[2][2],+w[2][3],+w[2][4],+A[2]],[+w[3][0],+w[3][1],+w[3][2],+w[3][3],+w[3][4],+A[3]],[+w[4][0],+w[4][1],+w[4][2],+w[4][3],+w[4][4],+A[4]],[+w[5][0],+w[5][1],+w[5][2],+w[5][3],+w[5][4],+A[5]]]),y(w)]}}var v=[n,r];function _(y,T,w,A,f,u,h,o){return function(R,z){switch(R.length){case 0:return y(R,z);case 1:return T(R,z);case 2:return w(R,z);case 3:return A(R,z);case 4:return f(R,z);case 5:return u(R,z)}var O=h[R.length];return O||(O=h[R.length]=o(R.length)),O(R,z)}}function l(){for(;v.length<t;)v.push(i(v.length));p.exports=_.apply(void 0,v.concat([v,i]));for(var y=0;y<t;++y)p.exports[y]=v[y]}l()},{"robust-determinant":280}],284:[function(e,p,g){"use strict";var a=e("two-product"),t=e("robust-sum"),i=e("robust-scale"),n=e("robust-subtract"),r=5,d=11102230246251565e-32,s=(3+16*d)*d,m=(7+56*d)*d;function x(u,h,o,S){return function(z,O,I){var F=u(u(h(O[1],I[0]),h(-I[1],O[0])),u(h(z[1],O[0]),h(-O[1],z[0]))),D=u(h(z[1],I[0]),h(-I[1],z[0])),B=S(F,D);return B[B.length-1]}}function M(u,h,o,S){return function(z,O,I,F){var D=u(u(o(u(h(I[1],F[0]),h(-F[1],I[0])),O[2]),u(o(u(h(O[1],F[0]),h(-F[1],O[0])),-I[2]),o(u(h(O[1],I[0]),h(-I[1],O[0])),F[2]))),u(o(u(h(O[1],F[0]),h(-F[1],O[0])),z[2]),u(o(u(h(z[1],F[0]),h(-F[1],z[0])),-O[2]),o(u(h(z[1],O[0]),h(-O[1],z[0])),F[2])))),B=u(u(o(u(h(I[1],F[0]),h(-F[1],I[0])),z[2]),u(o(u(h(z[1],F[0]),h(-F[1],z[0])),-I[2]),o(u(h(z[1],I[0]),h(-I[1],z[0])),F[2]))),u(o(u(h(O[1],I[0]),h(-I[1],O[0])),z[2]),u(o(u(h(z[1],I[0]),h(-I[1],z[0])),-O[2]),o(u(h(z[1],O[0]),h(-O[1],z[0])),I[2])))),U=S(D,B);return U[U.length-1]}}function v(u,h,o,S){return function(z,O,I,F,D){var B=u(u(u(o(u(o(u(h(F[1],D[0]),h(-D[1],F[0])),I[2]),u(o(u(h(I[1],D[0]),h(-D[1],I[0])),-F[2]),o(u(h(I[1],F[0]),h(-F[1],I[0])),D[2]))),O[3]),u(o(u(o(u(h(F[1],D[0]),h(-D[1],F[0])),O[2]),u(o(u(h(O[1],D[0]),h(-D[1],O[0])),-F[2]),o(u(h(O[1],F[0]),h(-F[1],O[0])),D[2]))),-I[3]),o(u(o(u(h(I[1],D[0]),h(-D[1],I[0])),O[2]),u(o(u(h(O[1],D[0]),h(-D[1],O[0])),-I[2]),o(u(h(O[1],I[0]),h(-I[1],O[0])),D[2]))),F[3]))),u(o(u(o(u(h(I[1],F[0]),h(-F[1],I[0])),O[2]),u(o(u(h(O[1],F[0]),h(-F[1],O[0])),-I[2]),o(u(h(O[1],I[0]),h(-I[1],O[0])),F[2]))),-D[3]),u(o(u(o(u(h(F[1],D[0]),h(-D[1],F[0])),O[2]),u(o(u(h(O[1],D[0]),h(-D[1],O[0])),-F[2]),o(u(h(O[1],F[0]),h(-F[1],O[0])),D[2]))),z[3]),o(u(o(u(h(F[1],D[0]),h(-D[1],F[0])),z[2]),u(o(u(h(z[1],D[0]),h(-D[1],z[0])),-F[2]),o(u(h(z[1],F[0]),h(-F[1],z[0])),D[2]))),-O[3])))),u(u(o(u(o(u(h(O[1],D[0]),h(-D[1],O[0])),z[2]),u(o(u(h(z[1],D[0]),h(-D[1],z[0])),-O[2]),o(u(h(z[1],O[0]),h(-O[1],z[0])),D[2]))),F[3]),u(o(u(o(u(h(O[1],F[0]),h(-F[1],O[0])),z[2]),u(o(u(h(z[1],F[0]),h(-F[1],z[0])),-O[2]),o(u(h(z[1],O[0]),h(-O[1],z[0])),F[2]))),-D[3]),o(u(o(u(h(I[1],F[0]),h(-F[1],I[0])),O[2]),u(o(u(h(O[1],F[0]),h(-F[1],O[0])),-I[2]),o(u(h(O[1],I[0]),h(-I[1],O[0])),F[2]))),z[3]))),u(o(u(o(u(h(I[1],F[0]),h(-F[1],I[0])),z[2]),u(o(u(h(z[1],F[0]),h(-F[1],z[0])),-I[2]),o(u(h(z[1],I[0]),h(-I[1],z[0])),F[2]))),-O[3]),u(o(u(o(u(h(O[1],F[0]),h(-F[1],O[0])),z[2]),u(o(u(h(z[1],F[0]),h(-F[1],z[0])),-O[2]),o(u(h(z[1],O[0]),h(-O[1],z[0])),F[2]))),I[3]),o(u(o(u(h(O[1],I[0]),h(-I[1],O[0])),z[2]),u(o(u(h(z[1],I[0]),h(-I[1],z[0])),-O[2]),o(u(h(z[1],O[0]),h(-O[1],z[0])),I[2]))),-F[3]))))),U=u(u(u(o(u(o(u(h(F[1],D[0]),h(-D[1],F[0])),I[2]),u(o(u(h(I[1],D[0]),h(-D[1],I[0])),-F[2]),o(u(h(I[1],F[0]),h(-F[1],I[0])),D[2]))),z[3]),o(u(o(u(h(F[1],D[0]),h(-D[1],F[0])),z[2]),u(o(u(h(z[1],D[0]),h(-D[1],z[0])),-F[2]),o(u(h(z[1],F[0]),h(-F[1],z[0])),D[2]))),-I[3])),u(o(u(o(u(h(I[1],D[0]),h(-D[1],I[0])),z[2]),u(o(u(h(z[1],D[0]),h(-D[1],z[0])),-I[2]),o(u(h(z[1],I[0]),h(-I[1],z[0])),D[2]))),F[3]),o(u(o(u(h(I[1],F[0]),h(-F[1],I[0])),z[2]),u(o(u(h(z[1],F[0]),h(-F[1],z[0])),-I[2]),o(u(h(z[1],I[0]),h(-I[1],z[0])),F[2]))),-D[3]))),u(u(o(u(o(u(h(I[1],D[0]),h(-D[1],I[0])),O[2]),u(o(u(h(O[1],D[0]),h(-D[1],O[0])),-I[2]),o(u(h(O[1],I[0]),h(-I[1],O[0])),D[2]))),z[3]),o(u(o(u(h(I[1],D[0]),h(-D[1],I[0])),z[2]),u(o(u(h(z[1],D[0]),h(-D[1],z[0])),-I[2]),o(u(h(z[1],I[0]),h(-I[1],z[0])),D[2]))),-O[3])),u(o(u(o(u(h(O[1],D[0]),h(-D[1],O[0])),z[2]),u(o(u(h(z[1],D[0]),h(-D[1],z[0])),-O[2]),o(u(h(z[1],O[0]),h(-O[1],z[0])),D[2]))),I[3]),o(u(o(u(h(O[1],I[0]),h(-I[1],O[0])),z[2]),u(o(u(h(z[1],I[0]),h(-I[1],z[0])),-O[2]),o(u(h(z[1],O[0]),h(-O[1],z[0])),I[2]))),-D[3])))),X=S(B,U);return X[X.length-1]}}function _(u){var h=u===3?x:u===4?M:v;return h(t,a,i,n)}var l=_(3),y=_(4),T=[function(){return 0},function(){return 0},function(h,o){return o[0]-h[0]},function(h,o,S){var R=(h[1]-S[1])*(o[0]-S[0]),z=(h[0]-S[0])*(o[1]-S[1]),O=R-z,I;if(R>0){if(z<=0)return O;I=R+z}else if(R<0){if(z>=0)return O;I=-(R+z)}else return O;var F=s*I;return O>=F||O<=-F?O:l(h,o,S)},function(h,o,S,R){var z=h[0]-R[0],O=o[0]-R[0],I=S[0]-R[0],F=h[1]-R[1],D=o[1]-R[1],B=S[1]-R[1],U=h[2]-R[2],X=o[2]-R[2],oe=S[2]-R[2],se=O*B,q=I*D,K=I*F,G=z*B,Q=z*D,V=O*F,H=U*(se-q)+X*(K-G)+oe*(Q-V),ee=(Math.abs(se)+Math.abs(q))*Math.abs(U)+(Math.abs(K)+Math.abs(G))*Math.abs(X)+(Math.abs(Q)+Math.abs(V))*Math.abs(oe),J=m*ee;return H>J||-H>J?H:y(h,o,S,R)}];function w(u){var h=T[u.length];return h||(h=T[u.length]=_(u.length)),h.apply(void 0,u)}function A(u,h,o,S,R,z,O){return function(F,D,B,U,X){switch(arguments.length){case 0:case 1:return 0;case 2:return S(F,D);case 3:return R(F,D,B);case 4:return z(F,D,B,U);case 5:return O(F,D,B,U,X)}for(var oe=new Array(arguments.length),se=0;se<arguments.length;++se)oe[se]=arguments[se];return u(oe)}}function f(){for(;T.length<=r;)T.push(_(T.length));p.exports=A.apply(void 0,[w].concat(T));for(var u=0;u<=r;++u)p.exports[u]=T[u]}f()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(e,p,g){"use strict";var a=e("robust-sum"),t=e("robust-scale");p.exports=i;function i(n,r){if(n.length===1)return t(r,n[0]);if(r.length===1)return t(n,r[0]);if(n.length===0||r.length===0)return[0];var d=[0];if(n.length<r.length)for(var s=0;s<n.length;++s)d=a(d,t(r,n[s]));else for(var s=0;s<r.length;++s)d=a(d,t(n,r[s]));return d}},{"robust-scale":286,"robust-sum":289}],286:[function(e,p,g){"use strict";var a=e("two-product"),t=e("two-sum");p.exports=i;function i(n,r){var d=n.length;if(d===1){var s=a(n[0],r);return s[0]?s:[s[1]]}var m=new Array(2*d),x=[.1,.1],M=[.1,.1],v=0;a(n[0],r,x),x[0]&&(m[v++]=x[0]);for(var _=1;_<d;++_){a(n[_],r,M);var l=x[1];t(l,M[0],x),x[0]&&(m[v++]=x[0]);var y=M[1],T=x[1],w=y+T,A=w-y,f=T-A;x[1]=w,f&&(m[v++]=f)}return x[1]&&(m[v++]=x[1]),v===0&&(m[v++]=0),m.length=v,m}},{"two-product":306,"two-sum":307}],287:[function(e,p,g){"use strict";p.exports=i;var a=e("robust-orientation")[3];function t(n,r,d,s){for(var m=0;m<2;++m){var x=n[m],M=r[m],v=Math.min(x,M),_=Math.max(x,M),l=d[m],y=s[m],T=Math.min(l,y),w=Math.max(l,y);if(w<v||_<T)return!1}return!0}function i(n,r,d,s){var m=a(n,d,s),x=a(r,d,s);if(m>0&&x>0||m<0&&x<0)return!1;var M=a(d,n,r),v=a(s,n,r);return M>0&&v>0||M<0&&v<0?!1:m===0&&x===0&&M===0&&v===0?t(n,r,d,s):!0}},{"robust-orientation":284}],288:[function(e,p,g){"use strict";p.exports=t;function a(i,n){var r=i+n,d=r-i,s=r-d,m=n-d,x=i-s,M=x+m;return M?[M,r]:[r]}function t(i,n){var r=i.length|0,d=n.length|0;if(r===1&&d===1)return a(i[0],-n[0]);var s=r+d,m=new Array(s),x=0,M=0,v=0,_=Math.abs,l=i[M],y=_(l),T=-n[v],w=_(T),A,f;y<w?(f=l,M+=1,M<r&&(l=i[M],y=_(l))):(f=T,v+=1,v<d&&(T=-n[v],w=_(T))),M<r&&y<w||v>=d?(A=l,M+=1,M<r&&(l=i[M],y=_(l))):(A=T,v+=1,v<d&&(T=-n[v],w=_(T)));for(var u=A+f,h=u-A,o=f-h,S=o,R=u,z,O,I,F,D;M<r&&v<d;)y<w?(A=l,M+=1,M<r&&(l=i[M],y=_(l))):(A=T,v+=1,v<d&&(T=-n[v],w=_(T))),f=S,u=A+f,h=u-A,o=f-h,o&&(m[x++]=o),z=R+u,O=z-R,I=z-O,F=u-O,D=R-I,S=D+F,R=z;for(;M<r;)A=l,f=S,u=A+f,h=u-A,o=f-h,o&&(m[x++]=o),z=R+u,O=z-R,I=z-O,F=u-O,D=R-I,S=D+F,R=z,M+=1,M<r&&(l=i[M]);for(;v<d;)A=T,f=S,u=A+f,h=u-A,o=f-h,o&&(m[x++]=o),z=R+u,O=z-R,I=z-O,F=u-O,D=R-I,S=D+F,R=z,v+=1,v<d&&(T=-n[v]);return S&&(m[x++]=S),R&&(m[x++]=R),x||(m[x++]=0),m.length=x,m}},{}],289:[function(e,p,g){"use strict";p.exports=t;function a(i,n){var r=i+n,d=r-i,s=r-d,m=n-d,x=i-s,M=x+m;return M?[M,r]:[r]}function t(i,n){var r=i.length|0,d=n.length|0;if(r===1&&d===1)return a(i[0],n[0]);var s=r+d,m=new Array(s),x=0,M=0,v=0,_=Math.abs,l=i[M],y=_(l),T=n[v],w=_(T),A,f;y<w?(f=l,M+=1,M<r&&(l=i[M],y=_(l))):(f=T,v+=1,v<d&&(T=n[v],w=_(T))),M<r&&y<w||v>=d?(A=l,M+=1,M<r&&(l=i[M],y=_(l))):(A=T,v+=1,v<d&&(T=n[v],w=_(T)));for(var u=A+f,h=u-A,o=f-h,S=o,R=u,z,O,I,F,D;M<r&&v<d;)y<w?(A=l,M+=1,M<r&&(l=i[M],y=_(l))):(A=T,v+=1,v<d&&(T=n[v],w=_(T))),f=S,u=A+f,h=u-A,o=f-h,o&&(m[x++]=o),z=R+u,O=z-R,I=z-O,F=u-O,D=R-I,S=D+F,R=z;for(;M<r;)A=l,f=S,u=A+f,h=u-A,o=f-h,o&&(m[x++]=o),z=R+u,O=z-R,I=z-O,F=u-O,D=R-I,S=D+F,R=z,M+=1,M<r&&(l=i[M]);for(;v<d;)A=T,f=S,u=A+f,h=u-A,o=f-h,o&&(m[x++]=o),z=R+u,O=z-R,I=z-O,F=u-O,D=R-I,S=D+F,R=z,v+=1,v<d&&(T=n[v]);return S&&(m[x++]=S),R&&(m[x++]=R),x||(m[x++]=0),m.length=x,m}},{}],290:[function(e,p,g){"use strict";p.exports=i;var a=e("boundary-cells"),t=e("reduce-simplicial-complex");function i(n){return t(a(n))}},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(e,p,g){"use strict";p.exports=v;var a=e("ndarray"),t=e("typedarray-pool"),i=e("ndarray-sort"),n=e("./lib/codegen");function r(_){for(var l=_.length,y=0,T=0;T<l;++T)y=Math.max(y,_[T].length)|0;return y-1}function d(_,l){for(var y=_.length,T=t.mallocUint8(y),w=0;w<y;++w)T[w]=_[w]<l|0;return T}function s(_,l){for(var y=_.length,T=l*(l+1)/2*y|0,w=t.mallocUint32(T*2),A=0,f=0;f<y;++f)for(var u=_[f],l=u.length,h=0;h<l;++h)for(var o=0;o<h;++o){var S=u[o],R=u[h];w[A++]=Math.min(S,R)|0,w[A++]=Math.max(S,R)|0}var z=A/2|0;i(a(w,[z,2]));for(var O=2,f=2;f<A;f+=2)w[f-2]===w[f]&&w[f-1]===w[f+1]||(w[O++]=w[f],w[O++]=w[f+1]);return a(w,[O/2|0,2])}function m(_,l,y,T){for(var w=_.data,A=_.shape[0],f=t.mallocDouble(A),u=0,h=0;h<A;++h){var o=w[2*h],S=w[2*h+1];if(y[o]!==y[S]){var R=l[o],z=l[S];w[2*u]=o,w[2*u+1]=S,f[u++]=(z-T)/(z-R)}}return _.shape[0]=u,a(f,[u])}function x(_,l){var y=t.mallocInt32(l*2),T=_.shape[0],w=_.data;y[0]=0;for(var A=0,f=0;f<T;++f){var u=w[2*f];if(u!==A){for(y[2*A+1]=f;++A<u;)y[2*A]=f,y[2*A+1]=f;y[2*A]=f}}for(y[2*A+1]=T;++A<l;)y[2*A]=y[2*A+1]=T;return y}function M(_){for(var l=_.shape[0]|0,y=_.data,T=new Array(l),w=0;w<l;++w)T[w]=[y[2*w],y[2*w+1]];return T}function v(_,l,y,T){y=y||0,typeof T>"u"&&(T=r(_));var w=_.length;if(w===0||T<1)return{cells:[],vertexIds:[],vertexWeights:[]};var A=d(l,+y),f=s(_,T),u=m(f,l,A,+y),h=x(f,l.length|0),o=n(T)(_,f.data,h,A),S=M(f),R=[].slice.call(u.data,0,u.shape[0]);return t.free(A),t.free(f.data),t.free(u.data),t.free(h),{cells:o,vertexIds:S,vertexWeights:R}}},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(e,p,g){"use strict";p.exports=t;var a=[function(){function n(d,s,m,x){for(var M=Math.min(m,x)|0,v=Math.max(m,x)|0,_=d[2*M],l=d[2*M+1];_<l;){var y=_+l>>1,T=s[2*y+1];if(T===v)return y;v<T?l=y:_=y+1}return _}function r(d,s,m,x){for(var M=d.length,v=[],_=0;_<M;++_)var l=d[_],y=l.length;return v}return r},function(){function n(d,s,m,x){for(var M=Math.min(m,x)|0,v=Math.max(m,x)|0,_=d[2*M],l=d[2*M+1];_<l;){var y=_+l>>1,T=s[2*y+1];if(T===v)return y;v<T?l=y:_=y+1}return _}function r(d,s,m,x){for(var M=d.length,v=[],_=0;_<M;++_){var l=d[_],y=l.length;if(y===2){var T=(x[l[0]]<<0)+(x[l[1]]<<1);if(T===0||T===3)continue;switch(T){case 0:break;case 1:v.push([n(m,s,l[0],l[1])]);break;case 2:v.push([n(m,s,l[1],l[0])]);break;case 3:break}}}return v}return r},function(){function n(d,s,m,x){for(var M=Math.min(m,x)|0,v=Math.max(m,x)|0,_=d[2*M],l=d[2*M+1];_<l;){var y=_+l>>1,T=s[2*y+1];if(T===v)return y;v<T?l=y:_=y+1}return _}function r(d,s,m,x){for(var M=d.length,v=[],_=0;_<M;++_){var l=d[_],y=l.length;if(y===3){var T=(x[l[0]]<<0)+(x[l[1]]<<1)+(x[l[2]]<<2);if(T===0||T===7)continue;switch(T){case 0:break;case 1:v.push([n(m,s,l[0],l[2]),n(m,s,l[0],l[1])]);break;case 2:v.push([n(m,s,l[1],l[0]),n(m,s,l[1],l[2])]);break;case 3:v.push([n(m,s,l[0],l[2]),n(m,s,l[1],l[2])]);break;case 4:v.push([n(m,s,l[2],l[1]),n(m,s,l[2],l[0])]);break;case 5:v.push([n(m,s,l[2],l[1]),n(m,s,l[0],l[1])]);break;case 6:v.push([n(m,s,l[1],l[0]),n(m,s,l[2],l[0])]);break;case 7:break}}else if(y===2){var T=(x[l[0]]<<0)+(x[l[1]]<<1);if(T===0||T===3)continue;switch(T){case 0:break;case 1:v.push([n(m,s,l[0],l[1])]);break;case 2:v.push([n(m,s,l[1],l[0])]);break;case 3:break}}}return v}return r},function(){function n(d,s,m,x){for(var M=Math.min(m,x)|0,v=Math.max(m,x)|0,_=d[2*M],l=d[2*M+1];_<l;){var y=_+l>>1,T=s[2*y+1];if(T===v)return y;v<T?l=y:_=y+1}return _}function r(d,s,m,x){for(var M=d.length,v=[],_=0;_<M;++_){var l=d[_],y=l.length;if(y===4){var T=(x[l[0]]<<0)+(x[l[1]]<<1)+(x[l[2]]<<2)+(x[l[3]]<<3);if(T===0||T===15)continue;switch(T){case 0:break;case 1:v.push([n(m,s,l[0],l[1]),n(m,s,l[0],l[2]),n(m,s,l[0],l[3])]);break;case 2:v.push([n(m,s,l[1],l[2]),n(m,s,l[1],l[0]),n(m,s,l[1],l[3])]);break;case 3:v.push([n(m,s,l[1],l[2]),n(m,s,l[0],l[2]),n(m,s,l[0],l[3])],[n(m,s,l[1],l[3]),n(m,s,l[1],l[2]),n(m,s,l[0],l[3])]);break;case 4:v.push([n(m,s,l[2],l[0]),n(m,s,l[2],l[1]),n(m,s,l[2],l[3])]);break;case 5:v.push([n(m,s,l[0],l[1]),n(m,s,l[2],l[1]),n(m,s,l[0],l[3])],[n(m,s,l[2],l[1]),n(m,s,l[2],l[3]),n(m,s,l[0],l[3])]);break;case 6:v.push([n(m,s,l[2],l[0]),n(m,s,l[1],l[0]),n(m,s,l[1],l[3])],[n(m,s,l[2],l[3]),n(m,s,l[2],l[0]),n(m,s,l[1],l[3])]);break;case 7:v.push([n(m,s,l[0],l[3]),n(m,s,l[1],l[3]),n(m,s,l[2],l[3])]);break;case 8:v.push([n(m,s,l[3],l[1]),n(m,s,l[3],l[0]),n(m,s,l[3],l[2])]);break;case 9:v.push([n(m,s,l[3],l[1]),n(m,s,l[0],l[1]),n(m,s,l[0],l[2])],[n(m,s,l[3],l[2]),n(m,s,l[3],l[1]),n(m,s,l[0],l[2])]);break;case 10:v.push([n(m,s,l[1],l[0]),n(m,s,l[3],l[0]),n(m,s,l[1],l[2])],[n(m,s,l[3],l[0]),n(m,s,l[3],l[2]),n(m,s,l[1],l[2])]);break;case 11:v.push([n(m,s,l[1],l[2]),n(m,s,l[0],l[2]),n(m,s,l[3],l[2])]);break;case 12:v.push([n(m,s,l[3],l[0]),n(m,s,l[2],l[0]),n(m,s,l[2],l[1])],[n(m,s,l[3],l[1]),n(m,s,l[3],l[0]),n(m,s,l[2],l[1])]);break;case 13:v.push([n(m,s,l[0],l[1]),n(m,s,l[2],l[1]),n(m,s,l[3],l[1])]);break;case 14:v.push([n(m,s,l[2],l[0]),n(m,s,l[1],l[0]),n(m,s,l[3],l[0])]);break;case 15:break}}else if(y===3){var T=(x[l[0]]<<0)+(x[l[1]]<<1)+(x[l[2]]<<2);if(T===0||T===7)continue;switch(T){case 0:break;case 1:v.push([n(m,s,l[0],l[2]),n(m,s,l[0],l[1])]);break;case 2:v.push([n(m,s,l[1],l[0]),n(m,s,l[1],l[2])]);break;case 3:v.push([n(m,s,l[0],l[2]),n(m,s,l[1],l[2])]);break;case 4:v.push([n(m,s,l[2],l[1]),n(m,s,l[2],l[0])]);break;case 5:v.push([n(m,s,l[2],l[1]),n(m,s,l[0],l[1])]);break;case 6:v.push([n(m,s,l[1],l[0]),n(m,s,l[2],l[0])]);break;case 7:break}}else if(y===2){var T=(x[l[0]]<<0)+(x[l[1]]<<1);if(T===0||T===3)continue;switch(T){case 0:break;case 1:v.push([n(m,s,l[0],l[1])]);break;case 2:v.push([n(m,s,l[1],l[0])]);break;case 3:break}}}return v}return r}];function t(i){return a[i]()}},{}],293:[function(e,p,g){"use strict";var a=e("bit-twiddle"),t=e("union-find");function i(u){for(var h=0,o=Math.max,S=0,R=u.length;S<R;++S)h=o(h,u[S].length);return h-1}g.dimension=i;function n(u){for(var h=-1,o=Math.max,S=0,R=u.length;S<R;++S)for(var z=u[S],O=0,I=z.length;O<I;++O)h=o(h,z[O]);return h+1}g.countVertices=n;function r(u){for(var h=new Array(u.length),o=0,S=u.length;o<S;++o)h[o]=u[o].slice(0);return h}g.cloneCells=r;function d(u,h){var o=u.length,S=u.length-h.length,R=Math.min;if(S)return S;switch(o){case 0:return 0;case 1:return u[0]-h[0];case 2:var D=u[0]+u[1]-h[0]-h[1];return D||R(u[0],u[1])-R(h[0],h[1]);case 3:var z=u[0]+u[1],O=h[0]+h[1];if(D=z+u[2]-(O+h[2]),D)return D;var I=R(u[0],u[1]),F=R(h[0],h[1]),D=R(I,u[2])-R(F,h[2]);return D||R(I+u[2],z)-R(F+h[2],O);default:var B=u.slice(0);B.sort();var U=h.slice(0);U.sort();for(var X=0;X<o;++X)if(S=B[X]-U[X],S)return S;return 0}}g.compareCells=d;function s(u,h){return d(u[0],h[0])}function m(u,h){if(h){for(var o=u.length,S=new Array(o),R=0;R<o;++R)S[R]=[u[R],h[R]];S.sort(s);for(var R=0;R<o;++R)u[R]=S[R][0],h[R]=S[R][1];return u}else return u.sort(d),u}g.normalize=m;function x(u){if(u.length===0)return[];for(var h=1,o=u.length,S=1;S<o;++S){var R=u[S];if(d(R,u[S-1])){if(S===h){h++;continue}u[h++]=R}}return u.length=h,u}g.unique=x;function M(u,h){for(var o=0,S=u.length-1,R=-1;o<=S;){var z=o+S>>1,O=d(u[z],h);O<=0?(O===0&&(R=z),o=z+1):O>0&&(S=z-1)}return R}g.findCell=M;function v(u,h){for(var o=new Array(u.length),S=0,R=o.length;S<R;++S)o[S]=[];for(var z=[],S=0,O=h.length;S<O;++S)for(var I=h[S],F=I.length,D=1,B=1<<F;D<B;++D){z.length=a.popCount(D);for(var U=0,X=0;X<F;++X)D&1<<X&&(z[U++]=I[X]);var oe=M(u,z);if(!(oe<0))for(;o[oe++].push(S),!(oe>=u.length||d(u[oe],z)!==0););}return o}g.incidence=v;function _(u,h){if(!h)return v(x(y(u,0)),u,0);for(var o=new Array(h),S=0;S<h;++S)o[S]=[];for(var S=0,R=u.length;S<R;++S)for(var z=u[S],O=0,I=z.length;O<I;++O)o[z[O]].push(S);return o}g.dual=_;function l(u){for(var h=[],o=0,S=u.length;o<S;++o)for(var R=u[o],z=R.length|0,O=1,I=1<<z;O<I;++O){for(var F=[],D=0;D<z;++D)O>>>D&1&&F.push(R[D]);h.push(F)}return m(h)}g.explode=l;function y(u,h){if(h<0)return[];for(var o=[],S=(1<<h+1)-1,R=0;R<u.length;++R)for(var z=u[R],O=S;O<1<<z.length;O=a.nextCombination(O)){for(var I=new Array(h+1),F=0,D=0;D<z.length;++D)O&1<<D&&(I[F++]=z[D]);o.push(I)}return m(o)}g.skeleton=y;function T(u){for(var h=[],o=0,S=u.length;o<S;++o)for(var R=u[o],z=0,O=R.length;z<O;++z){for(var I=new Array(R.length-1),F=0,D=0;F<O;++F)F!==z&&(I[D++]=R[F]);h.push(I)}return m(h)}g.boundary=T;function w(u,h){for(var o=new t(h),S=0;S<u.length;++S)for(var R=u[S],z=0;z<R.length;++z)for(var O=z+1;O<R.length;++O)o.link(R[z],R[O]);for(var I=[],F=o.ranks,S=0;S<F.length;++S)F[S]=-1;for(var S=0;S<u.length;++S){var D=o.find(u[S][0]);F[D]<0?(F[D]=I.length,I.push([u[S].slice(0)])):I[F[D]].push(u[S].slice(0))}return I}function A(u){for(var h=x(m(y(u,0))),o=new t(h.length),S=0;S<u.length;++S)for(var R=u[S],z=0;z<R.length;++z)for(var O=M(h,[R[z]]),I=z+1;I<R.length;++I)o.link(O,M(h,[R[I]]));for(var F=[],D=o.ranks,S=0;S<D.length;++S)D[S]=-1;for(var S=0;S<u.length;++S){var B=o.find(M(h,[u[S][0]]));D[B]<0?(D[B]=F.length,F.push([u[S].slice(0)])):F[D[B]].push(u[S].slice(0))}return F}function f(u,h){return h?w(u,h):A(u)}g.connectedComponents=f},{"bit-twiddle":32,"union-find":309}],294:[function(e,p,g){arguments[4][32][0].apply(g,arguments)},{dup:32}],295:[function(e,p,g){arguments[4][293][0].apply(g,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(e,p,g){"use strict";p.exports=a;function a(t){this.roots=new Array(t),this.ranks=new Array(t);for(var i=0;i<t;++i)this.roots[i]=i,this.ranks[i]=0}a.prototype.length=function(){return this.roots.length},a.prototype.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},a.prototype.find=function(t){for(var i=this.roots;i[t]!==t;){var n=i[t];i[t]=i[n],t=n}return t},a.prototype.link=function(t,i){var n=this.find(t),r=this.find(i);if(n!==r){var d=this.ranks,s=this.roots,m=d[n],x=d[r];m<x?s[n]=r:x<m?s[r]=n:(s[r]=n,++d[n])}}},{}],297:[function(e,p,g){"use strict";p.exports=n;var a=e("robust-orientation"),t=e("simplicial-complex");function i(r,d,s){var m=Math.abs(a(r,d,s)),x=Math.sqrt(Math.pow(d[0]-s[0],2)+Math.pow(d[1]-s[1],2));return m/x}function n(r,d,s){for(var m=d.length,x=r.length,M=new Array(m),v=new Array(m),_=new Array(m),l=new Array(m),y=0;y<m;++y)M[y]=v[y]=-1,_[y]=1/0,l[y]=!1;for(var y=0;y<x;++y){var T=r[y];if(T.length!==2)throw new Error("Input must be a graph");var w=T[1],A=T[0];v[A]!==-1?v[A]=-2:v[A]=w,M[w]!==-1?M[w]=-2:M[w]=A}function f(G){if(l[G])return 1/0;var Q=M[G],V=v[G];return Q<0||V<0?1/0:i(d[G],d[Q],d[V])}function u(G,Q){var V=F[G],H=F[Q];F[G]=H,F[Q]=V,D[V]=Q,D[H]=G}function h(G){return _[F[G]]}function o(G){return G&1?G-1>>1:(G>>1)-1}function S(G){for(var Q=h(G);;){var V=Q,H=2*G+1,ee=2*(G+1),J=G;if(H<U){var W=h(H);W<V&&(J=H,V=W)}if(ee<U){var re=h(ee);re<V&&(J=ee)}if(J===G)return G;u(G,J),G=J}}function R(G){for(var Q=h(G);G>0;){var V=o(G);if(V>=0){var H=h(V);if(Q<H){u(G,V),G=V;continue}}return G}}function z(){if(U>0){var G=F[0];return u(0,U-1),U-=1,S(0),G}return-1}function O(G,Q){var V=F[G];return _[V]===Q?G:(_[V]=-1/0,R(G),z(),_[V]=Q,U+=1,R(U-1))}function I(G){if(!l[G]){l[G]=!0;var Q=M[G],V=v[G];M[V]>=0&&(M[V]=Q),v[Q]>=0&&(v[Q]=V),D[Q]>=0&&O(D[Q],f(Q)),D[V]>=0&&O(D[V],f(V))}}for(var F=[],D=new Array(m),y=0;y<m;++y){var B=_[y]=f(y);B<1/0?(D[y]=F.length,F.push(y)):D[y]=-1}for(var U=F.length,y=U>>1;y>=0;--y)S(y);for(;;){var X=z();if(X<0||_[X]>s)break;I(X)}for(var oe=[],y=0;y<m;++y)l[y]||(D[y]=oe.length,oe.push(d[y].slice()));var se=oe.length;function q(G,Q){if(G[Q]<0)return Q;var V=Q,H=Q;do{var ee=G[H];if(!l[H]||ee<0||ee===H||(H=ee,ee=G[H],!l[H]||ee<0||ee===H))break;H=ee,V=G[V]}while(V!==H);for(var J=Q;J!==H;J=G[J])G[J]=H;return H}var K=[];return r.forEach(function(G){var Q=q(M,G[0]),V=q(v,G[1]);if(Q>=0&&V>=0&&Q!==V){var H=D[Q],ee=D[V];H!==ee&&K.push([H,ee])}}),t.unique(t.normalize(K)),{positions:oe,edges:K}}},{"robust-orientation":284,"simplicial-complex":295}],298:[function(e,p,g){"use strict";p.exports=i;var a=e("robust-orientation");function t(n,r){var d,s;if(r[0][0]<r[1][0])d=r[0],s=r[1];else if(r[0][0]>r[1][0])d=r[1],s=r[0];else{var m=Math.min(n[0][1],n[1][1]),x=Math.max(n[0][1],n[1][1]),M=Math.min(r[0][1],r[1][1]),v=Math.max(r[0][1],r[1][1]);return x<M?x-M:m>v?m-v:x-v}var _,l;n[0][1]<n[1][1]?(_=n[0],l=n[1]):(_=n[1],l=n[0]);var y=a(s,d,_);return y||(y=a(s,d,l),y)?y:l-s}function i(n,r){var d,s;if(r[0][0]<r[1][0])d=r[0],s=r[1];else if(r[0][0]>r[1][0])d=r[1],s=r[0];else return t(r,n);var m,x;if(n[0][0]<n[1][0])m=n[0],x=n[1];else if(n[0][0]>n[1][0])m=n[1],x=n[0];else return-t(n,r);var M=a(d,s,x),v=a(d,s,m);if(M<0){if(v<=0)return M}else if(M>0){if(v>=0)return M}else if(v)return v;if(M=a(x,m,s),v=a(x,m,d),M<0){if(v<=0)return M}else if(M>0){if(v>=0)return M}else if(v)return v;return s[0]-x[0]}},{"robust-orientation":284}],299:[function(e,p,g){"use strict";p.exports=v;var a=e("binary-search-bounds"),t=e("functional-red-black-tree"),i=e("robust-orientation"),n=e("./lib/order-segments");function r(_,l,y){this.slabs=_,this.coordinates=l,this.horizontal=y}var d=r.prototype;function s(_,l){return _.y-l}function m(_,l){for(var y=null;_;){var T=_.key,w,A;T[0][0]<T[1][0]?(w=T[0],A=T[1]):(w=T[1],A=T[0]);var f=i(w,A,l);if(f<0)_=_.left;else if(f>0)if(l[0]!==T[1][0])y=_,_=_.right;else{var u=m(_.right,l);if(u)return u;_=_.left}else{if(l[0]!==T[1][0])return _;var u=m(_.right,l);if(u)return u;_=_.left}}return y}d.castUp=function(_){var l=a.le(this.coordinates,_[0]);if(l<0)return-1;var y=this.slabs[l],T=m(this.slabs[l],_),w=-1;if(T&&(w=T.value),this.coordinates[l]===_[0]){var A=null;if(T&&(A=T.key),l>0){var f=m(this.slabs[l-1],_);f&&(A?n(f.key,A)>0&&(A=f.key,w=f.value):(w=f.value,A=f.key))}var u=this.horizontal[l];if(u.length>0){var h=a.ge(u,_[1],s);if(h<u.length){var o=u[h];if(_[1]===o.y){if(o.closed)return o.index;for(;h<u.length-1&&u[h+1].y===_[1];)if(h=h+1,o=u[h],o.closed)return o.index;if(o.y===_[1]&&!o.start){if(h=h+1,h>=u.length)return w;o=u[h]}}if(o.start)if(A){var S=i(A[0],A[1],[_[0],o.y]);A[0][0]>A[1][0]&&(S=-S),S>0&&(w=o.index)}else w=o.index;else o.y!==_[1]&&(w=o.index)}}}return w};function x(_,l,y,T){this.y=_,this.index=l,this.start=y,this.closed=T}function M(_,l,y,T){this.x=_,this.segment=l,this.create=y,this.index=T}function v(_){for(var l=_.length,y=2*l,T=new Array(y),w=0;w<l;++w){var A=_[w],f=A[0][0]<A[1][0];T[2*w]=new M(A[0][0],A,f,w),T[2*w+1]=new M(A[1][0],A,!f,w)}T.sort(function(F,D){var B=F.x-D.x;return B||(B=F.create-D.create,B)?B:Math.min(F.segment[0][1],F.segment[1][1])-Math.min(D.segment[0][1],D.segment[1][1])});for(var u=t(n),h=[],o=[],S=[],R=-1/0,w=0;w<y;){for(var z=T[w].x,O=[];w<y;){var I=T[w];if(I.x!==z)break;w+=1,I.segment[0][0]===I.x&&I.segment[1][0]===I.x?I.create&&(I.segment[0][1]<I.segment[1][1]?(O.push(new x(I.segment[0][1],I.index,!0,!0)),O.push(new x(I.segment[1][1],I.index,!1,!1))):(O.push(new x(I.segment[1][1],I.index,!0,!1)),O.push(new x(I.segment[0][1],I.index,!1,!0)))):I.create?u=u.insert(I.segment,I.index):u=u.remove(I.segment)}h.push(u.root),o.push(z),S.push(O)}return new r(h,o,S)}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(e,p,g){"use strict";var a=e("robust-dot-product"),t=e("robust-sum");p.exports=r,p.exports.positive=d,p.exports.negative=s;function i(m,x){var M=t(a(m,x),[x[x.length-1]]);return M[M.length-1]}function n(m,x,M,v){var _=v-x,l=-x/_;l<0?l=0:l>1&&(l=1);for(var y=1-l,T=m.length,w=new Array(T),A=0;A<T;++A)w[A]=l*m[A]+y*M[A];return w}function r(m,x){for(var M=[],v=[],_=i(m[m.length-1],x),l=m[m.length-1],y=m[0],T=0;T<m.length;++T,l=y){y=m[T];var w=i(y,x);if(_<0&&w>0||_>0&&w<0){var A=n(l,w,y,_);M.push(A),v.push(A.slice())}w<0?v.push(y.slice()):w>0?M.push(y.slice()):(M.push(y.slice()),v.push(y.slice())),_=w}return{positive:M,negative:v}}function d(m,x){for(var M=[],v=i(m[m.length-1],x),_=m[m.length-1],l=m[0],y=0;y<m.length;++y,_=l){l=m[y];var T=i(l,x);(v<0&&T>0||v>0&&T<0)&&M.push(n(_,T,l,v)),T>=0&&M.push(l.slice()),v=T}return M}function s(m,x){for(var M=[],v=i(m[m.length-1],x),_=m[m.length-1],l=m[0],y=0;y<m.length;++y,_=l){l=m[y];var T=i(l,x);(v<0&&T>0||v>0&&T<0)&&M.push(n(_,T,l,v)),T<=0&&M.push(l.slice()),v=T}return M}},{"robust-dot-product":281,"robust-sum":289}],301:[function(e,p,g){(function(){"use strict";var a={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(s){return n(d(s),arguments)}function i(s,m){return t.apply(null,[s].concat(m||[]))}function n(s,m){var x=1,M=s.length,v,_="",l,y,T,w,A,f,u,h;for(l=0;l<M;l++)if(typeof s[l]=="string")_+=s[l];else if(typeof s[l]=="object"){if(T=s[l],T.keys)for(v=m[x],y=0;y<T.keys.length;y++){if(v==null)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',T.keys[y],T.keys[y-1]));v=v[T.keys[y]]}else T.param_no?v=m[T.param_no]:v=m[x++];if(a.not_type.test(T.type)&&a.not_primitive.test(T.type)&&v instanceof Function&&(v=v()),a.numeric_arg.test(T.type)&&typeof v!="number"&&isNaN(v))throw new TypeError(t("[sprintf] expecting number but found %T",v));switch(a.number.test(T.type)&&(u=v>=0),T.type){case"b":v=parseInt(v,10).toString(2);break;case"c":v=String.fromCharCode(parseInt(v,10));break;case"d":case"i":v=parseInt(v,10);break;case"j":v=JSON.stringify(v,null,T.width?parseInt(T.width):0);break;case"e":v=T.precision?parseFloat(v).toExponential(T.precision):parseFloat(v).toExponential();break;case"f":v=T.precision?parseFloat(v).toFixed(T.precision):parseFloat(v);break;case"g":v=T.precision?String(Number(v.toPrecision(T.precision))):parseFloat(v);break;case"o":v=(parseInt(v,10)>>>0).toString(8);break;case"s":v=String(v),v=T.precision?v.substring(0,T.precision):v;break;case"t":v=String(!!v),v=T.precision?v.substring(0,T.precision):v;break;case"T":v=Object.prototype.toString.call(v).slice(8,-1).toLowerCase(),v=T.precision?v.substring(0,T.precision):v;break;case"u":v=parseInt(v,10)>>>0;break;case"v":v=v.valueOf(),v=T.precision?v.substring(0,T.precision):v;break;case"x":v=(parseInt(v,10)>>>0).toString(16);break;case"X":v=(parseInt(v,10)>>>0).toString(16).toUpperCase();break}a.json.test(T.type)?_+=v:(a.number.test(T.type)&&(!u||T.sign)?(h=u?"+":"-",v=v.toString().replace(a.sign,"")):h="",A=T.pad_char?T.pad_char==="0"?"0":T.pad_char.charAt(1):" ",f=T.width-(h+v).length,w=T.width&&f>0?A.repeat(f):"",_+=T.align?h+v+w:A==="0"?h+w+v:w+h+v)}return _}var r=Object.create(null);function d(s){if(r[s])return r[s];for(var m=s,x,M=[],v=0;m;){if((x=a.text.exec(m))!==null)M.push(x[0]);else if((x=a.modulo.exec(m))!==null)M.push("%");else if((x=a.placeholder.exec(m))!==null){if(x[2]){v|=1;var _=[],l=x[2],y=[];if((y=a.key.exec(l))!==null)for(_.push(y[1]);(l=l.substring(y[0].length))!=="";)if((y=a.key_access.exec(l))!==null)_.push(y[1]);else if((y=a.index_access.exec(l))!==null)_.push(y[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");else throw new SyntaxError("[sprintf] failed to parse named argument key");x[2]=_}else v|=2;if(v===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");M.push({placeholder:x[0],param_no:x[1],keys:x[2],sign:x[3],pad_char:x[4],align:x[5],width:x[6],precision:x[7],type:x[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");m=m.substring(x[0].length)}return r[s]=M}typeof g<"u"&&(g.sprintf=t,g.vsprintf=i),typeof window<"u"&&(window.sprintf=t,window.vsprintf=i,typeof k=="function"&&k.amd&&k(function(){return{sprintf:t,vsprintf:i}}))})()},{}],302:[function(e,p,g){"use strict";p.exports=s;var a=e("ndarray-extract-contour"),t=e("zero-crossings"),i={"2d":function(m,x,M){var v=m({order:x,scalarArguments:3,getters:M==="generic"?[0]:void 0,phase:function(l,y,T,w){return l>w|0},vertex:function(l,y,T,w,A,f,u,h,o,S,R,z,O){var I=(u<<0)+(h<<1)+(o<<2)+(S<<3)|0;if(!(I===0||I===15))switch(I){case 0:R.push([l-.5,y-.5]);break;case 1:R.push([l-.25-.25*(w+T-2*O)/(T-w),y-.25-.25*(A+T-2*O)/(T-A)]);break;case 2:R.push([l-.75-.25*(-w-T+2*O)/(w-T),y-.25-.25*(f+w-2*O)/(w-f)]);break;case 3:R.push([l-.5,y-.5-.5*(A+T+f+w-4*O)/(T-A+w-f)]);break;case 4:R.push([l-.25-.25*(f+A-2*O)/(A-f),y-.75-.25*(-A-T+2*O)/(A-T)]);break;case 5:R.push([l-.5-.5*(w+T+f+A-4*O)/(T-w+A-f),y-.5]);break;case 6:R.push([l-.5-.25*(-w-T+f+A)/(w-T+A-f),y-.5-.25*(-A-T+f+w)/(A-T+w-f)]);break;case 7:R.push([l-.75-.25*(f+A-2*O)/(A-f),y-.75-.25*(f+w-2*O)/(w-f)]);break;case 8:R.push([l-.75-.25*(-f-A+2*O)/(f-A),y-.75-.25*(-f-w+2*O)/(f-w)]);break;case 9:R.push([l-.5-.25*(w+T+-f-A)/(T-w+f-A),y-.5-.25*(A+T+-f-w)/(T-A+f-w)]);break;case 10:R.push([l-.5-.5*(-w-T+-f-A+4*O)/(w-T+f-A),y-.5]);break;case 11:R.push([l-.25-.25*(-f-A+2*O)/(f-A),y-.75-.25*(A+T-2*O)/(T-A)]);break;case 12:R.push([l-.5,y-.5-.5*(-A-T+-f-w+4*O)/(A-T+f-w)]);break;case 13:R.push([l-.75-.25*(w+T-2*O)/(T-w),y-.25-.25*(-f-w+2*O)/(f-w)]);break;case 14:R.push([l-.25-.25*(-w-T+2*O)/(w-T),y-.25-.25*(-A-T+2*O)/(A-T)]);break;case 15:R.push([l-.5,y-.5]);break}},cell:function(l,y,T,w,A,f,u,h,o){A?h.push([l,y]):h.push([y,l])}});return function(_,l){var y=[],T=[];return v(_,y,T,l),{positions:y,cells:T}}}};function n(m,x){var M=m.length+"d",v=i[M];if(v)return v(a,m,x)}function r(m,x){for(var M=t(m,x),v=M.length,_=new Array(v),l=new Array(v),y=0;y<v;++y)_[y]=[M[y]],l[y]=[y];return{positions:_,cells:l}}var d={};function s(m,_){if(m.dimension<=0)return{positions:[],cells:[]};if(m.dimension===1)return r(m,_);var M=m.order.join()+"-"+m.dtype,v=d[M],_=+_||0;return v||(v=d[M]=n(m.order,m.dtype)),v(m,_)}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(e,p,g){(function(a){(function(){"use strict";p.exports=d;var t=e("vectorize-text"),i=window||a.global||{},n=i.__TEXT_CACHE||{};i.__TEXT_CACHE={};function r(s){for(var m=s.cells,x=s.positions,M=new Float32Array(m.length*6),v=0,_=0,l=0;l<m.length;++l)for(var y=m[l],T=0;T<3;++T){var w=x[y[T]];M[v++]=w[0],M[v++]=w[1]+1.4,_=Math.max(w[0],_)}return{data:M,shape:_}}function d(s,m,M){var M=M||{},v=n[s];v||(v=n[s]={" ":{data:new Float32Array(0),shape:.2}});var _=v[m];if(!_)if(m.length<=1||!/\d/.test(m))_=v[m]=r(t(m,{triangles:!0,font:s,textAlign:M.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var l=m.split(/(\d|\s)/),y=new Array(l.length),T=0,w=0,A=0;A<l.length;++A)y[A]=d(s,l[A]),T+=y[A].data.length,w+=y[A].shape,A>0&&(w+=.02);for(var f=new Float32Array(T),u=0,h=-.5*w,A=0;A<y.length;++A){for(var o=y[A].data,S=0;S<o.length;S+=2)f[u++]=o[S]+h,f[u++]=o[S+1];h+=y[A].shape+.02}_=v[m]={data:f,shape:w}}return _}}).call(this)}).call(this,e("_process"))},{_process:5,"vectorize-text":311}],304:[function(e,p,g){"use strict";var a=e("parse-unit");p.exports=r;var t=96;function i(d,s){var m=a(getComputedStyle(d).getPropertyValue(s));return m[0]*r(m[1],d)}function n(d,s){var m=document.createElement("div");m.style["font-size"]="128"+d,s.appendChild(m);var x=i(m,"font-size")/128;return s.removeChild(m),x}function r(d,s){switch(s=s||document.body,d=(d||"px").trim().toLowerCase(),(s===window||s===document)&&(s=document.body),d){case"%":return s.clientHeight/100;case"ch":case"ex":return n(d,s);case"em":return i(s,"font-size");case"rem":return i(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return t;case"cm":return t/2.54;case"mm":return t/25.4;case"pt":return t/72;case"pc":return t/6}return 1}},{"parse-unit":265}],305:[function(e,p,g){"use strict";p.exports=l;var a=e("filtered-vector"),t=e("gl-mat4/invert"),i=e("gl-mat4/rotate"),n=e("gl-vec3/cross"),r=e("gl-vec3/normalize"),d=e("gl-vec3/dot");function s(y,T,w){return Math.sqrt(Math.pow(y,2)+Math.pow(T,2)+Math.pow(w,2))}function m(y){return Math.min(1,Math.max(-1,y))}function x(y){var T=Math.abs(y[0]),w=Math.abs(y[1]),A=Math.abs(y[2]),f=[0,0,0];T>Math.max(w,A)?f[2]=1:w>Math.max(T,A)?f[0]=1:f[1]=1;for(var u=0,h=0,o=0;o<3;++o)u+=y[o]*y[o],h+=f[o]*y[o];for(var o=0;o<3;++o)f[o]-=h/u*y[o];return r(f,f),f}function M(y,T,w,A,f,u,h,o){this.center=a(w),this.up=a(A),this.right=a(f),this.radius=a([u]),this.angle=a([h,o]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(y,T),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var S=0;S<16;++S)this.computedMatrix[S]=.5;this.recalcMatrix(0)}var v=M.prototype;v.setDistanceLimits=function(y,T){y>0?y=Math.log(y):y=-1/0,T>0?T=Math.log(T):T=1/0,T=Math.max(T,y),this.radius.bounds[0][0]=y,this.radius.bounds[1][0]=T},v.getDistanceLimits=function(y){var T=this.radius.bounds[0];return y?(y[0]=Math.exp(T[0][0]),y[1]=Math.exp(T[1][0]),y):[Math.exp(T[0][0]),Math.exp(T[1][0])]},v.recalcMatrix=function(y){this.center.curve(y),this.up.curve(y),this.right.curve(y),this.radius.curve(y),this.angle.curve(y);for(var T=this.computedUp,w=this.computedRight,A=0,f=0,u=0;u<3;++u)f+=T[u]*w[u],A+=T[u]*T[u];for(var h=Math.sqrt(A),o=0,u=0;u<3;++u)w[u]-=T[u]*f/A,o+=w[u]*w[u],T[u]/=h;for(var S=Math.sqrt(o),u=0;u<3;++u)w[u]/=S;var R=this.computedToward;n(R,T,w),r(R,R);for(var z=Math.exp(this.computedRadius[0]),O=this.computedAngle[0],I=this.computedAngle[1],F=Math.cos(O),D=Math.sin(O),B=Math.cos(I),U=Math.sin(I),X=this.computedCenter,oe=F*B,se=D*B,q=U,K=-F*U,G=-D*U,Q=B,V=this.computedEye,H=this.computedMatrix,u=0;u<3;++u){var ee=oe*w[u]+se*R[u]+q*T[u];H[4*u+1]=K*w[u]+G*R[u]+Q*T[u],H[4*u+2]=ee,H[4*u+3]=0}var J=H[1],W=H[5],re=H[9],j=H[2],Z=H[6],ne=H[10],le=W*ne-re*Z,ge=re*j-J*ne,pe=J*Z-W*j,xe=s(le,ge,pe);le/=xe,ge/=xe,pe/=xe,H[0]=le,H[4]=ge,H[8]=pe;for(var u=0;u<3;++u)V[u]=X[u]+H[2+4*u]*z;for(var u=0;u<3;++u){for(var o=0,Ee=0;Ee<3;++Ee)o+=H[u+4*Ee]*V[Ee];H[12+u]=-o}H[15]=1},v.getMatrix=function(y,T){this.recalcMatrix(y);var w=this.computedMatrix;if(T){for(var A=0;A<16;++A)T[A]=w[A];return T}return w};var _=[0,0,0];v.rotate=function(y,T,w,A){if(this.angle.move(y,T,w),A){this.recalcMatrix(y);var f=this.computedMatrix;_[0]=f[2],_[1]=f[6],_[2]=f[10];for(var u=this.computedUp,h=this.computedRight,o=this.computedToward,S=0;S<3;++S)f[4*S]=u[S],f[4*S+1]=h[S],f[4*S+2]=o[S];i(f,f,A,_);for(var S=0;S<3;++S)u[S]=f[4*S],h[S]=f[4*S+1];this.up.set(y,u[0],u[1],u[2]),this.right.set(y,h[0],h[1],h[2])}},v.pan=function(y,T,w,A){T=T||0,w=w||0,A=A||0,this.recalcMatrix(y);var f=this.computedMatrix,u=Math.exp(this.computedRadius[0]),h=f[1],o=f[5],S=f[9],R=s(h,o,S);h/=R,o/=R,S/=R;var z=f[0],O=f[4],I=f[8],F=z*h+O*o+I*S;z-=h*F,O-=o*F,I-=S*F;var D=s(z,O,I);z/=D,O/=D,I/=D;var B=z*T+h*w,U=O*T+o*w,X=I*T+S*w;this.center.move(y,B,U,X);var oe=Math.exp(this.computedRadius[0]);oe=Math.max(1e-4,oe+A),this.radius.set(y,Math.log(oe))},v.translate=function(y,T,w,A){this.center.move(y,T||0,w||0,A||0)},v.setMatrix=function(y,T,w,A){var f=1;typeof w=="number"&&(f=w|0),(f<0||f>3)&&(f=1);var u=(f+2)%3,h=(f+1)%3;T||(this.recalcMatrix(y),T=this.computedMatrix);var o=T[f],S=T[f+4],R=T[f+8];if(A){var O=Math.abs(o),I=Math.abs(S),F=Math.abs(R),D=Math.max(O,I,F);O===D?(o=o<0?-1:1,S=R=0):F===D?(R=R<0?-1:1,o=S=0):(S=S<0?-1:1,o=R=0)}else{var z=s(o,S,R);o/=z,S/=z,R/=z}var B=T[u],U=T[u+4],X=T[u+8],oe=B*o+U*S+X*R;B-=o*oe,U-=S*oe,X-=R*oe;var se=s(B,U,X);B/=se,U/=se,X/=se;var q=S*X-R*U,K=R*B-o*X,G=o*U-S*B,Q=s(q,K,G);q/=Q,K/=Q,G/=Q,this.center.jump(y,De,ye,ke),this.radius.idle(y),this.up.jump(y,o,S,R),this.right.jump(y,B,U,X);var V,H;if(f===2){var ee=T[1],J=T[5],W=T[9],re=ee*B+J*U+W*X,j=ee*q+J*K+W*G;ge<0?V=-Math.PI/2:V=Math.PI/2,H=Math.atan2(j,re)}else{var Z=T[2],ne=T[6],le=T[10],ge=Z*o+ne*S+le*R,pe=Z*B+ne*U+le*X,xe=Z*q+ne*K+le*G;V=Math.asin(m(ge)),H=Math.atan2(xe,pe)}this.angle.jump(y,H,V),this.recalcMatrix(y);var Ee=T[2],Te=T[6],de=T[10],be=this.computedMatrix;t(be,T);var Le=be[15],De=be[12]/Le,ye=be[13]/Le,ke=be[14]/Le,Oe=Math.exp(this.computedRadius[0]);this.center.jump(y,De-Ee*Oe,ye-Te*Oe,ke-de*Oe)},v.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},v.idle=function(y){this.center.idle(y),this.up.idle(y),this.right.idle(y),this.radius.idle(y),this.angle.idle(y)},v.flush=function(y){this.center.flush(y),this.up.flush(y),this.right.flush(y),this.radius.flush(y),this.angle.flush(y)},v.setDistance=function(y,T){T>0&&this.radius.set(y,Math.log(T))},v.lookAt=function(y,T,w,A){this.recalcMatrix(y),T=T||this.computedEye,w=w||this.computedCenter,A=A||this.computedUp;var f=A[0],u=A[1],h=A[2],o=s(f,u,h);if(!(o<1e-6)){f/=o,u/=o,h/=o;var S=T[0]-w[0],R=T[1]-w[1],z=T[2]-w[2],O=s(S,R,z);if(!(O<1e-6)){S/=O,R/=O,z/=O;var I=this.computedRight,F=I[0],D=I[1],B=I[2],U=f*F+u*D+h*B;F-=U*f,D-=U*u,B-=U*h;var X=s(F,D,B);if(!(X<.01&&(F=u*z-h*R,D=h*S-f*z,B=f*R-u*S,X=s(F,D,B),X<1e-6))){F/=X,D/=X,B/=X,this.up.set(y,f,u,h),this.right.set(y,F,D,B),this.center.set(y,w[0],w[1],w[2]),this.radius.set(y,Math.log(O));var oe=u*B-h*D,se=h*F-f*B,q=f*D-u*F,K=s(oe,se,q);oe/=K,se/=K,q/=K;var G=f*S+u*R+h*z,Q=F*S+D*R+B*z,V=oe*S+se*R+q*z,H=Math.asin(m(G)),ee=Math.atan2(V,Q),J=this.angle._state,W=J[J.length-1],re=J[J.length-2];W=W%(2*Math.PI);var j=Math.abs(W+2*Math.PI-ee),Z=Math.abs(W-ee),ne=Math.abs(W-2*Math.PI-ee);j<Z&&(W+=2*Math.PI),ne<Z&&(W-=2*Math.PI),this.angle.jump(this.angle.lastT(),W,re),this.angle.set(y,ee,H)}}}};function l(y){y=y||{};var T=y.center||[0,0,0],w=y.up||[0,1,0],A=y.right||x(w),f=y.radius||1,u=y.theta||0,h=y.phi||0;if(T=[].slice.call(T,0,3),w=[].slice.call(w,0,3),r(w,w),A=[].slice.call(A,0,3),r(A,A),"eye"in y){var o=y.eye,S=[o[0]-T[0],o[1]-T[1],o[2]-T[2]];n(A,S,w),s(A[0],A[1],A[2])<1e-6?A=x(w):r(A,A),f=s(S[0],S[1],S[2]);var R=d(w,S)/f,z=d(A,S)/f;h=Math.acos(R),u=Math.acos(z)}return f=Math.log(f),new M(y.zoomMin,y.zoomMax,T,w,A,f,u,h)}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(e,p,g){"use strict";p.exports=t;var a=+(Math.pow(2,27)+1);function t(i,n,r){var d=i*n,s=a*i,m=s-i,x=s-m,M=i-x,v=a*n,_=v-n,l=v-_,y=n-l,T=d-x*l,w=T-M*l,A=w-x*y,f=M*y-A;return r?(r[0]=f,r[1]=d,r):[f,d]}},{}],307:[function(e,p,g){"use strict";p.exports=a;function a(t,i,n){var r=t+i,d=r-t,s=r-d,m=i-d,x=t-s;return n?(n[0]=x+m,n[1]=r,n):[x+m,r]}},{}],308:[function(e,p,g){(function(a){(function(){"use strict";var t=e("bit-twiddle"),i=e("dup"),n=e("buffer").Buffer;a.__TYPEDARRAY_POOL||(a.__TYPEDARRAY_POOL={UINT8:i([32,0]),UINT16:i([32,0]),UINT32:i([32,0]),BIGUINT64:i([32,0]),INT8:i([32,0]),INT16:i([32,0]),INT32:i([32,0]),BIGINT64:i([32,0]),FLOAT:i([32,0]),DOUBLE:i([32,0]),DATA:i([32,0]),UINT8C:i([32,0]),BUFFER:i([32,0])});var r=typeof Uint8ClampedArray<"u",d=typeof BigUint64Array<"u",s=typeof BigInt64Array<"u",m=a.__TYPEDARRAY_POOL;m.UINT8C||(m.UINT8C=i([32,0])),m.BIGUINT64||(m.BIGUINT64=i([32,0])),m.BIGINT64||(m.BIGINT64=i([32,0])),m.BUFFER||(m.BUFFER=i([32,0]));var x=m.DATA,M=m.BUFFER;g.free=function(D){if(n.isBuffer(D))M[t.log2(D.length)].push(D);else{if(Object.prototype.toString.call(D)!=="[object ArrayBuffer]"&&(D=D.buffer),!D)return;var B=D.length||D.byteLength,U=t.log2(B)|0;x[U].push(D)}};function v(F){if(!!F){var D=F.length||F.byteLength,B=t.log2(D);x[B].push(F)}}function _(F){v(F.buffer)}g.freeUint8=g.freeUint16=g.freeUint32=g.freeBigUint64=g.freeInt8=g.freeInt16=g.freeInt32=g.freeBigInt64=g.freeFloat32=g.freeFloat=g.freeFloat64=g.freeDouble=g.freeUint8Clamped=g.freeDataView=_,g.freeArrayBuffer=v,g.freeBuffer=function(D){M[t.log2(D.length)].push(D)},g.malloc=function(D,B){if(B===void 0||B==="arraybuffer")return l(D);switch(B){case"uint8":return y(D);case"uint16":return T(D);case"uint32":return w(D);case"int8":return A(D);case"int16":return f(D);case"int32":return u(D);case"float":case"float32":return h(D);case"double":case"float64":return o(D);case"uint8_clamped":return S(D);case"bigint64":return z(D);case"biguint64":return R(D);case"buffer":return I(D);case"data":case"dataview":return O(D);default:return null}return null};function l(D){var D=t.nextPow2(D),B=t.log2(D),U=x[B];return U.length>0?U.pop():new ArrayBuffer(D)}g.mallocArrayBuffer=l;function y(F){return new Uint8Array(l(F),0,F)}g.mallocUint8=y;function T(F){return new Uint16Array(l(2*F),0,F)}g.mallocUint16=T;function w(F){return new Uint32Array(l(4*F),0,F)}g.mallocUint32=w;function A(F){return new Int8Array(l(F),0,F)}g.mallocInt8=A;function f(F){return new Int16Array(l(2*F),0,F)}g.mallocInt16=f;function u(F){return new Int32Array(l(4*F),0,F)}g.mallocInt32=u;function h(F){return new Float32Array(l(4*F),0,F)}g.mallocFloat32=g.mallocFloat=h;function o(F){return new Float64Array(l(8*F),0,F)}g.mallocFloat64=g.mallocDouble=o;function S(F){return r?new Uint8ClampedArray(l(F),0,F):y(F)}g.mallocUint8Clamped=S;function R(F){return d?new BigUint64Array(l(8*F),0,F):null}g.mallocBigUint64=R;function z(F){return s?new BigInt64Array(l(8*F),0,F):null}g.mallocBigInt64=z;function O(F){return new DataView(l(F),0,F)}g.mallocDataView=O;function I(F){F=t.nextPow2(F);var D=t.log2(F),B=M[D];return B.length>0?B.pop():new n(F)}g.mallocBuffer=I,g.clearCache=function(){for(var D=0;D<32;++D)m.UINT8[D].length=0,m.UINT16[D].length=0,m.UINT32[D].length=0,m.INT8[D].length=0,m.INT16[D].length=0,m.INT32[D].length=0,m.FLOAT[D].length=0,m.DOUBLE[D].length=0,m.BIGUINT64[D].length=0,m.BIGINT64[D].length=0,m.UINT8C[D].length=0,x[D].length=0,M[D].length=0}}).call(this)}).call(this,typeof b<"u"?b:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(e,p,g){"use strict";p.exports=a;function a(i){this.roots=new Array(i),this.ranks=new Array(i);for(var n=0;n<i;++n)this.roots[n]=n,this.ranks[n]=0}var t=a.prototype;Object.defineProperty(t,"length",{get:function(){return this.roots.length}}),t.makeSet=function(){var i=this.roots.length;return this.roots.push(i),this.ranks.push(0),i},t.find=function(i){for(var n=i,r=this.roots;r[i]!==i;)i=r[i];for(;r[n]!==i;){var d=r[n];r[n]=i,n=d}return i},t.link=function(i,n){var r=this.find(i),d=this.find(n);if(r!==d){var s=this.ranks,m=this.roots,x=s[r],M=s[d];x<M?m[r]=d:M<x?m[d]=r:(m[d]=r,++s[r])}}},{}],310:[function(e,p,g){"use strict";function a(n,r){for(var d=1,s=n.length,m=n[0],x=n[0],M=1;M<s;++M)if(x=m,m=n[M],r(m,x)){if(M===d){d++;continue}n[d++]=m}return n.length=d,n}function t(n){for(var r=1,d=n.length,s=n[0],m=n[0],x=1;x<d;++x,m=s)if(m=s,s=n[x],s!==m){if(x===r){r++;continue}n[r++]=s}return n.length=r,n}function i(n,r,d){return n.length===0?n:r?(d||n.sort(r),a(n,r)):(d||n.sort(),t(n))}p.exports=i},{}],311:[function(e,p,g){"use strict";p.exports=n;var a=e("./lib/vtext"),t=null,i=null;typeof document<"u"&&(t=document.createElement("canvas"),t.width=8192,t.height=1024,i=t.getContext("2d"));function n(r,d){return(typeof d!="object"||d===null)&&(d={}),a(r,d.canvas||t,d.context||i,d)}},{"./lib/vtext":312}],312:[function(e,p,g){p.exports=R,p.exports.processPixels=S;var a=e("surface-nets"),t=e("ndarray"),i=e("simplify-planar-graph"),n=e("clean-pslg"),r=e("cdt2d"),d=e("planar-graph-to-polyline"),s="b",m="b|",x="i",M="i|",v="sup",_="+",l="+1",y="sub",T="-",w="-1";function A(z,O,I,F){for(var D="<"+z+">",B="</"+z+">",U=D.length,X=B.length,oe=O[0]===_||O[0]===T,se=0,q=-X;se>-1&&(se=I.indexOf(D,se),!(se===-1||(q=I.indexOf(B,se+U),q===-1)||q<=se));){for(var K=se;K<q+X;++K)if(K<se+U||K>=q)F[K]=null,I=I.substr(0,K)+" "+I.substr(K+1);else if(F[K]!==null){var G=F[K].indexOf(O[0]);G===-1?F[K]+=O:oe&&(F[K]=F[K].substr(0,G+1)+(1+parseInt(F[K][G+1]))+F[K].substr(G+2))}var Q=se+U,V=I.substr(Q,q-Q),H=V.indexOf(D);H!==-1?se=H:se=q+X}return F}function f(z,O,I){for(var F=O.textAlign||"start",D=O.textBaseline||"alphabetic",B=[1<<30,1<<30],U=[0,0],X=z.length,oe=0;oe<X;++oe)for(var se=z[oe],q=0;q<2;++q)B[q]=Math.min(B[q],se[q])|0,U[q]=Math.max(U[q],se[q])|0;var K=0;switch(F){case"center":K=-.5*(B[0]+U[0]);break;case"right":case"end":K=-U[0];break;case"left":case"start":K=-B[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+F+"'")}var G=0;switch(D){case"hanging":case"top":G=-B[1];break;case"middle":G=-.5*(B[1]+U[1]);break;case"alphabetic":case"ideographic":G=-3*I;break;case"bottom":G=-U[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+D+"'")}var Q=1/I;return"lineHeight"in O?Q*=+O.lineHeight:"width"in O?Q=O.width/(U[0]-B[0]):"height"in O&&(Q=O.height/(U[1]-B[1])),z.map(function(V){return[Q*(V[0]+K),Q*(V[1]+G)]})}function u(z,O,I,F,D,B){I=I.replace(/\n/g,""),B.breaklines===!0?I=I.replace(/\<br\>/g,`
`):I=I.replace(/\<br\>/g," ");var U="",X=[];for(W=0;W<I.length;++W)X[W]=U;B.bolds===!0&&(X=A(s,m,I,X)),B.italics===!0&&(X=A(x,M,I,X)),B.superscripts===!0&&(X=A(v,l,I,X)),B.subscripts===!0&&(X=A(y,w,I,X));var oe=[],se="";for(W=0;W<I.length;++W)X[W]!==null&&(se+=I[W],oe.push(X[W]));var q=se.split(`
`),K=q.length,G=Math.round(D*F),Q=F,V=F*2,H=0,ee=K*G+V;z.height<ee&&(z.height=ee),O.fillStyle="#000",O.fillRect(0,0,z.width,z.height),O.fillStyle="#fff";var J,W,re,j,Z,ne=0,le="";function ge(){if(le!==""){var ye=O.measureText(le).width;O.fillText(le,Q+re,V+j),re+=ye}}function pe(){return""+Math.round(Z)+"px "}function xe(ye,ke){var Oe=""+O.font;if(B.subscripts===!0){var Qe=ye.indexOf(T),Ve=ke.indexOf(T),Ue=Qe>-1?parseInt(ye[1+Qe]):0,Ie=Ve>-1?parseInt(ke[1+Ve]):0;Ue!==Ie&&(Oe=Oe.replace(pe(),"?px "),Z*=Math.pow(.75,Ie-Ue),Oe=Oe.replace("?px ",pe())),j+=.25*G*(Ie-Ue)}if(B.superscripts===!0){var at=ye.indexOf(_),pt=ke.indexOf(_),Rt=at>-1?parseInt(ye[1+at]):0,Mt=pt>-1?parseInt(ke[1+pt]):0;Rt!==Mt&&(Oe=Oe.replace(pe(),"?px "),Z*=Math.pow(.75,Mt-Rt),Oe=Oe.replace("?px ",pe())),j-=.25*G*(Mt-Rt)}if(B.bolds===!0){var It=ye.indexOf(m)>-1,Bt=ke.indexOf(m)>-1;!It&&Bt&&(St?Oe=Oe.replace("italic ","italic bold "):Oe="bold "+Oe),It&&!Bt&&(Oe=Oe.replace("bold ",""))}if(B.italics===!0){var St=ye.indexOf(M)>-1,_t=ke.indexOf(M)>-1;!St&&_t&&(Oe="italic "+Oe),St&&!_t&&(Oe=Oe.replace("italic ",""))}O.font=Oe}for(J=0;J<K;++J){var Ee=q[J]+`
`;for(re=0,j=J*G,Z=F,le="",W=0;W<Ee.length;++W){var Te=W+ne<oe.length?oe[W+ne]:oe[oe.length-1];U===Te?le+=Ee[W]:(ge(),le=Ee[W],Te!==void 0&&(xe(U,Te),U=Te))}ge(),ne+=Ee.length;var de=Math.round(re+2*Q)|0;H<de&&(H=de)}var be=H,Le=V+G*K,De=t(O.getImageData(0,0,be,Le).data,[Le,be,4]);return De.pick(-1,-1,0).transpose(1,0)}function h(z,O){var I=a(z,128);return O?i(I.cells,I.positions,.25):{edges:I.cells,positions:I.positions}}function o(z,O,I,F){var D=h(z,F),B=f(D.positions,O,I),U=D.edges,X=O.orientation==="ccw";if(n(B,U),O.polygons||O.polygon||O.polyline){for(var oe=d(U,B),se=new Array(oe.length),q=0;q<oe.length;++q){for(var K=oe[q],G=new Array(K.length),Q=0;Q<K.length;++Q){for(var V=K[Q],H=new Array(V.length),ee=0;ee<V.length;++ee)H[ee]=B[V[ee]].slice();X&&H.reverse(),G[Q]=H}se[q]=G}return se}else return O.triangles||O.triangulate||O.triangle?{cells:r(B,U,{delaunay:!1,exterior:!1,interior:!0}),positions:B}:{edges:U,positions:B}}function S(z,O,I){try{return o(z,O,I,!0)}catch{}try{return o(z,O,I,!1)}catch{}return O.polygons||O.polyline||O.polygon?[]:O.triangles||O.triangulate||O.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}function R(z,O,I,F){var D=64,B=1.25,U={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};F&&(F.size&&F.size>0&&(D=F.size),F.lineSpacing&&F.lineSpacing>0&&(B=F.lineSpacing),F.styletags&&F.styletags.breaklines&&(U.breaklines=!!F.styletags.breaklines),F.styletags&&F.styletags.bolds&&(U.bolds=!!F.styletags.bolds),F.styletags&&F.styletags.italics&&(U.italics=!!F.styletags.italics),F.styletags&&F.styletags.subscripts&&(U.subscripts=!!F.styletags.subscripts),F.styletags&&F.styletags.superscripts&&(U.superscripts=!!F.styletags.superscripts)),I.font=[F.fontStyle,F.fontVariant,F.fontWeight,D+"px",F.font].filter(function(oe){return oe}).join(" "),I.textAlign="start",I.textBaseline="alphabetic",I.direction="ltr";var X=u(O,I,z,D,B,U);return S(X,F,D)}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(e,p,g){(function(){"use strict";if(typeof ses<"u"&&ses.ok&&!ses.ok())return;function t(R){R.permitHostObjects___&&R.permitHostObjects___(t)}typeof ses<"u"&&(ses.weakMapPermitHostObjects=t);var i=!1;if(typeof WeakMap=="function"){var n=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var r=new n,d=Object.freeze({});if(r.set(d,1),r.get(d)!==1)i=!0;else{p.exports=WeakMap;return}}}var s=Object.prototype.hasOwnProperty,m=Object.getOwnPropertyNames,x=Object.defineProperty,M=Object.isExtensible,v="weakmap:",_=v+"ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var l=new ArrayBuffer(25),y=new Uint8Array(l);crypto.getRandomValues(y),_=v+"rand:"+Array.prototype.map.call(y,function(R){return(R%36).toString(36)}).join("")+"___"}function T(R){return!(R.substr(0,v.length)==v&&R.substr(R.length-3)==="___")}if(x(Object,"getOwnPropertyNames",{value:function(z){return m(z).filter(T)}}),"getPropertyNames"in Object){var w=Object.getPropertyNames;x(Object,"getPropertyNames",{value:function(z){return w(z).filter(T)}})}function A(R){if(R!==Object(R))throw new TypeError("Not an object: "+R);var z=R[_];if(z&&z.key===R)return z;if(!!M(R)){z={key:R};try{return x(R,_,{value:z,writable:!1,enumerable:!1,configurable:!1}),z}catch{return}}}(function(){var R=Object.freeze;x(Object,"freeze",{value:function(F){return A(F),R(F)}});var z=Object.seal;x(Object,"seal",{value:function(F){return A(F),z(F)}});var O=Object.preventExtensions;x(Object,"preventExtensions",{value:function(F){return A(F),O(F)}})})();function f(R){return R.prototype=null,Object.freeze(R)}var u=!1;function h(){!u&&typeof console<"u"&&(u=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}var o=0,S=function(){this instanceof S||h();var R=[],z=[],O=o++;function I(U,X){var oe,se=A(U);return se?O in se?se[O]:X:(oe=R.indexOf(U),oe>=0?z[oe]:X)}function F(U){var X=A(U);return X?O in X:R.indexOf(U)>=0}function D(U,X){var oe,se=A(U);return se?se[O]=X:(oe=R.indexOf(U),oe>=0?z[oe]=X:(oe=R.length,z[oe]=X,R[oe]=U)),this}function B(U){var X=A(U),oe,se;return X?O in X&&delete X[O]:(oe=R.indexOf(U),oe<0?!1:(se=R.length-1,R[oe]=void 0,z[oe]=z[se],R[oe]=R[se],R.length=se,z.length=se,!0))}return Object.create(S.prototype,{get___:{value:f(I)},has___:{value:f(F)},set___:{value:f(D)},delete___:{value:f(B)}})};S.prototype=Object.create(Object.prototype,{get:{value:function(z,O){return this.get___(z,O)},writable:!0,configurable:!0},has:{value:function(z){return this.has___(z)},writable:!0,configurable:!0},set:{value:function(z,O){return this.set___(z,O)},writable:!0,configurable:!0},delete:{value:function(z){return this.delete___(z)},writable:!0,configurable:!0}}),typeof n=="function"?function(){i&&typeof Proxy<"u"&&(Proxy=void 0);function R(){this instanceof S||h();var z=new n,O=void 0,I=!1;function F(X,oe){return O?z.has(X)?z.get(X):O.get___(X,oe):z.get(X,oe)}function D(X){return z.has(X)||(O?O.has___(X):!1)}var B;i?B=function(X,oe){return z.set(X,oe),z.has(X)||(O||(O=new S),O.set(X,oe)),this}:B=function(X,oe){if(I)try{z.set(X,oe)}catch{O||(O=new S),O.set___(X,oe)}else z.set(X,oe);return this};function U(X){var oe=!!z.delete(X);return O&&O.delete___(X)||oe}return Object.create(S.prototype,{get___:{value:f(F)},has___:{value:f(D)},set___:{value:f(B)},delete___:{value:f(U)},permitHostObjects___:{value:f(function(X){if(X===t)I=!0;else throw new Error("bogus call to permitHostObjects___")})}})}R.prototype=S.prototype,p.exports=R,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),p.exports=S)})()},{}],314:[function(e,p,g){var a=e("./hidden-store.js");p.exports=t;function t(){var i={};return function(n){if((typeof n!="object"||n===null)&&typeof n!="function")throw new Error("Weakmap-shim: Key must be object");var r=n.valueOf(i);return r&&r.identity===i?r:a(n,i)}}},{"./hidden-store.js":315}],315:[function(e,p,g){p.exports=a;function a(t,i){var n={identity:i},r=t.valueOf;return Object.defineProperty(t,"valueOf",{value:function(d){return d!==i?r.apply(this,arguments):n},writable:!0}),n}},{}],316:[function(e,p,g){var a=e("./create-store.js");p.exports=t;function t(){var i=a();return{get:function(n,r){var d=i(n);return d.hasOwnProperty("value")?d.value:r},set:function(n,r){return i(n).value=r,this},has:function(n){return"value"in i(n)},delete:function(n){return delete i(n).value}}}},{"./create-store.js":314}],317:[function(e,p,g){"use strict";function a(){return function(s,m,x,M,v,_){var l=s[0],y=x[0],T=[0],w=y;M|=0;var A=0,f=y;for(A=0;A<l;++A){{var u=m[M]-_,h=m[M+w]-_;u>=0!=h>=0&&v.push(T[0]+.5+.5*(u+h)/(u-h))}M+=f,++T[0]}}}function t(){return a()}var i=t;function n(s){var m={};return function(M,v,_){var l=M.dtype,y=M.order,T=[l,y.join()].join(),w=m[T];return w||(m[T]=w=s([l,y])),w(M.shape.slice(0),M.data,M.stride,M.offset|0,v,_)}}function r(s){return n(i.bind(void 0,s))}function d(s){return r({funcName:s.funcName})}p.exports=d({funcName:"zeroCrossings"})},{}],318:[function(e,p,g){"use strict";p.exports=t;var a=e("./lib/zc-core");function t(i,n){var r=[];return n=+n||0,a(i.hi(i.shape[0]-1),r,n),r}},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)})});var zh=rg(Kv());var tc={RED:(Vr=.8)=>`rgba(255,65,54,${Vr})`,GREEN:(Vr=.8)=>`rgba(46,204,64,${Vr})`,BLUE:(Vr=.8)=>`rgba(0,116,217,${Vr})`,GOLD:(Vr=.8)=>`rgba(238,170,0,${Vr})`,PURPLE:(Vr=.8)=>`rgba(102,51,102,${Vr})`,BLACK:(Vr=.8)=>`rgba(0,0,0,${Vr})`};var ro=Math.sqrt,Jv=[{fns:[(Vr,wn,ca)=>({x:Vr,y:16*ro(2*Vr),z:ca}),(Vr,wn,ca)=>({x:Vr,y:ro(2*Vr),z:ca}),(Vr,wn,ca)=>({x:Vr,y:wn,z:0}),(Vr,wn,ca)=>({x:Vr,y:wn,z:2-Vr})],aabb:[{x:0,y:0,z:0},{x:2,y:32,z:2}],isInside:({x:Vr,y:wn,z:ca})=>Vr>=0&&Vr<=2&&ca>=0&&ca<=2-Vr&&wn>=ro(2*Vr)&&wn<=16*ro(2*Vr)},{fns:[(Vr,wn,ca)=>({x:Vr,y:5*ro(Vr),z:ca}),(Vr,wn,ca)=>({x:Vr,y:5*Vr/3,z:ca}),(Vr,wn,ca)=>({x:Vr,y:wn,z:0}),(Vr,wn,ca)=>({x:Vr,y:wn,z:5+5*ro(Vr)/3})],aabb:[{x:0,y:0,z:0},{x:9,y:15,z:9}],isInside:({x:Vr,y:wn,z:ca})=>ca>=0&&ca<=5+5*ro(Vr)/3&&wn>=5*Vr/3&&wn<=5*ro(Vr)&&Vr>=0&&Vr<=9},{fns:[(Vr,wn,ca)=>({x:19*ro(2*wn),y:wn,z:ca}),(Vr,wn,ca)=>({x:4*ro(2*wn),y:wn,z:ca}),(Vr,wn,ca)=>({x:Vr,y:wn,z:0}),(Vr,wn,ca)=>({x:Vr,y:wn,z:2-wn})],aabb:[{x:0,y:0,z:0},{x:38,y:2,z:2}],isInside:({x:Vr,y:wn,z:ca})=>wn>=0&&wn<=2&&Vr>=4*ro(2*wn)&&Vr<=19*ro(2*wn)&&ca>=0&&ca<=2-wn},{fns:[(Vr,wn,ca)=>({x:Vr,y:2-Vr,z:ca}),(Vr,wn,ca)=>({x:Vr,y:ro(Vr),z:ca}),(Vr,wn,ca)=>({x:Vr,y:wn,z:12*wn}),(Vr,wn,ca)=>({x:Vr,y:wn,z:0})],aabb:[{x:0,y:0,z:0},{x:2,y:2,z:24}],isInside:({x:Vr,y:wn,z:ca})=>Vr>=0&&Vr<=2&&wn<=2-Vr&&wn<=ro(Vr)&&ca>=0&&ca<=12*wn},{fns:[(Vr,wn,ca)=>({x:20*ro(2*wn),y:wn,z:ca}),(Vr,wn,ca)=>({x:5*ro(2*wn),y:wn,z:ca}),(Vr,wn,ca)=>({x:Vr,y:wn,z:0}),(Vr,wn,ca)=>({x:Vr,y:wn,z:1/2-wn})],aabb:[{x:0,y:0,z:0},{x:20,y:1/2,z:1/2}],isInside:({x:Vr,y:wn,z:ca})=>wn>=0&&wn<=2&&Vr>=5*ro(2*wn)&&Vr<=20*ro(2*wn)&&ca>=0&&ca<=1/2-wn},{fns:[(Vr,wn,ca)=>({x:5*ro(wn)/2,y:wn,z:ca}),(Vr,wn,ca)=>({x:5*wn/6,y:wn,z:ca}),(Vr,wn,ca)=>({x:Vr,y:wn,z:0}),(Vr,wn,ca)=>({x:Vr,y:wn,z:5*(3+ro(wn))/6})],aabb:[{x:0,y:0,z:0},{x:7.5,y:9,z:5}],isInside:({x:Vr,y:wn,z:ca})=>wn>=0&&wn<=9&&Vr<=5*ro(wn)/2&&Vr>=5*wn/6&&ca>=0&&ca<=5*(3+ro(wn))/6},{fns:[(Vr,wn,ca)=>({x:5*ro(wn)/6,y:wn,z:ca}),(Vr,wn,ca)=>({x:5*wn/18,y:wn,z:ca}),(Vr,wn,ca)=>({x:Vr,y:wn,z:0}),(Vr,wn,ca)=>({x:Vr,y:wn,z:5*(3+ro(wn))/18})],aabb:[{x:0,y:0,z:0},{x:2.5,y:9,z:5/3}],isInside:({x:Vr,y:wn,z:ca})=>wn>=0&&wn<=9&&Vr<=5*ro(wn)/6&&Vr>=5*wn/18&&ca>=0&&ca<=5*(3+ro(wn))/18},{fns:[(Vr,wn,ca)=>({x:2-wn,y:wn,z:ca}),(Vr,wn,ca)=>({x:ro(wn),y:wn,z:ca}),(Vr,wn,ca)=>({x:Vr,y:wn,z:12*Vr/5}),(Vr,wn,ca)=>({x:Vr,y:wn,z:0})],aabb:[{x:0,y:0,z:0},{x:1,y:1,z:12/5}],isInside:({x:Vr,y:wn,z:ca})=>wn>=0&&wn<=1&&Vr<=2-wn&&Vr<=ro(wn)&&ca>=0&&ca<=12*wn/5},{fns:[(Vr,wn,ca)=>({x:Vr,y:17*ro(2*Vr),z:ca}),(Vr,wn,ca)=>({x:Vr,y:2*ro(2*Vr),z:ca}),(Vr,wn,ca)=>({x:Vr,y:wn,z:0}),(Vr,wn,ca)=>({x:1/2-ca,y:wn,z:ca})],aabb:[{x:0,y:0,z:0},{x:1/2,y:17,z:1/2}],isInside:({x:Vr,y:wn,z:ca})=>Vr>=0&&Vr<=1/2&&ca>=0&&ca<=1/2-Vr&&wn>=2*ro(2*Vr)&&wn<=17*ro(2*Vr)}];var eh=(Vr,wn=document)=>wn.querySelector(Vr),Ih=(Vr,wn,ca,c)=>Vr.addEventListener(wn,ca,!!c);var Ef=(Vr,wn)=>Vr.map(ca=>ca[wn]),Qv=Vr=>Vr.toFixed(3),Rh=(Vr,wn)=>Math.random()*(wn-Vr)+Vr,ng=(Vr,wn)=>({x:Rh(Vr.x,wn.x),y:Rh(Vr.y,wn.y),z:Rh(Vr.z,wn.z)});var $v=Vr=>{let[wn,ca]=Vr;return(ca.x-wn.x)*(ca.y-wn.y)*(ca.z-wn.z)};function qv(Vr,wn,ca,c){let ae=(wn.x-Vr.x)/ca,ie=(wn.y-Vr.y)/ca,b=(wn.z-Vr.z)/ca,k=[];for(let P=Vr.x;P<=wn.x;P+=ae)for(let E=Vr.y;E<=wn.y;E+=ie)for(let e=Vr.z;e<=wn.z;e+=b)k.push(c(P,E,e));return k}function ep(Vr,wn,ca){let c=Array(ca);for(let ae=0;ae<ca;ae++)c[ae]=ng(Vr,wn);return c}var Mc=100,tp=0;function Fh(){let Vr=Jv[tp],[wn,ca]=Vr.aabb,c=()=>Vr.fns.map(a=>qv(wn,ca,10,a)),ae=[],ie=c(),b=[tc.BLUE(),tc.RED(),tc.GREEN(),tc.BLACK()];for(let a=0;a<ie.length;a++){let t=ie[a];ae.push({x:Ef(t,"x"),y:Ef(t,"y"),z:Ef(t,"z"),type:"scatter3d",mode:"markers",marker:{size:2,color:b[a]}})}let P=ep(wn,ca,Mc).filter(a=>Vr.isInside(a)),E=P.length,e=[{x:Ef(P,"x"),y:Ef(P,"y"),z:Ef(P,"z"),type:"scatter3d",mode:"markers",marker:{size:2,color:tc.PURPLE()}}],p={showlegend:!1,width:800,height:800};zh.default.newPlot("surfaces",ae,p),zh.default.newPlot("volume",e,p);let g=$v(Vr.aabb);eh("#result").textContent=`\u0422\u043E\u0447\u0435\u043A \u0432 \u0444\u0438\u0433\u0443\u0440\u0435: ${E} \u0438\u0437 ${Mc} (${Qv(100*E/Mc)}%), \u043E\u0431\u044A\u0451\u043C: ${g*E/Mc} \u0438\u0437 ${g}`}Fh();Ih(eh("#variant"),"change",Vr=>{let wn=Vr.target;tp=+wn.options[wn.selectedIndex].value,Fh()});Ih(eh("#points"),"change",Vr=>{let wn=Vr.target;Mc=+wn.options[wn.selectedIndex].value,Fh()});})();
/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
/*!
 * pad-left <https://github.com/jonschlinkert/pad-left>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT license.
 */
/*!
 * repeat-string <https://github.com/jonschlinkert/repeat-string>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */
/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
